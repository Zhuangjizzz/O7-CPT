[

{
    "text": "Chapter Outline\n\n5.1 The $\\mu \\mathrm{A} 741$ Operational Amplifier 473\n5.2 The Two-Stage CMOS Operational Amplifier 487\n5.3 The Folded-Cascode CMOS Operational Amplifier 495\n5.4 Voltage Comparators 501\n5.5 Current and Voltage References 510\n5.6 Current-Mode Integrated Circuits 521\n5.7 Fully Differential Operational Amplifiers 532\n5.8 Switched-Capacitor Circuits 541\n\nAppendix 5A: SPICE Macro-Models 553\nReferences 554\nProblems 554\n\nThe advent of the integrated-circuit concept by Jack Kilby at Texas Instruments in 1958 and independently by Robert Noyce at Fairchild Semiconductor in 1959 sparked intense activity, culminating in the creation of the first analog integrated circuits (ICs), specifically the $\\mu \\mathrm{A} 702$ and $\\mu \\mathrm{A} 709$ operational amplifiers, the $\\mu \\mathrm{A} 710$ voltage comparator, and the $\\mu \\mathrm{A} 723$ voltage regulator. These devices were developed in the early 1960s by Robert J. Widlar (1937-1991) during his tenure at Fairchild. (He later moved to National Semiconductor, where he continued to innovate in analog technology.) Widlar introduced several foundational components, such as the Widlar current source and the bandgap voltage reference, which became industry benchmarks and remain widely utilized today.\n\nIn May 1968, Fairchild introduced the $\\mu \\mathrm{A} 741$, the first op amp with internal frequency compensation. Prior to this, op amps required external components for frequency compensation. By integrating this function onto the chip, the 741 simplified usage, eliminating the need for users to deal with the complex issue of frequency compensation, thereby broadening the market for both experts and novices. Despite the development of numerous other op amp families since then, the 741 remains the most extensively documented op amp and incorporates fundamental components common to many modern analog ICs. Therefore, it is prudent to begin the chapter by examining this device, both for its historical significance and educational value.\n\nCHAPTER HIGHLIGHTS\n\nAfter a thorough analysis of the classic 741 op amp, focusing on common nonidealities and limitations, the chapter shifts to the two predominant CMOS op amp configurations currently in use: the two-stage and the folded-cascode types. (These three categories of op amps are revisited in Chapter 6, where their frequency and time responses are explored, and in Chapter 7, where their stability in negative-feedback operation is examined.)\n\nThe discussion then moves to voltage comparators, another widely used category of analog ICs. Both bipolar and CMOS varieties are covered, including those with hysteresis. (Their transient responses are analyzed in Chapter 6.)\n\nNearly every IC necessitates appropriate circuitry for internal transistor biasing. Additionally, applications like instrumentation and measurement demand stable and predictable current and voltage references. This category of circuits is subsequently addressed, including bandgap-reference types for both bipolar and CMOS ICs.\n\nInterestingly, while the engineering community has traditionally preferred voltage manipulation, current manipulation is inherently a faster process. Despite delays due to technological constraints, current-mode ICs are now extensively used alongside their voltage-mode counterparts. The chapter covers circuits such as transconductors, current conveyors (CCs), operational transconductance amplifiers (OTAs), current feedback amplifiers (CFAs), and Gilbert Cells.\n\nIn contemporary mixed-mode ICs, where sensitive analog circuits must coexist with digital circuits in noisy environments and with low-power supplies, much of the signal processing and transmission is performed in fully differential form. The chapter explores some of the most prevalent fully differential op amps in use today.\n\nThe need to integrate analog and digital functions on a single chip necessitates the reconfiguration of traditional analog functions using CMOS switches and capacitors, the most readily available components in today's dominant digital technology. The chapter concludes with an examination of switched-capacitor techniques in two typical applications: autozeroing and filtering. A concise discussion of the discrete-time nature of switched-capacitor integrators highlights their differences from their continuous-time equivalents.\n\nThe chapter extensively employs PSpice, both as a software oscilloscope for displaying transfer curves and waveforms, and as a tool for verifying dc and ac hand calculations."
},
{
    "text": "Chapter Outline\n\n5.1 The $\\mu \\mathrm{A} 741$ Operational Amplifier 473\n5.2 The Two-Stage CMOS Operational Amplifier 487\n5.3 The Folded-Cascode CMOS Operational Amplifier 495\n5.4 Voltage Comparators 501\n5.5 Current and Voltage References 510\n5.6 Current-Mode Integrated Circuits 521\n5.7 Fully Differential Operational Amplifiers 532\n5.8 Switched-Capacitor Circuits 541\n\nAppendix 5A: SPICE Macro-Models 553\nReferences 554\nProblems 554\n\nThe introduction of the integrated-circuit concept by Jack Kilby at Texas Instruments in 1958 and independently by Robert Noyce at Fairchild Semiconductor in 1959 sparked intense activity, leading to the creation of the first analog integrated circuits (ICs). These included the $\\mu \\mathrm{A} 702$ and $\\mu \\mathrm{A} 709$ operational amplifiers, the $\\mu \\mathrm{A} 710$ voltage comparator, and the $\\mu \\mathrm{A} 723$ voltage regulator. These devices were designed in the early 1960s by Robert J. Widlar (1937-1991) during his tenure at Fairchild. (He later moved to National Semiconductor, where he continued to innovate in analog technology.) Widlar developed several key components, such as the Widlar current source and the bandgap voltage reference, which became industry standards and remain widely used today.\n\nIn May 1968, Fairchild introduced the $\\mu \\mathrm{A} 741$, the first op amp with internal frequency compensation. Prior to this, op amps required external components for frequency compensation. By integrating this function onto the chip, the 741 simplified the user experience, eliminating the need to deal with complex frequency compensation issues, thus broadening the market for both experts and beginners. Despite the development of numerous other op amp families since then, the 741 remains the most extensively documented op amp and includes fundamental building blocks common to many modern analog ICs. Therefore, it is beneficial to begin the chapter by examining this device, both from historical and educational perspectives.\n\nCHAPTER HIGHLIGHTS\n\nAfter a thorough analysis of the classic 741 op amp, focusing on common nonidealities and limitations, the chapter shifts to the two most prevalent CMOS op amp architectures today: the two-stage and the folded-cascode types. (These three categories of op amps are revisited in Chapter 6, where their frequency and time responses are examined, and in Chapter 7, where their stability in negative-feedback operation is discussed.)\n\nThe chapter then addresses voltage comparators, another significant category of analog ICs. Both bipolar and CMOS comparator types are covered, including those with hysteresis. (Their transient responses are explored in Chapter 6.)\n\nNearly every IC requires internal circuitry to bias its transistors. Additionally, applications like instrumentation and measurement necessitate stable and predictable current and voltage references. This section delves into these circuits, including bandgap-reference types for both bipolar and CMOS ICs.\n\nInterestingly, while the engineering community has traditionally preferred voltage manipulation, current manipulation is inherently faster. Despite delays due to technological constraints, current-mode ICs are now widely used alongside voltage-mode counterparts. The chapter covers circuits such as transconductors, current conveyors (CCs), operational transconductance amplifiers (OTAs), current feedback amplifiers (CFAs), and Gilbert Cells.\n\nIn contemporary mixed-mode ICs, where sensitive analog circuits must coexist with digital circuits in noisy environments and with low-power supplies, much of the signal processing and transmission is done in fully differential form. The chapter examines some of the most common fully differential op amps in use today.\n\nThe need to integrate analog and digital functions on a single chip necessitates reinterpreting traditional analog functions using CMOS switches and capacitors, the most readily available components in today's dominant digital technology. The chapter concludes with a discussion of switched-capacitor techniques in two key applications: autozeroing and filtering. A brief examination of the discrete-time nature of switched-capacitor integrators highlights their differences from their continuous-time counterparts.\n\nThroughout the chapter, PSpice is extensively utilized both as a software oscilloscope for displaying transfer curves and waveforms, and as a tool for verifying dc and ac hand calculations."
},
{
    "text": "Chapter Outline\n\n5.1 The $\\mu \\mathrm{A} 741$ Operational Amplifier 473\n5.2 The Two-Stage CMOS Operational Amplifier 487\n5.3 The Folded-Cascode CMOS Operational Amplifier 495\n5.4 Voltage Comparators 501\n5.5 Current and Voltage References 510\n5.6 Current-Mode Integrated Circuits 521\n5.7 Fully Differential Operational Amplifiers 532\n5.8 Switched-Capacitor Circuits 541\n\nAppendix 5A: SPICE Macro-Models 553\nReferences 554\nProblems 554\n\nThe development of integrated-circuit technology was initiated by Jack Kilby at Texas Instruments in 1958 and independently by Robert Noyce at Fairchild Semiconductor in 1959. This led to the creation of the first analog integrated circuits (ICs), including the $\\mu \\mathrm{A} 702$ and $\\mu \\mathrm{A} 709$ operational amplifiers, the $\\mu \\mathrm{A} 710$ voltage comparator, and the $\\mu \\mathrm{A} 723$ voltage regulator. These were designed in the early 1960s by Robert J. Widlar (1937-1991) during his tenure at Fairchild. Widlar later moved to National Semiconductor, where he continued to innovate in analog technology. He introduced several key components, such as the Widlar current source and the bandgap voltage reference, which became industry standards and remain widely used today.\n\nIn May 1968, Fairchild introduced the $\\mu \\mathrm{A} 741$, the first op amp with internal frequency compensation. Earlier op amps needed external components for this purpose. By integrating this function onto the chip, the 741 simplified usage, eliminating the need for users to deal with complex frequency compensation issues, thereby broadening the market for both experts and beginners. Despite the development of numerous other op amp families since then, the 741 remains the most extensively documented and includes fundamental components common to many modern analog ICs. Therefore, it is beneficial to begin the chapter by examining this device, both historically and pedagogically.\n\nCHAPTER HIGHLIGHTS\n\nAfter a thorough analysis of the classic 741 op amp, focusing on common nonidealities and limitations, the chapter explores the two most prevalent CMOS op amp configurations today: the two-stage and the folded-cascode types. (These three op amp categories are revisited in Chapter 6, where their frequency and time responses are examined, and in Chapter 7, where their stability in negative-feedback operation is discussed.)\n\nThe chapter then shifts to voltage comparators, another significant category of analog ICs. It covers both bipolar and CMOS varieties, including those with hysteresis. (Their transient responses are analyzed in Chapter 6.)\n\nNearly every IC requires internal circuitry to bias its transistors. Additionally, applications like instrumentation and measurement necessitate stable and predictable current and voltage references. This section addresses such circuits, including bandgap references for both bipolar and CMOS ICs.\n\nInterestingly, while the engineering field has traditionally favored voltage manipulation, current manipulation is inherently faster. Despite technological delays, current-mode ICs are now widely used alongside voltage-mode counterparts. This chapter discusses circuits such as transconductors, current conveyors (CCs), operational transconductance amplifiers (OTAs), current feedback amplifiers (CFAs), and Gilbert Cells.\n\nIn contemporary mixed-mode ICs, where analog and digital circuits coexist in noisy environments with low-power supplies, much of the signal processing and transmission is done in fully differential form. The chapter examines some of the most common fully differential op amps in use today.\n\nThe need to integrate analog and digital functions on a single chip has led to the reimagining of traditional analog functions using CMOS switches and capacitors, the most accessible components in today's digital technology. The chapter concludes with a discussion of switched-capacitor techniques in applications like autozeroing and filtering. A brief exploration of the discrete-time nature of switched-capacitor integrators highlights their differences from continuous-time counterparts.\n\nThroughout the chapter, PSpice is extensively utilized both for displaying transfer curves and waveforms as a software oscilloscope and for verifying dc and ac hand calculations."
},
{
    "text": "Chapter Outline\n\n5.1 The $\\mu \\mathrm{A} 741$ Operational Amplifier 473\n5.2 The Two-Stage CMOS Operational Amplifier 487\n5.3 The Folded-Cascode CMOS Operational Amplifier 495\n5.4 Voltage Comparators 501\n5.5 Current and Voltage References 510\n5.6 Current-Mode Integrated Circuits 521\n5.7 Fully Differential Operational Amplifiers 532\n5.8 Switched-Capacitor Circuits 541\n\nAppendix 5A: SPICE Macro-Models 553\nReferences 554\nProblems 554\n\nThe introduction of the integrated-circuit concept by Jack Kilby at Texas Instruments in 1958 and independently by Robert Noyce at Fairchild Semiconductor in 1959 sparked intense activity, leading to the creation of the first analog integrated circuits (ICs). These included the $\\mu \\mathrm{A} 702$ and $\\mu \\mathrm{A} 709$ operational amplifiers, the $\\mu \\mathrm{A} 710$ voltage comparator, and the $\\mu \\mathrm{A} 723$ voltage regulator. These devices were designed in the early 1960s by Robert J. Widlar (1937-1991) while at Fairchild. (He later moved to National Semiconductor, where he continued to innovate in analog products.) Widlar developed several key components, such as the Widlar current source and the bandgap voltage reference, which became industry standards and remain widely used today.\n\nIn May 1968, Fairchild introduced the $\\mu \\mathrm{A} 741$, the first op amp with internal frequency compensation. Earlier op amps needed external components for this purpose. By integrating this function onto the chip, the 741 simplified the user experience, eliminating the need to deal with complex frequency compensation issues, thus broadening the market for both experts and beginners. Despite the development of numerous other op amp families since then, the 741 remains the most extensively documented op amp and includes fundamental components common to many modern analog ICs. Therefore, it is beneficial to begin the chapter by examining this device, both historically and pedagogically.\n\nCHAPTER HIGHLIGHTS\n\nAfter a thorough analysis of the classic 741 op amp, focusing on common nonidealities and limitations, the chapter shifts to the two most prevalent CMOS op amp configurations today: the two-stage and the folded-cascode types. (These three op amp categories are revisited in Chapter 6, where their frequency and time responses are examined, and in Chapter 7, where their stability in negative-feedback operation is discussed.)\n\nThe chapter then addresses voltage comparators, another widely used category of analog ICs. Both bipolar and CMOS varieties are covered, including those with hysteresis. (Their transient responses are explored in Chapter 6.)\n\nNearly every IC requires appropriate circuitry to internally bias its transistors. Additionally, applications like instrumentation and measurement demand stable and predictable current and voltage references. This section covers such circuits, including bandgap-reference types for both bipolar and CMOS ICs.\n\nInterestingly, while the engineering field has traditionally favored voltage manipulation, current manipulation is inherently faster. Despite delays due to technological factors, current-mode ICs are now widely used alongside their voltage-mode counterparts. This chapter discusses circuits such as transconductors, current conveyors (CCs), operational transconductance amplifiers (OTAs), current feedback amplifiers (CFAs), and Gilbert Cells.\n\nIn contemporary mixed-mode ICs, where sensitive analog circuits must coexist with digital circuits in noisy environments and with low-power supplies, much of the signal processing and transmission is done in fully differential form. The chapter examines some of the most common fully differential op amps in use today.\n\nThe need to integrate analog and digital functions on a single chip necessitates reinterpreting traditional analog functions using CMOS switches and capacitors, the most readily available components in today's dominant digital technology. The chapter concludes with an exploration of switched-capacitor techniques in two typical applications: autozeroing and filtering. A brief discussion on the discrete-time nature of switched-capacitor integrators highlights their differences from their continuous-time counterparts.\n\nThroughout the chapter, PSpice is extensively utilized both as a software oscilloscope for displaying transfer curves and waveforms, and as a tool for verifying dc and ac hand calculations."
},
{
    "text": "Chapter Outline\n\n5.1 The $\\mu \\mathrm{A} 741$ Operational Amplifier 473\n5.2 The Two-Stage CMOS Operational Amplifier 487\n5.3 The Folded-Cascode CMOS Operational Amplifier 495\n5.4 Voltage Comparators 501\n5.5 Current and Voltage References 510\n5.6 Current-Mode Integrated Circuits 521\n5.7 Fully Differential Operational Amplifiers 532\n5.8 Switched-Capacitor Circuits 541\n\nAppendix 5A: SPICE Macro-Models 553\nReferences 554\nProblems 554\n\nThe introduction of the integrated-circuit concept by Jack Kilby at Texas Instruments in 1958 and independently by Robert Noyce at Fairchild Semiconductor in 1959 sparked intense activity, culminating in the creation of the first analog integrated circuits (ICs), including the $\\mu \\mathrm{A} 702$ and $\\mu \\mathrm{A} 709$ operational amplifiers, the $\\mu \\mathrm{A} 710$ voltage comparator, and the $\\mu \\mathrm{A} 723$ voltage regulator. These devices were designed in the early 1960s by Robert J. Widlar (1937-1991) during his tenure at Fairchild. (He later moved to National Semiconductor, where he continued to innovate in analog technology.) Widlar developed several key components, such as the Widlar current source and the bandgap voltage reference, which became industry standards and remain widely used today.\n\nIn May 1968, Fairchild introduced the $\\mu \\mathrm{A} 741$, the first op amp with internal frequency compensation. Earlier op amps necessitated external components for this purpose. By integrating this function onto the chip, the 741 simplified usage, eliminating the need for users to manage the complex issue of frequency compensation, thus broadening its market appeal to both experts and novices. Despite the development of numerous other op amp families since then, the 741 remains the most extensively documented and contains fundamental components common to many modern analog ICs. Therefore, it is prudent to begin the chapter by examining this device, both historically and pedagogically.\n\nCHAPTER HIGHLIGHTS\n\nAfter a thorough analysis of the classic 741 op amp, focusing on common nonidealities and limitations, the chapter shifts to the two most prevalent CMOS op amp configurations today: the two-stage and the folded-cascode types. (These three op amp categories are revisited in Chapter 6, where their frequency and time responses are explored, and in Chapter 7, where their stability in negative-feedback operation is examined.)\n\nThe discussion then moves to voltage comparators, another widely used category of analog ICs. Both bipolar and CMOS versions are covered, including those with hysteresis. (Their transient responses are analyzed in Chapter 6.)\n\nNearly every IC requires appropriate circuitry to internally bias its transistors. Additionally, applications like instrumentation and measurement demand stable and predictable current and voltage references. This section addresses such circuits, including bandgap-reference types for both bipolar and CMOS ICs.\n\nInterestingly, while the engineering field has traditionally preferred voltage manipulation, current manipulation is inherently faster. Despite technological delays, current-mode ICs are now widely used alongside voltage-mode counterparts. This chapter covers circuits such as transconductors, current conveyors (CCs), operational transconductance amplifiers (OTAs), current feedback amplifiers (CFAs), and Gilbert Cells.\n\nIn contemporary mixed-mode ICs, where sensitive analog circuits must coexist with digital circuits in noisy environments and with low-power supplies, much of the signal processing and transmission is done in fully differential form. The chapter explores some of the most common fully differential op amps in current use.\n\nThe need to integrate analog and digital functions on a single chip necessitates reinterpreting traditional analog functions using CMOS switches and capacitors, the most readily available components in today's dominant digital technology. The chapter concludes with an examination of switched-capacitor techniques in two typical applications: autozeroing and filtering. A concise discussion of the discrete-time nature of switched-capacitor integrators highlights their differences from continuous-time counterparts.\n\nThroughout the chapter, PSpice is extensively utilized both as a software oscilloscope for displaying transfer curves and waveforms, and as a tool for verifying dc and ac hand calculations."
},
{
    "text": "Chapter Outline\n\n5.1 The $\\mu \\mathrm{A} 741$ Operational Amplifier 473\n5.2 The Two-Stage CMOS Operational Amplifier 487\n5.3 The Folded-Cascode CMOS Operational Amplifier 495\n5.4 Voltage Comparators 501\n5.5 Current and Voltage References 510\n5.6 Current-Mode Integrated Circuits 521\n5.7 Fully Differential Operational Amplifiers 532\n5.8 Switched-Capacitor Circuits 541\n\nAppendix 5A: SPICE Macro-Models 553\nReferences 554\nProblems 554\n\nThe invention of the integrated-circuit concept by Jack Kilby at Texas Instruments in 1958 and independently by Robert Noyce at Fairchild Semiconductor in 1959 sparked intense activity, leading to the creation of the first analog integrated circuits (ICs), such as the $\\mu \\mathrm{A} 702$ and $\\mu \\mathrm{A} 709$ operational amplifiers, the $\\mu \\mathrm{A} 710$ voltage comparator, and the $\\mu \\mathrm{A} 723$ voltage regulator. These devices were designed in the early 1960s by Robert J. Widlar (1937-1991) during his tenure at Fairchild. (He later moved to National Semiconductor, where he continued to innovate in analog technology.) Widlar developed several key components, including the Widlar current source and the bandgap voltage reference, which became industry standards and remain widely used today.\n\nIn May 1968, Fairchild introduced the $\\mu \\mathrm{A} 741$, the first op amp with internal frequency compensation. Earlier op amps necessitated external components for this purpose. By integrating this function onto the chip, the 741 simplified usage, eliminating the need for users to deal with the complex issue of frequency compensation, thereby broadening the market for both experts and beginners. Despite the development of numerous other op amp families since then, the 741 remains the most extensively documented op amp and incorporates fundamental building blocks common to many modern analog ICs. Therefore, it is beneficial to begin the chapter by examining this device, both historically and pedagogically.\n\nCHAPTER HIGHLIGHTS\n\nAfter a comprehensive analysis of the classic 741 op amp, focusing on common nonidealities and limitations, the chapter shifts to the two most prevalent CMOS op amp configurations today: the two-stage and the folded-cascode types. (These three op amp categories are revisited in Chapter 6, where their frequency and time responses are examined, and in Chapter 7, where their stability in negative-feedback operation is discussed.)\n\nThe chapter then addresses voltage comparators, another significant category of analog ICs. Both bipolar and CMOS variants are covered, including those with hysteresis. (Their transient responses are explored in Chapter 6.)\n\nNearly every IC requires appropriate circuitry to internally bias its transistors. Additionally, applications like instrumentation and measurement demand stable and predictable current and voltage references. This section delves into such circuits, including bandgap-reference types for both bipolar and CMOS ICs.\n\nInterestingly, while the engineering community has traditionally preferred voltage manipulation, current manipulation is inherently faster. Despite technological delays, current-mode ICs are now widely used alongside voltage-mode counterparts. The chapter discusses circuits such as transconductors, current conveyors (CCs), operational transconductance amplifiers (OTAs), current feedback amplifiers (CFAs), and Gilbert Cells.\n\nIn contemporary mixed-mode ICs, where sensitive analog circuits must coexist with digital circuits in noisy environments and with low-power supplies, much of the signal processing and transmission is done in fully differential form. The chapter examines some of the most common fully differential op amps in use today.\n\nThe need to integrate analog and digital functions on a single chip necessitates reinterpreting traditional analog functions using CMOS switches and capacitors, the most accessible components in today's dominant digital technology. The chapter concludes with an exploration of switched-capacitor techniques in two typical applications: autozeroing and filtering. A brief discussion on the discrete-time nature of switched-capacitor integrators highlights their differences from their continuous-time equivalents.\n\nThroughout the chapter, PSpice is extensively utilized both as a software oscilloscope for displaying transfer curves and waveforms, and as a tool for verifying dc and ac hand calculations."
},
{
    "text": "Chapter Outline\n\n5.1 The $\\mu \\mathrm{A} 741$ Operational Amplifier 473\n5.2 The Two-Stage CMOS Operational Amplifier 487\n5.3 The Folded-Cascode CMOS Operational Amplifier 495\n5.4 Voltage Comparators 501\n5.5 Current and Voltage References 510\n5.6 Current-Mode Integrated Circuits 521\n5.7 Fully Differential Operational Amplifiers 532\n5.8 Switched-Capacitor Circuits 541\n\nAppendix 5A: SPICE Macro-Models 553\nReferences 554\nProblems 554\n\nThe invention of the integrated-circuit concept by Jack Kilby at Texas Instruments in 1958 and independently by Robert Noyce at Fairchild Semiconductor in 1959 sparked intense activity, leading to the creation of the first analog integrated circuits (ICs), such as the $\\mu \\mathrm{A} 702$ and $\\mu \\mathrm{A} 709$ operational amplifiers, the $\\mu \\mathrm{A} 710$ voltage comparator, and the $\\mu \\mathrm{A} 723$ voltage regulator. These devices were designed in the early 1960s by Robert J. Widlar (1937-1991) during his tenure at Fairchild. (He later joined National Semiconductor, where he continued to pioneer significant analog products.) Widlar developed several key components, including the Widlar current source and the bandgap voltage reference, which became industry standards and remain widely used today.\n\nIn May 1968, Fairchild introduced the $\\mu \\mathrm{A} 741$, the first op amp with internal frequency compensation. Earlier op amps necessitated external components for this purpose. By integrating this function onto the chip, the 741 simplified usage, eliminating the need for users to deal with the complex issue of frequency compensation, thereby broadening its market appeal to both experts and beginners. Despite the development of numerous other op amp families since then, the 741 remains the most extensively documented op amp and incorporates fundamental components common to many modern analog ICs. Therefore, it is prudent to begin the chapter by examining this device, both historically and pedagogically.\n\nCHAPTER HIGHLIGHTS\n\nAfter a thorough analysis of the classic 741 op amp, focusing on common nonidealities and limitations, the chapter shifts to the two predominant CMOS op amp architectures in current use: the two-stage and the folded-cascode types. (These three op amp categories are revisited in Chapter 6, where their frequency and time responses are examined, and in Chapter 7, where their stability in negative-feedback configurations is discussed.)\n\nThe chapter then addresses voltage comparators, another widely used category of analog ICs. Both bipolar and CMOS variants are covered, including those with hysteresis. (Their transient responses are explored in Chapter 6.)\n\nNearly every IC requires appropriate circuitry to internally bias its transistors. Additionally, applications like instrumentation and measurement necessitate stable and predictable current and voltage references. This section delves into such circuits, including bandgap-reference types for both bipolar and CMOS ICs.\n\nInterestingly, while the engineering field has traditionally favored voltage manipulation, current manipulation is inherently faster. Despite delays due to technological constraints, current-mode ICs are now extensively used alongside their voltage-mode counterparts. The chapter discusses circuits such as transconductors, current conveyors (CCs), operational transconductance amplifiers (OTAs), current feedback amplifiers (CFAs), and Gilbert Cells.\n\nIn contemporary mixed-mode ICs, where sensitive analog circuits must coexist with digital circuits in noisy environments and with low-power supplies, much of the signal processing and transmission is performed in fully differential form. The chapter examines some of the most prevalent fully differential op amps in use today.\n\nThe need to integrate analog and digital functions on a single chip necessitates reinterpreting traditional analog functions using CMOS switches and capacitors, the most readily available components in today's dominant digital technology. The chapter concludes with an exploration of switched-capacitor techniques in two typical applications: autozeroing and filtering. A concise discussion of the discrete-time nature of switched-capacitor integrators highlights their differences from their continuous-time equivalents.\n\nThroughout the chapter, PSpice is extensively utilized both as a software oscilloscope for displaying transfer curves and waveforms, and as a tool for verifying dc and ac hand calculations."
},
{
    "text": "Chapter Outline\n\n5.1 The $\\mu \\mathrm{A} 741$ Operational Amplifier 473\n5.2 The Two-Stage CMOS Operational Amplifier 487\n5.3 The Folded-Cascode CMOS Operational Amplifier 495\n5.4 Voltage Comparators 501\n5.5 Current and Voltage References 510\n5.6 Current-Mode Integrated Circuits 521\n5.7 Fully Differential Operational Amplifiers 532\n5.8 Switched-Capacitor Circuits 541\n\nAppendix 5A: SPICE Macro-Models 553\nReferences 554\nProblems 554\n\nThe development of the integrated-circuit concept by Jack Kilby at Texas Instruments in 1958 and independently by Robert Noyce at Fairchild Semiconductor in 1959 sparked intense activity, leading to the creation of the first analog integrated circuits (ICs). These included the $\\mu \\mathrm{A} 702$ and $\\mu \\mathrm{A} 709$ operational amplifiers, the $\\mu \\mathrm{A} 710$ voltage comparator, and the $\\mu \\mathrm{A} 723$ voltage regulator. These devices were designed in the early 1960s by Robert J. Widlar (1937-1991) while at Fairchild. (He later moved to National Semiconductor, where he continued to innovate in analog products.) Widlar developed several key components, such as the Widlar current source and the bandgap voltage reference, which became industry standards and remain widely used today.\n\nIn May 1968, Fairchild introduced the $\\mu \\mathrm{A} 741$, the first op amp with internal frequency compensation. Earlier op amps required external components for this purpose. By integrating this function onto the chip, the 741 simplified usage, eliminating the need for users to deal with complex frequency compensation issues, thus broadening the market for both experts and beginners. Despite the development of numerous other op amp families since then, the 741 remains the most extensively documented and includes fundamental components common to many modern analog ICs. Therefore, it is beneficial to begin the chapter by examining this device, both historically and pedagogically.\n\nCHAPTER HIGHLIGHTS\n\nAfter a detailed examination of the classic 741 op amp, focusing on common nonidealities and limitations, the chapter shifts to the two most prevalent CMOS op amp configurations today: the two-stage and the folded-cascode types. (These three op amp categories are revisited in Chapter 6, where their frequency and time responses are analyzed, and in Chapter 7, where their stability in negative-feedback operation is explored.)\n\nThe discussion then moves to voltage comparators, another significant category of analog ICs. Both bipolar and CMOS versions are covered, including those with hysteresis. (Their transient responses are examined in Chapter 6.)\n\nNearly every IC requires internal circuitry to bias its transistors. Additionally, applications like instrumentation and measurement demand stable and predictable current and voltage references. This section addresses such circuits, including bandgap references for both bipolar and CMOS ICs.\n\nInterestingly, while the engineering field has traditionally favored voltage manipulation, current manipulation is inherently faster. Despite technological delays, current-mode ICs are now widely used alongside voltage-mode counterparts. This chapter covers circuits such as transconductors, current conveyors (CCs), operational transconductance amplifiers (OTAs), current feedback amplifiers (CFAs), and Gilbert Cells.\n\nIn contemporary mixed-mode ICs, where analog and digital circuits coexist in noisy environments with low-power supplies, much of the signal processing and transmission is done in fully differential form. The chapter explores some of the most common fully differential op amps in use today.\n\nThe need to integrate analog and digital functions on a single chip necessitates reinterpreting traditional analog functions using CMOS switches and capacitors, the most accessible components in today's dominant digital technology. The chapter concludes with an examination of switched-capacitor techniques in autozeroing and filtering applications. A brief discussion on the discrete-time nature of switched-capacitor integrators highlights their differences from continuous-time counterparts.\n\nThroughout the chapter, PSpice is extensively utilized both for displaying transfer curves and waveforms as a software oscilloscope and for verifying dc and ac hand calculations."
},
{
    "text": "The 741 operational amplifier features several ingenious design concepts that remain widely utilized even today. As the most extensively documented analog integrated circuit, it provides students with a wealth of resources for studying general analog design techniques.\n\nIllustrated in Fig. 5.1 is the circuit schematic of the $\\mu \\mathrm{A} 741$ op amp, as originally released by Fairchild Semiconductor, its initial manufacturer (the 741 has been reproduced by nearly every analog IC manufacturer, so slight variations may be found in different sources). Comprising two dozen bipolar junction transistors (BJTs), a dozen resistors, and a capacitor, this complexity can be daunting for beginners.\nimage_name: Figure 5.1\ndescription: This diagram depicts the internal schematic of the μA741 operational amplifier, featuring a differential input stage, gain stage, and output stage. The circuit utilizes numerous NPN and PNP transistors, resistors, and a compensation capacitor to achieve its function. The power supply connections are labeled VCC and VEE, with the output denoted as Vout.\n\nFIGURE 5.1 Circuit schematic of the 741 op amp. (Courtesy of Fairchild Semiconductor Corporation.)\nHowever, the recommended approach is not to attempt to comprehend the entire circuit simultaneously, but rather to identify and analyze familiar subcircuits individually. A thorough understanding of these components is essential before tackling the circuit as a whole. To aid this process, it is helpful to redraw the circuit in a simplified manner, focusing on the key elements and deferring the finer details. This simplified version is presented in Fig. 5.2, and readers are encouraged to compare it with the original schematic in Fig. 5.1 before proceeding."
},
{
    "text": "The 741 operational amplifier embodies numerous ingenious design concepts that remain widely utilized even today. As the most extensively documented analog integrated circuit, it provides students with a wealth of resources for consulting and serves as an effective tool for mastering general analog design techniques.\n\nIllustrated in Fig. 5.1 is the circuit schematic of the $\\mu \\mathrm{A} 741$ op amp, as originally presented by Fairchild, its initial manufacturer (since the 741 has been reproduced by nearly every analog IC manufacturer, minor variations may be encountered in different sources). Featuring approximately two dozen bipolar junction transistors (BJTs), a dozen resistors, and a capacitor, beginners might understandably feel overwhelmed. However, the recommended approach is not to attempt comprehending the entire circuit in one go, but to pinpoint familiar subcircuits and analyze them separately. A comprehensive understanding of the circuit can only be achieved after grasping its individual components. To aid this process, it is helpful to redraw the circuit in a simplified manner, emphasizing key elements and deferring intricate details. This results in the schematic shown in Fig. 5.2, which readers are advised to compare with the original in Fig. 5.1 before proceeding.\n\nimage_name: Figure 5.1\ndescription: The diagram depicts the internal schematic of the μA741 operational amplifier, comprising a differential input stage, gain stage, and output stage. It utilizes multiple NPN and PNP transistors, resistors, and a compensation capacitor to achieve its functionality. The power supply nodes are identified as VCC and VEE, with the output labeled Vout.\n\nFIGURE 5.1 Circuit schematic of the 741 op amp. (Courtesy of Fairchild Semiconductor Corporation.)"
},
{
    "text": "The 741 operational amplifier integrates several ingenious design concepts that remain widely utilized even today. As the most extensively documented analog integrated circuit, it provides students with numerous resources to consult and serves as an effective tool for learning general analog design techniques.\n\nIllustrated in Fig. 5.1 is the circuit schematic of the $\\mu \\mathrm{A} 741$ op amp, as originally provided by Fairchild, its initial manufacturer (since the 741 has been reproduced by nearly every analog IC manufacturer, slight variations may be found in different sources). Featuring approximately two dozen BJTs, a dozen resistors, and a capacitor, beginners may understandably feel overwhelmed. However, the recommended approach is not to attempt to comprehend the entire circuit at once, but to identify and analyze familiar subcircuits individually. A comprehensive understanding of the circuit can only be achieved after grasping its individual components. To aid this process, it is helpful to redraw the circuit in a simplified manner, emphasizing the key elements and postponing the finer details for later study. This results in the schematic shown in Fig. 5.2, which readers are advised to compare with the original in Fig. 5.1 before proceeding."
},
{
    "text": "The 741 operational amplifier incorporates various innovative design concepts that remain widely utilized even today. As the most extensively documented analog integrated circuit, it provides students with numerous resources for studying general analog-design techniques.\n\nIllustrated in Fig. 5.1 is the circuit schematic of the $\\mu \\mathrm{A} 741$ op amp, as originally provided by Fairchild Semiconductor, its initial manufacturer (since the 741 has been produced by nearly every analog IC manufacturer, slight variations may be found in different literature). Featuring two dozen bipolar junction transistors (BJTs), a dozen resistors, and a capacitor, beginners might understandably feel overwhelmed. However, the correct strategy is not to attempt to comprehend the entire circuit at once, but to identify and analyze familiar subcircuits individually. A thorough understanding of these components is essential before tackling the entire circuit. To aid this process, it is helpful to redraw the circuit in a simplified manner, focusing on the key elements and postponing the finer details. This simplified version is presented in Fig. 5.2, which readers are advised to compare with the original in Fig. 5.1 before proceeding."
},
{
    "text": "The 741 operational amplifier features numerous ingenious design concepts that remain widely utilized even today. As the most extensively documented analog integrated circuit, it provides students with a wealth of resources for learning general analog design techniques.\n\nIllustrated in Fig. 5.1 is the circuit schematic of the $\\mu \\mathrm{A} 741$ op amp, as originally supplied by Fairchild Semiconductor, its initial manufacturer (the 741 has been replicated by nearly every analog IC manufacturer, leading to slight variations in the literature). Comprising two dozen bipolar junction transistors (BJTs), a dozen resistors, and a capacitor, beginners may understandably feel overwhelmed. However, the correct strategy is not to attempt to comprehend the entire circuit at once, but to identify and analyze familiar subcircuits individually. Only after grasping its components can one hope to understand the circuit as a whole. To aid this process, it is helpful to redraw the circuit in a simplified manner, emphasizing the key elements and deferring the finer points. This results in the schematic shown in Fig. 5.2, which readers are advised to compare with the original in Fig. 5.1 before proceeding."
},
{
    "text": "The 741 operational amplifier integrates several ingenious design concepts that remain extensively utilized today. As the most extensively documented analog integrated circuit, it provides students with a plethora of resources for learning general analog design techniques.\n\nIllustrated in Fig. 5.1 is the circuit schematic of the $\\mu \\mathrm{A} 741$ op amp, as originally provided by Fairchild Semiconductor, its initial manufacturer (the 741 has been replicated by nearly every analog IC manufacturer, leading to slight variations in documented schematics). Featuring approximately two dozen bipolar junction transistors (BJTs), a dozen resistors, and a capacitor, beginners may understandably feel overwhelmed. However, the correct strategy is not to attempt to comprehend the entire circuit simultaneously but to identify and analyze familiar subcircuits individually. A comprehensive understanding of the circuit can only be achieved after grasping its components. To simplify this process, it is advisable to redraw the circuit in a more streamlined form, focusing on the key elements and deferring the finer details. This approach results in the schematic shown in Fig. 5.2, which readers are encouraged to compare with the original in Fig. 5.1 before proceeding."
},
{
    "text": "The 741 operational amplifier integrates several ingenious design concepts that remain widely utilized today. As the most extensively documented analog integrated circuit, it provides students with numerous resources for learning general analog-design techniques.\n\nIllustrated in Fig. 5.1 is the circuit schematic of the $\\mu \\mathrm{A} 741$ op amp, as originally provided by Fairchild, its initial manufacturer (the 741 has been reproduced by nearly all analog IC manufacturers, leading to slight variations in the literature). Featuring two dozen bipolar junction transistors (BJTs), a dozen resistors, and a capacitor, beginners might understandably feel overwhelmed. However, the recommended approach is not to attempt to comprehend the entire circuit at once, but to identify and analyze familiar subcircuits individually. Only after grasping its components can one effectively tackle the entire circuit. To aid this process, it is helpful to redraw the circuit in a simplified manner, focusing on the essential elements and deferring the finer details. This results in the schematic shown in Fig. 5.2, which readers should compare to the original in Fig. 5.1 before proceeding."
},
{
    "text": "The 741 operational amplifier integrates several innovative design concepts that remain widely utilized today. As the most extensively documented analog integrated circuit, it provides students with numerous resources to consult and serves as an effective tool for learning general analog design techniques.\n\nIllustrated in Fig. 5.1 is the circuit schematic of the $\\mu \\mathrm{A} 741$ op amp, as originally presented by Fairchild, its initial manufacturer (since the 741 has been reproduced by nearly every analog IC manufacturer, slight variations may be found in the literature). Comprising two dozen bipolar junction transistors, a dozen resistors, and a capacitor, beginners may understandably feel overwhelmed. However, the appropriate strategy is not to attempt to comprehend the entire circuit at once, but rather to identify and analyze familiar subcircuits individually. Only after grasping its individual components can one hope to understand the circuit as a whole. To aid this process, it is helpful to redraw the circuit in a simplified manner, emphasizing key elements while deferring the finer details. This results in the schematic shown in Fig. 5.2, which readers are advised to compare with the original in Fig. 5.1 before proceeding."
},
{
    "text": "With reference to Fig. 5.2, we make the following observations:\n\n- Beginning at the lower left, we identify the current mirror $Q_{5} Q_{6}$ as forming an active load for the CB pnp pair $Q_{3}-Q_{4}$. Typically, this pair would be of the EC type, but here it is not, due to the notoriously low betas of lateral pnp BJTs. Op amps are designed to draw minimal currents at the input terminals. To minimize these currents, the pnp pair $Q_{3}-Q_{4}$ operates in the CB mode, and the $v_{P}$ and $v_{N}$ inputs are buffered through the CC pair\nimage_name:FIGURE 5.2 Simplified circuit schematic of the 741 op amp.\ndescription:This simplified schematic of the 741 operational amplifier features a differential input stage with active load, a current mirror, and a Darlington-type output stage. The design prioritizes the performance of NPN transistors because of their higher beta compared to PNP transistors.\n\nFIGURE 5.2 Simplified circuit schematic of the 741 op amp.\n$Q_{1}-Q_{2}$. Since the bipolar process utilized optimizes npn BJTs, $Q_{1}$ and $Q_{2}$ exhibit much higher betas than their pnp counterparts, resulting in significantly lower base currents. Thus, we identify our first subcircuit: a differential-input, single-ended-output amplifier stage composed of two CC-CB halves and a current-mirror load.\n\n- Progressing to the right, we encounter a Darlington-type stage consisting of the CC-CE pair $Q_{16} Q_{17}$. The role of the CE amplifier $Q_{17}$ is to provide additional gain, while the CC buffer $Q_{16}$ offers high input resistance to prevent excessive loading of the first stage. (Figure 5.1 also shows a capacitance $C_{c}$ between this stage's input and output terminals. Its purpose is to stabilize the op amp against potential oscillations, a topic to be explored at the end of Chapter 7. The current analysis is confined to low frequencies, where $C_{c}$ acts as an open circuit and will therefore be disregarded.)\n- Continuing further right, we discover another CC buffer, $Q_{22}$, whose role is to reduce the loading on $Q_{17}$. The emitter network of $Q_{22}$ includes the pair $Q_{18^{-}} Q_{19}$ to provide the necessary $p n$-junction voltage drops for biasing the Class AB push-pull pair $Q_{14}-Q_{20}$ that forms the output stage. The overload protection circuitry has been excluded here to focus solely on the essentials, with details to be addressed later.\n- It is logical to view the 741 op amp as a cascade of three stages, as illustrated in the block diagram of Fig. 5.3. (Indeed, many op amps follow a similar three-stage configuration.) One additional consideration is necessary: for proper functioning, all active transistors must operate in the forward-active region, necessitating a fourth subcircuit to appropriately bias the aforementioned stages. In Fig. 5.1, this subcircuit comprises the current-mirror pairs $Q_{8}{ }^{-} Q_{9}, Q_{10}-Q_{11}$, and $Q_{12}-Q_{13}$.\nimage_name:Figure 5.3 Block diagram of the 741 op amp\ndescription:The block diagram of the 741 operational amplifier includes three main stages and a DC bias circuitry.\n\n1. **Main Components:**\n- **Stage I:** This input differential amplifier stage accepts two inputs, labeled \\( v_P \\) (non-inverting) and \\( v_N \\) (inverting), and delivers an amplified differential output. This stage is critical for initial amplification and common-mode rejection.\n- **Stage II:** This intermediate gain stage further amplifies the signal from Stage I. It primarily contributes to the voltage gain.\n- **Stage III:** This output stage receives the signal from Stage II and provides the required current to drive the load at the output \\( v_O \\). It is designed for low output impedance and high current drive capability.\n- **DC Bias Circuitry:** This block ensures the necessary bias currents and voltages for all transistors to operate in their active regions. It connects to all three stages, ensuring proper operation and stability.\n\n2. **Flow of Information or Control:**\n- The signal flow starts at the input of Stage I, where the differential input \\( v_P - v_N \\) is amplified.\n- The amplified signal then moves to Stage II for further amplification.\n- Finally, the signal reaches Stage III, where it is conditioned to effectively drive the output \\( v_O \\).\n- The DC bias circuitry provides feedback to each stage, maintaining proper transistor biasing.\n\n3. **Labels, Annotations, and Key Indicators:**\n- Inputs are labeled \\( v_P \\) and \\( v_N \\), with the output labeled \\( v_O \\).\n- Each stage is numbered I, II, and III, indicating the signal processing sequence.\n- The DC bias circuitry is clearly marked and shown connected to all stages.\n\n4. **Overall System Function:**\n- This block diagram's primary function is to depict the internal structure and signal flow of the 741 operational amplifier. The arrangement of the three stages, along with the DC bias circuitry, enables the amplification of the input differential signal to produce a high-gain output suitable for driving loads. The bias circuitry ensures efficient and stable operation across various conditions.\n\nFIGURE 5.3 Block diagram of the 741 op amp.\n\nThe primary goal of this section is to determine the gain $a$ of the 741 op amp, along with its small-signal input and output resistances. These calculations involve parameters like $g_{m}, r_{\\pi}$, and $r_{o}$, all of which depend on dc bias conditions. Therefore, we must first establish the dc operating point of each relevant transistor before conducting any ac analysis. We will address this for each stage individually. By the end of this process, our initial apprehension should significantly diminish."
},
{
    "text": "With reference to Fig. 5.2, we make the following observations:\n\n- Beginning at the lower left, we identify the current mirror $Q_{5} Q_{6}$ as forming an active load for the CB pnp pair $Q_{3}-Q_{4}$. Typically, this pair would be of the EC type, but due to the low betas of lateral pnp BJTs, it is not in this case. Op amps are designed to draw minimal currents at the input terminals, so to reduce these currents, the pnp pair $Q_{3}-Q_{4}$ operates in the CB mode, with the $v_{P}$ and $v_{N}$ inputs buffered via the CC pair\nimage_name:FIGURE 5.2 Simplified circuit schematic of the 741 op amp.\ndescription:This is a simplified schematic of the 741 operational amplifier, featuring a differential input stage with active load, a current mirror, and a Darlington-type output stage. The design optimizes NPN transistor performance due to their higher beta compared to PNP transistors.\n\nFIGURE 5.2 Simplified circuit schematic of the 741 op amp.\n$Q_{1}-Q_{2}$. Since the bipolar process used optimizes npn BJTs, $Q_{1}$ and $Q_{2}$ have much higher betas than their pnp counterparts, resulting in lower base currents. Thus, we identify our first subcircuit: a differential-input, single-ended-output amplifier stage comprising two CC-CB halves and a current-mirror load.\n\n- Moving to the right, we identify a Darlington-type stage consisting of the CC-CE pair $Q_{16} Q_{17}$. The role of the CE amplifier $Q_{17}$ is to provide additional gain, while the CC buffer $Q_{16}$ offers high input resistance to prevent excessive loading of the first stage. (Figure 5.1 also shows a capacitance $C_{c}$ between this stage's input and output terminals. Its purpose is to stabilize the op amp against potential oscillations, a topic to be explored at the end of Chapter 7. The current analysis is limited to low frequencies, where $C_{c}$ acts as an open circuit and will therefore be ignored.)\n- Proceeding further to the right, we encounter another CC buffer, $Q_{22}$, whose role is to reduce the loading on $Q_{17}$. The emitter network of $Q_{22}$ includes the pair $Q_{18^{-}} Q_{19}$ to provide the necessary $p n$-junction voltage drops for biasing the Class AB push-pull pair $Q_{14}-Q_{20}$ in the output stage. The overload protection circuitry is omitted here to focus on the essentials, with details to be addressed later.\n- It is logical to view the 741 op amp as a cascade of three stages, as depicted in the block diagram in Fig. 5.3. (Indeed, many op amps follow a similar three-stage configuration.) One additional consideration is necessary: for proper functioning, all active transistors must operate in the forward-active region, necessitating a fourth subcircuit to appropriately bias the mentioned stages. In Fig. 5.1, this subcircuit consists of the current-mirror pairs $Q_{8}{ }^{-} Q_{9}, Q_{10}-Q_{11}$, and $Q_{12}-Q_{13}$.\nimage_name:Figure 5.3 Block diagram of the 741 op amp\ndescription:The block diagram of the 741 operational amplifier comprises three main stages and a DC bias circuitry.\n\n1. **Main Components:**\n- **Stage I:** This input differential amplifier stage accepts two inputs, labeled \\( v_P \\) (non-inverting) and \\( v_N \\) (inverting), and delivers an amplified differential output. This stage is critical for initial amplification and common-mode rejection.\n- **Stage II:** This intermediate gain stage further amplifies the signal from Stage I. It is primarily responsible for providing substantial voltage gain.\n- **Stage III:** This output stage receives the signal from Stage II and supplies the required current to drive the load at the output \\( v_O \\). It is designed for low output impedance and high current drive capability.\n- **DC Bias Circuitry:** This block ensures the necessary bias currents and voltages for all transistors to operate in their active regions. It connects to all three stages, ensuring proper operation and stability.\n\n2. **Flow of Information or Control:**\n- The signal begins at the input of Stage I, where the differential input \\( v_P - v_N \\) is amplified.\n- The amplified signal then moves to Stage II for further amplification.\n- Finally, the signal reaches Stage III, where it is conditioned to effectively drive the output \\( v_O \\).\n- The DC bias circuitry provides feedback to each stage, maintaining proper transistor biasing.\n\n3. **Labels, Annotations, and Key Indicators:**\n- Inputs are labeled \\( v_P \\) and \\( v_N \\), with the output labeled \\( v_O \\).\n- Each stage is numbered I, II, and III, indicating the sequence of signal processing.\n- The DC bias circuitry is clearly labeled and shown connected to all stages.\n\n4. **Overall System Function:**\n- The primary function of this block diagram is to illustrate the internal structure and signal flow of the 741 operational amplifier. The arrangement of the three stages, along with the DC bias circuitry, enables the amplification of the input differential signal to produce a high-gain output suitable for driving loads. The bias circuitry ensures efficient and stable operation across various conditions.\n\nFIGURE 5.3 Block diagram of the 741 op amp.\n\nThe main goal of this section is to determine the gain $a$ of the 741 op amp, along with its small-signal input and output resistances. These calculations involve parameters like $g_{m}, r_{\\pi}$, and $r_{o}$, all of which depend on dc bias conditions. Therefore, we must first determine the dc operating point of each relevant transistor before conducting any ac analysis. We will do this for each stage individually. By the end of this process, our initial intimidation should significantly diminish."
},
{
    "text": "With reference to Fig. 5.2, the following observations are made:\n\n- Beginning at the lower left, we recognize the current mirror $Q_{5} Q_{6}$ as serving as an active load for the CB pnp pair $Q_{3}-Q_{4}$. Typically, this pair would be of the EC type, but due to the low betas characteristic of lateral pnp BJTs, it operates in the CB mode instead. Op amps are designed to draw minimal input currents, so the pnp pair $Q_{3}-Q_{4}$ functions in the CB configuration, with the $v_{P}$ and $v_{N}$ inputs buffered through the CC pair\nimage_name:FIGURE 5.2 Simplified circuit schematic of the 741 op amp.\ndescription:This simplified schematic of the 741 operational amplifier features a differential input stage with an active load, a current mirror, and a Darlington-type output stage. The design prioritizes the performance of NPN transistors due to their superior beta compared to PNP transistors.\n\nFIGURE 5.2 Simplified circuit schematic of the 741 op amp.\n$Q_{1}-Q_{2}$. Given that the bipolar process optimizes npn BJTs, $Q_{1}$ and $Q_{2}$ exhibit higher betas than their pnp counterparts, resulting in lower base currents. This identifies our first subcircuit: a differential-input, single-ended-output amplifier stage comprising two CC-CB halves and a current-mirror load.\n\n- Progressing to the right, we identify a Darlington-type stage consisting of the CC-CE pair $Q_{16} Q_{17}$. The role of the CE amplifier $Q_{17}$ is to provide additional gain, while the CC buffer $Q_{16}$ offers high input resistance to prevent excessive loading of the first stage. (Figure 5.1 also depicts a capacitance $C_{c}$ between this stage's input and output terminals, which stabilizes the op amp against potential oscillations—a topic to be explored in Chapter 7. For now, our analysis focuses on low frequencies, where $C_{c}$ acts as an open circuit and can be disregarded.)\n- Continuing further right, we encounter another CC buffer, $Q_{22}$, which minimizes the loading on $Q_{17}$. The emitter network of $Q_{22}$ includes the pair $Q_{18^{-}} Q_{19}$ to provide the necessary $p n$-junction voltage drops for biasing the Class AB push-pull pair $Q_{14}-Q_{20}$ in the output stage. The overload protection circuitry is omitted here to emphasize the core elements, with details deferred to a later discussion.\n- It is logical to view the 741 op amp as a cascade of three stages, as illustrated in the block diagram of Fig. 5.3. (Indeed, many op amps follow a similar three-stage architecture.) An additional consideration is essential: for proper functioning, all active transistors must operate in the forward-active region, necessitating a fourth subcircuit for biasing the aforementioned stages. In Fig. 5.1, this subcircuit comprises the current-mirror pairs $Q_{8}{ }^{-} Q_{9}, Q_{10}-Q_{11}$, and $Q_{12}-Q_{13}$.\nimage_name:Figure 5.3 Block diagram of the 741 op amp\ndescription:The block diagram of the 741 operational amplifier features three main stages and DC bias circuitry.\n\n1. **Main Components:**\n- **Stage I:** This input differential amplifier stage processes two inputs, \\( v_P \\) (non-inverting) and \\( v_N \\) (inverting), to produce an amplified differential output. It is key for initial amplification and common-mode rejection.\n- **Stage II:** This intermediate gain stage further amplifies the signal from Stage I, contributing most of the voltage gain.\n- **Stage III:** This output stage receives the signal from Stage II and delivers the required current to drive the load at \\( v_O \\). It is designed for low output impedance and high current drive capability.\n- **DC Bias Circuitry:** This block ensures the necessary bias currents and voltages for active transistor operation, connecting to all three stages for stability and proper functioning.\n\n2. **Flow of Information or Control:**\n- The signal begins at Stage I, where the differential input \\( v_P - v_N \\) is amplified.\n- It then moves to Stage II for further amplification.\n- Finally, it reaches Stage III for conditioning to effectively drive the output \\( v_O \\).\n- The DC bias circuitry provides feedback to maintain proper transistor biasing.\n\n3. **Labels, Annotations, and Key Indicators:**\n- Inputs are labeled \\( v_P \\) and \\( v_N \\), with the output labeled \\( v_O \\).\n- Stages are numbered I, II, and III, indicating the signal processing sequence.\n- The DC bias circuitry is clearly marked and shown interconnected with all stages.\n\n4. **Overall System Function:**\n- This block diagram illustrates the internal structure and signal flow of the 741 operational amplifier. The three-stage arrangement, along with the DC bias circuitry, enables efficient amplification of the input differential signal to produce a high-gain output suitable for load driving. The bias circuitry ensures stable and efficient operation across various conditions.\n\nFIGURE 5.3 Block diagram of the 741 op amp.\n\nThe primary goal of this section is to determine the gain $a$ of the 741 op amp, as well as its small-signal input and output resistances. These calculations involve parameters like $g_{m}, r_{\\pi}$, and $r_{o}$, all of which depend on dc bias conditions. Therefore, we must first establish the dc operating points of the relevant transistors before conducting any ac analysis. This will be done for each stage individually. By the end of this process, the initial complexity should feel significantly reduced."
},
{
    "text": "With reference to Fig. 5.2, we make the following observations:\n\n- Beginning at the lower left, we recognize the current mirror $Q_{5} Q_{6}$ as providing an active load for the CB pnp pair $Q_{3}-Q_{4}$. Typically, this pair would be of the EC type, but here it is not, due to the notably low betas of lateral pnp BJTs. Op amps are designed to draw minimal input currents, so to reduce these currents, the pnp pair $Q_{3}-Q_{4}$ operates in CB mode, with the $v_{P}$ and $v_{N}$ inputs buffered by the CC pair $Q_{1}-Q_{2}$. Given that the bipolar process favors npn BJTs, $Q_{1}$ and $Q_{2}$ have significantly higher betas than their pnp counterparts, thus drawing lower base currents. This identifies our first subcircuit: a differential-input, single-ended-output amplifier stage comprising two CC-CB halves and a current-mirror load.\n\n- Progressing to the right, we identify a Darlington-type stage consisting of the CC-CE pair $Q_{16} Q_{17}$. The CE amplifier $Q_{17}$ serves to provide additional gain, while the CC buffer $Q_{16}$ offers high input resistance to prevent excessive loading of the first stage. (Figure 5.1 also shows a capacitance $C_{c}$ between this stage's input and output terminals, which stabilizes the op amp against potential oscillations—a topic to be explored in Chapter 7. For now, our analysis focuses on low frequencies, where $C_{c}$ acts as an open circuit and can be disregarded.)\n- Further to the right, we encounter another CC buffer, $Q_{22}$, which reduces the loading on $Q_{17}$. The emitter network of $Q_{22}$ includes the pair $Q_{18}-Q_{19}$ to provide the necessary $pn$-junction voltage drops for biasing the Class AB push-pull output pair $Q_{14}-Q_{20}$. The overload protection circuitry has been excluded here to emphasize the core elements, with details deferred to later discussions.\n- It is logical to view the 741 op amp as a series of three stages, as illustrated in the block diagram of Fig. 5.3. (Many op amps follow a similar three-stage configuration.) An additional consideration is essential: all active transistors must operate in the forward-active region, necessitating a fourth subcircuit to properly bias the mentioned stages. In Fig. 5.1, this subcircuit comprises the current-mirror pairs $Q_{8}-Q_{9}$, $Q_{10}-Q_{11}$, and $Q_{12}-Q_{13}$.\n\nThe primary goal of this section is to determine the gain $a$ of the 741 op amp, along with its small-signal input and output resistances. These calculations involve parameters like $g_{m}$, $r_{\\pi}$, and $r_{o}$, all of which depend on the dc bias. Therefore, we must first establish the dc operating point of each relevant transistor before conducting any ac analysis. We will address this for each stage individually. By the end of this process, our initial complexity should be significantly reduced."
},
{
    "text": "Referring to Fig. 5.2, we observe the following:\n\n- Beginning at the lower left, we recognize the current mirror $Q_{5} Q_{6}$ as providing an active load for the CB pnp pair $Q_{3}-Q_{4}$. Typically, this pair would be of the EC type, but here it is not, due to the low betas characteristic of lateral pnp BJTs. Op amps are designed to draw minimal input currents, so to reduce these currents, the pnp pair $Q_{3}-Q_{4}$ operates in CB mode, with the $v_{P}$ and $v_{N}$ inputs buffered by the CC pair\nimage_name:FIGURE 5.2 Simplified circuit schematic of the 741 op amp.\ndescription:This simplified schematic of the 741 operational amplifier features a differential input stage with active load, a current mirror, and a Darlington-type output stage. The design prioritizes NPN transistor performance due to their higher beta compared to PNP transistors.\n\nFIGURE 5.2 Simplified circuit schematic of the 741 op amp.\n$Q_{1}-Q_{2}$. Given that the bipolar process optimizes npn BJTs, $Q_{1}$ and $Q_{2}$ exhibit higher betas than their pnp counterparts, resulting in lower base currents. Thus, we identify our first subcircuit: a differential-input, single-ended-output amplifier stage composed of two CC-CB halves and a current-mirror load.\n\n- Progressing to the right, we identify a Darlington-type stage consisting of the CC-CE pair $Q_{16} Q_{17}$. The role of the CE amplifier $Q_{17}$ is to provide additional gain, while the CC buffer $Q_{16}$ offers high input resistance to prevent excessive loading of the first stage. (Figure 5.1 also shows a capacitance $C_{c}$ between this stage's input and output. Its purpose is to stabilize the op amp against potential oscillations, a topic explored in Chapter 7. For now, our analysis focuses on low frequencies, where $C_{c}$ acts as an open circuit and is thus disregarded.)\n- Further to the right, we encounter another CC buffer, $Q_{22}$, which minimizes the loading on $Q_{17}$. The emitter network of $Q_{22}$ includes the pair $Q_{18^{-}} Q_{19}$ to provide the necessary $p n$-junction voltage drops for biasing the Class AB push-pull pair $Q_{14}-Q_{20}$ in the output stage. The overload protection circuitry is omitted here to focus on the essentials, with details addressed later.\n- It is logical to view the 741 op amp as a series of three stages, as illustrated in the block diagram Fig. 5.3. (Many op amps follow a similar three-stage configuration.) One additional point is crucial: all active transistors must operate in the forward-active region, necessitating a fourth subcircuit to properly bias the stages. In Fig. 5.1, this subcircuit comprises the current-mirror pairs $Q_{8}{ }^{-} Q_{9}, Q_{10}-Q_{11}$, and $Q_{12}-Q_{13}$.\nimage_name:Figure 5.3 Block diagram of the 741 op amp\ndescription:The block diagram of the 741 operational amplifier features three main stages and DC bias circuitry.\n\n1. **Main Components:**\n- **Stage I:** This input differential amplifier stage accepts two inputs, \\( v_P \\) (non-inverting) and \\( v_N \\) (inverting), and delivers an amplified differential output. It is essential for initial amplification and common-mode rejection.\n- **Stage II:** This intermediate gain stage further amplifies the signal from Stage I, contributing most of the voltage gain.\n- **Stage III:** This output stage receives the signal from Stage II and provides the required current to drive the load at output \\( v_O \\). It is designed for low output impedance and high current drive capability.\n- **DC Bias Circuitry:** This block ensures the necessary bias currents and voltages for active transistor operation, connecting to all three stages for proper operation and stability.\n\n2. **Flow of Information or Control:**\n- The signal flow starts at Stage I, where the differential input \\( v_P - v_N \\) is amplified.\n- The amplified signal then moves to Stage II for further amplification.\n- Finally, the signal reaches Stage III, where it is prepared to drive the output \\( v_O \\) effectively.\n- The DC bias circuitry provides feedback to each stage, maintaining proper transistor biasing.\n\n3. **Labels, Annotations, and Key Indicators:**\n- Inputs are labeled \\( v_P \\) and \\( v_N \\), with the output labeled \\( v_O \\).\n- Each stage is numbered I, II, and III, indicating the signal processing sequence.\n- The DC bias circuitry is clearly labeled and shown connected to all stages.\n\n4. **Overall System Function:**\n- This block diagram illustrates the internal structure and signal flow of the 741 operational amplifier. The three-stage arrangement, along with the DC bias circuitry, enables the amplification of the input differential signal to produce a high-gain output suitable for driving loads. The bias circuitry ensures efficient and stable operation across various conditions.\n\nFIGURE 5.3 Block diagram of the 741 op amp.\n\nThe primary goal of this section is to determine the gain $a$ of the 741 op amp, along with its small-signal input and output resistances. These calculations involve parameters like $g_{m}, r_{\\pi}$, and $r_{o}$, all of which depend on dc bias conditions. Therefore, we must first establish the dc operating point of each relevant transistor before conducting any ac analysis. We will address each stage individually. By the end, our initial apprehension should notably diminish."
},
{
    "text": "Referring to Fig. 5.2, we note the following points:\n\n- Beginning at the lower left, we recognize the current mirror $Q_{5} Q_{6}$ as serving as an active load for the CB pnp pair $Q_{3}-Q_{4}$. Typically, this pair would be of the EC type, but here it is not, owing to the notoriously low betas of lateral pnp BJTs. Since op amps are designed to draw minimal currents at the input terminals, the pnp pair $Q_{3}-Q_{4}$ operates in the CB mode, and the $v_{P}$ and $v_{N}$ inputs are buffered through the CC pair\nimage_name:FIGURE 5.2 Simplified circuit schematic of the 741 op amp.\ndescription:This simplified schematic of the 741 operational amplifier features a differential input stage with active load, a current mirror, and a Darlington-type output stage. The design prioritizes the performance of NPN transistors due to their higher beta compared to PNP transistors.\n\nFIGURE 5.2 Simplified circuit schematic of the 741 op amp.\n$Q_{1}-Q_{2}$. Given that the bipolar process optimizes npn BJTs, $Q_{1}$ and $Q_{2}$ exhibit significantly higher betas than their pnp counterparts, thereby drawing much lower base currents. This identifies our first subcircuit: a differential-input, single-ended-output amplifier stage comprising two CC-CB halves and a current-mirror load.\n\n- Progressing to the right, we identify a Darlington-type stage consisting of the CC-CE pair $Q_{16} Q_{17}$. The role of the CE amplifier $Q_{17}$ is to provide additional gain, while the CC buffer $Q_{16}$ offers high input resistance to prevent excessive loading of the first stage. (Figure 5.1 also depicts a capacitance $C_{c}$ between this stage's input and output terminals, which serves to stabilize the op amp against potential oscillations—a topic to be explored at the end of Chapter 7. For the present low-frequency analysis, $C_{c}$ acts as an open circuit and is thus disregarded.)\n- Continuing further right, we encounter another CC buffer, $Q_{22}$, whose purpose is to minimize the loading on $Q_{17}$. The emitter network of $Q_{22}$ includes the pair $Q_{18^{-}} Q_{19}$ to supply the two $p n$-junction voltage drops required to bias the Class AB push-pull pair $Q_{14}-Q_{20}$ in the output stage. The overload protection circuitry is omitted here to focus solely on the essential components, with the details to be addressed later.\n- It is logical to view the 741 op amp as a series of three stages, as illustrated in the block diagram of Fig. 5.3. (Indeed, many op amps adhere to a similar three-stage configuration.) One additional aspect to consider: for proper functioning, all active transistors must operate in the forward-active region, necessitating a fourth subcircuit to appropriately bias the aforementioned stages. In Fig. 5.1, this subcircuit comprises the current-mirror pairs $Q_{8}{ }^{-} Q_{9}, Q_{10}-Q_{11}$, and $Q_{12}-Q_{13}$.\nimage_name:Figure 5.3 Block diagram of the 741 op amp\ndescription:The block diagram of the 741 operational amplifier comprises three main stages and a DC bias circuitry.\n\n1. **Main Components:**\n- **Stage I:** This input differential amplifier stage accepts two inputs, labeled \\( v_P \\) (non-inverting) and \\( v_N \\) (inverting), and delivers an amplified differential output. This stage is vital for initial amplification and common-mode rejection.\n- **Stage II:** This intermediate gain stage further amplifies the signal from Stage I. It primarily contributes to the voltage gain.\n- **Stage III:** This output stage receives the signal from Stage II and provides the necessary current to drive the load at the output \\( v_O \\). It is designed for low output impedance and high current drive capability.\n- **DC Bias Circuitry:** This block ensures the necessary bias currents and voltages for all transistors to operate in their active regions. It connects to all three stages, ensuring proper operation and stability.\n\n2. **Flow of Information or Control:**\n- The signal starts at the input of Stage I, where the differential input \\( v_P - v_N \\) is amplified.\n- The amplified signal then moves to Stage II for further amplification.\n- Finally, the signal reaches Stage III, where it is conditioned for effective output \\( v_O \\) drive.\n- The DC bias circuitry provides feedback to each stage, maintaining proper transistor biasing.\n\n3. **Labels, Annotations, and Key Indicators:**\n- Inputs are labeled \\( v_P \\) and \\( v_N \\), and the output is labeled \\( v_O \\).\n- Each stage is numbered I, II, and III, indicating the signal processing sequence.\n- The DC bias circuitry is clearly labeled and shown connected to all stages.\n\n4. **Overall System Function:**\n- This block diagram illustrates the internal structure and signal flow of the 741 operational amplifier. The arrangement of the three stages, along with the DC bias circuitry, enables the amplification of the input differential signal to produce a high-gain output suitable for driving loads. The bias circuitry ensures efficient and stable operation across various conditions.\n\nFIGURE 5.3 Block diagram of the 741 op amp.\n\nThe primary goal of this section is to determine the gain $a$ of the 741 op amp, along with its small-signal input and output resistances. These calculations involve parameters like $g_{m}, r_{\\pi}$, and $r_{o}$, all of which depend on the dc bias. Therefore, we must first establish the dc operating point of each relevant transistor before conducting any ac analysis. We will address this for each stage individually. By the end of this process, our initial apprehension should be considerably reduced."
},
{
    "text": "Referring to Fig. 5.2, we note the following observations:\n\n- Beginning at the lower left, we recognize the current mirror $Q_{5} Q_{6}$ as serving as an active load for the CB pnp pair $Q_{3}-Q_{4}$. Typically, this pair would be of the EC type, but here it is not, due to the notoriously low betas of lateral pnp BJTs. Op amps are designed to draw minimal currents at the input terminals. To reduce these currents, the pnp pair $Q_{3}-Q_{4}$ operates in the CB mode, with the $v_{P}$ and $v_{N}$ inputs buffered through the CC pair\nimage_name:FIGURE 5.2 Simplified circuit schematic of the 741 op amp.\ndescription:This image depicts a simplified schematic of the 741 operational amplifier, featuring a differential input stage with active load, a current mirror, and a Darlington-type output stage. The design prioritizes the performance of NPN transistors because of their higher beta compared to PNP transistors.\n\nFIGURE 5.2 Simplified circuit schematic of the 741 op amp.\n$Q_{1}-Q_{2}$. Given that the bipolar process utilized optimizes npn BJTs, $Q_{1}$ and $Q_{2}$ exhibit significantly higher betas than their pnp counterparts, resulting in much lower base currents. This identifies our first subcircuit: a differential-input, single-ended-output amplifier stage comprising two CC-CB halves and a current-mirror load.\n\n- Progressing to the right, we identify a Darlington-type stage consisting of the CC-CE pair $Q_{16} Q_{17}$. The role of the CE amplifier $Q_{17}$ is to provide additional gain, while the CC buffer $Q_{16}$ offers high input resistance to prevent excessive loading of the first stage. (Figure 5.1 also shows a capacitance $C_{c}$ between this stage's input and output terminals. Its purpose is to stabilize the op amp against potential oscillations, a topic to be explored at the end of Chapter 7. The current analysis is confined to low frequencies, where $C_{c}$ acts as an open circuit and will therefore be disregarded.)\n- Continuing further right, we encounter another CC buffer, $Q_{22}$, which serves to minimize the loading on $Q_{17}$. The emitter network of $Q_{22}$ includes the pair $Q_{18^{-}} Q_{19}$ to provide the necessary $p n$-junction voltage drops for biasing the Class AB push-pull pair $Q_{14}-Q_{20}$ in the output stage. The overload protection circuitry has been excluded here to focus solely on the essentials, with details to be addressed later.\n- It is logical to view the 741 op amp as a cascade of three stages, as illustrated in the block diagram of Fig. 5.3. (Indeed, many op amps follow a similar three-stage configuration.) An additional consideration is necessary: for proper functioning, all active transistors must operate in the forward-active region, necessitating a fourth subcircuit to appropriately bias the mentioned stages. In Fig. 5.1, this subcircuit comprises the current-mirror pairs $Q_{8}{ }^{-} Q_{9}, Q_{10}-Q_{11}$, and $Q_{12}-Q_{13}$.\nimage_name:Figure 5.3 Block diagram of the 741 op amp\ndescription:The block diagram of the 741 operational amplifier features three main stages and DC bias circuitry.\n\n1. **Main Components:**\n- **Stage I:** This input differential amplifier stage accepts two inputs, \\( v_P \\) (non-inverting) and \\( v_N \\) (inverting), and delivers an amplified differential output. This stage is essential for initial amplification and common-mode rejection.\n- **Stage II:** This intermediate gain stage further amplifies the signal from Stage I. It primarily contributes to the voltage gain.\n- **Stage III:** This output stage receives the signal from Stage II and provides the required current to drive the load at the output \\( v_O \\). It is designed for low output impedance and high current drive capability.\n- **DC Bias Circuitry:** This component ensures the necessary bias currents and voltages for all transistors to operate in their active regions. It connects to all three stages, ensuring proper operation and stability.\n\n2. **Flow of Information or Control:**\n- The signal flow starts at the input of Stage I, where the differential input \\( v_P - v_N \\) is amplified.\n- The amplified signal then moves to Stage II for further amplification.\n- Finally, the signal reaches Stage III, where it is prepared to effectively drive the output \\( v_O \\).\n- The DC bias circuitry provides feedback to each stage, maintaining proper transistor biasing.\n\n3. **Labels, Annotations, and Key Indicators:**\n- Inputs are labeled \\( v_P \\) and \\( v_N \\), and the output is labeled \\( v_O \\).\n- Each stage is numbered I, II, and III, indicating the sequence of signal processing.\n- The DC bias circuitry is clearly marked and shown connected to all stages.\n\n4. **Overall System Function:**\n- The primary purpose of this block diagram is to illustrate the internal structure and signal flow of the 741 operational amplifier. The arrangement of the three stages, along with the DC bias circuitry, enables the amplification of the input differential signal to produce a high-gain output suitable for driving loads. The bias circuitry ensures efficient and stable operation across various conditions.\n\nFIGURE 5.3 Block diagram of the 741 op amp.\n\nThe main goal of this section is to determine the gain $a$ of the 741 op amp, along with its small-signal input and output resistances. These calculations involve parameters such as $g_{m}, r_{\\pi}$, and $r_{o}$, all of which depend on the dc bias. Therefore, we must first determine the dc operating point of each relevant transistor before conducting any ac analysis. We will address this for each stage individually. By the end of this process, our initial apprehension should significantly diminish."
},
{
    "text": "Referencing Fig. 5.2, we observe the following:\n\n- At the lower left, we identify the current mirror $Q_{5} Q_{6}$ as serving as an active load for the CB pnp pair $Q_{3}-Q_{4}$. Typically, this pair would be of the EC type, but due to the low betas characteristic of lateral pnp BJTs, it operates in the CB mode. Op amps are designed to draw minimal input currents, so the pnp pair $Q_{3}-Q_{4}$ is used in CB mode, with the $v_{P}$ and $v_{N}$ inputs buffered by the CC pair\nimage_name:FIGURE 5.2 Simplified circuit schematic of the 741 op amp.\ndescription:This is a simplified schematic of the 741 operational amplifier, featuring a differential input stage with active load, a current mirror, and a Darlington-type output stage. The design prioritizes the performance of NPN transistors due to their higher beta compared to PNP transistors.\n\nFIGURE 5.2 Simplified circuit schematic of the 741 op amp.\n$Q_{1}-Q_{2}$. Given that the bipolar process optimizes npn BJTs, $Q_{1}$ and $Q_{2}$ exhibit higher betas than their pnp counterparts, resulting in lower base currents. This forms our first subcircuit: a differential-input, single-ended-output amplifier stage composed of two CC-CB halves and a current-mirror load.\n\n- Progressing to the right, we identify a Darlington-type stage comprising the CC-CE pair $Q_{16} Q_{17}$. The CE amplifier $Q_{17}$ provides additional gain, while the CC buffer $Q_{16}$ offers high input resistance to prevent excessive loading of the first stage. (Fig. 5.1 also shows a capacitance $C_{c}$ between this stage's input and output, which stabilizes the op amp against oscillations, a topic covered in Chapter 7. For low-frequency analysis, $C_{c}$ acts as an open circuit and is thus ignored.)\n- Further right, we encounter another CC buffer, $Q_{22}$, which reduces the loading on $Q_{17}$. The emitter network of $Q_{22}$ includes $Q_{18^{-}} Q_{19}$ to provide the necessary $p n$-junction voltage drops for biasing the Class AB push-pull output pair $Q_{14}-Q_{20}$. Overload protection circuitry is omitted here to focus on the essential components, with details addressed later.\n- It is logical to view the 741 op amp as a series of three stages, as depicted in Fig. 5.3. (Many op amps follow a similar three-stage structure.) An additional consideration is that all active transistors must operate in the forward-active region, necessitating a fourth subcircuit for proper biasing. In Fig. 5.1, this subcircuit consists of the current-mirror pairs $Q_{8}{ }^{-} Q_{9}, Q_{10}-Q_{11}$, and $Q_{12}-Q_{13}$.\nimage_name:Figure 5.3 Block diagram of the 741 op amp\ndescription:The block diagram of the 741 operational amplifier includes three main stages and a DC bias circuitry.\n\n1. **Main Components:**\n- **Stage I:** The input differential amplifier stage, accepting two inputs, \\( v_P \\) (non-inverting) and \\( v_N \\) (inverting), and providing an amplified differential output. This stage is key for initial amplification and common-mode rejection.\n- **Stage II:** The intermediate gain stage, further amplifying the signal from Stage I. This stage primarily contributes to the voltage gain.\n- **Stage III:** The output stage, receiving the signal from Stage II and delivering the required current to drive the output load \\( v_O \\). This stage is designed for low output impedance and high current capability.\n- **DC Bias Circuitry:** This block ensures the necessary bias currents and voltages for active transistor operation, connected to all stages for proper function and stability.\n\n2. **Flow of Information or Control:**\n- The signal begins at Stage I, where the differential input \\( v_P - v_N \\) is amplified.\n- It then moves to Stage II for further amplification.\n- Finally, it reaches Stage III for conditioning to effectively drive the output \\( v_O \\).\n- The DC bias circuitry provides feedback to each stage, maintaining proper transistor biasing.\n\n3. **Labels, Annotations, and Key Indicators:**\n- Inputs are labeled \\( v_P \\) and \\( v_N \\), with the output labeled \\( v_O \\).\n- Stages are numbered I, II, and III, indicating the signal processing sequence.\n- The DC bias circuitry is clearly marked and shown connected to all stages.\n\n4. **Overall System Function:**\n- This block diagram illustrates the internal structure and signal flow of the 741 operational amplifier. The three-stage arrangement, along with the DC bias circuitry, enables the amplification of the input differential signal to produce a high-gain output suitable for driving loads. The bias circuitry ensures efficient and stable operation across various conditions.\n\nFIGURE 5.3 Block diagram of the 741 op amp.\n\nThe goal of this section is to determine the gain $a$ of the 741 op amp, along with its small-signal input and output resistances. These calculations involve parameters like $g_{m}, r_{\\pi}$, and $r_{o}$, which are dependent on dc bias conditions. Therefore, we must first determine the dc operating points of the relevant transistors before conducting any ac analysis. We will address each stage individually, aiming to reduce initial complexity by the end of the process."
},
{
    "text": "Referring to the dc biasing subcircuit, shown again in Fig. 5.4 for ease of reference, we note that $Q_{11}$ and $Q_{12}$ are configured as diodes, thus\n\n$$\n\\begin{equation*}\nI_{R E F}=\\frac{\\left(V_{C C}-V_{E B 12(\\mathrm{on})}\\right)-\\left(V_{E E}+V_{B E 11(\\mathrm{on})}\\right)}{R_{5}} \\tag{5.1}\n\\end{equation*}\n$$\n\nimage_name:Figure 5.4\ndescription:\n[\nname: Q10, type: NPN, ports: {C: LOAD1, B: X1, E: E1}\nname: Q11, type: NPN, ports: {C: X1, B: X1, E: VEE}\nname: Q12, type: PNP, ports: {C: X2, B: X2, E: VCC}\nname: Q13, type: PNP, ports: {C: B, B: X2, E: VCC}\nname: R4, type: Resistor, value: 5 kΩ, ports: {N1: E1, N2: VEE}\nname: R5, type: Resistor, value: 39 kΩ, ports: {N1: X1, N2: X2}\n]\nextrainfo:This circuit segment is part of the 741 op amp's DC biasing network, featuring a Widlar current sink composed of Q10 and Q11, and a current mirror involving Q12 and Q13. It operates with standard power supplies of ±15 V and typical pn junction voltage drops of 0.7 V. The reference current I_REF is determined to be 733 μA.\n\nFIGURE 5.4 The DC biasing circuitry of the 741 op amp.\n\nThe 741 is designed to function with standard power supplies of $\\pm 15 \\mathrm{~V}$, although it can also operate effectively at lower voltages, such as $\\pm 5 \\mathrm{~V}$. In the subsequent analysis, we will use the standard supply values along with typical pn junction voltage drops of 0.7 V. With these parameters, Eq. (5.1) yields $I_{R E F}=733 \\mu \\mathrm{~A}$.\n\nThe combination of $Q_{10}$ and $Q_{11}$ constitutes a Widlar current sink. Employing the iterative method discussed in Chapter 4 for this type of source, we find\n\n$$\n\\begin{equation*}\nI_{1}=19 \\mu \\mathrm{~A} \\tag{5.2}\n\\end{equation*}\n$$\n\nThe $Q_{12}$ and $Q_{13}$ pair forms a standard current mirror, with the exception that $Q_{13}$ has two collectors instead of one. These two collectors are created by performing two separate $p$-type diffusions into the $n$-type base region. In this instance, the areas are produced in a 3-to-1 ratio, meaning the larger collector will gather $3 / 4$ and the smaller $1 / 4$ of the total collector current $I_{C 13}$. (Alternatively, you can envision $Q_{13}$ as two distinct transistors, $Q_{13 A}$ and $Q_{13 B}$, with their emitters and bases connected in pairs and their $I_{s}$ in a 3-to-1 ratio. However, fabricating two separate BJTs would occupy more chip area than a single BJT with two collectors.) Through current mirror action, $I_{C 13}=I_{R E F}\\left(1-2 / \\beta_{F 13}\\right)=733(1-2 / 50)=704 \\mu \\mathrm{~A}$, assuming $\\beta_{F 13}=50$. By setting $I_{2}=3 I_{3}=3 / 4 I_{C 13}$, we obtain\n\n$$\n\\begin{equation*}\nI_{2}=528 \\mu \\mathrm{~A} \\quad I_{3}=176 \\mu \\mathrm{~A} \\tag{5.3}\n\\end{equation*}\n$$"
},
{
    "text": "Regarding the dc biasing subcircuit, depicted again in Fig. 5.4 for ease of reference, it is noted that $Q_{11}$ and $Q_{12}$ are configured as diode connections, thus\n\n$$\n\\begin{equation*}\nI_{R E F}=\\frac{\\left(V_{C C}-V_{E B 12(\\mathrm{on})}\\right)-\\left(V_{E E}+V_{B E 11(\\mathrm{on})}\\right)}{R_{5}} \\tag{5.1}\n\\end{equation*}\n$$\n\nimage_name:Figure 5.4\ndescription:\n[\nname: Q10, type: NPN, ports: {C: LOAD1, B: X1, E: E1}\nname: Q11, type: NPN, ports: {C: X1, B: X1, E: VEE}\nname: Q12, type: PNP, ports: {C: X2, B: X2, E: VCC}\nname: Q13, type: PNP, ports: {C: B, B: X2, E: VCC}\nname: R4, type: Resistor, value: 5 kΩ, ports: {N1: E1, N2: VEE}\nname: R5, type: Resistor, value: 39 kΩ, ports: {N1: X1, N2: X2}\n]\nextrainfo:This circuit segment belongs to the 741 op amp's DC biasing network, incorporating a Widlar current sink made by Q10 and Q11, and a current mirror involving Q12 and Q13. The circuit operates with standard power supplies of ±15 V and typical pn junction voltage drops of 0.7 V. The reference current I_REF is determined to be 733 μA.\n\nFIGURE 5.4 The dc biasing circuitry of the 741 op amp.\n\nThe 741 is designed to function with standard power supplies of $\\pm 15 \\mathrm{~V}$, although it can also operate effectively at lower voltages, such as $\\pm 5 \\mathrm{~V}$. In the subsequent analysis, we will use the standard supply values along with typical pn junction voltage drops of 0.7 V. With these parameters, Eq. (5.1) yields $I_{R E F}=733 \\mu \\mathrm{~A}$.\n\nThe combination of $Q_{10}$ and $Q_{11}$ constitutes a Widlar current sink. Employing the iterative method discussed in Chapter 4 related to this type of source, we find\n\n$$\n\\begin{equation*}\nI_{1}=19 \\mu \\mathrm{~A} \\tag{5.2}\n\\end{equation*}\n$$\n\nThe $Q_{12}$ and $Q_{13}$ pair forms a standard current mirror, with the exception that $Q_{13}$ features two collectors instead of one. These two collectors are created by performing two separate $p$-type diffusions into the $n$-type base region. In this instance, the areas are produced in a 3-to-1 ratio, meaning the larger collector will gather $3 / 4$ and the smaller $1 / 4$ of the total collector current $I_{C 13}$. (Alternatively, $Q_{13}$ can be envisioned as two distinct transistors, $Q_{13 A}$ and $Q_{13 B}$, with their emitters and bases connected in pairs and their $I_{s}$ in a 3-to-1 ratio. However, fabricating two separate BJTs would occupy more chip area than a single BJT with two collectors.) Through current mirror action, $I_{C 13}=I_{R E F}\\left(1-2 / \\beta_{F 13}\\right)=733(1-2 / 50)=704 \\mu \\mathrm{~A}$, assuming $\\beta_{F 13}=50$. By setting $I_{2}=3 I_{3}=3 / 4 I_{C 13}$, we obtain\n\n$$\n\\begin{equation*}\nI_{2}=528 \\mu \\mathrm{~A} \\quad I_{3}=176 \\mu \\mathrm{~A} \\tag{5.3}\n\\end{equation*}\n$$"
},
{
    "text": "Regarding the dc biasing subcircuit, shown again in Fig. 5.4 for ease of reference, it is noted that $Q_{11}$ and $Q_{12}$ are configured as diode-connected, leading to\n\n$$\n\\begin{equation*}\nI_{R E F}=\\frac{\\left(V_{C C}-V_{E B 12(\\mathrm{on})}\\right)-\\left(V_{E E}+V_{B E 11(\\mathrm{on})}\\right)}{R_{5}} \\tag{5.1}\n\\end{equation*}\n$$\n\nimage_name:Figure 5.4\ndescription:\n[\nname: Q10, type: NPN, ports: {C: LOAD1, B: X1, E: E1}\nname: Q11, type: NPN, ports: {C: X1, B: X1, E: VEE}\nname: Q12, type: PNP, ports: {C: X2, B: X2, E: VCC}\nname: Q13, type: PNP, ports: {C: B, B: X2, E: VCC}\nname: R4, type: Resistor, value: 5 kΩ, ports: {N1: E1, N2: VEE}\nname: R5, type: Resistor, value: 39 kΩ, ports: {N1: X1, N2: X2}\n]\nextrainfo:This circuit is a segment of the 741 op amp's DC biasing network, featuring a Widlar current sink composed of Q10 and Q11, and a current mirror involving Q12 and Q13. It operates with standard power supplies of ±15 V and typical pn junction voltage drops of 0.7 V. The reference current I_REF is determined to be 733 μA.\n\nFIGURE 5.4 The DC biasing circuitry of the 741 op amp.\n\nThe 741 is designed to function with standard power supplies of $\\pm 15 \\mathrm{~V}$, but it can also operate effectively with lower voltages, such as $\\pm 5 \\mathrm{~V}$. In the subsequent analysis, we will use the standard supply values along with typical pn junction voltage drops of 0.7 V. With these parameters, Eq. (5.1) yields $I_{R E F}=733 \\mu \\mathrm{~A}$.\n\nThe combination of $Q_{10}$ and $Q_{11}$ constitutes a Widlar current sink. Applying the iterative method discussed in Chapter 4 for this type of source, we find\n\n$$\n\\begin{equation*}\nI_{1}=19 \\mu \\mathrm{~A} \\tag{5.2}\n\\end{equation*}\n$$\n\nThe $Q_{12}$ and $Q_{13}$ pair forms a standard current mirror, with the exception that $Q_{13}$ has two collectors instead of one. These two collectors are created by making two separate $p$-type diffusions into the $n$-type base region. In this instance, the areas are made in a 3-to-1 ratio, meaning the larger collector will gather $3 / 4$ and the smaller $1 / 4$ of the total collector current $I_{C 13}$. (Alternatively, $Q_{13}$ can be viewed as two distinct transistors, $Q_{13 A}$ and $Q_{13 B}$, with their emitters and bases connected in pairs and their $I_{s}$ in a 3-to-1 ratio. However, fabricating two separate BJTs would occupy more chip area than a single BJT with two collectors.) By the action of the current mirror, $I_{C 13}=I_{R E F}\\left(1-2 / \\beta_{F 13}\\right)=733(1-2 / 50)=704 \\mu \\mathrm{~A}$, assuming $\\beta_{F 13}=50$. Setting $I_{2}=3 I_{3}=3 / 4 I_{C 13}$ results in\n\n$$\n\\begin{equation*}\nI_{2}=528 \\mu \\mathrm{~A} \\quad I_{3}=176 \\mu \\mathrm{~A} \\tag{5.3}\n\\end{equation*}\n$$"
},
{
    "text": "Referring to the dc biasing subcircuit, which is shown again in Fig. 5.4 for ease of reference, we note that $Q_{11}$ and $Q_{12}$ are configured as diodes, thus\n\n$$\n\\begin{equation*}\nI_{R E F}=\\frac{\\left(V_{C C}-V_{E B 12(\\mathrm{on})}\\right)-\\left(V_{E E}+V_{B E 11(\\mathrm{on})}\\right)}{R_{5}} \\tag{5.1}\n\\end{equation*}\n$$\n\nimage_name:Figure 5.4\ndescription:\n[\nname: Q10, type: NPN, ports: {C: LOAD1, B: X1, E: E1}\nname: Q11, type: NPN, ports: {C: X1, B: X1, E: VEE}\nname: Q12, type: PNP, ports: {C: X2, B: X2, E: VCC}\nname: Q13, type: PNP, ports: {C: B, B: X2, E: VCC}\nname: R4, type: Resistor, value: 5 kΩ, ports: {N1: E1, N2: VEE}\nname: R5, type: Resistor, value: 39 kΩ, ports: {N1: X1, N2: X2}\n]\nextrainfo:The circuit illustrates a segment of the 741 op amp's DC biasing network, incorporating a Widlar current sink made up of Q10 and Q11, and a current mirror involving Q12 and Q13. The circuit is designed for nominal power supplies of ±15 V, with typical pn junction voltage drops of 0.7 V. The reference current I_REF is determined to be 733 μA.\n\nFIGURE 5.4 The DC biasing circuitry of the 741 op amp.\n\nThe 741 is intended to operate with nominal power supplies of $\\pm 15 \\mathrm{~V}$, although it can also function effectively with lower voltages, such as $\\pm 5 \\mathrm{~V}$. In the subsequent analysis, we will assume nominal supply voltages along with typical pn junction voltage drops of 0.7 V. Using these values, Eq. (5.1) yields $I_{R E F}=733 \\mu \\mathrm{~A}$.\n\nThe combination of $Q_{10}$ and $Q_{11}$ constitutes a Widlar current sink. Applying the iterative method discussed in Chapter 4 for this type of source, we obtain\n\n$$\n\\begin{equation*}\nI_{1}=19 \\mu \\mathrm{~A} \\tag{5.2}\n\\end{equation*}\n$$\n\nThe $Q_{12}$ and $Q_{13}$ pair forms a standard current mirror, with the exception that $Q_{13}$ features two collectors instead of one. These two collectors are created by performing two separate $p$-type diffusions into the $n$-type base region. In this instance, the areas are produced in a 3-to-1 ratio, meaning the larger collector will gather $3 / 4$ and the smaller $1 / 4$ of the total collector current $I_{C 13}$. (Alternatively, $Q_{13}$ can be conceptualized as two distinct transistors, $Q_{13 A}$ and $Q_{13 B}$, with their emitters and bases connected pairwise and their $I_{s}$ in a 3-to-1 ratio. However, fabricating two separate BJTs would occupy more chip area than a single BJT with two collectors.) By the action of the current mirror, $I_{C 13}=I_{R E F}\\left(1-2 / \\beta_{F 13}\\right)=733(1-2 / 50)=704 \\mu \\mathrm{~A}$, assuming $\\beta_{F 13}=50$. Setting $I_{2}=3 I_{3}=3 / 4 I_{C 13}$ results in\n\n$$\n\\begin{equation*}\nI_{2}=528 \\mu \\mathrm{~A} \\quad I_{3}=176 \\mu \\mathrm{~A} \\tag{5.3}\n\\end{equation*}\n$$"
},
{
    "text": "Referring to the dc biasing subcircuit, which is reillustrated in Fig. 5.4 for ease of reference, we note that $Q_{11}$ and $Q_{12}$ are configured as diode connections. Consequently,\n\n$$\n\\begin{equation*}\nI_{R E F}=\\frac{\\left(V_{C C}-V_{E B 12(\\mathrm{on})}\\right)-\\left(V_{E E}+V_{B E 11(\\mathrm{on})}\\right)}{R_{5}} \\tag{5.1}\n\\end{equation*}\n$$\n\nimage_name:Figure 5.4\ndescription:\n[\nname: Q10, type: NPN, ports: {C: LOAD1, B: X1, E: E1}\nname: Q11, type: NPN, ports: {C: X1, B: X1, E: VEE}\nname: Q12, type: PNP, ports: {C: X2, B: X2, E: VCC}\nname: Q13, type: PNP, ports: {C: B, B: X2, E: VCC}\nname: R4, type: Resistor, value: 5 kΩ, ports: {N1: E1, N2: VEE}\nname: R5, type: Resistor, value: 39 kΩ, ports: {N1: X1, N2: X2}\n]\nextrainfo:This circuit segment is part of the 741 op amp's DC biasing network, incorporating a Widlar current sink composed of Q10 and Q11, and a current mirror involving Q12 and Q13. The circuit is designed for standard power supplies of ±15 V, with typical pn junction voltage drops of 0.7 V. The reference current I_REF is determined to be 733 μA.\n\nFIGURE 5.4 The dc biasing circuitry of the 741 op amp.\n\nThe 741 is intended to operate with standard power supplies of $\\pm 15 \\mathrm{~V}$, although it can also function effectively with lower voltages, such as $\\pm 5 \\mathrm{~V}$. In the subsequent analysis, we will assume standard supply voltages and typical pn junction voltage drops of 0.7 V. Using these parameters, Eq. (5.1) yields $I_{R E F}=733 \\mu \\mathrm{~A}$.\n\nThe combination of $Q_{10}$ and $Q_{11}$ constitutes a Widlar current sink. Applying the iterative method discussed in Chapter 4 for this type of source, we obtain\n\n$$\n\\begin{equation*}\nI_{1}=19 \\mu \\mathrm{~A} \\tag{5.2}\n\\end{equation*}\n$$\n\nThe $Q_{12}$ and $Q_{13}$ pair forms a standard current mirror, with the exception that $Q_{13}$ features two collectors instead of one. These two collectors are created by performing two separate $p$-type diffusions into the $n$-type base region. In this instance, the areas are fabricated in a 3-to-1 ratio, meaning the larger collector will carry $3 / 4$ and the smaller $1 / 4$ of the total collector current $I_{C 13}$. (Alternatively, you can conceptualize $Q_{13}$ as two distinct transistors, $Q_{13 A}$ and $Q_{13 B}$, with their emitters and bases connected in pairs and their saturation currents in a 3-to-1 ratio. However, fabricating two separate BJTs would occupy more chip area than a single BJT with two collectors.) Through current mirror action, $I_{C 13}=I_{R E F}\\left(1-2 / \\beta_{F 13}\\right)=733(1-2 / 50)=704 \\mu \\mathrm{~A}$, assuming $\\beta_{F 13}=50$. By setting $I_{2}=3 I_{3}=3 / 4 I_{C 13}$, we derive\n\n$$\n\\begin{equation*}\nI_{2}=528 \\mu \\mathrm{~A} \\quad I_{3}=176 \\mu \\mathrm{~A} \\tag{5.3}\n\\end{equation*}\n$$"
},
{
    "text": "Regarding the dc biasing subcircuit, depicted again in Fig. 5.4 for ease of reference, it is noted that $Q_{11}$ and $Q_{12}$ are configured as diode connections, thus\n\n$$\n\\begin{equation*}\nI_{R E F}=\\frac{\\left(V_{C C}-V_{E B 12(\\mathrm{on})}\\right)-\\left(V_{E E}+V_{B E 11(\\mathrm{on})}\\right)}{R_{5}} \\tag{5.1}\n\\end{equation*}\n$$\n\nimage_name:Figure 5.4\ndescription:\n[\nname: Q10, type: NPN, ports: {C: LOAD1, B: X1, E: E1}\nname: Q11, type: NPN, ports: {C: X1, B: X1, E: VEE}\nname: Q12, type: PNP, ports: {C: X2, B: X2, E: VCC}\nname: Q13, type: PNP, ports: {C: B, B: X2, E: VCC}\nname: R4, type: Resistor, value: 5 kΩ, ports: {N1: E1, N2: VEE}\nname: R5, type: Resistor, value: 39 kΩ, ports: {N1: X1, N2: X2}\n]\nextrainfo:This circuit segment is part of the 741 op amp's DC biasing network, incorporating a Widlar current sink composed of Q10 and Q11, and a current mirror involving Q12 and Q13. The circuit is designed for nominal power supplies of ±15 V, with typical pn junction voltage drops of 0.7 V. The reference current I_REF is determined to be 733 μA.\n\nFIGURE 5.4 The DC biasing circuitry of the 741 op amp.\n\nThe 741 is intended to operate with nominal power supplies of $\\pm 15 \\mathrm{~V}$, although it can also function effectively with lower voltages, such as $\\pm 5 \\mathrm{~V}$. In the subsequent analysis, we will assume nominal supply voltages and typical pn junction voltage drops of 0.7 V. Using these values, Eq. (5.1) yields $I_{R E F}=733 \\mu \\mathrm{~A}$.\n\nThe combination of $Q_{10}$ and $Q_{11}$ constitutes a Widlar current sink. Employing the iterative method discussed in Chapter 4 for this type of source, we obtain\n\n$$\n\\begin{equation*}\nI_{1}=19 \\mu \\mathrm{~A} \\tag{5.2}\n\\end{equation*}\n$$\n\nThe $Q_{12}$ and $Q_{13}$ pair forms a standard current mirror, with the exception that $Q_{13}$ features two collectors instead of one. These two collectors are created by performing two separate $p$-type diffusions into the $n$-type base region. In this instance, the areas are fabricated in a 3-to-1 ratio, meaning the larger collector will conduct $3 / 4$ and the smaller one $1 / 4$ of the total collector current $I_{C 13}$. (Alternatively, $Q_{13}$ can be conceptualized as two distinct transistors, $Q_{13 A}$ and $Q_{13 B}$, with their emitters and bases connected in pairs and their $I_{s}$ in a 3-to-1 ratio. However, fabricating two separate BJTs would occupy more chip area than a single BJT with two collectors.) By the action of the current mirror, $I_{C 13}=I_{R E F}\\left(1-2 / \\beta_{F 13}\\right)=733(1-2 / 50)=704 \\mu \\mathrm{~A}$, assuming $\\beta_{F 13}=50$. Setting $I_{2}=3 I_{3}=3 / 4 I_{C 13}$ results in\n\n$$\n\\begin{equation*}\nI_{2}=528 \\mu \\mathrm{~A} \\quad I_{3}=176 \\mu \\mathrm{~A} \\tag{5.3}\n\\end{equation*}\n$$"
},
{
    "text": "Regarding the dc biasing subcircuit, which is depicted again in Fig. 5.4 for ease of reference, it is noted that $Q_{11}$ and $Q_{12}$ are configured as diode connections. Thus,\n\n$$\n\\begin{equation*}\nI_{R E F}=\\frac{\\left(V_{C C}-V_{E B 12(\\mathrm{on})}\\right)-\\left(V_{E E}+V_{B E 11(\\mathrm{on})}\\right)}{R_{5}} \\tag{5.1}\n\\end{equation*}\n$$\n\nimage_name:Figure 5.4\ndescription:\n[\nname: Q10, type: NPN, ports: {C: LOAD1, B: X1, E: E1}\nname: Q11, type: NPN, ports: {C: X1, B: X1, E: VEE}\nname: Q12, type: PNP, ports: {C: X2, B: X2, E: VCC}\nname: Q13, type: PNP, ports: {C: B, B: X2, E: VCC}\nname: R4, type: Resistor, value: 5 kΩ, ports: {N1: E1, N2: VEE}\nname: R5, type: Resistor, value: 39 kΩ, ports: {N1: X1, N2: X2}\n]\nextrainfo:This circuit segment is part of the 741 op amp's DC biasing network, featuring a Widlar current sink composed of Q10 and Q11, and a current mirror involving Q12 and Q13. The circuit is designed for standard power supplies of ±15 V, with typical pn junction voltage drops of 0.7 V. The reference current I_REF is determined to be 733 μA.\n\nFIGURE 5.4 The DC biasing circuitry of the 741 op amp.\n\nThe 741 is intended to operate with standard power supplies of $\\pm 15 \\mathrm{~V}$, although it can also function effectively at lower voltages, such as $\\pm 5 \\mathrm{~V}$. In the subsequent analysis, we will use the standard supply values and typical pn junction voltage drops of 0.7 V. With these parameters, Eq. (5.1) yields $I_{R E F}=733 \\mu \\mathrm{~A}$.\n\nThe combination of $Q_{10}$ and $Q_{11}$ constitutes a Widlar current sink. Applying the iterative method discussed in Chapter 4 for this type of source, we find\n\n$$\n\\begin{equation*}\nI_{1}=19 \\mu \\mathrm{~A} \\tag{5.2}\n\\end{equation*}\n$$\n\nThe $Q_{12}$ and $Q_{13}$ pair forms a standard current mirror, with the exception that $Q_{13}$ has two collectors instead of one. These two collectors are created by making two separate $p$-type diffusions into the $n$-type base region. In this instance, the areas are produced in a 3-to-1 ratio, meaning the larger collector will gather $3 / 4$ and the smaller $1 / 4$ of the total collector current $I_{C 13}$. (Alternatively, you can conceptualize $Q_{13}$ as two distinct transistors, $Q_{13 A}$ and $Q_{13 B}$, with their emitters and bases connected in pairs and their $I_{s}$ in a 3-to-1 ratio. However, fabricating two separate BJTs would occupy more chip area than a single BJT with two collectors.) By the action of the current mirror, $I_{C 13}=I_{R E F}\\left(1-2 / \\beta_{F 13}\\right)=733(1-2 / 50)=704 \\mu \\mathrm{~A}$, assuming $\\beta_{F 13}=50$. Setting $I_{2}=3 I_{3}=3 / 4 I_{C 13}$ results in\n\n$$\n\\begin{equation*}\nI_{2}=528 \\mu \\mathrm{~A} \\quad I_{3}=176 \\mu \\mathrm{~A} \\tag{5.3}\n\\end{equation*}\n$$"
},
{
    "text": "Regarding the dc biasing subcircuit, depicted again in Fig. 5.4 for ease of reference, it is noted that $Q_{11}$ and $Q_{12}$ are configured as diode connections, thus\n\n$$\n\\begin{equation*}\nI_{R E F}=\\frac{\\left(V_{C C}-V_{E B 12(\\mathrm{on})}\\right)-\\left(V_{E E}+V_{B E 11(\\mathrm{on})}\\right)}{R_{5}} \\tag{5.1}\n\\end{equation*}\n$$\n\nimage_name:Figure 5.4\ndescription:\n[\nname: Q10, type: NPN, ports: {C: LOAD1, B: X1, E: E1}\nname: Q11, type: NPN, ports: {C: X1, B: X1, E: VEE}\nname: Q12, type: PNP, ports: {C: X2, B: X2, E: VCC}\nname: Q13, type: PNP, ports: {C: B, B: X2, E: VCC}\nname: R4, type: Resistor, value: 5 kΩ, ports: {N1: E1, N2: VEE}\nname: R5, type: Resistor, value: 39 kΩ, ports: {N1: X1, N2: X2}\n]\nextrainfo:The circuit illustrates a segment of the 741 op amp's DC biasing network, incorporating a Widlar current sink composed of Q10 and Q11, and a current mirror involving Q12 and Q13. The circuit operates with standard power supplies of ±15 V, and typical pn junction voltage drops of 0.7 V. The reference current I_REF is determined to be 733 μA.\n\nFIGURE 5.4 The dc biasing circuitry of the 741 op amp.\n\nThe 741 is designed to function with standard power supplies of $\\pm 15 \\mathrm{~V}$, although it can also operate effectively with lower voltages, such as $\\pm 5 \\mathrm{~V}$. In the subsequent analysis, we will assume standard supply voltages along with typical pn junction voltage drops of 0.7 V. Using these values, Eq. (5.1) yields $I_{R E F}=733 \\mu \\mathrm{~A}$.\n\nThe combination of $Q_{10}$ and $Q_{11}$ constitutes a Widlar current sink. Employing the iterative method discussed in Chapter 4 related to this type of source, we obtain\n\n$$\n\\begin{equation*}\nI_{1}=19 \\mu \\mathrm{~A} \\tag{5.2}\n\\end{equation*}\n$$\n\nThe $Q_{12}$ and $Q_{13}$ pair forms a standard current mirror, with the exception that $Q_{13}$ features two collectors instead of one. These two collectors are created by performing two separate $p$-type diffusions into the $n$-type base region. In this instance, the areas are produced in a 3-to-1 ratio, meaning the larger collector will gather $3 / 4$ and the smaller $1 / 4$ of the total collector current $I_{C 13}$. (Alternatively, $Q_{13}$ can be envisioned as two distinct transistors, $Q_{13 A}$ and $Q_{13 B}$, with their emitters and bases connected in pairs and their $I_{s}$ in a 3-to-1 ratio. However, fabricating two separate BJTs would occupy more chip area than a single BJT with two collectors.) Through current mirror action, $I_{C 13}=I_{R E F}\\left(1-2 / \\beta_{F 13}\\right)=733(1-2 / 50)=704 \\mu \\mathrm{~A}$, assuming $\\beta_{F 13}=50$. By setting $I_{2}=3 I_{3}=3 / 4 I_{C 13}$, we derive\n\n$$\n\\begin{equation*}\nI_{2}=528 \\mu \\mathrm{~A} \\quad I_{3}=176 \\mu \\mathrm{~A} \\tag{5.3}\n\\end{equation*}\n$$"
},
{
    "text": "The functioning of this stage is most comprehensible when analyzed immediately after power application. Initially, with all BJTs off, the current $I_{R E F}$ from Fig 5.4 activates first, followed by $I_{1}$ through $I_{3}$. At the outset, all of $I_{1}$ in Fig. 5.5 is drawn by the bases of $Q_{3}$ and $Q_{4}$, leading to their swift activation. As $Q_{3}$ and $Q_{4}$ conduct, $Q_{1}$ and $Q_{2}$ also start conducting since they are in series with the former. $Q_{1}$ and $Q_{2}$ derive their collector currents from the diode-connected transistor $Q_{8}$, whose current is mirrored by $Q_{9}$ back to the node where $I_{1}$ initiated the sequence. This creates a negative-feedback loop, stabilizing the circuit at an operating point where the current $I_{C 9}$ from $Q_{9}$, plus the current $2 I_{B}$ from the bases of $Q_{3}$ and $Q_{4}$, equals $I_{1}$.\n\nFrom Chapter 4, we know the current mirrored by $Q_{9}$ relative to $Q_{8}$ has a fractional error of $-2 / \\beta_{F p}$. This error, non-trivial due to the modest betas of lateral pnp BJTs, is neutralized by the current $2 I_{B}$ from the bases of $Q_{3}$ and $Q_{4}$ themselves, akin to error cancellation in Wilson current mirrors. Thus, each BJT in the input stage's halves carries a current of $I_{1} / 2$, or\n\n$$\n\\begin{equation*}\nI_{C 1}=I_{C 2}=I_{C 3}=I_{C 4}=I_{C 5}=I_{C 6}=\\frac{I_{1}}{2}=9.5 \\mu \\mathrm{~A} \\tag{5.4}\n\\end{equation*}\n$$\n\nThe base currents for $Q_{1}$ and $Q_{2}$ are\n\n$$\n\\begin{equation*}\nI_{P}=I_{N}=\\frac{I_{1} / 2}{\\beta_{F n}}=47.5 \\mathrm{nA} \\tag{5.5}\n\\end{equation*}\n$$\n\n**Figure 5.5 Description:**\nThe circuit is part of the input stage of a 741 op-amp, featuring a differential amplifier with current mirrors and active loads. Transistors Q1 to Q4 form the differential pair and current mirror, while Q5 and Q6 serve as active loads and Q7 as a beta helper. The circuit is powered by VCC and VEE.\n\n**Figure 5.5:** Circuit for the dc analysis of the 741 op-amp's input stage, assuming $\\beta_{F n}=200$ for the $Q_{1}-Q_{2}$ pair. Upon powering, the op-amp automatically draws these currents from the surrounding circuitry. Referring to Fig. 5.1, both collectors of $Q_{5}$ and $Q_{6}$ are two $pn$-junction voltage drops above $V_{E E}$. Thus, besides aiding as a beta helper, $Q_{7}$ ensures equal collector voltages for $Q_{5}$ and $Q_{6}$, and for $Q_{3}$ and $Q_{4}$, achieving perfect balance in the stage's halves.\n\nNext, we aim to determine the small-signal gain and input/output resistances of the input stage. This is simplified using the half-circuit concept in Fig. 5.6a. By applying $v_{i d} / 2$ to $Q_{1}$ and $-v_{i d} / 2$ to $Q_{2}$, the common base node of $Q_{3}$ and $Q_{4}$ remains at ac ground, allowing us to focus on one half, say, $Q_{1}$ and $Q_{3}$. Their small-signal emitter resistances $r_{e 1}$ and $r_{e 3}$ cause a voltage division by two, resulting in an ac signal at their shared emitter terminals of\n\n**Figure 5.6 (a) Description:**\nThis circuit is an AC analysis model of a differential amplifier's input stage, employing the half-circuit concept. It applies differential voltages to Q1 and Q2, with Q3 and Q4 forming a current mirror and Q5, Q6, and Q7 part of the biasing and amplification stage. Resistors R1, R2, and R3 provide biasing and load resistance, leveraging symmetry and small-signal models for analysis.\n\n**Figure 5.6 (b) Description:**\nThe circuit represents a small-signal model of a differential amplifier input stage, using a voltage-controlled current source for transconductance gain. Resistors provide biasing and load resistance, illustrating the relationship between differential input voltage and output voltage.\n\n**Figure 5.6 (a) and (b):** Circuit for the ac analysis of the input stage and its small-signal equivalent.\n$(1 / 2)\\left(v_{i d} / 2\\right)=v_{i d} / 4$. Thus, the ac current from $Q_{3}$'s collector is $i_{3}=g_{m 3} v_{i d} / 4$, and by symmetry, the ac current into $Q_{4}$'s collector is $i_{4}=g_{m 4} v_{i d} / 4$. The current mirror of $Q_{5}$ and $Q_{6}$ reflects $i_{3}$, resulting in a net short-circuit ac current sunk from the output node of $i_{o 1(\\mathrm{sc})}=i_{3}+i_{4}=g_{m 3} v_{i d} / 4+g_{m 4} v_{i d} / 4=g_{m} v_{i d} / 2$, where $g_{m}$ is the same for both transistors. This allows us to write\n\n$$\n\\begin{equation*}\nG_{m 1}=\\frac{i_{o l(\\mathrm{~s})}}{v_{i d}}=\\frac{g_{m}}{2}=\\frac{9.5 \\mu \\mathrm{~A}}{2 \\times 26 \\mathrm{mV}}=\\frac{1}{5.47 \\mathrm{k} \\Omega} \\tag{5.6}\n\\end{equation*}\n$$\n\nwhere $G_{m 1}$ is the first-stage transconductance. Inspecting $Q_{1}$'s base terminal reveals $R_{i d} / 2=r_{\\pi 1}+\\left(\\beta_{01}+1\\right) r_{e 3} \\cong r_{\\pi 1}+\\left(\\beta_{01}+1\\right) r_{e 1}=2 r_{\\pi 1}=2 r_{\\pi n}$, given $r_{e 3} \\cong r_{e 1}$. Therefore,\n\n$$\n\\begin{equation*}\nR_{i d} \\cong 4 r_{\\pi n}=2.19 \\mathrm{M} \\Omega \\tag{5.7}\n\\end{equation*}\n$$\n\nassuming $\\beta_{0 n}=200$ for the $Q_{1}-Q_{2}$ pair. For the first stage's output terminal, inspection yields $R_{o 1}=R_{c 4} / / R_{c 6} \\cong\\left[r_{o 4}\\left(1+g_{m 4} r_{e 2}\\right)\\right] / /$ $\\left[r_{o 6}\\left(1+g_{m 0} R_{2}\\right)\\right]$, or\n\n$$\n\\begin{equation*}\nR_{o 1} \\cong 2 r_{o 4} / / 1.37 r_{o 6}=6.12 \\mathrm{M} \\Omega \\tag{5.8}\n\\end{equation*}\n$$\n\nassuming $V_{A n}=100 \\mathrm{~V}$ and $V_{A p}=50 \\mathrm{~V}$. This completes the first stage's analysis, summarized in Fig. 5.6b.\n\nBefore concluding, we examine additional characteristics the user should be aware of, as listed in the manufacturer's data sheets:\n\n- **Input Bias Current $I_{B}$**: This is the average of the two input currents, $I_{B}=$ $1 / 2\\left(I_{P}+I_{N}\\right)$. According to Eq. (5.5), $I_{B}$ is around 50 nA, heavily influenced by $\\beta_{F n}$. Mismatches in the betas of $Q_{1}$ and $Q_{2}$ result in an Input Offset Current $I_{O S}=I_{P}-I_{N}$. The 741 data sheets report typical values of $I_{B}=80 \\mathrm{nA}$ and $I_{O S}=20 \\mathrm{nA}$.\n- **Input Offset Voltage $V_{O S}$**: Due to $V_{B E}$ mismatches in the BJTs of the two halves, this stage exhibits an input offset voltage $V_{O S}$. The 741 data sheets typically give $V_{O S}=2 \\mathrm{mV}$.\n- **Input Offset Nulling**: The 741 includes provisions for nulling input offset errors from $V_{O S}$ and $I_{O S}$ using an external $10-\\mathrm{k} \\Omega$ potentiometer with on-chip resistors $R_{1}$ and $R_{2}$, as shown in Fig. 5.5. With the wiper centered, the emitters of $Q_{5}$ and $Q_{6}$ are biased at about $[(1 / / 5) \\mathrm{k} \\Omega] \\times(9.5 \\mu \\mathrm{~A})=8 \\mathrm{mV}$ above $V_{E E}$. Adjusting the wiper empirically cancels out internal imbalances, achieving offset-less behavior.\n- **Input Voltage Range (IVR)**: In negative-feedback operation, the op amp forces $v_{N}$ to track $v_{P}$, making the common-mode input voltage $v_{I C}=1 / 2\\left(v_{P}+v_{N}\\right) \\cong v_{P}$. The common-mode input voltage range is the range of $v_{I C}$ over which the input stage functions properly. Referring to Fig. 5.1, the upper limit is reached when $Q_{1}$ approaches EOS, giving $v_{P(\\max )} \\cong V_{C C}-V_{E B 8(\\text { (n) })}-V_{C E 1(\\mathrm{EOS})}+V_{B E 1(\\mathrm{on})}$. The lower limit is when $Q_{3}$ reaches EOS, so $v_{P(\\text { min })} \\cong V_{E E}+V_{B E S(\\text { on })}+$ $V_{B E 7(\\text { on })}+V_{E C 3(\\mathrm{EOS})}+V_{B E 1(\\mathrm{on})}$. Letting $v_{P} \\rightarrow v_{I C}$ gives\n\n$$\n\\begin{equation*}\nv_{I C(\\max )} \\cong V_{C C}-V_{C E(\\mathrm{EOS})} \\quad v_{I C(\\min )} \\cong V_{E E}+3 V_{B E(\\mathrm{mn})}+V_{E C(\\mathrm{EOS})} \\tag{5.9}\n\\end{equation*}\n$$\n\n(Ignoring small voltage drops across $R_{1}, R_{2}$, and $R_{8}$, and assuming equal junction voltage drops.) Assuming typical junction drops of 0.7 V and EOS drops of 0.2 V, the estimates are $v_{I C(\\max )} \\cong V_{C C}-0.2 \\mathrm{~V}$ and $v_{I C(\\min )} \\cong V_{E E}+2.3 \\mathrm{~V}$. With $\\pm 15-\\mathrm{V}$ supplies, the IVR is $-12.7 \\mathrm{~V} \\leq v_{I C} \\leq+14.8 \\mathrm{~V}$. Exceeding this range causes malfunction."
},
{
    "text": "The functionality of this stage is best comprehended by analyzing it immediately after power application. With all BJTs initially off, the first component to activate is the current $I_{R E F}$ from Fig 5.4, followed by $I_{1}$ through $I_{3}$. At the outset, the entire $I_{1}$ in Fig. 5.5 is drawn from the bases of $Q_{3}$ and $Q_{4}$, leading to their swift activation. However, as $Q_{3}$ and $Q_{4}$ start conducting, $Q_{1}$ and $Q_{2}$ also follow suit due to their series connection with the former. $Q_{1}$ and $Q_{2}$ derive their collector currents from the diode-connected transistor $Q_{8}$, whose current is mirrored by $Q_{9}$ back to the node where $I_{1}$ initiated the sequence. This creates a negative-feedback scenario where the circuit stabilizes at an operating point where the current $I_{C 9}$ returned by $Q_{9}$, combined with the current $2 I_{B}$ from the bases of $Q_{3}$ and $Q_{4}$, equals $I_{1}$.\n\nFrom Chapter 4, we know that the current returned by $Q_{9}$, relative to $Q_{8}$, experiences a fractional error of $-2 / \\beta_{F p}$. This error may not be insignificant, given the modest betas of lateral pnp BJTs. However, in this setup, this error is neutralized by the current $2 I_{B}$ returned by the bases of $Q_{3}$ and $Q_{4}$ themselves. (This error cancellation is akin to that in Wilson current mirrors.) Consequently, each half of the input stage's BJTs carries a current of $I_{1} / 2$, or\n\n$$\n\\begin{equation*}\nI_{C 1}=I_{C 2}=I_{C 3}=I_{C 4}=I_{C 5}=I_{C 6}=\\frac{I_{1}}{2}=9.5 \\mu \\mathrm{~A} \\tag{5.4}\n\\end{equation*}\n$$\n\nThe base currents for $Q_{1}$ and $Q_{2}$ are\n\n$$\n\\begin{equation*}\nI_{P}=I_{N}=\\frac{I_{1} / 2}{\\beta_{F n}}=47.5 \\mathrm{nA} \\tag{5.5}\n\\end{equation*}\n$$\n\nimage_name:Figure 5.5\ndescription:The circuit is part of the input stage of a 741 op-amp, featuring a differential amplifier with current mirrors and active loads. Transistors Q1 to Q4 form the differential pair and current mirror, while Q5 and Q6 serve as active loads and Q7 acts as a beta helper. The circuit is powered by VCC and VEE.\n\nFIGURE 5.5 Circuit for the dc analysis of the input stage of the 741 op amp.\nassuming $\\beta_{F n}=200$ for the $Q_{1}-Q_{2}$ pair. Upon powering, the op amp automatically draws these currents from the surrounding circuitry. Referring to Fig. 5.1, we note that the collectors of $Q_{5}$ and $Q_{6}$ are two $p n$-junction voltage drops above $V_{E E}$. Thus, besides serving as a beta helper, $Q_{7}$ ensures equal collector voltages for $Q_{5}$ and $Q_{6}$ as well as for $Q_{3}$ and $Q_{4}$, thereby balancing the two halves of the stage.\n\nNext, we aim to determine the small-signal gain and the input/output resistances of the input stage. This task is simplified by utilizing the half-circuit concept of Fig. 5.6a. By applying $v_{i d} / 2$ to $Q_{1}$ and $-v_{i d} / 2$ to $Q_{2}$, we maintain the common base node of $Q_{3}$ and $Q_{4}$ at ac ground, allowing us to focus on one half, say, $Q_{1}$ and $Q_{3}$. Their small-signal emitter resistances $r_{e 1}$ and $r_{e 3}$ cause a voltage division by two, resulting in an ac signal of $(1 / 2)\\left(v_{i d} / 2\\right)=v_{i d} / 4$ at their shared emitter terminals. Thus, the ac current from $Q_{3}$'s collector is $i_{3}=g_{m 3} v_{i d} / 4$, and by symmetry, the ac current into $Q_{4}$'s collector is $i_{4}=g_{m 4} v_{i d} / 4$. The current mirror formed by $Q_{5}$ and $Q_{6}$ reflects $i_{3}$, resulting in a net short-circuit ac current sunk from the output node of $i_{o 1(\\mathrm{sc})}=i_{3}+i_{4}=g_{m 3} v_{i d} / 4+g_{m 4} v_{i d} / 4=g_{m} v_{i d} / 2$, where $g_{m}$ is assumed identical for both. This leads to\n\n$$\n\\begin{equation*}\nG_{m 1}=\\frac{i_{o l(\\mathrm{~s})}}{v_{i d}}=\\frac{g_{m}}{2}=\\frac{9.5 \\mu \\mathrm{~A}}{2 \\times 26 \\mathrm{mV}}=\\frac{1}{5.47 \\mathrm{k} \\Omega} \\tag{5.6}\n\\end{equation*}\n$$\n\nwhere $G_{m 1}$ is the first-stage transconductance. By inspecting $Q_{1}$'s base terminal, we find $R_{i d} / 2=r_{\\pi 1}+\\left(\\beta_{01}+1\\right) r_{e 3} \\cong r_{\\pi 1}+\\left(\\beta_{01}+1\\right) r_{e 1}=2 r_{\\pi 1}=2 r_{\\pi n}$, using $r_{e 3} \\cong r_{e 1}$. Therefore,\n\n$$\n\\begin{equation*}\nR_{i d} \\cong 4 r_{\\pi n}=2.19 \\mathrm{M} \\Omega \\tag{5.7}\n\\end{equation*}\n$$\n\nassuming $\\beta_{0 n}=200$ for the $Q_{1}-Q_{2}$ pair. For the first stage's output terminal, inspection yields $R_{o 1}=R_{c 4} / / R_{c 6} \\cong\\left[r_{o 4}\\left(1+g_{m 4} r_{e 2}\\right)\\right] / /$ $\\left[r_{o 6}\\left(1+g_{m 0} R_{2}\\right)\\right]$, or\n\n$$\n\\begin{equation*}\nR_{o 1} \\cong 2 r_{o 4} / / 1.37 r_{o 6}=6.12 \\mathrm{M} \\Omega \\tag{5.8}\n\\end{equation*}\n$$\n\nassuming $V_{A n}=100 \\mathrm{~V}$ and $V_{A p}=50 \\mathrm{~V}$. This completes the first stage's analysis, with its small-signal characteristics summarized in Fig. 5.6b.\n\nBefore concluding, we examine additional characteristics the user should be aware of, as listed in the manufacturer's data sheets.\n\n- **Input Bias Current** $\\boldsymbol{I}_{B}$. This is the average of the two input currents, or $I_{B}=$ $1 / 2\\left(I_{P}+I_{N}\\right)$. According to Eq. (5.5), $I_{B}$ is around 50 nA and is significantly influenced by $\\beta_{F n}$. Any beta mismatches between $Q_{1}$ and $Q_{2}$ result in an Input Offset Current $I_{O S}=I_{P}-I_{N}$. The 741 data sheets, available online, typically report $I_{B}=80 \\mathrm{nA}$ and $I_{O S}=20 \\mathrm{nA}$.\n- **Input Offset Voltage** $V_{O S}$. Due to $V_{B E}$ mismatches in the BJTs of the two halves, this stage exhibits an input offset voltage $V_{O S}$. The 741 data sheets typically give $V_{O S}=2 \\mathrm{mV}$.\n- **Input Offset Nulling**. The 741 includes provisions for nulling input offset errors from $V_{O S}$ and $I_{O S}$. This is achieved using an external $10-\\mathrm{k} \\Omega$ potentiometer along with on-chip resistors $R_{1}$ and $R_{2}$, as shown in Fig. 5.5. With the wiper centered, the emitters of $Q_{5}$ and $Q_{6}$ are biased equally at about $[(1 / / 5) \\mathrm{k} \\Omega] \\times(9.5 \\mu \\mathrm{~A})=8 \\mathrm{mV}$ above $V_{E E}$. Moving the wiper off-center makes one transistor more conductive by bringing its emitter closer to $V_{E E}$, while the other remains about 8 mV above $V_{E E}$. This imbalance is empirically adjusted by the user to cancel any internal imbalance, achieving offset-less behavior.\n- **Input Voltage Range (IVR)**. In negative-feedback operation, the op amp forces $v_{N}$ to track $v_{P}$, making the common-mode input voltage $v_{I C}=1 / 2\\left(v_{P}+v_{N}\\right) \\cong v_{P}$. We seek the common-mode input voltage range, the values of $v_{I C}$ over which the input stage functions properly, with all BJTs in the forward-active region or at the edge of saturation (EOS). Referring to Fig. 5.1, the upper limit is reached when $Q_{1}$ hits EOS, so we use KVL to write $v_{P(\\max )} \\cong V_{C C}-V_{E B 8(\\text { (n) })}-V_{C E 1(\\mathrm{EOS})}+V_{B E 1(\\mathrm{on})}$. The lower limit is reached when $Q_{3}$ hits EOS, so $v_{P(\\text { min })} \\cong V_{E E}+V_{B E S(\\text { on })}+$ $V_{B E 7(\\text { on })}+V_{E C 3(\\mathrm{EOS})}+V_{B E 1(\\mathrm{on})}$. Setting $v_{P} \\rightarrow v_{I C}$ gives\n\n$$\n\\begin{equation*}\nv_{I C(\\max )} \\cong V_{C C}-V_{C E(\\mathrm{EOS})} \\quad v_{I C(\\min )} \\cong V_{E E}+3 V_{B E(\\mathrm{mn})}+V_{E C(\\mathrm{EOS})} \\tag{5.9}\n\\end{equation*}\n$$\n\n(This estimate ignores small voltage drops across $R_{1}, R_{2}$, and $R_{8}$, and assumes equal junction voltage drops.) Assuming typical junction drops of 0.7 V and EOS drops of 0.2 V, the estimates yield $v_{I C(\\max )} \\cong V_{C C}-0.2 \\mathrm{~V}$ and $v_{I C(\\min )} \\cong V_{E E}+2.3 \\mathrm{~V}$. With $\\pm 15-\\mathrm{V}$ supplies, the IVR is $-12.7 \\mathrm{~V} \\leq v_{I C} \\leq+14.8 \\mathrm{~V}$. Exceeding this IVR causes malfunction."
},
{
    "text": "Understanding the operation of this stage is best achieved by examining it immediately after power application. With all BJTs initially off, the first element to activate is the current $I_{R E F}$ from Fig 5.4, followed by $I_{1}$ through $I_{3}$. Initially, in Fig. 5.5, the entire $I_{1}$ flows into the bases of $Q_{3}$ and $Q_{4}$, causing them to turn on rapidly. As $Q_{3}$ and $Q_{4}$ conduct, $Q_{1}$ and $Q_{2}$ also conduct due to their series connection. $Q_{1}$ and $Q_{2}$ draw their collector currents from the diode-connected transistor $Q_{8}$, whose current is mirrored by $Q_{9}$ back to the node where $I_{1}$ initiated the sequence. This creates a negative-feedback loop, stabilizing the circuit at an operating point where the current $I_{C 9}$ returned by $Q_{9}$, plus the current $2 I_{B}$ from the bases of $Q_{3}$ and $Q_{4}$, equals $I_{1}$.\n\nFrom Chapter 4, we know the current returned by $Q_{9}$ has a fractional error of $-2 / \\beta_{F p}$ compared to $Q_{8}$, which may not be negligible due to the mediocre betas of lateral pnp BJTs. However, this error is neutralized by the current $2 I_{B}$ from the bases of $Q_{3}$ and $Q_{4}$, akin to error cancellation in Wilson current mirrors. Thus, each BJT in the input stage's halves carries a current of $I_{1} / 2$, or\n\n$$\n\\begin{equation*}\nI_{C 1}=I_{C 2}=I_{C 3}=I_{C 4}=I_{C 5}=I_{C 6}=\\frac{I_{1}}{2}=9.5 \\mu \\mathrm{~A} \\tag{5.4}\n\\end{equation*}\n$$\n\nThe base currents for $Q_{1}$ and $Q_{2}$ are\n\n$$\n\\begin{equation*}\nI_{P}=I_{N}=\\frac{I_{1} / 2}{\\beta_{F n}}=47.5 \\mathrm{nA} \\tag{5.5}\n\\end{equation*}\n$$\n\n(image_name:Figure 5.5, description:The circuit is part of the input stage of a 741 op-amp, featuring a differential amplifier with current mirrors and active loads. Transistors Q1 to Q4 form the differential pair and current mirror, Q5 and Q6 serve as active loads, and Q7 acts as a beta helper. The circuit is powered by VCC and VEE.)\n\nFIGURE 5.5 Circuit for the dc analysis of the input stage of the 741 op amp.\nAssuming $\\beta_{F n}=200$ for the $Q_{1}-Q_{2}$ pair, the op amp automatically draws these currents from the surrounding circuitry upon power-up. Referring to Fig. 5.1, both collectors of $Q_{5}$ and $Q_{6}$ are two $pn$-junction voltage drops above $V_{E E}$. Thus, besides being a beta helper, $Q_{7}$ ensures equal collector voltages for $Q_{5}$ and $Q_{6}$, as well as for $Q_{3}$ and $Q_{4}$, balancing the stage halves perfectly.\n\nNext, we determine the small-signal gain and input/output resistances of the input stage. This is simplified by using the half-circuit concept in Fig. 5.6a. Applying $v_{i d} / 2$ to $Q_{1}$ and $-v_{i d} / 2$ to $Q_{2}$ keeps the common base node of $Q_{3}$ and $Q_{4}$ at ac ground, allowing us to focus on one half, such as $Q_{1}$ and $Q_{3}$. Their small-signal emitter resistances $r_{e 1}$ and $r_{e 3}$ create a voltage division, resulting in an ac signal of\n\n(image_name:Figure 5.6 (a), description:The circuit is an AC analysis model of the input stage of a differential amplifier, using the half-circuit concept. Differential voltages are applied to transistors Q1 and Q2, with Q3 and Q4 forming a current mirror. Q5, Q6, and Q7 are part of the biasing and amplification stage, with resistors R1, R2, and R3 providing biasing and load resistance.)\n\n(a)\n(image_name:Figure 5.6 (b), description:[\nname: Rid, type: Resistor, value: 2.19 MΩ, ports: {N1: vid_plus, N2: vid_minus}\nname: Gm1, type: VoltageControlledCurrentSource, value: 1/5.47 kΩ, ports: {Np: vop, Nn: von}\nname: Ro1, type: Resistor, value: 6.12 MΩ, ports: {N1: vop, N2: von}\n]\nextrainfo:The circuit represents a small-signal model of a differential amplifier input stage, using a voltage-controlled current source for transconductance gain and resistors for biasing and load resistance.)\n\n(b)\n\nFIGURE 5.6 (a) Circuit for the ac analysis of the input stage, and (b) input-stage small-signal equivalent.\n$(1 / 2)\\left(v_{i d} / 2\\right)=v_{i d} / 4$. Thus, the ac current from $Q_{3}$'s collector is $i_{3}=g_{m 3} v_{i d} / 4$, and by symmetry, the ac current into $Q_{4}$'s collector is $i_{4}=g_{m 4} v_{i d} / 4$. The current mirror formed by $Q_{5}$ and $Q_{6}$ reflects $i_{3}$, resulting in a net short-circuit ac current of $i_{o 1(\\mathrm{sc})}=i_{3}+i_{4}=g_{m 3} v_{i d} / 4+g_{m 4} v_{i d} / 4=g_{m} v_{i d} / 2$, where $g_{m}$ is the same for both. This leads to\n\n$$\n\\begin{equation*}\nG_{m 1}=\\frac{i_{o l(\\mathrm{~s})}}{v_{i d}}=\\frac{g_{m}}{2}=\\frac{9.5 \\mu \\mathrm{~A}}{2 \\times 26 \\mathrm{mV}}=\\frac{1}{5.47 \\mathrm{k} \\Omega} \\tag{5.6}\n\\end{equation*}\n$$\n\nwhere $G_{m 1}$ is the first-stage transconductance. Inspecting $Q_{1}$'s base terminal, we find $R_{i d} / 2=r_{\\pi 1}+\\left(\\beta_{01}+1\\right) r_{e 3} \\cong r_{\\pi 1}+\\left(\\beta_{01}+1\\right) r_{e 1}=2 r_{\\pi 1}=2 r_{\\pi n}$, given $r_{e 3} \\cong r_{e 1}$. Thus,\n\n$$\n\\begin{equation*}\nR_{i d} \\cong 4 r_{\\pi n}=2.19 \\mathrm{M} \\Omega \\tag{5.7}\n\\end{equation*}\n$$\n\nassuming $\\beta_{0 n}=200$ for the $Q_{1}-Q_{2}$ pair. For the first stage's output terminal, we find $R_{o 1}=R_{c 4} / / R_{c 6} \\cong\\left[r_{o 4}\\left(1+g_{m 4} r_{e 2}\\right)\\right] / /$ $\\left[r_{o 6}\\left(1+g_{m 0} R_{2}\\right)\\right]$, or\n\n$$\n\\begin{equation*}\nR_{o 1} \\cong 2 r_{o 4} / / 1.37 r_{o 6}=6.12 \\mathrm{M} \\Omega \\tag{5.8}\n\\end{equation*}\n$$\n\nassuming $V_{A n}=100 \\mathrm{~V}$ and $V_{A p}=50 \\mathrm{~V}$. This completes the first stage's analysis, summarized in Fig. 5.6b.\n\nBefore concluding, we examine additional characteristics the user should be aware of, as listed in the manufacturer's data sheets.\n\n- **Input Bias Current $I_{B}$**: This is the average of the two input currents, $I_{B}=$ $1 / 2\\left(I_{P}+I_{N}\\right)$. According to Eq. (5.5), $I_{B}$ is around 50 nA and is significantly influenced by $\\beta_{F n}$. Mismatches in the betas of $Q_{1}$ and $Q_{2}$ result in an Input Offset Current $I_{O S}=I_{P}-I_{N}$. The 741 data sheets report typical values of $I_{B}=80 \\mathrm{nA}$ and $I_{O S}=20 \\mathrm{nA}$.\n- **Input Offset Voltage $V_{O S}$**: Due to $V_{B E}$ mismatches in the BJTs, this stage exhibits an input offset voltage $V_{O S}$. The 741 data sheets typically give $V_{O S}=2 \\mathrm{mV}$.\n- **Input Offset Nulling**: The 741 includes a provision for nulling input offset errors from $V_{O S}$ and $I_{O S}$ using an external $10-\\mathrm{k} \\Omega$ potentiometer with on-chip resistors $R_{1}$ and $R_{2}$, as shown in Fig. 5.5. With the wiper centered, the emitters of $Q_{5}$ and $Q_{6}$ are biased at about $[(1 / / 5) \\mathrm{k} \\Omega] \\times(9.5 \\mu \\mathrm{~A})=8 \\mathrm{mV}$ above $V_{E E}$. Adjusting the wiper empirically cancels out internal imbalances, achieving offset-less behavior.\n- **Input Voltage Range (IVR)**: In negative-feedback operation, the op amp forces $v_{N}$ to track $v_{P}$, making the common-mode input voltage $v_{I C}=1 / 2\\left(v_{P}+v_{N}\\right) \\cong v_{P}$. The common-mode input voltage range is the range of $v_{I C}$ where the input stage functions properly, with BJTs in the forward-active region or at the edge of saturation (EOS). Referring to Fig. 5.1, the upper limit is reached when $Q_{1}$ reaches EOS, so $v_{P(\\max )} \\cong V_{C C}-V_{E B 8(\\text { (n) })}-V_{C E 1(\\mathrm{EOS})}+V_{B E 1(\\mathrm{on})}$. The lower limit is when $Q_{3}$ reaches EOS, so $v_{P(\\text { min })} \\cong V_{E E}+V_{B E S(\\text { on })}+$ $V_{B E 7(\\text { on })}+V_{E C 3(\\mathrm{EOS})}+V_{B E 1(\\mathrm{on})}$. Thus,\n\n$$\n\\begin{equation*}\nv_{I C(\\max )} \\cong V_{C C}-V_{C E(\\mathrm{EOS})} \\quad v_{I C(\\min )} \\cong V_{E E}+3 V_{B E(\\mathrm{mn})}+V_{E C(\\mathrm{EOS})} \\tag{5.9}\n\\end{equation*}\n$$\n\n(Ignoring small voltage drops across $R_{1}, R_{2}$, and $R_{8}$, and assuming equal junction voltage drops.) Assuming typical junction drops of 0.7 V and EOS drops of 0.2 V, the IVR is $-12.7 \\mathrm{~V} \\leq v_{I C} \\leq+14.8 \\mathrm{~V}$ with $\\pm 15-\\mathrm{V}$ supplies. Exceeding this range causes malfunction."
},
{
    "text": "The operation of this stage is best understood by examining it immediately after power is applied. With all BJTs initially off, the first element to activate is the current $I_{R E F}$ from Fig 5.4, followed by $I_{1}$ through $I_{3}$. Initially, all of $I_{1}$ in Fig. 5.5 is drawn by the bases of $Q_{3}$ and $Q_{4}$, causing them to turn on rapidly. However, as $Q_{3}$ and $Q_{4}$ start conducting, $Q_{1}$ and $Q_{2}$ also conduct since they are in series with the former. $Q_{1}$ and $Q_{2}$ draw their collector currents from the diode-connected transistor $Q_{8}$, whose current is mirrored by $Q_{9}$ back to the node where $I_{1}$ initiated the sequence. This creates a negative-feedback loop, stabilizing the circuit at an operating point where the current $I_{C 9}$ returned by $Q_{9}$, plus the current $2 I_{B}$ from the bases of $Q_{3}$ and $Q_{4}$, equals $I_{1}$.\n\nFrom Chapter 4, we know that the current returned by $Q_{9}$, compared to $Q_{8}$, has a fractional error of $-2 / \\beta_{F p}$. This error can be significant due to the mediocre betas of lateral pnp BJTs. However, in this setup, this error is neutralized by the current $2 I_{B}$ returned by the bases of $Q_{3}$ and $Q_{4}$ themselves, akin to error cancellation in Wilson current mirrors. Thus, each BJT in the input stage's halves carries a current of $I_{1} / 2$, or\n\n$$\n\\begin{equation*}\nI_{C 1}=I_{C 2}=I_{C 3}=I_{C 4}=I_{C 5}=I_{C 6}=\\frac{I_{1}}{2}=9.5 \\mu \\mathrm{~A} \\tag{5.4}\n\\end{equation*}\n$$\n\nThe base currents for $Q_{1}$ and $Q_{2}$ are\n\n$$\n\\begin{equation*}\nI_{P}=I_{N}=\\frac{I_{1} / 2}{\\beta_{F n}}=47.5 \\mathrm{nA} \\tag{5.5}\n\\end{equation*}\n$$\n\nimage_name:Figure 5.5\ndescription:The circuit is part of the input stage of a 741 op-amp, featuring a differential amplifier with current mirrors and active loads. Transistors Q1 to Q4 form the differential pair and current mirror, Q5 and Q6 serve as active loads, and Q7 acts as a beta helper. The circuit is powered by VCC and VEE.\n\nFIGURE 5.5 Circuit for the dc analysis of the input stage of the 741 op amp.\nassuming $\\beta_{F n}=200$ for the $Q_{1}-Q_{2}$ pair. Once powered, the op amp automatically draws these currents from the surrounding circuitry. Referring to Fig. 5.1, we note that the collectors of $Q_{5}$ and $Q_{6}$ are two $p n$-junction voltage drops above $V_{E E}$. Thus, besides being a beta helper, $Q_{7}$ ensures equal collector voltages for $Q_{5}$ and $Q_{6}$, as well as for $Q_{3}$ and $Q_{4}$, achieving perfect balance in the stage's halves.\n\nNext, we aim to determine the small-signal gain and input/output resistances of the input stage. This is simplified by using the half-circuit concept of Fig. 5.6a. Applying $v_{i d} / 2$ to $Q_{1}$ and $-v_{i d} / 2$ to $Q_{2}$ keeps the common base node of $Q_{3}$ and $Q_{4}$ at ac ground, allowing us to focus on one half, say, $Q_{1}$ and $Q_{3}$. Their small-signal emitter resistances $r_{e 1}$ and $r_{e 3}$ create a voltage division, resulting in an ac signal of\n\nimage_name:Figure 5.6 (a)\ndescription:The circuit is an AC analysis model of a differential amplifier's input stage, using the half-circuit concept. Differential voltages are applied to transistors Q1 and Q2, with Q3 and Q4 forming a current mirror. Q5, Q6, and Q7 are part of the biasing and amplification stage, with resistors R1, R2, and R3 providing biasing and load resistance. The circuit leverages symmetry and small-signal models for analysis.\n\n(a)\nimage_name:Figure 5.6 (b)\ndescription:\n[\nname: Rid, type: Resistor, value: 2.19 MΩ, ports: {N1: vid_plus, N2: vid_minus}\nname: Gm1, type: VoltageControlledCurrentSource, value: 1/5.47 kΩ, ports: {Np: vop, Nn: von}\nname: Ro1, type: Resistor, value: 6.12 MΩ, ports: {N1: vop, N2: von}\n]\nextrainfo:The circuit represents a small-signal model of a differential amplifier input stage, using a voltage-controlled current source for transconductance gain. Resistors provide biasing and load resistance, illustrating the relationship between differential input voltage and output voltage.\n\n(b)\n\nFIGURE 5.6 (a) Circuit for the ac analysis of the input stage, and (b) input-stage small-signal equivalent.\n$(1 / 2)\\left(v_{i d} / 2\\right)=v_{i d} / 4$. Thus, the ac current from $Q_{3}$'s collector is $i_{3}=g_{m 3} v_{i d} / 4$, and by symmetry, the ac current into $Q_{4}$'s collector is $i_{4}=g_{m 4} v_{i d} / 4$. The current mirror of $Q_{5}$ and $Q_{6}$ reflects $i_{3}$, resulting in a net short-circuit ac current sunk from the output node of $i_{o 1(\\mathrm{sc})}=i_{3}+i_{4}=g_{m 3} v_{i d} / 4+g_{m 4} v_{i d} / 4=g_{m} v_{i d} / 2$, where $g_{m}$ is the same for both. This allows us to write\n\n$$\n\\begin{equation*}\nG_{m 1}=\\frac{i_{o l(\\mathrm{~s})}}{v_{i d}}=\\frac{g_{m}}{2}=\\frac{9.5 \\mu \\mathrm{~A}}{2 \\times 26 \\mathrm{mV}}=\\frac{1}{5.47 \\mathrm{k} \\Omega} \\tag{5.6}\n\\end{equation*}\n$$\n\nwhere $G_{m 1}$ is the first-stage transconductance. By inspecting $Q_{1}$'s base terminal, we find $R_{i d} / 2=r_{\\pi 1}+\\left(\\beta_{01}+1\\right) r_{e 3} \\cong r_{\\pi 1}+\\left(\\beta_{01}+1\\right) r_{e 1}=2 r_{\\pi 1}=2 r_{\\pi n}$, given $r_{e 3} \\cong r_{e 1}$. Therefore,\n\n$$\n\\begin{equation*}\nR_{i d} \\cong 4 r_{\\pi n}=2.19 \\mathrm{M} \\Omega \\tag{5.7}\n\\end{equation*}\n$$\n\nassuming $\\beta_{0 n}=200$ for the $Q_{1}-Q_{2}$ pair. Finally, examining the first stage's output terminal, we use inspection to write $R_{o 1}=R_{c 4} / / R_{c 6} \\cong\\left[r_{o 4}\\left(1+g_{m 4} r_{e 2}\\right)\\right] / /$ $\\left[r_{o 6}\\left(1+g_{m 0} R_{2}\\right)\\right]$, or\n\n$$\n\\begin{equation*}\nR_{o 1} \\cong 2 r_{o 4} / / 1.37 r_{o 6}=6.12 \\mathrm{M} \\Omega \\tag{5.8}\n\\end{equation*}\n$$\n\nassuming $V_{A n}=100 \\mathrm{~V}$ and $V_{A p}=50 \\mathrm{~V}$. This completes the first stage's analysis, with its small-signal characteristics summarized in Fig. 5.6b.\n\nBefore concluding, we examine additional characteristics the user should be aware of, as listed in the manufacturer's data sheets.\n\n- Input Bias Current $\\boldsymbol{I}_{B}$. This is the average of the two input currents, or $I_{B}=$ $1 / 2\\left(I_{P}+I_{N}\\right)$. According to Eq. (5.5), $I_{B}$ is around 50 nA and is strongly influenced by $\\beta_{F n}$. Mismatches in the betas of $Q_{1}$ and $Q_{2}$ result in an Input Offset Current $I_{O S}=I_{P}-I_{N}$. The 741 data sheets report typical values of $I_{B}=80 \\mathrm{nA}$ and $I_{O S}=20 \\mathrm{nA}$.\n- Input Offset Voltage $V_{O S}$. Due to $V_{B E}$ mismatches in the BJTs of the two halves, this stage exhibits an input offset voltage $V_{O S}$. The 741 data sheets typically give $V_{O S}=2 \\mathrm{mV}$.\n- Input Offset Nulling. The 741 includes a provision for nulling the input offset error from $V_{O S}$ and $I_{O S}$. This is achieved using an external $10-\\mathrm{k} \\Omega$ potentiometer with on-chip resistors $R_{1}$ and $R_{2}$, as shown in Fig. 5.5. With the wiper centered, the emitters of $Q_{5}$ and $Q_{6}$ are biased equally at about $[(1 / / 5) \\mathrm{k} \\Omega] \\times(9.5 \\mu \\mathrm{~A})=8 \\mathrm{mV}$ above $V_{E E}$. Moving the wiper away from center makes one transistor more conductive by bringing its emitter closer to $V_{E E}$, while the other remains about 8 mV above $V_{E E}$. This imbalance is adjusted empirically to cancel any internal imbalance, achieving offset-less behavior.\n- Input Voltage Range (IVR). In negative-feedback operation, the op amp forces $v_{N}$ to track $v_{P}$, so the common-mode input voltage is $v_{I C}=1 / 2\\left(v_{P}+v_{N}\\right) \\cong v_{P}$. We seek the common-mode input voltage range where the input stage functions properly, with BJTs in the forward-active region or at the edge of saturation (EOS). Referring to Fig. 5.1, the upper limit is reached when $Q_{1}$ reaches EOS, so $v_{P(\\max )} \\cong V_{C C}-V_{E B 8(\\text { (n) })}-V_{C E 1(\\mathrm{EOS})}+V_{B E 1(\\mathrm{on})}$. The lower limit is when $Q_{3}$ reaches EOS, so $v_{P(\\text { min })} \\cong V_{E E}+V_{B E S(\\text { on })}+$ $V_{B E 7(\\text { on })}+V_{E C 3(\\mathrm{EOS})}+V_{B E 1(\\mathrm{on})}$. Letting $v_{P} \\rightarrow v_{I C}$ gives\n\n$$\n\\begin{equation*}\nv_{I C(\\max )} \\cong V_{C C}-V_{C E(\\mathrm{EOS})} \\quad v_{I C(\\min )} \\cong V_{E E}+3 V_{B E(\\mathrm{mn})}+V_{E C(\\mathrm{EOS})} \\tag{5.9}\n\\end{equation*}\n$$\n\n(Ignoring small voltage drops across $R_{1}, R_{2}$, and $R_{8}$, and assuming equal junction voltage drops.) Assuming typical junction drops of 0.7 V and EOS drops of 0.2 V, the estimates are $v_{I C(\\max )} \\cong V_{C C}-0.2 \\mathrm{~V}$ and $v_{I C(\\min )} \\cong V_{E E}+2.3 \\mathrm{~V}$. With $\\pm 15-\\mathrm{V}$ supplies, the IVR is $-12.7 \\mathrm{~V} \\leq v_{I C} \\leq+14.8 \\mathrm{~V}$. Exceeding this range causes malfunction."
},
{
    "text": "The functionality of this stage is most clearly understood by examining it immediately after power is applied. With all BJTs initially off, the first element to activate is the current $I_{R E F}$ from Fig 5.4, followed by $I_{1}$ through $I_{3}$. Initially, in Fig. 5.5, the entire $I_{1}$ is drawn through the bases of $Q_{3}$ and $Q_{4}$, causing them to turn on rapidly. As $Q_{3}$ and $Q_{4}$ start conducting, $Q_{1}$ and $Q_{2}$ also conduct due to their series connection with the former. $Q_{1}$ and $Q_{2}$ draw their collector currents from the diode-connected transistor $Q_{8}$, whose current is mirrored by $Q_{9}$ back to the node where $I_{1}$ initiated the sequence. This creates a negative-feedback loop, stabilizing the circuit at an operating point where the current $I_{C 9}$ returned by $Q_{9}$, plus the current $2 I_{B}$ from the bases of $Q_{3}$ and $Q_{4}$, equals $I_{1}$.\n\nFrom Chapter 4, we know that the current returned by $Q_{9}$, relative to $Q_{8}$, has a fractional error of $-2 / \\beta_{F p}$. This error can be significant due to the mediocre betas of lateral pnp BJTs. However, in this setup, this error is neutralized by the current $2 I_{B}$ returned by the bases of $Q_{3}$ and $Q_{4}$ themselves, akin to error cancellation in Wilson current mirrors. Thus, each BJT in the input stage's halves carries a current of $I_{1} / 2$, or\n\n$$\n\\begin{equation*}\nI_{C 1}=I_{C 2}=I_{C 3}=I_{C 4}=I_{C 5}=I_{C 6}=\\frac{I_{1}}{2}=9.5 \\mu \\mathrm{~A} \\tag{5.4}\n\\end{equation*}\n$$\n\nThe base currents for $Q_{1}$ and $Q_{2}$ are\n\n$$\n\\begin{equation*}\nI_{P}=I_{N}=\\frac{I_{1} / 2}{\\beta_{F n}}=47.5 \\mathrm{nA} \\tag{5.5}\n\\end{equation*}\n$$\n\nimage_name:Figure 5.5\ndescription:The circuit is part of the input stage of a 741 op-amp, featuring a differential amplifier with current mirrors and active loads. Transistors Q1 to Q4 form the differential pair and current mirror, Q5 and Q6 serve as active loads, and Q7 acts as a beta helper. The circuit is powered by VCC and VEE.\n\nFIGURE 5.5 Circuit for the dc analysis of the input stage of the 741 op amp.\nassuming $\\beta_{F n}=200$ for the $Q_{1}-Q_{2}$ pair. Once powered, the op amp automatically draws these currents from the surrounding circuitry. Referring to Fig. 5.1, we note that the collectors of $Q_{5}$ and $Q_{6}$ are two $p n$-junction voltage drops above $V_{E E}$. Thus, besides serving as a beta helper, $Q_{7}$ ensures equal collector voltages for $Q_{5}$ and $Q_{6}$ as well as for $Q_{3}$ and $Q_{4}$, achieving perfect balance in the stage's halves.\n\nNext, we aim to determine the small-signal gain and input/output resistances of the input stage. This is simplified by using the half-circuit concept from Fig. 5.6a. Applying $v_{i d} / 2$ to $Q_{1}$ and $-v_{i d} / 2$ to $Q_{2}$ keeps the common base node of $Q_{3}$ and $Q_{4}$ at ac ground, allowing us to focus on one half, say, $Q_{1}$ and $Q_{3}$. Their small-signal emitter resistances $r_{e 1}$ and $r_{e 3}$ result in a voltage division by two, yielding an ac signal of\n\nimage_name:Figure 5.6 (a)\ndescription:The circuit is an AC analysis model of a differential amplifier's input stage, using the half-circuit concept to simplify analysis by applying differential voltages to transistors Q1 and Q2. Q3 and Q4 form a current mirror, while Q5, Q6, and Q7 are part of the biasing and amplification stage. Resistors R1, R2, and R3 provide biasing and load resistance, exploiting symmetry and small-signal models for analysis.\n\n(a)\nimage_name:Figure 5.6 (b)\ndescription:\n[\nname: Rid, type: Resistor, value: 2.19 MΩ, ports: {N1: vid_plus, N2: vid_minus}\nname: Gm1, type: VoltageControlledCurrentSource, value: 1/5.47 kΩ, ports: {Np: vop, Nn: von}\nname: Ro1, type: Resistor, value: 6.12 MΩ, ports: {N1: vop, N2: von}\n]\nextrainfo:The circuit represents a small-signal model of a differential amplifier input stage, using a voltage-controlled current source for transconductance gain. Resistors provide biasing and load resistance, illustrating the relationship between differential input voltage and output voltage.\n\n(b)\n\nFIGURE 5.6 (a) Circuit for the ac analysis of the input stage, and (b) input-stage small-signal equivalent.\n$(1 / 2)\\left(v_{i d} / 2\\right)=v_{i d} / 4$. Thus, the ac current from $Q_{3}$'s collector is $i_{3}=g_{m 3} v_{i d} / 4$, and by symmetry, the ac current into $Q_{4}$'s collector is $i_{4}=g_{m 4} v_{i d} / 4$. The current mirror formed by $Q_{5}$ and $Q_{6}$ reflects $i_{3}$, resulting in a net short-circuit ac current of $i_{o 1(\\mathrm{sc})}=i_{3}+i_{4}=g_{m 3} v_{i d} / 4+g_{m 4} v_{i d} / 4=g_{m} v_{i d} / 2$, where $g_{m}$ is assumed identical for both. This allows us to write\n\n$$\n\\begin{equation*}\nG_{m 1}=\\frac{i_{o l(\\mathrm{~s})}}{v_{i d}}=\\frac{g_{m}}{2}=\\frac{9.5 \\mu \\mathrm{~A}}{2 \\times 26 \\mathrm{mV}}=\\frac{1}{5.47 \\mathrm{k} \\Omega} \\tag{5.6}\n\\end{equation*}\n$$\n\nwhere $G_{m 1}$ is the first-stage transconductance. Inspecting $Q_{1}$'s base terminal, we find $R_{i d} / 2=r_{\\pi 1}+\\left(\\beta_{01}+1\\right) r_{e 3} \\cong r_{\\pi 1}+\\left(\\beta_{01}+1\\right) r_{e 1}=2 r_{\\pi 1}=2 r_{\\pi n}$, using $r_{e 3} \\cong r_{e 1}$. Therefore,\n\n$$\n\\begin{equation*}\nR_{i d} \\cong 4 r_{\\pi n}=2.19 \\mathrm{M} \\Omega \\tag{5.7}\n\\end{equation*}\n$$\n\nassuming $\\beta_{0 n}=200$ for the $Q_{1}-Q_{2}$ pair. For the first stage's output terminal, inspection yields $R_{o 1}=R_{c 4} / / R_{c 6} \\cong\\left[r_{o 4}\\left(1+g_{m 4} r_{e 2}\\right)\\right] / /$ $\\left[r_{o 6}\\left(1+g_{m 0} R_{2}\\right)\\right]$, or\n\n$$\n\\begin{equation*}\nR_{o 1} \\cong 2 r_{o 4} / / 1.37 r_{o 6}=6.12 \\mathrm{M} \\Omega \\tag{5.8}\n\\end{equation*}\n$$\n\nassuming $V_{A n}=100 \\mathrm{~V}$ and $V_{A p}=50 \\mathrm{~V}$. This completes the first stage's analysis, with its small-signal characteristics summarized in Fig. 5.6b.\n\nBefore concluding, we examine additional characteristics the user should be aware of, as listed in the manufacturer's data sheets.\n\n- **Input Bias Current** $\\boldsymbol{I}_{B}$. This is the average of the two input currents, $I_{B}=$ $1 / 2\\left(I_{P}+I_{N}\\right)$. According to Eq. (5.5), $I_{B}$ is around 50 nA and is significantly influenced by $\\beta_{F n}$. Mismatches in the betas of $Q_{1}$ and $Q_{2}$ result in an Input Offset Current $I_{O S}=I_{P}-I_{N}$. The 741 data sheets report typical values of $I_{B}=80 \\mathrm{nA}$ and $I_{O S}=20 \\mathrm{nA}$.\n- **Input Offset Voltage** $V_{O S}$. Due to $V_{B E}$ mismatches in the BJTs of the two halves, this stage exhibits an input offset voltage $V_{O S}$. The 741 data sheets typically give $V_{O S}=2 \\mathrm{mV}$.\n- **Input Offset Nulling**. The 741 includes provisions for nulling input offset errors from $V_{O S}$ and $I_{O S}$ using an external $10-\\mathrm{k} \\Omega$ potentiometer with on-chip resistors $R_{1}$ and $R_{2}$, as shown in Fig. 5.5. With the wiper centered, the emitters of $Q_{5}$ and $Q_{6}$ are biased at about $[(1 / / 5) \\mathrm{k} \\Omega] \\times(9.5 \\mu \\mathrm{~A})=8 \\mathrm{mV}$ above $V_{E E}$. Adjusting the wiper away from center makes one transistor more conductive by bringing its emitter closer to $V_{E E}$, while the other remains about 8 mV above $V_{E E}$. This external imbalance is empirically adjusted to cancel internal imbalances, achieving offset-less behavior.\n- **Input Voltage Range (IVR)**. In negative-feedback operation, the op amp forces $v_{N}$ to track $v_{P}$, so the common-mode input voltage is $v_{I C}=1 / 2\\left(v_{P}+v_{N}\\right) \\cong v_{P}$. We seek the common-mode input voltage range, where the input stage functions properly with BJTs in the forward-active region or at the edge of saturation (EOS). Referring to Fig. 5.1, the upper limit is reached when $Q_{1}$ reaches EOS, so $v_{P(\\max )} \\cong V_{C C}-V_{E B 8(\\text { (n) })}-V_{C E 1(\\mathrm{EOS})}+V_{B E 1(\\mathrm{on})}$. The lower limit is when $Q_{3}$ reaches EOS, so $v_{P(\\text { min })} \\cong V_{E E}+V_{B E S(\\text { on })}+$ $V_{B E 7(\\text { on })}+V_{E C 3(\\mathrm{EOS})}+V_{B E 1(\\mathrm{on})}$. Setting $v_{P} \\rightarrow v_{I C}$ gives\n\n$$\n\\begin{equation*}\nv_{I C(\\max )} \\cong V_{C C}-V_{C E(\\mathrm{EOS})} \\quad v_{I C(\\min )} \\cong V_{E E}+3 V_{B E(\\mathrm{mn})}+V_{E C(\\mathrm{EOS})} \\tag{5.9}\n\\end{equation*}\n$$\n\n(Ignoring small voltage drops across $R_{1}, R_{2}$, and $R_{8}$, and assuming equal junction voltage drops.) Assuming typical junction drops of 0.7 V and EOS drops of 0.2 V, we get $v_{I C(\\max )} \\cong V_{C C}-0.2 \\mathrm{~V}$ and $v_{I C(\\min )} \\cong V_{E E}+2.3 \\mathrm{~V}$. With $\\pm 15-\\mathrm{V}$ supplies, the IVR is $-12.7 \\mathrm{~V} \\leq v_{I C} \\leq+14.8 \\mathrm{~V}$. Exceeding this range causes malfunction."
},
{
    "text": "The operation of this stage is best understood by examining it immediately after power is applied. With all BJTs initially off, the first element to activate is the current $I_{R E F}$ from Fig 5.4, followed by $I_{1}$ through $I_{3}$. Initially, all of $I_{1}$ in Fig. 5.5 is drawn through the bases of $Q_{3}$ and $Q_{4}$, causing them to turn on rapidly. However, as $Q_{3}$ and $Q_{4}$ start conducting, $Q_{1}$ and $Q_{2}$ also conduct since they are in series with the former. $Q_{1}$ and $Q_{2}$ draw their collector currents from the diode-connected transistor $Q_{8}$, whose current is mirrored by $Q_{9}$ back to the node where $I_{1}$ initiated the sequence. This creates a negative-feedback loop, stabilizing the circuit at an operating point where the current $I_{C 9}$ returned by $Q_{9}$, plus the current $2 I_{B}$ from the bases of $Q_{3}$ and $Q_{4}$, equals $I_{1}$.\n\nFrom Chapter 4, we know that the current returned by $Q_{9}$, compared to $Q_{8}$, has a fractional error of $-2 / \\beta_{F p}$. This error might not be negligible due to the mediocre betas of lateral pnp BJTs. However, in this setup, this error is offset by the current $2 I_{B}$ returned by the bases of $Q_{3}$ and $Q_{4}$ themselves, similar to error cancellation in Wilson current mirrors. Thus, each half of the input stage's BJTs carries a current of $I_{1} / 2$, or\n\n$$\n\\begin{equation*}\nI_{C 1}=I_{C 2}=I_{C 3}=I_{C 4}=I_{C 5}=I_{C 6}=\\frac{I_{1}}{2}=9.5 \\mu \\mathrm{~A} \\tag{5.4}\n\\end{equation*}\n$$\n\nThe base currents for $Q_{1}$ and $Q_{2}$ are\n\n$$\n\\begin{equation*}\nI_{P}=I_{N}=\\frac{I_{1} / 2}{\\beta_{F n}}=47.5 \\mathrm{nA} \\tag{5.5}\n\\end{equation*}\n$$\n\n**Figure 5.5 Description:**\nThe circuit is part of the input stage of a 741 op-amp, featuring a differential amplifier with current mirrors and active loads. Transistors Q1 to Q4 form the differential pair and current mirror, while Q5 and Q6 serve as active loads and Q7 as a beta helper. The circuit is powered by VCC and VEE.\n\n**FIGURE 5.5:** Circuit for the dc analysis of the input stage of the 741 op amp.\nAssuming $\\beta_{F n}=200$ for the $Q_{1}-Q_{2}$ pair, the op amp automatically draws these currents from the surrounding circuitry upon powering. Referring to Fig. 5.1, we note that the collectors of $Q_{5}$ and $Q_{6}$ are two $p n$-junction voltage drops above $V_{E E}$. Consequently, besides acting as a beta helper, $Q_{7}$ ensures equal collector voltages for $Q_{5}$ and $Q_{6}$ as well as for $Q_{3}$ and $Q_{4}$, thus balancing the two halves of the stage.\n\nNext, we aim to determine the small-signal gain and the input/output resistances of the input stage. This task is simplified by using the half-circuit concept shown in Fig. 5.6a. By applying $v_{i d} / 2$ to $Q_{1}$ and $-v_{i d} / 2$ to $Q_{2}$, we keep the common base node of $Q_{3}$ and $Q_{4}$ at ac ground, allowing us to focus on one half, such as $Q_{1}$ and $Q_{3}$. Their small-signal emitter resistances $r_{e 1}$ and $r_{e 3}$ cause a voltage division by two, resulting in an ac signal of\n\n**Figure 5.6 (a) Description:**\nThis circuit is an AC analysis model of the input stage of a differential amplifier, using the half-circuit concept to simplify analysis by applying differential voltages to transistors Q1 and Q2. Q3 and Q4 form a current mirror configuration, while Q5, Q6, and Q7 are part of the biasing and amplification stage. Resistors R1, R2, and R3 provide biasing and load resistance, exploiting symmetry and small-signal models for analysis.\n\n(a)\n\n**Figure 5.6 (b) Description:**\nThe circuit represents a small-signal model of a differential amplifier input stage, using a voltage-controlled current source to model the transconductance gain. Resistors provide biasing and load resistance, illustrating the relationship between the differential input voltage and the output voltage.\n\n(b)\n\n**FIGURE 5.6 (a):** Circuit for the ac analysis of the input stage, and (b) input-stage small-signal equivalent.\n$(1 / 2)\\left(v_{i d} / 2\\right)=v_{i d} / 4$ at their shared emitter terminals. Thus, the ac current out of $Q_{3}$'s collector is $i_{3}=g_{m 3} v_{i d} / 4$, and by symmetry, the ac current into $Q_{4}$'s collector is $i_{4}=g_{m 4} v_{i d} / 4$. The current mirror formed by $Q_{5}$ and $Q_{6}$ reflects $i_{3}$, resulting in a net short-circuit ac current sunk from the output node of $i_{o 1(\\mathrm{sc})}=i_{3}+i_{4}=g_{m 3} v_{i d} / 4+g_{m 4} v_{i d} / 4=g_{m} v_{i d} / 2$, where $g_{m}$ is the same for both transistors. This allows us to write\n\n$$\n\\begin{equation*}\nG_{m 1}=\\frac{i_{o l(\\mathrm{~s})}}{v_{i d}}=\\frac{g_{m}}{2}=\\frac{9.5 \\mu \\mathrm{~A}}{2 \\times 26 \\mathrm{mV}}=\\frac{1}{5.47 \\mathrm{k} \\Omega} \\tag{5.6}\n\\end{equation*}\n$$\n\nwhere $G_{m 1}$ is the first-stage transconductance. By inspecting $Q_{1}$'s base terminal, we find $R_{i d} / 2=r_{\\pi 1}+\\left(\\beta_{01}+1\\right) r_{e 3} \\cong r_{\\pi 1}+\\left(\\beta_{01}+1\\right) r_{e 1}=2 r_{\\pi 1}=2 r_{\\pi n}$, using $r_{e 3} \\cong r_{e 1}$. Consequently,\n\n$$\n\\begin{equation*}\nR_{i d} \\cong 4 r_{\\pi n}=2.19 \\mathrm{M} \\Omega \\tag{5.7}\n\\end{equation*}\n$$\n\nassuming $\\beta_{0 n}=200$ for the $Q_{1}-Q_{2}$ pair. Finally, examining the first stage's output terminal, we use inspection to write $R_{o 1}=R_{c 4} / / R_{c 6} \\cong\\left[r_{o 4}\\left(1+g_{m 4} r_{e 2}\\right)\\right] / / \\left[r_{o 6}\\left(1+g_{m 0} R_{2}\\right)\\right]$, or\n\n$$\n\\begin{equation*}\nR_{o 1} \\cong 2 r_{o 4} / / 1.37 r_{o 6}=6.12 \\mathrm{M} \\Omega \\tag{5.8}\n\\end{equation*}\n$$\n\nassuming $V_{A n}=100 \\mathrm{~V}$ and $V_{A p}=50 \\mathrm{~V}$. This completes the analysis of the first stage, summarized in Fig. 5.6b.\n\nBefore concluding, we examine additional characteristics the user should be aware of, as listed in the manufacturer's data sheets:\n\n- **Input Bias Current $I_{B}$**: This is the average of the two input currents, $I_{B}=$ $1 / 2\\left(I_{P}+I_{N}\\right)$. According to Eq. (5.5), $I_{B}$ is around 50 nA and is strongly influenced by $\\beta_{F n}$. Mismatches in the betas of $Q_{1}$ and $Q_{2}$ result in an Input Offset Current $I_{O S}=I_{P}-I_{N}$. The 741 data sheets report typical values of $I_{B}=80 \\mathrm{nA}$ and $I_{O S}=20 \\mathrm{nA}$.\n- **Input Offset Voltage $V_{O S}$**: Due to $V_{B E}$ mismatches in the BJTs of the two halves, this stage exhibits an input offset voltage $V_{O S}$. The 741 data sheets give a typical $V_{O S}=2 \\mathrm{mV}$.\n- **Input Offset Nulling**: The 741 includes a provision for nulling the input offset error from $V_{O S}$ and $I_{O S}$ using an external $10-\\mathrm{k} \\Omega$ potentiometer with on-chip resistors $R_{1}$ and $R_{2}$, as shown in Fig. 5.5. With the wiper centered, the emitters of $Q_{5}$ and $Q_{6}$ are biased at about $[(1 / / 5) \\mathrm{k} \\Omega] \\times(9.5 \\mu \\mathrm{~A})=8 \\mathrm{mV}$ above $V_{E E}$. Adjusting the wiper empirically cancels out any internal imbalance, achieving offset-less behavior.\n- **Input Voltage Range (IVR)**: In negative-feedback operation, the op amp forces $v_{N}$ to track $v_{P}$, so the common-mode input voltage is $v_{I C}=1 / 2\\left(v_{P}+v_{N}\\right) \\cong v_{P}$. We determine the common-mode input voltage range where the input stage functions properly, with BJTs in the forward-active region or at the edge of saturation (EOS). Referring to Fig. 5.1, the upper limit is reached when $Q_{1}$ reaches EOS, so $v_{P(\\max )} \\cong V_{C C}-V_{E B 8(\\text { (n) })}-V_{C E 1(\\mathrm{EOS})}+V_{B E 1(\\mathrm{on})}$. The lower limit is when $Q_{3}$ reaches EOS, so $v_{P(\\text { min })} \\cong V_{E E}+V_{B E S(\\text { on })}+V_{B E 7(\\text { on })}+V_{E C 3(\\mathrm{EOS})}+V_{B E 1(\\mathrm{on})}$. Letting $v_{P} \\rightarrow v_{I C}$ gives\n\n$$\n\\begin{equation*}\nv_{I C(\\max )} \\cong V_{C C}-V_{C E(\\mathrm{EOS})} \\quad v_{I C(\\min )} \\cong V_{E E}+3 V_{B E(\\mathrm{mn})}+V_{E C(\\mathrm{EOS})} \\tag{5.9}\n\\end{equation*}\n$$\n\n(Ignoring small voltage drops across $R_{1}$, $R_{2}$, and $R_{8}$, and assuming equal junction voltage drops.) Assuming typical junction drops of 0.7 V and EOS drops of 0.2 V, the IVR is $-12.7 \\mathrm{~V} \\leq v_{I C} \\leq+14.8 \\mathrm{~V}$ with $\\pm 15-\\mathrm{V}$ supplies. Exceeding this range causes malfunction."
},
{
    "text": "Understanding the operation of this stage is most effective by examining it immediately after power is applied. With all BJTs initially off, the first element to activate is the current $I_{R E F}$ from Fig 5.4, followed by $I_{1}$ through $I_{3}$. At the outset, the entire $I_{1}$ in Fig. 5.5 is drawn through the bases of $Q_{3}$ and $Q_{4}$, leading to their swift activation. However, as $Q_{3}$ and $Q_{4}$ begin to conduct, $Q_{1}$ and $Q_{2}$ also start conducting since they are in series with the former. $Q_{1}$ and $Q_{2}$ derive their collector currents from the diode-connected transistor $Q_{8}$, whose current is mirrored by $Q_{9}$ back to the node where $I_{1}$ initiated the sequence. This creates a negative-feedback scenario where the circuit stabilizes at an operating point where the current $I_{C 9}$ returned by $Q_{9}$, combined with the current $2 I_{B}$ from the bases of $Q_{3}$ and $Q_{4}$, equals $I_{1}$.\n\nFrom Chapter 4, we know that the current returned by $Q_{9}$, relative to $Q_{8}$, incurs a fractional error of $-2 / \\beta_{F p}$. This error is not negligible, given the mediocre betas of lateral pnp BJTs. However, in this configuration, this error is neutralized by the current $2 I_{B}$ returned by the bases of $Q_{3}$ and $Q_{4}$ themselves, akin to error cancellation in Wilson current mirrors. Consequently, each half of the input stage's BJTs carries a current of $I_{1} / 2$, or\n\n$$\n\\begin{equation*}\nI_{C 1}=I_{C 2}=I_{C 3}=I_{C 4}=I_{C 5}=I_{C 6}=\\frac{I_{1}}{2}=9.5 \\mu \\mathrm{~A} \\tag{5.4}\n\\end{equation*}\n$$\n\nThe base currents for $Q_{1}$ and $Q_{2}$ are\n\n$$\n\\begin{equation*}\nI_{P}=I_{N}=\\frac{I_{1} / 2}{\\beta_{F n}}=47.5 \\mathrm{nA} \\tag{5.5}\n\\end{equation*}\n$$\n\n(image description: The circuit is part of the input stage of a 741 op-amp, featuring a differential amplifier with current mirrors and active loads. Transistors Q1 to Q4 form the differential pair and current mirror, Q5 and Q6 serve as active loads, and Q7 functions as a beta helper. The circuit is powered by VCC and VEE.)\n\nFIGURE 5.5 Circuit for the dc analysis of the input stage of the 741 op amp.\nAssuming $\\beta_{F n}=200$ for the $Q_{1}-Q_{2}$ pair, the op amp automatically draws these currents from the surrounding circuitry upon powering. Referring to Fig. 5.1, we note that the collectors of $Q_{5}$ and $Q_{6}$ are two $p n$-junction voltage drops above $V_{E E}$. Thus, besides acting as a beta helper, $Q_{7}$ ensures equal collector voltages for $Q_{5}$ and $Q_{6}$ as well as for $Q_{3}$ and $Q_{4}$, achieving perfect balance in the stage's two halves.\n\nTo determine the small-signal gain and input/output resistances of the input stage, the half-circuit concept of Fig. 5.6a simplifies the task. By applying $v_{i d} / 2$ to $Q_{1}$ and $-v_{i d} / 2$ to $Q_{2}$, the common base node of $Q_{3}$ and $Q_{4}$ remains at ac ground, allowing us to focus on one half, say, $Q_{1}$ and $Q_{3}$. Their small-signal emitter resistances $r_{e 1}$ and $r_{e 3}$ cause a voltage division by two, resulting in an ac signal at their shared emitter terminals of\n\n(image description: The circuit is an AC analysis model of the input stage of a differential amplifier, using the half-circuit concept. Differential voltages are applied to transistors Q1 and Q2, with Q3 and Q4 forming a current mirror configuration. Q5, Q6, and Q7 are part of the biasing and amplification stage, with resistors R1, R2, and R3 providing biasing and load resistance. The circuit utilizes symmetry and small-signal models for analysis.)\n\n(image description: The circuit represents a small-signal model of a differential amplifier input stage, featuring a voltage-controlled current source for transconductance gain and resistors for biasing and load resistance. It illustrates the relationship between the differential input voltage and the output voltage.)\n\nFIGURE 5.6 (a) Circuit for the ac analysis of the input stage, and (b) input-stage small-signal equivalent.\n$(1 / 2)\\left(v_{i d} / 2\\right)=v_{i d} / 4$. Thus, the ac current from $Q_{3}$'s collector is $i_{3}=g_{m 3} v_{i d} / 4$, and by symmetry, the ac current into $Q_{4}$'s collector is $i_{4}=g_{m 4} v_{i d} / 4$. The current mirror formed by $Q_{5}$ and $Q_{6}$ reflects $i_{3}$, resulting in a net short-circuit ac current sunk from the output node of $i_{o 1(\\mathrm{sc})}=i_{3}+i_{4}=g_{m 3} v_{i d} / 4+g_{m 4} v_{i d} / 4=g_{m} v_{i d} / 2$, where $g_{m}$ is the same for both transistors. This allows us to write\n\n$$\n\\begin{equation*}\nG_{m 1}=\\frac{i_{o l(\\mathrm{~s})}}{v_{i d}}=\\frac{g_{m}}{2}=\\frac{9.5 \\mu \\mathrm{~A}}{2 \\times 26 \\mathrm{mV}}=\\frac{1}{5.47 \\mathrm{k} \\Omega} \\tag{5.6}\n\\end{equation*}\n$$\n\nwhere $G_{m 1}$ is the first-stage transconductance. Inspecting $Q_{1}$'s base terminal reveals $R_{i d} / 2=r_{\\pi 1}+\\left(\\beta_{01}+1\\right) r_{e 3} \\cong r_{\\pi 1}+\\left(\\beta_{01}+1\\right) r_{e 1}=2 r_{\\pi 1}=2 r_{\\pi n}$, given $r_{e 3} \\cong r_{e 1}$. Consequently,\n\n$$\n\\begin{equation*}\nR_{i d} \\cong 4 r_{\\pi n}=2.19 \\mathrm{M} \\Omega \\tag{5.7}\n\\end{equation*}\n$$\n\nassuming $\\beta_{0 n}=200$ for the $Q_{1}-Q_{2}$ pair. Finally, examining the first stage's output terminal, we find $R_{o 1}=R_{c 4} / / R_{c 6} \\cong\\left[r_{o 4}\\left(1+g_{m 4} r_{e 2}\\right)\\right] / /$ $\\left[r_{o 6}\\left(1+g_{m 0} R_{2}\\right)\\right]$, or\n\n$$\n\\begin{equation*}\nR_{o 1} \\cong 2 r_{o 4} / / 1.37 r_{o 6}=6.12 \\mathrm{M} \\Omega \\tag{5.8}\n\\end{equation*}\n$$\n\nassuming $V_{A n}=100 \\mathrm{~V}$ and $V_{A p}=50 \\mathrm{~V}$. This completes the analysis of the first stage, with its small-signal characteristics summarized in Fig. 5.6b.\n\nBefore concluding, we examine additional characteristics the user should be aware of, as listed in the manufacturer's data sheets.\n\n- **Input Bias Current** $\\boldsymbol{I}_{B}$. This is the average of the two input currents, or $I_{B}=$ $1 / 2\\left(I_{P}+I_{N}\\right)$. According to Eq. (5.5), $I_{B}$ ranges around 50 nA and is significantly influenced by $\\beta_{F n}$. Mismatches in the betas of $Q_{1}$ and $Q_{2}$ result in an Input Offset Current $I_{O S}=I_{P}-I_{N}$. The 741 data sheets, available online, typically report $I_{B}=80 \\mathrm{nA}$ and $I_{O S}=20 \\mathrm{nA}$.\n- **Input Offset Voltage** $V_{O S}$. Due to $V_{B E}$ mismatches in the BJTs of the two halves, this stage exhibits an input offset voltage $V_{O S}$. The 741 data sheets typically give $V_{O S}=2 \\mathrm{mV}$.\n- **Input Offset Nulling**. The 741 includes a provision for nulling the input offset error caused by $V_{O S}$ and $I_{O S}$. This is achieved using an external $10-\\mathrm{k} \\Omega$ potentiometer in conjunction with on-chip resistors $R_{1}$ and $R_{2}$, as shown in Fig. 5.5. With the wiper centered, the emitters of $Q_{5}$ and $Q_{6}$ are biased equally at about $[(1 / / 5) \\mathrm{k} \\Omega] \\times(9.5 \\mu \\mathrm{~A})=8 \\mathrm{mV}$ above $V_{E E}$. Adjusting the wiper away from the center makes one transistor more conductive by bringing its emitter closer to $V_{E E}$, while the other remains about 8 mV above $V_{E E}$. This external imbalance is empirically adjusted by the user to cancel any internal imbalance, achieving offset-less behavior.\n- **Input Voltage Range (IVR)**. In negative-feedback operation, the op amp forces $v_{N}$ to track $v_{P}$, so the common-mode input voltage is $v_{I C}=1 / 2\\left(v_{P}+v_{N}\\right) \\cong v_{P}$. We seek the common-mode input voltage range, the range of $v_{I C}$ values over which the input stage functions properly, with all BJTs in the forward-active region or at most at the edge of saturation (EOS). Referring to Fig. 5.1, the upper limit is reached when $Q_{1}$ is driven to EOS, so we use KVL to write $v_{P(\\max )} \\cong V_{C C}-V_{E B 8(\\text { (n) })}-V_{C E 1(\\mathrm{EOS})}+V_{B E 1(\\mathrm{on})}$. The lower limit is reached when $Q_{3}$ is driven to EOS, so $v_{P(\\text { min })} \\cong V_{E E}+V_{B E S(\\text { on })}+$ $V_{B E 7(\\text { on })}+V_{E C 3(\\mathrm{EOS})}+V_{B E 1(\\mathrm{on})}$. Letting $v_{P} \\rightarrow v_{I C}$ gives\n\n$$\n\\begin{equation*}\nv_{I C(\\max )} \\cong V_{C C}-V_{C E(\\mathrm{EOS})} \\quad v_{I C(\\min )} \\cong V_{E E}+3 V_{B E(\\mathrm{mn})}+V_{E C(\\mathrm{EOS})} \\tag{5.9}\n\\end{equation*}\n$$\n\n(Ignoring small voltage drops across $R_{1}, R_{2}$, and $R_{8}$, and assuming equal junction voltage drops.) Assuming typical junction drops of 0.7 V and EOS drops of 0.2 V, the estimates yield $v_{I C(\\max )} \\cong V_{C C}-0.2 \\mathrm{~V}$ and $v_{I C(\\min )} \\cong V_{E E}+2.3 \\mathrm{~V}$. With $\\pm 15-\\mathrm{V}$ supplies, the IVR is $-12.7 \\mathrm{~V} \\leq v_{I C} \\leq+14.8 \\mathrm{~V}$. Exceeding this IVR causes malfunction."
},
{
    "text": "The functionality of this stage is best comprehended by analyzing it immediately after power application. With all BJTs initially off, the first element to activate is the current $I_{R E F}$ from Fig 5.4, followed by $I_{1}$ through $I_{3}$. Initially, in Fig. 5.5, the entire $I_{1}$ flows into the bases of $Q_{3}$ and $Q_{4}$, causing them to turn on rapidly. As $Q_{3}$ and $Q_{4}$ conduct, $Q_{1}$ and $Q_{2}$ also conduct since they are in series with the former. $Q_{1}$ and $Q_{2}$ draw their collector currents from the diode-connected transistor $Q_{8}$, whose current is mirrored by $Q_{9}$ back to the node where $I_{1}$ initiated the sequence. This creates a negative-feedback loop, stabilizing the circuit at an operating point where the current $I_{C 9}$ returned by $Q_{9}$, plus the current $2 I_{B}$ from the bases of $Q_{3}$ and $Q_{4}$, equals $I_{1}$.\n\nFrom Chapter 4, we know the current returned by $Q_{9}$ has a fractional error of $-2 / \\beta_{F p}$ compared to $Q_{8}$, which might not be negligible due to the mediocre betas of lateral pnp BJTs. However, in this setup, this error is neutralized by the current $2 I_{B}$ from the bases of $Q_{3}$ and $Q_{4}$ themselves, akin to error cancellation in Wilson current mirrors. Thus, each BJT in the input stage's halves carries a current of $I_{1} / 2$, or\n\n$$\n\\begin{equation*}\nI_{C 1}=I_{C 2}=I_{C 3}=I_{C 4}=I_{C 5}=I_{C 6}=\\frac{I_{1}}{2}=9.5 \\mu \\mathrm{~A} \\tag{5.4}\n\\end{equation*}\n$$\n\nThe base currents for $Q_{1}$ and $Q_{2}$ are\n\n$$\n\\begin{equation*}\nI_{P}=I_{N}=\\frac{I_{1} / 2}{\\beta_{F n}}=47.5 \\mathrm{nA} \\tag{5.5}\n\\end{equation*}\n$$\n\nimage_name:Figure 5.5\ndescription:The circuit is part of the input stage of a 741 op-amp, featuring a differential amplifier with current mirrors and active loads. Transistors Q1 to Q4 form the differential pair and current mirror, while Q5 and Q6 serve as active loads and Q7 as a beta helper. The circuit is powered by VCC and VEE.\n\nFIGURE 5.5 Circuit for the dc analysis of the input stage of the 741 op amp.\nassuming $\\beta_{F n}=200$ for the $Q_{1}-Q_{2}$ pair. Upon powering, the op amp automatically draws these currents from the surrounding circuitry. Referring to Fig. 5.1, we note that the collectors of $Q_{5}$ and $Q_{6}$ are two $p n$-junction voltage drops above $V_{E E}$. Thus, besides acting as a beta helper, $Q_{7}$ ensures equal collector voltages for $Q_{5}$ and $Q_{6}$, as well as for $Q_{3}$ and $Q_{4}$, balancing the stage halves perfectly.\n\nNext, we aim to determine the small-signal gain and input/output resistances of the input stage. This is simplified by using the half-circuit concept of Fig. 5.6a. Applying $v_{i d} / 2$ to $Q_{1}$ and $-v_{i d} / 2$ to $Q_{2}$ keeps the common base node of $Q_{3}$ and $Q_{4}$ at ac ground, allowing us to focus on one half, say, $Q_{1}$ and $Q_{3}$. Their small-signal emitter resistances $r_{e 1}$ and $r_{e 3}$ cause a voltage division by two, resulting in an ac signal at their shared emitter terminals of\n\nimage_name:Figure 5.6 (a)\ndescription:The circuit is an AC analysis model of a differential amplifier's input stage, using the half-circuit concept to simplify analysis by applying differential voltages to Q1 and Q2. Q3 and Q4 form a current mirror, while Q5, Q6, and Q7 are part of the biasing and amplification stage. Resistors R1, R2, and R3 provide biasing and load resistance, exploiting symmetry and small-signal models for analysis.\n\n(a)\nimage_name:Figure 5.6 (b)\ndescription:\n[\nname: Rid, type: Resistor, value: 2.19 MΩ, ports: {N1: vid_plus, N2: vid_minus}\nname: Gm1, type: VoltageControlledCurrentSource, value: 1/5.47 kΩ, ports: {Np: vop, Nn: von}\nname: Ro1, type: Resistor, value: 6.12 MΩ, ports: {N1: vop, N2: von}\n]\nextrainfo:The circuit represents a small-signal model of a differential amplifier input stage, using a voltage-controlled current source for transconductance gain. Resistors provide biasing and load resistance, illustrating the relationship between differential input voltage and output voltage.\n\n(b)\n\nFIGURE 5.6 (a) Circuit for the ac analysis of the input stage, and (b) input-stage small-signal equivalent.\n$(1 / 2)\\left(v_{i d} / 2\\right)=v_{i d} / 4$. Thus, the ac current from $Q_{3}$'s collector is $i_{3}=g_{m 3} v_{i d} / 4$, and by symmetry, the ac current into $Q_{4}$'s collector is $i_{4}=g_{m 4} v_{i d} / 4$. The current mirror of $Q_{5}$ and $Q_{6}$ reflects $i_{3}$, resulting in a net short-circuit ac current sunk from the output node of $i_{o 1(\\mathrm{sc})}=i_{3}+i_{4}=g_{m 3} v_{i d} / 4+g_{m 4} v_{i d} / 4=g_{m} v_{i d} / 2$, where $g_{m}$ is the same for both transistors. This leads to\n\n$$\n\\begin{equation*}\nG_{m 1}=\\frac{i_{o l(\\mathrm{~s})}}{v_{i d}}=\\frac{g_{m}}{2}=\\frac{9.5 \\mu \\mathrm{~A}}{2 \\times 26 \\mathrm{mV}}=\\frac{1}{5.47 \\mathrm{k} \\Omega} \\tag{5.6}\n\\end{equation*}\n$$\n\nwhere $G_{m 1}$ is the first-stage transconductance. Inspecting $Q_{1}$'s base terminal, we find $R_{i d} / 2=r_{\\pi 1}+\\left(\\beta_{01}+1\\right) r_{e 3} \\cong r_{\\pi 1}+\\left(\\beta_{01}+1\\right) r_{e 1}=2 r_{\\pi 1}=2 r_{\\pi n}$, using $r_{e 3} \\cong r_{e 1}$. Therefore,\n\n$$\n\\begin{equation*}\nR_{i d} \\cong 4 r_{\\pi n}=2.19 \\mathrm{M} \\Omega \\tag{5.7}\n\\end{equation*}\n$$\n\nassuming $\\beta_{0 n}=200$ for the $Q_{1}-Q_{2}$ pair. Finally, examining the first stage's output terminal, we write $R_{o 1}=R_{c 4} / / R_{c 6} \\cong\\left[r_{o 4}\\left(1+g_{m 4} r_{e 2}\\right)\\right] / /$ $\\left[r_{o 6}\\left(1+g_{m 0} R_{2}\\right)\\right]$, or\n\n$$\n\\begin{equation*}\nR_{o 1} \\cong 2 r_{o 4} / / 1.37 r_{o 6}=6.12 \\mathrm{M} \\Omega \\tag{5.8}\n\\end{equation*}\n$$\n\nassuming $V_{A n}=100 \\mathrm{~V}$ and $V_{A p}=50 \\mathrm{~V}$. This completes the first stage's analysis, with its small-signal characteristics summarized in Fig. 5.6b.\n\nBefore concluding, we examine additional characteristics the user should be aware of, as listed in the manufacturer's data sheets.\n\n- **Input Bias Current** $\\boldsymbol{I}_{B}$. This is the average of the two input currents, $I_{B}=$ $1 / 2\\left(I_{P}+I_{N}\\right)$. According to Eq. (5.5), $I_{B}$ is around 50 nA and is significantly influenced by $\\beta_{F n}$. Mismatches in the betas of $Q_{1}$ and $Q_{2}$ result in an Input Offset Current $I_{O S}=I_{P}-I_{N}$. The 741 data sheets, available online, typically report $I_{B}=80 \\mathrm{nA}$ and $I_{O S}=20 \\mathrm{nA}$.\n- **Input Offset Voltage** $V_{O S}$. Due to $V_{B E}$ mismatches in the BJTs of the two halves, the stage exhibits an input offset voltage $V_{O S}$. The 741 data sheets typically give $V_{O S}=2 \\mathrm{mV}$.\n- **Input Offset Nulling**. The 741 includes a provision for nulling the input offset error from $V_{O S}$ and $I_{O S}$ using an external $10-\\mathrm{k} \\Omega$ potentiometer with on-chip resistors $R_{1}$ and $R_{2}$, as shown in Fig. 5.5. With the wiper centered, the emitters of $Q_{5}$ and $Q_{6}$ are biased equally at about $[(1 / / 5) \\mathrm{k} \\Omega] \\times(9.5 \\mu \\mathrm{~A})=8 \\mathrm{mV}$ above $V_{E E}$. Moving the wiper adjusts the imbalance, empirically canceling internal imbalances for apparent offset-less behavior.\n- **Input Voltage Range (IVR)**. In negative-feedback operation, the op amp forces $v_{N}$ to track $v_{P}$, making the common-mode input voltage $v_{I C}=1 / 2\\left(v_{P}+v_{N}\\right) \\cong v_{P}$. We determine the common-mode input voltage range where the input stage functions properly, with BJTs in the forward-active region or at the edge of saturation (EOS). Referring to Fig. 5.1, the upper limit is reached when $Q_{1}$ reaches EOS, so $v_{P(\\max )} \\cong V_{C C}-V_{E B 8(\\text { (n) })}-V_{C E 1(\\mathrm{EOS})}+V_{B E 1(\\mathrm{on})}$. The lower limit is when $Q_{3}$ reaches EOS, so $v_{P(\\text { min })} \\cong V_{E E}+V_{B E S(\\text { on })}+$ $V_{B E 7(\\text { on })}+V_{E C 3(\\mathrm{EOS})}+V_{B E 1(\\mathrm{on})}$. Letting $v_{P} \\rightarrow v_{I C}$ gives\n\n$$\n\\begin{equation*}\nv_{I C(\\max )} \\cong V_{C C}-V_{C E(\\mathrm{EOS})} \\quad v_{I C(\\min )} \\cong V_{E E}+3 V_{B E(\\mathrm{mn})}+V_{E C(\\mathrm{EOS})} \\tag{5.9}\n\\end{equation*}\n$$\n\n(Ignoring small voltage drops across $R_{1}, R_{2}$, and $R_{8}$, and assuming equal junction voltage drops.) Assuming typical junction drops of 0.7 V and EOS drops of 0.2 V, the IVR is $-12.7 \\mathrm{~V} \\leq v_{I C} \\leq+14.8 \\mathrm{~V}$ with $\\pm 15-\\mathrm{V}$ supplies. Exceeding the IVR causes malfunction."
},
{
    "text": "Referring to Fig. 5.7, we observe that $I_{C 17}=I_{2}$, which gives us\n\n$$\n\\begin{equation*}\nI_{C 17}=528 \\mu \\mathrm{~A} \\tag{5.10}\n\\end{equation*}\n$$\n\nAdditionally, we have $I_{C 6}=\\alpha_{F 6}\\left(I_{R_{9}}+I_{B 17}\\right)$, which can be approximated as\n\n$$\n\\begin{equation*}\nI_{C 16} \\cong \\frac{V_{B E 17}+R_{8} I_{2} / \\alpha_{F 17}}{R_{9}}+\\frac{I_{2}}{\\beta_{F 17}} \\cong \\frac{V_{T} \\ln \\left(I_{2} / I_{s 17}\\right)+R_{8} I_{2}}{R_{9}}+\\frac{I_{2}}{\\beta_{F 17}} \\tag{5.11a}\n\\end{equation*}\n$$\n\nWith $I_{s 17}=10 \\mathrm{fA}$ and $\\beta_{F 17}=250$, we obtain\n\n$$\n\\begin{equation*}\nI_{C 16}=16 \\mu \\mathrm{~A} \\tag{5.11b}\n\\end{equation*}\n$$\n\nThis concludes the dc analysis.\nFor the small-signal analysis, consult Fig. 5.8a, where $C_{c}$ is excluded due to our focus on low-frequency behavior. Starting from the left and moving right, we derive by inspection\n\n$$\n\\begin{equation*}\nR_{i 2}=r_{\\pi 16}+\\left(\\beta_{016}+1\\right)\\left\\{R_{9} / /\\left[r_{\\pi 17}+\\left(\\beta_{017}+1\\right) R_{8}\\right]\\right\\} \\tag{5.12a}\n\\end{equation*}\n$$\n\nGiven $\\beta_{016}=200$ and $\\beta_{017}=250$, we find\n\n$$\n\\begin{equation*}\nR_{i 2}=4.63 \\mathrm{M} \\Omega \\tag{5.12b}\n\\end{equation*}\n$$\n\nBy further inspection, we write\n\n$$\n\\begin{equation*}\nR_{o 2}=r_{o 13 A} / / R_{c 17} \\cong r_{o 13 A} / /\\left[r_{o 17}\\left(1+g_{m 17} R_{8}\\right)\\right] \\tag{5.13a}\n\\end{equation*}\n$$\n\nUsing $r_{o 13 A}=(50 \\mathrm{~V}) /(528 \\mu \\mathrm{~A})=94.7 \\mathrm{k} \\Omega$ and $r_{o 17}=(100 \\mathrm{~V}) /(528 \\mu \\mathrm{~A})=189.4 \\mathrm{k} \\Omega$, we get\n\n$$\n\\begin{equation*}\nR_{o 2}=81.3 \\mathrm{k} \\Omega \\tag{5.13b}\n\\end{equation*}\n$$\n\nimage_name:FIGURE 5.7 Circuit for the dc analysis of the intermediate stage of the 741 op amp\ndescription:\n[\nname: Q16, type: NPN, ports: {C: VCC, B: Vo1, E: V1}\nname: Q17, type: NPN, ports: {C: V2, B: V1, E: V3}\nname: R9, type: Resistor, value: 50kΩ, ports: {N1: V1, N2: VEE}\nname: R8, type: Resistor, value: 100Ω, ports: {N1: V3, N2: VEE}\nname: I2, type: CurrentSource, value: 528μA, ports: {Np: Vcc, Nn: V2}\n]\nextrainfo:The circuit depicts the intermediate stage of a 741 operational amplifier for DC analysis. It includes two NPN transistors (Q16 and Q17), two resistors (R8 and R9), and a current source (I2). The transistors are arranged with Q16 in common collector mode and Q17 in common emitter mode.\n\nFIGURE 5.7 Circuit for the dc analysis of the intermediate stage of the 741 op amp .\nimage_name:(a)\ndescription:\n[\nname: Q16, type: NPN, ports: {C: GND, B: vi2, E: vb17}\nname: Q17, type: NPN, ports: {C: GND, B: vb17, E: ve17}\nname: R9, type: Resistor, value: 50kΩ, ports: {N1: vb17, N2: GND}\nname: R8, type: Resistor, value: 100Ω, ports: {N1: ve17, N2: GND}\nname: ro13A, type: Resistor, value: 94.7kΩ, ports: {N1: GND, N2: GND}\n]\nextrainfo:The circuit illustrates the intermediate stage of a 741 operational amplifier for DC analysis. It comprises two NPN transistors (Q16 and Q17), two resistors (R8 and R9), and a current source (I2). The transistors are set with Q16 in common collector mode and Q17 in common emitter mode.\nimage_name:(b)\ndescription:\n[\nname: Ri2, type: Resistor, value: 4.63MΩ, ports: {N1: Vi2, N2: GND}\nname: Gm2, type: VoltageControlledCurrentSource, value: 1/161Ω, ports: {Np: Vo2, Nn: GND}\nname: Ro2, type: Resistor, value: 81.3kΩ, ports: {N1: Vo2, N2: GND}\n]\nextrainfo:The circuit represents the AC analysis of the second stage of the 741 op amp. It includes a voltage-controlled current source Gm2, a resistor Ri2, and a resistor Ro2. The input voltage is Vi2 and the output voltage is Vo2.\n\nFIGURE 5.8 (a) Circuit for the ac analysis of the second stage, and (b) second-stage small-signal equivalent.\n\nFinally, considering $Q_{16}$ in CC mode and $Q_{17}$ in CE-ED mode, we express\n\n$$\n\\begin{align*}\nG_{m 2} & =\\frac{i_{o 2(s c)}}{v_{i 2}}=\\frac{v_{b 17}}{v_{i 2}} \\times \\frac{i_{c 17}}{v_{b 17}}=\\frac{1}{1+\\frac{r_{e 16}}{R_{9} / /\\left[r_{\\pi 17}+\\left(\\beta_{017}+1\\right) R_{8}\\right]}} \\times \\frac{g_{m 17}}{1+g_{m 17} R_{8}}  \\tag{5.14}\\\\\n& =\\frac{1}{161 \\Omega}\n\\end{align*}\n$$\n\nHere, $G_{m 2}$ denotes the second-stage transconductance. The small-signal characteristics of this stage are summarized in Fig. 5.8b, thus completing the second-stage analysis."
},
{
    "text": "Referring to Fig. 5.7, we observe by inspection that $I_{C 17}=I_{2}$, or\n\n$$\n\\begin{equation*}\nI_{C 17}=528 \\mu \\mathrm{~A} \\tag{5.10}\n\\end{equation*}\n$$\n\nFurthermore, we have $I_{C 6}=\\alpha_{F 6}\\left(I_{R_{9}}+I_{B 17}\\right)$, which can be approximated as\n\n$$\n\\begin{equation*}\nI_{C 16} \\cong \\frac{V_{B E 17}+R_{8} I_{2} / \\alpha_{F 17}}{R_{9}}+\\frac{I_{2}}{\\beta_{F 17}} \\cong \\frac{V_{T} \\ln \\left(I_{2} / I_{s 17}\\right)+R_{8} I_{2}}{R_{9}}+\\frac{I_{2}}{\\beta_{F 17}} \\tag{5.11a}\n\\end{equation*}\n$$\n\nWith $I_{s 17}=10 \\mathrm{fA}$ and $\\beta_{F 17}=250$, we obtain\n\n$$\n\\begin{equation*}\nI_{C 16}=16 \\mu \\mathrm{~A} \\tag{5.11b}\n\\end{equation*}\n$$\n\nThis concludes the dc analysis.\nFor the small-signal analysis, consult Fig. 5.8a, where $C_{c}$ is excluded due to our focus on low-frequency behavior. Beginning from the left and moving right, we derive by inspection\n\n$$\n\\begin{equation*}\nR_{i 2}=r_{\\pi 16}+\\left(\\beta_{016}+1\\right)\\left\\{R_{9} / /\\left[r_{\\pi 17}+\\left(\\beta_{017}+1\\right) R_{8}\\right]\\right\\} \\tag{5.12a}\n\\end{equation*}\n$$\n\nGiven $\\beta_{016}=200$ and $\\beta_{017}=250$, we find\n\n$$\n\\begin{equation*}\nR_{i 2}=4.63 \\mathrm{M} \\Omega \\tag{5.12b}\n\\end{equation*}\n$$\n\nBy further inspection, we write\n\n$$\n\\begin{equation*}\nR_{o 2}=r_{o 13 A} / / R_{c 17} \\cong r_{o 13 A} / /\\left[r_{o 17}\\left(1+g_{m 17} R_{8}\\right)\\right] \\tag{5.13a}\n\\end{equation*}\n$$\n\nUsing $r_{o 13 A}=(50 \\mathrm{~V}) /(528 \\mu \\mathrm{~A})=94.7 \\mathrm{k} \\Omega$ and $r_{o 17}=(100 \\mathrm{~V}) /(528 \\mu \\mathrm{~A})=189.4 \\mathrm{k} \\Omega$, we get\n\n$$\n\\begin{equation*}\nR_{o 2}=81.3 \\mathrm{k} \\Omega \\tag{5.13b}\n\\end{equation*}\n$$\n\nimage_name:FIGURE 5.7 Circuit for the dc analysis of the intermediate stage of the 741 op amp\ndescription:\n[\nname: Q16, type: NPN, ports: {C: VCC, B: Vo1, E: V1}\nname: Q17, type: NPN, ports: {C: V2, B: V1, E: V3}\nname: R9, type: Resistor, value: 50kΩ, ports: {N1: V1, N2: VEE}\nname: R8, type: Resistor, value: 100Ω, ports: {N1: V3, N2: VEE}\nname: I2, type: CurrentSource, value: 528μA, ports: {Np: Vcc, Nn: V2}\n]\nextrainfo:The circuit represents the intermediate stage of a 741 operational amplifier for DC analysis. It includes two NPN transistors (Q16 and Q17), two resistors (R8 and R9), and a current source (I2). The transistors are configured with Q16 in a common collector mode and Q17 in a common emitter mode.\n\nFIGURE 5.7 Circuit for the dc analysis of the intermediate stage of the 741 op amp .\nimage_name:(a)\ndescription:\n[\nname: Q16, type: NPN, ports: {C: GND, B: vi2, E: vb17}\nname: Q17, type: NPN, ports: {C: GND, B: vb17, E: ve17}\nname: R9, type: Resistor, value: 50kΩ, ports: {N1: vb17, N2: GND}\nname: R8, type: Resistor, value: 100Ω, ports: {N1: ve17, N2: GND}\nname: ro13A, type: Resistor, value: 94.7kΩ, ports: {N1: GND, N2: GND}\n]\nextrainfo:The circuit represents the intermediate stage of a 741 operational amplifier for DC analysis. It includes two NPN transistors (Q16 and Q17), two resistors (R8 and R9), and a current source (I2). The transistors are configured with Q16 in a common collector mode and Q17 in a common emitter mode.\nimage_name:(b)\ndescription:\n[\nname: Ri2, type: Resistor, value: 4.63MΩ, ports: {N1: Vi2, N2: GND}\nname: Gm2, type: VoltageControlledCurrentSource, value: 1/161Ω, ports: {Np: Vo2, Nn: GND}\nname: Ro2, type: Resistor, value: 81.3kΩ, ports: {N1: Vo2, N2: GND}\n]\nextrainfo:The circuit is an AC analysis of the second stage of the 741 op amp. It consists of a voltage-controlled current source Gm2, a resistor Ri2, and a resistor Ro2. The input voltage is Vi2 and the output voltage is Vo2.\n\nFIGURE 5.8 (a) Circuit for the ac analysis of the second stage, and (b) second-stage small-signal equivalent.\n\nFinally, considering $Q_{16}$ in CC mode and $Q_{17}$ in CE-ED mode, we express\n\n$$\n\\begin{align*}\nG_{m 2} & =\\frac{i_{o 2(s c)}}{v_{i 2}}=\\frac{v_{b 17}}{v_{i 2}} \\times \\frac{i_{c 17}}{v_{b 17}}=\\frac{1}{1+\\frac{r_{e 16}}{R_{9} / /\\left[r_{\\pi 17}+\\left(\\beta_{017}+1\\right) R_{8}\\right]}} \\times \\frac{g_{m 17}}{1+g_{m 17} R_{8}}  \\tag{5.14}\\\\\n& =\\frac{1}{161 \\Omega}\n\\end{align*}\n$$\n\nHere, $G_{m 2}$ denotes the second-stage transconductance. The small-signal characteristics of this stage are summarized in Fig. 5.8b, finalizing the second-stage analysis."
},
{
    "text": "Referring to Fig. 5.7, we observe by inspection that $I_{C 17}=I_{2}$, or\n\n$$\n\\begin{equation*}\nI_{C 17}=528 \\mu \\mathrm{~A} \\tag{5.10}\n\\end{equation*}\n$$\n\nFurthermore, we have $I_{C 6}=\\alpha_{F 6}\\left(I_{R_{9}}+I_{B 17}\\right)$, which can be approximated as\n\n$$\n\\begin{equation*}\nI_{C 16} \\cong \\frac{V_{B E 17}+R_{8} I_{2} / \\alpha_{F 17}}{R_{9}}+\\frac{I_{2}}{\\beta_{F 17}} \\cong \\frac{V_{T} \\ln \\left(I_{2} / I_{s 17}\\right)+R_{8} I_{2}}{R_{9}}+\\frac{I_{2}}{\\beta_{F 17}} \\tag{5.11a}\n\\end{equation*}\n$$\n\nAssuming $I_{s 17}=10 \\mathrm{fA}$ and $\\beta_{F 17}=250$, we obtain\n\n$$\n\\begin{equation*}\nI_{C 16}=16 \\mu \\mathrm{~A} \\tag{5.11b}\n\\end{equation*}\n$$\n\nThis concludes the dc analysis.\nFor the small-signal analysis, consult Fig. 5.8a, where $C_{c}$ is omitted due to our focus on low-frequency behavior. Starting from the left and moving to the right, we write by inspection\n\n$$\n\\begin{equation*}\nR_{i 2}=r_{\\pi 16}+\\left(\\beta_{016}+1\\right)\\left\\{R_{9} / /\\left[r_{\\pi 17}+\\left(\\beta_{017}+1\\right) R_{8}\\right]\\right\\} \\tag{5.12a}\n\\end{equation*}\n$$\n\nWith $\\beta_{016}=200$ and $\\beta_{017}=250$, we find\n\n$$\n\\begin{equation*}\nR_{i 2}=4.63 \\mathrm{M} \\Omega \\tag{5.12b}\n\\end{equation*}\n$$\n\nUsing inspection again, we write\n\n$$\n\\begin{equation*}\nR_{o 2}=r_{o 13 A} / / R_{c 17} \\cong r_{o 13 A} / /\\left[r_{o 17}\\left(1+g_{m 17} R_{8}\\right)\\right] \\tag{5.13a}\n\\end{equation*}\n$$\n\nGiven $r_{o 13 A}=(50 \\mathrm{~V}) /(528 \\mu \\mathrm{~A})=94.7 \\mathrm{k} \\Omega$ and $r_{o 17}=(100 \\mathrm{~V}) /(528 \\mu \\mathrm{~A})=189.4 \\mathrm{k} \\Omega$, we get\n\n$$\n\\begin{equation*}\nR_{o 2}=81.3 \\mathrm{k} \\Omega \\tag{5.13b}\n\\end{equation*}\n$$\n\nimage_name:FIGURE 5.7 Circuit for the dc analysis of the intermediate stage of the 741 op amp\ndescription:\n[\nname: Q16, type: NPN, ports: {C: VCC, B: Vo1, E: V1}\nname: Q17, type: NPN, ports: {C: V2, B: V1, E: V3}\nname: R9, type: Resistor, value: 50kΩ, ports: {N1: V1, N2: VEE}\nname: R8, type: Resistor, value: 100Ω, ports: {N1: V3, N2: VEE}\nname: I2, type: CurrentSource, value: 528μA, ports: {Np: Vcc, Nn: V2}\n]\nextrainfo:The circuit represents the intermediate stage of a 741 operational amplifier for DC analysis. It includes two NPN transistors (Q16 and Q17), two resistors (R8 and R9), and a current source (I2). The transistors are configured with Q16 in a common collector mode and Q17 in a common emitter mode.\n\nFIGURE 5.7 Circuit for the dc analysis of the intermediate stage of the 741 op amp .\nimage_name:(a)\ndescription:\n[\nname: Q16, type: NPN, ports: {C: GND, B: vi2, E: vb17}\nname: Q17, type: NPN, ports: {C: GND, B: vb17, E: ve17}\nname: R9, type: Resistor, value: 50kΩ, ports: {N1: vb17, N2: GND}\nname: R8, type: Resistor, value: 100Ω, ports: {N1: ve17, N2: GND}\nname: ro13A, type: Resistor, value: 94.7kΩ, ports: {N1: GND, N2: GND}\n]\nextrainfo:The circuit represents the intermediate stage of a 741 operational amplifier for DC analysis. It includes two NPN transistors (Q16 and Q17), two resistors (R8 and R9), and a current source (I2). The transistors are configured with Q16 in a common collector mode and Q17 in a common emitter mode.\nimage_name:(b)\ndescription:\n[\nname: Ri2, type: Resistor, value: 4.63MΩ, ports: {N1: Vi2, N2: GND}\nname: Gm2, type: VoltageControlledCurrentSource, value: 1/161Ω, ports: {Np: Vo2, Nn: GND}\nname: Ro2, type: Resistor, value: 81.3kΩ, ports: {N1: Vo2, N2: GND}\n]\nextrainfo:The circuit is an AC analysis of the second stage of the 741 op amp. It consists of a voltage-controlled current source Gm2, a resistor Ri2, and a resistor Ro2. The input voltage is Vi2 and the output voltage is Vo2.\n\nFIGURE 5.8 (a) Circuit for the ac analysis of the second stage, and (b) second-stage small-signal equivalent.\n\nFinally, considering that $Q_{16}$ operates in the CC mode and $Q_{17}$ in the CE-ED mode, we write\n\n$$\n\\begin{align*}\nG_{m 2} & =\\frac{i_{o 2(s c)}}{v_{i 2}}=\\frac{v_{b 17}}{v_{i 2}} \\times \\frac{i_{c 17}}{v_{b 17}}=\\frac{1}{1+\\frac{r_{e 16}}{R_{9} / /\\left[r_{\\pi 17}+\\left(\\beta_{017}+1\\right) R_{8}\\right]}} \\times \\frac{g_{m 17}}{1+g_{m 17} R_{8}}  \\tag{5.14}\\\\\n& =\\frac{1}{161 \\Omega}\n\\end{align*}\n$$\n\nwhere $G_{m 2}$ denotes the second-stage transconductance. The small-signal characteristics of this stage are summarized in Fig. 5.8b, thus completing the second-stage analysis."
},
{
    "text": "Referring to Fig. 5.7, we observe by inspection that $I_{C 17}=I_{2}$, which yields\n\n$$\n\\begin{equation*}\nI_{C 17}=528 \\mu \\mathrm{~A} \\tag{5.10}\n\\end{equation*}\n$$\n\nAdditionally, we have $I_{C 6}=\\alpha_{F 6}\\left(I_{R_{9}}+I_{B 17}\\right)$, which can be approximated as\n\n$$\n\\begin{equation*}\nI_{C 16} \\cong \\frac{V_{B E 17}+R_{8} I_{2} / \\alpha_{F 17}}{R_{9}}+\\frac{I_{2}}{\\beta_{F 17}} \\cong \\frac{V_{T} \\ln \\left(I_{2} / I_{s 17}\\right)+R_{8} I_{2}}{R_{9}}+\\frac{I_{2}}{\\beta_{F 17}} \\tag{5.11a}\n\\end{equation*}\n$$\n\nWith $I_{s 17}=10 \\mathrm{fA}$ and $\\beta_{F 17}=250$, we obtain\n\n$$\n\\begin{equation*}\nI_{C 16}=16 \\mu \\mathrm{~A} \\tag{5.11b}\n\\end{equation*}\n$$\n\nThis concludes the dc analysis.\n\nFor the small-signal analysis, consult Fig. 5.8a, where $C_{c}$ is omitted due to our focus on low-frequency behavior. Starting from the left and moving right, we derive by inspection\n\n$$\n\\begin{equation*}\nR_{i 2}=r_{\\pi 16}+\\left(\\beta_{016}+1\\right)\\left\\{R_{9} / /\\left[r_{\\pi 17}+\\left(\\beta_{017}+1\\right) R_{8}\\right]\\right\\} \\tag{5.12a}\n\\end{equation*}\n$$\n\nGiven $\\beta_{016}=200$ and $\\beta_{017}=250$, we find\n\n$$\n\\begin{equation*}\nR_{i 2}=4.63 \\mathrm{M} \\Omega \\tag{5.12b}\n\\end{equation*}\n$$\n\nBy further inspection, we write\n\n$$\n\\begin{equation*}\nR_{o 2}=r_{o 13 A} / / R_{c 17} \\cong r_{o 13 A} / /\\left[r_{o 17}\\left(1+g_{m 17} R_{8}\\right)\\right] \\tag{5.13a}\n\\end{equation*}\n$$\n\nUsing $r_{o 13 A}=(50 \\mathrm{~V}) /(528 \\mu \\mathrm{~A})=94.7 \\mathrm{k} \\Omega$ and $r_{o 17}=(100 \\mathrm{~V}) /(528 \\mu \\mathrm{~A})=189.4 \\mathrm{k} \\Omega$, we get\n\n$$\n\\begin{equation*}\nR_{o 2}=81.3 \\mathrm{k} \\Omega \\tag{5.13b}\n\\end{equation*}\n$$\n\nimage_name:FIGURE 5.7 Circuit for the dc analysis of the intermediate stage of the 741 op amp\ndescription:\n[\nname: Q16, type: NPN, ports: {C: VCC, B: Vo1, E: V1}\nname: Q17, type: NPN, ports: {C: V2, B: V1, E: V3}\nname: R9, type: Resistor, value: 50kΩ, ports: {N1: V1, N2: VEE}\nname: R8, type: Resistor, value: 100Ω, ports: {N1: V3, N2: VEE}\nname: I2, type: CurrentSource, value: 528μA, ports: {Np: Vcc, Nn: V2}\n]\nextrainfo:The circuit depicts the intermediate stage of a 741 operational amplifier for DC analysis. It comprises two NPN transistors (Q16 and Q17), two resistors (R8 and R9), and a current source (I2). Q16 is in common collector mode and Q17 in common emitter mode.\n\nFIGURE 5.7 Circuit for the dc analysis of the intermediate stage of the 741 op amp .\nimage_name:(a)\ndescription:\n[\nname: Q16, type: NPN, ports: {C: GND, B: vi2, E: vb17}\nname: Q17, type: NPN, ports: {C: GND, B: vb17, E: ve17}\nname: R9, type: Resistor, value: 50kΩ, ports: {N1: vb17, N2: GND}\nname: R8, type: Resistor, value: 100Ω, ports: {N1: ve17, N2: GND}\nname: ro13A, type: Resistor, value: 94.7kΩ, ports: {N1: GND, N2: GND}\n]\nextrainfo:The circuit illustrates the intermediate stage of a 741 operational amplifier for DC analysis. It includes two NPN transistors (Q16 and Q17), two resistors (R8 and R9), and a current source (I2). Q16 is configured in common collector mode and Q17 in common emitter mode.\nimage_name:(b)\ndescription:\n[\nname: Ri2, type: Resistor, value: 4.63MΩ, ports: {N1: Vi2, N2: GND}\nname: Gm2, type: VoltageControlledCurrentSource, value: 1/161Ω, ports: {Np: Vo2, Nn: GND}\nname: Ro2, type: Resistor, value: 81.3kΩ, ports: {N1: Vo2, N2: GND}\n]\nextrainfo:The circuit represents the AC analysis of the second stage of the 741 op amp. It consists of a voltage-controlled current source Gm2, a resistor Ri2, and a resistor Ro2. The input voltage is Vi2 and the output voltage is Vo2.\n\nFIGURE 5.8 (a) Circuit for the ac analysis of the second stage, and (b) second-stage small-signal equivalent.\n\nLastly, considering $Q_{16}$ operates in CC mode and $Q_{17}$ in CE-ED mode, we express\n\n$$\n\\begin{align*}\nG_{m 2} & =\\frac{i_{o 2(s c)}}{v_{i 2}}=\\frac{v_{b 17}}{v_{i 2}} \\times \\frac{i_{c 17}}{v_{b 17}}=\\frac{1}{1+\\frac{r_{e 16}}{R_{9} / /\\left[r_{\\pi 17}+\\left(\\beta_{017}+1\\right) R_{8}\\right]}} \\times \\frac{g_{m 17}}{1+g_{m 17} R_{8}}  \\tag{5.14}\\\\\n& =\\frac{1}{161 \\Omega}\n\\end{align*}\n$$\n\nHere, $G_{m 2}$ denotes the second-stage transconductance. The small-signal characteristics of this stage are summarized in Fig. 5.8b, finalizing the second-stage analysis."
},
{
    "text": "Referring to Fig. 5.7, we observe that $I_{C 17}=I_{2}$, which translates to\n\n$$\n\\begin{equation*}\nI_{C 17}=528 \\mu \\mathrm{~A} \\tag{5.10}\n\\end{equation*}\n$$\n\nFurthermore, we have $I_{C 6}=\\alpha_{F 6}\\left(I_{R_{9}}+I_{B 17}\\right)$, which can be approximated as\n\n$$\n\\begin{equation*}\nI_{C 16} \\cong \\frac{V_{B E 17}+R_{8} I_{2} / \\alpha_{F 17}}{R_{9}}+\\frac{I_{2}}{\\beta_{F 17}} \\cong \\frac{V_{T} \\ln \\left(I_{2} / I_{s 17}\\right)+R_{8} I_{2}}{R_{9}}+\\frac{I_{2}}{\\beta_{F 17}} \\tag{5.11a}\n\\end{equation*}\n$$\n\nWith $I_{s 17}=10 \\mathrm{fA}$ and $\\beta_{F 17}=250$, we obtain\n\n$$\n\\begin{equation*}\nI_{C 16}=16 \\mu \\mathrm{~A} \\tag{5.11b}\n\\end{equation*}\n$$\n\nThis concludes the dc analysis.\n\nFor the small-signal analysis, consult Fig. 5.8a, where $C_{c}$ is excluded due to our focus on low-frequency behavior. Proceeding from left to right, we derive by inspection\n\n$$\n\\begin{equation*}\nR_{i 2}=r_{\\pi 16}+\\left(\\beta_{016}+1\\right)\\left\\{R_{9} / /\\left[r_{\\pi 17}+\\left(\\beta_{017}+1\\right) R_{8}\\right]\\right\\} \\tag{5.12a}\n\\end{equation*}\n$$\n\nGiven $\\beta_{016}=200$ and $\\beta_{017}=250$, we find\n\n$$\n\\begin{equation*}\nR_{i 2}=4.63 \\mathrm{M} \\Omega \\tag{5.12b}\n\\end{equation*}\n$$\n\nBy further inspection, we write\n\n$$\n\\begin{equation*}\nR_{o 2}=r_{o 13 A} / / R_{c 17} \\cong r_{o 13 A} / /\\left[r_{o 17}\\left(1+g_{m 17} R_{8}\\right)\\right] \\tag{5.13a}\n\\end{equation*}\n$$\n\nUsing $r_{o 13 A}=(50 \\mathrm{~V}) /(528 \\mu \\mathrm{~A})=94.7 \\mathrm{k} \\Omega$ and $r_{o 17}=(100 \\mathrm{~V}) /(528 \\mu \\mathrm{~A})=189.4 \\mathrm{k} \\Omega$, we get\n\n$$\n\\begin{equation*}\nR_{o 2}=81.3 \\mathrm{k} \\Omega \\tag{5.13b}\n\\end{equation*}\n$$\n\nImage Description: FIGURE 5.7 illustrates the circuit for the dc analysis of the intermediate stage of the 741 op amp. It includes two NPN transistors (Q16 and Q17), two resistors (R8 and R9), and a current source (I2). Q16 is in common collector mode and Q17 in common emitter mode.\n\nImage Description: FIGURE 5.8a depicts the circuit for the ac analysis of the second stage, excluding capacitor $C_{c}$. It features two NPN transistors (Q16 and Q17), two resistors (R8 and R9), and a resistor $r_{o 13 A}$.\n\nImage Description: FIGURE 5.8b presents the small-signal equivalent of the second stage, including a resistor $R_{i 2}$, a voltage-controlled current source $G_{m 2}$, and a resistor $R_{o 2}$.\n\nFinally, considering $Q_{16}$ in CC mode and $Q_{17}$ in CE-ED mode, we express\n\n$$\n\\begin{align*}\nG_{m 2} & =\\frac{i_{o 2(s c)}}{v_{i 2}}=\\frac{v_{b 17}}{v_{i 2}} \\times \\frac{i_{c 17}}{v_{b 17}}=\\frac{1}{1+\\frac{r_{e 16}}{R_{9} / /\\left[r_{\\pi 17}+\\left(\\beta_{017}+1\\right) R_{8}\\right]}} \\times \\frac{g_{m 17}}{1+g_{m 17} R_{8}}  \\tag{5.14}\\\\\n& =\\frac{1}{161 \\Omega}\n\\end{align*}\n$$\n\nHere, $G_{m 2}$ represents the second-stage transconductance. The small-signal characteristics are summarized in Fig. 5.8b, finalizing the second-stage analysis."
},
{
    "text": "Referring to Fig. 5.7, by inspection, we have $I_{C 17}=I_{2}$, or\n\n$$\n\\begin{equation*}\nI_{C 17}=528 \\mu \\mathrm{~A} \\tag{5.10}\n\\end{equation*}\n$$\n\nAdditionally, we find $I_{C 6}=\\alpha_{F 6}\\left(I_{R_{9}}+I_{B 17}\\right)$, which can be approximated as\n\n$$\n\\begin{equation*}\nI_{C 16} \\cong \\frac{V_{B E 17}+R_{8} I_{2} / \\alpha_{F 17}}{R_{9}}+\\frac{I_{2}}{\\beta_{F 17}} \\cong \\frac{V_{T} \\ln \\left(I_{2} / I_{s 17}\\right)+R_{8} I_{2}}{R_{9}}+\\frac{I_{2}}{\\beta_{F 17}} \\tag{5.11a}\n\\end{equation*}\n$$\n\nWith $I_{s 17}=10 \\mathrm{fA}$ and $\\beta_{F 17}=250$, we obtain\n\n$$\n\\begin{equation*}\nI_{C 16}=16 \\mu \\mathrm{~A} \\tag{5.11b}\n\\end{equation*}\n$$\n\nThis concludes the dc analysis.\nFor the small-signal analysis, consult Fig. 5.8a, where $C_{c}$ is omitted due to our focus on low-frequency behavior. Starting from the left and moving right, we derive by inspection\n\n$$\n\\begin{equation*}\nR_{i 2}=r_{\\pi 16}+\\left(\\beta_{016}+1\\right)\\left\\{R_{9} / /\\left[r_{\\pi 17}+\\left(\\beta_{017}+1\\right) R_{8}\\right]\\right\\} \\tag{5.12a}\n\\end{equation*}\n$$\n\nAssuming $\\beta_{016}=200$ and $\\beta_{017}=250$, we find\n\n$$\n\\begin{equation*}\nR_{i 2}=4.63 \\mathrm{M} \\Omega \\tag{5.12b}\n\\end{equation*}\n$$\n\nBy further inspection, we write\n\n$$\n\\begin{equation*}\nR_{o 2}=r_{o 13 A} / / R_{c 17} \\cong r_{o 13 A} / /\\left[r_{o 17}\\left(1+g_{m 17} R_{8}\\right)\\right] \\tag{5.13a}\n\\end{equation*}\n$$\n\nUsing $r_{o 13 A}=(50 \\mathrm{~V}) /(528 \\mu \\mathrm{~A})=94.7 \\mathrm{k} \\Omega$ and $r_{o 17}=(100 \\mathrm{~V}) /(528 \\mu \\mathrm{~A})=189.4 \\mathrm{k} \\Omega$, we get\n\n$$\n\\begin{equation*}\nR_{o 2}=81.3 \\mathrm{k} \\Omega \\tag{5.13b}\n\\end{equation*}\n$$\n\nimage_name:FIGURE 5.7 Circuit for the dc analysis of the intermediate stage of the 741 op amp\ndescription:\n[\nname: Q16, type: NPN, ports: {C: VCC, B: Vo1, E: V1}\nname: Q17, type: NPN, ports: {C: V2, B: V1, E: V3}\nname: R9, type: Resistor, value: 50kΩ, ports: {N1: V1, N2: VEE}\nname: R8, type: Resistor, value: 100Ω, ports: {N1: V3, N2: VEE}\nname: I2, type: CurrentSource, value: 528μA, ports: {Np: Vcc, Nn: V2}\n]\nextrainfo:The circuit represents the intermediate stage of a 741 operational amplifier for DC analysis. It includes two NPN transistors (Q16 and Q17), two resistors (R8 and R9), and a current source (I2). The transistors are configured with Q16 in a common collector mode and Q17 in a common emitter mode.\n\nFIGURE 5.7 Circuit for the dc analysis of the intermediate stage of the 741 op amp .\nimage_name:(a)\ndescription:\n[\nname: Q16, type: NPN, ports: {C: GND, B: vi2, E: vb17}\nname: Q17, type: NPN, ports: {C: GND, B: vb17, E: ve17}\nname: R9, type: Resistor, value: 50kΩ, ports: {N1: vb17, N2: GND}\nname: R8, type: Resistor, value: 100Ω, ports: {N1: ve17, N2: GND}\nname: ro13A, type: Resistor, value: 94.7kΩ, ports: {N1: GND, N2: GND}\n]\nextrainfo:The circuit represents the intermediate stage of a 741 operational amplifier for DC analysis. It includes two NPN transistors (Q16 and Q17), two resistors (R8 and R9), and a current source (I2). The transistors are configured with Q16 in a common collector mode and Q17 in a common emitter mode.\nimage_name:(b)\ndescription:\n[\nname: Ri2, type: Resistor, value: 4.63MΩ, ports: {N1: Vi2, N2: GND}\nname: Gm2, type: VoltageControlledCurrentSource, value: 1/161Ω, ports: {Np: Vo2, Nn: GND}\nname: Ro2, type: Resistor, value: 81.3kΩ, ports: {N1: Vo2, N2: GND}\n]\nextrainfo:The circuit is an AC analysis of the second stage of the 741 op amp. It consists of a voltage-controlled current source Gm2, a resistor Ri2, and a resistor Ro2. The input voltage is Vi2 and the output voltage is Vo2.\n\nFIGURE 5.8 (a) Circuit for the ac analysis of the second stage, and (b) second-stage small-signal equivalent.\n\nFinally, considering $Q_{16}$ in CC mode and $Q_{17}$ in CE-ED mode, we express\n\n$$\n\\begin{align*}\nG_{m 2} & =\\frac{i_{o 2(s c)}}{v_{i 2}}=\\frac{v_{b 17}}{v_{i 2}} \\times \\frac{i_{c 17}}{v_{b 17}}=\\frac{1}{1+\\frac{r_{e 16}}{R_{9} / /\\left[r_{\\pi 17}+\\left(\\beta_{017}+1\\right) R_{8}\\right]}} \\times \\frac{g_{m 17}}{1+g_{m 17} R_{8}}  \\tag{5.14}\\\\\n& =\\frac{1}{161 \\Omega}\n\\end{align*}\n$$\n\nwhere $G_{m 2}$ represents the second-stage transconductance. The small-signal characteristics of this stage are summarized in Fig. 5.8b, thus completing the second-stage analysis."
},
{
    "text": "Referring to Fig. 5.7, we observe by inspection that $I_{C 17}=I_{2}$, which translates to\n\n$$\n\\begin{equation*}\nI_{C 17}=528 \\mu \\mathrm{~A} \\tag{5.10}\n\\end{equation*}\n$$\n\nAdditionally, we have $I_{C 6}=\\alpha_{F 6}\\left(I_{R_{9}}+I_{B 17}\\right)$, which can be approximated as\n\n$$\n\\begin{equation*}\nI_{C 16} \\cong \\frac{V_{B E 17}+R_{8} I_{2} / \\alpha_{F 17}}{R_{9}}+\\frac{I_{2}}{\\beta_{F 17}} \\cong \\frac{V_{T} \\ln \\left(I_{2} / I_{s 17}\\right)+R_{8} I_{2}}{R_{9}}+\\frac{I_{2}}{\\beta_{F 17}} \\tag{5.11a}\n\\end{equation*}\n$$\n\nGiven $I_{s 17}=10 \\mathrm{fA}$ and $\\beta_{F 17}=250$, we find\n\n$$\n\\begin{equation*}\nI_{C 16}=16 \\mu \\mathrm{~A} \\tag{5.11b}\n\\end{equation*}\n$$\n\nThis concludes the dc analysis.\nFor the small-signal analysis, consult Fig. 5.8a, where $C_{c}$ is excluded due to our focus on low-frequency behavior. Beginning from the left and moving right, we derive by inspection\n\n$$\n\\begin{equation*}\nR_{i 2}=r_{\\pi 16}+\\left(\\beta_{016}+1\\right)\\left\\{R_{9} / /\\left[r_{\\pi 17}+\\left(\\beta_{017}+1\\right) R_{8}\\right]\\right\\} \\tag{5.12a}\n\\end{equation*}\n$$\n\nWith $\\beta_{016}=200$ and $\\beta_{017}=250$, we obtain\n\n$$\n\\begin{equation*}\nR_{i 2}=4.63 \\mathrm{M} \\Omega \\tag{5.12b}\n\\end{equation*}\n$$\n\nBy further inspection, we write\n\n$$\n\\begin{equation*}\nR_{o 2}=r_{o 13 A} / / R_{c 17} \\cong r_{o 13 A} / /\\left[r_{o 17}\\left(1+g_{m 17} R_{8}\\right)\\right] \\tag{5.13a}\n\\end{equation*}\n$$\n\nUsing $r_{o 13 A}=(50 \\mathrm{~V}) /(528 \\mu \\mathrm{~A})=94.7 \\mathrm{k} \\Omega$ and $r_{o 17}=(100 \\mathrm{~V}) /(528 \\mu \\mathrm{~A})=189.4 \\mathrm{k} \\Omega$, we get\n\n$$\n\\begin{equation*}\nR_{o 2}=81.3 \\mathrm{k} \\Omega \\tag{5.13b}\n\\end{equation*}\n$$\n\nimage_name:FIGURE 5.7 Circuit for the dc analysis of the intermediate stage of the 741 op amp\ndescription:\n[\nname: Q16, type: NPN, ports: {C: VCC, B: Vo1, E: V1}\nname: Q17, type: NPN, ports: {C: V2, B: V1, E: V3}\nname: R9, type: Resistor, value: 50kΩ, ports: {N1: V1, N2: VEE}\nname: R8, type: Resistor, value: 100Ω, ports: {N1: V3, N2: VEE}\nname: I2, type: CurrentSource, value: 528μA, ports: {Np: Vcc, Nn: V2}\n]\nextrainfo:The circuit represents the intermediate stage of a 741 operational amplifier for DC analysis. It includes two NPN transistors (Q16 and Q17), two resistors (R8 and R9), and a current source (I2). The transistors are configured with Q16 in a common collector mode and Q17 in a common emitter mode.\n\nFIGURE 5.7 Circuit for the dc analysis of the intermediate stage of the 741 op amp .\nimage_name:(a)\ndescription:\n[\nname: Q16, type: NPN, ports: {C: GND, B: vi2, E: vb17}\nname: Q17, type: NPN, ports: {C: GND, B: vb17, E: ve17}\nname: R9, type: Resistor, value: 50kΩ, ports: {N1: vb17, N2: GND}\nname: R8, type: Resistor, value: 100Ω, ports: {N1: ve17, N2: GND}\nname: ro13A, type: Resistor, value: 94.7kΩ, ports: {N1: GND, N2: GND}\n]\nextrainfo:The circuit represents the intermediate stage of a 741 operational amplifier for DC analysis. It includes two NPN transistors (Q16 and Q17), two resistors (R8 and R9), and a current source (I2). The transistors are configured with Q16 in a common collector mode and Q17 in a common emitter mode.\nimage_name:(b)\ndescription:\n[\nname: Ri2, type: Resistor, value: 4.63MΩ, ports: {N1: Vi2, N2: GND}\nname: Gm2, type: VoltageControlledCurrentSource, value: 1/161Ω, ports: {Np: Vo2, Nn: GND}\nname: Ro2, type: Resistor, value: 81.3kΩ, ports: {N1: Vo2, N2: GND}\n]\nextrainfo:The circuit is an AC analysis of the second stage of the 741 op amp. It consists of a voltage-controlled current source Gm2, a resistor Ri2, and a resistor Ro2. The input voltage is Vi2 and the output voltage is Vo2.\n\nFIGURE 5.8 (a) Circuit for the ac analysis of the second stage, and (b) second-stage small-signal equivalent.\n\nLastly, considering $Q_{16}$ in CC mode and $Q_{17}$ in CE-ED mode, we express\n\n$$\n\\begin{align*}\nG_{m 2} & =\\frac{i_{o 2(s c)}}{v_{i 2}}=\\frac{v_{b 17}}{v_{i 2}} \\times \\frac{i_{c 17}}{v_{b 17}}=\\frac{1}{1+\\frac{r_{e 16}}{R_{9} / /\\left[r_{\\pi 17}+\\left(\\beta_{017}+1\\right) R_{8}\\right]}} \\times \\frac{g_{m 17}}{1+g_{m 17} R_{8}}  \\tag{5.14}\\\\\n& =\\frac{1}{161 \\Omega}\n\\end{align*}\n$$\n\nHere, $G_{m 2}$ denotes the second-stage transconductance. The small-signal characteristics of this stage are summarized in Fig. 5.8b, finalizing the second-stage analysis."
},
{
    "text": "Referring to Fig. 5.7, we observe by inspection that $I_{C 17}=I_{2}$, which translates to\n\n$$\n\\begin{equation*}\nI_{C 17}=528 \\mu \\mathrm{~A} \\tag{5.10}\n\\end{equation*}\n$$\n\nFurthermore, we have $I_{C 6}=\\alpha_{F 6}\\left(I_{R_{9}}+I_{B 17}\\right)$, which can be approximated as\n\n$$\n\\begin{equation*}\nI_{C 16} \\cong \\frac{V_{B E 17}+R_{8} I_{2} / \\alpha_{F 17}}{R_{9}}+\\frac{I_{2}}{\\beta_{F 17}} \\cong \\frac{V_{T} \\ln \\left(I_{2} / I_{s 17}\\right)+R_{8} I_{2}}{R_{9}}+\\frac{I_{2}}{\\beta_{F 17}} \\tag{5.11a}\n\\end{equation*}\n$$\n\nBy assuming $I_{s 17}=10 \\mathrm{fA}$ and $\\beta_{F 17}=250$, we obtain\n\n$$\n\\begin{equation*}\nI_{C 16}=16 \\mu \\mathrm{~A} \\tag{5.11b}\n\\end{equation*}\n$$\n\nThis concludes the dc analysis.\nFor the small-signal analysis, consult Fig. 5.8a, where $C_{c}$ is omitted due to our focus on low-frequency behavior. Beginning from the left and moving right, we derive by inspection\n\n$$\n\\begin{equation*}\nR_{i 2}=r_{\\pi 16}+\\left(\\beta_{016}+1\\right)\\left\\{R_{9} / /\\left[r_{\\pi 17}+\\left(\\beta_{017}+1\\right) R_{8}\\right]\\right\\} \\tag{5.12a}\n\\end{equation*}\n$$\n\nWith $\\beta_{016}=200$ and $\\beta_{017}=250$, we find\n\n$$\n\\begin{equation*}\nR_{i 2}=4.63 \\mathrm{M} \\Omega \\tag{5.12b}\n\\end{equation*}\n$$\n\nBy further inspection, we write\n\n$$\n\\begin{equation*}\nR_{o 2}=r_{o 13 A} / / R_{c 17} \\cong r_{o 13 A} / /\\left[r_{o 17}\\left(1+g_{m 17} R_{8}\\right)\\right] \\tag{5.13a}\n\\end{equation*}\n$$\n\nUsing $r_{o 13 A}=(50 \\mathrm{~V}) /(528 \\mu \\mathrm{~A})=94.7 \\mathrm{k} \\Omega$ and $r_{o 17}=(100 \\mathrm{~V}) /(528 \\mu \\mathrm{~A})=189.4 \\mathrm{k} \\Omega$, we get\n\n$$\n\\begin{equation*}\nR_{o 2}=81.3 \\mathrm{k} \\Omega \\tag{5.13b}\n\\end{equation*}\n$$\n\nFIGURE 5.7 Circuit for the dc analysis of the intermediate stage of the 741 op amp.\nimage_name:FIGURE 5.7 Circuit for the dc analysis of the intermediate stage of the 741 op amp\ndescription:\n[\nname: Q16, type: NPN, ports: {C: VCC, B: Vo1, E: V1}\nname: Q17, type: NPN, ports: {C: V2, B: V1, E: V3}\nname: R9, type: Resistor, value: 50kΩ, ports: {N1: V1, N2: VEE}\nname: R8, type: Resistor, value: 100Ω, ports: {N1: V3, N2: VEE}\nname: I2, type: CurrentSource, value: 528μA, ports: {Np: Vcc, Nn: V2}\n]\nextrainfo:The circuit represents the intermediate stage of a 741 operational amplifier for DC analysis. It includes two NPN transistors (Q16 and Q17), two resistors (R8 and R9), and a current source (I2). The transistors are configured with Q16 in a common collector mode and Q17 in a common emitter mode.\n\nFIGURE 5.7 Circuit for the dc analysis of the intermediate stage of the 741 op amp.\nimage_name:(a)\ndescription:\n[\nname: Q16, type: NPN, ports: {C: GND, B: vi2, E: vb17}\nname: Q17, type: NPN, ports: {C: GND, B: vb17, E: ve17}\nname: R9, type: Resistor, value: 50kΩ, ports: {N1: vb17, N2: GND}\nname: R8, type: Resistor, value: 100Ω, ports: {N1: ve17, N2: GND}\nname: ro13A, type: Resistor, value: 94.7kΩ, ports: {N1: GND, N2: GND}\n]\nextrainfo:The circuit represents the intermediate stage of a 741 operational amplifier for DC analysis. It includes two NPN transistors (Q16 and Q17), two resistors (R8 and R9), and a current source (I2). The transistors are configured with Q16 in a common collector mode and Q17 in a common emitter mode.\nimage_name:(b)\ndescription:\n[\nname: Ri2, type: Resistor, value: 4.63MΩ, ports: {N1: Vi2, N2: GND}\nname: Gm2, type: VoltageControlledCurrentSource, value: 1/161Ω, ports: {Np: Vo2, Nn: GND}\nname: Ro2, type: Resistor, value: 81.3kΩ, ports: {N1: Vo2, N2: GND}\n]\nextrainfo:The circuit is an AC analysis of the second stage of the 741 op amp. It consists of a voltage-controlled current source Gm2, a resistor Ri2, and a resistor Ro2. The input voltage is Vi2 and the output voltage is Vo2.\n\nFIGURE 5.8 (a) Circuit for the ac analysis of the second stage, and (b) second-stage small-signal equivalent.\n\nFinally, considering $Q_{16}$ operates in CC mode and $Q_{17}$ in CE-ED mode, we express\n\n$$\n\\begin{align*}\nG_{m 2} & =\\frac{i_{o 2(s c)}}{v_{i 2}}=\\frac{v_{b 17}}{v_{i 2}} \\times \\frac{i_{c 17}}{v_{b 17}}=\\frac{1}{1+\\frac{r_{e 16}}{R_{9} / /\\left[r_{\\pi 17}+\\left(\\beta_{017}+1\\right) R_{8}\\right]}} \\times \\frac{g_{m 17}}{1+g_{m 17} R_{8}}  \\tag{5.14}\\\\\n& =\\frac{1}{161 \\Omega}\n\\end{align*}\n$$\n\nHere, $G_{m 2}$ represents the second-stage transconductance. The small-signal characteristics of this stage are summarized in Fig. 5.8b, finalizing the second-stage analysis."
},
{
    "text": "The 741 op amp's output stage features intriguing design solutions, best understood by examining its standby state, depicted in Fig. 5.9 for an input of 0 V and no output load. The biasing transistors $Q_{18}$ and $Q_{19}$ are minimal in size, whereas the push-pull transistors $Q_{14}$ and $Q_{20}$ have larger emitter areas (typically four times larger) to maintain good current gains even at high load currents. If $Q_{14}$ and $Q_{19}$ were diode-connected as in Section 4.10, $Q_{14}$ and $Q_{20}$ would draw a standby current about four times that of the diodes. To lower this current to a more acceptable level, $Q_{18}$ is appropriately underbiased, as the following example will illustrate. It's also noteworthy that $Q_{18}$ and $Q_{19}$, sharing the same collector, are fabricated within the same isolation region, conserving valuable die area.\n\nimage_name:FIGURE 5.9\ndescription:\n[\nname: Q14, type: NPN, ports: {C: VCC, B: V1, E: V5}\nname: Q18, type: NPN, ports: {C: V1, B: V1, E: V2}\nname: Q19, type: NPN, ports: {C: V1, B: V2, E: V3}\nname: Q20, type: PNP, ports: {C: VEE, B: V3, E: V6}\nname: Q22, type: PNP, ports: {C: VEE, B: GND, E: V3}\nname: R6, type: Resistor, value: 27 Ω, ports: {N1: V5, N2: V4}\nname: R7, type: Resistor, value: 22 Ω, ports: {N1: V4, N2: V6}\nname: R10, type: Resistor, value: 50 kΩ, ports: {N1: V2, N2: GND}\nname: I3, type: CurrentSource, value: 176 μA, ports: {Np: VCC, Nn: V1}\n]\nextrainfo:This circuit is a DC analysis of the 741 output stage in standby mode. It includes NPN and PNP transistors, resistors, and a current source. The analysis involves estimating collector currents and voltages at various nodes to understand the circuit behavior under standby conditions.\n\nFIGURE 5.9 Dc analysis of the 741 output stage in standby.\n\nIn the circuit of Fig. 5.9, let $I_{s 18}=I_{s 19}=2 \\mathrm{fA}$ and $I_{s 14}=I_{s 20}=8 \\mathrm{fA}$ (four times larger). Additionally, assume negligible base currents for all BJTs whenever appropriate.\n(a) Use iterative methods to estimate the collector currents $I_{C 18}$ and $I_{C 19}$. Then, determine $V_{B B}$ in mV.\n(b) Estimate $I_{C 14}$ and $I_{C 20}$ under the simplifying assumption $R_{6}=R_{7}=0$.\n(c) Repeat part (b) with $R_{6}$ and $R_{7}$ in place as shown. Comment on your findings.\n\n#### Solution\n\n(a) Begin with $V_{B E 19}=0.7 \\mathrm{~V}$, so $I_{C 18} \\approx V_{B E 19} / R_{10} \\approx 0.7 / 50 = 14 \\mu \\mathrm{~A}$. By KCL, $I_{C 19}=I_{3}-I_{C 18} \\approx 176-14 = 162 \\mu \\mathrm{~A}$. Using the BJT equation, $V_{B E 19} = V_{T} \\ln (I_{C 19} / I_{s 19}) = 0.026 \\ln [(162 \\times 10^{-6}) / (2 \\times 10^{-15})] = 0.653 \\mathrm{~V}$. Use this value for the refined estimate $I_{C 18} \\approx 0.653 / 50 \\approx 13 \\mu \\mathrm{~A}$. Allowing for about $1 \\mu \\mathrm{~A}$ of base current for $Q_{19}$, we finally get\n\n$$\n\\begin{equation*}\nI_{C 18} \\approx 14 \\mu \\mathrm{~A} \\quad I_{C 19} \\approx 162 \\mu \\mathrm{~A} \\tag{5.15}\n\\end{equation*}\n$$\n\nNo further iterations are needed. Applying the BJT equation again with $I_{s 18}=I_{s 19}=2 \\mathrm{fA}$, we obtain\n\n$$\nV_{B B}=V_{B E 18}+V_{B E 19}=589.4+653.1 \\approx 1242 \\mathrm{mV}\n$$\n\n(b) In standby, $I_{C 14}=I_{C 20}$. With $I_{s 14}=I_{s 20}$, we also have $V_{B E 14}=V_{E B 20}=V_{B B} / 2$, so\n\n$$\nI_{C 14}=I_{C 20}=8 \\times 10^{-15} \\exp (1242 / 52) \\approx 190 \\mu \\mathrm{~A}\n$$\n\nDespite being large-area devices, $Q_{14}$ and $Q_{20}$ conduct a standby current comparable to $I_{3}$.\n(c) With $R_{6}$ and $R_{7}$ in place, the voltage drop across the combined junctions of $Q_{14}$ and $Q_{20}$ decreases by $\\Delta V=(R_{6}+R_{7}) I_{Q}$, where $I_{Q}$ is the new quiescent current of $Q_{14}$ and $Q_{20}$. Using $190 \\mu \\mathrm{~A}$ as our initial estimate for $I_{Q}$, we find $\\Delta V=(27+22) 190 \\times 10^{-6} \\approx 9.3 \\mathrm{mV}$, so\n\n$$\n\\begin{equation*}\nI_{Q}=8 \\times 10^{-15} \\exp [(1242-9.3) / 52] \\approx 160 \\mu \\mathrm{~A} \\tag{5.16}\n\\end{equation*}\n$$\n\nThis is lower than the previous estimate due to the voltage drop across $R_{6}$ and $R_{7}$.\n\nIn practical applications, the output stage is rarely in standby. For a more realistic AC analysis, consider a typical scenario with a $2-\\mathrm{k} \\Omega$ load driven by a voltage centered at $V_{O}=5 \\mathrm{~V}$. Under these conditions, the lower half of the push-pull stage will be off, leaving $Q_{14}$ to source the current $I_{L}=5 / 2=2.5 \\mathrm{~mA}$ to the load. The AC equivalent of the output stage simplifies as shown in Fig. 5.10a, where $Q_{13 B}$ is modeled with the resistance $r_{o 13 B}=(50 \\mathrm{~V}) / (176 \\mu \\mathrm{~A})=284 \\mathrm{k} \\Omega$, and the biasing network composed of $Q_{18}, Q_{19}$, and $R_{10}$ with a single small-signal resistance $r_{b b} \\approx 174 \\Omega$ (see Exercise 5.1).\n\nimage_name:(a)\ndescription:\n[\nname: Q22, type: PNP, ports: {C: GND, B: vi3, E: ve22}\nname: Q14, type: NPN, ports: {C: GND, B: v1, E: v2}\nname: Ro13B, type: Resistor, value: 284kΩ, ports: {N1: GND, N2: v1}\nname: Rbb, type: Resistor, value: 174Ω, ports: {N1: v1, N2: ve22}\nname: R02, type: Resistor, value: 81.3kΩ, ports: {N1: vi3, N2: GND}\nname: R6, type: Resistor, value: 27kΩ, ports: {N1: v2, N2: vo}\nname: RL, type: Resistor, value: 2kΩ, ports: {N1: vo, N2: GND}\n]\nextrainfo:The circuit is an AC analysis model of an output stage. It includes a push-pull amplifier configuration with transistors Q22 and Q14, resistors for biasing and load, and models for small-signal analysis. The circuit is designed to analyze the behavior of the output stage under AC conditions.\nimage_name:(b)\ndescription:\n[\nname: Ri3, type: Resistor, value: 9.33MΩ, ports: {N1: Vi3, N2: GND}\nname: Ro, type: Resistor, value: 47Ω, ports: {N1: Vi3, N2: Vo}\nname: vi3, type: VoltageControlledCurrentSource, value: vi3, ports: {Np: Vi3, Nn: GND}\n]\nextrainfo:The circuit is an AC equivalent output stage with a push-pull configuration. Q14 sources current to the load, while Q22 is part of the biasing network. The circuit includes a feedback loop with resistors and a small-signal equivalent for AC analysis.\n\nFIGURE 5.10 (a) Circuit for the ac analysis of the output stage, and (b) output-stage small-signal equivalent.\n\n#### EXercise 5.1\n\nDraw the small-signal equivalent of the biasing network of Fig. 5.9, consisting of $Q_{18}, Q_{19}$, and $R_{10}$, and demonstrate that the entire network acts as a single resistance\n\n$$\n\\begin{equation*}\nr_{b b}=\\frac{r_{d 18}+\\left(R_{10} / / r_{\\pi 19}\\right)}{1+g_{m 19}\\left(R_{10} / / r_{\\pi 19}\\right)} \\approx 174 \\Omega \\tag{5.17}\n\\end{equation*}\n$$\n\nwhere $r_{d 18}=V_{T} / I_{C 18}$ is the AC resistance of diode-connected $Q_{18}$, and $g_{m 19}=I_{C 19} / V_{T}$ and $r_{\\pi 19}=\\beta_{019} / g_{m 19}$ are the small-signal parameters of $Q_{19}$. Assume the currents of Example 5.1 and $\\beta_{019}=200$.\n\nTo determine the small-signal characteristics of the output stage, refer to Fig. 5.10a. Considering the two voltage-followers coupled via the small resistance $r_{b b}$, we can approximate\n\n$$\n\\begin{equation*}\nv_{o} \\approx 1 \\times v_{i 3} \\tag{5.18}\n\\end{equation*}\n$$\n\nBy inspection, we also have\n\n$$\n\\begin{equation*}\nR_{i 3}=r_{\\pi 22}+\\left(\\beta_{022}+1\\right)\\left[r_{b b}+\\left(r_{o 13 B} / / R_{b 14}\\right)\\right] \\tag{5.19a}\n\\end{equation*}\n$$\n\nwhere $R_{b 14}$ is the AC resistance seen looking into the base of $Q_{14}$,\n\n$$\nR_{b 14}=r_{\\pi 14}+\\left(\\beta_{014}+1\\right)\\left(R_{6}+R_{L}\\right)\n$$\n\nAssuming $I_{C 14}=2.5 \\mathrm{~mA}$ and $\\beta_{014}=250$, we get $R_{b 14} \\approx 511 \\mathrm{k} \\Omega$. Substituting into Eq. (5.19a) and assuming $\\beta_{022}=50$, we obtain\n\n$$\n\\begin{equation*}\nR_{i 3}=9.33 \\mathrm{M} \\Omega \\tag{5.19b}\n\\end{equation*}\n$$\n\nUsing inspection again, we write\n\n$$\n\\begin{equation*}\nR_{o}=R_{6}+\\frac{R_{B 14}+r_{\\pi 14}}{\\beta_{014}+1} \\tag{5.20a}\n\\end{equation*}\n$$\n\nwhere $R_{B 14}$ is the AC resistance presented to $Q_{14}$'s base by the upstream circuitry,\n\n$$\nR_{B 14}=r_{o 13 B} / /\\left(r_{b b}+R_{e 22}\\right)\n$$\n\nand $R_{e 22}$ is the AC resistance seen looking into $Q_{22}$'s emitter\n\n$$\nR_{e 22}=\\frac{R_{o 2}+r_{\\pi 22}}{\\beta_{022}+1}=\\frac{81.3+50(26 / 0.176)}{50+1}=1.74 \\mathrm{k} \\Omega\n$$\n\nSubstituting gives $R_{B 14}=1.9 \\mathrm{k} \\Omega$. Substituting in turn into Eq. (5.20a) yields\n\n$$\n\\begin{equation*}\nR_{o}=47 \\Omega \\tag{5.20b}\n\\end{equation*}\n$$\n\nThe small-signal characteristics of the output stage are summarized in Fig. 5.10b. Before concluding this stage, we investigate one additional characteristic that users need to be aware of, as reported in the data sheets.\n\n- Output Voltage Swing (OVS). This is the range of $v_{O}$ values over which the output stage operates correctly, with all active BJTs in the forward-active region or at most at the edge of saturation (EOS). A simple inspection of Fig. 5.1 shows that the upper limit for $v_{O}$ is reached when $Q_{13 B}$ is driven to EOS, and the lower limit when $Q_{17}$ is driven to EOS. Using KVL, we write $v_{O(\\max )} \\cong V_{C C}-V_{E C 13(\\mathrm{EOS})}-V_{B E 14(\\mathrm{on})}$ and $v_{O(\\min )} \\cong V_{E E}+V_{C E 17(\\mathrm{EOS})}+$ $V_{\\text {EB22(on) }}+V_{\\text {EB20(on) }}$. These simplify to\n\n$$\n\\begin{equation*}\nv_{O(\\max )} \\cong V_{C C}-V_{E C(\\mathrm{EOS})}-V_{B E(\\mathrm{on})} \\quad v_{O(\\min )} \\cong V_{E E}+V_{C E(\\mathrm{EOS})}+2 V_{E B(\\mathrm{on})} \\tag{5.21}\n\\end{equation*}\n$$\n\n(The above estimates assume identical junction voltage drops for the BJTs and light output loading,忽略ing voltage drops across $R_{6}$ and $R_{7}$.) If we assume junction drops of 0.7 V and EOS drops of 0.2 V, the estimates give $v_{O(\\max )} \\cong V_{C C}-0.9 \\mathrm{~V}$ and $v_{O(\\min )} \\cong V_{E E}+1.6 \\mathrm{~V}$. With $\\pm 15-\\mathrm{V}$ supplies, the OVS is thus $-13.4 \\mathrm{~V} \\leq v_{O} \\leq+14.1 \\mathrm{~V}$."
},
{
    "text": "The 741 op amp's output stage incorporates several notable design strategies, best understood by examining the circuit in its standby condition, as depicted in Fig. 5.9, where the input is at 0 V and no output load is present. The biasing transistors $Q_{18}$ and $Q_{19}$ are of minimal size, whereas the push-pull transistors $Q_{14}$ and $Q_{20}$ have larger emitter areas (typically four times larger) to maintain adequate current gains even at high load currents. If $Q_{14}$ and $Q_{19}$ were diode-connected as in Section 4.10, $Q_{14}$ and $Q_{20}$ would draw a standby current about four times that of the diodes. To reduce this current to a more manageable level, $Q_{18}$ is deliberately underbiased, as the following example will illustrate. Additionally, since $Q_{18}$ and $Q_{19}$ share the same collector, they are fabricated within the same isolation region, conserving valuable die area.\n\nimage_name:FIGURE 5.9\ndescription:\n[\nname: Q14, type: NPN, ports: {C: VCC, B: V1, E: V5}\nname: Q18, type: NPN, ports: {C: V1, B: V1, E: V2}\nname: Q19, type: NPN, ports: {C: V1, B: V2, E: V3}\nname: Q20, type: PNP, ports: {C: VEE, B: V3, E: V6}\nname: Q22, type: PNP, ports: {C: VEE, B: GND, E: V3}\nname: R6, type: Resistor, value: 27 Ω, ports: {N1: V5, N2: V4}\nname: R7, type: Resistor, value: 22 Ω, ports: {N1: V4, N2: V6}\nname: R10, type: Resistor, value: 50 kΩ, ports: {N1: V2, N2: GND}\nname: I3, type: CurrentSource, value: 176 μA, ports: {Np: VCC, Nn: V1}\n]\nextrainfo:This circuit represents a DC analysis of the 741 output stage in standby mode, featuring NPN and PNP transistors, resistors, and a current source. The analysis involves estimating collector currents and voltages at various nodes to understand the circuit's behavior under standby conditions.\n\nFIGURE 5.9 DC analysis of the 741 output stage in standby.\n\nIn the circuit shown in Fig. 5.9, let $I_{s 18}=I_{s 19}=2 \\mathrm{fA}$ and $I_{s 14}=I_{s 20}=8 \\mathrm{fA}$ (four times larger). Assume negligible base currents for all BJTs where appropriate.\n(a) Use iterative methods to estimate the collector currents $I_{C 18}$ and $I_{C 19}$. Then, determine $V_{B B}$ in mV.\n(b) Estimate $I_{C 14}$ and $I_{C 20}$ under the simplifying assumption $R_{6}=R_{7}=0$.\n(c) Repeat part (b) with $R_{6}$ and $R_{7}$ in place as shown. Comment on your findings.\n\n#### Solution\n\n(a) Begin with $V_{B E 19}=0.7 \\mathrm{~V}$, so $I_{C 18} \\approx V_{B E 19} / R_{10} \\approx 0.7 / 50 = 14 \\mu \\mathrm{~A}$. By KCL, $I_{C 19}=I_{3}-I_{C 18} \\approx 176-14 = 162 \\mu \\mathrm{~A}$. Using the BJT equation, $V_{B E 19} = V_{T} \\ln (I_{C 19} / I_{s 19}) = 0.026 \\ln [(162 \\times 10^{-6}) / (2 \\times 10^{-15})] = 0.653 \\mathrm{~V}$. Use this value for a refined estimate $I_{C 18} \\approx 0.653 / 50 \\approx 13 \\mu \\mathrm{~A}$. Allowing for about $1 \\mu \\mathrm{~A}$ of base current for $Q_{19}$, we get\n\n$$\n\\begin{equation*}\nI_{C 18} \\approx 14 \\mu \\mathrm{~A} \\quad I_{C 19} \\approx 162 \\mu \\mathrm{~A} \\tag{5.15}\n\\end{equation*}\n$$\n\nNo further iterations are needed. Applying the BJT equation with $I_{s 18}=I_{s 19}=2 \\mathrm{fA}$, we obtain\n\n$$\nV_{B B}=V_{B E 18}+V_{B E 19}=589.4+653.1 \\approx 1242 \\mathrm{mV}\n$$\n\n(b) In standby, $I_{C 14}=I_{C 20}$. With $I_{s 14}=I_{s 20}$, we also have $V_{B E 14}=V_{E B 20}=V_{B B} / 2$, so\n\n$$\nI_{C 14}=I_{C 20}=8 \\times 10^{-15} \\exp (1242 / 52) \\approx 190 \\mu \\mathrm{~A}\n$$\n\nDespite being large-area devices, $Q_{14}$ and $Q_{20}$ conduct a standby current comparable to $I_{3}$.\n(c) With $R_{6}$ and $R_{7}$ in place, the voltage drop across the combined junctions of $Q_{14}$ and $Q_{20}$ decreases by $\\Delta V=(R_{6}+R_{7}) I_{Q}$, where $I_{Q}$ is the new quiescent current of $Q_{14}$ and $Q_{20}$. Using $190 \\mu \\mathrm{~A}$ as an initial estimate for $I_{Q}$, we find $\\Delta V=(27+22) 190 \\times 10^{-6} \\approx 9.3 \\mathrm{mV}$, so\n\n$$\n\\begin{equation*}\nI_{Q}=8 \\times 10^{-15} \\exp [(1242-9.3) / 52] \\approx 160 \\mu \\mathrm{~A} \\tag{5.16}\n\\end{equation*}\n$$\n\nThis is lower than the previous estimate due to the voltage drop across $R_{6}$ and $R_{7}$.\n\nIn practical applications, the output stage is rarely in standby. For a more realistic AC analysis, consider a typical scenario with a $2-\\mathrm{k} \\Omega$ load driven by a voltage centered at $V_{O}=5 \\mathrm{~V}$. Under these conditions, the lower half of the push-pull stage is off, leaving $Q_{14}$ to source the current $I_{L}=5 / 2=2.5 \\mathrm{~mA}$ to the load. The AC equivalent of the output stage simplifies as shown in Fig. 5.10a, where $Q_{13 B}$ is modeled with the resistance $r_{o 13 B}=(50 \\mathrm{~V}) / (176 \\mu \\mathrm{~A})=284 \\mathrm{k} \\Omega$, and the biasing network of $Q_{18}, Q_{19}$, and $R_{10}$ is represented by a single small-signal resistance $r_{b b} \\approx 174 \\Omega$ (see Exercise 5.1).\n\nimage_name:(a)\ndescription:\n[\nname: Q22, type: PNP, ports: {C: GND, B: vi3, E: ve22}\nname: Q14, type: NPN, ports: {C: GND, B: v1, E: v2}\nname: Ro13B, type: Resistor, value: 284kΩ, ports: {N1: GND, N2: v1}\nname: Rbb, type: Resistor, value: 174Ω, ports: {N1: v1, N2: ve22}\nname: R02, type: Resistor, value: 81.3kΩ, ports: {N1: vi3, N2: GND}\nname: R6, type: Resistor, value: 27kΩ, ports: {N1: v2, N2: vo}\nname: RL, type: Resistor, value: 2kΩ, ports: {N1: vo, N2: GND}\n]\nextrainfo:The circuit is an AC analysis model of an output stage, featuring a push-pull amplifier configuration with transistors Q22 and Q14, resistors for biasing and load, and models for small-signal analysis. The circuit is designed to analyze the behavior of the output stage under AC conditions.\nimage_name:(b)\ndescription:\n[\nname: Ri3, type: Resistor, value: 9.33MΩ, ports: {N1: Vi3, N2: GND}\nname: Ro, type: Resistor, value: 47Ω, ports: {N1: Vi3, N2: Vo}\nname: vi3, type: VoltageControlledCurrentSource, value: vi3, ports: {Np: Vi3, Nn: GND}\n]\nextrainfo:The circuit is an AC equivalent output stage with a push-pull configuration. Q14 sources current to the load, while Q22 is part of the biasing network. The circuit includes a feedback loop with resistors and a small-signal equivalent for AC analysis.\n\nFIGURE 5.10 (a) Circuit for the AC analysis of the output stage, and (b) output-stage small-signal equivalent.\n\n#### Exercise 5.1\n\nDraw the small-signal equivalent of the biasing network in Fig. 5.9, consisting of $Q_{18}, Q_{19}$, and $R_{10}$, and demonstrate that the entire network acts as a single resistance\n\n$$\n\\begin{equation*}\nr_{b b}=\\frac{r_{d 18}+\\left(R_{10} / / r_{\\pi 19}\\right)}{1+g_{m 19}\\left(R_{10} / / r_{\\pi 19}\\right)} \\approx 174 \\Omega \\tag{5.17}\n\\end{equation*}\n$$\n\nwhere $r_{d 18}=V_{T} / I_{C 18}$ is the AC resistance of diode-connected $Q_{18}$, and $g_{m 19}=I_{C 19} / V_{T}$ and $r_{\\pi 19}=\\beta_{019} / g_{m 19}$ are the small-signal parameters of $Q_{19}$. Assume the currents from Example 5.1 and $\\beta_{019}=200$.\n\nTo determine the small-signal characteristics of the output stage, refer to Fig. 5.10a. Considering the two voltage-followers coupled via the small resistance $r_{b b}$, we can approximate\n\n$$\n\\begin{equation*}\nv_{o} \\approx 1 \\times v_{i 3} \\tag{5.18}\n\\end{equation*}\n$$\n\nBy inspection, we also have\n\n$$\n\\begin{equation*}\nR_{i 3}=r_{\\pi 22}+\\left(\\beta_{022}+1\\right)\\left[r_{b b}+\\left(r_{o 13 B} / / R_{b 14}\\right)\\right] \\tag{5.19a}\n\\end{equation*}\n$$\n\nwhere $R_{b 14}$ is the AC resistance seen looking into the base of $Q_{14}$,\n\n$$\nR_{b 14}=r_{\\pi 14}+\\left(\\beta_{014}+1\\right)\\left(R_{6}+R_{L}\\right)\n$$\n\nAssuming $I_{C 14}=2.5 \\mathrm{~mA}$ and $\\beta_{014}=250$, we get $R_{b 14} \\approx 511 \\mathrm{k} \\Omega$. Substituting into Eq. (5.19a) and assuming $\\beta_{022}=50$, we obtain\n\n$$\n\\begin{equation*}\nR_{i 3}=9.33 \\mathrm{M} \\Omega \\tag{5.19b}\n\\end{equation*}\n$$\n\nUsing inspection again, we write\n\n$$\n\\begin{equation*}\nR_{o}=R_{6}+\\frac{R_{B 14}+r_{\\pi 14}}{\\beta_{014}+1} \\tag{5.20a}\n\\end{equation*}\n$$\n\nwhere $R_{B 14}$ is the AC resistance presented to $Q_{14}$'s base by the upstream circuitry,\n\n$$\nR_{B 14}=r_{o 13 B} / /\\left(r_{b b}+R_{e 22}\\right)\n$$\n\nand $R_{e 22}$ is the AC resistance seen looking into $Q_{22}$'s emitter\n\n$$\nR_{e 22}=\\frac{R_{o 2}+r_{\\pi 22}}{\\beta_{022}+1}=\\frac{81.3+50(26 / 0.176)}{50+1}=1.74 \\mathrm{k} \\Omega\n$$\n\nSubstituting gives $R_{B 14}=1.9 \\mathrm{k} \\Omega$. Substituting in turn into Eq. (5.20a) yields\n\n$$\n\\begin{equation*}\nR_{o}=47 \\Omega \\tag{5.20b}\n\\end{equation*}\n$$\n\nThe small-signal characteristics of the output stage are summarized in Fig. 5.10b. Before concluding this stage, we investigate one additional characteristic that users need to be aware of, as reported in the data sheets.\n\n- Output Voltage Swing (OVS). This is the range of $v_{O}$ values over which the output stage operates properly, with all active BJTs in the forward-active region or at most at the edge of saturation (EOS). A simple inspection of Fig. 5.1 reveals that the upper limit for $v_{O}$ is reached when $Q_{13 B}$ is driven to EOS, and the lower limit when $Q_{17}$ is driven to EOS. Using KVL, we write $v_{O(\\max )} \\cong V_{C C}-V_{E C 13(\\mathrm{EOS})}-V_{B E 14(\\mathrm{on})}$ and $v_{O(\\min )} \\cong V_{E E}+V_{C E 17(\\mathrm{EOS})}+$ $V_{\\text {EB22(on) }}+V_{\\text {EB20(on) }}$. These simplify to\n\n$$\n\\begin{equation*}\nv_{O(\\max )} \\cong V_{C C}-V_{E C(\\mathrm{EOS})}-V_{B E(\\mathrm{on})} \\quad v_{O(\\min )} \\cong V_{E E}+V_{C E(\\mathrm{EOS})}+2 V_{E B(\\mathrm{on})} \\tag{5.21}\n\\end{equation*}\n$$\n\n(The above estimates assume identical junction voltage drops for the BJTs and light output loading, so voltage drops across $R_{6}$ and $R_{7}$ are negligible.) Assuming junction drops of 0.7 V and EOS drops of 0.2 V, the estimates give $v_{O(\\max )} \\cong V_{C C}-0.9 \\mathrm{~V}$ and $v_{O(\\min )} \\cong V_{E E}+1.6 \\mathrm{~V}$. With $\\pm 15-\\mathrm{V}$ supplies, the OVS is thus $-13.4 \\mathrm{~V} \\leq v_{O} \\leq+14.1 \\mathrm{~V}$."
},
{
    "text": "The output stage of the 741 operational amplifier incorporates several intriguing design strategies, best understood by analyzing the circuit in its standby condition. This state is depicted in Fig. 5.9, illustrating the scenario where the input is at 0 V and no output load is present. The biasing transistors $Q_{18}$ and $Q_{19}$ are of minimal size, whereas the push-pull transistors $Q_{14}$ and $Q_{20}$ are constructed with larger emitter areas (typically four times larger) to ensure adequate current gains even at high load currents. If $Q_{14}$ and $Q_{19}$ were connected as diodes, as described in Section 4.10, $Q_{14}$ and $Q_{20}$ would draw a standby current approximately four times that of the diodes. To reduce this current to a more manageable level, $Q_{18}$ is deliberately underbiased, as the following example will illustrate. Additionally, since $Q_{18}$ and $Q_{19}$ share the same collector, they are fabricated within the same isolation region, thereby conserving valuable die area.\n\nimage_name:FIGURE 5.9\ndescription:\n[\nname: Q14, type: NPN, ports: {C: VCC, B: V1, E: V5}\nname: Q18, type: NPN, ports: {C: V1, B: V1, E: V2}\nname: Q19, type: NPN, ports: {C: V1, B: V2, E: V3}\nname: Q20, type: PNP, ports: {C: VEE, B: V3, E: V6}\nname: Q22, type: PNP, ports: {C: VEE, B: GND, E: V3}\nname: R6, type: Resistor, value: 27 Ω, ports: {N1: V5, N2: V4}\nname: R7, type: Resistor, value: 22 Ω, ports: {N1: V4, N2: V6}\nname: R10, type: Resistor, value: 50 kΩ, ports: {N1: V2, N2: GND}\nname: I3, type: CurrentSource, value: 176 μA, ports: {Np: VCC, Nn: V1}\n]\nextrainfo:This circuit represents a DC analysis of the 741 output stage in standby mode, featuring NPN and PNP transistors, resistors, and a current source. The analysis involves estimating collector currents and voltages at various nodes to comprehend the circuit's behavior under standby conditions.\n\nFIGURE 5.9 DC analysis of the 741 output stage in standby.\n\nIn the circuit shown in Fig. 5.9, let $I_{s 18}=I_{s 19}=2 \\mathrm{fA}$ and $I_{s 14}=I_{s 20}=8 \\mathrm{fA}$ (four times larger). Whenever applicable, assume negligible base currents for all BJTs.\n(a) Use iterative methods to estimate the collector currents $I_{C 18}$ and $I_{C 19}$. Then, determine $V_{B B}$ in mV.\n(b) Estimate $I_{C 14}$ and $I_{C 20}$ under the simplifying assumption $R_{6}=R_{7}=0$.\n(c) Repeat part (b), but with $R_{6}$ and $R_{7}$ included as shown. Comment on your findings.\n\n#### Solution\n\n(a) Begin with $V_{B E 19}=0.7 \\mathrm{~V}$, thus $I_{C 18} \\approx V_{B E 19} / R_{10} \\approx 0.7 / 50 = 14 \\mu \\mathrm{~A}$. By KCL, $I_{C 19}=I_{3}-I_{C 18} \\approx 176-14 = 162 \\mu \\mathrm{~A}$. Using the BJT equation, $V_{B E 19} = V_{T} \\ln \\left(I_{C 19} / I_{s 19}\\right) = 0.026 \\ln \\left[\\left(162 \\times 10^{-6}\\right) / \\left(2 \\times 10^{-15}\\right)\\right] = 0.653 \\mathrm{~V}$. Utilize this value for the refined estimate $I_{C 18} \\approx 0.653 / 50 \\approx 13 \\mu \\mathrm{~A}$. Allowing for approximately $1 \\mu \\mathrm{~A}$ of base current for $Q_{19}$, we ultimately obtain\n\n$$\n\\begin{equation*}\nI_{C 18} \\approx 14 \\mu \\mathrm{~A} \\quad I_{C 19} \\approx 162 \\mu \\mathrm{~A} \\tag{5.15}\n\\end{equation*}\n$$\n\nNo further iterations are necessary. Applying the BJT equation again with $I_{s 18}=I_{s 19}=2 \\mathrm{fA}$, we get\n\n$$\nV_{B B} = V_{B E 18} + V_{B E 19} = 589.4 + 653.1 \\approx 1242 \\mathrm{mV}\n$$\n\n(b) In standby, $I_{C 14} = I_{C 20}$. Additionally, with $I_{s 14}=I_{s 20}$, we also have $V_{B E 14} = V_{E B 20} = V_{B B} / 2$, so\n\n$$\nI_{C 14} = I_{C 20} = 8 \\times 10^{-15} \\exp (1242 / 52) \\approx 190 \\mu \\mathrm{~A}\n$$\n\nDespite being large-area devices, $Q_{14}$ and $Q_{20}$ conduct a standby current comparable to $I_{3}$.\n(c) With $R_{6}$ and $R_{7}$ in place, the voltage drop across the combined junctions of $Q_{14}$ and $Q_{20}$ decreases by $\\Delta V = (R_{6} + R_{7}) I_{Q}$, where $I_{Q}$ is the new quiescent current of $Q_{14}$ and $Q_{20}$. Using $190 \\mu \\mathrm{~A}$ as our initial estimate for $I_{Q}$, we find $\\Delta V = (27 + 22) 190 \\times 10^{-6} \\approx 9.3 \\mathrm{mV}$, thus\n\n$$\n\\begin{equation*}\nI_{Q} = 8 \\times 10^{-15} \\exp [(1242 - 9.3) / 52] \\approx 160 \\mu \\mathrm{~A} \\tag{5.16}\n\\end{equation*}\n$$\n\nThis is lower than the previous estimate due to the voltage drop across $R_{6}$ and $R_{7}$.\n\nIn practical applications, the output stage is rarely in standby. For a more realistic AC analysis, consider a typical scenario with a $2-\\mathrm{k} \\Omega$ load driven by a voltage centered at $V_{O} = 5 \\mathrm{~V}$. Under these conditions, the lower half of the push-pull stage will be off, leaving $Q_{14}$ to source the current $I_{L} = 5 / 2 = 2.5 \\mathrm{~mA}$ to the load. The AC equivalent of the output stage simplifies as shown in Fig. 5.10a, where $Q_{13 B}$ is modeled with the resistance $r_{o 13 B} = (50 \\mathrm{~V}) / (176 \\mu \\mathrm{~A}) = 284 \\mathrm{k} \\Omega$, and the biasing network composed of $Q_{18}, Q_{19}$, and $R_{10}$ with a single small-signal resistance $r_{b b} \\approx 174 \\Omega$ (see Exercise 5.1).\n\nimage_name:(a)\ndescription:\n[\nname: Q22, type: PNP, ports: {C: GND, B: vi3, E: ve22}\nname: Q14, type: NPN, ports: {C: GND, B: v1, E: v2}\nname: Ro13B, type: Resistor, value: 284kΩ, ports: {N1: GND, N2: v1}\nname: Rbb, type: Resistor, value: 174Ω, ports: {N1: v1, N2: ve22}\nname: R02, type: Resistor, value: 81.3kΩ, ports: {N1: vi3, N2: GND}\nname: R6, type: Resistor, value: 27kΩ, ports: {N1: v2, N2: vo}\nname: RL, type: Resistor, value: 2kΩ, ports: {N1: vo, N2: GND}\n]\nextrainfo:The circuit is an AC analysis model of an output stage, featuring a push-pull amplifier configuration with transistors Q22 and Q14, resistors for biasing and load, and models for small-signal analysis. The circuit is designed to analyze the behavior of the output stage under AC conditions.\nimage_name:(b)\ndescription:\n[\nname: Ri3, type: Resistor, value: 9.33MΩ, ports: {N1: Vi3, N2: GND}\nname: Ro, type: Resistor, value: 47Ω, ports: {N1: Vi3, N2: Vo}\nname: vi3, type: VoltageControlledCurrentSource, value: vi3, ports: {Np: Vi3, Nn: GND}\n]\nextrainfo:The circuit is an AC equivalent output stage with a push-pull configuration. Q14 sources current to the load, while Q22 is part of the biasing network. The circuit includes a feedback loop with resistors and a small-signal equivalent for AC analysis.\n\nFIGURE 5.10 (a) Circuit for the AC analysis of the output stage, and (b) output-stage small-signal equivalent.\n\n#### EXercise 5.1\n\nDraw the small-signal equivalent of the biasing network in Fig. 5.9, consisting of $Q_{18}, Q_{19}$, and $R_{10}$, and demonstrate that the entire network acts as a single resistance\n\n$$\n\\begin{equation*}\nr_{b b} = \\frac{r_{d 18} + \\left(R_{10} / / r_{\\pi 19}\\right)}{1 + g_{m 19} \\left(R_{10} / / r_{\\pi 19}\\right)} \\approx 174 \\Omega \\tag{5.17}\n\\end{equation*}\n$$\n\nwhere $r_{d 18} = V_{T} / I_{C 18}$ is the AC resistance of diode-connected $Q_{18}$, and $g_{m 19} = I_{C 19} / V_{T}$ and $r_{\\pi 19} = \\beta_{019} / g_{m 19}$ are the small-signal parameters of $Q_{19}$. Assume the currents from Example 5.1 and $\\beta_{019} = 200$.\n\nTo determine the small-signal characteristics of the output stage, refer again to Fig. 5.10a. Considering the presence of two voltage-followers coupled via the small resistance $r_{b b}$, we can approximate\n\n$$\n\\begin{equation*}\nv_{o} \\approx 1 \\times v_{i 3} \\tag{5.18}\n\\end{equation*}\n$$\n\nBy inspection, we also have\n\n$$\n\\begin{equation*}\nR_{i 3} = r_{\\pi 22} + \\left(\\beta_{022} + 1\\right) \\left[r_{b b} + \\left(r_{o 13 B} / / R_{b 14}\\right)\\right] \\tag{5.19a}\n\\end{equation*}\n$$\n\nwhere $R_{b 14}$ is the AC resistance seen looking into the base of $Q_{14}$,\n\n$$\nR_{b 14} = r_{\\pi 14} + \\left(\\beta_{014} + 1\\right) \\left(R_{6} + R_{L}\\right)\n$$\n\nAssuming $I_{C 14} = 2.5 \\mathrm{~mA}$ and $\\beta_{014} = 250$, we get $R_{b 14} \\approx 511 \\mathrm{k} \\Omega$. Substituting into Eq. (5.19a) and assuming $\\beta_{022} = 50$, we finally obtain\n\n$$\n\\begin{equation*}\nR_{i 3} = 9.33 \\mathrm{M} \\Omega \\tag{5.19b}\n\\end{equation*}\n$$\n\nUsing inspection again, we write\n\n$$\n\\begin{equation*}\nR_{o} = R_{6} + \\frac{R_{B 14} + r_{\\pi 14}}{\\beta_{014} + 1} \\tag{5.20a}\n\\end{equation*}\n$$\n\nwhere $R_{B 14}$ is the AC resistance presented to $Q_{14}$'s base by the upstream circuitry,\n\n$$\nR_{B 14} = r_{o 13 B} / / \\left(r_{b b} + R_{e 22}\\right)\n$$\n\nand $R_{e 22}$ is the AC resistance seen looking into $Q_{22}$'s emitter,\n\n$$\nR_{e 22} = \\frac{R_{o 2} + r_{\\pi 22}}{\\beta_{022} + 1} = \\frac{81.3 + 50(26 / 0.176)}{50 + 1} = 1.74 \\mathrm{k} \\Omega\n$$\n\nSubstituting gives $R_{B 14} = 1.9 \\mathrm{k} \\Omega$. Substituting in turn into Eq. (5.20a) we finally get\n\n$$\n\\begin{equation*}\nR_{o} = 47 \\Omega \\tag{5.20b}\n\\end{equation*}\n$$\n\nThe small-signal characteristics of the output stage are summarized in Fig. 5.10b. Before concluding this stage, we wish to investigate one additional characteristic that the user needs to be aware of, as reported in the data sheets.\n\n- Output Voltage Swing (OVS). This is the range of $v_{O}$ values over which the output stage operates correctly, with all active BJTs in the forward-active region or at most at the edge of saturation (EOS). A simple inspection of Fig. 5.1 reveals that the upper limit for $v_{O}$ is reached when $Q_{13 B}$ is driven to EOS, and the lower limit when $Q_{17}$ is driven to EOS. Using KVL, we write $v_{O(\\max )} \\cong V_{C C} - V_{E C 13(\\mathrm{EOS})} - V_{B E 14(\\mathrm{on})}$ and $v_{O(\\min )} \\cong V_{E E} + V_{C E 17(\\mathrm{EOS})} + V_{\\text {EB22(on) }} + V_{\\text {EB20(on) }}$. These simplify to\n\n$$\n\\begin{equation*}\nv_{O(\\max )} \\cong V_{C C} - V_{E C(\\mathrm{EOS})} - V_{B E(\\mathrm{on})} \\quad v_{O(\\min )} \\cong V_{E E} + V_{C E(\\mathrm{EOS})} + 2 V_{E B(\\mathrm{on})} \\tag{5.21}\n\\end{equation*}\n$$\n\n(The above estimates assume identical junction voltage drops for the BJTs and light output loading, so voltage drops across $R_{6}$ and $R_{7}$ are negligible.) To illustrate, if we assume junction drops of 0.7 V and EOS drops of 0.2 V, the above estimates give $v_{O(\\max )} \\cong V_{C C} - 0.9 \\mathrm{~V}$ and $v_{O(\\min )} \\cong V_{E E} + 1.6 \\mathrm{~V}$. With $\\pm 15-\\mathrm{V}$ supplies, the OVS is thus $-13.4 \\mathrm{~V} \\leq v_{O} \\leq +14.1 \\mathrm{~V}$."
},
{
    "text": "The output stage of the 741 operational amplifier incorporates several intriguing design strategies, best understood by examining the circuit in its standby condition, as depicted in Fig. 5.9. This state is illustrated for an input voltage of 0 V and in the absence of any load at the output. The biasing transistors, $Q_{18}$ and $Q_{19}$, are designed with minimal size, whereas the push-pull transistors, $Q_{14}$ and $Q_{20}$, are constructed with larger emitter areas (typically four times larger) to ensure adequate current gain even at high load currents. If $Q_{14}$ and $Q_{19}$ were connected as diodes, as described in Section 4.10, $Q_{14}$ and $Q_{20}$ would draw a standby current approximately four times that of the diodes. To reduce this current to a more manageable level, $Q_{18}$ is deliberately underbiased, as the following example will elucidate. Additionally, it is noteworthy that $Q_{18}$ and $Q_{19}$, which share the same collector, are fabricated within the same isolation region, thereby conserving valuable die area.\n\n**FIGURE 5.9** DC analysis of the 741 output stage in standby mode.\n\n**Image Description:**\n- **Q14:** NPN transistor with ports C: VCC, B: V1, E: V5\n- **Q18:** NPN transistor with ports C: V1, B: V1, E: V2\n- **Q19:** NPN transistor with ports C: V1, B: V2, E: V3\n- **Q20:** PNP transistor with ports C: VEE, B: V3, E: V6\n- **Q22:** PNP transistor with ports C: VEE, B: GND, E: V3\n- **R6:** Resistor, 27 Ω, ports N1: V5, N2: V4\n- **R7:** Resistor, 22 Ω, ports N1: V4, N2: V6\n- **R10:** Resistor, 50 kΩ, ports N1: V2, N2: GND\n- **I3:** Current Source, 176 μA, ports Np: VCC, Nn: V1\n\n**Extra Info:** This circuit represents a DC analysis of the 741 output stage in standby mode, featuring NPN and PNP transistors, resistors, and a current source. The analysis involves estimating collector currents and voltages at various nodes to understand the circuit's behavior under standby conditions.\n\nIn the circuit of Fig. 5.9, let $I_{s 18}=I_{s 19}=2 \\mathrm{fA}$ and $I_{s 14}=I_{s 20}=8 \\mathrm{fA}$ (four times larger). Assume negligible base currents for all BJTs where appropriate.\n(a) Use iterative methods to estimate the collector currents $I_{C 18}$ and $I_{C 19}$. Then, determine $V_{B B}$ in millivolts.\n(b) Estimate $I_{C 14}$ and $I_{C 20}$ under the simplifying assumption $R_{6}=R_{7}=0$.\n(c) Repeat part (b) with $R_{6}$ and $R_{7}$ in place as shown. Comment on your findings.\n\n#### Solution\n\n(a) Begin with $V_{B E 19}=0.7 \\mathrm{~V}$, so $I_{C 18} \\approx V_{B E 19} / R_{10} \\approx 0.7 / 50 = 14 \\mu \\mathrm{~A}$. By KCL, $I_{C 19} = I_{3} - I_{C 18} \\approx 176 - 14 = 162 \\mu \\mathrm{~A}$. Using the BJT equation, $V_{B E 19} = V_{T} \\ln (I_{C 19} / I_{s 19}) = 0.026 \\ln [(162 \\times 10^{-6}) / (2 \\times 10^{-15})] = 0.653 \\mathrm{~V}$. Using this value for a refined estimate, $I_{C 18} \\approx 0.653 / 50 \\approx 13 \\mu \\mathrm{~A}$. Allowing for about $1 \\mu \\mathrm{~A}$ of base current for $Q_{19}$, we obtain:\n\n$$\n\\begin{equation*}\nI_{C 18} \\approx 14 \\mu \\mathrm{~A} \\quad I_{C 19} \\approx 162 \\mu \\mathrm{~A} \\tag{5.15}\n\\end{equation*}\n$$\n\nNo further iterations are needed. Applying the BJT equation again with $I_{s 18}=I_{s 19}=2 \\mathrm{fA}$, we get:\n\n$$\nV_{B B} = V_{B E 18} + V_{B E 19} = 589.4 + 653.1 \\approx 1242 \\mathrm{mV}\n$$\n\n(b) In standby, $I_{C 14} = I_{C 20}$. With $I_{s 14} = I_{s 20}$, we also have $V_{B E 14} = V_{E B 20} = V_{B B} / 2$, so:\n\n$$\nI_{C 14} = I_{C 20} = 8 \\times 10^{-15} \\exp (1242 / 52) \\approx 190 \\mu \\mathrm{~A}\n$$\n\nDespite being large-area devices, $Q_{14}$ and $Q_{20}$ conduct a standby current comparable to $I_{3}$.\n(c) With $R_{6}$ and $R_{7}$ in place, the voltage drop across the combined junctions of $Q_{14}$ and $Q_{20}$ decreases by $\\Delta V = (R_{6} + R_{7}) I_{Q}$, where $I_{Q}$ is the new quiescent current of $Q_{14}$ and $Q_{20}$. Using $190 \\mu \\mathrm{~A}$ as an initial estimate for $I_{Q}$, we find $\\Delta V = (27 + 22) 190 \\times 10^{-6} \\approx 9.3 \\mathrm{mV}$, so:\n\n$$\n\\begin{equation*}\nI_{Q} = 8 \\times 10^{-15} \\exp [(1242 - 9.3) / 52] \\approx 160 \\mu \\mathrm{~A} \\tag{5.16}\n\\end{equation*}\n$$\n\nThis is lower than the previous estimate due to the voltage drop across $R_{6}$ and $R_{7}$.\n\nIn practical applications, the output stage is rarely in standby. For a more realistic AC analysis, consider a typical scenario with a $2-\\mathrm{k} \\Omega$ load driven by a voltage centered at $V_{O} = 5 \\mathrm{~V}$. Under these conditions, the lower half of the push-pull stage will be off, leaving $Q_{14}$ to source the current $I_{L} = 5 / 2 = 2.5 \\mathrm{~mA}$ to the load. The AC equivalent of the output stage simplifies as shown in Fig. 5.10a, where $Q_{13 B}$ is modeled with the resistance $r_{o 13 B} = (50 \\mathrm{~V}) / (176 \\mu \\mathrm{~A}) = 284 \\mathrm{k} \\Omega$, and the biasing network composed of $Q_{18}$, $Q_{19}$, and $R_{10}$ is represented by a single small-signal resistance $r_{b b} \\approx 174 \\Omega$ (see Exercise 5.1).\n\n**FIGURE 5.10 (a)** Circuit for the AC analysis of the output stage, and **(b)** output-stage small-signal equivalent.\n\n#### Exercise 5.1\n\nDraw the small-signal equivalent of the biasing network in Fig. 5.9, consisting of $Q_{18}$, $Q_{19}$, and $R_{10}$, and demonstrate that the entire network acts as a single resistance:\n\n$$\n\\begin{equation*}\nr_{b b} = \\frac{r_{d 18} + (R_{10} // r_{\\pi 19})}{1 + g_{m 19} (R_{10} // r_{\\pi 19})} \\approx 174 \\Omega \\tag{5.17}\n\\end{equation*}\n$$\n\nwhere $r_{d 18} = V_{T} / I_{C 18}$ is the AC resistance of diode-connected $Q_{18}$, and $g_{m 19} = I_{C 19} / V_{T}$ and $r_{\\pi 19} = \\beta_{019} / g_{m 19}$ are the small-signal parameters of $Q_{19}$. Assume the currents from Example 5.1 and $\\beta_{019} = 200$.\n\nTo determine the small-signal characteristics of the output stage, refer to Fig. 5.10a. Considering the two voltage-followers coupled via the small resistance $r_{b b}$, we can approximate:\n\n$$\n\\begin{equation*}\nv_{o} \\approx 1 \\times v_{i 3} \\tag{5.18}\n\\end{equation*}\n$$\n\nBy inspection, we also have:\n\n$$\n\\begin{equation*}\nR_{i 3} = r_{\\pi 22} + (\\beta_{022} + 1) [r_{b b} + (r_{o 13 B} // R_{b 14})] \\tag{5.19a}\n\\end{equation*}\n$$\n\nwhere $R_{b 14}$ is the AC resistance seen looking into the base of $Q_{14}$:\n\n$$\nR_{b 14} = r_{\\pi 14} + (\\beta_{014} + 1) (R_{6} + R_{L})\n$$\n\nAssuming $I_{C 14} = 2.5 \\mathrm{~mA}$ and $\\beta_{014} = 250$, we get $R_{b 14} \\approx 511 \\mathrm{k} \\Omega$. Substituting into Eq. (5.19a) and assuming $\\beta_{022} = 50$, we obtain:\n\n$$\n\\begin{equation*}\nR_{i 3} = 9.33 \\mathrm{M} \\Omega \\tag{5.19b}\n\\end{equation*}\n$$\n\nUsing inspection again, we write:\n\n$$\n\\begin{equation*}\nR_{o} = R_{6} + \\frac{R_{B 14} + r_{\\pi 14}}{\\beta_{014} + 1} \\tag{5.20a}\n\\end{equation*}\n$$\n\nwhere $R_{B 14}$ is the AC resistance presented to $Q_{14}$'s base by the upstream circuitry:\n\n$$\nR_{B 14} = r_{o 13 B} // (r_{b b} + R_{e 22})\n$$\n\nand $R_{e 22}$ is the AC resistance seen looking into $Q_{22}$'s emitter:\n\n$$\nR_{e 22} = \\frac{R_{o 2} + r_{\\pi 22}}{\\beta_{022} + 1} = \\frac{81.3 + 50(26 / 0.176)}{50 + 1} = 1.74 \\mathrm{k} \\Omega\n$$\n\nSubstituting gives $R_{B 14} = 1.9 \\mathrm{k} \\Omega$. Substituting in turn into Eq. (5.20a), we finally get:\n\n$$\n\\begin{equation*}\nR_{o} = 47 \\Omega \\tag{5.20b}\n\\end{equation*}\n$$\n\nThe small-signal characteristics of the output stage are summarized in Fig. 5.10b. Before concluding this stage, we investigate an additional characteristic that users need to be aware of, as reported in the data sheets.\n\n- **Output Voltage Swing (OVS):** This is the range of output voltages $v_{O}$ over which the output stage operates correctly, with all active BJTs in the forward-active region or at most at the edge of saturation (EOS). A simple inspection of Fig. 5.1 reveals that the upper limit for $v_{O}$ is reached when $Q_{13 B}$ is driven to EOS, and the lower limit when $Q_{17}$ is driven to EOS. Using KVL, we write $v_{O(\\max)} \\cong V_{CC} - V_{EC 13(\\mathrm{EOS})} - V_{BE 14(\\mathrm{on})}$ and $v_{O(\\min)} \\cong V_{EE} + V_{CE 17(\\mathrm{EOS})} + V_{EB 22(\\mathrm{on})} + V_{EB 20(\\mathrm{on})}$. These simplify to:\n\n$$\n\\begin{equation*}\nv_{O(\\max)} \\cong V_{CC} - V_{EC(\\mathrm{EOS})} - V_{BE(\\mathrm{on})} \\quad v_{O(\\min)} \\cong V_{EE} + V_{CE(\\mathrm{EOS})} + 2 V_{EB(\\mathrm{on})} \\tag{5.21}\n\\end{equation*}\n$$\n\n(The above estimates assume identical junction voltage drops for the BJTs and light output loading, so voltage drops across $R_{6}$ and $R_{7}$ are negligible.) For instance, assuming junction drops of 0.7 V and EOS drops of 0.2 V, the estimates give $v_{O(\\max)} \\cong V_{CC} - 0.9 \\mathrm{~V}$ and $v_{O(\\min)} \\cong V_{EE} + 1.6 \\mathrm{~V}$. With $\\pm 15-\\mathrm{V}$ supplies, the OVS is thus $-13.4 \\mathrm{~V} \\leq v_{O} \\leq +14.1 \\mathrm{~V}$."
},
{
    "text": "The output stage of the 741 operational amplifier incorporates several intriguing design strategies, best understood by analyzing the circuit in its standby condition. This state is depicted in Fig. 5.9, illustrating the scenario where the input is at 0 V and no output load is present. The biasing transistors $Q_{18}$ and $Q_{19}$ are of minimal size, whereas the push-pull transistors $Q_{14}$ and $Q_{20}$ are constructed with larger emitter areas (typically four times larger) to ensure adequate current gains even at high load currents. If $Q_{14}$ and $Q_{19}$ were connected as diodes, as described in Section 4.10, $Q_{14}$ and $Q_{20}$ would draw a standby current approximately four times that of the diodes. To reduce this current to a more manageable level, $Q_{18}$ is deliberately underbiased, as the following example will elucidate. Additionally, it is noteworthy that $Q_{18}$ and $Q_{19}$, which share the same collector, are fabricated within the same isolation region, thereby conserving valuable die area.\n\n**FIGURE 5.9** Dc analysis of the 741 output stage in standby.\n\n**Image Description:**\n- **Q14:** NPN, Ports: {C: VCC, B: V1, E: V5}\n- **Q18:** NPN, Ports: {C: V1, B: V1, E: V2}\n- **Q19:** NPN, Ports: {C: V1, B: V2, E: V3}\n- **Q20:** PNP, Ports: {C: VEE, B: V3, E: V6}\n- **Q22:** PNP, Ports: {C: VEE, B: GND, E: V3}\n- **R6:** Resistor, 27 Ω, Ports: {N1: V5, N2: V4}\n- **R7:** Resistor, 22 Ω, Ports: {N1: V4, N2: V6}\n- **R10:** Resistor, 50 kΩ, Ports: {N1: V2, N2: GND}\n- **I3:** Current Source, 176 μA, Ports: {Np: VCC, Nn: V1}\n\n**Extra Info:** This circuit represents a DC analysis of the 741 output stage in standby mode, featuring NPN and PNP transistors, resistors, and a current source. The analysis involves estimating collector currents and voltages at various nodes to comprehend the circuit's behavior under standby conditions.\n\nIn the circuit shown in Fig. 5.9, let $I_{s 18}=I_{s 19}=2 \\mathrm{fA}$ and $I_{s 14}=I_{s 20}=8 \\mathrm{fA}$ (four times larger). Whenever applicable, assume negligible base currents for all BJTs.\n(a) Use iterative methods to estimate the collector currents $I_{C 18}$ and $I_{C 19}$. Consequently, determine $V_{B B}$ in mV.\n(b) Estimate $I_{C 14}$ and $I_{C 20}$ under the simplifying assumption $R_{6}=R_{7}=0$.\n(c) Repeat part (b), but with $R_{6}$ and $R_{7}$ included as shown. Comment on your findings.\n\n#### Solution\n\n(a) Begin with $V_{B E 19}=0.7 \\mathrm{~V}$, thus $I_{C 18} \\approx V_{B E 19} / R_{10} \\approx 0.7 / 50 = 14 \\mu \\mathrm{~A}$. By KCL, $I_{C 19}=I_{3}-I_{C 18} \\approx 176-14 = 162 \\mu \\mathrm{~A}$. Using the BJT equation, $V_{B E 19} = V_{T} \\ln (I_{C 19} / I_{s 19}) = 0.026 \\ln [(162 \\times 10^{-6}) / (2 \\times 10^{-15})] = 0.653 \\mathrm{~V}$. Utilize this value for a refined estimate $I_{C 18} \\approx 0.653 / 50 \\approx 13 \\mu \\mathrm{~A}$. Allowing for approximately $1 \\mu \\mathrm{~A}$ of base current for $Q_{19}$, we finally obtain:\n\n$$\n\\begin{equation*}\nI_{C 18} \\approx 14 \\mu \\mathrm{~A} \\quad I_{C 19} \\approx 162 \\mu \\mathrm{~A} \\tag{5.15}\n\\end{equation*}\n$$\n\nNo further iterations are necessary. Applying the BJT equation again with $I_{s 18}=I_{s 19}=2 \\mathrm{fA}$, we get:\n\n$$\nV_{B B} = V_{B E 18} + V_{B E 19} = 589.4 + 653.1 \\approx 1242 \\mathrm{mV}\n$$\n\n(b) In standby, $I_{C 14} = I_{C 20}$. Moreover, with $I_{s 14}=I_{s 20}$, we also have $V_{B E 14} = V_{E B 20} = V_{B B} / 2$, so:\n\n$$\nI_{C 14} = I_{C 20} = 8 \\times 10^{-15} \\exp (1242 / 52) \\approx 190 \\mu \\mathrm{~A}\n$$\n\nDespite being large-area devices, $Q_{14}$ and $Q_{20}$ conduct a standby current comparable to $I_{3}$.\n(c) With $R_{6}$ and $R_{7}$ in place, the voltage drop across the combined junctions of $Q_{14}$ and $Q_{20}$ decreases by $\\Delta V = (R_{6} + R_{7}) I_{Q}$, where $I_{Q}$ is the new quiescent current of $Q_{14}$ and $Q_{20}$. Using $190 \\mu \\mathrm{~A}$ as our initial estimate for $I_{Q}$, we find $\\Delta V = (27 + 22) 190 \\times 10^{-6} \\approx 9.3 \\mathrm{mV}$, so:\n\n$$\n\\begin{equation*}\nI_{Q} = 8 \\times 10^{-15} \\exp [(1242 - 9.3) / 52] \\approx 160 \\mu \\mathrm{~A} \\tag{5.16}\n\\end{equation*}\n$$\n\nThis is lower than the previous estimate due to the voltage drop across $R_{6}$ and $R_{7}$.\n\nIn practical applications, the output stage is rarely in standby. For a more realistic AC analysis, consider a typical scenario with a $2-\\mathrm{k} \\Omega$ load driven by a voltage centered at $V_{O} = 5 \\mathrm{~V}$. Under these conditions, the lower half of the push-pull stage will be off, leaving $Q_{14}$ to source the current $I_{L} = 5 / 2 = 2.5 \\mathrm{~mA}$ to the load. The AC equivalent of the output stage simplifies as shown in Fig. 5.10a, where $Q_{13 B}$ is modeled with the resistance $r_{o 13 B} = (50 \\mathrm{~V}) / (176 \\mu \\mathrm{~A}) = 284 \\mathrm{k} \\Omega$, and the biasing network composed of $Q_{18}, Q_{19}$, and $R_{10}$ with a single small-signal resistance $r_{b b} \\approx 174 \\Omega$ (see Exercise 5.1).\n\n**FIGURE 5.10 (a)** Circuit for the AC analysis of the output stage, and **(b)** output-stage small-signal equivalent.\n\n#### Exercise 5.1\n\nDraw the small-signal equivalent of the biasing network in Fig. 5.9, consisting of $Q_{18}, Q_{19}$, and $R_{10}$, and demonstrate that the entire network acts as a single resistance:\n\n$$\n\\begin{equation*}\nr_{b b} = \\frac{r_{d 18} + (R_{10} / / r_{\\pi 19})}{1 + g_{m 19} (R_{10} / / r_{\\pi 19})} \\approx 174 \\Omega \\tag{5.17}\n\\end{equation*}\n$$\n\nwhere $r_{d 18} = V_{T} / I_{C 18}$ is the AC resistance of diode-connected $Q_{18}$, and $g_{m 19} = I_{C 19} / V_{T}$ and $r_{\\pi 19} = \\beta_{019} / g_{m 19}$ are the small-signal parameters of $Q_{19}$. Assume the currents from Example 5.1 and $\\beta_{019} = 200$.\n\nTo determine the small-signal characteristics of the output stage, refer again to Fig. 5.10a. Considering the presence of two voltage-followers coupled via the small resistance $r_{b b}$, we can approximate:\n\n$$\n\\begin{equation*}\nv_{o} \\approx 1 \\times v_{i 3} \\tag{5.18}\n\\end{equation*}\n$$\n\nBy inspection, we also have:\n\n$$\n\\begin{equation*}\nR_{i 3} = r_{\\pi 22} + (\\beta_{022} + 1) [r_{b b} + (r_{o 13 B} / / R_{b 14})] \\tag{5.19a}\n\\end{equation*}\n$$\n\nwhere $R_{b 14}$ is the AC resistance seen looking into the base of $Q_{14}$:\n\n$$\nR_{b 14} = r_{\\pi 14} + (\\beta_{014} + 1) (R_{6} + R_{L})\n$$\n\nAssuming $I_{C 14} = 2.5 \\mathrm{~mA}$ and $\\beta_{014} = 250$, we get $R_{b 14} \\approx 511 \\mathrm{k} \\Omega$. Substituting into Eq. (5.19a) and assuming $\\beta_{022} = 50$, we finally obtain:\n\n$$\n\\begin{equation*}\nR_{i 3} = 9.33 \\mathrm{M} \\Omega \\tag{5.19b}\n\\end{equation*}\n$$\n\nUsing inspection again, we write:\n\n$$\n\\begin{equation*}\nR_{o} = R_{6} + \\frac{R_{B 14} + r_{\\pi 14}}{\\beta_{014} + 1} \\tag{5.20a}\n\\end{equation*}\n$$\n\nwhere $R_{B 14}$ is the AC resistance presented to $Q_{14}$'s base by the upstream circuitry:\n\n$$\nR_{B 14} = r_{o 13 B} / / (r_{b b} + R_{e 22})\n$$\n\nand $R_{e 22}$ is the AC resistance seen looking into $Q_{22}$'s emitter:\n\n$$\nR_{e 22} = \\frac{R_{o 2} + r_{\\pi 22}}{\\beta_{022} + 1} = \\frac{81.3 + 50(26 / 0.176)}{50 + 1} = 1.74 \\mathrm{k} \\Omega\n$$\n\nSubstituting gives $R_{B 14} = 1.9 \\mathrm{k} \\Omega$. Substituting in turn into Eq. (5.20a), we finally get:\n\n$$\n\\begin{equation*}\nR_{o} = 47 \\Omega \\tag{5.20b}\n\\end{equation*}\n$$\n\nThe small-signal characteristics of the output stage are summarized in Fig. 5.10b. Before concluding this stage, we investigate one additional characteristic that the user needs to know, which is reported in the data sheets.\n\n- **Output Voltage Swing (OVS):** This is the range of $v_{O}$ values over which the output stage operates properly, with all active BJTs in the forward-active region or at most at the edge of saturation (EOS). A simple inspection of Fig. 5.1 reveals that the upper limit for $v_{O}$ is reached when $Q_{13 B}$ is driven to EOS, and the lower limit when $Q_{17}$ is driven to EOS. Using KVL, we write $v_{O(\\max)} \\cong V_{CC} - V_{EC 13(\\mathrm{EOS})} - V_{BE 14(\\mathrm{on})}$ and $v_{O(\\min)} \\cong V_{EE} + V_{CE 17(\\mathrm{EOS})} + V_{\\text{EB22(on)}} + V_{\\text{EB20(on)}}$. These simplify to:\n\n$$\n\\begin{equation*}\nv_{O(\\max)} \\cong V_{CC} - V_{EC(\\mathrm{EOS})} - V_{BE(\\mathrm{on})} \\quad v_{O(\\min)} \\cong V_{EE} + V_{CE(\\mathrm{EOS})} + 2 V_{EB(\\mathrm{on})} \\tag{5.21}\n\\end{equation*}\n$$\n\n(The above estimates assume identical junction voltage drops for the BJTs, along with light output loading so that the voltage drops across $R_{6}$ and $R_{7}$ can be ignored.) To illustrate, if we assume junction drops of 0.7 V and EOS drops of 0.2 V, the above estimates give $v_{O(\\max)} \\cong V_{CC} - 0.9 \\mathrm{~V}$ and $v_{O(\\min)} \\cong V_{EE} + 1.6 \\mathrm{~V}$. With $\\pm 15-\\mathrm{V}$ supplies, the OVS is thus $-13.4 \\mathrm{~V} \\leq v_{O} \\leq +14.1 \\mathrm{~V}$."
},
{
    "text": "The output stage of the 741 op amp incorporates intriguing design solutions that are best understood by examining the circuit in its standby state, as depicted in Fig. 5.9, where the input is at 0 V and no output load is present. The biasing transistors $Q_{18}$ and $Q_{19}$ are of minimal size, whereas the push-pull transistors $Q_{14}$ and $Q_{20}$ are designed with larger emitter areas (typically four times larger) to ensure good current gains even at high load currents. If $Q_{14}$ and $Q_{19}$ were connected as diodes, as described in Section 4.10, $Q_{14}$ and $Q_{20}$ would draw a standby current approximately four times that of the diodes. To reduce this current to a more manageable level, $Q_{18}$ is deliberately underbiased, as the following example will illustrate. Additionally, since $Q_{18}$ and $Q_{19}$ share the same collector, they are fabricated within the same isolation region, thereby conserving valuable die area.\n\nimage_name:FIGURE 5.9\ndescription:\n[\nname: Q14, type: NPN, ports: {C: VCC, B: V1, E: V5}\nname: Q18, type: NPN, ports: {C: V1, B: V1, E: V2}\nname: Q19, type: NPN, ports: {C: V1, B: V2, E: V3}\nname: Q20, type: PNP, ports: {C: VEE, B: V3, E: V6}\nname: Q22, type: PNP, ports: {C: VEE, B: GND, E: V3}\nname: R6, type: Resistor, value: 27 Ω, ports: {N1: V5, N2: V4}\nname: R7, type: Resistor, value: 22 Ω, ports: {N1: V4, N2: V6}\nname: R10, type: Resistor, value: 50 kΩ, ports: {N1: V2, N2: GND}\nname: I3, type: CurrentSource, value: 176 μA, ports: {Np: VCC, Nn: V1}\n]\nextrainfo:This circuit represents a DC analysis of the 741 output stage in standby mode, featuring NPN and PNP transistors, resistors, and a current source. The analysis involves estimating collector currents and voltages at various nodes to understand the circuit's behavior under standby conditions.\n\nFIGURE 5.9 DC analysis of the 741 output stage in standby.\n\nIn the circuit shown in Fig. 5.9, let $I_{s 18}=I_{s 19}=2 \\mathrm{fA}$ and $I_{s 14}=I_{s 20}=8 \\mathrm{fA}$ (four times larger). Assume negligible base currents for all BJTs where appropriate.\n(a) Use iterative methods to estimate the collector currents $I_{C 18}$ and $I_{C 19}$. Then, determine $V_{B B}$ in mV.\n(b) Estimate $I_{C 14}$ and $I_{C 20}$ under the simplifying assumption $R_{6}=R_{7}=0$.\n(c) Repeat part (b) with $R_{6}$ and $R_{7}$ in place as shown. Comment on your findings.\n\n#### Solution\n\n(a) Begin with $V_{B E 19}=0.7 \\mathrm{~V}$, so $I_{C 18} \\approx V_{B E 19} / R_{10} \\approx 0.7 / 50 = 14 \\mu \\mathrm{~A}$. By KCL, $I_{C 19}=I_{3}-I_{C 18} \\approx 176-14 = 162 \\mu \\mathrm{~A}$. Using the BJT equation, $V_{B E 19} = V_{T} \\ln (I_{C 19} / I_{s 19}) = 0.026 \\ln [(162 \\times 10^{-6}) / (2 \\times 10^{-15})] = 0.653 \\mathrm{~V}$. Use this value for the refined estimate $I_{C 18} \\approx 0.653 / 50 \\approx 13 \\mu \\mathrm{~A}$. Allowing for about $1 \\mu \\mathrm{~A}$ of base current for $Q_{19}$, we finally get\n\n$$\n\\begin{equation*}\nI_{C 18} \\approx 14 \\mu \\mathrm{~A} \\quad I_{C 19} \\approx 162 \\mu \\mathrm{~A} \\tag{5.15}\n\\end{equation*}\n$$\n\nNo further iterations are needed. Applying the BJT equation again with $I_{s 18}=I_{s 19}=2 \\mathrm{fA}$, we obtain\n\n$$\nV_{B B}=V_{B E 18}+V_{B E 19}=589.4+653.1 \\approx 1242 \\mathrm{mV}\n$$\n\n(b) In standby, $I_{C 14}=I_{C 20}$. With $I_{s 14}=I_{s 20}$, we also have $V_{B E 14}=V_{E B 20}=V_{B B} / 2$, so\n\n$$\nI_{C 14}=I_{C 20}=8 \\times 10^{-15} \\exp (1242 / 52) \\approx 190 \\mu \\mathrm{~A}\n$$\n\nDespite being large-area devices, $Q_{14}$ and $Q_{20}$ conduct a standby current comparable to $I_{3}$.\n(c) With $R_{6}$ and $R_{7}$ in place, the voltage drop across the combined junctions of $Q_{14}$ and $Q_{20}$ decreases by $\\Delta V=(R_{6}+R_{7}) I_{Q}$, where $I_{Q}$ is the new quiescent current of $Q_{14}$ and $Q_{20}$. Using $190 \\mu \\mathrm{~A}$ as our initial estimate for $I_{Q}$, we find $\\Delta V=(27+22) 190 \\times 10^{-6} \\approx 9.3 \\mathrm{mV}$, so\n\n$$\n\\begin{equation*}\nI_{Q}=8 \\times 10^{-15} \\exp [(1242-9.3) / 52] \\approx 160 \\mu \\mathrm{~A} \\tag{5.16}\n\\end{equation*}\n$$\n\nThis is lower than the previous estimate due to the voltage drop across $R_{6}$ and $R_{7}$.\n\nIn practical applications, the output stage is rarely in standby. For a more realistic AC analysis, consider a typical scenario with a $2-\\mathrm{k} \\Omega$ load driven by a voltage centered at $V_{O}=5 \\mathrm{~V}$. Under these conditions, the lower half of the push-pull stage will be off, leaving $Q_{14}$ to source the current $I_{L}=5 / 2=2.5 \\mathrm{~mA}$ to the load. The AC equivalent of the output stage simplifies as shown in Fig. 5.10a, where $Q_{13 B}$ is modeled with the resistance $r_{o 13 B}=(50 \\mathrm{~V}) / (176 \\mu \\mathrm{~A})=284 \\mathrm{k} \\Omega$, and the biasing network consisting of $Q_{18}, Q_{19}$, and $R_{10}$ is represented by a single small-signal resistance $r_{b b} \\approx 174 \\Omega$ (see Exercise 5.1).\n\nimage_name:(a)\ndescription:\n[\nname: Q22, type: PNP, ports: {C: GND, B: vi3, E: ve22}\nname: Q14, type: NPN, ports: {C: GND, B: v1, E: v2}\nname: Ro13B, type: Resistor, value: 284kΩ, ports: {N1: GND, N2: v1}\nname: Rbb, type: Resistor, value: 174Ω, ports: {N1: v1, N2: ve22}\nname: R02, type: Resistor, value: 81.3kΩ, ports: {N1: vi3, N2: GND}\nname: R6, type: Resistor, value: 27kΩ, ports: {N1: v2, N2: vo}\nname: RL, type: Resistor, value: 2kΩ, ports: {N1: vo, N2: GND}\n]\nextrainfo:The circuit is an AC analysis model of an output stage, featuring a push-pull amplifier configuration with transistors Q22 and Q14, resistors for biasing and load, and models for small-signal analysis. The circuit is designed to analyze the behavior of the output stage under AC conditions.\n\nimage_name:(b)\ndescription:\n[\nname: Ri3, type: Resistor, value: 9.33MΩ, ports: {N1: Vi3, N2: GND}\nname: Ro, type: Resistor, value: 47Ω, ports: {N1: Vi3, N2: Vo}\nname: vi3, type: VoltageControlledCurrentSource, value: vi3, ports: {Np: Vi3, Nn: GND}\n]\nextrainfo:The circuit is an AC equivalent output stage with a push-pull configuration. Q14 sources current to the load, while Q22 is part of the biasing network. The circuit includes a feedback loop with resistors and a small-signal equivalent for AC analysis.\n\nFIGURE 5.10 (a) Circuit for the AC analysis of the output stage, and (b) output-stage small-signal equivalent.\n\n#### Exercise 5.1\n\nDraw the small-signal equivalent of the biasing network in Fig. 5.9, consisting of $Q_{18}, Q_{19}$, and $R_{10}$, and demonstrate that the entire network acts as a single resistance\n\n$$\n\\begin{equation*}\nr_{b b}=\\frac{r_{d 18}+\\left(R_{10} / / r_{\\pi 19}\\right)}{1+g_{m 19}\\left(R_{10} / / r_{\\pi 19}\\right)} \\approx 174 \\Omega \\tag{5.17}\n\\end{equation*}\n$$\n\nwhere $r_{d 18}=V_{T} / I_{C 18}$ is the AC resistance of diode-connected $Q_{18}$, and $g_{m 19}=I_{C 19} / V_{T}$ and $r_{\\pi 19}=\\beta_{019} / g_{m 19}$ are the small-signal parameters of $Q_{19}$. Assume the currents from Example 5.1 and $\\beta_{019}=200$.\n\nTo determine the small-signal characteristics of the output stage, refer again to Fig. 5.10a. Considering the presence of two voltage-followers coupled via the small resistance $r_{b b}$, we can approximate\n\n$$\n\\begin{equation*}\nv_{o} \\approx 1 \\times v_{i 3} \\tag{5.18}\n\\end{equation*}\n$$\n\nBy inspection, we also have\n\n$$\n\\begin{equation*}\nR_{i 3}=r_{\\pi 22}+\\left(\\beta_{022}+1\\right)\\left[r_{b b}+\\left(r_{o 13 B} / / R_{b 14}\\right)\\right] \\tag{5.19a}\n\\end{equation*}\n$$\n\nwhere $R_{b 14}$ is the AC resistance seen looking into the base of $Q_{14}$,\n\n$$\nR_{b 14}=r_{\\pi 14}+\\left(\\beta_{014}+1\\right)\\left(R_{6}+R_{L}\\right)\n$$\n\nAssuming $I_{C 14}=2.5 \\mathrm{~mA}$ and $\\beta_{014}=250$, we get $R_{b 14} \\approx 511 \\mathrm{k} \\Omega$. Substituting into Eq. (5.19a) and assuming $\\beta_{022}=50$, we finally obtain\n\n$$\n\\begin{equation*}\nR_{i 3}=9.33 \\mathrm{M} \\Omega \\tag{5.19b}\n\\end{equation*}\n$$\n\nUsing inspection again, we write\n\n$$\n\\begin{equation*}\nR_{o}=R_{6}+\\frac{R_{B 14}+r_{\\pi 14}}{\\beta_{014}+1} \\tag{5.20a}\n\\end{equation*}\n$$\n\nwhere $R_{B 14}$ is the AC resistance presented to $Q_{14}$'s base by the upstream circuitry,\n\n$$\nR_{B 14}=r_{o 13 B} / /\\left(r_{b b}+R_{e 22}\\right)\n$$\n\nand $R_{e 22}$ is the AC resistance seen looking into $Q_{22}$'s emitter,\n\n$$\nR_{e 22}=\\frac{R_{o 2}+r_{\\pi 22}}{\\beta_{022}+1}=\\frac{81.3+50(26 / 0.176)}{50+1}=1.74 \\mathrm{k} \\Omega\n$$\n\nSubstituting gives $R_{B 14}=1.9 \\mathrm{k} \\Omega$. Substituting in turn into Eq. (5.20a) we finally get\n\n$$\n\\begin{equation*}\nR_{o}=47 \\Omega \\tag{5.20b}\n\\end{equation*}\n$$\n\nThe small-signal characteristics of the output stage are summarized in Fig. 5.10b. Before concluding this stage, we wish to investigate one additional characteristic that the user needs to be aware of, as reported in the data sheets.\n\n- Output Voltage Swing (OVS). This is the range of $v_{O}$ values over which the output stage operates correctly, with all active BJTs in the forward-active region or at most at the edge of saturation (EOS). A simple inspection of Fig. 5.1 reveals that the upper limit for $v_{O}$ is reached when $Q_{13 B}$ is driven to EOS, and the lower limit when $Q_{17}$ is driven to EOS. Using KVL, we write $v_{O(\\max )} \\cong V_{C C}-V_{E C 13(\\mathrm{EOS})}-V_{B E 14(\\mathrm{on})}$ and $v_{O(\\min )} \\cong V_{E E}+V_{C E 17(\\mathrm{EOS})}+$ $V_{\\text {EB22(on) }}+V_{\\text {EB20(on) }}$. These simplify to\n\n$$\n\\begin{equation*}\nv_{O(\\max )} \\cong V_{C C}-V_{E C(\\mathrm{EOS})}-V_{B E(\\mathrm{on})} \\quad v_{O(\\min )} \\cong V_{E E}+V_{C E(\\mathrm{EOS})}+2 V_{E B(\\mathrm{on})} \\tag{5.21}\n\\end{equation*}\n$$\n\n(The above estimates assume identical junction voltage drops for the BJTs and light output loading, so voltage drops across $R_{6}$ and $R_{7}$ can be ignored.) Assuming junction drops of 0.7 V and EOS drops of 0.2 V, the estimates give $v_{O(\\max )} \\cong V_{C C}-0.9 \\mathrm{~V}$ and $v_{O(\\min )} \\cong V_{E E}+1.6 \\mathrm{~V}$. With $\\pm 15-\\mathrm{V}$ supplies, the OVS is thus $-13.4 \\mathrm{~V} \\leq v_{O} \\leq +14.1 \\mathrm{~V}$."
},
{
    "text": "The output stage of the 741 operational amplifier incorporates several intriguing design strategies that are best understood by examining the circuit in its standby condition. This state is depicted in Fig. 5.9, specifically for an input voltage of 0 V and in the absence of any load at the output. The biasing transistors, $Q_{18}$ and $Q_{19}$, are designed with minimal size, whereas the push-pull transistors, $Q_{14}$ and $Q_{20}$, are constructed with larger emitter areas (typically four times larger) to maintain effective current gains even at high load currents. If $Q_{14}$ and $Q_{19}$ were connected in a diode-like manner as described in Section 4.10, $Q_{14}$ and $Q_{20}$ would draw a standby current approximately four times that of the diodes. To reduce this current to a more manageable level, $Q_{18}$ is deliberately underbiased, as the following example will illustrate. It is also noteworthy that $Q_{18}$ and $Q_{19}$, which share the same collector, are fabricated within the same isolation region, thereby conserving valuable die area.\n\n**FIGURE 5.9** DC analysis of the 741 output stage in standby mode.\n\n**Image Description:**\n- **Q14**: NPN transistor with ports {C: VCC, B: V1, E: V5}\n- **Q18**: NPN transistor with ports {C: V1, B: V1, E: V2}\n- **Q19**: NPN transistor with ports {C: V1, B: V2, E: V3}\n- **Q20**: PNP transistor with ports {C: VEE, B: V3, E: V6}\n- **Q22**: PNP transistor with ports {C: VEE, B: GND, E: V3}\n- **R6**: Resistor, 27 Ω, ports {N1: V5, N2: V4}\n- **R7**: Resistor, 22 Ω, ports {N1: V4, N2: V6}\n- **R10**: Resistor, 50 kΩ, ports {N1: V2, N2: GND}\n- **I3**: Current source, 176 μA, ports {Np: VCC, Nn: V1}\n\n**Extra Info:** This circuit represents a DC analysis of the 741 output stage in standby mode, featuring NPN and PNP transistors, resistors, and a current source. The analysis involves estimating collector currents and voltages at various nodes to understand the circuit's behavior under standby conditions.\n\nIn the circuit of Fig. 5.9, let $I_{s 18}=I_{s 19}=2 \\mathrm{fA}$ and $I_{s 14}=I_{s 20}=8 \\mathrm{fA}$ (four times larger). Additionally, assume negligible base currents for all BJTs where appropriate.\n(a) Use iterative methods to estimate the collector currents $I_{C 18}$ and $I_{C 19}$. Then, determine $V_{B B}$ in millivolts.\n(b) Estimate $I_{C 14}$ and $I_{C 20}$ under the simplifying assumption that $R_{6}=R_{7}=0$.\n(c) Repeat part (b) with $R_{6}$ and $R_{7}$ included as shown. Comment on your findings.\n\n#### Solution\n\n(a) Begin with $V_{B E 19}=0.7 \\mathrm{~V}$, so $I_{C 18} \\approx V_{B E 19} / R_{10} \\approx 0.7 / 50 = 14 \\mu \\mathrm{~A}$. By KCL, $I_{C 19} = I_{3} - I_{C 18} \\approx 176 - 14 = 162 \\mu \\mathrm{~A}$. Using the BJT equation, $V_{B E 19} = V_{T} \\ln (I_{C 19} / I_{s 19}) = 0.026 \\ln [(162 \\times 10^{-6}) / (2 \\times 10^{-15})] = 0.653 \\mathrm{~V}$. Use this value for the refined estimate $I_{C 18} \\approx 0.653 / 50 \\approx 13 \\mu \\mathrm{~A}$. Allowing for about $1 \\mu \\mathrm{~A}$ of base current for $Q_{19}$, we finally get:\n\n$$\n\\begin{equation*}\nI_{C 18} \\approx 14 \\mu \\mathrm{~A} \\quad I_{C 19} \\approx 162 \\mu \\mathrm{~A} \\tag{5.15}\n\\end{equation*}\n$$\n\nNo further iterations are needed. Applying the BJT equation again with $I_{s 18}=I_{s 19}=2 \\mathrm{fA}$, we obtain:\n\n$$\nV_{B B} = V_{B E 18} + V_{B E 19} = 589.4 + 653.1 \\approx 1242 \\mathrm{mV}\n$$\n\n(b) In standby, $I_{C 14} = I_{C 20}$. With $I_{s 14} = I_{s 20}$, we also have $V_{B E 14} = V_{E B 20} = V_{B B} / 2$, so:\n\n$$\nI_{C 14} = I_{C 20} = 8 \\times 10^{-15} \\exp (1242 / 52) \\approx 190 \\mu \\mathrm{~A}\n$$\n\nDespite being large-area devices, $Q_{14}$ and $Q_{20}$ conduct a standby current comparable to $I_{3}$.\n(c) With $R_{6}$ and $R_{7}$ in place, the voltage drop across the combined junctions of $Q_{14}$ and $Q_{20}$ decreases by $\\Delta V = (R_{6} + R_{7}) I_{Q}$, where $I_{Q}$ is the new quiescent current of $Q_{14}$ and $Q_{20}$. Using $190 \\mu \\mathrm{~A}$ as our initial estimate for $I_{Q}$, we find $\\Delta V = (27 + 22) 190 \\times 10^{-6} \\approx 9.3 \\mathrm{mV}$, so:\n\n$$\n\\begin{equation*}\nI_{Q} = 8 \\times 10^{-15} \\exp [(1242 - 9.3) / 52] \\approx 160 \\mu \\mathrm{~A} \\tag{5.16}\n\\end{equation*}\n$$\n\nThis is lower than the previous estimate due to the voltage drop across $R_{6}$ and $R_{7}$.\n\nIn practical applications, the output stage is rarely in standby. For a more realistic AC analysis, consider a typical scenario with a $2-\\mathrm{k} \\Omega$ load driven by a voltage centered at $V_{O} = 5 \\mathrm{~V}$. Under these conditions, the lower half of the push-pull stage will be off, leaving $Q_{14}$ to source the current $I_{L} = 5 / 2 = 2.5 \\mathrm{~mA}$ to the load. The AC equivalent of the output stage simplifies as shown in Fig. 5.10a, where $Q_{13 B}$ is modeled with the resistance $r_{o 13 B} = (50 \\mathrm{~V}) / (176 \\mu \\mathrm{~A}) = 284 \\mathrm{k} \\Omega$, and the biasing network composed of $Q_{18}, Q_{19}$, and $R_{10}$ is represented by a single small-signal resistance $r_{b b} \\approx 174 \\Omega$ (see Exercise 5.1).\n\n**FIGURE 5.10 (a)** Circuit for the AC analysis of the output stage, and (b) output-stage small-signal equivalent.\n\n**Image Description (a):**\n- **Q22**: PNP transistor, ports {C: GND, B: vi3, E: ve22}\n- **Q14**: NPN transistor, ports {C: GND, B: v1, E: v2}\n- **Ro13B**: Resistor, 284 kΩ, ports {N1: GND, N2: v1}\n- **Rbb**: Resistor, 174 Ω, ports {N1: v1, N2: ve22}\n- **R02**: Resistor, 81.3 kΩ, ports {N1: vi3, N2: GND}\n- **R6**: Resistor, 27 kΩ, ports {N1: v2, N2: vo}\n- **RL**: Resistor, 2 kΩ, ports {N1: vo, N2: GND}\n\n**Extra Info:** This circuit is an AC analysis model of an output stage, featuring a push-pull amplifier configuration with transistors Q22 and Q14, resistors for biasing and load, and models for small-signal analysis. The circuit is designed to analyze the behavior of the output stage under AC conditions.\n\n**Image Description (b):**\n- **Ri3**: Resistor, 9.33 MΩ, ports {N1: Vi3, N2: GND}\n- **Ro**: Resistor, 47 Ω, ports {N1: Vi3, N2: Vo}\n- **vi3**: Voltage-controlled current source, value: vi3, ports {Np: Vi3, Nn: GND}\n\n**Extra Info:** The circuit is an AC equivalent output stage with a push-pull configuration. Q14 sources current to the load, while Q22 is part of the biasing network. The circuit includes a feedback loop with resistors and a small-signal equivalent for AC analysis.\n\n#### Exercise 5.1\n\nDraw the small-signal equivalent of the biasing network in Fig. 5.9, consisting of $Q_{18}, Q_{19}$, and $R_{10}$, and demonstrate that the entire network acts as a single resistance:\n\n$$\n\\begin{equation*}\nr_{b b} = \\frac{r_{d 18} + (R_{10} / / r_{\\pi 19})}{1 + g_{m 19} (R_{10} / / r_{\\pi 19})} \\approx 174 \\Omega \\tag{5.17}\n\\end{equation*}\n$$\n\nwhere $r_{d 18} = V_{T} / I_{C 18}$ is the AC resistance of diode-connected $Q_{18}$, and $g_{m 19} = I_{C 19} / V_{T}$ and $r_{\\pi 19} = \\beta_{019} / g_{m 19}$ are the small-signal parameters of $Q_{19}$. Assume the currents from Example 5.1 and $\\beta_{019} = 200$.\n\nTo determine the small-signal characteristics of the output stage, refer to Fig. 5.10a. Considering the presence of two voltage-followers coupled via the small resistance $r_{b b}$, we can approximate:\n\n$$\n\\begin{equation*}\nv_{o} \\approx 1 \\times v_{i 3} \\tag{5.18}\n\\end{equation*}\n$$\n\nBy inspection, we also have:\n\n$$\n\\begin{equation*}\nR_{i 3} = r_{\\pi 22} + (\\beta_{022} + 1) [r_{b b} + (r_{o 13 B} / / R_{b 14})] \\tag{5.19a}\n\\end{equation*}\n$$\n\nwhere $R_{b 14}$ is the AC resistance seen looking into the base of $Q_{14}$:\n\n$$\nR_{b 14} = r_{\\pi 14} + (\\beta_{014} + 1) (R_{6} + R_{L})\n$$\n\nAssuming $I_{C 14} = 2.5 \\mathrm{~mA}$ and $\\beta_{014} = 250$, we get $R_{b 14} \\approx 511 \\mathrm{k} \\Omega$. Substituting into Eq. (5.19a) and assuming $\\beta_{022} = 50$, we obtain:\n\n$$\n\\begin{equation*}\nR_{i 3} = 9.33 \\mathrm{M} \\Omega \\tag{5.19b}\n\\end{equation*}\n$$\n\nUsing inspection again, we write:\n\n$$\n\\begin{equation*}\nR_{o} = R_{6} + \\frac{R_{B 14} + r_{\\pi 14}}{\\beta_{014} + 1} \\tag{5.20a}\n\\end{equation*}\n$$\n\nwhere $R_{B 14}$ is the AC resistance presented to $Q_{14}$'s base by the upstream circuitry:\n\n$$\nR_{B 14} = r_{o 13 B} / / (r_{b b} + R_{e 22})\n$$\n\nand $R_{e 22}$ is the AC resistance seen looking into $Q_{22}$'s emitter:\n\n$$\nR_{e 22} = \\frac{R_{o 2} + r_{\\pi 22}}{\\beta_{022} + 1} = \\frac{81.3 + 50(26 / 0.176)}{50 + 1} = 1.74 \\mathrm{k} \\Omega\n$$\n\nSubstituting gives $R_{B 14} = 1.9 \\mathrm{k} \\Omega$. Substituting in turn into Eq. (5.20a) yields:\n\n$$\n\\begin{equation*}\nR_{o} = 47 \\Omega \\tag{5.20b}\n\\end{equation*}\n$$\n\nThe small-signal characteristics of the output stage are summarized in Fig. 5.10b. Before concluding this stage, we investigate one additional characteristic that users need to be aware of, as reported in the data sheets.\n\n- **Output Voltage Swing (OVS)**: This is the range of output voltages $v_{O}$ over which the output stage operates correctly, with all active BJTs in the forward-active region or at most at the edge of saturation (EOS). A simple inspection of Fig. 5.1 reveals that the upper limit for $v_{O}$ is reached when $Q_{13 B}$ is driven to EOS, and the lower limit when $Q_{17}$ is driven to EOS. Using KVL, we write:\n\n$$\nv_{O(\\max )} \\cong V_{C C} - V_{E C 13(\\mathrm{EOS})} - V_{B E 14(\\mathrm{on})} \\quad v_{O(\\min )} \\cong V_{E E} + V_{C E 17(\\mathrm{EOS})} + V_{\\text {EB22(on) }} + V_{\\text {EB20(on) }}\n$$\n\nThese simplify to:\n\n$$\n\\begin{equation*}\nv_{O(\\max )} \\cong V_{C C} - V_{E C(\\mathrm{EOS})} - V_{B E(\\mathrm{on})} \\quad v_{O(\\min )} \\cong V_{E E} + V_{C E(\\mathrm{EOS})} + 2 V_{E B(\\mathrm{on})} \\tag{5.21}\n\\end{equation*}\n$$\n\n(The above estimates assume identical junction voltage drops for the BJTs and light output loading, allowing us to ignore voltage drops across $R_{6}$ and $R_{7}$.) For instance, assuming junction drops of 0.7 V and EOS drops of 0.2 V, the estimates yield $v_{O(\\max )} \\cong V_{C C} - 0.9 \\mathrm{~V}$ and $v_{O(\\min )} \\cong V_{E E} + 1.6 \\mathrm{~V}$. With $\\pm 15-\\mathrm{V}$ supplies, the OVS is thus $-13.4 \\mathrm{~V} \\leq v_{O} \\leq +14.1 \\mathrm{~V}$."
},
{
    "text": "The output stage of the 741 operational amplifier incorporates several intriguing design strategies, best understood by examining the circuit in its standby condition. This state is depicted in Fig. 5.9, assuming the input is at 0 V and there is no output load. The biasing transistors $Q_{18}$ and $Q_{19}$ are of minimal size, whereas the push-pull transistors $Q_{14}$ and $Q_{20}$ are constructed with larger emitter areas (typically four times larger) to maintain adequate current gains even at high load currents. If $Q_{14}$ and $Q_{19}$ were connected as diodes, as described in Section 4.10, $Q_{14}$ and $Q_{20}$ would draw a standby current approximately four times that of the diodes. To reduce this current to a more manageable level, $Q_{18}$ is deliberately underbiased, as the following example will illustrate. It is also noteworthy that $Q_{18}$ and $Q_{19}$, sharing the same collector, are fabricated within the same isolation region, thereby conserving valuable die area.\n\nimage_name:FIGURE 5.9\ndescription:\n[\nname: Q14, type: NPN, ports: {C: VCC, B: V1, E: V5}\nname: Q18, type: NPN, ports: {C: V1, B: V1, E: V2}\nname: Q19, type: NPN, ports: {C: V1, B: V2, E: V3}\nname: Q20, type: PNP, ports: {C: VEE, B: V3, E: V6}\nname: Q22, type: PNP, ports: {C: VEE, B: GND, E: V3}\nname: R6, type: Resistor, value: 27 Ω, ports: {N1: V5, N2: V4}\nname: R7, type: Resistor, value: 22 Ω, ports: {N1: V4, N2: V6}\nname: R10, type: Resistor, value: 50 kΩ, ports: {N1: V2, N2: GND}\nname: I3, type: CurrentSource, value: 176 μA, ports: {Np: VCC, Nn: V1}\n]\nextrainfo:This circuit represents a DC analysis of the 741 output stage in standby mode, featuring NPN and PNP transistors, resistors, and a current source. The analysis involves estimating collector currents and voltages at various nodes to understand the circuit's behavior under standby conditions.\n\nFIGURE 5.9 DC analysis of the 741 output stage in standby.\n\nIn the circuit shown in Fig. 5.9, let $I_{s 18}=I_{s 19}=2 \\mathrm{fA}$ and $I_{s 14}=I_{s 20}=8 \\mathrm{fA}$ (four times larger). Additionally, assume negligible base currents for all BJTs where appropriate.\n(a) Use iterative methods to estimate the collector currents $I_{C 18}$ and $I_{C 19}$. Then, determine $V_{B B}$ in mV.\n(b) Estimate $I_{C 14}$ and $I_{C 20}$ under the simplifying assumption that $R_{6}=R_{7}=0$.\n(c) Repeat part (b), but with $R_{6}$ and $R_{7}$ included as shown. Comment on your findings.\n\n#### Solution\n\n(a) Begin with $V_{B E 19}=0.7 \\mathrm{~V}$, so $I_{C 18} \\approx V_{B E 19} / R_{10} \\approx 0.7 / 50 = 14 \\mu \\mathrm{~A}$. By KCL, $I_{C 19}=I_{3}-I_{C 18} \\approx 176-14 = 162 \\mu \\mathrm{~A}$. Using the BJT equation, $V_{B E 19} = V_{T} \\ln (I_{C 19} / I_{s 19}) = 0.026 \\ln [(162 \\times 10^{-6}) / (2 \\times 10^{-15})] = 0.653 \\mathrm{~V}$. Use this value for the refined estimate $I_{C 18} \\approx 0.653 / 50 \\approx 13 \\mu \\mathrm{~A}$. Allowing for about $1 \\mu \\mathrm{~A}$ of base current for $Q_{19}$, we finally obtain\n\n$$\n\\begin{equation*}\nI_{C 18} \\approx 14 \\mu \\mathrm{~A} \\quad I_{C 19} \\approx 162 \\mu \\mathrm{~A} \\tag{5.15}\n\\end{equation*}\n$$\n\nNo further iterations are needed. Applying the BJT equation again with $I_{s 18}=I_{s 19}=2 \\mathrm{fA}$, we get\n\n$$\nV_{B B} = V_{B E 18} + V_{B E 19} = 589.4 + 653.1 \\approx 1242 \\mathrm{mV}\n$$\n\n(b) In standby, $I_{C 14} = I_{C 20}$. With $I_{s 14} = I_{s 20}$, we also have $V_{B E 14} = V_{E B 20} = V_{B B} / 2$, so\n\n$$\nI_{C 14} = I_{C 20} = 8 \\times 10^{-15} \\exp (1242 / 52) \\approx 190 \\mu \\mathrm{~A}\n$$\n\nDespite being large-area devices, $Q_{14}$ and $Q_{20}$ conduct a standby current comparable to $I_{3}$.\n(c) With $R_{6}$ and $R_{7}$ in place, the voltage drop across the combined junctions of $Q_{14}$ and $Q_{20}$ decreases by $\\Delta V = (R_{6} + R_{7}) I_{Q}$, where $I_{Q}$ is the new quiescent current of $Q_{14}$ and $Q_{20}$. Using $190 \\mu \\mathrm{~A}$ as our initial estimate for $I_{Q}$, we find $\\Delta V = (27 + 22) 190 \\times 10^{-6} \\approx 9.3 \\mathrm{mV}$, so we get\n\n$$\n\\begin{equation*}\nI_{Q} = 8 \\times 10^{-15} \\exp [(1242 - 9.3) / 52] \\approx 160 \\mu \\mathrm{~A} \\tag{5.16}\n\\end{equation*}\n$$\n\nThis is lower than the previous estimate due to the voltage drop across $R_{6}$ and $R_{7}$.\n\nIn practical applications, the output stage is rarely in standby. For a more realistic AC analysis, consider a typical scenario with a $2-\\mathrm{k} \\Omega$ load driven by a voltage centered at $V_{O} = 5 \\mathrm{~V}$. Under these conditions, the lower half of the push-pull stage will be off, leaving $Q_{14}$ to source the current $I_{L} = 5 / 2 = 2.5 \\mathrm{~mA}$ to the load. The AC equivalent of the output stage simplifies as shown in Fig. 5.10a, where $Q_{13 B}$ is modeled with the resistance $r_{o 13 B} = (50 \\mathrm{~V}) / (176 \\mu \\mathrm{~A}) = 284 \\mathrm{k} \\Omega$, and the biasing network consisting of $Q_{18}, Q_{19}$, and $R_{10}$ is represented by a single small-signal resistance $r_{b b} \\approx 174 \\Omega$ (see Exercise 5.1).\n\nimage_name:(a)\ndescription:\n[\nname: Q22, type: PNP, ports: {C: GND, B: vi3, E: ve22}\nname: Q14, type: NPN, ports: {C: GND, B: v1, E: v2}\nname: Ro13B, type: Resistor, value: 284kΩ, ports: {N1: GND, N2: v1}\nname: Rbb, type: Resistor, value: 174Ω, ports: {N1: v1, N2: ve22}\nname: R02, type: Resistor, value: 81.3kΩ, ports: {N1: vi3, N2: GND}\nname: R6, type: Resistor, value: 27kΩ, ports: {N1: v2, N2: vo}\nname: RL, type: Resistor, value: 2kΩ, ports: {N1: vo, N2: GND}\n]\nextrainfo:The circuit is an AC analysis model of an output stage, featuring a push-pull amplifier configuration with transistors Q22 and Q14, resistors for biasing and load, and models for small-signal analysis. The circuit is designed to analyze the behavior of the output stage under AC conditions.\nimage_name:(b)\ndescription:\n[\nname: Ri3, type: Resistor, value: 9.33MΩ, ports: {N1: Vi3, N2: GND}\nname: Ro, type: Resistor, value: 47Ω, ports: {N1: Vi3, N2: Vo}\nname: vi3, type: VoltageControlledCurrentSource, value: vi3, ports: {Np: Vi3, Nn: GND}\n]\nextrainfo:The circuit is an AC equivalent output stage with a push-pull configuration. Q14 sources current to the load, while Q22 is part of the biasing network. The circuit includes a feedback loop with resistors and a small-signal equivalent for AC analysis.\n\nFIGURE 5.10 (a) Circuit for the AC analysis of the output stage, and (b) output-stage small-signal equivalent.\n\n#### Exercise 5.1\n\nDraw the small-signal equivalent of the biasing network in Fig. 5.9, consisting of $Q_{18}, Q_{19}$, and $R_{10}$, and demonstrate that the entire network acts as a single resistance\n\n$$\n\\begin{equation*}\nr_{b b} = \\frac{r_{d 18} + (R_{10} / / r_{\\pi 19})}{1 + g_{m 19} (R_{10} / / r_{\\pi 19})} \\approx 174 \\Omega \\tag{5.17}\n\\end{equation*}\n$$\n\nwhere $r_{d 18} = V_{T} / I_{C 18}$ is the AC resistance of diode-connected $Q_{18}$, and $g_{m 19} = I_{C 19} / V_{T}$ and $r_{\\pi 19} = \\beta_{019} / g_{m 19}$ are the small-signal parameters of $Q_{19}$. Assume the currents from Example 5.1 and $\\beta_{019} = 200$.\n\nTo determine the small-signal characteristics of the output stage, refer again to Fig. 5.10a. Considering the presence of two voltage-followers coupled via the small resistance $r_{b b}$, we can approximate\n\n$$\n\\begin{equation*}\nv_{o} \\approx 1 \\times v_{i 3} \\tag{5.18}\n\\end{equation*}\n$$\n\nBy inspection, we also have\n\n$$\n\\begin{equation*}\nR_{i 3} = r_{\\pi 22} + (\\beta_{022} + 1) [r_{b b} + (r_{o 13 B} / / R_{b 14})] \\tag{5.19a}\n\\end{equation*}\n$$\n\nwhere $R_{b 14}$ is the AC resistance seen looking into the base of $Q_{14}$,\n\n$$\nR_{b 14} = r_{\\pi 14} + (\\beta_{014} + 1) (R_{6} + R_{L})\n$$\n\nAssuming $I_{C 14} = 2.5 \\mathrm{~mA}$ and $\\beta_{014} = 250$, we get $R_{b 14} \\approx 511 \\mathrm{k} \\Omega$. Substituting into Eq. (5.19a) and assuming $\\beta_{022} = 50$, we finally obtain\n\n$$\n\\begin{equation*}\nR_{i 3} = 9.33 \\mathrm{M} \\Omega \\tag{5.19b}\n\\end{equation*}\n$$\n\nUsing inspection again, we write\n\n$$\n\\begin{equation*}\nR_{o} = R_{6} + \\frac{R_{B 14} + r_{\\pi 14}}{\\beta_{014} + 1} \\tag{5.20a}\n\\end{equation*}\n$$\n\nwhere $R_{B 14}$ is the AC resistance presented to $Q_{14}$'s base by the upstream circuitry,\n\n$$\nR_{B 14} = r_{o 13 B} / / (r_{b b} + R_{e 22})\n$$\n\nand $R_{e 22}$ is the AC resistance seen looking into $Q_{22}$'s emitter\n\n$$\nR_{e 22} = \\frac{R_{o 2} + r_{\\pi 22}}{\\beta_{022} + 1} = \\frac{81.3 + 50(26 / 0.176)}{50 + 1} = 1.74 \\mathrm{k} \\Omega\n$$\n\nSubstituting gives $R_{B 14} = 1.9 \\mathrm{k} \\Omega$. Substituting in turn into Eq. (5.20a) we finally get\n\n$$\n\\begin{equation*}\nR_{o} = 47 \\Omega \\tag{5.20b}\n\\end{equation*}\n$$\n\nThe small-signal characteristics of the output stage are summarized in Fig. 5.10b. Before concluding this stage, we wish to investigate one additional characteristic that the user needs to be aware of, as reported in the data sheets.\n\n- Output Voltage Swing (OVS). This is the range of values of $v_{O}$ over which the output stage will operate correctly, with all active BJTs functioning in the forward-active region or at most at the edge of saturation (EOS). A simple inspection of Fig. 5.1 reveals that the upper limit for $v_{O}$ is reached when $Q_{13 B}$ is driven to EOS, and the lower limit when $Q_{17}$ is driven to EOS. Using KVL, we can write $v_{O(\\max )} \\cong V_{C C} - V_{E C 13(\\mathrm{EOS})} - V_{B E 14(\\mathrm{on})}$ and $v_{O(\\min )} \\cong V_{E E} + V_{C E 17(\\mathrm{EOS})} + V_{\\text {EB22(on) }} + V_{\\text {EB20(on) }}$. These simplify to\n\n$$\n\\begin{equation*}\nv_{O(\\max )} \\cong V_{C C} - V_{E C(\\mathrm{EOS})} - V_{B E(\\mathrm{on})} \\quad v_{O(\\min )} \\cong V_{E E} + V_{C E(\\mathrm{EOS})} + 2 V_{E B(\\mathrm{on})} \\tag{5.21}\n\\end{equation*}\n$$\n\n(The above estimates assume identical junction voltage drops for the BJTs, along with light output loading so that the voltage drops across $R_{6}$ and $R_{7}$ can be ignored.) To get an idea, if we assume junction drops of 0.7 V and EOS drops of 0.2 V, the above estimates give $v_{O(\\max )} \\cong V_{C C} - 0.9 \\mathrm{~V}$ and $v_{O(\\min )} \\cong V_{E E} + 1.6 \\mathrm{~V}$. With $\\pm 15-\\mathrm{V}$ supplies, the OVS is thus $-13.4 \\mathrm{~V} \\leq v_{O} \\leq +14.1 \\mathrm{~V}$."
},
{
    "text": "The output stage of the 741 operational amplifier incorporates several intriguing design strategies that are most effectively understood by examining the circuit in its standby condition. This state is depicted in Fig. 5.9, specifically for the scenario where the input is at 0 V and there is no output load present. The biasing transistors, $Q_{18}$ and $Q_{19}$, are of minimal size, whereas the push-pull transistors, $Q_{14}$ and $Q_{20}$, are constructed with larger emitter areas (typically four times larger) to ensure adequate current gains even at high load currents. If $Q_{14}$ and $Q_{19}$ were connected in a diode-like manner as described in Section 4.10, $Q_{14}$ and $Q_{20}$ would draw a standby current approximately four times that of the diodes. To reduce this current to a more manageable level, $Q_{18}$ is deliberately underbiased, as the following example will illustrate. Additionally, it is noteworthy that $Q_{18}$ and $Q_{19}$, which share the same collector, are fabricated within the same isolation region, thereby conserving valuable die area.\n\nimage_name:FIGURE 5.9\ndescription:\n[\nname: Q14, type: NPN, ports: {C: VCC, B: V1, E: V5}\nname: Q18, type: NPN, ports: {C: V1, B: V1, E: V2}\nname: Q19, type: NPN, ports: {C: V1, B: V2, E: V3}\nname: Q20, type: PNP, ports: {C: VEE, B: V3, E: V6}\nname: Q22, type: PNP, ports: {C: VEE, B: GND, E: V3}\nname: R6, type: Resistor, value: 27 Ω, ports: {N1: V5, N2: V4}\nname: R7, type: Resistor, value: 22 Ω, ports: {N1: V4, N2: V6}\nname: R10, type: Resistor, value: 50 kΩ, ports: {N1: V2, N2: GND}\nname: I3, type: CurrentSource, value: 176 μA, ports: {Np: VCC, Nn: V1}\n]\nextrainfo:This circuit represents a DC analysis of the 741 output stage in standby mode, featuring NPN and PNP transistors, resistors, and a current source. The analysis involves estimating collector currents and voltages at various nodes to comprehend the circuit's behavior under standby conditions.\n\nFIGURE 5.9 DC analysis of the 741 output stage in standby.\n\nIn the circuit shown in Fig. 5.9, let $I_{s 18}=I_{s 19}=2 \\mathrm{fA}$ and $I_{s 14}=I_{s 20}=8 \\mathrm{fA}$ (four times larger). Furthermore, assume negligible base currents for all BJTs where appropriate.\n(a) Use iterative methods to estimate the collector currents $I_{C 18}$ and $I_{C 19}$. Then, determine $V_{B B}$ in millivolts.\n(b) Estimate $I_{C 14}$ and $I_{C 20}$ under the simplifying assumption that $R_{6}=R_{7}=0$.\n(c) Repeat part (b), but with $R_{6}$ and $R_{7}$ included as shown. Comment on your findings.\n\n#### Solution\n\n(a) Begin with $V_{B E 19}=0.7 \\mathrm{~V}$, so $I_{C 18} \\approx V_{B E 19} / R_{10} \\approx 0.7 / 50 = 14 \\mu \\mathrm{~A}$. By KCL, $I_{C 19}=I_{3}-I_{C 18} \\approx 176-14 = 162 \\mu \\mathrm{~A}$. Using the BJT equation, $V_{B E 19} = V_{T} \\ln (I_{C 19} / I_{s 19}) = 0.026 \\ln [(162 \\times 10^{-6}) / (2 \\times 10^{-15})] = 0.653 \\mathrm{~V}$. Use this value for the refined estimate $I_{C 18} \\approx 0.653 / 50 \\approx 13 \\mu \\mathrm{~A}$. Allowing for about $1 \\mu \\mathrm{~A}$ of base current for $Q_{19}$, we finally obtain\n\n$$\n\\begin{equation*}\nI_{C 18} \\approx 14 \\mu \\mathrm{~A} \\quad I_{C 19} \\approx 162 \\mu \\mathrm{~A} \\tag{5.15}\n\\end{equation*}\n$$\n\nNo further iterations are needed. Applying the BJT equation again with $I_{s 18}=I_{s 19}=2 \\mathrm{fA}$, we get\n\n$$\nV_{B B}=V_{B E 18}+V_{B E 19}=589.4+653.1 \\approx 1242 \\mathrm{mV}\n$$\n\n(b) In standby, $I_{C 14}=I_{C 20}$. Additionally, with $I_{s 14}=I_{s 20}$, we also have $V_{B E 14}=V_{E B 20}=V_{B B} / 2$, so\n\n$$\nI_{C 14}=I_{C 20}=8 \\times 10^{-15} \\exp (1242 / 52) \\approx 190 \\mu \\mathrm{~A}\n$$\n\nDespite being large-area devices, $Q_{14}$ and $Q_{20}$ conduct a standby current comparable to $I_{3}$.\n(c) With $R_{6}$ and $R_{7}$ in place, the voltage drop across the combined junctions of $Q_{14}$ and $Q_{20}$ will decrease by $\\Delta V=(R_{6}+R_{7}) I_{Q}$, where $I_{Q}$ is the new quiescent current of $Q_{14}$ and $Q_{20}$. Using $190 \\mu \\mathrm{~A}$ as our initial estimate for $I_{Q}$, we find $\\Delta V=(27+22) 190 \\times 10^{-6} \\approx 9.3 \\mathrm{mV}$, so we get\n\n$$\n\\begin{equation*}\nI_{Q}=8 \\times 10^{-15} \\exp [(1242-9.3) / 52] \\approx 160 \\mu \\mathrm{~A} \\tag{5.16}\n\\end{equation*}\n$$\n\nThis is lower than the previous estimate due to the voltage dropped by $R_{6}$ and $R_{7}$.\n\nIn practical applications, the output stage is rarely in standby. For a more realistic AC analysis, consider a typical scenario where a $2-\\mathrm{k} \\Omega$ load is driven by a voltage centered at $V_{O}=5 \\mathrm{~V}$. Under these conditions, the lower half of the push-pull stage will be off, leaving $Q_{14}$ to source the current $I_{L}=5 / 2=2.5 \\mathrm{~mA}$ to the load. The AC equivalent of the output stage simplifies as shown in Fig. 5.10a, where $Q_{13 B}$ is modeled with the resistance $r_{o 13 B}=(50 \\mathrm{~V}) / (176 \\mu \\mathrm{~A})=284 \\mathrm{k} \\Omega$, and the biasing network consisting of $Q_{18}, Q_{19}$, and $R_{10}$ is represented by a single small-signal resistance $r_{b b} \\approx 174 \\Omega$ (see Exercise 5.1).\n\nimage_name:(a)\ndescription:\n[\nname: Q22, type: PNP, ports: {C: GND, B: vi3, E: ve22}\nname: Q14, type: NPN, ports: {C: GND, B: v1, E: v2}\nname: Ro13B, type: Resistor, value: 284kΩ, ports: {N1: GND, N2: v1}\nname: Rbb, type: Resistor, value: 174Ω, ports: {N1: v1, N2: ve22}\nname: R02, type: Resistor, value: 81.3kΩ, ports: {N1: vi3, N2: GND}\nname: R6, type: Resistor, value: 27kΩ, ports: {N1: v2, N2: vo}\nname: RL, type: Resistor, value: 2kΩ, ports: {N1: vo, N2: GND}\n]\nextrainfo:The circuit is an AC analysis model of an output stage, featuring a push-pull amplifier configuration with transistors Q22 and Q14, resistors for biasing and load, and models for small-signal analysis. The circuit is designed to analyze the behavior of the output stage under AC conditions.\nimage_name:(b)\ndescription:\n[\nname: Ri3, type: Resistor, value: 9.33MΩ, ports: {N1: Vi3, N2: GND}\nname: Ro, type: Resistor, value: 47Ω, ports: {N1: Vi3, N2: Vo}\nname: vi3, type: VoltageControlledCurrentSource, value: vi3, ports: {Np: Vi3, Nn: GND}\n]\nextrainfo:The circuit is an AC equivalent output stage with a push-pull configuration. Q14 sources current to the load, while Q22 is part of the biasing network. The circuit includes a feedback loop with resistors and a small-signal equivalent for AC analysis.\n\nFIGURE 5.10 (a) Circuit for the AC analysis of the output stage, and (b) output-stage small-signal equivalent.\n\n#### Exercise 5.1\n\nDraw the small-signal equivalent of the biasing network in Fig. 5.9, consisting of $Q_{18}, Q_{19}$, and $R_{10}$, and demonstrate that the entire network acts as a single resistance\n\n$$\n\\begin{equation*}\nr_{b b}=\\frac{r_{d 18}+\\left(R_{10} / / r_{\\pi 19}\\right)}{1+g_{m 19}\\left(R_{10} / / r_{\\pi 19}\\right)} \\approx 174 \\Omega \\tag{5.17}\n\\end{equation*}\n$$\n\nwhere $r_{d 18}=V_{T} / I_{C 18}$ is the AC resistance of diode-connected $Q_{18}$, and $g_{m 19}=I_{C 19} / V_{T}$ and $r_{\\pi 19}=\\beta_{019} / g_{m 19}$ are the small-signal parameters of $Q_{19}$. Assume the currents from Example 5.1 and $\\beta_{019}=200$.\n\nTo determine the small-signal characteristics of the output stage, refer again to Fig. 5.10a. Considering that we have two voltage-followers coupled via the small resistance $r_{b b}$, we can approximate\n\n$$\n\\begin{equation*}\nv_{o} \\approx 1 \\times v_{i 3} \\tag{5.18}\n\\end{equation*}\n$$\n\nBy inspection, we also have\n\n$$\n\\begin{equation*}\nR_{i 3}=r_{\\pi 22}+\\left(\\beta_{022}+1\\right)\\left[r_{b b}+\\left(r_{o 13 B} / / R_{b 14}\\right)\\right] \\tag{5.19a}\n\\end{equation*}\n$$\n\nwhere $R_{b 14}$ is the AC resistance seen looking into the base of $Q_{14}$,\n\n$$\nR_{b 14}=r_{\\pi 14}+\\left(\\beta_{014}+1\\right)\\left(R_{6}+R_{L}\\right)\n$$\n\nAssuming $I_{C 14}=2.5 \\mathrm{~mA}$ and $\\beta_{014}=250$, we get $R_{b 14} \\approx 511 \\mathrm{k} \\Omega$. Substituting into Eq. (5.19a) and assuming $\\beta_{022}=50$, we finally obtain\n\n$$\n\\begin{equation*}\nR_{i 3}=9.33 \\mathrm{M} \\Omega \\tag{5.19b}\n\\end{equation*}\n$$\n\nUsing inspection again, we write\n\n$$\n\\begin{equation*}\nR_{o}=R_{6}+\\frac{R_{B 14}+r_{\\pi 14}}{\\beta_{014}+1} \\tag{5.20a}\n\\end{equation*}\n$$\n\nwhere $R_{B 14}$ is the AC resistance presented to $Q_{14}$'s base by the upstream circuitry,\n\n$$\nR_{B 14}=r_{o 13 B} / /\\left(r_{b b}+R_{e 22}\\right)\n$$\n\nand $R_{e 22}$ is the AC resistance seen looking into $Q_{22}$'s emitter\n\n$$\nR_{e 22}=\\frac{R_{o 2}+r_{\\pi 22}}{\\beta_{022}+1}=\\frac{81.3+50(26 / 0.176)}{50+1}=1.74 \\mathrm{k} \\Omega\n$$\n\nSubstituting gives $R_{B 14}=1.9 \\mathrm{k} \\Omega$. Substituting in turn into Eq. (5.20a) we finally get\n\n$$\n\\begin{equation*}\nR_{o}=47 \\Omega \\tag{5.20b}\n\\end{equation*}\n$$\n\nThe small-signal characteristics of the output stage are summarized in Fig. 5.10b. Before concluding this stage, we wish to investigate one additional characteristic that the user needs to be aware of, as reported in the data sheets.\n\n- Output Voltage Swing (OVS). This is the range of values of $v_{O}$ over which the output stage will operate properly, with all active BJTs functioning in the forward-active region or at most at the edge of saturation (EOS). A simple inspection of Fig. 5.1 reveals that the upper limit for $v_{O}$ is reached when $Q_{13 B}$ is driven to EOS, and the lower limit when $Q_{17}$ is driven to EOS. Using KVL, we can write $v_{O(\\max )} \\cong V_{C C}-V_{E C 13(\\mathrm{EOS})}-V_{B E 14(\\mathrm{on})}$ and $v_{O(\\min )} \\cong V_{E E}+V_{C E 17(\\mathrm{EOS})}+$ $V_{\\text {EB22(on) }}+V_{\\text {EB20(on) }}$. These simplify to\n\n$$\n\\begin{equation*}\nv_{O(\\max )} \\cong V_{C C}-V_{E C(\\mathrm{EOS})}-V_{B E(\\mathrm{on})} \\quad v_{O(\\min )} \\cong V_{E E}+V_{C E(\\mathrm{EOS})}+2 V_{E B(\\mathrm{on})} \\tag{5.21}\n\\end{equation*}\n$$\n\n(The above estimates assume identical junction voltage drops for the BJTs, along with light output loading so that the voltage drops across $R_{6}$ and $R_{7}$ can be ignored.) To provide an example, if we assume junction drops of 0.7 V and EOS drops of 0.2 V, the above estimates yield $v_{O(\\max )} \\cong V_{C C}-0.9 \\mathrm{~V}$ and $v_{O(\\min )} \\cong V_{E E}+1.6 \\mathrm{~V}$. With $\\pm 15-\\mathrm{V}$ supplies, the OVS is thus $-13.4 \\mathrm{~V} \\leq v_{O} \\leq +14.1 \\mathrm{~V}$."
},
{
    "text": "The output stage of the 741 operational amplifier incorporates several notable design strategies, which are best understood by examining the circuit in its standby state, as depicted in Fig. 5.9. This state is characterized by an input voltage of 0 V and the absence of any output load. The biasing transistors $Q_{18}$ and $Q_{19}$ are of minimum size, whereas the push-pull transistors $Q_{14}$ and $Q_{20}$ are designed with larger emitter areas (typically four times larger) to ensure adequate current gains even at high load currents. If $Q_{14}$ and $Q_{19}$ were connected in a diode configuration as described in Section 4.10, $Q_{14}$ and $Q_{20}$ would draw a standby current approximately four times that of the diodes. To reduce this current to a more manageable level, $Q_{18}$ is deliberately underbiased, as the following example will illustrate. Additionally, since $Q_{18}$ and $Q_{19}$ share the same collector, they are fabricated within the same isolation region, thereby conserving valuable die area.\n\nimage_name:FIGURE 5.9\ndescription:\n[\nname: Q14, type: NPN, ports: {C: VCC, B: V1, E: V5}\nname: Q18, type: NPN, ports: {C: V1, B: V1, E: V2}\nname: Q19, type: NPN, ports: {C: V1, B: V2, E: V3}\nname: Q20, type: PNP, ports: {C: VEE, B: V3, E: V6}\nname: Q22, type: PNP, ports: {C: VEE, B: GND, E: V3}\nname: R6, type: Resistor, value: 27 Ω, ports: {N1: V5, N2: V4}\nname: R7, type: Resistor, value: 22 Ω, ports: {N1: V4, N2: V6}\nname: R10, type: Resistor, value: 50 kΩ, ports: {N1: V2, N2: GND}\nname: I3, type: CurrentSource, value: 176 μA, ports: {Np: VCC, Nn: V1}\n]\nextrainfo:This circuit represents a DC analysis of the 741 output stage in standby mode, featuring NPN and PNP transistors, resistors, and a current source. The analysis involves estimating collector currents and voltages at various nodes to understand the circuit's behavior under standby conditions.\n\nFIGURE 5.9 DC analysis of the 741 output stage in standby.\n\nIn the circuit shown in Fig. 5.9, let $I_{s 18}=I_{s 19}=2 \\mathrm{fA}$ and $I_{s 14}=I_{s 20}=8 \\mathrm{fA}$ (four times larger). Whenever applicable, assume negligible base currents for all BJTs.\n(a) Use iterative methods to estimate the collector currents $I_{C 18}$ and $I_{C 19}$. Then, determine $V_{B B}$ in mV.\n(b) Estimate $I_{C 14}$ and $I_{C 20}$ under the simplifying assumption $R_{6}=R_{7}=0$.\n(c) Repeat part (b) with $R_{6}$ and $R_{7}$ included as shown. Comment on your findings.\n\n#### Solution\n\n(a) Begin with $V_{B E 19}=0.7 \\mathrm{~V}$, so $I_{C 18} \\approx V_{B E 19} / R_{10} \\approx 0.7 / 50 = 14 \\mu \\mathrm{~A}$. By KCL, $I_{C 19}=I_{3}-I_{C 18} \\approx 176-14 = 162 \\mu \\mathrm{~A}$. Using the BJT equation, $V_{B E 19} = V_{T} \\ln \\left(I_{C 19} / I_{s 19}\\right) = 0.026 \\ln \\left[\\left(162 \\times 10^{-6}\\right) / \\left(2 \\times 10^{-15}\\right)\\right] = 0.653 \\mathrm{~V}$. Use this value for a refined estimate $I_{C 18} \\approx 0.653 / 50 \\approx 13 \\mu \\mathrm{~A}$. Allowing for about $1 \\mu \\mathrm{~A}$ of base current for $Q_{19}$, we finally get\n\n$$\n\\begin{equation*}\nI_{C 18} \\approx 14 \\mu \\mathrm{~A} \\quad I_{C 19} \\approx 162 \\mu \\mathrm{~A} \\tag{5.15}\n\\end{equation*}\n$$\n\nNo further iterations are needed. Applying the BJT equation again with $I_{s 18}=I_{s 19}=2 \\mathrm{fA}$, we obtain\n\n$$\nV_{B B}=V_{B E 18}+V_{B E 19}=589.4+653.1 \\approx 1242 \\mathrm{mV}\n$$\n\n(b) In standby, $I_{C 14}=I_{C 20}$. With $I_{s 14}=I_{s 20}$, we also have $V_{B E 14}=V_{E B 20}=V_{B B} / 2$, so\n\n$$\nI_{C 14}=I_{C 20}=8 \\times 10^{-15} \\exp (1242 / 52) \\approx 190 \\mu \\mathrm{~A}\n$$\n\nDespite being large-area devices, $Q_{14}$ and $Q_{20}$ conduct a standby current comparable to $I_{3}$.\n(c) With $R_{6}$ and $R_{7}$ in place, the voltage drop across the combined junctions of $Q_{14}$ and $Q_{20}$ decreases by $\\Delta V=(R_{6}+R_{7}) I_{Q}$, where $I_{Q}$ is the new quiescent current of $Q_{14}$ and $Q_{20}$. Using $190 \\mu \\mathrm{~A}$ as an initial estimate for $I_{Q}$, we find $\\Delta V=(27+22) 190 \\times 10^{-6} \\approx 9.3 \\mathrm{mV}$, so\n\n$$\n\\begin{equation*}\nI_{Q}=8 \\times 10^{-15} \\exp [(1242-9.3) / 52] \\approx 160 \\mu \\mathrm{~A} \\tag{5.16}\n\\end{equation*}\n$$\n\nThis is lower than the previous estimate due to the voltage drop across $R_{6}$ and $R_{7}$.\n\nIn practical applications, the output stage is rarely in standby. For a more realistic AC analysis, consider a typical scenario with a $2-\\mathrm{k} \\Omega$ load driven by a voltage centered at $V_{O}=5 \\mathrm{~V}$. Under these conditions, the lower half of the push-pull stage will be off, leaving $Q_{14}$ to source the current $I_{L}=5 / 2=2.5 \\mathrm{~mA}$ to the load. The AC equivalent of the output stage simplifies as shown in Fig. 5.10a, where $Q_{13 B}$ is modeled with the resistance $r_{o 13 B}=(50 \\mathrm{~V}) / (176 \\mu \\mathrm{~A})=284 \\mathrm{k} \\Omega$, and the biasing network consisting of $Q_{18}, Q_{19}$, and $R_{10}$ is represented by a single small-signal resistance $r_{b b} \\approx 174 \\Omega$ (see Exercise 5.1).\n\nimage_name:(a)\ndescription:\n[\nname: Q22, type: PNP, ports: {C: GND, B: vi3, E: ve22}\nname: Q14, type: NPN, ports: {C: GND, B: v1, E: v2}\nname: Ro13B, type: Resistor, value: 284kΩ, ports: {N1: GND, N2: v1}\nname: Rbb, type: Resistor, value: 174Ω, ports: {N1: v1, N2: ve22}\nname: R02, type: Resistor, value: 81.3kΩ, ports: {N1: vi3, N2: GND}\nname: R6, type: Resistor, value: 27kΩ, ports: {N1: v2, N2: vo}\nname: RL, type: Resistor, value: 2kΩ, ports: {N1: vo, N2: GND}\n]\nextrainfo:The circuit is an AC analysis model of an output stage, featuring a push-pull amplifier configuration with transistors Q22 and Q14, resistors for biasing and load, and models for small-signal analysis. The circuit is designed to analyze the behavior of the output stage under AC conditions.\nimage_name:(b)\ndescription:\n[\nname: Ri3, type: Resistor, value: 9.33MΩ, ports: {N1: Vi3, N2: GND}\nname: Ro, type: Resistor, value: 47Ω, ports: {N1: Vi3, N2: Vo}\nname: vi3, type: VoltageControlledCurrentSource, value: vi3, ports: {Np: Vi3, Nn: GND}\n]\nextrainfo:The circuit is an AC equivalent output stage with a push-pull configuration. Q14 sources current to the load, while Q22 is part of the biasing network. The circuit includes a feedback loop with resistors and a small-signal equivalent for AC analysis.\n\nFIGURE 5.10 (a) Circuit for the AC analysis of the output stage, and (b) output-stage small-signal equivalent.\n\n#### Exercise 5.1\n\nDraw the small-signal equivalent of the biasing network in Fig. 5.9, consisting of $Q_{18}, Q_{19}$, and $R_{10}$, and demonstrate that the entire network acts as a single resistance\n\n$$\n\\begin{equation*}\nr_{b b}=\\frac{r_{d 18}+\\left(R_{10} / / r_{\\pi 19}\\right)}{1+g_{m 19}\\left(R_{10} / / r_{\\pi 19}\\right)} \\approx 174 \\Omega \\tag{5.17}\n\\end{equation*}\n$$\n\nwhere $r_{d 18}=V_{T} / I_{C 18}$ is the AC resistance of diode-connected $Q_{18}$, and $g_{m 19}=I_{C 19} / V_{T}$ and $r_{\\pi 19}=\\beta_{019} / g_{m 19}$ are the small-signal parameters of $Q_{19}$. Assume the currents from Example 5.1 and $\\beta_{019}=200$.\n\nTo determine the small-signal characteristics of the output stage, refer again to Fig. 5.10a. Considering the presence of two voltage-followers coupled via the small resistance $r_{b b}$, we can approximate\n\n$$\n\\begin{equation*}\nv_{o} \\approx 1 \\times v_{i 3} \\tag{5.18}\n\\end{equation*}\n$$\n\nBy inspection, we also have\n\n$$\n\\begin{equation*}\nR_{i 3}=r_{\\pi 22}+\\left(\\beta_{022}+1\\right)\\left[r_{b b}+\\left(r_{o 13 B} / / R_{b 14}\\right)\\right] \\tag{5.19a}\n\\end{equation*}\n$$\n\nwhere $R_{b 14}$ is the AC resistance seen looking into the base of $Q_{14}$,\n\n$$\nR_{b 14}=r_{\\pi 14}+\\left(\\beta_{014}+1\\right)\\left(R_{6}+R_{L}\\right)\n$$\n\nAssuming $I_{C 14}=2.5 \\mathrm{~mA}$ and $\\beta_{014}=250$, we get $R_{b 14} \\approx 511 \\mathrm{k} \\Omega$. Substituting into Eq. (5.19a) and assuming $\\beta_{022}=50$, we obtain\n\n$$\n\\begin{equation*}\nR_{i 3}=9.33 \\mathrm{M} \\Omega \\tag{5.19b}\n\\end{equation*}\n$$\n\nUsing inspection again, we write\n\n$$\n\\begin{equation*}\nR_{o}=R_{6}+\\frac{R_{B 14}+r_{\\pi 14}}{\\beta_{014}+1} \\tag{5.20a}\n\\end{equation*}\n$$\n\nwhere $R_{B 14}$ is the AC resistance presented to $Q_{14}$'s base by the upstream circuitry,\n\n$$\nR_{B 14}=r_{o 13 B} / /\\left(r_{b b}+R_{e 22}\\right)\n$$\n\nand $R_{e 22}$ is the AC resistance seen looking into $Q_{22}$'s emitter\n\n$$\nR_{e 22}=\\frac{R_{o 2}+r_{\\pi 22}}{\\beta_{022}+1}=\\frac{81.3+50(26 / 0.176)}{50+1}=1.74 \\mathrm{k} \\Omega\n$$\n\nSubstituting gives $R_{B 14}=1.9 \\mathrm{k} \\Omega$. Substituting in turn into Eq. (5.20a) we finally get\n\n$$\n\\begin{equation*}\nR_{o}=47 \\Omega \\tag{5.20b}\n\\end{equation*}\n$$\n\nThe small-signal characteristics of the output stage are summarized in Fig. 5.10b. Before concluding this stage, we wish to investigate an additional characteristic that the user needs to be aware of, as reported in the data sheets.\n\n- Output Voltage Swing (OVS). This is the range of values of $v_{O}$ over which the output stage will operate correctly, with all active BJTs functioning in the forward-active region or at most at the edge of saturation (EOS). A simple inspection of Fig. 5.1 reveals that the upper limit for $v_{O}$ is reached when $Q_{13 B}$ is driven to EOS, and the lower limit when $Q_{17}$ is driven to EOS. Using KVL, we can write $v_{O(\\max )} \\approx V_{C C}-V_{E C 13(\\mathrm{EOS})}-V_{B E 14(\\mathrm{on})}$ and $v_{O(\\min )} \\approx V_{E E}+V_{C E 17(\\mathrm{EOS})}+$ $V_{\\text {EB22(on) }}+V_{\\text {EB20(on) }}$. These simplify to\n\n$$\n\\begin{equation*}\nv_{O(\\max )} \\approx V_{C C}-V_{E C(\\mathrm{EOS})}-V_{B E(\\mathrm{on})} \\quad v_{O(\\min )} \\approx V_{E E}+V_{C E(\\mathrm{EOS})}+2 V_{E B(\\mathrm{on})} \\tag{5.21}\n\\end{equation*}\n$$\n\n(The above estimates assume identical junction voltage drops for the BJTs, along with light output loading so that the voltage drops across $R_{6}$ and $R_{7}$ can be ignored.) To illustrate, if we assume junction drops of 0.7 V and EOS drops of 0.2 V, the above estimates yield $v_{O(\\max )} \\approx V_{C C}-0.9 \\mathrm{~V}$ and $v_{O(\\min )} \\approx V_{E E}+1.6 \\mathrm{~V}$. With $\\pm 15-\\mathrm{V}$ supplies, the OVS is thus $-13.4 \\mathrm{~V} \\leq v_{O} \\leq +14.1 \\mathrm{~V}$."
},
{
    "text": "The output stage of the 741 operational amplifier incorporates intriguing design solutions that are best understood by examining the circuit in its standby state, as depicted in Fig. 5.9 for an input of 0 V and no output load. The biasing transistors $Q_{18}$ and $Q_{19}$ are minimal in size, whereas the push-pull transistors $Q_{14}$ and $Q_{20}$ are designed with larger emitter areas (typically four times larger) to maintain effective current gains even at high load currents. If $Q_{14}$ and $Q_{19}$ were connected as diodes, as described in Section 4.10, $Q_{14}$ and $Q_{20}$ would draw a standby current approximately four times that of the diodes. To reduce this current to a more manageable level, $Q_{18}$ is deliberately underbiased, as the following example will illustrate. It is also noteworthy that $Q_{18}$ and $Q_{19}$, sharing the same collector, are fabricated within the same isolation region, thereby conserving valuable die area.\n\nimage_name:FIGURE 5.9\ndescription:\n[\nname: Q14, type: NPN, ports: {C: VCC, B: V1, E: V5}\nname: Q18, type: NPN, ports: {C: V1, B: V1, E: V2}\nname: Q19, type: NPN, ports: {C: V1, B: V2, E: V3}\nname: Q20, type: PNP, ports: {C: VEE, B: V3, E: V6}\nname: Q22, type: PNP, ports: {C: VEE, B: GND, E: V3}\nname: R6, type: Resistor, value: 27 Ω, ports: {N1: V5, N2: V4}\nname: R7, type: Resistor, value: 22 Ω, ports: {N1: V4, N2: V6}\nname: R10, type: Resistor, value: 50 kΩ, ports: {N1: V2, N2: GND}\nname: I3, type: CurrentSource, value: 176 μA, ports: {Np: VCC, Nn: V1}\n]\nextrainfo:This circuit represents a DC analysis of the 741 output stage in standby mode, featuring NPN and PNP transistors, resistors, and a current source. The analysis involves estimating collector currents and voltages at various nodes to understand the circuit's behavior under standby conditions.\n\nFIGURE 5.9 DC analysis of the 741 output stage in standby.\n\nIn the circuit shown in Fig. 5.9, let $I_{s 18}=I_{s 19}=2 \\mathrm{fA}$ and $I_{s 14}=I_{s 20}=8 \\mathrm{fA}$ (four times larger). Additionally, assume negligible base currents for all BJTs where appropriate.\n(a) Use iterative methods to estimate the collector currents $I_{C 18}$ and $I_{C 19}$. Then, determine $V_{B B}$ in millivolts.\n(b) Estimate $I_{C 14}$ and $I_{C 20}$ under the simplifying assumption that $R_{6}=R_{7}=0$.\n(c) Repeat part (b) with $R_{6}$ and $R_{7}$ in place as shown. Comment on your findings.\n\n#### Solution\n\n(a) Begin with $V_{B E 19}=0.7 \\mathrm{~V}$, so $I_{C 18} \\approx V_{B E 19} / R_{10} \\approx 0.7 / 50 = 14 \\mu \\mathrm{~A}$. By KCL, $I_{C 19}=I_{3}-I_{C 18} \\approx 176-14 = 162 \\mu \\mathrm{~A}$. Using the BJT equation, $V_{B E 19} = V_{T} \\ln (I_{C 19} / I_{s 19}) = 0.026 \\ln [(162 \\times 10^{-6}) / (2 \\times 10^{-15})] = 0.653 \\mathrm{~V}$. Use this value for a refined estimate: $I_{C 18} \\approx 0.653 / 50 \\approx 13 \\mu \\mathrm{~A}$. Allowing for about $1 \\mu \\mathrm{~A}$ of base current for $Q_{19}$, we finally get\n\n$$\n\\begin{equation*}\nI_{C 18} \\approx 14 \\mu \\mathrm{~A} \\quad I_{C 19} \\approx 162 \\mu \\mathrm{~A} \\tag{5.15}\n\\end{equation*}\n$$\n\nNo further iterations are needed. Applying the BJT equation again with $I_{s 18}=I_{s 19}=2 \\mathrm{fA}$, we obtain\n\n$$\nV_{B B}=V_{B E 18}+V_{B E 19}=589.4+653.1 \\approx 1242 \\mathrm{mV}\n$$\n\n(b) In standby, $I_{C 14}=I_{C 20}$. With $I_{s 14}=I_{s 20}$, we also have $V_{B E 14}=V_{E B 20}=V_{B B} / 2$, so\n\n$$\nI_{C 14}=I_{C 20}=8 \\times 10^{-15} \\exp (1242 / 52) \\approx 190 \\mu \\mathrm{~A}\n$$\n\nDespite being large-area devices, $Q_{14}$ and $Q_{20}$ conduct a standby current comparable to $I_{3}$.\n(c) With $R_{6}$ and $R_{7}$ in place, the voltage drop across the combined junctions of $Q_{14}$ and $Q_{20}$ decreases by $\\Delta V=(R_{6}+R_{7}) I_{Q}$, where $I_{Q}$ is the new quiescent current of $Q_{14}$ and $Q_{20}$. Using $190 \\mu \\mathrm{~A}$ as an initial estimate for $I_{Q}$, we find $\\Delta V=(27+22) 190 \\times 10^{-6} \\approx 9.3 \\mathrm{mV}$, so\n\n$$\n\\begin{equation*}\nI_{Q}=8 \\times 10^{-15} \\exp [(1242-9.3) / 52] \\approx 160 \\mu \\mathrm{~A} \\tag{5.16}\n\\end{equation*}\n$$\n\nThis is lower than the previous estimate due to the voltage drop across $R_{6}$ and $R_{7}$.\n\nIn practical applications, the output stage is rarely in standby. For a more realistic AC analysis, consider a typical scenario with a $2-\\mathrm{k} \\Omega$ load driven by a voltage centered at $V_{O}=5 \\mathrm{~V}$. Under these conditions, the lower half of the push-pull stage will be off, leaving $Q_{14}$ to source the current $I_{L}=5 / 2=2.5 \\mathrm{~mA}$ to the load. The AC equivalent of the output stage simplifies as shown in Fig. 5.10a, where $Q_{13 B}$ is modeled with the resistance $r_{o 13 B}=(50 \\mathrm{~V}) / (176 \\mu \\mathrm{~A})=284 \\mathrm{k} \\Omega$, and the biasing network consisting of $Q_{18}, Q_{19}$, and $R_{10}$ is represented by a single small-signal resistance $r_{b b} \\approx 174 \\Omega$ (see Exercise 5.1).\nimage_name:(a)\ndescription:\n[\nname: Q22, type: PNP, ports: {C: GND, B: vi3, E: ve22}\nname: Q14, type: NPN, ports: {C: GND, B: v1, E: v2}\nname: Ro13B, type: Resistor, value: 284kΩ, ports: {N1: GND, N2: v1}\nname: Rbb, type: Resistor, value: 174Ω, ports: {N1: v1, N2: ve22}\nname: R02, type: Resistor, value: 81.3kΩ, ports: {N1: vi3, N2: GND}\nname: R6, type: Resistor, value: 27kΩ, ports: {N1: v2, N2: vo}\nname: RL, type: Resistor, value: 2kΩ, ports: {N1: vo, N2: GND}\n]\nextrainfo:The circuit represents an AC analysis model of an output stage, featuring a push-pull amplifier configuration with transistors Q22 and Q14, resistors for biasing and load, and models for small-signal analysis. The circuit is designed to analyze the behavior of the output stage under AC conditions.\nimage_name:(b)\ndescription:\n[\nname: Ri3, type: Resistor, value: 9.33MΩ, ports: {N1: Vi3, N2: GND}\nname: Ro, type: Resistor, value: 47Ω, ports: {N1: Vi3, N2: Vo}\nname: vi3, type: VoltageControlledCurrentSource, value: vi3, ports: {Np: Vi3, Nn: GND}\n]\nextrainfo:The circuit is an AC equivalent output stage with a push-pull configuration. Q14 sources current to the load, while Q22 is part of the biasing network. The circuit includes a feedback loop with resistors and a small-signal equivalent for AC analysis.\n\nFIGURE 5.10 (a) Circuit for the AC analysis of the output stage, and (b) output-stage small-signal equivalent.\n\n#### Exercise 5.1\n\nDraw the small-signal equivalent of the biasing network in Fig. 5.9, consisting of $Q_{18}, Q_{19}$, and $R_{10}$, and demonstrate that the entire network acts as a single resistance\n\n$$\n\\begin{equation*}\nr_{b b}=\\frac{r_{d 18}+\\left(R_{10} / / r_{\\pi 19}\\right)}{1+g_{m 19}\\left(R_{10} / / r_{\\pi 19}\\right)} \\approx 174 \\Omega \\tag{5.17}\n\\end{equation*}\n$$\n\nwhere $r_{d 18}=V_{T} / I_{C 18}$ is the AC resistance of diode-connected $Q_{18}$, and $g_{m 19}=I_{C 19} / V_{T}$ and $r_{\\pi 19}=\\beta_{019} / g_{m 19}$ are the small-signal parameters of $Q_{19}$. Assume the currents from Example 5.1 and $\\beta_{019}=200$.\n\nTo determine the small-signal characteristics of the output stage, refer again to Fig. 5.10a. Considering the presence of two voltage-followers coupled via the small resistance $r_{b b}$, we can approximate\n\n$$\n\\begin{equation*}\nv_{o} \\approx 1 \\times v_{i 3} \\tag{5.18}\n\\end{equation*}\n$$\n\nBy inspection, we also have\n\n$$\n\\begin{equation*}\nR_{i 3}=r_{\\pi 22}+\\left(\\beta_{022}+1\\right)\\left[r_{b b}+\\left(r_{o 13 B} / / R_{b 14}\\right)\\right] \\tag{5.19a}\n\\end{equation*}\n$$\n\nwhere $R_{b 14}$ is the AC resistance seen looking into the base of $Q_{14}$,\n\n$$\nR_{b 14}=r_{\\pi 14}+\\left(\\beta_{014}+1\\right)\\left(R_{6}+R_{L}\\right)\n$$\n\nAssuming $I_{C 14}=2.5 \\mathrm{~mA}$ and $\\beta_{014}=250$, we get $R_{b 14} \\approx 511 \\mathrm{k} \\Omega$. Substituting into Eq. (5.19a) and assuming $\\beta_{022}=50$, we obtain\n\n$$\n\\begin{equation*}\nR_{i 3}=9.33 \\mathrm{M} \\Omega \\tag{5.19b}\n\\end{equation*}\n$$\n\nUsing inspection again, we write\n\n$$\n\\begin{equation*}\nR_{o}=R_{6}+\\frac{R_{B 14}+r_{\\pi 14}}{\\beta_{014}+1} \\tag{5.20a}\n\\end{equation*}\n$$\n\nwhere $R_{B 14}$ is the AC resistance presented to $Q_{14}$'s base by the upstream circuitry,\n\n$$\nR_{B 14}=r_{o 13 B} / /\\left(r_{b b}+R_{e 22}\\right)\n$$\n\nand $R_{e 22}$ is the AC resistance seen looking into $Q_{22}$'s emitter\n\n$$\nR_{e 22}=\\frac{R_{o 2}+r_{\\pi 22}}{\\beta_{022}+1}=\\frac{81.3+50(26 / 0.176)}{50+1}=1.74 \\mathrm{k} \\Omega\n$$\n\nSubstituting gives $R_{B 14}=1.9 \\mathrm{k} \\Omega$. Substituting in turn into Eq. (5.20a) we finally get\n\n$$\n\\begin{equation*}\nR_{o}=47 \\Omega \\tag{5.20b}\n\\end{equation*}\n$$\n\nThe small-signal characteristics of the output stage are summarized in Fig. 5.10b. Before concluding this stage, we wish to investigate one additional characteristic that the user needs to be aware of, as reported in the data sheets.\n\n- Output Voltage Swing (OVS). This is the range of $v_{O}$ values over which the output stage operates correctly, with all active BJTs functioning in the forward-active region or at most at the edge of saturation (EOS). A simple inspection of Fig. 5.1 reveals that the upper limit for $v_{O}$ is reached when $Q_{13 B}$ is driven to EOS, and the lower limit when $Q_{17}$ is driven to EOS. Using KVL, we write $v_{O(\\max )} \\approx V_{C C}-V_{E C 13(\\mathrm{EOS})}-V_{B E 14(\\mathrm{on})}$ and $v_{O(\\min )} \\approx V_{E E}+V_{C E 17(\\mathrm{EOS})}+V_{\\text {EB22(on) }}+V_{\\text {EB20(on) }}$. These simplify to\n\n$$\n\\begin{equation*}\nv_{O(\\max )} \\approx V_{C C}-V_{E C(\\mathrm{EOS})}-V_{B E(\\mathrm{on})} \\quad v_{O(\\min )} \\approx V_{E E}+V_{C E(\\mathrm{EOS})}+2 V_{E B(\\mathrm{on})} \\tag{5.21}\n\\end{equation*}\n$$\n\n(The above estimates assume identical junction voltage drops for the BJTs and light output loading, so voltage drops across $R_{6}$ and $R_{7}$ can be ignored.) If we assume junction drops of 0.7 V and EOS drops of 0.2 V, the estimates yield $v_{O(\\max )} \\approx V_{C C}-0.9 \\mathrm{~V}$ and $v_{O(\\min )} \\approx V_{E E}+1.6 \\mathrm{~V}$. With $\\pm 15-\\mathrm{V}$ supplies, the OVS is thus $-13.4 \\mathrm{~V} \\leq v_{O} \\leq +14.1 \\mathrm{~V}$."
},
{
    "text": "The output stage of the 741 op amp incorporates several intriguing design strategies that are most effectively understood by examining the circuit in its standby condition. This state is depicted in Fig. 5.9, illustrating the scenario where the input is at 0 V and no output load is present. The biasing transistors $Q_{18}$ and $Q_{19}$ are of minimal size, whereas the push-pull transistors $Q_{14}$ and $Q_{20}$ are constructed with larger emitter areas (typically four times larger) to ensure adequate current gains even at high load currents. If $Q_{14}$ and $Q_{19}$ were connected in a diode configuration as described in Section 4.10, $Q_{14}$ and $Q_{20}$ would draw a standby current approximately four times that of the diodes. To reduce this current to a more manageable level, $Q_{18}$ is deliberately underbiased, as the following example will elucidate. Additionally, it is noteworthy that $Q_{18}$ and $Q_{19}$, which share the same collector, are fabricated within the same isolation region, thereby conserving valuable die area.\n\nimage_name:FIGURE 5.9\ndescription:\n[\nname: Q14, type: NPN, ports: {C: VCC, B: V1, E: V5}\nname: Q18, type: NPN, ports: {C: V1, B: V1, E: V2}\nname: Q19, type: NPN, ports: {C: V1, B: V2, E: V3}\nname: Q20, type: PNP, ports: {C: VEE, B: V3, E: V6}\nname: Q22, type: PNP, ports: {C: VEE, B: GND, E: V3}\nname: R6, type: Resistor, value: 27 Ω, ports: {N1: V5, N2: V4}\nname: R7, type: Resistor, value: 22 Ω, ports: {N1: V4, N2: V6}\nname: R10, type: Resistor, value: 50 kΩ, ports: {N1: V2, N2: GND}\nname: I3, type: CurrentSource, value: 176 μA, ports: {Np: VCC, Nn: V1}\n]\nextrainfo:This circuit represents a DC analysis of the 741 output stage in standby mode, featuring NPN and PNP transistors, resistors, and a current source. The analysis involves estimating collector currents and voltages at various nodes to comprehend the circuit's behavior under standby conditions.\n\nFIGURE 5.9 DC analysis of the 741 output stage in standby.\n\nIn the circuit shown in Fig. 5.9, let $I_{s 18}=I_{s 19}=2 \\mathrm{fA}$ and $I_{s 14}=I_{s 20}=8 \\mathrm{fA}$ (four times larger). Furthermore, assume negligible base currents for all BJTs where appropriate.\n(a) Use iterative methods to estimate the collector currents $I_{C 18}$ and $I_{C 19}$. Consequently, determine $V_{B B}$ in mV.\n(b) Estimate $I_{C 14}$ and $I_{C 20}$ under the simplifying assumption that $R_{6}=R_{7}=0$.\n(c) Repeat part (b) with $R_{6}$ and $R_{7}$ in place as depicted. Comment on your observations.\n\n#### Solution\n\n(a) Begin with $V_{B E 19}=0.7 \\mathrm{~V}$, thus $I_{C 18} \\approx V_{B E 19} / R_{10} \\approx 0.7 / 50 = 14 \\mu \\mathrm{~A}$. By KCL, $I_{C 19}=I_{3}-I_{C 18} \\approx 176-14 = 162 \\mu \\mathrm{~A}$. Using the BJT equation, $V_{B E 19} = V_{T} \\ln (I_{C 19} / I_{s 19}) = 0.026 \\ln [(162 \\times 10^{-6}) / (2 \\times 10^{-15})] = 0.653 \\mathrm{~V}$. Utilize this value for the refined estimate $I_{C 18} \\approx 0.653 / 50 \\approx 13 \\mu \\mathrm{~A}$. Allowing for approximately $1 \\mu \\mathrm{~A}$ of base current for $Q_{19}$, we finally obtain\n\n$$\n\\begin{equation*}\nI_{C 18} \\approx 14 \\mu \\mathrm{~A} \\quad I_{C 19} \\approx 162 \\mu \\mathrm{~A} \\tag{5.15}\n\\end{equation*}\n$$\n\nNo further iterations are necessary. Applying the BJT equation again with $I_{s 18}=I_{s 19}=2 \\mathrm{fA}$, we get\n\n$$\nV_{B B}=V_{B E 18}+V_{B E 19}=589.4+653.1 \\approx 1242 \\mathrm{mV}\n$$\n\n(b) In standby, $I_{C 14}=I_{C 20}$. Additionally, with $I_{s 14}=I_{s 20}$, we also have $V_{B E 14}=V_{E B 20}=V_{B B} / 2$, so\n\n$$\nI_{C 14}=I_{C 20}=8 \\times 10^{-15} \\exp (1242 / 52) \\approx 190 \\mu \\mathrm{~A}\n$$\n\nDespite being large-area devices, $Q_{14}$ and $Q_{20}$ conduct a standby current comparable to $I_{3}$.\n(c) With $R_{6}$ and $R_{7}$ in place, the voltage drop across the combined junctions of $Q_{14}$ and $Q_{20}$ decreases by $\\Delta V=(R_{6}+R_{7}) I_{Q}$, where $I_{Q}$ is the new quiescent current of $Q_{14}$ and $Q_{20}$. Using $190 \\mu \\mathrm{~A}$ as our initial estimate for $I_{Q}$, we find $\\Delta V=(27+22) 190 \\times 10^{-6} \\approx 9.3 \\mathrm{mV}$, thus\n\n$$\n\\begin{equation*}\nI_{Q}=8 \\times 10^{-15} \\exp [(1242-9.3) / 52] \\approx 160 \\mu \\mathrm{~A} \\tag{5.16}\n\\end{equation*}\n$$\n\nThis is lower than the previous estimate due to the voltage drop across $R_{6}$ and $R_{7}$.\n\nIn practical applications, the output stage is seldom in standby. For a more realistic AC analysis, consider a typical scenario with a $2-\\mathrm{k} \\Omega$ load driven by a voltage centered at $V_{O}=5 \\mathrm{~V}$. Under these conditions, the lower half of the push-pull stage will be off, leaving $Q_{14}$ to source the current $I_{L}=5 / 2=2.5 \\mathrm{~mA}$ to the load. The AC equivalent of the output stage simplifies as shown in Fig. 5.10a, where $Q_{13 B}$ is modeled with the resistance $r_{o 13 B}=(50 \\mathrm{~V}) / (176 \\mu \\mathrm{~A})=284 \\mathrm{k} \\Omega$, and the biasing network composed of $Q_{18}, Q_{19}$, and $R_{10}$ is represented by a single small-signal resistance $r_{b b} \\approx 174 \\Omega$ (see Exercise 5.1).\n\nimage_name:(a)\ndescription:\n[\nname: Q22, type: PNP, ports: {C: GND, B: vi3, E: ve22}\nname: Q14, type: NPN, ports: {C: GND, B: v1, E: v2}\nname: Ro13B, type: Resistor, value: 284kΩ, ports: {N1: GND, N2: v1}\nname: Rbb, type: Resistor, value: 174Ω, ports: {N1: v1, N2: ve22}\nname: R02, type: Resistor, value: 81.3kΩ, ports: {N1: vi3, N2: GND}\nname: R6, type: Resistor, value: 27kΩ, ports: {N1: v2, N2: vo}\nname: RL, type: Resistor, value: 2kΩ, ports: {N1: vo, N2: GND}\n]\nextrainfo:The circuit is an AC analysis model of an output stage, featuring a push-pull amplifier configuration with transistors Q22 and Q14, resistors for biasing and load, and models for small-signal analysis. The circuit is designed to analyze the behavior of the output stage under AC conditions.\n\nimage_name:(b)\ndescription:\n[\nname: Ri3, type: Resistor, value: 9.33MΩ, ports: {N1: Vi3, N2: GND}\nname: Ro, type: Resistor, value: 47Ω, ports: {N1: Vi3, N2: Vo}\nname: vi3, type: VoltageControlledCurrentSource, value: vi3, ports: {Np: Vi3, Nn: GND}\n]\nextrainfo:The circuit is an AC equivalent output stage with a push-pull configuration. Q14 sources current to the load, while Q22 is part of the biasing network. The circuit includes a feedback loop with resistors and a small-signal equivalent for AC analysis.\n\nFIGURE 5.10 (a) Circuit for the AC analysis of the output stage, and (b) output-stage small-signal equivalent.\n\n#### Exercise 5.1\n\nDraw the small-signal equivalent of the biasing network in Fig. 5.9, consisting of $Q_{18}, Q_{19}$, and $R_{10}$, and demonstrate that the entire network acts as a single resistance\n\n$$\n\\begin{equation*}\nr_{b b}=\\frac{r_{d 18}+\\left(R_{10} / / r_{\\pi 19}\\right)}{1+g_{m 19}\\left(R_{10} / / r_{\\pi 19}\\right)} \\approx 174 \\Omega \\tag{5.17}\n\\end{equation*}\n$$\n\nwhere $r_{d 18}=V_{T} / I_{C 18}$ is the AC resistance of diode-connected $Q_{18}$, and $g_{m 19}=I_{C 19} / V_{T}$ and $r_{\\pi 19}=\\beta_{019} / g_{m 19}$ are the small-signal parameters of $Q_{19}$. Assume the currents from Example 5.1 and $\\beta_{019}=200$.\n\nTo determine the small-signal characteristics of the output stage, refer again to Fig. 5.10a. Considering the presence of two voltage-followers coupled via the small resistance $r_{b b}$, we can approximate\n\n$$\n\\begin{equation*}\nv_{o} \\approx 1 \\times v_{i 3} \\tag{5.18}\n\\end{equation*}\n$$\n\nBy inspection, we also have\n\n$$\n\\begin{equation*}\nR_{i 3}=r_{\\pi 22}+\\left(\\beta_{022}+1\\right)\\left[r_{b b}+\\left(r_{o 13 B} / / R_{b 14}\\right)\\right] \\tag{5.19a}\n\\end{equation*}\n$$\n\nwhere $R_{b 14}$ is the AC resistance seen looking into the base of $Q_{14}$,\n\n$$\nR_{b 14}=r_{\\pi 14}+\\left(\\beta_{014}+1\\right)\\left(R_{6}+R_{L}\\right)\n$$\n\nAssuming $I_{C 14}=2.5 \\mathrm{~mA}$ and $\\beta_{014}=250$, we get $R_{b 14} \\approx 511 \\mathrm{k} \\Omega$. Substituting into Eq. (5.19a) and assuming $\\beta_{022}=50$, we finally obtain\n\n$$\n\\begin{equation*}\nR_{i 3}=9.33 \\mathrm{M} \\Omega \\tag{5.19b}\n\\end{equation*}\n$$\n\nUsing inspection again, we write\n\n$$\n\\begin{equation*}\nR_{o}=R_{6}+\\frac{R_{B 14}+r_{\\pi 14}}{\\beta_{014}+1} \\tag{5.20a}\n\\end{equation*}\n$$\n\nwhere $R_{B 14}$ is the AC resistance presented to $Q_{14}$'s base by the upstream circuitry,\n\n$$\nR_{B 14}=r_{o 13 B} / /\\left(r_{b b}+R_{e 22}\\right)\n$$\n\nand $R_{e 22}$ is the AC resistance seen looking into $Q_{22}$'s emitter,\n\n$$\nR_{e 22}=\\frac{R_{o 2}+r_{\\pi 22}}{\\beta_{022}+1}=\\frac{81.3+50(26 / 0.176)}{50+1}=1.74 \\mathrm{k} \\Omega\n$$\n\nSubstituting gives $R_{B 14}=1.9 \\mathrm{k} \\Omega$. Substituting in turn into Eq. (5.20a) we finally get\n\n$$\n\\begin{equation*}\nR_{o}=47 \\Omega \\tag{5.20b}\n\\end{equation*}\n$$\n\nThe small-signal characteristics of the output stage are summarized in Fig. 5.10b. Before concluding this stage, we wish to investigate an additional characteristic that the user needs to be aware of, as reported in the data sheets.\n\n- Output Voltage Swing (OVS). This is the range of values of $v_{O}$ over which the output stage will operate correctly, with all active BJTs functioning in the forward-active region or at most at the edge of saturation (EOS). A simple inspection of Fig. 5.1 reveals that the upper limit for $v_{O}$ is reached when $Q_{13 B}$ is driven to the EOS, and the lower limit when $Q_{17}$ is driven to the EOS. Using KVL, we can write $v_{O(\\max )} \\approx V_{C C}-V_{E C 13(\\mathrm{EOS})}-V_{B E 14(\\mathrm{on})}$ and $v_{O(\\min )} \\approx V_{E E}+V_{C E 17(\\mathrm{EOS})}+$ $V_{\\text {EB22(on) }}+V_{\\text {EB20(on) }}$. These simplify to\n\n$$\n\\begin{equation*}\nv_{O(\\max )} \\approx V_{C C}-V_{E C(\\mathrm{EOS})}-V_{B E(\\mathrm{on})} \\quad v_{O(\\min )} \\approx V_{E E}+V_{C E(\\mathrm{EOS})}+2 V_{E B(\\mathrm{on})} \\tag{5.21}\n\\end{equation*}\n$$\n\n(The above estimates assume identical junction voltage drops for the BJTs, along with light output loading so that the voltage drops across $R_{6}$ and $R_{7}$ can be ignored.) To provide an example, if we assume junction drops of 0.7 V and EOS drops of 0.2 V, the above estimates yield $v_{O(\\max )} \\approx V_{C C}-0.9 \\mathrm{~V}$ and $v_{O(\\min )} \\approx V_{E E}+1.6 \\mathrm{~V}$. With $\\pm 15-\\mathrm{V}$ supplies, the OVS is thus $-13.4 \\mathrm{~V} \\leq v_{O} \\leq +14.1 \\mathrm{~V}$."
},
{
    "text": "We now employ the three-stage cascade depicted in Fig. 5.11 to determine the overall small-signal gain \\( a \\). By inspection,\n\n$$\n\\begin{align*}\na & =\\frac{v_{o}}{v_{i d}} \\cong\\left(-G_{m 1}\\right)\\left(R_{o 1} I / R_{i 2}\\right)\\left(-G_{m 2}\\right)\\left(R_{o 2} / / R_{i 3}\\right)=(-482) \\times(-501)  \\tag{5.22}\\\\\n& =241 \\times 10^{3} \\mathrm{~V} / \\mathrm{V}\n\\end{align*}\n$$\n\nThis indicates that the first two stages contribute gains of approximately \\( 500 \\mathrm{~V} / \\mathrm{V} \\) each. The 741 data sheets typically specify \\( R_{i d}=2 \\mathrm{M} \\Omega, a=200 \\times 10^{3} \\mathrm{~V} / \\mathrm{V} \\), and \\( R_{o}=75 \\Omega \\). Our calculations are influenced by the assumed values for the betas and the Early voltages, both of which are dependent on critical fabrication parameters like the base width. Additionally, assuming infinite Early voltages to simplify dc calculations may have led to an underestimation of dc currents by 20-30%, particularly for pnp BJTs. Finally, \\( R_{o} \\) depends on the operating current of \\( Q_{14} \\), which was arbitrarily assumed to be 2.5 mA.\n\n---\n\n**Image Description:**\n**FIGURE 5.11 Small-signal model of the 741 op amp.**\nThis figure illustrates the small-signal model of the 741 operational amplifier, detailing the internal resistance and transconductance stages. It includes:\n- **Rid**: Resistor, 2.19 MΩ, connected between Vid and GND.\n- **Gm1**: Voltage-controlled current source, GmVid, with ports Vi2 and GDD.\n- **Ro1**: Resistor, 6.12 MΩ, connected between V12 and GND.\n- **Ri2**: Resistor, 4.63 MΩ, connected between V12 and GND.\n- **Gm2**: Voltage-controlled current source, 1/161 Ω, with ports V23 and GND.\n- **Ro2**: Resistor, 81.3 kΩ, connected between V23 and GND.\n- **Ri3**: Resistor, 9.33 MΩ, connected between V23 and GND.\n- **Ro**: Resistor, 47 Ω, connected between V23 and Vo.\n- **Iv23**: Voltage-controlled voltage source, with ports V23 and Vo.\n\n**Extra Info:** This model demonstrates the interaction between voltage-controlled current sources and various resistors to simulate the op-amp's behavior.\n\n**FIGURE 5.11 Small-signal model of the 741 op amp**\nThis circuit represents the small-signal model of the 741 operational amplifier, featuring:\n- **VI**: Voltage source, VI, with ports VI and GND.\n- **μA741**: Op-amp, μA741, with ports InP (VI), InN (GND), OutP (Vo), OutN (GND), Vdd (VCC +15V), and -Vdd (VCC -15V).\n- **RL**: Resistor, 2kΩ, connected between Vo and GND.\n\n**Extra Info:** The circuit includes a voltage source VI, an op-amp μA741, and a load resistor RL. The op-amp is powered by a dual supply of +15V and -15V, with the output voltage Vo measured across the load resistor RL connected to ground.\n\n**(a)**\n**Image Description: (b)**\nThis graph depicts the Voltage Transfer Characteristic (VTC) for a 741 operational amplifier, plotting output voltage \\( v_o \\) in volts (V) against the differential input voltage \\( v_P - v_N \\) in microvolts (μV).\n\n1. **Type of Graph and Function:**\n   - The graph is a Voltage Transfer Characteristic (VTC) plot.\n\n2. **Axes Labels and Units:**\n   - The x-axis represents the differential input voltage \\( v_P - v_N \\) in microvolts (μV), ranging from -150 μV to 150 μV.\n   - The y-axis represents the output voltage \\( v_o \\) in volts (V), ranging from -15 V to 15 V.\n\n3. **Overall Behavior and Trends:**\n   - The graph exhibits a linear region where \\( v_o \\) increases with \\( v_P - v_N \\). This linear region is centered around 0 μV and extends approximately from -100 μV to 100 μV.\n   - Beyond this linear region, \\( v_o \\) saturates at approximately -15 V for input voltages less than -100 μV and at approximately 15 V for input voltages greater than 100 μV.\n\n4. **Key Features and Technical Details:**\n   - The slope of the linear region indicates the gain of the operational amplifier.\n   - The saturation levels reflect the supply voltage limits of the op-amp, approximately ±15 V.\n\n5. **Annotations and Specific Data Points:**\n   - The graph clearly marks the transition from the linear region to saturation, indicating the limits of linear operation for the op-amp.\n   - The center of the linear region is at 0 μV, typical for op-amp VTCs, signifying balanced input conditions.\n\n**(b)**\n\n**FIGURE 5.12 (a) PSpice circuit to display (b) the VTC of the 741 op amp.**\nThus, the discrepancies between the calculated values and those provided in the data sheets are not unexpected. Nevertheless, the mental exercise involved in estimating these parameters is undoubtedly educational and has likely helped dispel any initial intimidation we may have had."
},
{
    "text": "We now employ the three-stage cascade depicted in Fig. 5.11 to determine the overall small-signal gain \\( a \\). By inspection,\n\n$$\n\\begin{align*}\na & =\\frac{v_{o}}{v_{i d}} \\cong\\left(-G_{m 1}\\right)\\left(R_{o 1} I / R_{i 2}\\right)\\left(-G_{m 2}\\right)\\left(R_{o 2} / / R_{i 3}\\right)=(-482) \\times(-501)  \\tag{5.22}\\\\\n& =241 \\times 10^{3} \\mathrm{~V} / \\mathrm{V}\n\\end{align*}\n$$\n\nThis indicates that the first two stages contribute gains of approximately $500 \\mathrm{~V} / \\mathrm{V}$ each. The 741 data sheets typically specify $R_{i d}=2 \\mathrm{M} \\Omega, a=200 \\times 10^{3} \\mathrm{~V} / \\mathrm{V}$, and $R_{o}=75 \\Omega$. Our calculations are influenced by the assumed values for the betas and the Early voltages, both of which are dependent on critical fabrication parameters such as the base width. Additionally, assuming infinite Early voltages to simplify the dc calculations may have led to an underestimation of dc currents by as much as 20-30%, particularly for pnp BJTs. Finally, $R_{o}$ depends on the operating current of $Q_{14}$, which was arbitrarily assumed to be 2.5 mA.\n\nImage Description: FIGURE 5.11 Small-signal model of the 741 op amp.\n- The model includes:\n  - Resistor \\( R_{id} \\) with a value of 2.19 MΩ, connected between \\( V_{id} \\) and GND.\n  - Voltage-controlled current source \\( G_{m1} \\) with value \\( GmVid \\), connected between \\( V_{i2} \\) and GDD.\n  - Resistor \\( R_{o1} \\) with a value of 6.12 MΩ, connected between \\( V_{12} \\) and GND.\n  - Resistor \\( R_{i2} \\) with a value of 4.63 MΩ, connected between \\( V_{12} \\) and GND.\n  - Voltage-controlled current source \\( G_{m2} \\) with value \\( 1/161 \\) Ω, connected between \\( V_{23} \\) and GND.\n  - Resistor \\( R_{o2} \\) with a value of 81.3 kΩ, connected between \\( V_{23} \\) and GND.\n  - Resistor \\( R_{i3} \\) with a value of 9.33 MΩ, connected between \\( V_{23} \\) and GND.\n  - Resistor \\( R_{o} \\) with a value of 47 Ω, connected between \\( V_{23} \\) and \\( V_{o} \\).\n  - Voltage-controlled voltage source \\( I_{v23} \\), connected between \\( V_{23} \\) and \\( V_{o} \\).\n\nExtra Info: This is a small-signal model of the 741 operational amplifier, illustrating the internal resistance and transconductance stages. The model demonstrates the interaction between voltage-controlled current sources and various resistors to simulate the op-amp's behavior.\n\nImage Description: Small-signal model of the 741 op amp.\n- The circuit includes:\n  - Voltage source \\( V_{I} \\), connected between \\( V_{I} \\) and GND.\n  - Op-amp \\( \\mu A741 \\), with ports: InP connected to \\( V_{I} \\), InN connected to GND, OutP connected to \\( V_{o} \\), OutN connected to GND, Vdd connected to VCC (+15V), and -Vdd connected to VCC (-15V).\n  - Resistor \\( R_{L} \\) with a value of 2kΩ, connected between \\( V_{o} \\) and GND.\n\nExtra Info: This circuit represents a small-signal model of the 741 operational amplifier, including a voltage source \\( V_{I} \\), an op-amp \\( \\mu A741 \\), and a load resistor \\( R_{L} \\). The op-amp is powered by a dual supply of +15V and -15V, with the output voltage \\( V_{o} \\) taken across the load resistor \\( R_{L} \\) connected to ground.\n\n(a)\nImage Description: (b)\n- The graph depicts the Voltage Transfer Characteristic (VTC) for a 741 operational amplifier, plotting the output voltage \\( v_{o} \\) in volts (V) against the differential input voltage \\( v_{P} - v_{N} \\) in microvolts (µV).\n\n1. **Type of Graph and Function:**\n- The graph is a Voltage Transfer Characteristic (VTC) plot.\n\n2. **Axes Labels and Units:**\n- The x-axis represents the differential input voltage \\( v_{P} - v_{N} \\) in microvolts (µV), ranging from -150 µV to 150 µV.\n- The y-axis represents the output voltage \\( v_{o} \\) in volts (V), ranging from -15 V to 15 V.\n\n3. **Overall Behavior and Trends:**\n- The graph displays a linear region where the output voltage \\( v_{o} \\) increases with the input voltage \\( v_{P} - v_{N} \\). This linear region is centered around 0 µV and extends approximately from -100 µV to 100 µV.\n- Beyond this linear region, the output voltage saturates at approximately -15 V for input voltages less than -100 µV and at approximately 15 V for input voltages greater than 100 µV.\n\n4. **Key Features and Technical Details:**\n- The slope of the linear region represents the gain of the operational amplifier.\n- The saturation levels indicate the supply voltage limits of the op-amp, approximately ±15 V.\n\n5. **Annotations and Specific Data Points:**\n- The graph clearly illustrates the transition from the linear region to saturation, marking the limits of linear operation for the op-amp.\n- The center of the linear region is at 0 µV, which is typical for op-amp VTCs, indicating balanced input conditions.\n\n(b)\n\nFIGURE $\\mathbf{5 . 1 2}$ (a) PSpice circuit to display (b) the VTC of the 741 op amp.\nThus, the discrepancies between the calculated and data-sheet values are not surprising. Nevertheless, the mental process involved in estimating these parameters is undoubtedly quite instructive—and presumably it has helped demystify our initial intimidation."
},
{
    "text": "We now employ the three-stage cascade depicted in Fig. 5.11 to determine the overall small-signal gain \\( a \\). By inspection,\n\n$$\n\\begin{align*}\na & = \\frac{v_{o}}{v_{i d}} \\approx \\left(-G_{m 1}\\right)\\left(R_{o 1} // R_{i 2}\\right)\\left(-G_{m 2}\\right)\\left(R_{o 2} // R_{i 3}\\right) = (-482) \\times (-501) \\tag{5.22}\\\\\n& = 241 \\times 10^{3} \\mathrm{~V} / \\mathrm{V}\n\\end{align*}\n$$\n\nThis indicates that the first two stages contribute gains of approximately \\( 500 \\mathrm{~V} / \\mathrm{V} \\) each. The 741 data sheets typically specify \\( R_{i d} = 2 \\mathrm{M} \\Omega \\), \\( a = 200 \\times 10^{3} \\mathrm{~V} / \\mathrm{V} \\), and \\( R_{o} = 75 \\Omega \\). Our calculations are influenced by the assumed values for the betas and the Early voltages, both of which are dependent on critical fabrication parameters like the base width. Additionally, assuming infinite Early voltages to simplify dc calculations may have led to an underestimation of dc currents by 20-30%, particularly for pnp BJTs. Finally, \\( R_{o} \\) depends on the operating current of \\( Q_{14} \\), which was arbitrarily assumed to be 2.5 mA.\n\n---\n\n**Image Description: FIGURE 5.11 Small-signal model of the 741 op amp.**\n- **Components:**\n  - **Rid:** Resistor, 2.19 MΩ, connected between Vid and GND.\n  - **Gm1:** Voltage-controlled current source, GmVid, connected between Vi2 and GDD.\n  - **Ro1:** Resistor, 6.12 MΩ, connected between V12 and GND.\n  - **Ri2:** Resistor, 4.63 MΩ, connected between V12 and GND.\n  - **Gm2:** Voltage-controlled current source, 1/161 Ω, connected between V23 and GND.\n  - **Ro2:** Resistor, 81.3 kΩ, connected between V23 and GND.\n  - **Ri3:** Resistor, 9.33 MΩ, connected between V23 and GND.\n  - **Ro:** Resistor, 47 Ω, connected between V23 and Vo.\n  - **Iv23:** Voltage-controlled voltage source, connected between V23 and Vo.\n\n**Additional Info:** This model illustrates the internal resistance and transconductance stages of the 741 operational amplifier, showing the interaction between voltage-controlled current sources and various resistors to simulate the op-amp's behavior.\n\n**FIGURE 5.11 Small-signal model of the 741 op amp.**\n- **Components:**\n  - **VI:** Voltage source, VI, connected between VI and GND.\n  - **μA741:** Op-amp, μA741, with ports InP (VI), InN (GND), OutP (Vo), OutN (GND), Vdd (VCC(+15V)), and -Vdd (VCC(-15V)).\n  - **RL:** Resistor, 2kΩ, connected between Vo and GND.\n\n**Additional Info:** This circuit represents a small-signal model of the 741 operational amplifier, including a voltage source VI, an op-amp μA741, and a load resistor RL. The op-amp is powered by a dual supply of +15V and -15V, with the output voltage Vo measured across the load resistor RL connected to ground.\n\n**(a)**\n\n**Image Description: (b)**\n- **Graph Type:** Voltage Transfer Characteristic (VTC) for a 741 operational amplifier.\n- **Axes:**\n  - **X-axis:** Differential input voltage \\( v_P - v_N \\) in microvolts (μV), ranging from -150 μV to 150 μV.\n  - **Y-axis:** Output voltage \\( v_o \\) in volts (V), ranging from -15 V to 15 V.\n- **Behavior:** The graph exhibits a linear region where \\( v_o \\) increases with \\( v_P - v_N \\), centered around 0 μV and extending from -100 μV to 100 μV. Beyond this region, \\( v_o \\) saturates at approximately -15 V for input voltages less than -100 μV and at 15 V for input voltages greater than 100 μV.\n- **Key Features:** The slope of the linear region indicates the op-amp's gain, while the saturation levels reflect the supply voltage limits of ±15 V. The transition from linear to saturation regions is clearly marked, with the linear region's center at 0 μV, indicating balanced input conditions.\n\n**(b)**\n\n**FIGURE 5.12 (a) PSpice circuit to display (b) the VTC of the 741 op amp.**\n\nThus, the discrepancies between the calculated values and those provided in the data sheets are not unexpected. Nonetheless, the mental exercise involved in estimating these parameters is undoubtedly instructive and has likely helped demystify any initial intimidation."
},
{
    "text": "We utilize the three-stage cascade depicted in Fig. 5.11 to determine the overall small-signal gain \\( a \\). By inspection,\n\n$$\n\\begin{align*}\na & =\\frac{v_{o}}{v_{i d}} \\cong\\left(-G_{m 1}\\right)\\left(R_{o 1} I / R_{i 2}\\right)\\left(-G_{m 2}\\right)\\left(R_{o 2} / / R_{i 3}\\right)=(-482) \\times(-501)  \\tag{5.22}\\\\\n& =241 \\times 10^{3} \\mathrm{~V} / \\mathrm{V}\n\\end{align*}\n$$\n\nThis indicates that the first two stages contribute gains approximately $500 \\mathrm{~V} / \\mathrm{V}$ each. The 741 data sheets typically specify $R_{i d}=2 \\mathrm{M} \\Omega, a=200 \\times 10^{3} \\mathrm{~V} / \\mathrm{V}$, and $R_{o}=75 \\Omega$. Our calculations are influenced by the assumed values for the betas and Early voltages, which depend on critical fabrication parameters like the base width. Additionally, assuming infinite Early voltages to simplify dc calculations may have underestimated dc currents by 20-30%, particularly for pnp BJTs. Finally, $R_{o}$ depends on the operating current of $Q_{14}$, which was arbitrarily assumed to be 2.5 mA.\n\n---\n\n**Image Description: FIGURE 5.11 Small-signal model of the 741 op amp.**\n- **Components:**\n  - **Rid:** Resistor, 2.19 MΩ, connected between Vid and GND.\n  - **Gm1:** Voltage-controlled current source, GmVid, connected between Vi2 and GDD.\n  - **Ro1:** Resistor, 6.12 MΩ, connected between V12 and GND.\n  - **Ri2:** Resistor, 4.63 MΩ, connected between V12 and GND.\n  - **Gm2:** Voltage-controlled current source, 1/161 Ω, connected between V23 and GND.\n  - **Ro2:** Resistor, 81.3 kΩ, connected between V23 and GND.\n  - **Ri3:** Resistor, 9.33 MΩ, connected between V23 and GND.\n  - **Ro:** Resistor, 47 Ω, connected between V23 and Vo.\n  - **Iv23:** Voltage-controlled voltage source, connected between V23 and Vo.\n\n**Additional Info:** This model represents the 741 operational amplifier's small-signal characteristics, illustrating the interaction between voltage-controlled current sources and various resistors to simulate the op-amp's behavior.\n\n**FIGURE 5.11 Small-signal model of the 741 op amp.**\n- **Components:**\n  - **VI:** Voltage source, VI, connected between VI and GND.\n  - **μA741:** Op-amp, μA741, with ports InP (VI), InN (GND), OutP (Vo), OutN (GND), Vdd (VCC(+15V)), and -Vdd (VCC(-15V)).\n  - **RL:** Resistor, 2kΩ, connected between Vo and GND.\n\n**Additional Info:** This circuit is a small-signal model of the 741 operational amplifier, including a voltage source VI, an op-amp μA741, and a load resistor RL. The op-amp is powered by a dual supply of +15V and -15V, with the output voltage Vo measured across the load resistor RL connected to ground.\n\n**(a)**\n\n**Image Description: (b)**\n- **Graph Type and Function:** Voltage Transfer Characteristic (VTC) for a 741 operational amplifier.\n- **Axes Labels and Units:** \n  - X-axis: Differential input voltage \\( v_P - v_N \\) in microvolts (\\( \\mu V \\)), ranging from -150 \\( \\mu V \\) to 150 \\( \\mu V \\).\n  - Y-axis: Output voltage \\( v_o \\) in volts (V), ranging from -15 V to 15 V.\n- **Overall Behavior and Trends:** \n  - Linear region where \\( v_o \\) increases with \\( v_P - v_N \\), centered around 0 \\( \\mu V \\) and extending from -100 \\( \\mu V \\) to 100 \\( \\mu V \\).\n  - Beyond this region, \\( v_o \\) saturates at approximately -15 V for input voltages less than -100 \\( \\mu V \\) and at approximately 15 V for input voltages greater than 100 \\( \\mu V \\).\n- **Key Features and Technical Details:** \n  - Slope of the linear region represents the op-amp's gain.\n  - Saturation levels indicate the supply voltage limits, approximately \\( \\pm 15 \\) V.\n- **Annotations and Specific Data Points:** \n  - Clear transition from linear to saturation regions, marking the limits of linear operation.\n  - Center of the linear region at 0 \\( \\mu V \\), indicating balanced input conditions.\n\n**(b)**\n\n**FIGURE $\\mathbf{5 . 1 2}$ (a) PSpice circuit to display (b) the VTC of the 741 op amp.**\nThus, the discrepancies between calculated and data-sheet values are not surprising. Nevertheless, the mental exercise involved in estimating these parameters is undoubtedly instructive and has presumably helped demystify our initial intimidation."
},
{
    "text": "We now employ the three-stage cascade depicted in Fig. 5.11 to determine the overall small-signal gain, \\( a \\). By inspection,\n\n$$\n\\begin{align*}\na & = \\frac{v_{o}}{v_{i d}} \\approx \\left(-G_{m 1}\\right)\\left(R_{o 1} || R_{i 2}\\right)\\left(-G_{m 2}\\right)\\left(R_{o 2} || R_{i 3}\\right) = (-482) \\times (-501) \\tag{5.22}\\\\\n& = 241 \\times 10^{3} \\mathrm{~V} / \\mathrm{V}\n\\end{align*}\n$$\n\nThis indicates that the first two stages contribute gains of approximately \\( 500 \\mathrm{~V} / \\mathrm{V} \\) each. The 741 data sheets typically provide \\( R_{i d} = 2 \\mathrm{M} \\Omega \\), \\( a = 200 \\times 10^{3} \\mathrm{~V} / \\mathrm{V} \\), and \\( R_{o} = 75 \\Omega \\). Our calculations are influenced by the assumed values for the betas and the Early voltages, both of which are dependent on critical fabrication parameters such as the base width. Additionally, assuming infinite Early voltages to simplify the dc calculations may have led to an underestimation of dc currents by 20-30%, particularly for pnp BJTs. Finally, \\( R_{o} \\) depends on the operating current of \\( Q_{14} \\), which was arbitrarily assumed to be 2.5 mA.\n\nImage Description: FIGURE 5.11 Small-signal model of the 741 op amp.\n[\nname: Rid, type: Resistor, value: 2.19 MΩ, ports: {N1: Vid, N2: GND}\nname: Gm1, type: VoltageControlledCurrentSource, value: GmVid, ports: {Np: Vi2, Nn: GDD}\nname: Ro1, type: Resistor, value: 6.12 MΩ, ports: {N1: V12, N2: GND}\nname: Ri2, type: Resistor, value: 4.63 MΩ, ports: {N1: V12, N2: GND}\nname: Gm2, type: VoltageControlledCurrentSource, value: 1/161 Ω, ports: {Np: V23, Nn: GND}\nname: Ro2, type: Resistor, value: 81.3 kΩ, ports: {N1: V23, N2: GND}\nname: Ri3, type: Resistor, value: 9.33 MΩ, ports: {N1: V23, N2: GND}\nname: Ro, type: Resistor, value: 47 Ω, ports: {N1: V23, N2: Vo}\nname: Iv23, type: VoltageControlledVoltageSource, ports: {Np: V23, Nn: Vo}\n]\nExtra Info: This is a small-signal model of the 741 operational amplifier, illustrating the internal resistance and transconductance stages. The model shows the interaction between voltage-controlled current sources and various resistors to simulate the op-amp's behavior.\n\nFIGURE 5.11 Small-signal model of the 741 op amp.\nImage Name: Small-signal model of the 741 op amp\nDescription:\n[\nname: VI, type: VoltageSource, value: VI, ports: {Np: VI, Nn: GND}\nname: μA741, type: OpAmp, value: μA741, ports: {InP: VI, InN: GND, OutP: Vo, OutN: GND, Vdd: VCC(+15V), -Vdd: VCC(-15V)}\nname: RL, type: Resistor, value: 2kΩ, ports: {N1: Vo, N2: GND}\n]\nExtra Info: This circuit represents a small-signal model of the 741 operational amplifier, including a voltage source VI, an op-amp μA741, and a load resistor RL. The op-amp is powered by a dual supply of +15V and -15V, with the output voltage Vo measured across the load resistor RL connected to ground.\n\n(a)\nImage Name: (b)\nDescription: The graph illustrates the Voltage Transfer Characteristic (VTC) for a 741 operational amplifier, plotting the output voltage \\( v_o \\) in volts (V) against the differential input voltage \\( v_P - v_N \\) in microvolts (\\( \\mu V \\)).\n\n1. **Type of Graph and Function:**\n- The graph is a Voltage Transfer Characteristic (VTC) plot.\n\n2. **Axes Labels and Units:**\n- The x-axis represents the differential input voltage \\( v_P - v_N \\) in microvolts (\\( \\mu V \\)), ranging from -150 \\( \\mu V \\) to 150 \\( \\mu V \\).\n- The y-axis represents the output voltage \\( v_o \\) in volts (V), ranging from -15 V to 15 V.\n\n3. **Overall Behavior and Trends:**\n- The graph displays a linear region where the output voltage \\( v_o \\) increases with the input voltage \\( v_P - v_N \\). This linear region is centered around 0 \\( \\mu V \\) and extends approximately from -100 \\( \\mu V \\) to 100 \\( \\mu V \\).\n- Beyond this linear region, the output voltage saturates at around -15 V for input voltages less than -100 \\( \\mu V \\) and at around 15 V for input voltages greater than 100 \\( \\mu V \\).\n\n4. **Key Features and Technical Details:**\n- The slope of the linear region indicates the gain of the operational amplifier.\n- The saturation levels reflect the supply voltage limits of the op-amp, approximately \\( \\pm 15 \\) V.\n\n5. **Annotations and Specific Data Points:**\n- The graph clearly marks the transition from the linear region to saturation, indicating the limits of linear operation for the op-amp.\n- The center of the linear region is at 0 \\( \\mu V \\), typical for op-amp VTCs, signifying balanced input conditions.\n\n(b)\n\nFIGURE $\\mathbf{5 . 1 2}$ (a) PSpice circuit to display (b) the VTC of the 741 op amp.\nThus, the discrepancies between the calculated values and those provided in the data sheets are not unexpected. Nevertheless, the mental exercise involved in estimating these parameters is undoubtedly educational and has presumably helped to demystify our initial intimidation."
},
{
    "text": "We utilize the three-stage cascade depicted in Fig. 5.11 to determine the overall small-signal gain \\( a \\). By inspection,\n\n$$\n\\begin{align*}\na & =\\frac{v_{o}}{v_{i d}} \\cong\\left(-G_{m 1}\\right)\\left(R_{o 1} I / R_{i 2}\\right)\\left(-G_{m 2}\\right)\\left(R_{o 2} / / R_{i 3}\\right)=(-482) \\times(-501)  \\tag{5.22}\\\\\n& =241 \\times 10^{3} \\mathrm{~V} / \\mathrm{V}\n\\end{align*}\n$$\n\nThis indicates that the first two stages each contribute gains of approximately $500 \\mathrm{~V} / \\mathrm{V}$. The 741 data sheets typically specify $R_{i d}=2 \\mathrm{M} \\Omega, a=200 \\times 10^{3} \\mathrm{~V} / \\mathrm{V}$, and $R_{o}=75 \\Omega$. Our calculations are influenced by the assumed values for the betas and the Early voltages, both of which are dependent on critical fabrication parameters such as the base width. Additionally, assuming infinite Early voltages to simplify dc calculations may have led to an underestimation of dc currents by 20-30%, particularly for pnp BJTs. Finally, $R_{o}$ is dependent on the operating current of $Q_{14}$, which was arbitrarily assumed to be 2.5 mA.\n\nimage_name:FIGURE 5.11 Small-signal model of the 741 op amp.\ndescription:\n[\nname: Rid, type: Resistor, value: 2.19 MΩ, ports: {N1: Vid, N2: GND}\nname: Gm1, type: VoltageControlledCurrentSource, value: GmVid, ports: {Np: Vi2, Nn: GDD}\nname: Ro1, type: Resistor, value: 6.12 MΩ, ports: {N1: V12, N2: GND}\nname: Ri2, type: Resistor, value: 4.63 MΩ, ports: {N1: V12, N2: GND}\nname: Gm2, type: VoltageControlledCurrentSource, value: 1/161 Ω, ports: {Np: V23, Nn: GND}\nname: Ro2, type: Resistor, value: 81.3 kΩ, ports: {N1: V23, N2: GND}\nname: Ri3, type: Resistor, value: 9.33 MΩ, ports: {N1: V23, N2: GND}\nname: Ro, type: Resistor, value: 47 Ω, ports: {N1: V23, N2: Vo}\nname: Iv23, type: VoltageControlledVoltageSource, ports: {Np: V23, Nn: Vo}\n]\nextrainfo:This is a small-signal model of the 741 operational amplifier, illustrating the internal resistance and transconductance stages. The model demonstrates the interaction between voltage-controlled current sources and various resistors to simulate the op-amp's behavior.\n\nFIGURE 5.11 Small-signal model of the 741 op amp.\nimage_name:Small-signal model of the 741 op amp\ndescription:\n[\nname: VI, type: VoltageSource, value: VI, ports: {Np: VI, Nn: GND}\nname: μA741, type: OpAmp, value: μA741, ports: {InP: VI, InN: GND, OutP: Vo, OutN: GND, Vdd: VCC(+15V), -Vdd: VCC(-15V)}\nname: RL, type: Resistor, value: 2kΩ, ports: {N1: Vo, N2: GND}\n]\nextrainfo:This circuit represents a small-signal model of the 741 operational amplifier, including a voltage source VI, an op-amp μA741, and a load resistor RL. The op-amp is powered by a dual supply of +15V and -15V, with the output voltage Vo measured across the load resistor RL connected to ground.\n\n(a)\nimage_name:(b)\ndescription:The depicted graph is a Voltage Transfer Characteristic (VTC) for a 741 operational amplifier, plotting the output voltage \\( v_o \\) in volts (V) against the differential input voltage \\( v_P - v_N \\) in microvolts (\\( \\mu V \\)).\n\n1. **Type of Graph and Function:**\n- The graph is a Voltage Transfer Characteristic (VTC) plot.\n\n2. **Axes Labels and Units:**\n- The x-axis represents the differential input voltage \\( v_P - v_N \\) in microvolts (\\( \\mu V \\)), ranging from -150 \\( \\mu V \\) to 150 \\( \\mu V \\).\n- The y-axis represents the output voltage \\( v_o \\) in volts (V), ranging from -15 V to 15 V.\n\n3. **Overall Behavior and Trends:**\n- The graph exhibits a linear region where the output voltage \\( v_o \\) increases with the input voltage \\( v_P - v_N \\). This linear region is centered around 0 \\( \\mu V \\) and extends roughly from -100 \\( \\mu V \\) to 100 \\( \\mu V \\).\n- Beyond this linear region, the output voltage saturates at approximately -15 V for input voltages below -100 \\( \\mu V \\) and at approximately 15 V for input voltages above 100 \\( \\mu V \\).\n\n4. **Key Features and Technical Details:**\n- The slope of the linear region represents the gain of the operational amplifier.\n- The saturation levels indicate the supply voltage limits of the op-amp, approximately \\( \\pm 15 \\) V.\n\n5. **Annotations and Specific Data Points:**\n- The graph clearly delineates the transition from the linear region to saturation, marking the boundaries of linear operation for the op-amp.\n- The center of the linear region is at 0 \\( \\mu V \\), which is typical for op-amp VTCs, indicating balanced input conditions.\n\n(b)\n\nFIGURE $\\mathbf{5 . 1 2}$ (a) PSpice circuit to display (b) the VTC of the 741 op amp.\nThus, the discrepancies between the calculated values and those provided in the data sheets are not unexpected. Nevertheless, the mental exercise involved in estimating these parameters is undoubtedly educational and has likely helped dispel any initial intimidation."
},
{
    "text": "We utilize the three-stage cascade depicted in Fig. 5.11 to determine the overall small-signal gain \\( a \\). By inspection,\n\n$$\n\\begin{align*}\na & = \\frac{v_{o}}{v_{i d}} \\approx \\left(-G_{m 1}\\right)\\left(R_{o 1} // R_{i 2}\\right)\\left(-G_{m 2}\\right)\\left(R_{o 2} // R_{i 3}\\right) = (-482) \\times (-501) \\tag{5.22}\\\\\n& = 241 \\times 10^{3} \\mathrm{~V} / \\mathrm{V}\n\\end{align*}\n$$\n\nThis indicates that the first two stages contribute gains of approximately \\( 500 \\mathrm{~V} / \\mathrm{V} \\) each. The 741 data sheets typically specify \\( R_{i d} = 2 \\mathrm{M} \\Omega \\), \\( a = 200 \\times 10^{3} \\mathrm{~V} / \\mathrm{V} \\), and \\( R_{o} = 75 \\Omega \\). Our calculations are influenced by the assumed values for the betas and the Early voltages, both of which are dependent on critical fabrication parameters like the base width. Additionally, assuming infinite Early voltages to simplify dc calculations may have led to an underestimation of dc currents by 20-30%, particularly for pnp BJTs. Lastly, \\( R_{o} \\) depends on the operating current of \\( Q_{14} \\), which was arbitrarily assumed to be 2.5 mA.\n\n---\n\n**FIGURE 5.11 Small-signal model of the 741 op amp.**\n\n**Description:**\n- **Rid:** Resistor, 2.19 MΩ, connected between Vid and GND.\n- **Gm1:** Voltage-controlled current source, GmVid, connected between Vi2 and GDD.\n- **Ro1:** Resistor, 6.12 MΩ, connected between V12 and GND.\n- **Ri2:** Resistor, 4.63 MΩ, connected between V12 and GND.\n- **Gm2:** Voltage-controlled current source, 1/161 Ω, connected between V23 and GND.\n- **Ro2:** Resistor, 81.3 kΩ, connected between V23 and GND.\n- **Ri3:** Resistor, 9.33 MΩ, connected between V23 and GND.\n- **Ro:** Resistor, 47 Ω, connected between V23 and Vo.\n- **Iv23:** Voltage-controlled voltage source, connected between V23 and Vo.\n\n**Extra Info:** This model represents the 741 operational amplifier's small-signal characteristics, illustrating the interaction between voltage-controlled current sources and various resistors to simulate the op-amp's behavior.\n\n**FIGURE 5.11 Small-signal model of the 741 op amp**\n\n**Description:**\n- **VI:** Voltage source, VI, connected between VI and GND.\n- **μA741:** Op-amp, μA741, with ports InP (VI), InN (GND), OutP (Vo), OutN (GND), Vdd (VCC(+15V)), and -Vdd (VCC(-15V)).\n- **RL:** Resistor, 2kΩ, connected between Vo and GND.\n\n**Extra Info:** This circuit is a small-signal model of the 741 operational amplifier, including a voltage source VI, an op-amp μA741, and a load resistor RL. The op-amp is powered by a dual supply of +15V and -15V, with the output voltage Vo measured across the load resistor RL connected to ground.\n\n**(a)**\n\n**FIGURE (b)**\n\n**Description:** The graph depicts the Voltage Transfer Characteristic (VTC) for a 741 operational amplifier, plotting the output voltage \\( v_o \\) in volts (V) against the differential input voltage \\( v_P - v_N \\) in microvolts (\\( \\mu V \\)).\n\n1. **Type of Graph and Function:**\n   - The graph is a Voltage Transfer Characteristic (VTC) plot.\n\n2. **Axes Labels and Units:**\n   - The x-axis represents the differential input voltage \\( v_P - v_N \\) in microvolts (\\( \\mu V \\)), ranging from -150 \\( \\mu V \\) to 150 \\( \\mu V \\).\n   - The y-axis represents the output voltage \\( v_o \\) in volts (V), ranging from -15 V to 15 V.\n\n3. **Overall Behavior and Trends:**\n   - The graph exhibits a linear region where the output voltage \\( v_o \\) increases with the input voltage \\( v_P - v_N \\). This linear region is centered around 0 \\( \\mu V \\) and extends approximately from -100 \\( \\mu V \\) to 100 \\( \\mu V \\).\n   - Beyond this linear region, the output voltage saturates at approximately -15 V for input voltages less than -100 \\( \\mu V \\) and at approximately 15 V for input voltages greater than 100 \\( \\mu V \\).\n\n4. **Key Features and Technical Details:**\n   - The slope of the linear region represents the gain of the operational amplifier.\n   - The saturation levels indicate the supply voltage limits of the op-amp, approximately \\( \\pm 15 \\) V.\n\n5. **Annotations and Specific Data Points:**\n   - The graph clearly illustrates the transition from the linear region to saturation, marking the limits of linear operation for the op-amp.\n   - The center of the linear region is at 0 \\( \\mu V \\), which is typical for op-amp VTCs, indicating balanced input conditions.\n\n**(b)**\n\n**FIGURE \\( \\mathbf{5.12} \\)** (a) PSpice circuit to display (b) the VTC of the 741 op amp.\n\nThus, the discrepancies between the calculated values and those provided in the data sheets are not surprising. Nevertheless, the mental process involved in estimating these parameters is undoubtedly instructive and has presumably helped demystify our initial intimidation."
},
{
    "text": "We now employ the three-stage cascade depicted in Fig. 5.11 to determine the overall small-signal gain, \\(a\\). By inspection,\n\n$$\n\\begin{align*}\na & =\\frac{v_{o}}{v_{i d}} \\approx \\left(-G_{m 1}\\right)\\left(R_{o 1} I / R_{i 2}\\right)\\left(-G_{m 2}\\right)\\left(R_{o 2} / / R_{i 3}\\right)=(-482) \\times(-501)  \\tag{5.22}\\\\\n& =241 \\times 10^{3} \\mathrm{~V} / \\mathrm{V}\n\\end{align*}\n$$\n\nThis indicates that the first two stages contribute gains of approximately \\(500 \\mathrm{~V} / \\mathrm{V}\\) each. The 741 data sheets typically specify \\(R_{i d}=2 \\mathrm{M} \\Omega\\), \\(a=200 \\times 10^{3} \\mathrm{~V} / \\mathrm{V}\\), and \\(R_{o}=75 \\Omega\\). Our calculations are influenced by the assumed values for the betas and Early voltages, both of which are dependent on critical fabrication parameters like the base width. Additionally, assuming infinite Early voltages to simplify DC calculations may have led to an underestimation of DC currents by 20-30%, particularly for pnp BJTs. Lastly, \\(R_{o}\\) depends on the operating current of \\(Q_{14}\\), which was arbitrarily assumed to be 2.5 mA.\n\nimage_name:FIGURE 5.11 Small-signal model of the 741 op amp.\ndescription:\n[\nname: Rid, type: Resistor, value: 2.19 MΩ, ports: {N1: Vid, N2: GND}\nname: Gm1, type: VoltageControlledCurrentSource, value: GmVid, ports: {Np: Vi2, Nn: GDD}\nname: Ro1, type: Resistor, value: 6.12 MΩ, ports: {N1: V12, N2: GND}\nname: Ri2, type: Resistor, value: 4.63 MΩ, ports: {N1: V12, N2: GND}\nname: Gm2, type: VoltageControlledCurrentSource, value: 1/161 Ω, ports: {Np: V23, Nn: GND}\nname: Ro2, type: Resistor, value: 81.3 kΩ, ports: {N1: V23, N2: GND}\nname: Ri3, type: Resistor, value: 9.33 MΩ, ports: {N1: V23, N2: GND}\nname: Ro, type: Resistor, value: 47 Ω, ports: {N1: V23, N2: Vo}\nname: Iv23, type: VoltageControlledVoltageSource, ports: {Np: V23, Nn: Vo}\n]\nextrainfo:This is a small-signal model of the 741 operational amplifier, illustrating the internal resistance and transconductance stages. The model depicts the interaction between voltage-controlled current sources and various resistors to simulate the op-amp's behavior.\n\nFIGURE 5.11 Small-signal model of the 741 op amp.\nimage_name:Small-signal model of the 741 op amp\ndescription:\n[\nname: VI, type: VoltageSource, value: VI, ports: {Np: VI, Nn: GND}\nname: μA741, type: OpAmp, value: μA741, ports: {InP: VI, InN: GND, OutP: Vo, OutN: GND, Vdd: VCC(+15V), -Vdd: VCC(-15V)}\nname: RL, type: Resistor, value: 2kΩ, ports: {N1: Vo, N2: GND}\n]\nextrainfo:This circuit represents a small-signal model of the 741 operational amplifier. It includes a voltage source VI, an op-amp μA741, and a load resistor RL. The op-amp is powered by a dual supply of +15V and -15V. The output voltage Vo is measured across the load resistor RL connected to ground.\n\n(a)\nimage_name:(b)\ndescription:The graph shown is a Voltage Transfer Characteristic (VTC) for a 741 operational amplifier. It plots the output voltage \\( v_o \\) in volts (V) against the differential input voltage \\( v_P - v_N \\) in microvolts (\\( \\mu V \\)).\n\n1. **Type of Graph and Function:**\n- The graph is a Voltage Transfer Characteristic (VTC) plot.\n\n2. **Axes Labels and Units:**\n- The x-axis represents the differential input voltage \\( v_P - v_N \\) in microvolts (\\( \\mu V \\)), ranging from -150 \\( \\mu V \\) to 150 \\( \\mu V \\).\n- The y-axis represents the output voltage \\( v_o \\) in volts (V), ranging from -15 V to 15 V.\n\n3. **Overall Behavior and Trends:**\n- The graph displays a linear region where the output voltage \\( v_o \\) increases with the input voltage \\( v_P - v_N \\). This linear region is centered around 0 \\( \\mu V \\) and extends approximately from -100 \\( \\mu V \\) to 100 \\( \\mu V \\).\n- Beyond this linear region, the output voltage saturates at approximately -15 V for input voltages less than -100 \\( \\mu V \\) and at approximately 15 V for input voltages greater than 100 \\( \\mu V \\).\n\n4. **Key Features and Technical Details:**\n- The slope of the linear region represents the gain of the operational amplifier.\n- The saturation levels indicate the supply voltage limits of the op-amp, approximately \\( \\pm 15 \\) V.\n\n5. **Annotations and Specific Data Points:**\n- The graph clearly marks the transition from the linear region to saturation, indicating the limits of linear operation for the op-amp.\n- The center of the linear region is at 0 \\( \\mu V \\), which is typical for op-amp VTCs, signifying balanced input conditions.\n\n(b)\n\nFIGURE $\\mathbf{5 . 1 2}$ (a) PSpice circuit to display (b) the VTC of the 741 op amp.\nThus, the discrepancies between the calculated values and those provided in the data sheets are not unexpected. Nonetheless, the mental exercise involved in estimating these parameters is undoubtedly educational and has presumably helped dispel our initial intimidation."
},
{
    "text": "The classic CMOS operational amplifier topology, along with its variants, is particularly prevalent in mixed-mode integrated circuits. Illustrated in its fundamental configuration in Fig. 5.13, it consists of two gain stages and a direct current (dc) biasing circuit, detailed as follows:\n\n- The initial or input stage is composed of the $p$-channel differential pair $M_{1}-M_{2}$ and the $n$-channel mirror load $M_{3}-M_{4}$. As previously discussed, its voltage gain is given by\n\n$$\n\\begin{equation*}\na_{1}=-g_{m 1}\\left(r_{o 2} / / r_{o 4}\\right) \\tag{5.23}\n\\end{equation*}\n$$\n\nimage_name:Figure 5.13 Two-stage CMOS op amp\ndescription:\n[\nname: M1, type: PMOS, ports: {S: x3, D: x2, G: vN}\nname: M2, type: PMOS, ports: {S: x3, D: x1, G: vP}\nname: M3, type: NMOS, ports: {S: Vss, D: x2, G: x2}\nname: M4, type: NMOS, ports: {S: GND, D: x1, G: x2}\nname: M5, type: NMOS, ports: {S: Vss, D: vO, G: x1}\nname: M6, type: PMOS, ports: {S: VDD, D: vO, G: x4}\nname: M7, type: PMOS, ports: {S: VDD, D: x3, G: x4}\nname: M8, type: PMOS, ports: {S: VDD, D: x4, G: x4}\nname: I_REF, type: CurrentSource, ports: {Np: x4, Nn: VSS}\nname: R_C, type: Resistor, value: R_C, ports: {N1: x1, N2: RC}\nname: C_C, type: Capacitor, value: C_C, ports: {Np: RC, Nn: vO}\n]\nextrainfo:The circuit is a two-stage CMOS operational amplifier with a differential input stage and a common-source output stage. It includes a compensation network with R_C and C_C for stability.\n\nFIGURE 5.13 Two-stage CMOS op amp.\n\n- The second or output stage includes the common-source (CS) amplifier $M_{5}$ and the active load $M_{6}$. (Additionally, an $R_{c}-C_{c}$ network is shown, which serves to stabilize the amplifier against potential oscillations during negative-feedback operation, a topic covered in Chapter 7. For the current analysis, which is limited to low frequencies where $C_{c}$ behaves as an open circuit, the $R_{c}-C_{c}$ network will be disregarded.) The low-frequency voltage gain of this stage is\n\n$$\n\\begin{equation*}\na_{2}=-g_{m 5}\\left(r_{o 5} / / r_{o 6}\\right) \\tag{5.24}\n\\end{equation*}\n$$\n\n- The dc biasing circuit comprises the dual-output current mirror $M_{6}-M_{7}-M_{8}$, along with the $I_{R E F}$ current reference. While the specifics of this reference are omitted for simplicity, it is typically a shared circuit among various op amps on the same chip. It generates a regulated current $I_{R E F}$, which is then duplicated by a multiple-output current mirror to each of the other on-chip op amps. In Fig. 5.13, $I_{R E F}$ is replicated by $M_{7}$ to bias the $M_{1}-M_{2}$ pair and by $M_{6}$ to actively load the CS stage $M_{5}$. Due to the infinite resistance at $M_{5}$'s gate, there is no inter-stage loading, resulting in the overall gain being simply the product of the individual gains:\n\n$$\n\\begin{equation*}\na=\\frac{v_{o}}{v_{p}-v_{n}}=a_{1} \\times a_{2}=g_{m 1}\\left(r_{o 2} / / r_{o 4}\\right) g_{m 5}\\left(r_{o 5} / / r_{o 6}\\right) \\tag{5.25a}\n\\end{equation*}\n$$\n\nBy adapting Eq. (4.152) to this scenario, we can express the gain in an insightful alternative form:\n\n$$\n\\begin{equation*}\na=\\frac{2}{V_{O V 1}\\left(\\lambda_{2}+\\lambda_{4}\\right)} \\times \\frac{2}{V_{O V 5}\\left(\\lambda_{5}+\\lambda_{6}\\right)} \\tag{5.25b}\n\\end{equation*}\n$$\n\nIf the op amp is constructed with FETs having identical channel length $L$ and overdrive voltage $V_{O V}$, the gain can be succinctly expressed as:\n\n$$\n\\begin{equation*}\na=\\left[\\frac{2 L}{V_{O V}\\left(\\lambda_{n}^{\\prime}+\\lambda_{p}^{\\prime}\\right)}\\right]^{2} \\tag{5.25c}\n\\end{equation*}\n$$\n\nHere, according to Eq. (4.31), $\\lambda_{n}^{\\prime}$ and $\\lambda_{p}^{\\prime}$ are the process parameters that describe channel-length modulation in the $n$ FETs and $p$ FETs, respectively. Clearly, longer $L$ and lower $V_{O V}$ result in higher gain. The alternating current (ac) resistances between the two inputs and between the output and ground are, respectively,\n\n$$\n\\begin{equation*}\nR_{i}=\\infty \\quad R_{o}=r_{o 5} / / r_{o 6} \\tag{5.26}\n\\end{equation*}\n$$\n\nWe observe a strong similarity between the CMOS stages in Fig. 5.13 and the first and second stages of the 741 op amp in Fig. 5.2. In fact, due to the infinite resistance at the gates, the CMOS stages are significantly simpler. We also note the absence of an output stage, even though $R_{o}$ can be quite high. Typically, an op amp of the type shown in Fig. 5.13 is designed to drive other on-chip CMOS circuits that also present infinite input resistance (though not necessarily zero capacitance), eliminating the need for a dedicated output stage. A dedicated third stage is only added when the op amp is intended to drive resistive loads, usually off-chip, and this might be an output stage as discussed in Section 4.11."
},
{
    "text": "This traditional CMOS operational amplifier configuration (and its variants) is particularly prevalent in mixed-mode integrated circuits. Illustrated in its fundamental form in Fig. 5.13, it consists of two gain stages and a DC biasing circuit, detailed as follows:\n\n- The first or input stage is composed of the $p$-channel differential pair $M_{1}-M_{2}$ and the $n$-channel mirror load $M_{3}-M_{4}$. As known, its voltage gain is\n\n$$\n\\begin{equation*}\na_{1}=-g_{m 1}\\left(r_{o 2} / / r_{o 4}\\right) \\tag{5.23}\n\\end{equation*}\n$$\n\nimage_name:Figure 5.13 Two-stage CMOS op amp\ndescription:\n[\nname: M1, type: PMOS, ports: {S: x3, D: x2, G: vN}\nname: M2, type: PMOS, ports: {S: x3, D: x1, G: vP}\nname: M3, type: NMOS, ports: {S: Vss, D: x2, G: x2}\nname: M4, type: NMOS, ports: {S: GND, D: x1, G: x2}\nname: M5, type: NMOS, ports: {S: Vss, D: vO, G: x1}\nname: M6, type: PMOS, ports: {S: VDD, D: vO, G: x4}\nname: M7, type: PMOS, ports: {S: VDD, D: x3, G: x4}\nname: M8, type: PMOS, ports: {S: VDD, D: x4, G: x4}\nname: I_REF, type: CurrentSource, ports: {Np: x4, Nn: VSS}\nname: R_C, type: Resistor, value: R_C, ports: {N1: x1, N2: RC}\nname: C_C, type: Capacitor, value: C_C, ports: {Np: RC, Nn: vO}\n]\nextrainfo:The circuit is a two-stage CMOS operational amplifier featuring a differential input stage and a common-source output stage. It incorporates a compensation network with R_C and C_C for stability.\n\nFIGURE 5.13 Two-stage CMOS op amp.\n\n- The second or output stage includes the CS amplifier $M_{5}$ and the active load $M_{6}$. (Also depicted is an $R_{c}-C_{c}$ network, which serves to stabilize the amplifier against potential oscillations during negative-feedback operation, a topic covered in Chapter 7. The current analysis is limited to low frequencies, where $C_{c}$ acts as an open circuit, thus the $R_{c}-C_{c}$ network is disregarded.) The low-frequency voltage gain of this stage is\n\n$$\n\\begin{equation*}\na_{2}=-g_{m 5}\\left(r_{o 5} / / r_{o 6}\\right) \\tag{5.24}\n\\end{equation*}\n$$\n\n- The DC biasing circuit comprises the dual-output current mirror $M_{6}-M_{7}-M_{8}$, along with the $I_{R E F}$ current reference. The specifics of this reference are omitted for simplicity, but it is typically a shared circuit among various op amps on the same chip. It generates a regulated current $I_{R E F}$ once, which is then duplicated by a multiple-output current mirror to each of the other on-chip op amps. In Fig. 5.13, $I_{R E F}$ is duplicated by $M_{7}$ to bias the $M_{1}-M_{2}$ pair, and by $M_{6}$ to actively load the CS stage $M_{5}$. Thanks to the infinite resistance at $M_{5}$'s gate, there is no inter-stage loading, so the overall gain is simply the product of the individual gains\n\n$$\n\\begin{equation*}\na=\\frac{v_{o}}{v_{p}-v_{n}}=a_{1} \\times a_{2}=g_{m 1}\\left(r_{o 2} / / r_{o 4}\\right) g_{m 5}\\left(r_{o 5} / / r_{o 6}\\right) \\tag{5.25a}\n\\end{equation*}\n$$\n\nModifying Eq. (4.152) for the current scenario, we express the gain in an insightful alternative form\n\n$$\n\\begin{equation*}\na=\\frac{2}{V_{O V 1}\\left(\\lambda_{2}+\\lambda_{4}\\right)} \\times \\frac{2}{V_{O V 5}\\left(\\lambda_{5}+\\lambda_{6}\\right)} \\tag{5.25b}\n\\end{equation*}\n$$\n\nIf the op amp is implemented with FETs having identical channel length $L$ and overdrive voltage $V_{O V}$, the gain simplifies to\n\n$$\n\\begin{equation*}\na=\\left[\\frac{2 L}{V_{O V}\\left(\\lambda_{n}^{\\prime}+\\lambda_{p}^{\\prime}\\right)}\\right]^{2} \\tag{5.25c}\n\\end{equation*}\n$$\n\nwhere, according to Eq. (4.31), $\\lambda_{n}^{\\prime}$ and $\\lambda_{p}^{\\prime}$ are the process parameters describing channel-length modulation in the $n$ FETs and $p$ FETs, respectively. Clearly, a longer $L$ and a lower $V_{O V}$ result in higher gain. The AC resistances between the two inputs and between the output and ground are, respectively,\n\n$$\n\\begin{equation*}\nR_{i}=\\infty \\quad R_{o}=r_{o 5} / / r_{o 6} \\tag{5.26}\n\\end{equation*}\n$$\n\nWe observe a strong similarity between the CMOS stages of Fig. 5.13 and the first and second stages of the 741 op amp in Fig. 5.2. In fact, due to the infinite resistance at the gates, the CMOS stages are significantly simpler. We also note the absence of an output stage, even though $R_{o}$ can be quite high. Typically, an op amp of the type shown in Fig. 5.13 is designed to drive other on-chip CMOS circuits that also present infinite input resistance (though not necessarily zero capacitance), eliminating the need for a dedicated output stage. Only when intended to drive resistive loads, usually off-chip, will a two-stage op amp be fitted with a dedicated third stage. This might be an output stage of the type discussed in Section 4.11."
},
{
    "text": "This timeless CMOS operational amplifier configuration, along with its variants, is particularly prevalent in mixed-mode integrated circuits. Illustrated in its fundamental form in Fig. 5.13, it encompasses two gain stages and a DC biasing circuit as detailed below:\n\n- The initial or input stage is composed of the $p$-channel differential pair $M_{1}-M_{2}$ and the $n$-channel mirror load $M_{3}-M_{4}$. As previously discussed, its voltage gain is given by\n\n$$\n\\begin{equation*}\na_{1}=-g_{m 1}\\left(r_{o 2} / / r_{o 4}\\right) \\tag{5.23}\n\\end{equation*}\n$$\n\nimage_name:Figure 5.13 Two-stage CMOS op amp\ndescription:\n[\nname: M1, type: PMOS, ports: {S: x3, D: x2, G: vN}\nname: M2, type: PMOS, ports: {S: x3, D: x1, G: vP}\nname: M3, type: NMOS, ports: {S: Vss, D: x2, G: x2}\nname: M4, type: NMOS, ports: {S: GND, D: x1, G: x2}\nname: M5, type: NMOS, ports: {S: Vss, D: vO, G: x1}\nname: M6, type: PMOS, ports: {S: VDD, D: vO, G: x4}\nname: M7, type: PMOS, ports: {S: VDD, D: x3, G: x4}\nname: M8, type: PMOS, ports: {S: VDD, D: x4, G: x4}\nname: I_REF, type: CurrentSource, ports: {Np: x4, Nn: VSS}\nname: R_C, type: Resistor, value: R_C, ports: {N1: x1, N2: RC}\nname: C_C, type: Capacitor, value: C_C, ports: {Np: RC, Nn: vO}\n]\nextrainfo:The circuit is a two-stage CMOS operational amplifier with a differential input stage and a common-source output stage. It includes a compensation network with R_C and C_C for stability.\n\nFIGURE 5.13 Two-stage CMOS op amp.\n\n- The secondary or output stage features the CS amplifier $M_{5}$ and the active load $M_{6}$. (Also depicted is an $R_{c}-C_{c}$ network, which serves to stabilize the amplifier against potential oscillations during negative-feedback operation, a topic covered in Chapter 7. The current analysis is confined to low frequencies, where $C_{c}$ behaves as an open circuit, hence the $R_{c}-C_{c}$ network is disregarded.) The low-frequency voltage gain of this stage is\n\n$$\n\\begin{equation*}\na_{2}=-g_{m 5}\\left(r_{o 5} / / r_{o 6}\\right) \\tag{5.24}\n\\end{equation*}\n$$\n\n- The DC biasing circuit includes the dual-output current mirror $M_{6}-M_{7}-M_{8}$, along with the $I_{R E F}$ current reference. The specifics of this reference are omitted for simplicity, but it typically constitutes a circuit shared among various op amps on the same chip. It generates a regulated current $I_{R E F}$, which is then duplicated by a multiple-output current mirror to each of the other on-chip op amps. In Fig. 5.13, $I_{R E F}$ is replicated by $M_{7}$ to bias the $M_{1}-M_{2}$ pair, and by $M_{6}$ to actively load the CS stage $M_{5}$. Thanks to the infinite resistance at $M_{5}$'s gate, there is no inter-stage loading, so the overall gain is simply the product of the individual gains:\n\n$$\n\\begin{equation*}\na=\\frac{v_{o}}{v_{p}-v_{n}}=a_{1} \\times a_{2}=g_{m 1}\\left(r_{o 2} / / r_{o 4}\\right) g_{m 5}\\left(r_{o 5} / / r_{o 6}\\right) \\tag{5.25a}\n\\end{equation*}\n$$\n\nBy adapting Eq. (4.152) to this scenario, we can express the gain in an insightful alternative form:\n\n$$\n\\begin{equation*}\na=\\frac{2}{V_{O V 1}\\left(\\lambda_{2}+\\lambda_{4}\\right)} \\times \\frac{2}{V_{O V 5}\\left(\\lambda_{5}+\\lambda_{6}\\right)} \\tag{5.25b}\n\\end{equation*}\n$$\n\nIf the op amp is implemented with FETs having identical channel length $L$ and overdrive voltage $V_{O V}$, the gain simplifies to:\n\n$$\n\\begin{equation*}\na=\\left[\\frac{2 L}{V_{O V}\\left(\\lambda_{n}^{\\prime}+\\lambda_{p}^{\\prime}\\right)}\\right]^{2} \\tag{5.25c}\n\\end{equation*}\n$$\n\nHere, as per Eq. (4.31), $\\lambda_{n}^{\\prime}$ and $\\lambda_{p}^{\\prime}$ are the process parameters that describe channel-length modulation in the $n$ FETs and $p$ FETs, respectively. Clearly, a longer $L$ and a lower $V_{O V}$ result in higher gain. The AC resistances between the two inputs and between the output and ground are, respectively:\n\n$$\n\\begin{equation*}\nR_{i}=\\infty \\quad R_{o}=r_{o 5} / / r_{o 6} \\tag{5.26}\n\\end{equation*}\n$$\n\nWe observe a striking similarity between the CMOS stages of Fig. 5.13 and the first and second stages of the 741 op amp in Fig. 5.2. In fact, due to the infinite resistance at the gates, the CMOS stages are significantly simpler. We also note the absence of an output stage, even though $R_{o}$ can be quite high. Typically, an op amp of the type shown in Fig. 5.13 is intended to drive other on-chip CMOS circuits that also present infinite input resistance (though not necessarily zero capacitance), thus obviating the need for a dedicated output stage. Only when designed to drive resistive loads, usually off-chip, will a two-stage op amp be fitted with a dedicated third stage. This might be an output stage of the type discussed in Section 4.11."
},
{
    "text": "This traditional CMOS operational amplifier configuration, along with its variants, is particularly employed in mixed-mode integrated circuits. Illustrated in its fundamental form in Fig. 5.13, it consists of two gain stages and a DC biasing circuit as detailed below:\n\n- The initial or input stage is composed of the $p$-channel differential pair $M_{1}-M_{2}$ and the $n$-channel mirror load $M_{3}-M_{4}$. As known, its voltage gain is given by\n\n$$\n\\begin{equation*}\na_{1}=-g_{m 1}\\left(r_{o 2} / / r_{o 4}\\right) \\tag{5.23}\n\\end{equation*}\n$$\n\nimage_name:Figure 5.13 Two-stage CMOS op amp\ndescription:\n[\nname: M1, type: PMOS, ports: {S: x3, D: x2, G: vN}\nname: M2, type: PMOS, ports: {S: x3, D: x1, G: vP}\nname: M3, type: NMOS, ports: {S: Vss, D: x2, G: x2}\nname: M4, type: NMOS, ports: {S: GND, D: x1, G: x2}\nname: M5, type: NMOS, ports: {S: Vss, D: vO, G: x1}\nname: M6, type: PMOS, ports: {S: VDD, D: vO, G: x4}\nname: M7, type: PMOS, ports: {S: VDD, D: x3, G: x4}\nname: M8, type: PMOS, ports: {S: VDD, D: x4, G: x4}\nname: I_REF, type: CurrentSource, ports: {Np: x4, Nn: VSS}\nname: R_C, type: Resistor, value: R_C, ports: {N1: x1, N2: RC}\nname: C_C, type: Capacitor, value: C_C, ports: {Np: RC, Nn: vO}\n]\nextrainfo:The circuit is a two-stage CMOS operational amplifier with a differential input stage and a common-source output stage. It includes a compensation network with R_C and C_C for stability.\n\nFIGURE 5.13 Two-stage CMOS op amp.\n\n- The second or output stage includes the CS amplifier $M_{5}$ and the active load $M_{6}$. (Also depicted is an $R_{c}-C_{c}$ network designed to stabilize the amplifier against potential oscillations in negative-feedback operation, a topic covered in Chapter 7. The current analysis is limited to low frequencies, where $C_{c}$ behaves as an open circuit, thus the $R_{c}-C_{c}$ network is disregarded.) The low-frequency voltage gain of this stage is\n\n$$\n\\begin{equation*}\na_{2}=-g_{m 5}\\left(r_{o 5} / / r_{o 6}\\right) \\tag{5.24}\n\\end{equation*}\n$$\n\n- The DC biasing circuit comprises the dual-output current mirror $M_{6}-M_{7}-M_{8}$, along with the $I_{R E F}$ current reference. The specifics of this reference are omitted for simplicity, but it is typically a circuit shared among various op amps on the same chip. It generates a regulated current $I_{R E F}$ once, which is then duplicated by a multiple-output current mirror to each of the other on-chip op amps. In Fig. 5.13, $I_{R E F}$ is duplicated by $M_{7}$ to bias the $M_{1}-M_{2}$ pair, and by $M_{6}$ to actively load the CS stage $M_{5}$. Thanks to the infinite resistance at $M_{5}$'s gate, there is no inter-stage loading, so the overall gain is simply the product of the individual gains\n\n$$\n\\begin{equation*}\na=\\frac{v_{o}}{v_{p}-v_{n}}=a_{1} \\times a_{2}=g_{m 1}\\left(r_{o 2} / / r_{o 4}\\right) g_{m 5}\\left(r_{o 5} / / r_{o 6}\\right) \\tag{5.25a}\n\\end{equation*}\n$$\n\nBy adapting Eq. (4.152) to this scenario, we express the gain in an insightful alternative form\n\n$$\n\\begin{equation*}\na=\\frac{2}{V_{O V 1}\\left(\\lambda_{2}+\\lambda_{4}\\right)} \\times \\frac{2}{V_{O V 5}\\left(\\lambda_{5}+\\lambda_{6}\\right)} \\tag{5.25b}\n\\end{equation*}\n$$\n\nIf the op amp is implemented with FETs having identical channel length $L$ and overdrive voltage $V_{O V}$, the gain simplifies to\n\n$$\n\\begin{equation*}\na=\\left[\\frac{2 L}{V_{O V}\\left(\\lambda_{n}^{\\prime}+\\lambda_{p}^{\\prime}\\right)}\\right]^{2} \\tag{5.25c}\n\\end{equation*}\n$$\n\nwhere, according to Eq. (4.31), $\\lambda_{n}^{\\prime}$ and $\\lambda_{p}^{\\prime}$ are the process parameters describing channel-length modulation in the $n$ FETs and $p$ FETs, respectively. Clearly, a longer $L$ and a lower $V_{O V}$ result in higher gain. The AC resistances between the two inputs and between the output and ground are, respectively,\n\n$$\n\\begin{equation*}\nR_{i}=\\infty \\quad R_{o}=r_{o 5} / / r_{o 6} \\tag{5.26}\n\\end{equation*}\n$$\n\nWe observe a strong similarity between the CMOS stages of Fig. 5.13 and the first and second stages of the 741 op amp in Fig. 5.2. In fact, due to the infinite resistance at the gates, the CMOS stages are significantly simpler. We also note the absence of an output stage, even though $R_{o}$ can be quite high. Typically, an op amp of the type shown in Fig. 5.13 is intended to drive other on-chip CMOS circuits that also present infinite input resistance (though not necessarily zero capacitance), eliminating the need for a dedicated output stage. Only when designed to drive resistive loads, usually off-chip, will a two-stage op amp be equipped with a dedicated third stage. This might be an output stage of the type discussed in Section 4.11."
},
{
    "text": "The rephrased text:\n\n```\nThis traditional CMOS operational amplifier configuration (and its variants) is particularly utilized in mixed-mode integrated circuits. Illustrated in its fundamental form in Fig. 5.13, it encompasses two gain stages and a direct current (dc) biasing circuit as detailed below:\n\n- The initial or input stage is composed of the $p$-channel differential pair $M_{1}-M_{2}$ and the $n$-channel current mirror load $M_{3}-M_{4}$. As previously discussed, its voltage gain is given by\n\n$$\n\\begin{equation*}\na_{1}=-g_{m 1}\\left(r_{o 2} / / r_{o 4}\\right) \\tag{5.23}\n\\end{equation*}\n$$\n\nimage_name:Figure 5.13 Two-stage CMOS op amp\ndescription:\n[\nname: M1, type: PMOS, ports: {S: x3, D: x2, G: vN}\nname: M2, type: PMOS, ports: {S: x3, D: x1, G: vP}\nname: M3, type: NMOS, ports: {S: Vss, D: x2, G: x2}\nname: M4, type: NMOS, ports: {S: GND, D: x1, G: x2}\nname: M5, type: NMOS, ports: {S: Vss, D: vO, G: x1}\nname: M6, type: PMOS, ports: {S: VDD, D: vO, G: x4}\nname: M7, type: PMOS, ports: {S: VDD, D: x3, G: x4}\nname: M8, type: PMOS, ports: {S: VDD, D: x4, G: x4}\nname: I_REF, type: CurrentSource, ports: {Np: x4, Nn: VSS}\nname: R_C, type: Resistor, value: R_C, ports: {N1: x1, N2: RC}\nname: C_C, type: Capacitor, value: C_C, ports: {Np: RC, Nn: vO}\n]\nextrainfo:The circuit is a two-stage CMOS operational amplifier with a differential input stage and a common-source output stage. It includes a compensation network with R_C and C_C for stability.\n\nFIGURE 5.13 Two-stage CMOS op amp.\n\n- The secondary or output stage includes the common-source (CS) amplifier $M_{5}$ and the active load $M_{6}$. (Additionally, an $R_{c}-C_{c}$ network is depicted, which serves to stabilize the amplifier against potential oscillations during negative-feedback operation, a topic covered in Chapter 7. The current analysis is confined to low frequencies, where $C_{c}$ behaves as an open circuit, thus the $R_{c}-C_{c}$ network is disregarded.) The low-frequency voltage gain of this stage is\n\n$$\n\\begin{equation*}\na_{2}=-g_{m 5}\\left(r_{o 5} / / r_{o 6}\\right) \\tag{5.24}\n\\end{equation*}\n$$\n\n- The dc biasing circuit comprises the dual-output current mirror $M_{6}-M_{7}-M_{8}$, along with the $I_{R E F}$ current reference. The specifics of this reference are omitted for simplicity, but it typically constitutes a circuit shared among various op amps on the same chip. It produces a regulated current $I_{R E F}$, which is then duplicated by a multiple-output current mirror to each of the other on-chip op amps. In Fig. 5.13, $I_{R E F}$ is duplicated by $M_{7}$ to bias the $M_{1}-M_{2}$ pair, and by $M_{6}$ to actively load the CS stage $M_{5}$. Due to the infinite resistance at $M_{5}$'s gate, there is no inter-stage loading, so the overall gain is simply the product of the individual gains\n\n$$\n\\begin{equation*}\na=\\frac{v_{o}}{v_{p}-v_{n}}=a_{1} \\times a_{2}=g_{m 1}\\left(r_{o 2} / / r_{o 4}\\right) g_{m 5}\\left(r_{o 5} / / r_{o 6}\\right) \\tag{5.25a}\n\\end{equation*}\n$$\n\nBy modifying Eq. (4.152) for the current scenario, we express the gain in an insightful alternative form\n\n$$\n\\begin{equation*}\na=\\frac{2}{V_{O V 1}\\left(\\lambda_{2}+\\lambda_{4}\\right)} \\times \\frac{2}{V_{O V 5}\\left(\\lambda_{5}+\\lambda_{6}\\right)} \\tag{5.25b}\n\\end{equation*}\n$$\n\nIf the op amp is implemented with FETs having identical channel length $L$ and overdrive voltage $V_{O V}$, the gain can be succinctly expressed as\n\n$$\n\\begin{equation*}\na=\\left[\\frac{2 L}{V_{O V}\\left(\\lambda_{n}^{\\prime}+\\lambda_{p}^{\\prime}\\right)}\\right]^{2} \\tag{5.25c}\n\\end{equation*}\n$$\n\nwhere, according to Eq. (4.31), $\\lambda_{n}^{\\prime}$ and $\\lambda_{p}^{\\prime}$ are the process parameters that describe channel-length modulation in the $n$ FETs and $p$ FETs, respectively. Clearly, longer $L$ and lower $V_{O V}$ result in higher gain. The alternating current (ac) resistances between the two inputs and between the output and ground are, respectively,\n\n$$\n\\begin{equation*}\nR_{i}=\\infty \\quad R_{o}=r_{o 5} / / r_{o 6} \\tag{5.26}\n\\end{equation*}\n$$\n\nWe observe a striking similarity between the CMOS stages of Fig. 5.13 and the first and second stages of the 741 op amp in Fig. 5.2. In fact, due to the infinite resistance at the gates, the CMOS stages are significantly simpler. We also note the absence of an output stage, even though $R_{o}$ can be quite high. Typically, an op amp of the type shown in Fig. 5.13 is intended to drive other on-chip CMOS circuits that also present infinite input resistance (though not necessarily zero capacitance), eliminating the need for a dedicated output stage. Only when designed to drive resistive loads, usually off-chip, will a two-stage op amp be equipped with a dedicated third stage. This might be an output stage of the type discussed in Section 4.11.\n```"
},
{
    "text": "This traditional CMOS operational amplifier configuration, along with its variants, is particularly prevalent in mixed-mode integrated circuits. Illustrated in its fundamental form in Fig. 5.13, it encompasses two gain stages and a DC biasing circuit as detailed below:\n\n- The initial or input stage is composed of the $p$-channel differential pair $M_{1}-M_{2}$ and the $n$-channel mirror load $M_{3}-M_{4}$. As previously discussed, its voltage gain is given by\n\n$$\n\\begin{equation*}\na_{1}=-g_{m 1}\\left(r_{o 2} / / r_{o 4}\\right) \\tag{5.23}\n\\end{equation*}\n$$\n\nimage_name: Figure 5.13 Two-stage CMOS op amp\ndescription:\n[\nname: M1, type: PMOS, ports: {S: x3, D: x2, G: vN}\nname: M2, type: PMOS, ports: {S: x3, D: x1, G: vP}\nname: M3, type: NMOS, ports: {S: Vss, D: x2, G: x2}\nname: M4, type: NMOS, ports: {S: GND, D: x1, G: x2}\nname: M5, type: NMOS, ports: {S: Vss, D: vO, G: x1}\nname: M6, type: PMOS, ports: {S: VDD, D: vO, G: x4}\nname: M7, type: PMOS, ports: {S: VDD, D: x3, G: x4}\nname: M8, type: PMOS, ports: {S: VDD, D: x4, G: x4}\nname: I_REF, type: CurrentSource, ports: {Np: x4, Nn: VSS}\nname: R_C, type: Resistor, value: R_C, ports: {N1: x1, N2: RC}\nname: C_C, type: Capacitor, value: C_C, ports: {Np: RC, Nn: vO}\n]\nextrainfo: The circuit represents a two-stage CMOS operational amplifier featuring a differential input stage and a common-source output stage. It incorporates a compensation network consisting of R_C and C_C for stability.\n\nFIGURE 5.13 Two-stage CMOS op amp.\n\n- The second or output stage includes the CS amplifier $M_{5}$ and the active load $M_{6}$. (Additionally, an $R_{c}-C_{c}$ network is shown, which serves to stabilize the amplifier against potential oscillations during negative-feedback operation, a topic covered in Chapter 7. For the current analysis, which is limited to low frequencies where $C_{c}$ behaves as an open circuit, the $R_{c}-C_{c}$ network will be disregarded.) The low-frequency voltage gain of this stage is\n\n$$\n\\begin{equation*}\na_{2}=-g_{m 5}\\left(r_{o 5} / / r_{o 6}\\right) \\tag{5.24}\n\\end{equation*}\n$$\n\n- The DC biasing circuit comprises the dual-output current mirror $M_{6}-M_{7}-M_{8}$, along with the $I_{R E F}$ current reference. While the specifics of this reference have been omitted for simplicity, it is typically a shared circuit among various op amps on the same chip. It produces a regulated current $I_{R E F}$, which is then duplicated by a multiple-output current mirror to each of the other on-chip op amps. In Fig. 5.13, $I_{R E F}$ is replicated by $M_{7}$ to bias the $M_{1}-M_{2}$ pair and by $M_{6}$ to actively load the CS stage $M_{5}$. Due to the infinite resistance at $M_{5}$'s gate, there is no inter-stage loading, resulting in the overall gain being simply the product of the individual gains:\n\n$$\n\\begin{equation*}\na=\\frac{v_{o}}{v_{p}-v_{n}}=a_{1} \\times a_{2}=g_{m 1}\\left(r_{o 2} / / r_{o 4}\\right) g_{m 5}\\left(r_{o 5} / / r_{o 6}\\right) \\tag{5.25a}\n\\end{equation*}\n$$\n\nBy adapting Eq. (4.152) to this scenario, we can express the gain in a more insightful form:\n\n$$\n\\begin{equation*}\na=\\frac{2}{V_{O V 1}\\left(\\lambda_{2}+\\lambda_{4}\\right)} \\times \\frac{2}{V_{O V 5}\\left(\\lambda_{5}+\\lambda_{6}\\right)} \\tag{5.25b}\n\\end{equation*}\n$$\n\nIf the op amp is implemented with FETs having identical channel length $L$ and overdrive voltage $V_{O V}$, the gain can be succinctly expressed as:\n\n$$\n\\begin{equation*}\na=\\left[\\frac{2 L}{V_{O V}\\left(\\lambda_{n}^{\\prime}+\\lambda_{p}^{\\prime}\\right)}\\right]^{2} \\tag{5.25c}\n\\end{equation*}\n$$\n\nHere, according to Eq. (4.31), $\\lambda_{n}^{\\prime}$ and $\\lambda_{p}^{\\prime}$ are the process parameters that describe channel-length modulation in the $n$ FETs and $p$ FETs, respectively. Clearly, longer $L$ and lower $V_{O V}$ result in higher gain. The AC resistances between the two inputs and between the output and ground are, respectively,\n\n$$\n\\begin{equation*}\nR_{i}=\\infty \\quad R_{o}=r_{o 5} / / r_{o 6} \\tag{5.26}\n\\end{equation*}\n$$\n\nWe observe a strong similarity between the CMOS stages of Fig. 5.13 and the first and second stages of the 741 op amp in Fig. 5.2. In fact, due to the infinite resistance at the gates, the CMOS stages are significantly simpler. We also note the absence of an output stage, even though $R_{o}$ can be quite high. Typically, an op amp of the type shown in Fig. 5.13 is intended to drive other on-chip CMOS circuits that also present infinite input resistance (though not necessarily zero capacitance), eliminating the need for a dedicated output stage. Only when designed to drive resistive loads, usually off-chip, will a two-stage op amp include a dedicated third stage, which might be of the type discussed in Section 4.11."
},
{
    "text": "This traditional CMOS operational amplifier configuration, along with its variants, is particularly prevalent in mixed-mode integrated circuits. Illustrated in its fundamental form in Fig. 5.13, it consists of two gain stages and a DC biasing circuit, detailed as follows:\n\n- The first or input stage is composed of the $p$-channel differential pair $M_{1}-M_{2}$ and the $n$-channel mirror load $M_{3}-M_{4}$. As previously discussed, its voltage gain is given by\n\n$$\n\\begin{equation*}\na_{1}=-g_{m 1}\\left(r_{o 2} / / r_{o 4}\\right) \\tag{5.23}\n\\end{equation*}\n$$\n\nimage_name: Figure 5.13 Two-stage CMOS op amp\ndescription:\n[\nname: M1, type: PMOS, ports: {S: x3, D: x2, G: vN}\nname: M2, type: PMOS, ports: {S: x3, D: x1, G: vP}\nname: M3, type: NMOS, ports: {S: Vss, D: x2, G: x2}\nname: M4, type: NMOS, ports: {S: GND, D: x1, G: x2}\nname: M5, type: NMOS, ports: {S: Vss, D: vO, G: x1}\nname: M6, type: PMOS, ports: {S: VDD, D: vO, G: x4}\nname: M7, type: PMOS, ports: {S: VDD, D: x3, G: x4}\nname: M8, type: PMOS, ports: {S: VDD, D: x4, G: x4}\nname: I_REF, type: CurrentSource, ports: {Np: x4, Nn: VSS}\nname: R_C, type: Resistor, value: R_C, ports: {N1: x1, N2: RC}\nname: C_C, type: Capacitor, value: C_C, ports: {Np: RC, Nn: vO}\n]\nextrainfo: The circuit is a two-stage CMOS operational amplifier featuring a differential input stage and a common-source output stage. It includes a compensation network comprising R_C and C_C for stability.\n\nFIGURE 5.13 Two-stage CMOS op amp.\n\n- The second or output stage includes the CS amplifier $M_{5}$ and the active load $M_{6}$. (Also depicted is an $R_{c}-C_{c}$ network, which serves to stabilize the amplifier against potential oscillations during negative-feedback operation, a topic covered in Chapter 7. The current analysis is confined to low frequencies, where $C_{c}$ behaves as an open circuit, thus the $R_{c}-C_{c}$ network is disregarded.) The low-frequency voltage gain of this stage is\n\n$$\n\\begin{equation*}\na_{2}=-g_{m 5}\\left(r_{o 5} / / r_{o 6}\\right) \\tag{5.24}\n\\end{equation*}\n$$\n\n- The DC biasing circuit comprises the dual-output current mirror $M_{6}-M_{7}-M_{8}$, along with the $I_{R E F}$ current reference. For simplicity, the specifics of this reference have been omitted, but it is typically a circuit shared among various op amps on the same chip. It produces a regulated current $I_{R E F}$, which is then duplicated by a multiple-output current mirror to each of the other on-chip op amps. In Fig. 5.13, $I_{R E F}$ is replicated by $M_{7}$ to bias the $M_{1}-M_{2}$ pair and by $M_{6}$ to actively load the CS stage $M_{5}$. Due to the infinite resistance at $M_{5}$'s gate, there is no inter-stage loading, so the overall gain is simply the product of the individual gains\n\n$$\n\\begin{equation*}\na=\\frac{v_{o}}{v_{p}-v_{n}}=a_{1} \\times a_{2}=g_{m 1}\\left(r_{o 2} / / r_{o 4}\\right) g_{m 5}\\left(r_{o 5} / / r_{o 6}\\right) \\tag{5.25a}\n\\end{equation*}\n$$\n\nBy adapting Eq. (4.152) to this scenario, we can express the gain in an insightful alternative form\n\n$$\n\\begin{equation*}\na=\\frac{2}{V_{O V 1}\\left(\\lambda_{2}+\\lambda_{4}\\right)} \\times \\frac{2}{V_{O V 5}\\left(\\lambda_{5}+\\lambda_{6}\\right)} \\tag{5.25b}\n\\end{equation*}\n$$\n\nIf the op amp is implemented with FETs having identical channel length $L$ and overdrive voltage $V_{O V}$, the gain can be succinctly expressed as\n\n$$\n\\begin{equation*}\na=\\left[\\frac{2 L}{V_{O V}\\left(\\lambda_{n}^{\\prime}+\\lambda_{p}^{\\prime}\\right)}\\right]^{2} \\tag{5.25c}\n\\end{equation*}\n$$\n\nwhere, according to Eq. (4.31), $\\lambda_{n}^{\\prime}$ and $\\lambda_{p}^{\\prime}$ are the process parameters that describe channel-length modulation in the $n$ FETs and $p$ FETs, respectively. Clearly, a longer $L$ and a lower $V_{O V}$ result in higher gain. The AC resistances between the two inputs and between the output and ground are, respectively,\n\n$$\n\\begin{equation*}\nR_{i}=\\infty \\quad R_{o}=r_{o 5} / / r_{o 6} \\tag{5.26}\n\\end{equation*}\n$$\n\nWe observe a strong similarity between the CMOS stages of Fig. 5.13 and the first and second stages of the 741 op amp in Fig. 5.2. In fact, due to the infinite resistance at the gates, the CMOS stages are significantly simpler. We also note the absence of an output stage, even though $R_{o}$ can be quite high. Typically, an op amp of the type shown in Fig. 5.13 is intended to drive other on-chip CMOS circuits that also present infinite input resistance (though not necessarily zero capacitance), eliminating the need for a dedicated output stage. Only when designed to drive resistive loads, usually off-chip, will a two-stage op amp include a dedicated third stage. This might be an output stage of the type discussed in Section 4.11."
},
{
    "text": "This traditional CMOS operational amplifier configuration, along with its variants, is particularly prevalent in mixed-mode integrated circuits. Illustrated in its fundamental form in Fig. 5.13, it encompasses two gain stages and a DC biasing circuit as detailed below:\n\n- The initial or input stage is composed of the $p$-channel differential pair $M_{1}-M_{2}$ and the $n$-channel mirror load $M_{3}-M_{4}$. As previously discussed, its voltage gain is given by\n\n$$\n\\begin{equation*}\na_{1}=-g_{m 1}\\left(r_{o 2} / / r_{o 4}\\right) \\tag{5.23}\n\\end{equation*}\n$$\n\nimage_name:Figure 5.13 Two-stage CMOS op amp\ndescription:\n[\nname: M1, type: PMOS, ports: {S: x3, D: x2, G: vN}\nname: M2, type: PMOS, ports: {S: x3, D: x1, G: vP}\nname: M3, type: NMOS, ports: {S: Vss, D: x2, G: x2}\nname: M4, type: NMOS, ports: {S: GND, D: x1, G: x2}\nname: M5, type: NMOS, ports: {S: Vss, D: vO, G: x1}\nname: M6, type: PMOS, ports: {S: VDD, D: vO, G: x4}\nname: M7, type: PMOS, ports: {S: VDD, D: x3, G: x4}\nname: M8, type: PMOS, ports: {S: VDD, D: x4, G: x4}\nname: I_REF, type: CurrentSource, ports: {Np: x4, Nn: VSS}\nname: R_C, type: Resistor, value: R_C, ports: {N1: x1, N2: RC}\nname: C_C, type: Capacitor, value: C_C, ports: {Np: RC, Nn: vO}\n]\nextrainfo:The circuit is a two-stage CMOS operational amplifier with a differential input stage and a common-source output stage. It includes a compensation network with R_C and C_C for stability.\n\nFIGURE 5.13 Two-stage CMOS op amp.\n\n- The second or output stage includes the common-source (CS) amplifier $M_{5}$ and the active load $M_{6}$. (Additionally, an $R_{c}-C_{c}$ network is depicted, which serves to stabilize the amplifier against potential oscillations during negative-feedback operation, a topic covered in Chapter 7. For the current analysis, which focuses on low frequencies where $C_{c}$ behaves as an open circuit, the $R_{c}-C_{c}$ network will be disregarded.) The low-frequency voltage gain of this stage is\n\n$$\n\\begin{equation*}\na_{2}=-g_{m 5}\\left(r_{o 5} / / r_{o 6}\\right) \\tag{5.24}\n\\end{equation*}\n$$\n\n- The DC biasing circuit comprises the dual-output current mirror $M_{6}-M_{7}-M_{8}$, along with the $I_{R E F}$ current reference. The specifics of this reference have been omitted for simplicity, but it is typically a shared circuit among various op amps on the same chip. It produces a regulated current $I_{R E F}$, which is then duplicated by a multiple-output current mirror to each of the other on-chip op amps. In Fig. 5.13, $I_{R E F}$ is replicated by $M_{7}$ to bias the $M_{1}-M_{2}$ pair, and by $M_{6}$ to actively load the CS stage $M_{5}$. Due to the infinite resistance at $M_{5}$'s gate, there is no inter-stage loading, resulting in the overall gain being simply the product of the individual gains\n\n$$\n\\begin{equation*}\na=\\frac{v_{o}}{v_{p}-v_{n}}=a_{1} \\times a_{2}=g_{m 1}\\left(r_{o 2} / / r_{o 4}\\right) g_{m 5}\\left(r_{o 5} / / r_{o 6}\\right) \\tag{5.25a}\n\\end{equation*}\n$$\n\nBy adapting Eq. (4.152) to this scenario, we can express the gain in a more insightful form\n\n$$\n\\begin{equation*}\na=\\frac{2}{V_{O V 1}\\left(\\lambda_{2}+\\lambda_{4}\\right)} \\times \\frac{2}{V_{O V 5}\\left(\\lambda_{5}+\\lambda_{6}\\right)} \\tag{5.25b}\n\\end{equation*}\n$$\n\nIf the op amp is implemented using FETs with identical channel length $L$ and overdrive voltage $V_{O V}$, the gain can be succinctly expressed as\n\n$$\n\\begin{equation*}\na=\\left[\\frac{2 L}{V_{O V}\\left(\\lambda_{n}^{\\prime}+\\lambda_{p}^{\\prime}\\right)}\\right]^{2} \\tag{5.25c}\n\\end{equation*}\n$$\n\nwhere, according to Eq. (4.31), $\\lambda_{n}^{\\prime}$ and $\\lambda_{p}^{\\prime}$ are the process parameters that describe channel-length modulation in the $n$ FETs and $p$ FETs, respectively. Clearly, a longer $L$ and a lower $V_{O V}$ result in a higher gain. The AC resistances between the two inputs and between the output and ground are, respectively,\n\n$$\n\\begin{equation*}\nR_{i}=\\infty \\quad R_{o}=r_{o 5} / / r_{o 6} \\tag{5.26}\n\\end{equation*}\n$$\n\nWe observe a strong similarity between the CMOS stages in Fig. 5.13 and the first and second stages of the 741 op amp in Fig. 5.2. In fact, due to the infinite resistance at the gates, the CMOS stages are significantly simpler. We also note the absence of an output stage, even though $R_{o}$ can be quite high. Typically, an op amp of the type shown in Fig. 5.13 is intended to drive other on-chip CMOS circuits that also present infinite input resistance (though not necessarily zero capacitance), eliminating the need for a dedicated output stage. Only when designed to drive resistive loads, usually off-chip, will a two-stage op amp be equipped with a dedicated third stage. This might be an output stage of the type discussed in Section 4.11."
},
{
    "text": "This traditional CMOS operational amplifier configuration, along with its variations, is particularly employed in mixed-mode integrated circuits. Illustrated in its fundamental form in Fig. 5.13, it consists of two gain stages and a direct current (dc) biasing circuit as detailed below:\n\n- The initial or input stage is composed of the $p$-channel differential pair $M_{1}-M_{2}$ and the $n$-channel mirror load $M_{3}-M_{4}$. As previously discussed, its voltage gain is given by\n\n$$\n\\begin{equation*}\na_{1}=-g_{m 1}\\left(r_{o 2} / / r_{o 4}\\right) \\tag{5.23}\n\\end{equation*}\n$$\n\nimage_name:Figure 5.13 Two-stage CMOS op amp\ndescription:\n[\nname: M1, type: PMOS, ports: {S: x3, D: x2, G: vN}\nname: M2, type: PMOS, ports: {S: x3, D: x1, G: vP}\nname: M3, type: NMOS, ports: {S: Vss, D: x2, G: x2}\nname: M4, type: NMOS, ports: {S: GND, D: x1, G: x2}\nname: M5, type: NMOS, ports: {S: Vss, D: vO, G: x1}\nname: M6, type: PMOS, ports: {S: VDD, D: vO, G: x4}\nname: M7, type: PMOS, ports: {S: VDD, D: x3, G: x4}\nname: M8, type: PMOS, ports: {S: VDD, D: x4, G: x4}\nname: I_REF, type: CurrentSource, ports: {Np: x4, Nn: VSS}\nname: R_C, type: Resistor, value: R_C, ports: {N1: x1, N2: RC}\nname: C_C, type: Capacitor, value: C_C, ports: {Np: RC, Nn: vO}\n]\nextrainfo:The circuit is a two-stage CMOS operational amplifier with a differential input stage and a common-source output stage. It includes a compensation network with R_C and C_C for stability.\n\nFIGURE 5.13 Two-stage CMOS op amp.\n\n- The second or output stage includes the common-source (CS) amplifier $M_{5}$ and the active load $M_{6}$. (Additionally, an $R_{c}-C_{c}$ network is depicted, which serves to stabilize the amplifier against potential oscillations during negative-feedback operation, a topic covered in Chapter 7. For the current analysis, which is limited to low frequencies where $C_{c}$ behaves as an open circuit, the $R_{c}-C_{c}$ network will be disregarded.) The low-frequency voltage gain of this stage is\n\n$$\n\\begin{equation*}\na_{2}=-g_{m 5}\\left(r_{o 5} / / r_{o 6}\\right) \\tag{5.24}\n\\end{equation*}\n$$\n\n- The dc biasing circuit is formed by the dual-output current mirror $M_{6}-M_{7}-M_{8}$, along with the $I_{R E F}$ current reference. The specifics of this reference have been omitted for simplicity, but it is typically a circuit shared among various op amps on the same chip. It produces a regulated current $I_{R E F}$, which is then duplicated by a multiple-output current mirror to each of the other on-chip op amps. In Fig. 5.13, $I_{R E F}$ is duplicated by $M_{7}$ to bias the $M_{1}-M_{2}$ pair, and by $M_{6}$ to actively load the CS stage $M_{5}$. Due to the infinite resistance at $M_{5}$'s gate, there is no inter-stage loading, resulting in the overall gain being simply the product of the individual gains\n\n$$\n\\begin{equation*}\na=\\frac{v_{o}}{v_{p}-v_{n}}=a_{1} \\times a_{2}=g_{m 1}\\left(r_{o 2} / / r_{o 4}\\right) g_{m 5}\\left(r_{o 5} / / r_{o 6}\\right) \\tag{5.25a}\n\\end{equation*}\n$$\n\nBy adapting Eq. (4.152) to this scenario, we can express the gain in a more insightful alternative form\n\n$$\n\\begin{equation*}\na=\\frac{2}{V_{O V 1}\\left(\\lambda_{2}+\\lambda_{4}\\right)} \\times \\frac{2}{V_{O V 5}\\left(\\lambda_{5}+\\lambda_{6}\\right)} \\tag{5.25b}\n\\end{equation*}\n$$\n\nIf the op amp is implemented using FETs with identical channel length $L$ and overdrive voltage $V_{O V}$, the gain can be succinctly expressed as\n\n$$\n\\begin{equation*}\na=\\left[\\frac{2 L}{V_{O V}\\left(\\lambda_{n}^{\\prime}+\\lambda_{p}^{\\prime}\\right)}\\right]^{2} \\tag{5.25c}\n\\end{equation*}\n$$\n\nwhere, according to Eq. (4.31), $\\lambda_{n}^{\\prime}$ and $\\lambda_{p}^{\\prime}$ are the process parameters that describe channel-length modulation in the $n$ FETs and $p$ FETs, respectively. Clearly, a longer $L$ and a lower $V_{O V}$ result in a higher gain. The alternating current (ac) resistances between the two inputs and between the output and ground are, respectively,\n\n$$\n\\begin{equation*}\nR_{i}=\\infty \\quad R_{o}=r_{o 5} / / r_{o 6} \\tag{5.26}\n\\end{equation*}\n$$\n\nWe observe a strong similarity between the CMOS stages of Fig. 5.13 and the first and second stages of the 741 op amp in Fig. 5.2. In fact, due to the infinite resistance at the gates, the CMOS stages are significantly simpler. We also note the absence of an output stage, even though $R_{o}$ can be quite high. Typically, an op amp of the type shown in Fig. 5.13 is intended to drive other on-chip CMOS circuits that also present infinite input resistance (though not necessarily zero capacitance), eliminating the need for a dedicated output stage. Only when designed to drive resistive loads, usually off-chip, will a two-stage op amp be equipped with a dedicated third stage. This might be an output stage of the type discussed in Section 4.11."
},
{
    "text": "This traditional CMOS operational amplifier configuration, along with its variants, is particularly prevalent in mixed-mode integrated circuits. Illustrated in its fundamental form in Fig. 5.13, it includes two gain stages and a DC biasing circuit as detailed below:\n\n- The initial or input stage is composed of the $p$-channel differential pair $M_{1}-M_{2}$ and the $n$-channel mirror load $M_{3}-M_{4}$. As known, its voltage gain is given by\n\n$$\n\\begin{equation*}\na_{1}=-g_{m 1}\\left(r_{o 2} / / r_{o 4}\\right) \\tag{5.23}\n\\end{equation*}\n$$\n\nimage_name:Figure 5.13 Two-stage CMOS op amp\ndescription:\n[\nname: M1, type: PMOS, ports: {S: x3, D: x2, G: vN}\nname: M2, type: PMOS, ports: {S: x3, D: x1, G: vP}\nname: M3, type: NMOS, ports: {S: Vss, D: x2, G: x2}\nname: M4, type: NMOS, ports: {S: GND, D: x1, G: x2}\nname: M5, type: NMOS, ports: {S: Vss, D: vO, G: x1}\nname: M6, type: PMOS, ports: {S: VDD, D: vO, G: x4}\nname: M7, type: PMOS, ports: {S: VDD, D: x3, G: x4}\nname: M8, type: PMOS, ports: {S: VDD, D: x4, G: x4}\nname: I_REF, type: CurrentSource, ports: {Np: x4, Nn: VSS}\nname: R_C, type: Resistor, value: R_C, ports: {N1: x1, N2: RC}\nname: C_C, type: Capacitor, value: C_C, ports: {Np: RC, Nn: vO}\n]\nextrainfo:The circuit is a two-stage CMOS operational amplifier featuring a differential input stage and a common-source output stage. It incorporates a compensation network comprising R_C and C_C for stability.\n\nFIGURE 5.13 Two-stage CMOS op amp.\n\n- The second or output stage consists of the common-source amplifier $M_{5}$ and the active load $M_{6}$. (Also depicted is an $R_{c}-C_{c}$ network designed to stabilize the amplifier against potential oscillations in negative-feedback operation, a topic covered in Chapter 7. The current analysis is limited to low frequencies, where $C_{c}$ behaves as an open circuit, hence the $R_{c}-C_{c}$ network is disregarded.) The low-frequency voltage gain of this stage is\n\n$$\n\\begin{equation*}\na_{2}=-g_{m 5}\\left(r_{o 5} / / r_{o 6}\\right) \\tag{5.24}\n\\end{equation*}\n$$\n\n- The DC biasing circuit comprises the dual-output current mirror $M_{6}-M_{7}-M_{8}$, along with the $I_{R E F}$ current reference. For simplicity, the details of this reference have been omitted, but it typically serves multiple op amps on the same chip. It produces a regulated current $I_{R E F}$, which is then duplicated by a multiple-output current mirror to each on-chip op amp. In Fig. 5.13, $I_{R E F}$ is duplicated by $M_{7}$ to bias the $M_{1}-M_{2}$ pair, and by $M_{6}$ to actively load the CS stage $M_{5}$. Thanks to the infinite resistance at $M_{5}$'s gate, there is no inter-stage loading, making the overall gain simply the product of the individual gains:\n\n$$\n\\begin{equation*}\na=\\frac{v_{o}}{v_{p}-v_{n}}=a_{1} \\times a_{2}=g_{m 1}\\left(r_{o 2} / / r_{o 4}\\right) g_{m 5}\\left(r_{o 5} / / r_{o 6}\\right) \\tag{5.25a}\n\\end{equation*}\n$$\n\nBy adapting Eq. (4.152) to this scenario, we can express the gain in an insightful alternative form:\n\n$$\n\\begin{equation*}\na=\\frac{2}{V_{O V 1}\\left(\\lambda_{2}+\\lambda_{4}\\right)} \\times \\frac{2}{V_{O V 5}\\left(\\lambda_{5}+\\lambda_{6}\\right)} \\tag{5.25b}\n\\end{equation*}\n$$\n\nIf the op amp is implemented with FETs having identical channel length $L$ and overdrive voltage $V_{O V}$, the gain simplifies to:\n\n$$\n\\begin{equation*}\na=\\left[\\frac{2 L}{V_{O V}\\left(\\lambda_{n}^{\\prime}+\\lambda_{p}^{\\prime}\\right)}\\right]^{2} \\tag{5.25c}\n\\end{equation*}\n$$\n\nHere, $\\lambda_{n}^{\\prime}$ and $\\lambda_{p}^{\\prime}$, as per Eq. (4.31), are the process parameters describing channel-length modulation in the $n$ FETs and $p$ FETs, respectively. Clearly, longer $L$ and lower $V_{O V}$ result in higher gain. The AC resistances between the two inputs and between the output and ground are, respectively,\n\n$$\n\\begin{equation*}\nR_{i}=\\infty \\quad R_{o}=r_{o 5} / / r_{o 6} \\tag{5.26}\n\\end{equation*}\n$$\n\nWe observe a strong similarity between the CMOS stages of Fig. 5.13 and the first and second stages of the 741 op amp in Fig. 5.2. In fact, due to the infinite resistance at the gates, the CMOS stages are significantly simpler. We also note the absence of an output stage, even though $R_{o}$ can be quite high. Typically, an op amp like the one in Fig. 5.13 is intended to drive other on-chip CMOS circuits that also present infinite input resistance (though not necessarily zero capacitance), eliminating the need for a dedicated output stage. A dedicated third stage is only added when the op amp is designed to drive resistive loads, usually off-chip, which might be an output stage as discussed in Section 4.11."
},
{
    "text": "This traditional CMOS operational amplifier configuration, along with its variations, is particularly employed in mixed-mode integrated circuits. Illustrated in its fundamental form in Fig. 5.13, it includes two gain stages and a direct current (dc) biasing circuit as detailed below:\n\n- The first or input stage is composed of the $p$-channel differential pair $M_{1}-M_{2}$ and the $n$-channel mirror load $M_{3}-M_{4}$. As previously discussed, its voltage gain is given by\n\n$$\n\\begin{equation*}\na_{1}=-g_{m 1}\\left(r_{o 2} / / r_{o 4}\\right) \\tag{5.23}\n\\end{equation*}\n$$\n\nimage_name:Figure 5.13 Two-stage CMOS op amp\ndescription:\n[\nname: M1, type: PMOS, ports: {S: x3, D: x2, G: vN}\nname: M2, type: PMOS, ports: {S: x3, D: x1, G: vP}\nname: M3, type: NMOS, ports: {S: Vss, D: x2, G: x2}\nname: M4, type: NMOS, ports: {S: GND, D: x1, G: x2}\nname: M5, type: NMOS, ports: {S: Vss, D: vO, G: x1}\nname: M6, type: PMOS, ports: {S: VDD, D: vO, G: x4}\nname: M7, type: PMOS, ports: {S: VDD, D: x3, G: x4}\nname: M8, type: PMOS, ports: {S: VDD, D: x4, G: x4}\nname: I_REF, type: CurrentSource, ports: {Np: x4, Nn: VSS}\nname: R_C, type: Resistor, value: R_C, ports: {N1: x1, N2: RC}\nname: C_C, type: Capacitor, value: C_C, ports: {Np: RC, Nn: vO}\n]\nextrainfo:The circuit is a two-stage CMOS operational amplifier featuring a differential input stage and a common-source output stage. It incorporates a compensation network comprising R_C and C_C for stability.\n\nFIGURE 5.13 Two-stage CMOS op amp.\n\n- The second or output stage consists of the common-source (CS) amplifier $M_{5}$ and the active load $M_{6}$. (Additionally, an $R_{c}-C_{c}$ network is included, which serves to stabilize the amplifier against potential oscillations during negative-feedback operation, a topic covered in Chapter 7. For the current analysis, which is limited to low frequencies where $C_{c}$ acts as an open circuit, the $R_{c}-C_{c}$ network will be disregarded.) The low-frequency voltage gain of this stage is\n\n$$\n\\begin{equation*}\na_{2}=-g_{m 5}\\left(r_{o 5} / / r_{o 6}\\right) \\tag{5.24}\n\\end{equation*}\n$$\n\n- The dc biasing circuit comprises the dual-output current mirror $M_{6}-M_{7}-M_{8}$, along with the $I_{R E F}$ current reference. The specifics of this reference have been omitted for simplicity, but it is typically a shared circuit among various op amps on the same chip. It produces a regulated current $I_{R E F}$ once, which is then duplicated by a multiple-output current mirror to each of the other on-chip op amps. In Fig. 5.13, $I_{R E F}$ is duplicated by $M_{7}$ to bias the $M_{1}-M_{2}$ pair and by $M_{6}$ to actively load the CS stage $M_{5}$. Due to the infinite resistance at $M_{5}$'s gate, there is no inter-stage loading, resulting in the overall gain being simply the product of the individual gains\n\n$$\n\\begin{equation*}\na=\\frac{v_{o}}{v_{p}-v_{n}}=a_{1} \\times a_{2}=g_{m 1}\\left(r_{o 2} / / r_{o 4}\\right) g_{m 5}\\left(r_{o 5} / / r_{o 6}\\right) \\tag{5.25a}\n\\end{equation*}\n$$\n\nBy adapting Eq. (4.152) to this scenario, we can express the gain in an insightful alternative form\n\n$$\n\\begin{equation*}\na=\\frac{2}{V_{O V 1}\\left(\\lambda_{2}+\\lambda_{4}\\right)} \\times \\frac{2}{V_{O V 5}\\left(\\lambda_{5}+\\lambda_{6}\\right)} \\tag{5.25b}\n\\end{equation*}\n$$\n\nIf the op amp is implemented with FETs having identical channel length $L$ and overdrive voltage $V_{O V}$, the gain can be concisely expressed as\n\n$$\n\\begin{equation*}\na=\\left[\\frac{2 L}{V_{O V}\\left(\\lambda_{n}^{\\prime}+\\lambda_{p}^{\\prime}\\right)}\\right]^{2} \\tag{5.25c}\n\\end{equation*}\n$$\n\nwhere, according to Eq. (4.31), $\\lambda_{n}^{\\prime}$ and $\\lambda_{p}^{\\prime}$ are the process parameters that describe channel-length modulation in the $n$ FETs and $p$ FETs, respectively. Clearly, a longer $L$ and a lower $V_{O V}$ result in a higher gain. The alternating current (ac) resistances between the two inputs and between the output and ground are, respectively,\n\n$$\n\\begin{equation*}\nR_{i}=\\infty \\quad R_{o}=r_{o 5} / / r_{o 6} \\tag{5.26}\n\\end{equation*}\n$$\n\nWe observe a strong similarity between the CMOS stages of Fig. 5.13 and the first and second stages of the 741 op amp in Fig. 5.2. In fact, due to the infinite resistance at the gates, the CMOS stages are significantly simpler. We also note the absence of an output stage, even though $R_{o}$ can be quite high. Typically, an op amp of the type shown in Fig. 5.13 is intended to drive other on-chip CMOS circuits that also present infinite input resistance (though not necessarily zero capacitance), eliminating the need for a dedicated output stage. Only when designed to drive resistive loads, usually off-chip, will a two-stage op amp include a dedicated third stage. This might be an output stage of the type discussed in Section 4.11."
},
{
    "text": "This classic CMOS operational amplifier topology, along with its variants, is particularly utilized in mixed-mode integrated circuits. Illustrated in its fundamental form in Fig. 5.13, it consists of two gain stages and a DC biasing circuit as detailed below:\n\n- The first or input stage is composed of the $p$-channel differential pair $M_{1}-M_{2}$ and the $n$-channel mirror load $M_{3}-M_{4}$. As known, its voltage gain is given by\n\n$$\n\\begin{equation*}\na_{1}=-g_{m 1}\\left(r_{o 2} / / r_{o 4}\\right) \\tag{5.23}\n\\end{equation*}\n$$\n\nimage_name:Figure 5.13 Two-stage CMOS op amp\ndescription:\n[\nname: M1, type: PMOS, ports: {S: x3, D: x2, G: vN}\nname: M2, type: PMOS, ports: {S: x3, D: x1, G: vP}\nname: M3, type: NMOS, ports: {S: Vss, D: x2, G: x2}\nname: M4, type: NMOS, ports: {S: GND, D: x1, G: x2}\nname: M5, type: NMOS, ports: {S: Vss, D: vO, G: x1}\nname: M6, type: PMOS, ports: {S: VDD, D: vO, G: x4}\nname: M7, type: PMOS, ports: {S: VDD, D: x3, G: x4}\nname: M8, type: PMOS, ports: {S: VDD, D: x4, G: x4}\nname: I_REF, type: CurrentSource, ports: {Np: x4, Nn: VSS}\nname: R_C, type: Resistor, value: R_C, ports: {N1: x1, N2: RC}\nname: C_C, type: Capacitor, value: C_C, ports: {Np: RC, Nn: vO}\n]\nextrainfo:The circuit is a two-stage CMOS operational amplifier featuring a differential input stage and a common-source output stage. It incorporates a compensation network with R_C and C_C for stability.\n\nFIGURE 5.13 Two-stage CMOS op amp.\n\n- The second or output stage includes the CS amplifier $M_{5}$ and the active load $M_{6}$. (Also depicted is an $R_{c}-C_{c}$ network, which serves to stabilize the amplifier against potential oscillations in negative-feedback operation, a topic covered in Chapter 7. The current analysis is confined to low frequencies, where $C_{c}$ behaves as an open circuit, thus the $R_{c}-C_{c}$ network will be disregarded.) The low-frequency voltage gain of this stage is\n\n$$\n\\begin{equation*}\na_{2}=-g_{m 5}\\left(r_{o 5} / / r_{o 6}\\right) \\tag{5.24}\n\\end{equation*}\n$$\n\n- The DC biasing circuit comprises the dual-output current mirror $M_{6}-M_{7}-M_{8}$, along with the $I_{R E F}$ current reference. The specifics of this reference are omitted for simplicity, but it is typically a circuit shared among various op amps on the same chip. It produces a regulated current $I_{R E F}$ once, which is then duplicated by a multiple-output current mirror to each of the other on-chip op amps. In Fig. 5.13, $I_{R E F}$ is duplicated by $M_{7}$ to bias the $M_{1}-M_{2}$ pair, and by $M_{6}$ to actively load the CS stage $M_{5}$. Thanks to the infinite resistance at $M_{5}$'s gate, there is no inter-stage loading, so the overall gain is simply the product of the individual gains\n\n$$\n\\begin{equation*}\na=\\frac{v_{o}}{v_{p}-v_{n}}=a_{1} \\times a_{2}=g_{m 1}\\left(r_{o 2} / / r_{o 4}\\right) g_{m 5}\\left(r_{o 5} / / r_{o 6}\\right) \\tag{5.25a}\n\\end{equation*}\n$$\n\nAdapting Eq. (4.152) to this scenario, we express the gain in an insightful alternative form\n\n$$\n\\begin{equation*}\na=\\frac{2}{V_{O V 1}\\left(\\lambda_{2}+\\lambda_{4}\\right)} \\times \\frac{2}{V_{O V 5}\\left(\\lambda_{5}+\\lambda_{6}\\right)} \\tag{5.25b}\n\\end{equation*}\n$$\n\nIf the op amp is implemented with FETs having the same channel length $L$ and overdrive voltage $V_{O V}$, the gain can be concisely expressed as\n\n$$\n\\begin{equation*}\na=\\left[\\frac{2 L}{V_{O V}\\left(\\lambda_{n}^{\\prime}+\\lambda_{p}^{\\prime}\\right)}\\right]^{2} \\tag{5.25c}\n\\end{equation*}\n$$\n\nwhere, according to Eq. (4.31), $\\lambda_{n}^{\\prime}$ and $\\lambda_{p}^{\\prime}$ are the process parameters describing channel-length modulation in the $n$ FETs and $p$ FETs, respectively. Clearly, a longer $L$ and a lower $V_{O V}$ result in higher gain. The AC resistances between the two inputs and between the output and ground are, respectively,\n\n$$\n\\begin{equation*}\nR_{i}=\\infty \\quad R_{o}=r_{o 5} / / r_{o 6} \\tag{5.26}\n\\end{equation*}\n$$\n\nWe observe a close similarity between the CMOS stages of Fig. 5.13 and the first and second stages of the 741 op amp in Fig. 5.2. In fact, due to the infinite resistance at the gates, the CMOS stages are significantly simpler. We also note the absence of an output stage, even though $R_{o}$ can be quite high. Typically, an op amp of the type shown in Fig. 5.13 is intended to drive other on-chip CMOS circuits that also present infinite input resistance (though not necessarily zero capacitance), thus eliminating the need for a dedicated output stage. Only when designed to drive resistive loads, usually off-chip, will a two-stage op amp include a dedicated third stage. This might be an output stage of the type discussed in Section 4.11."
},
{
    "text": "This traditional CMOS operational amplifier configuration, along with its variants, is particularly prevalent in mixed-mode integrated circuits. Illustrated in its fundamental form in Fig. 5.13, it encompasses two gain stages and a direct current (dc) biasing circuit as detailed below:\n\n- The initial or input stage is composed of the $p$-channel differential pair $M_{1}-M_{2}$ and the $n$-channel current mirror load $M_{3}-M_{4}$. As previously discussed, its voltage gain is given by\n\n$$\n\\begin{equation*}\na_{1}=-g_{m 1}\\left(r_{o 2} / / r_{o 4}\\right) \\tag{5.23}\n\\end{equation*}\n$$\n\nimage_name:Figure 5.13 Two-stage CMOS op amp\ndescription:\n[\nname: M1, type: PMOS, ports: {S: x3, D: x2, G: vN}\nname: M2, type: PMOS, ports: {S: x3, D: x1, G: vP}\nname: M3, type: NMOS, ports: {S: Vss, D: x2, G: x2}\nname: M4, type: NMOS, ports: {S: GND, D: x1, G: x2}\nname: M5, type: NMOS, ports: {S: Vss, D: vO, G: x1}\nname: M6, type: PMOS, ports: {S: VDD, D: vO, G: x4}\nname: M7, type: PMOS, ports: {S: VDD, D: x3, G: x4}\nname: M8, type: PMOS, ports: {S: VDD, D: x4, G: x4}\nname: I_REF, type: CurrentSource, ports: {Np: x4, Nn: VSS}\nname: R_C, type: Resistor, value: R_C, ports: {N1: x1, N2: RC}\nname: C_C, type: Capacitor, value: C_C, ports: {Np: RC, Nn: vO}\n]\nextrainfo:The circuit is a two-stage CMOS operational amplifier featuring a differential input stage and a common-source output stage. It includes a compensation network comprising R_C and C_C for stability.\n\nFIGURE 5.13 Two-stage CMOS op amp.\n\n- The second or output stage comprises the common-source (CS) amplifier $M_{5}$ and the active load $M_{6}$. (Additionally, an $R_{c}-C_{c}$ network is depicted, which serves to stabilize the amplifier against potential oscillations during negative-feedback operation, a topic covered in Chapter 7. For the current analysis, which is confined to low frequencies where $C_{c}$ acts as an open circuit, the $R_{c}-C_{c}$ network will be disregarded.) The low-frequency voltage gain of this stage is\n\n$$\n\\begin{equation*}\na_{2}=-g_{m 5}\\left(r_{o 5} / / r_{o 6}\\right) \\tag{5.24}\n\\end{equation*}\n$$\n\n- The dc biasing circuit includes the dual-output current mirror $M_{6}-M_{7}-M_{8}$, along with the $I_{R E F}$ current reference. The specifics of this reference have been omitted for simplicity, but it is typically a shared circuit among various op amps on the same chip. It produces a regulated current $I_{R E F}$, which is then duplicated by a multiple-output current mirror to each of the other on-chip op amps. In Fig. 5.13, $I_{R E F}$ is replicated by $M_{7}$ to bias the $M_{1}-M_{2}$ pair and by $M_{6}$ to actively load the CS stage $M_{5}$. Due to the infinite resistance at $M_{5}$'s gate, there is no inter-stage loading, resulting in the overall gain being simply the product of the individual gains\n\n$$\n\\begin{equation*}\na=\\frac{v_{o}}{v_{p}-v_{n}}=a_{1} \\times a_{2}=g_{m 1}\\left(r_{o 2} / / r_{o 4}\\right) g_{m 5}\\left(r_{o 5} / / r_{o 6}\\right) \\tag{5.25a}\n\\end{equation*}\n$$\n\nBy adapting Eq. (4.152) to this scenario, we can express the gain in a more insightful form\n\n$$\n\\begin{equation*}\na=\\frac{2}{V_{O V 1}\\left(\\lambda_{2}+\\lambda_{4}\\right)} \\times \\frac{2}{V_{O V 5}\\left(\\lambda_{5}+\\lambda_{6}\\right)} \\tag{5.25b}\n\\end{equation*}\n$$\n\nIf the op amp is constructed using FETs with identical channel length $L$ and overdrive voltage $V_{O V}$, the gain can be succinctly expressed as\n\n$$\n\\begin{equation*}\na=\\left[\\frac{2 L}{V_{O V}\\left(\\lambda_{n}^{\\prime}+\\lambda_{p}^{\\prime}\\right)}\\right]^{2} \\tag{5.25c}\n\\end{equation*}\n$$\n\nwhere, according to Eq. (4.31), $\\lambda_{n}^{\\prime}$ and $\\lambda_{p}^{\\prime}$ are the process parameters that describe channel-length modulation in the $n$ FETs and $p$ FETs, respectively. Clearly, a longer $L$ and a lower $V_{O V}$ result in a higher gain. The alternating current (ac) resistances between the two inputs and between the output and ground are, respectively,\n\n$$\n\\begin{equation*}\nR_{i}=\\infty \\quad R_{o}=r_{o 5} / / r_{o 6} \\tag{5.26}\n\\end{equation*}\n$$\n\nWe observe a strong similarity between the CMOS stages in Fig. 5.13 and the first and second stages of the 741 op amp in Fig. 5.2. In fact, due to the infinite resistance at the gates, the CMOS stages are significantly simpler. We also note the absence of an output stage, even though $R_{o}$ can be quite high. Typically, an op amp of the type shown in Fig. 5.13 is intended to drive other on-chip CMOS circuits that also present infinite input resistance (though not necessarily zero capacitance), eliminating the need for a dedicated output stage. Only when designed to drive resistive loads, usually off-chip, will a two-stage op amp be equipped with a dedicated third stage. This might be an output stage of the type discussed in Section 4.11."
},
{
    "text": "This traditional CMOS operational amplifier configuration, along with its variants, is particularly prevalent in mixed-mode integrated circuits. Illustrated in its fundamental form in Fig. 5.13, it consists of two gain stages and a dc biasing circuit as follows:\n\n- The first or input stage is composed of the $p$-channel differential pair $M_{1}-M_{2}$ and the $n$-channel mirror load $M_{3}-M_{4}$. As known, its voltage gain is\n\n$$\n\\begin{equation*}\na_{1}=-g_{m 1}\\left(r_{o 2} / / r_{o 4}\\right) \\tag{5.23}\n\\end{equation*}\n$$\n\nimage_name: Figure 5.13 Two-stage CMOS op amp\ndescription:\n[\nname: M1, type: PMOS, ports: {S: x3, D: x2, G: vN}\nname: M2, type: PMOS, ports: {S: x3, D: x1, G: vP}\nname: M3, type: NMOS, ports: {S: Vss, D: x2, G: x2}\nname: M4, type: NMOS, ports: {S: GND, D: x1, G: x2}\nname: M5, type: NMOS, ports: {S: Vss, D: vO, G: x1}\nname: M6, type: PMOS, ports: {S: VDD, D: vO, G: x4}\nname: M7, type: PMOS, ports: {S: VDD, D: x3, G: x4}\nname: M8, type: PMOS, ports: {S: VDD, D: x4, G: x4}\nname: I_REF, type: CurrentSource, ports: {Np: x4, Nn: VSS}\nname: R_C, type: Resistor, value: R_C, ports: {N1: x1, N2: RC}\nname: C_C, type: Capacitor, value: C_C, ports: {Np: RC, Nn: vO}\n]\nextrainfo: The circuit is a two-stage CMOS operational amplifier featuring a differential input stage and a common-source output stage. It includes a compensation network with R_C and C_C for stability.\n\nFIGURE 5.13 Two-stage CMOS op amp.\n\n- The second or output stage includes the CS amplifier $M_{5}$ and the active load $M_{6}$. (Also depicted is an $R_{c}-C_{c}$ network, which serves to stabilize the amplifier against potential oscillations in negative-feedback operation, a topic covered in Chapter 7. The current analysis is confined to low frequencies, where $C_{c}$ acts as an open circuit, thus the $R_{c}-C_{c}$ network will be disregarded.) The low-frequency voltage gain of this stage is\n\n$$\n\\begin{equation*}\na_{2}=-g_{m 5}\\left(r_{o 5} / / r_{o 6}\\right) \\tag{5.24}\n\\end{equation*}\n$$\n\n- The dc biasing circuit comprises the dual-output current mirror $M_{6}-M_{7}-M_{8}$, along with the $I_{R E F}$ current reference. The specifics of this reference are omitted for simplicity, but it is typically a shared circuit among various op amps on the same chip. It produces a regulated current $I_{R E F}$ once, which is then duplicated by a multiple-output current mirror to each of the other on-chip op amps. In Fig. 5.13, $I_{R E F}$ is duplicated by $M_{7}$ to bias the $M_{1}-M_{2}$ pair, and by $M_{6}$ to actively load the CS stage $M_{5}$. Due to the infinite resistance at $M_{5}$'s gate, there is no inter-stage loading, so the overall gain is simply the product of the individual gains\n\n$$\n\\begin{equation*}\na=\\frac{v_{o}}{v_{p}-v_{n}}=a_{1} \\times a_{2}=g_{m 1}\\left(r_{o 2} / / r_{o 4}\\right) g_{m 5}\\left(r_{o 5} / / r_{o 6}\\right) \\tag{5.25a}\n\\end{equation*}\n$$\n\nBy adapting Eq. (4.152) to this scenario, we express the gain in an insightful alternative form\n\n$$\n\\begin{equation*}\na=\\frac{2}{V_{O V 1}\\left(\\lambda_{2}+\\lambda_{4}\\right)} \\times \\frac{2}{V_{O V 5}\\left(\\lambda_{5}+\\lambda_{6}\\right)} \\tag{5.25b}\n\\end{equation*}\n$$\n\nIf the op amp is implemented with FETs having identical channel length $L$ and overdrive voltage $V_{O V}$, then the gain can be concisely expressed as\n\n$$\n\\begin{equation*}\na=\\left[\\frac{2 L}{V_{O V}\\left(\\lambda_{n}^{\\prime}+\\lambda_{p}^{\\prime}\\right)}\\right]^{2} \\tag{5.25c}\n\\end{equation*}\n$$\n\nwhere, according to Eq. (4.31), $\\lambda_{n}^{\\prime}$ and $\\lambda_{p}^{\\prime}$ are the process parameters describing channel-length modulation in the $n$ FETs and $p$ FETs, respectively. Clearly, longer $L$ and lower $V_{O V}$ result in higher gain. The ac resistances between the two inputs and between the output and ground are, respectively,\n\n$$\n\\begin{equation*}\nR_{i}=\\infty \\quad R_{o}=r_{o 5} / / r_{o 6} \\tag{5.26}\n\\end{equation*}\n$$\n\nWe observe a strong resemblance between the CMOS stages of Fig. 5.13 and the first and second stages of the 741 op amp in Fig. 5.2. In fact, due to the infinite resistance at the gates, the CMOS stages are significantly simpler. We also note the absence of an output stage, even though $R_{o}$ can be quite high. Typically, an op amp of the type shown in Fig. 5.13 is intended to drive other on-chip CMOS circuits that also present infinite input resistance (though not necessarily zero capacitance), eliminating the need for a dedicated output stage. Only when designed to drive resistive loads, usually off-chip, will a two-stage op amp be equipped with a dedicated third stage. This might be an output stage of the type discussed in Section 4.11."
},
{
    "text": "It is crucial to understand that the $W / L$ ratios of $M_{5}$ and $M_{6}$ cannot be chosen arbitrarily; they must adhere to a particular constraint to prevent significant input offset voltage errors. To determine this constraint, observe that since $V_{S G 6} = V_{S G 7}$, $I_{D 6}$ and $I_{D 7}$ must vary in proportion to their $W / L$ ratios as follows:\n\n$$\n\\begin{equation*}\n\\frac{I_{D 6}}{I_{D 7}} = \\frac{W_{6} / L_{6}}{W_{7} / L_{7}} \\tag{5.27a}\n\\end{equation*}\n$$\n\nAdditionally, at dc balance, we have $V_{D S 4} = V_{D S 3}$. Therefore, $V_{G S 5} = V_{D S 4} = V_{D S 3} = V_{G S 3}$, which implies that $I_{D 5}$ and $I_{D 3}$ must scale according to their $W / L$ ratios as:\n\n$$\n\\begin{equation*}\n\\frac{I_{D 5}}{I_{D 3}} = \\frac{W_{5} / L_{5}}{W_{3} / L_{3}} \\tag{5.27b}\n\\end{equation*}\n$$\n\nHowever, $I_{D 5} = I_{D 6}$ and $I_{D 3} = I_{D 7} / 2$. Substituting these into Eq. (5.27) and simplifying yields the critical constraint:\n\n$$\n\\begin{equation*}\n\\frac{W_{5} / L_{5}}{W_{3} / L_{3}} = 2 \\frac{W_{6} / L_{6}}{W_{7} / L_{7}} \\tag{5.28}\n\\end{equation*}\n$$\n\nOnce this condition is fulfilled, any mismatches in $k$ and $V_{t}$ within the $M_{1}-M_{2}$ and $M_{3}-M_{4}$ pairs will cause the first stage to exhibit an input offset voltage as described by Eq. (4.161). Tailoring this to the current scenario, we get:\n\n$$\n\\begin{equation*}\nV_{O S(1 \\text{st stage})} \\approx \\frac{V_{O V_{p}}}{2} \\sqrt{\\left(\\frac{\\Delta k_{p}}{k_{p}}\\right)^{2} + \\left(\\frac{\\Delta k_{n}}{k_{n}}\\right)^{2} + \\left(\\frac{\\Delta V_{t p}}{0.5 V_{O V_{p}}}\\right)^{2} + \\left(\\frac{\\Delta V_{t n}}{0.5 V_{O V_{p}}}\\right)^{2}} \\tag{5.29}\n\\end{equation*}\n$$\n\nHere, subscripts $p$ and $n$ correspond to the $M_{1}-M_{2}$ and $M_{3}-M_{4}$ pairs, respectively. Even if the $M_{1}-M_{2}$ and $M_{3}-M_{4}$ pairs are perfectly matched, setting $v_{P} = v_{N} = 0$ may still result in $v_{O} \\neq 0$ due to a potential imbalance between $M_{5}$ and $M_{6}$. This imbalance, when reflected to the input, will contribute an additional component to $V_{O S}$ (this topic is further examined in the end-of-chapter problems)."
},
{
    "text": "It's crucial to understand that the $W / L$ ratios of $M_{5}$ and $M_{6}$ cannot be set arbitrarily; they must adhere to a specific condition to prevent significant input offset voltage errors. To determine this condition, observe that since $V_{S G 6}=V_{S G 7}$, $I_{D 6}$ and $I_{D 7}$ must vary in proportion to their $W / L$ ratios as follows:\n\n$$\n\\begin{equation*}\n\\frac{I_{D 6}}{I_{D 7}}=\\frac{W_{6} / L_{6}}{W_{7} / L_{7}} \\tag{5.27a}\n\\end{equation*}\n$$\n\nAdditionally, at dc balance, $V_{D S 4}=V_{D S 3}$. Therefore, $V_{G S 5}=V_{D S 4}=V_{D S 3}=V_{G S 3}$, which implies that $I_{D 5}$ and $I_{D 3}$ must also scale in proportion to their $W / L$ ratios as:\n\n$$\n\\begin{equation*}\n\\frac{I_{D 5}}{I_{D 3}}=\\frac{W_{5} / L_{5}}{W_{3} / L_{3}} \\tag{5.27b}\n\\end{equation*}\n$$\n\nGiven that $I_{D 5}=I_{D 6}$ and $I_{D 3}=I_{D 7} / 2$, substituting these into Eq. (5.27) and simplifying yields the critical constraint:\n\n$$\n\\begin{equation*}\n\\frac{W_{5} / L_{5}}{W_{3} / L_{3}}=2 \\frac{W_{6} / L_{6}}{W_{7} / L_{7}} \\tag{5.28}\n\\end{equation*}\n$$\n\nOnce this constraint is fulfilled, any $k$ and $V_{t}$ mismatches in the $M_{1}-M_{2}$ and $M_{3}-M_{4}$ pairs will cause the first stage to exhibit an input offset voltage as described by Eq. (4.161). Adjusting this to the current scenario, we get:\n\n$$\n\\begin{equation*}\nV_{O S(1 \\text { ststage })} \\cong \\frac{V_{O V_{p}}}{2} \\sqrt{\\left(\\frac{\\Delta k_{p}}{k_{p}}\\right)^{2}+\\left(\\frac{\\Delta k_{n}}{k_{n}}\\right)^{2}+\\left(\\frac{\\Delta V_{t p}}{0.5 V_{O V_{p}}}\\right)^{2}+\\left(\\frac{\\Delta V_{t n}}{0.5 V_{O V_{p}}}\\right)^{2}} \\tag{5.29}\n\\end{equation*}\n$$\n\nHere, subscripts $p$ and $n$ correspond to the $M_{1}-M_{2}$ and $M_{3}-M_{4}$ pairs, respectively. Even if the $M_{1}-M_{2}$ and $M_{3}-M_{4}$ pairs are perfectly matched, setting $v_{P}=v_{N}=0$ might still result in $v_{O} \\neq 0$ due to a potential imbalance between $M_{5}$ and $M_{6}$. This imbalance, when reflected to the input, adds an extra component to $V_{O S}$ (this topic is further examined in the chapter-end problems)."
},
{
    "text": "It is crucial to understand that the $W / L$ ratios of $M_{5}$ and $M_{6}$ cannot be chosen arbitrarily; they must adhere to a particular constraint to prevent significant input offset voltage errors. To determine this constraint, observe that because $V_{S G 6} = V_{S G 7}$, $I_{D 6}$ and $I_{D 7}$ must vary in proportion to their $W / L$ ratios as follows:\n\n$$\n\\begin{equation*}\n\\frac{I_{D 6}}{I_{D 7}} = \\frac{W_{6} / L_{6}}{W_{7} / L_{7}} \\tag{5.27a}\n\\end{equation*}\n$$\n\nAdditionally, at dc balance, we have $V_{D S 4} = V_{D S 3}$. Therefore, $V_{G S 5} = V_{D S 4} = V_{D S 3} = V_{G S 3}$, which implies that $I_{D 5}$ and $I_{D 3}$ must also scale in proportion to their $W / L$ ratios as:\n\n$$\n\\begin{equation*}\n\\frac{I_{D 5}}{I_{D 3}} = \\frac{W_{5} / L_{5}}{W_{3} / L_{3}} \\tag{5.27b}\n\\end{equation*}\n$$\n\nHowever, $I_{D 5} = I_{D 6}$ and $I_{D 3} = I_{D 7} / 2$. Substituting these into Eq. (5.27) and simplifying yields the key constraint:\n\n$$\n\\begin{equation*}\n\\frac{W_{5} / L_{5}}{W_{3} / L_{3}} = 2 \\frac{W_{6} / L_{6}}{W_{7} / L_{7}} \\tag{5.28}\n\\end{equation*}\n$$\n\nOnce this constraint is fulfilled, any $k$ and $V_{t}$ mismatches in the $M_{1}-M_{2}$ and $M_{3}-M_{4}$ pairs will cause the first stage to exhibit an input offset voltage as described by Eq. (4.161). Adapting this to the current scenario, we obtain:\n\n$$\n\\begin{equation*}\nV_{O S(1 \\text{st stage})} \\approx \\frac{V_{O V_{p}}}{2} \\sqrt{\\left(\\frac{\\Delta k_{p}}{k_{p}}\\right)^{2} + \\left(\\frac{\\Delta k_{n}}{k_{n}}\\right)^{2} + \\left(\\frac{\\Delta V_{t p}}{0.5 V_{O V_{p}}}\\right)^{2} + \\left(\\frac{\\Delta V_{t n}}{0.5 V_{O V_{p}}}\\right)^{2}} \\tag{5.29}\n\\end{equation*}\n$$\n\nHere, subscripts $p$ and $n$ correspond to the $M_{1}-M_{2}$ and $M_{3}-M_{4}$ pairs, respectively. Even if the $M_{1}-M_{2}$ and $M_{3}-M_{4}$ pairs are perfectly matched, setting $v_{P} = v_{N} = 0$ may still result in $v_{O} \\neq 0$ due to a potential imbalance between $M_{5}$ and $M_{6}$. This imbalance, when reflected to the input, will contribute an additional component to $V_{O S}$ (this topic is further examined in the end-of-chapter problems)."
},
{
    "text": "It is crucial to understand that the $W / L$ ratios of $M_{5}$ and $M_{6}$ cannot be chosen arbitrarily; they must adhere to a specific condition to prevent significant input offset voltage errors. To determine this condition, observe that since $V_{S G 6} = V_{S G 7}$, $I_{D 6}$ and $I_{D 7}$ must scale according to their $W / L$ ratios as follows:\n\n$$\n\\begin{equation*}\n\\frac{I_{D 6}}{I_{D 7}} = \\frac{W_{6} / L_{6}}{W_{7} / L_{7}} \\tag{5.27a}\n\\end{equation*}\n$$\n\nAdditionally, at dc balance, we have $V_{D S 4} = V_{D S 3}$. Consequently, $V_{G S 5} = V_{D S 4} = V_{D S 3} = V_{G S 3}$, which implies that $I_{D 5}$ and $I_{D 3}$ must scale in proportion to their $W / L$ ratios as:\n\n$$\n\\begin{equation*}\n\\frac{I_{D 5}}{I_{D 3}} = \\frac{W_{5} / L_{5}}{W_{3} / L_{3}} \\tag{5.27b}\n\\end{equation*}\n$$\n\nHowever, $I_{D 5} = I_{D 6}$ and $I_{D 3} = I_{D 7} / 2$. Substituting these into Eq. (5.27) and simplifying yields the critical constraint:\n\n$$\n\\begin{equation*}\n\\frac{W_{5} / L_{5}}{W_{3} / L_{3}} = 2 \\frac{W_{6} / L_{6}}{W_{7} / L_{7}} \\tag{5.28}\n\\end{equation*}\n$$\n\nOnce this constraint is fulfilled, any mismatches in $k$ and $V_{t}$ within the $M_{1}-M_{2}$ and $M_{3}-M_{4}$ pairs will cause the first stage to exhibit an input offset voltage as described by Eq. (4.161). Adapting this to the current scenario, we obtain:\n\n$$\n\\begin{equation*}\nV_{O S(1 \\text{st stage})} \\approx \\frac{V_{O V_{p}}}{2} \\sqrt{\\left(\\frac{\\Delta k_{p}}{k_{p}}\\right)^{2} + \\left(\\frac{\\Delta k_{n}}{k_{n}}\\right)^{2} + \\left(\\frac{\\Delta V_{t p}}{0.5 V_{O V_{p}}}\\right)^{2} + \\left(\\frac{\\Delta V_{t n}}{0.5 V_{O V_{p}}}\\right)^{2}} \\tag{5.29}\n\\end{equation*}\n$$\n\nHere, subscripts $p$ and $n$ correspond to the $M_{1}-M_{2}$ and $M_{3}-M_{4}$ pairs, respectively. Even if the $M_{1}-M_{2}$ and $M_{3}-M_{4}$ pairs are perfectly matched, setting $v_{P} = v_{N} = 0$ may still result in $v_{O} \\neq 0$ due to a potential imbalance between $M_{5}$ and $M_{6}$. This imbalance, when reflected to the input, will introduce an additional component to $V_{O S}$ (this topic is further examined in the end-of-chapter problems)."
},
{
    "text": "It is crucial to understand that the $W / L$ ratios of $M_{5}$ and $M_{6}$ cannot be chosen arbitrarily; they must adhere to a specific condition to prevent significant input offset voltage errors. To determine this condition, observe that because $V_{S G 6}=V_{S G 7}$, $I_{D 6}$ and $I_{D 7}$ must vary in proportion to their $W / L$ ratios as follows:\n\n$$\n\\begin{equation*}\n\\frac{I_{D 6}}{I_{D 7}}=\\frac{W_{6} / L_{6}}{W_{7} / L_{7}} \\tag{5.27a}\n\\end{equation*}\n$$\n\nAdditionally, at dc balance, $V_{D S 4}=V_{D S 3}$. Therefore, $V_{G S 5}=V_{D S 4}=V_{D S 3}=$ $V_{G S 3}$, which implies that $I_{D 5}$ and $I_{D 3}$ must also scale according to their $W / L$ ratios as:\n\n$$\n\\begin{equation*}\n\\frac{I_{D 5}}{I_{D 3}}=\\frac{W_{5} / L_{5}}{W_{3} / L_{3}} \\tag{5.27b}\n\\end{equation*}\n$$\n\nHowever, $I_{D 5}=I_{D 6}$ and $I_{D 3}=I_{D 7} / 2$. Substituting these into Eq. (5.27) and simplifying yields the critical constraint:\n\n$$\n\\begin{equation*}\n\\frac{W_{5} / L_{5}}{W_{3} / L_{3}}=2 \\frac{W_{6} / L_{6}}{W_{7} / L_{7}} \\tag{5.28}\n\\end{equation*}\n$$\n\nOnce this constraint is fulfilled, any mismatches in $k$ and $V_{t}$ within the $M_{1}-M_{2}$ and $M_{3}-M_{4}$ pairs will cause the first stage to exhibit an input offset voltage as described by Eq. (4.161). Adjusting this to the current scenario, we get:\n\n$$\n\\begin{equation*}\nV_{O S(1 \\text { ststage })} \\cong \\frac{V_{O V_{p}}}{2} \\sqrt{\\left(\\frac{\\Delta k_{p}}{k_{p}}\\right)^{2}+\\left(\\frac{\\Delta k_{n}}{k_{n}}\\right)^{2}+\\left(\\frac{\\Delta V_{t p}}{0.5 V_{O V_{p}}}\\right)^{2}+\\left(\\frac{\\Delta V_{t n}}{0.5 V_{O V_{p}}}\\right)^{2}} \\tag{5.29}\n\\end{equation*}\n$$\n\nHere, subscripts $p$ and $n$ correspond to the $M_{1}-M_{2}$ and $M_{3}-M_{4}$ pairs, respectively. Even if the $M_{1}-M_{2}$ and $M_{3}-M_{4}$ pairs are perfectly matched, setting $v_{P}=v_{N}=0$ may still result in $v_{O} \\neq 0$ due to a potential imbalance between $M_{5}$ and $M_{6}$. This imbalance, when reflected to the input, adds an extra component to $V_{O S}$ (this topic is further examined in the end-of-chapter problems)."
},
{
    "text": "It is crucial to understand that the $W / L$ ratios of $M_{5}$ and $M_{6}$ cannot be set arbitrarily; they must adhere to a specific condition to prevent significant input offset voltage errors. To determine this condition, observe that since $V_{S G 6}=V_{S G 7}$, $I_{D 6}$ and $I_{D 7}$ must vary in proportion to their $W / L$ ratios as follows:\n\n$$\n\\begin{equation*}\n\\frac{I_{D 6}}{I_{D 7}}=\\frac{W_{6} / L_{6}}{W_{7} / L_{7}} \\tag{5.27a}\n\\end{equation*}\n$$\n\nAdditionally, at dc balance, $V_{D S 4}=V_{D S 3}$. Therefore, $V_{G S 5}=V_{D S 4}=V_{D S 3}=V_{G S 3}$, which implies that $I_{D 5}$ and $I_{D 3}$ must also scale in proportion to their $W / L$ ratios as:\n\n$$\n\\begin{equation*}\n\\frac{I_{D 5}}{I_{D 3}}=\\frac{W_{5} / L_{5}}{W_{3} / L_{3}} \\tag{5.27b}\n\\end{equation*}\n$$\n\nHowever, $I_{D 5}=I_{D 6}$ and $I_{D 3}=I_{D 7} / 2$. Substituting these into Eq. (5.27) and simplifying yields the crucial constraint:\n\n$$\n\\begin{equation*}\n\\frac{W_{5} / L_{5}}{W_{3} / L_{3}}=2 \\frac{W_{6} / L_{6}}{W_{7} / L_{7}} \\tag{5.28}\n\\end{equation*}\n$$\n\nOnce this constraint is fulfilled, any $k$ and $V_{t}$ mismatches in the $M_{1}-M_{2}$ and $M_{3}-M_{4}$ pairs will cause the first stage to exhibit an input offset voltage as described by Eq. (4.161). Adapting this to the current scenario, we obtain:\n\n$$\n\\begin{equation*}\nV_{O S(1 \\text { ststage })} \\cong \\frac{V_{O V_{p}}}{2} \\sqrt{\\left(\\frac{\\Delta k_{p}}{k_{p}}\\right)^{2}+\\left(\\frac{\\Delta k_{n}}{k_{n}}\\right)^{2}+\\left(\\frac{\\Delta V_{t p}}{0.5 V_{O V_{p}}}\\right)^{2}+\\left(\\frac{\\Delta V_{t n}}{0.5 V_{O V_{p}}}\\right)^{2}} \\tag{5.29}\n\\end{equation*}\n$$\n\nHere, subscripts $p$ and $n$ correspond to the $M_{1}-M_{2}$ and $M_{3}-M_{4}$ pairs, respectively. Even if the $M_{1}-M_{2}$ and $M_{3}-M_{4}$ pairs are perfectly matched, setting $v_{P}=v_{N}=0$ may still result in $v_{O} \\neq 0$ due to a potential imbalance between $M_{5}$ and $M_{6}$. This imbalance, when reflected to the input, adds an extra component to $V_{O S}$ (this topic is further examined in the end-of-chapter problems)."
},
{
    "text": "It is crucial to understand that the $W / L$ ratios of $M_{5}$ and $M_{6}$ cannot be chosen arbitrarily; they must adhere to a particular constraint to prevent significant input offset voltage errors. To determine this constraint, observe that since $V_{S G 6} = V_{S G 7}$, $I_{D 6}$ and $I_{D 7}$ must vary in proportion to their $W / L$ ratios as follows:\n\n$$\n\\begin{equation*}\n\\frac{I_{D 6}}{I_{D 7}} = \\frac{W_{6} / L_{6}}{W_{7} / L_{7}} \\tag{5.27a}\n\\end{equation*}\n$$\n\nAdditionally, at dc balance, $V_{D S 4} = V_{D S 3}$. Therefore, $V_{G S 5} = V_{D S 4} = V_{D S 3} = V_{G S 3}$, which implies that $I_{D 5}$ and $I_{D 3}$ must also scale according to their $W / L$ ratios as:\n\n$$\n\\begin{equation*}\n\\frac{I_{D 5}}{I_{D 3}} = \\frac{W_{5} / L_{5}}{W_{3} / L_{3}} \\tag{5.27b}\n\\end{equation*}\n$$\n\nHowever, $I_{D 5} = I_{D 6}$ and $I_{D 3} = I_{D 7} / 2$. Substituting these into Eq. (5.27) and simplifying yields the critical constraint:\n\n$$\n\\begin{equation*}\n\\frac{W_{5} / L_{5}}{W_{3} / L_{3}} = 2 \\frac{W_{6} / L_{6}}{W_{7} / L_{7}} \\tag{5.28}\n\\end{equation*}\n$$\n\nOnce this constraint is fulfilled, any mismatches in $k$ and $V_{t}$ within the $M_{1}-M_{2}$ and $M_{3}-M_{4}$ pairs will cause the first stage to exhibit an input offset voltage as described by Eq. (4.161). Adapted to the current scenario, we get:\n\n$$\n\\begin{equation*}\nV_{O S(1 \\text{st stage})} \\approx \\frac{V_{O V_{p}}}{2} \\sqrt{\\left(\\frac{\\Delta k_{p}}{k_{p}}\\right)^{2} + \\left(\\frac{\\Delta k_{n}}{k_{n}}\\right)^{2} + \\left(\\frac{\\Delta V_{t p}}{0.5 V_{O V_{p}}}\\right)^{2} + \\left(\\frac{\\Delta V_{t n}}{0.5 V_{O V_{p}}}\\right)^{2}} \\tag{5.29}\n\\end{equation*}\n$$\n\nHere, subscripts $p$ and $n$ correspond to the $M_{1}-M_{2}$ and $M_{3}-M_{4}$ pairs, respectively. Even if the $M_{1}-M_{2}$ and $M_{3}-M_{4}$ pairs are perfectly matched, setting $v_{P} = v_{N} = 0$ might still result in $v_{O} \\neq 0$ due to a potential imbalance between $M_{5}$ and $M_{6}$. This imbalance, when reflected to the input, will contribute an additional component to $V_{O S}$ (this topic is further examined in the end-of-chapter problems)."
},
{
    "text": "It is crucial to understand that the $W / L$ ratios of $M_{5}$ and $M_{6}$ cannot be chosen arbitrarily; they must adhere to a specific constraint to prevent significant input offset voltage errors. To determine this constraint, observe that because $V_{S G 6} = V_{S G 7}$, $I_{D 6}$ and $I_{D 7}$ must vary in proportion to their $W / L$ ratios as follows:\n\n$$\n\\begin{equation*}\n\\frac{I_{D 6}}{I_{D 7}} = \\frac{W_{6} / L_{6}}{W_{7} / L_{7}} \\tag{5.27a}\n\\end{equation*}\n$$\n\nAdditionally, at dc balance, we have $V_{D S 4} = V_{D S 3}$. Therefore, $V_{G S 5} = V_{D S 4} = V_{D S 3} = V_{G S 3}$, which implies that $I_{D 5}$ and $I_{D 3}$ must also scale according to their $W / L$ ratios as:\n\n$$\n\\begin{equation*}\n\\frac{I_{D 5}}{I_{D 3}} = \\frac{W_{5} / L_{5}}{W_{3} / L_{3}} \\tag{5.27b}\n\\end{equation*}\n$$\n\nHowever, $I_{D 5} = I_{D 6}$ and $I_{D 3} = I_{D 7} / 2$. Substituting these into Eq. (5.27) and simplifying yields the key constraint:\n\n$$\n\\begin{equation*}\n\\frac{W_{5} / L_{5}}{W_{3} / L_{3}} = 2 \\frac{W_{6} / L_{6}}{W_{7} / L_{7}} \\tag{5.28}\n\\end{equation*}\n$$\n\nOnce this constraint is fulfilled, any mismatches in $k$ and $V_{t}$ within the $M_{1}-M_{2}$ and $M_{3}-M_{4}$ pairs will cause the first stage to display an input offset voltage as described by Eq. (4.161). Adjusting for the current scenario, we get:\n\n$$\n\\begin{equation*}\nV_{O S(1 \\text{st stage})} \\approx \\frac{V_{O V_{p}}}{2} \\sqrt{\\left(\\frac{\\Delta k_{p}}{k_{p}}\\right)^{2} + \\left(\\frac{\\Delta k_{n}}{k_{n}}\\right)^{2} + \\left(\\frac{\\Delta V_{t p}}{0.5 V_{O V_{p}}}\\right)^{2} + \\left(\\frac{\\Delta V_{t n}}{0.5 V_{O V_{p}}}\\right)^{2}} \\tag{5.29}\n\\end{equation*}\n$$\n\nHere, subscripts $p$ and $n$ correspond to the $M_{1}-M_{2}$ and $M_{3}-M_{4}$ pairs, respectively. Even if the $M_{1}-M_{2}$ and $M_{3}-M_{4}$ pairs are perfectly matched, setting $v_{P} = v_{N} = 0$ may still result in $v_{O} \\neq 0$ due to a potential imbalance between $M_{5}$ and $M_{6}$. This imbalance, when reflected to the input, will introduce an additional component to $V_{O S}$ (this topic is further examined in the end-of-chapter problems)."
},
{
    "text": "In negative-feedback mode, the op amp makes $v_{N}$ follow $v_{P}$, resulting in the common-mode input voltage $v_{I C}=1 / 2\\left(v_{P}+v_{N}\\right) \\approx v_{P}$. Our goal is to determine the common-mode input voltage range, which is the span of $v_{I C}$ values where the input stage operates correctly, with all FETs in saturation or at the brink of saturation (EOS). The upper boundary is reached when $M_{7}$ hits EOS, where $V_{S D 7}=$ $V_{O V 7}$. By inspecting and applying KVL, we derive $v_{I C(\\max )}=V_{D D}-V_{O V 7}-V_{S G 1}$, specifically,\n\n$$\n\\begin{equation*}\nv_{I C(\\max )}=V_{D D}-V_{O V 7}-V_{O V 1}-\\left|V_{t t}\\right| \\tag{5.30a}\n\\end{equation*}\n$$\n\nLikewise, the lower boundary for $v_{I C}$ is achieved when $M_{1}$ reaches EOS, where $V_{S D 1}=$ $V_{O V 1}$. Using inspection and KVL, we write $v_{I C(\\min )}=V_{S S}+V_{G S 3}+V_{S D 1}-V_{S G 1}$. However, $V_{S D 1}-V_{S G 1}=V_{O V 1}-\\left(V_{O V 1}+\\left|V_{t 1}\\right|\\right)=-\\left|V_{t 1}\\right|$, thus\n\n$$\n\\begin{equation*}\nv_{I C(\\min )}=V_{S S}+V_{O V 3}+V_{t 3}-\\left|V_{t}\\right| \\tag{5.30b}\n\\end{equation*}\n$$\n\nIt is evident that in this circuit, $v_{I C(\\max )}$ imposes a stricter constraint than $v_{I C(\\min )}$."
},
{
    "text": "In negative-feedback mode, the op amp ensures that $v_{N}$ mirrors $v_{P}$, resulting in a common-mode input voltage $v_{I C}$ approximately equal to $v_{P}$, given by $v_{I C}=1 / 2\\left(v_{P}+v_{N}\\right) \\cong v_{P}$. Our objective is to determine the common-mode input voltage range, which is the span of $v_{I C}$ values within which the input stage operates correctly, with all FETs in saturation or at the brink of saturation (EOS). The upper boundary is achieved when $M_{7}$ reaches EOS, where $V_{S D 7}=$ $V_{O V 7}$. By inspecting and applying KVL, we derive $v_{I C(\\max )}=V_{D D}-V_{O V 7}-V_{S G 1}$, specifically,\n\n$$\n\\begin{equation*}\nv_{I C(\\max )}=V_{D D}-V_{O V 7}-V_{O V 1}-\\left|V_{t t}\\right| \\tag{5.30a}\n\\end{equation*}\n$$\n\nConversely, the lower boundary for $v_{I C}$ is met when $M_{1}$ hits EOS, where $V_{S D 1}=$ $V_{O V 1}$. Through inspection and KVL, we express $v_{I C(\\min )}=V_{S S}+V_{G S 3}+V_{S D 1}-V_{S G 1}$. However, since $V_{S D 1}-V_{S G 1}=V_{O V 1}-\\left(V_{O V 1}+\\left|V_{t 1}\\right|\\right)=-\\left|V_{t 1}\\right|$, we get\n\n$$\n\\begin{equation*}\nv_{I C(\\min )}=V_{S S}+V_{O V 3}+V_{t 3}-\\left|V_{t}\\right| \\tag{5.30b}\n\\end{equation*}\n$$\n\nIt is clear that in this circuit, $v_{I C(\\max )}$ imposes a stricter constraint than $v_{I C(\\min )}$."
},
{
    "text": "In negative-feedback mode, the op amp ensures $v_{N}$ mirrors $v_{P}$, resulting in a common-mode input voltage $v_{I C}=1 / 2\\left(v_{P}+v_{N}\\right) \\approx v_{P}$. Our goal is to determine the common-mode input voltage range, which is the span of $v_{I C}$ values within which the input stage operates correctly, with all FETs in saturation or at the brink of saturation (EOS). The upper boundary is attained when $M_{7}$ reaches EOS, where $V_{S D 7}=$ $V_{O V 7}$. By inspecting and applying KVL, we derive $v_{I C(\\max )}=V_{D D}-V_{O V 7}-V_{S G 1}$, specifically,\n\n$$\n\\begin{equation*}\nv_{I C(\\max )}=V_{D D}-V_{O V 7}-V_{O V 1}-\\left|V_{t t}\\right| \\tag{5.30a}\n\\end{equation*}\n$$\n\nConversely, the lower limit for $v_{I C}$ is achieved when $M_{1}$ hits EOS, where $V_{S D 1}=$ $V_{O V 1}$. Through inspection and KVL, we formulate $v_{I C(\\min )}=V_{S S}+V_{G S 3}+V_{S D 1}-V_{S G 1}$. Given that $V_{S D 1}-V_{S G 1}=V_{O V 1}-(V_{O V 1}+\\left|V_{t 1}\\right|)=-\\left|V_{t 1}\\right|$, we get\n\n$$\n\\begin{equation*}\nv_{I C(\\min )}=V_{S S}+V_{O V 3}+V_{t 3}-\\left|V_{t}\\right| \\tag{5.30b}\n\\end{equation*}\n$$\n\nIt is evident that in this circuit, $v_{I C(\\max )}$ imposes a stricter constraint than $v_{I C(\\min )}$."
},
{
    "text": "In negative-feedback mode, the op amp ensures $v_{N}$ follows $v_{P}$, resulting in a common-mode input voltage $v_{I C}=1 / 2\\left(v_{P}+v_{N}\\right) \\approx v_{P}$. Our goal is to determine the common-mode input voltage range, which is the span of $v_{I C}$ values where the input stage operates correctly, with all FETs in saturation or at the brink of saturation (EOS). The upper limit occurs when $M_{7}$ reaches EOS, where $V_{S D 7}=$ $V_{O V 7}$. By inspection and KVL, we derive $v_{I C(\\max )}=V_{D D}-V_{O V 7}-V_{S G 1}$, specifically,\n\n$$\n\\begin{equation*}\nv_{I C(\\max )}=V_{D D}-V_{O V 7}-V_{O V 1}-\\left|V_{t t}\\right| \\tag{5.30a}\n\\end{equation*}\n$$\n\nConversely, the lower limit for $v_{I C}$ is attained when $M_{1}$ hits EOS, where $V_{S D 1}=$ $V_{O V 1}$. Through inspection and KVL, we express $v_{I C(\\min )}=V_{S S}+V_{G S 3}+V_{S D 1}-V_{S G 1}$. Since $V_{S D 1}-V_{S G 1}=V_{O V 1}-\\left(V_{O V 1}+\\left|V_{t 1}\\right|\\right)=-\\left|V_{t 1}\\right|$, we get\n\n$$\n\\begin{equation*}\nv_{I C(\\min )}=V_{S S}+V_{O V 3}+V_{t 3}-\\left|V_{t}\\right| \\tag{5.30b}\n\\end{equation*}\n$$\n\nClearly, in this circuit, $v_{I C(\\max )}$ imposes a stricter constraint than $v_{I C(\\min )}$."
},
{
    "text": "In negative-feedback mode, the op amp ensures that $v_{N}$ mirrors $v_{P}$, resulting in a common-mode input voltage of $v_{I C}=1 / 2\\left(v_{P}+v_{N}\\right) \\approx v_{P}$. Our goal is to determine the common-mode input voltage range, which is the span of $v_{I C}$ values within which the input stage operates correctly, with all FETs in saturation or at the brink of saturation (EOS). The upper boundary is achieved when $M_{7}$ reaches EOS, where $V_{S D 7}=$ $V_{O V 7}$. By inspecting and applying KVL, we derive $v_{I C(\\max )}=V_{D D}-V_{O V 7}-V_{S G 1}$, specifically,\n\n$$\n\\begin{equation*}\nv_{I C(\\max )}=V_{D D}-V_{O V 7}-V_{O V 1}-\\left|V_{t t}\\right| \\tag{5.30a}\n\\end{equation*}\n$$\n\nLikewise, the lower boundary for $v_{I C}$ occurs when $M_{1}$ hits EOS, where $V_{S D 1}=$ $V_{O V 1}$. Through inspection and KVL, we express $v_{I C(\\min )}=V_{S S}+V_{G S 3}+V_{S D 1}-V_{S G 1}$. Since $V_{S D 1}-V_{S G 1}=V_{O V 1}-\\left(V_{O V 1}+\\left|V_{t 1}\\right|\\right)=-\\left|V_{t 1}\\right|$, we get\n\n$$\n\\begin{equation*}\nv_{I C(\\min )}=V_{S S}+V_{O V 3}+V_{t 3}-\\left|V_{t}\\right| \\tag{5.30b}\n\\end{equation*}\n$$\n\nIt is evident that in this circuit, $v_{I C(\\max )}$ imposes a stricter constraint than $v_{I C(\\min )}$."
},
{
    "text": "In negative-feedback mode, the op amp ensures that $v_{N}$ follows $v_{P}$, resulting in a common-mode input voltage $v_{I C}=1 / 2\\left(v_{P}+v_{N}\\right) \\approx v_{P}$. Our goal is to determine the common-mode input voltage range, which is the span of $v_{I C}$ values within which the input stage operates correctly, with all FETs in saturation or at the brink of saturation (EOS). The upper limit is attained when $M_{7}$ reaches EOS, where $V_{S D 7}=V_{O V 7}$. By inspecting and applying KVL, we derive $v_{I C(\\max )}=V_{D D}-V_{O V 7}-V_{S G 1}$, specifically,\n\n$$\n\\begin{equation*}\nv_{I C(\\max )}=V_{D D}-V_{O V 7}-V_{O V 1}-\\left|V_{t t}\\right| \\tag{5.30a}\n\\end{equation*}\n$$\n\nLikewise, the lower limit for $v_{I C}$ is reached when $M_{1}$ hits EOS, where $V_{S D 1}=V_{O V 1}$. Through inspection and KVL, we express $v_{I C(\\min )}=V_{S S}+V_{G S 3}+V_{S D 1}-V_{S G 1}$. However, $V_{S D 1}-V_{S G 1}=V_{O V 1}-(V_{O V 1}+\\left|V_{t 1}\\right|)=-\\left|V_{t 1}\\right|$, thus\n\n$$\n\\begin{equation*}\nv_{I C(\\min )}=V_{S S}+V_{O V 3}+V_{t 3}-\\left|V_{t}\\right| \\tag{5.30b}\n\\end{equation*}\n$$\n\nIt is evident that in this circuit, $v_{I C(\\max )}$ imposes a stricter constraint than $v_{I C(\\min )}$."
},
{
    "text": "In negative-feedback mode, the op amp ensures that $v_{N}$ mirrors $v_{P}$, resulting in a common-mode input voltage of $v_{I C}=1 / 2\\left(v_{P}+v_{N}\\right) \\approx v_{P}$. Our goal is to determine the common-mode input voltage range, which is the span of $v_{I C}$ values within which the input stage operates correctly, with all FETs in saturation or at the brink of saturation (EOS). The upper bound is achieved when $M_{7}$ reaches EOS, where $V_{S D 7}=$ $V_{O V 7}$. By inspecting and applying KVL, we derive $v_{I C(\\max )}=V_{D D}-V_{O V 7}-V_{S G 1}$, specifically,\n\n$$\n\\begin{equation*}\nv_{I C(\\max )}=V_{D D}-V_{O V 7}-V_{O V 1}-\\left|V_{t t}\\right| \\tag{5.30a}\n\\end{equation*}\n$$\n\nLikewise, the lower bound for $v_{I C}$ occurs when $M_{1}$ hits EOS, where $V_{S D 1}=$ $V_{O V 1}$. Through inspection and KVL, we express $v_{I C(\\min )}=V_{S S}+V_{G S 3}+V_{S D 1}-V_{S G 1}$. Since $V_{S D 1}-V_{S G 1}=V_{O V 1}-\\left(V_{O V 1}+\\left|V_{t 1}\\right|\\right)=-\\left|V_{t 1}\\right|$, we get\n\n$$\n\\begin{equation*}\nv_{I C(\\min )}=V_{S S}+V_{O V 3}+V_{t 3}-\\left|V_{t}\\right| \\tag{5.30b}\n\\end{equation*}\n$$\n\nIt is evident that in this circuit, $v_{I C(\\max )}$ imposes a stricter constraint than $v_{I C(\\min )}$."
},
{
    "text": "In negative-feedback mode, the op amp ensures $v_{N}$ follows $v_{P}$, leading to a common-mode input voltage $v_{I C}=1 / 2\\left(v_{P}+v_{N}\\right) \\approx v_{P}$. Our goal is to determine the common-mode input voltage range, which is the span of $v_{I C}$ values within which the input stage operates correctly, with all FETs in saturation or at the brink of saturation (EOS). The upper boundary is attained when $M_{7}$ reaches EOS, where $V_{S D 7}=V_{O V 7}$. By inspecting and applying KVL, we derive $v_{I C(\\max )}=V_{D D}-V_{O V 7}-V_{S G 1}$, specifically,\n\n$$\n\\begin{equation*}\nv_{I C(\\max )}=V_{D D}-V_{O V 7}-V_{O V 1}-\\left|V_{t t}\\right| \\tag{5.30a}\n\\end{equation*}\n$$\n\nLikewise, the lower boundary for $v_{I C}$ is achieved when $M_{1}$ hits EOS, where $V_{S D 1}=V_{O V 1}$. Through inspection and KVL, we express $v_{I C(\\min )}=V_{S S}+V_{G S 3}+V_{S D 1}-V_{S G 1}$. However, since $V_{S D 1}-V_{S G 1}=V_{O V 1}-(V_{O V 1}+\\left|V_{t 1}\\right|)=-\\left|V_{t 1}\\right|$, we get\n\n$$\n\\begin{equation*}\nv_{I C(\\min )}=V_{S S}+V_{O V 3}+V_{t 3}-\\left|V_{t}\\right| \\tag{5.30b}\n\\end{equation*}\n$$\n\nIt is clear that in this circuit, $v_{I C(\\max )}$ imposes a stricter limitation compared to $v_{I C(\\min )}$."
},
{
    "text": "This represents the range of $v_{0}$ values over which $M_{5}$ and $M_{6}$ function in saturation or at most at the EOS. By inspection, we quickly determine\n\n$$\n\\begin{equation*}\nv_{O(\\max )}=V_{D D}-V_{O V 6} \\quad v_{O(\\text { min })}=V_{S S}+V_{O V 5} \\tag{5.31}\n\\end{equation*}\n$$\n\nIn simpler terms, $v_{O}$ can fluctuate within a $V_{O V}$ voltage drop from each supply rail.\n\nEXAMPLE 5.2 (a) Consider the two-stage CMOS op amp depicted in Fig. 5.13, fabricated using a process with $k_{n}^{\\prime}=2.5 k_{p}^{\\prime}=100 \\mu \\mathrm{~A} / \\mathrm{V}^{2}, V_{t n}=-V_{t p}=0.75 \\mathrm{~V}, \\lambda_{n}^{\\prime}=$ $0.1 \\mu \\mathrm{~m} / \\mathrm{V}$, and $\\lambda_{p}^{\\prime}=0.05 \\mu \\mathrm{~m} / \\mathrm{V}$. Additionally, all FETs are fabricated with $L=1 \\mu \\mathrm{~m}$ and designed to operate at $V_{O V}=0.25 \\mathrm{~V}$. If the circuit is powered by $\\pm 2.5-\\mathrm{V}$ supplies and utilizes $I_{R E F}=100 \\mu \\mathrm{~A}$, determine appropriate values for $W_{1}$ through $W_{8}$ to bias both stages at $100 \\mu \\mathrm{~A}$ (for simplicity, assume $\\lambda_{n}=\\lambda_{p}=0$ in your dc calculations).\n(b) Calculate the individual-stage gains, the overall gain, the output resistance, the IVR, and the OVS.\n(c) Verify with PSpice and explain any discrepancies between the calculated and simulated values.\n\n#### Solution\n\n(a) $M_{6}, M_{7}$, and $M_{8}$ must each meet the saturation-region condition\n\n$$\n100 \\mu \\mathrm{~A}=\\frac{40 \\mu \\mathrm{~A}}{2} \\frac{W}{1 \\mu \\mathrm{~m}} 0.25^{2}\n$$\n\nyielding $W=80 \\mu \\mathrm{~m}$. Thus, $W_{6}=W_{7}=W_{8}=80 \\mu \\mathrm{~m}$. $M_{1}$ and $M_{2}$ draw half the current of $M_{7}$ but with the same overdrive voltage, so $W_{1}=W_{2}=$ $W_{7} / 2=40 \\mu \\mathrm{~m}$. $M_{3}$ and $M_{4}$ must each satisfy the condition\n\n$$\n50 \\mu \\mathrm{~A}=\\frac{100 \\mu \\mathrm{~A}}{2} \\frac{W}{1 \\mu \\mathrm{~m}} 0.25^{2}\n$$\n\nresulting in $W_{3}=W_{4}=16 \\mu \\mathrm{~m}$. By Eq. $(5.28),\\left(W_{5} / 1\\right) /(16 / 1)=2(80 / 1) /$ (80/1), or $W_{5}=32 \\mu \\mathrm{~m}$. Summarizing,\n\n$$\n\\begin{array}{ll}\nW_{1}=W_{2}=40 \\mu \\mathrm{~m} & W_{3}=W_{4}=16 \\mu \\mathrm{~m} \\\\\nW_{5}=32 \\mu \\mathrm{~m} & W_{6}=W_{7}=W_{8}=80 \\mu \\mathrm{~m}\n\\end{array}\n$$\n\n(b) According to Eq. (5.25c), we have\n\n$$\n\\begin{aligned}\n& \\quad a=\\left[\\frac{2 \\times 1}{0.25(0.1+0.05)}\\right]^{2}=53.3^{2}=2,844 \\mathrm{~V} / \\mathrm{V} \\\\\n& \\text { hence } a_{1}=a_{2}=-53.3 \\mathrm{~V} / \\mathrm{V}. Also, } \\lambda_{n}=\\lambda_{n}^{\\prime} / 1=0.1 \\mathrm{~V}^{-1} \\text { and } \\lambda_{p}=\\lambda_{p}^{\\prime} / 1=0.05 \\mathrm{~V}^{-1}, \\text { so } \\\\\n& r_{o 5}=1 /\\left(0.1 \\times 100 \\times 10^{-6}\\right)=100 \\mathrm{k} \\Omega, r_{o 6}=1 /\\left(0.05 \\times 100 \\times 10^{-6}\\right)=200 \\mathrm{k} \\Omega, \\text { and } \\\\\n& \\quad R_{o}=100 / / 200=66.7 \\mathrm{k} \\Omega\n\\end{aligned}\n$$\n\nFinally, Eqs. (5.30) and (5.31) yield\n\n$$\n\\begin{aligned}\n& v_{I C(\\max )}=2.5-2 \\times 0.25-0.75=1.25 \\mathrm{~V} \\\\\n& v_{I C(\\min )}=v_{O(\\min )}=-2.5+0.25=-2.25 \\mathrm{~V} \\\\\n& v_{O(\\max )}=2.25 \\mathrm{~V}\n\\end{aligned}\n$$\n\n(c) A PSpice simulation using the circuit in Fig. 5.14a produces the VTC shown in Fig. 5.14b, revealing a (systematic) input offset of $166 \\mu \\mathrm{~V}$ and confirming output saturation levels within a $V_{O V}$ of the $\\pm 2.5-\\mathrm{V}$ supplies. (The offset can be corrected by specifying a dc component of $-166 \\mu \\mathrm{~V}$ for the ac input source $v_{p}$.) After instructing PSpice to perform the small-signal analysis (.TF), we obtain $a=v_{o} / v_{p}=4,271 \\mathrm{~V} / \\mathrm{V}$ and $R_{o}=75 \\mathrm{k} \\Omega$. The difference between calculated and simulated values mainly arises from the assumption $\\lambda=0$, particularly when calculating $g_{m 1}$ and $g_{m 5}$. For greater accuracy, we should multiply the calculated $g_{m 1}$ by $\\left(1+\\lambda V_{S D 1}\\right) \\cong(1+0.05 \\times 2.5)=1.125$ and $g_{m 5}$ by $\\left(1+\\lambda V_{D S 5}\\right) \\cong(1+0.1 \\times 2.5)=1.25$. With these adjustments, we get $a_{1} \\cong-53.3 \\times 1.125=-60 \\mathrm{~V} / \\mathrm{V}, a_{2} \\cong-53.3 \\times 1.25=-66.7 \\mathrm{~V} / \\mathrm{V}$, and $a \\cong-4,000 \\mathrm{~V} / \\mathrm{V}$, aligning better with PSpice results.\n\n(a)\nThe circuit depicted in figure (a) is a differential amplifier utilizing PMOS and NMOS transistors. It employs a current source IREF for biasing, with the differential input applied at VP and the output taken at vo. The circuit operates between VDD and VSS supply voltages.\n\n(b)\nThe graph in figure (b) is a Voltage Transfer Characteristic (VTC) curve, illustrating the relationship between the input voltage difference \\( v_P - v_N \\) (in millivolts) on the x-axis and the output voltage \\( v_O \\) (in volts) on the y-axis.\n\n1. **Type of Graph and Function:**\n- This is a Voltage Transfer Characteristic curve, commonly used to depict the behavior of circuits like amplifiers or comparators.\n\n2. **Axes Labels and Units:**\n- The x-axis is labeled \"Input \\( v_P - v_N \\)\" with units in millivolts (mV), ranging from -1.0 mV to 1.0 mV.\n- The y-axis is labeled \"Output \\( v_O \\)\" with units in volts (V), ranging from -2.5 V to 2.5 V.\n- Both axes use a linear scale.\n\n3. **Overall Behavior and Trends:**\n- The graph shows a central linear region where the output voltage increases with the input voltage.\n- At the extremes of the input voltage range, the graph flattens, indicating saturation regions where input voltage changes have minimal impact on the output voltage.\n- The curve transitions smoothly from one saturation region through the linear region to the other saturation region.\n\n4. **Key Features and Technical Details:**\n- The linear region is approximately centered around the origin, indicating a gain where small input voltage changes result in proportional output voltage changes.\n- The saturation regions at both ends represent the output limits of the device.\n\n5. **Annotations and Specific Data Points:**\n- No specific markers or annotations are present on the graph, but critical points include the threshold where the curve begins to deviate from the linear region and the maximum output voltage in the saturation regions.\n- The graph is symmetric around the origin, indicating balanced behavior for positive and negative input voltages.\n\n(b)\n\nFIGURE 5.14 (a) PSpice circuit for Example 5.2, and (b) its VTC. The MOSFET parameters are as follows: $k_{n}^{\\prime}=2.5 k_{p}^{\\prime}=100 \\mu \\mathrm{~A} / \\mathrm{V}^{2}, V_{t n}=-V_{t p}=0.75 \\mathrm{~V}$, and $\\lambda_{n}=2 \\lambda_{\\rho}=0.1 \\mathrm{~V}^{-1}$."
},
{
    "text": "This represents the range of $v_{0}$ values over which $M_{5}$ and $M_{6}$ function in saturation or at most at the EOS. By inspection, we quickly determine\n\n$$\n\\begin{equation*}\nv_{O(\\max )}=V_{D D}-V_{O V 6} \\quad v_{O(\\text { min })}=V_{S S}+V_{O V 5} \\tag{5.31}\n\\end{equation*}\n$$\n\nIn essence, $v_{O}$ can vary within a $V_{O V}$ voltage drop from each supply rail.\n\nEXAMPLE 5.2 (a) Consider the two-stage CMOS op amp depicted in Fig. 5.13, fabricated using a process with $k_{n}^{\\prime}=2.5 k_{p}^{\\prime}=100 \\mu \\mathrm{~A} / \\mathrm{V}^{2}, V_{t n}=-V_{t p}=0.75 \\mathrm{~V}, \\lambda_{n}^{\\prime}=$ $0.1 \\mu \\mathrm{~m} / \\mathrm{V}$, and $\\lambda_{p}^{\\prime}=0.05 \\mu \\mathrm{~m} / \\mathrm{V}$. Furthermore, all FETs are fabricated with $L=1 \\mu \\mathrm{~m}$ and designed to operate at $V_{O V}=0.25 \\mathrm{~V}$. If the circuit is powered by $\\pm 2.5-\\mathrm{V}$ supplies and utilizes $I_{R E F}=100 \\mu \\mathrm{~A}$, determine appropriate values for $W_{1}$ through $W_{8}$ to bias both stages at $100 \\mu \\mathrm{~A}$ (for simplicity, assume $\\lambda_{n}=\\lambda_{p}=0$ in your dc calculations).\n(b) Compute the individual-stage gains, the overall gain, the output resistance, the IVR, and the OVS.\n(c) Verify with PSpice and explain any discrepancies between calculated and simulated values.\n\n#### Solution\n\n(a) $M_{6}, M_{7}$, and $M_{8}$ must each meet the saturation-region condition\n\n$$\n100 \\mu \\mathrm{~A}=\\frac{40 \\mu \\mathrm{~A}}{2} \\frac{W}{1 \\mu \\mathrm{~m}} 0.25^{2}\n$$\n\nyielding $W=80 \\mu \\mathrm{~m}$. Thus, $W_{6}=W_{7}=W_{8}=80 \\mu \\mathrm{~m}$. $M_{1}$ and $M_{2}$ draw half the current of $M_{7}$ but with the same overdrive voltage, so $W_{1}=W_{2}=$ $W_{7} / 2=40 \\mu \\mathrm{~m}$. $M_{3}$ and $M_{4}$ must each satisfy\n\n$$\n50 \\mu \\mathrm{~A}=\\frac{100 \\mu \\mathrm{~A}}{2} \\frac{W}{1 \\mu \\mathrm{~m}} 0.25^{2}\n$$\n\nresulting in $W_{3}=W_{4}=16 \\mu \\mathrm{~m}$. By Eq. $(5.28),\\left(W_{5} / 1\\right) /(16 / 1)=2(80 / 1) /$ (80/1), or $W_{5}=32 \\mu \\mathrm{~m}$. Summarizing,\n\n$$\n\\begin{array}{ll}\nW_{1}=W_{2}=40 \\mu \\mathrm{~m} & W_{3}=W_{4}=16 \\mu \\mathrm{~m} \\\\\nW_{5}=32 \\mu \\mathrm{~m} & W_{6}=W_{7}=W_{8}=80 \\mu \\mathrm{~m}\n\\end{array}\n$$\n\n(b) Using Eq. (5.25c), we obtain\n\n$$\n\\begin{aligned}\n& \\quad a=\\left[\\frac{2 \\times 1}{0.25(0.1+0.05)}\\right]^{2}=53.3^{2}=2,844 \\mathrm{~V} / \\mathrm{V} \\\\\n& \\text { hence } a_{1}=a_{2}=-53.3 \\mathrm{~V} / \\mathrm{V}. Also, \\lambda_{n}=\\lambda_{n}^{\\prime} / 1=0.1 \\mathrm{~V}^{-1} \\text { and } \\lambda_{p}=\\lambda_{p}^{\\prime} / 1=0.05 \\mathrm{~V}^{-1}, \\text { so } \\\\\n& r_{o 5}=1 /\\left(0.1 \\times 100 \\times 10^{-6}\\right)=100 \\mathrm{k} \\Omega, r_{o 6}=1 /\\left(0.05 \\times 100 \\times 10^{-6}\\right)=200 \\mathrm{k} \\Omega, \\text { and } \\\\\n& \\quad R_{o}=100 / / 200=66.7 \\mathrm{k} \\Omega\n\\end{aligned}\n$$\n\nFinally, Eqs. (5.30) and (5.31) yield\n\n$$\n\\begin{aligned}\n& v_{I C(\\max )}=2.5-2 \\times 0.25-0.75=1.25 \\mathrm{~V} \\\\\n& v_{I C(\\min )}=v_{O(\\min )}=-2.5+0.25=-2.25 \\mathrm{~V} \\\\\n& v_{O(\\max )}=2.25 \\mathrm{~V}\n\\end{aligned}\n$$\n\n(c) A PSpice simulation using the circuit in Fig. 5.14a produces the VTC shown in Fig. 5.14b, revealing a (systematic) input offset of $166 \\mu \\mathrm{~V}$ and confirming output saturation levels within a $V_{O V}$ of the $\\pm 2.5-\\mathrm{V}$ supplies. (The offset can be corrected by specifying a dc component of $-166 \\mu \\mathrm{~V}$ for the ac input source $v_{p}$.) After instructing PSpice to perform the small-signal analysis (.TF), we get $a=v_{o} / v_{p}=4,271 \\mathrm{~V} / \\mathrm{V}$ and $R_{o}=75 \\mathrm{k} \\Omega$. The differences between calculated and simulated values mainly arise from the assumption $\\lambda=0$, particularly when calculating $g_{m 1}$ and $g_{m 5}$. For greater accuracy, we should multiply the calculated $g_{m 1}$ by $\\left(1+\\lambda V_{S D 1}\\right) \\cong(1+0.05 \\times 2.5)=1.125$ and $g_{m 5}$ by $\\left(1+\\lambda V_{D S 5}\\right) \\cong(1+0.1 \\times 2.5)=1.25$. With these adjustments, we get $a_{1} \\cong-53.3 \\times 1.125=-60 \\mathrm{~V} / \\mathrm{V}, a_{2} \\cong-53.3 \\times 1.25=-66.7 \\mathrm{~V} / \\mathrm{V}$, and $a \\cong-4,000 \\mathrm{~V} / \\mathrm{V}$, which aligns better with PSpice results.\n\n(a)\nimage_name:(b)\ndescription:\n[\nname: M8, type: PMOS, ports: {S: VDD, D: x1, G: x1}\nname: M7, type: PMOS, ports: {S: VDD, D: x2, G: x1}\nname: M6, type: PMOS, ports: {S: VDD, D: vo, G: x1}\nname: M1, type: PMOS, ports: {S: x2, D: x3, G: GND}\nname: M2, type: PMOS, ports: {S: x2, D: x4, G: VP}\nname: M5, type: NMOS, ports: {S: GND, D: vo, G: x4}\nname: M4, type: NMOS, ports: {S: Vss, D: x4, G: x3}\nname: M3, type: NMOS, ports: {S: Vss, D: x3, G: x3}\nname: IREF, type: CurrentSource, value: 100uA, ports: {Np: x1, Nn: Vss}\nname: VP, type: VoltageSource, value: VP, ports: {Np: VP, Nn: GND}\n]\nextrainfo:The circuit is a differential amplifier using PMOS and NMOS transistors. It employs a current source IREF for biasing, and the differential input is applied at VP. The output is taken at vo. The circuit operates between VDD and VSS supply voltages.\n\n(b)\n\nFIGURE 5.14 (a) PSpice circuit for Example 5.2, and (b) its VTC. The MOSFET parameters are as follows: $k_{n}^{\\prime}=2.5 k_{p}^{\\prime}=100 \\mu \\mathrm{~A} / \\mathrm{V}^{2}, V_{t n}=-V_{t p}=0.75 \\mathrm{~V}$, and $\\lambda_{n}=2 \\lambda_{\\rho}=0.1 \\mathrm{~V}^{-1}$."
},
{
    "text": "This represents the range of $v_{0}$ values over which $M_{5}$ and $M_{6}$ operate in saturation or at most at the EOS. By inspection, we quickly determine\n\n$$\n\\begin{equation*}\nv_{O(\\max )}=V_{D D}-V_{O V 6} \\quad v_{O(\\text { min })}=V_{S S}+V_{O V 5} \\tag{5.31}\n\\end{equation*}\n$$\n\nIn essence, $v_{O}$ can vary within a $V_{O V}$ voltage drop from each supply rail.\n\nEXAMPLE 5.2 (a) Consider the two-stage CMOS op amp depicted in Fig. 5.13, fabricated using a process with $k_{n}^{\\prime}=2.5 k_{p}^{\\prime}=100 \\mu \\mathrm{~A} / \\mathrm{V}^{2}, V_{t n}=-V_{t p}=0.75 \\mathrm{~V}, \\lambda_{n}^{\\prime}=$ $0.1 \\mu \\mathrm{~m} / \\mathrm{V}$, and $\\lambda_{p}^{\\prime}=0.05 \\mu \\mathrm{~m} / \\mathrm{V}$. Furthermore, all FETs are fabricated with $L=1 \\mu \\mathrm{~m}$ and designed to operate with $V_{O V}=0.25 \\mathrm{~V}$. If the circuit is powered by $\\pm 2.5-\\mathrm{V}$ supplies and utilizes $I_{R E F}=100 \\mu \\mathrm{~A}$, determine appropriate values for $W_{1}$ through $W_{8}$ to bias both stages at $100 \\mu \\mathrm{~A}$ (for simplicity, assume $\\lambda_{n}=\\lambda_{p}=0$ in your dc calculations).\n(b) Compute the individual-stage gains, the overall gain, the output resistance, the IVR, and the OVS.\n(c) Verify with PSpice and explain any discrepancies between calculated and simulated values.\n\n#### Solution\n\n(a) $M_{6}, M_{7}$, and $M_{8}$ must each meet the saturation-region condition\n\n$$\n100 \\mu \\mathrm{~A}=\\frac{40 \\mu \\mathrm{~A}}{2} \\frac{W}{1 \\mu \\mathrm{~m}} 0.25^{2}\n$$\n\nyielding $W=80 \\mu \\mathrm{~m}$. Thus, $W_{6}=W_{7}=W_{8}=80 \\mu \\mathrm{~m}$. $M_{1}$ and $M_{2}$ draw half the current of $M_{7}$ but with the same overdrive voltage, so $W_{1}=W_{2}=$ $W_{7} / 2=40 \\mu \\mathrm{~m}$. $M_{3}$ and $M_{4}$ must each satisfy the condition\n\n$$\n50 \\mu \\mathrm{~A}=\\frac{100 \\mu \\mathrm{~A}}{2} \\frac{W}{1 \\mu \\mathrm{~m}} 0.25^{2}\n$$\n\nresulting in $W_{3}=W_{4}=16 \\mu \\mathrm{~m}$. By Eq. $(5.28),\\left(W_{5} / 1\\right) /(16 / 1)=2(80 / 1) /$ (80/1), or $W_{5}=32 \\mu \\mathrm{~m}$. Summarizing,\n\n$$\n\\begin{array}{ll}\nW_{1}=W_{2}=40 \\mu \\mathrm{~m} & W_{3}=W_{4}=16 \\mu \\mathrm{~m} \\\\\nW_{5}=32 \\mu \\mathrm{~m} & W_{6}=W_{7}=W_{8}=80 \\mu \\mathrm{~m}\n\\end{array}\n$$\n\n(b) According to Eq. (5.25c),\n\n$$\n\\begin{aligned}\n& \\quad a=\\left[\\frac{2 \\times 1}{0.25(0.1+0.05)}\\right]^{2}=53.3^{2}=2,844 \\mathrm{~V} / \\mathrm{V} \\\\\n& \\text { hence } a_{1}=a_{2}=-53.3 \\mathrm{~V} / \\mathrm{V}. Also, \\lambda_{n}=\\lambda_{n}^{\\prime} / 1=0.1 \\mathrm{~V}^{-1} \\text { and } \\lambda_{p}=\\lambda_{p}^{\\prime} / 1=0.05 \\mathrm{~V}^{-1}, \\text { so } \\\\\n& r_{o 5}=1 /\\left(0.1 \\times 100 \\times 10^{-6}\\right)=100 \\mathrm{k} \\Omega, r_{o 6}=1 /\\left(0.05 \\times 100 \\times 10^{-6}\\right)=200 \\mathrm{k} \\Omega, \\text { and } \\\\\n& \\quad R_{o}=100 / / 200=66.7 \\mathrm{k} \\Omega\n\\end{aligned}\n$$\n\nFinally, Eqs. (5.30) and (5.31) yield\n\n$$\n\\begin{aligned}\n& v_{I C(\\max )}=2.5-2 \\times 0.25-0.75=1.25 \\mathrm{~V} \\\\\n& v_{I C(\\min )}=v_{O(\\min )}=-2.5+0.25=-2.25 \\mathrm{~V} \\\\\n& v_{O(\\max )}=2.25 \\mathrm{~V}\n\\end{aligned}\n$$\n\n(c) A PSpice simulation using the circuit in Fig. 5.14a produces the VTC in Fig. 5.14b, revealing a (systematic) input offset of $166 \\mu \\mathrm{~V}$ and confirming output saturation levels within a $V_{O V}$ of the $\\pm 2.5-\\mathrm{V}$ supplies. (The offset can be corrected by specifying a dc component of $-166 \\mu \\mathrm{~V}$ for the ac input source $v_{p}$.) After instructing PSpice to perform the small-signal analysis (.TF), we obtain $a=v_{o} / v_{p}=4,271 \\mathrm{~V} / \\mathrm{V}$ and $R_{o}=75 \\mathrm{k} \\Omega$. The differences between calculated and simulated values primarily arise from the assumption $\\lambda=0$, particularly in calculating $g_{m 1}$ and $g_{m 5}$. For greater accuracy, we should multiply the calculated $g_{m 1}$ by $\\left(1+\\lambda V_{S D 1}\\right) \\cong(1+0.05 \\times 2.5)=1.125$ and $g_{m 5}$ by $\\left(1+\\lambda V_{D S 5}\\right) \\cong(1+0.1 \\times 2.5)=1.25$. With these adjustments, we get $a_{1} \\cong-53.3 \\times 1.125=-60 \\mathrm{~V} / \\mathrm{V}, a_{2} \\cong-53.3 \\times 1.25=-66.7 \\mathrm{~V} / \\mathrm{V}$, and $a \\cong-4,000 \\mathrm{~V} / \\mathrm{V}$, aligning more closely with PSpice results.\n\n(a)\nimage_name:(b)\ndescription:\n[\nname: M8, type: PMOS, ports: {S: VDD, D: x1, G: x1}\nname: M7, type: PMOS, ports: {S: VDD, D: x2, G: x1}\nname: M6, type: PMOS, ports: {S: VDD, D: vo, G: x1}\nname: M1, type: PMOS, ports: {S: x2, D: x3, G: GND}\nname: M2, type: PMOS, ports: {S: x2, D: x4, G: VP}\nname: M5, type: NMOS, ports: {S: GND, D: vo, G: x4}\nname: M4, type: NMOS, ports: {S: Vss, D: x4, G: x3}\nname: M3, type: NMOS, ports: {S: Vss, D: x3, G: x3}\nname: IREF, type: CurrentSource, value: 100uA, ports: {Np: x1, Nn: Vss}\nname: VP, type: VoltageSource, value: VP, ports: {Np: VP, Nn: GND}\n]\nextrainfo:The circuit is a differential amplifier featuring PMOS and NMOS transistors. It employs a current source IREF for biasing, and the differential input is applied at VP. The output is taken at vo. The circuit operates between VDD and VSS supply voltages.\n\n(b)\n\nFIGURE 5.14 (a) PSpice circuit for Example 5.2, and (b) its VTC. The MOSFET parameters are as follows: $k_{n}^{\\prime}=2.5 k_{p}^{\\prime}=100 \\mu \\mathrm{~A} / \\mathrm{V}^{2}, V_{t n}=-V_{t p}=0.75 \\mathrm{~V}$, and $\\lambda_{n}=2 \\lambda_{\\rho}=0.1 \\mathrm{~V}^{-1}$."
},
{
    "text": "This represents the range of $v_{0}$ values over which $M_{5}$ and $M_{6}$ operate in saturation or at most at the EOS. By inspection, we easily determine\n\n$$\n\\begin{equation*}\nv_{O(\\max )}=V_{D D}-V_{O V 6} \\quad v_{O(\\text { min })}=V_{S S}+V_{O V 5} \\tag{5.31}\n\\end{equation*}\n$$\n\nIn essence, $v_{O}$ can vary within a $V_{O V}$ voltage drop from each supply rail.\n\nEXAMPLE 5.2 (a) Consider the two-stage CMOS op amp shown in Fig. 5.13, fabricated using a process with $k_{n}^{\\prime}=2.5 k_{p}^{\\prime}=100 \\mu \\mathrm{~A} / \\mathrm{V}^{2}, V_{t n}=-V_{t p}=0.75 \\mathrm{~V}, \\lambda_{n}^{\\prime}=$ $0.1 \\mu \\mathrm{~m} / \\mathrm{V}$, and $\\lambda_{p}^{\\prime}=0.05 \\mu \\mathrm{~m} / \\mathrm{V}$. All FETs are fabricated with $L=1 \\mu \\mathrm{~m}$ and designed for $V_{O V}=0.25 \\mathrm{~V}$. If the circuit is powered by $\\pm 2.5-\\mathrm{V}$ supplies and uses $I_{R E F}=100 \\mu \\mathrm{~A}$, determine appropriate values for $W_{1}$ through $W_{8}$ to bias both stages at $100 \\mu \\mathrm{~A}$ (for simplicity, assume $\\lambda_{n}=\\lambda_{p}=0$ in your dc calculations).\n(b) Calculate the individual-stage gains, the overall gain, the output resistance, the IVR, and the OVS.\n(c) Verify with PSpice and explain any discrepancies between calculated and simulated values.\n\n#### Solution\n\n(a) $M_{6}, M_{7}$, and $M_{8}$ must each meet the saturation-region condition\n\n$$\n100 \\mu \\mathrm{~A}=\\frac{40 \\mu \\mathrm{~A}}{2} \\frac{W}{1 \\mu \\mathrm{~m}} 0.25^{2}\n$$\n\nyielding $W=80 \\mu \\mathrm{~m}$. Thus, $W_{6}=W_{7}=W_{8}=80 \\mu \\mathrm{~m}$. $M_{1}$ and $M_{2}$ draw half the current of $M_{7}$ but with the same overdrive voltage, so $W_{1}=W_{2}=$ $W_{7} / 2=40 \\mu \\mathrm{~m}$. $M_{3}$ and $M_{4}$ must each satisfy\n\n$$\n50 \\mu \\mathrm{~A}=\\frac{100 \\mu \\mathrm{~A}}{2} \\frac{W}{1 \\mu \\mathrm{~m}} 0.25^{2}\n$$\n\nresulting in $W_{3}=W_{4}=16 \\mu \\mathrm{~m}$. From Eq. $(5.28),\\left(W_{5} / 1\\right) /(16 / 1)=2(80 / 1) /$ (80/1), giving $W_{5}=32 \\mu \\mathrm{~m}$. Summarized,\n\n$$\n\\begin{array}{ll}\nW_{1}=W_{2}=40 \\mu \\mathrm{~m} & W_{3}=W_{4}=16 \\mu \\mathrm{~m} \\\\\nW_{5}=32 \\mu \\mathrm{~m} & W_{6}=W_{7}=W_{8}=80 \\mu \\mathrm{~m}\n\\end{array}\n$$\n\n(b) Using Eq. (5.25c), we find\n\n$$\n\\begin{aligned}\n& \\quad a=\\left[\\frac{2 \\times 1}{0.25(0.1+0.05)}\\right]^{2}=53.3^{2}=2,844 \\mathrm{~V} / \\mathrm{V} \\\\\n& \\text { hence } a_{1}=a_{2}=-53.3 \\mathrm{~V} / \\mathrm{V}. Also, \\lambda_{n}=\\lambda_{n}^{\\prime} / 1=0.1 \\mathrm{~V}^{-1} \\text { and } \\lambda_{p}=\\lambda_{p}^{\\prime} / 1=0.05 \\mathrm{~V}^{-1}, so \\\\\n& r_{o 5}=1 /\\left(0.1 \\times 100 \\times 10^{-6}\\right)=100 \\mathrm{k} \\Omega, r_{o 6}=1 /\\left(0.05 \\times 100 \\times 10^{-6}\\right)=200 \\mathrm{k} \\Omega, and \\\\\n& \\quad R_{o}=100 / / 200=66.7 \\mathrm{k} \\Omega\n\\end{aligned}\n$$\n\nFinally, Eqs. (5.30) and (5.31) yield\n\n$$\n\\begin{aligned}\n& v_{I C(\\max )}=2.5-2 \\times 0.25-0.75=1.25 \\mathrm{~V} \\\\\n& v_{I C(\\min )}=v_{O(\\min )}=-2.5+0.25=-2.25 \\mathrm{~V} \\\\\n& v_{O(\\max )}=2.25 \\mathrm{~V}\n\\end{aligned}\n$$\n\n(c) A PSpice simulation using the circuit of Fig. 5.14a produces the VTC shown in Fig. 5.14b, revealing a (systematic) input offset of $166 \\mu \\mathrm{~V}$ and confirming output saturation levels within a $V_{O V}$ of the $\\pm 2.5-\\mathrm{V}$ supplies. (The offset can be compensated by specifying a dc component of $-166 \\mu \\mathrm{~V}$ for the ac input source $v_{p}$.) After directing PSpice to perform the small-signal analysis (.TF), we obtain $a=v_{o} / v_{p}=4,271 \\mathrm{~V} / \\mathrm{V}$ and $R_{o}=75 \\mathrm{k} \\Omega$. The discrepancy between calculated and simulated values mainly arises from the assumption $\\lambda=0$, particularly in calculating $g_{m 1}$ and $g_{m 5}$. For greater accuracy, we should multiply the calculated $g_{m 1}$ by $\\left(1+\\lambda V_{S D 1}\\right) \\cong(1+0.05 \\times 2.5)=1.125$ and $g_{m 5}$ by $\\left(1+\\lambda V_{D S 5}\\right) \\cong(1+0.1 \\times 2.5)=1.25$. With these corrections, we get $a_{1} \\cong-53.3 \\times 1.125=-60 \\mathrm{~V} / \\mathrm{V}, a_{2} \\cong-53.3 \\times 1.25=-66.7 \\mathrm{~V} / \\mathrm{V}$, and $a \\cong-4,000 \\mathrm{~V} / \\mathrm{V}$, aligning better with PSpice results.\n\n(a)\nimage_name:(b)\ndescription:\n[\nname: M8, type: PMOS, ports: {S: VDD, D: x1, G: x1}\nname: M7, type: PMOS, ports: {S: VDD, D: x2, G: x1}\nname: M6, type: PMOS, ports: {S: VDD, D: vo, G: x1}\nname: M1, type: PMOS, ports: {S: x2, D: x3, G: GND}\nname: M2, type: PMOS, ports: {S: x2, D: x4, G: VP}\nname: M5, type: NMOS, ports: {S: GND, D: vo, G: x4}\nname: M4, type: NMOS, ports: {S: Vss, D: x4, G: x3}\nname: M3, type: NMOS, ports: {S: Vss, D: x3, G: x3}\nname: IREF, type: CurrentSource, value: 100uA, ports: {Np: x1, Nn: Vss}\nname: VP, type: VoltageSource, value: VP, ports: {Np: VP, Nn: GND}\n]\nextrainfo:The circuit is a differential amplifier with PMOS and NMOS transistors. It uses a current source IREF to provide biasing, and the differential input is applied at VP. The output is taken at vo. The circuit operates between VDD and VSS supply voltages.\n\n(b)\n\nFIGURE 5.14 (a) PSpice circuit for Example 5.2, and (b) its VTC. The MOSFET parameters are as follows: $k_{n}^{\\prime}=2.5 k_{p}^{\\prime}=100 \\mu \\mathrm{~A} / \\mathrm{V}^{2}, V_{t n}=-V_{t p}=0.75 \\mathrm{~V}$, and $\\lambda_{n}=2 \\lambda_{\\rho}=0.1 \\mathrm{~V}^{-1}$."
},
{
    "text": "This represents the range of $v_{0}$ values over which $M_{5}$ and $M_{6}$ function in saturation or at most at the EOS. By inspection, we quickly determine\n\n$$\n\\begin{equation*}\nv_{O(\\max )}=V_{D D}-V_{O V 6} \\quad v_{O(\\text { min })}=V_{S S}+V_{O V 5} \\tag{5.31}\n\\end{equation*}\n$$\n\nIn essence, $v_{O}$ can vary within a $V_{O V}$ voltage drop from each supply rail.\n\nEXAMPLE 5.2 (a) Consider the two-stage CMOS op amp depicted in Fig. 5.13, fabricated using a process with $k_{n}^{\\prime}=2.5 k_{p}^{\\prime}=100 \\mu \\mathrm{~A} / \\mathrm{V}^{2}, V_{t n}=-V_{t p}=0.75 \\mathrm{~V}, \\lambda_{n}^{\\prime}=$ $0.1 \\mu \\mathrm{~m} / \\mathrm{V}$, and $\\lambda_{p}^{\\prime}=0.05 \\mu \\mathrm{~m} / \\mathrm{V}$. Furthermore, all FETs are fabricated with $L=1 \\mu \\mathrm{~m}$ and designed to operate at $V_{O V}=0.25 \\mathrm{~V}$. If the circuit is powered by $\\pm 2.5-\\mathrm{V}$ supplies and utilizes $I_{R E F}=100 \\mu \\mathrm{~A}$, determine appropriate values for $W_{1}$ through $W_{8}$ to bias both stages at $100 \\mu \\mathrm{~A}$ (for simplicity, assume $\\lambda_{n}=\\lambda_{p}=0$ in your dc calculations).\n(b) Compute the individual-stage gains, the overall gain, the output resistance, the IVR, and the OVS.\n(c) Verify with PSpice and explain any discrepancies between the calculated and simulated values.\n\n#### Solution\n\n(a) $M_{6}, M_{7}$, and $M_{8}$ must each meet the saturation-region condition\n\n$$\n100 \\mu \\mathrm{~A}=\\frac{40 \\mu \\mathrm{~A}}{2} \\frac{W}{1 \\mu \\mathrm{~m}} 0.25^{2}\n$$\n\nyielding $W=80 \\mu \\mathrm{~m}$. Thus, $W_{6}=W_{7}=W_{8}=80 \\mu \\mathrm{~m}$. $M_{1}$ and $M_{2}$ draw half the current of $M_{7}$ but with the same overdrive voltage, so $W_{1}=W_{2}=$ $W_{7} / 2=40 \\mu \\mathrm{~m}$. $M_{3}$ and $M_{4}$ must each satisfy\n\n$$\n50 \\mu \\mathrm{~A}=\\frac{100 \\mu \\mathrm{~A}}{2} \\frac{W}{1 \\mu \\mathrm{~m}} 0.25^{2}\n$$\n\nresulting in $W_{3}=W_{4}=16 \\mu \\mathrm{~m}$. By Eq. $(5.28),\\left(W_{5} / 1\\right) /(16 / 1)=2(80 / 1) /$ (80/1), or $W_{5}=32 \\mu \\mathrm{~m}$. Summarizing,\n\n$$\n\\begin{array}{ll}\nW_{1}=W_{2}=40 \\mu \\mathrm{~m} & W_{3}=W_{4}=16 \\mu \\mathrm{~m} \\\\\nW_{5}=32 \\mu \\mathrm{~m} & W_{6}=W_{7}=W_{8}=80 \\mu \\mathrm{~m}\n\\end{array}\n$$\n\n(b) From Eq. (5.25c), we obtain\n\n$$\n\\begin{aligned}\n& \\quad a=\\left[\\frac{2 \\times 1}{0.25(0.1+0.05)}\\right]^{2}=53.3^{2}=2,844 \\mathrm{~V} / \\mathrm{V} \\\\\n& \\text { thus } a_{1}=a_{2}=-53.3 \\mathrm{~V} / \\mathrm{V}. Also, \\lambda_{n}=\\lambda_{n}^{\\prime} / 1=0.1 \\mathrm{~V}^{-1} \\text { and } \\lambda_{p}=\\lambda_{p}^{\\prime} / 1=0.05 \\mathrm{~V}^{-1}, \\text { so } \\\\\n& r_{o 5}=1 /\\left(0.1 \\times 100 \\times 10^{-6}\\right)=100 \\mathrm{k} \\Omega, r_{o 6}=1 /\\left(0.05 \\times 100 \\times 10^{-6}\\right)=200 \\mathrm{k} \\Omega, \\text { and } \\\\\n& \\quad R_{o}=100 / / 200=66.7 \\mathrm{k} \\Omega\n\\end{aligned}\n$$\n\nFinally, Eqs. (5.30) and (5.31) yield\n\n$$\n\\begin{aligned}\n& v_{I C(\\max )}=2.5-2 \\times 0.25-0.75=1.25 \\mathrm{~V} \\\\\n& v_{I C(\\min )}=v_{O(\\min )}=-2.5+0.25=-2.25 \\mathrm{~V} \\\\\n& v_{O(\\max )}=2.25 \\mathrm{~V}\n\\end{aligned}\n$$\n\n(c) A PSpice simulation using the circuit in Fig. 5.14a produces the VTC shown in Fig. 5.14b, revealing a (systematic) input offset of $166 \\mu \\mathrm{~V}$ and confirming output saturation levels within a $V_{O V}$ of the $\\pm 2.5-\\mathrm{V}$ supplies. (The offset can be compensated by specifying a dc component of $-166 \\mu \\mathrm{~V}$ for the ac input source $v_{p}$.) After instructing PSpice to perform a small-signal analysis (.TF), we get $a=v_{o} / v_{p}=4,271 \\mathrm{~V} / \\mathrm{V}$ and $R_{o}=75 \\mathrm{k} \\Omega$. The differences between calculated and simulated values mainly arise from the assumption $\\lambda=0$, particularly when calculating $g_{m 1}$ and $g_{m 5}$. For greater accuracy, we should multiply the calculated $g_{m 1}$ by $\\left(1+\\lambda V_{S D 1}\\right) \\cong(1+0.05 \\times 2.5)=1.125$ and $g_{m 5}$ by $\\left(1+\\lambda V_{D S 5}\\right) \\cong(1+0.1 \\times 2.5)=1.25$. With these adjustments, we get $a_{1} \\cong-53.3 \\times 1.125=-60 \\mathrm{~V} / \\mathrm{V}, a_{2} \\cong-53.3 \\times 1.25=-66.7 \\mathrm{~V} / \\mathrm{V}$, and $a \\cong-4,000 \\mathrm{~V} / \\mathrm{V}$, aligning better with PSpice results.\n\n(a)\nimage_name:(b)\ndescription:\n[\nname: M8, type: PMOS, ports: {S: VDD, D: x1, G: x1}\nname: M7, type: PMOS, ports: {S: VDD, D: x2, G: x1}\nname: M6, type: PMOS, ports: {S: VDD, D: vo, G: x1}\nname: M1, type: PMOS, ports: {S: x2, D: x3, G: GND}\nname: M2, type: PMOS, ports: {S: x2, D: x4, G: VP}\nname: M5, type: NMOS, ports: {S: GND, D: vo, G: x4}\nname: M4, type: NMOS, ports: {S: Vss, D: x4, G: x3}\nname: M3, type: NMOS, ports: {S: Vss, D: x3, G: x3}\nname: IREF, type: CurrentSource, value: 100uA, ports: {Np: x1, Nn: Vss}\nname: VP, type: VoltageSource, value: VP, ports: {Np: VP, Nn: GND}\n]\nextrainfo:The circuit is a differential amplifier with PMOS and NMOS transistors. It uses a current source IREF for biasing, and the differential input is applied at VP. The output is taken at vo. The circuit operates between VDD and VSS supply voltages.\n\n(b)\n\nFIGURE 5.14 (a) PSpice circuit for Example 5.2, and (b) its VTC. The MOSFET parameters are as follows: $k_{n}^{\\prime}=2.5 k_{p}^{\\prime}=100 \\mu \\mathrm{~A} / \\mathrm{V}^{2}, V_{t n}=-V_{t p}=0.75 \\mathrm{~V}$, and $\\lambda_{n}=2 \\lambda_{\\rho}=0.1 \\mathrm{~V}^{-1}$."
},
{
    "text": "This represents the range of $v_{0}$ values over which $M_{5}$ and $M_{6}$ function in saturation or at most at the EOS. By inspection, we quickly determine\n\n$$\n\\begin{equation*}\nv_{O(\\max )}=V_{D D}-V_{O V 6} \\quad v_{O(\\text { min })}=V_{S S}+V_{O V 5} \\tag{5.31}\n\\end{equation*}\n$$\n\nIn essence, $v_{O}$ can vary within a $V_{O V}$ voltage drop from each supply rail.\n\nEXAMPLE 5.2 (a) Consider the two-stage CMOS op amp depicted in Fig. 5.13, fabricated using a process with $k_{n}^{\\prime}=2.5 k_{p}^{\\prime}=100 \\mu \\mathrm{~A} / \\mathrm{V}^{2}, V_{t n}=-V_{t p}=0.75 \\mathrm{~V}, \\lambda_{n}^{\\prime}=$ $0.1 \\mu \\mathrm{~m} / \\mathrm{V}$, and $\\lambda_{p}^{\\prime}=0.05 \\mu \\mathrm{~m} / \\mathrm{V}$. Additionally, all FETs are fabricated with $L=1 \\mu \\mathrm{~m}$ and designed to operate with $V_{O V}=0.25 \\mathrm{~V}$. If the circuit is powered by $\\pm 2.5-\\mathrm{V}$ supplies and utilizes $I_{R E F}=100 \\mu \\mathrm{~A}$, determine appropriate values for $W_{1}$ through $W_{8}$ to bias both stages at $100 \\mu \\mathrm{~A}$ (for simplicity, assume $\\lambda_{n}=\\lambda_{p}=0$ in your dc calculations).\n(b) Compute the individual-stage gains, the overall gain, the output resistance, the IVR, and the OVS.\n(c) Validate with PSpice and explain any discrepancies between calculated and simulated values.\n\n#### Solution\n\n(a) $M_{6}, M_{7}$, and $M_{8}$ must each meet the saturation-region condition\n\n$$\n100 \\mu \\mathrm{~A}=\\frac{40 \\mu \\mathrm{~A}}{2} \\frac{W}{1 \\mu \\mathrm{~m}} 0.25^{2}\n$$\n\nyielding $W=80 \\mu \\mathrm{~m}$. Thus, $W_{6}=W_{7}=W_{8}=80 \\mu \\mathrm{~m}$. $M_{1}$ and $M_{2}$ draw half the current of $M_{7}$ but with the same overdrive voltage, so $W_{1}=W_{2}=$ $W_{7} / 2=40 \\mu \\mathrm{~m}$. $M_{3}$ and $M_{4}$ must each satisfy the condition\n\n$$\n50 \\mu \\mathrm{~A}=\\frac{100 \\mu \\mathrm{~A}}{2} \\frac{W}{1 \\mu \\mathrm{~m}} 0.25^{2}\n$$\n\nresulting in $W_{3}=W_{4}=16 \\mu \\mathrm{~m}$. By Eq. $(5.28),\\left(W_{5} / 1\\right) /(16 / 1)=2(80 / 1) /$ (80/1), or $W_{5}=32 \\mu \\mathrm{~m}$. Summarizing,\n\n$$\n\\begin{array}{ll}\nW_{1}=W_{2}=40 \\mu \\mathrm{~m} & W_{3}=W_{4}=16 \\mu \\mathrm{~m} \\\\\nW_{5}=32 \\mu \\mathrm{~m} & W_{6}=W_{7}=W_{8}=80 \\mu \\mathrm{~m}\n\\end{array}\n$$\n\n(b) According to Eq. (5.25c), we have\n\n$$\n\\begin{aligned}\n& \\quad a=\\left[\\frac{2 \\times 1}{0.25(0.1+0.05)}\\right]^{2}=53.3^{2}=2,844 \\mathrm{~V} / \\mathrm{V} \\\\\n& \\text { hence } a_{1}=a_{2}=-53.3 \\mathrm{~V} / \\mathrm{V}. Also, } \\lambda_{n}=\\lambda_{n}^{\\prime} / 1=0.1 \\mathrm{~V}^{-1} \\text { and } \\lambda_{p}=\\lambda_{p}^{\\prime} / 1=0.05 \\mathrm{~V}^{-1}, \\text { so } \\\\\n& r_{o 5}=1 /\\left(0.1 \\times 100 \\times 10^{-6}\\right)=100 \\mathrm{k} \\Omega, r_{o 6}=1 /\\left(0.05 \\times 100 \\times 10^{-6}\\right)=200 \\mathrm{k} \\Omega, \\text { and } \\\\\n& \\quad R_{o}=100 / / 200=66.7 \\mathrm{k} \\Omega\n\\end{aligned}\n$$\n\nFinally, Eqs. (5.30) and (5.31) yield\n\n$$\n\\begin{aligned}\n& v_{I C(\\max )}=2.5-2 \\times 0.25-0.75=1.25 \\mathrm{~V} \\\\\n& v_{I C(\\min )}=v_{O(\\min )}=-2.5+0.25=-2.25 \\mathrm{~V} \\\\\n& v_{O(\\max )}=2.25 \\mathrm{~V}\n\\end{aligned}\n$$\n\n(c) A PSpice simulation using the circuit of Fig. 5.14a produces the VTC shown in Fig. 5.14b, revealing a (systematic) input offset of $166 \\mu \\mathrm{~V}$ and confirming output saturation levels within a $V_{O V}$ of the $\\pm 2.5-\\mathrm{V}$ supplies. (The offset can be corrected by specifying a dc component of $-166 \\mu \\mathrm{~V}$ for the ac input source $v_{p}$.) After instructing PSpice to perform the small-signal analysis (.TF), we obtain $a=v_{o} / v_{p}=4,271 \\mathrm{~V} / \\mathrm{V}$ and $R_{o}=75 \\mathrm{k} \\Omega$. The discrepancy between calculated and simulated values primarily arises from the assumption $\\lambda=0$, particularly when calculating $g_{m 1}$ and $g_{m 5}$. For greater accuracy, we should multiply the calculated value of $g_{m 1}$ by $\\left(1+\\lambda V_{S D 1}\\right) \\cong(1+0.05 \\times 2.5)=1.125$ and that of $g_{m 5}$ by $\\left(1+\\lambda V_{D S 5}\\right) \\cong(1+0.1 \\times 2.5)=1.25$. With these adjustments, we get $a_{1} \\cong-53.3 \\times 1.125=-60 \\mathrm{~V} / \\mathrm{V}, a_{2} \\cong-53.3 \\times 1.25=-66.7 \\mathrm{~V} / \\mathrm{V}$, and $a \\cong-4,000 \\mathrm{~V} / \\mathrm{V}$, aligning more closely with PSpice results.\n\n(a)\nimage_name:(b)\ndescription:\n[\nname: M8, type: PMOS, ports: {S: VDD, D: x1, G: x1}\nname: M7, type: PMOS, ports: {S: VDD, D: x2, G: x1}\nname: M6, type: PMOS, ports: {S: VDD, D: vo, G: x1}\nname: M1, type: PMOS, ports: {S: x2, D: x3, G: GND}\nname: M2, type: PMOS, ports: {S: x2, D: x4, G: VP}\nname: M5, type: NMOS, ports: {S: GND, D: vo, G: x4}\nname: M4, type: NMOS, ports: {S: Vss, D: x4, G: x3}\nname: M3, type: NMOS, ports: {S: Vss, D: x3, G: x3}\nname: IREF, type: CurrentSource, value: 100uA, ports: {Np: x1, Nn: Vss}\nname: VP, type: VoltageSource, value: VP, ports: {Np: VP, Nn: GND}\n]\nextrainfo:The circuit is a differential amplifier with PMOS and NMOS transistors. It uses a current source IREF to provide biasing, and the differential input is applied at VP. The output is taken at vo. The circuit operates between VDD and VSS supply voltages.\n\n(b)\n\nFIGURE 5.14 (a) PSpice circuit for Example 5.2, and (b) its VTC. The MOSFET parameters are as follows: $k_{n}^{\\prime}=2.5 k_{p}^{\\prime}=100 \\mu \\mathrm{~A} / \\mathrm{V}^{2}, V_{t n}=-V_{t p}=0.75 \\mathrm{~V}$, and $\\lambda_{n}=2 \\lambda_{\\rho}=0.1 \\mathrm{~V}^{-1}$."
},
{
    "text": "This specifies the range of $v_{0}$ values over which $M_{5}$ and $M_{6}$ function in saturation or at most at the EOS. By examination, we quickly determine\n\n$$\n\\begin{equation*}\nv_{O(\\max )}=V_{D D}-V_{O V 6} \\quad v_{O(\\text { min })}=V_{S S}+V_{O V 5} \\tag{5.31}\n\\end{equation*}\n$$\n\nIn essence, $v_{O}$ can fluctuate within a $V_{O V}$ voltage drop from each supply rail.\n\nEXAMPLE 5.2 (a) Consider the two-stage CMOS op amp depicted in Fig. 5.13, fabricated using a process with $k_{n}^{\\prime}=2.5 k_{p}^{\\prime}=100 \\mu \\mathrm{~A} / \\mathrm{V}^{2}, V_{t n}=-V_{t p}=0.75 \\mathrm{~V}, \\lambda_{n}^{\\prime}=$ $0.1 \\mu \\mathrm{~m} / \\mathrm{V}$, and $\\lambda_{p}^{\\prime}=0.05 \\mu \\mathrm{~m} / \\mathrm{V}$. Furthermore, all FETs are produced with $L=1 \\mu \\mathrm{~m}$ and designed to operate at $V_{O V}=0.25 \\mathrm{~V}$. If the circuit is powered by $\\pm 2.5-\\mathrm{V}$ supplies and utilizes $I_{R E F}=100 \\mu \\mathrm{~A}$, determine appropriate values for $W_{1}$ through $W_{8}$ to bias both stages at $100 \\mu \\mathrm{~A}$ (for simplicity, assume $\\lambda_{n}=\\lambda_{p}=0$ in your dc calculations).\n(b) Compute the individual-stage gains, the total gain, the output resistance, the IVR, and the OVS.\n(c) Verify with PSpice and explain any discrepancies between the calculated and simulated values.\n\n#### Solution\n\n(a) $M_{6}, M_{7}$, and $M_{8}$ must each meet the saturation-region condition\n\n$$\n100 \\mu \\mathrm{~A}=\\frac{40 \\mu \\mathrm{~A}}{2} \\frac{W}{1 \\mu \\mathrm{~m}} 0.25^{2}\n$$\n\nyielding $W=80 \\mu \\mathrm{~m}$. Thus, $W_{6}=W_{7}=W_{8}=80 \\mu \\mathrm{~m}$. $M_{1}$ and $M_{2}$ draw half the current of $M_{7}$ but with the same overdrive voltage, so $W_{1}=W_{2}=$ $W_{7} / 2=40 \\mu \\mathrm{~m}$. $M_{3}$ and $M_{4}$ must each satisfy\n\n$$\n50 \\mu \\mathrm{~A}=\\frac{100 \\mu \\mathrm{~A}}{2} \\frac{W}{1 \\mu \\mathrm{~m}} 0.25^{2}\n$$\n\nresulting in $W_{3}=W_{4}=16 \\mu \\mathrm{~m}$. By Eq. $(5.28),\\left(W_{5} / 1\\right) /(16 / 1)=2(80 / 1) /$ (80/1), or $W_{5}=32 \\mu \\mathrm{~m}$. Summarizing,\n\n$$\n\\begin{array}{ll}\nW_{1}=W_{2}=40 \\mu \\mathrm{~m} & W_{3}=W_{4}=16 \\mu \\mathrm{~m} \\\\\nW_{5}=32 \\mu \\mathrm{~m} & W_{6}=W_{7}=W_{8}=80 \\mu \\mathrm{~m}\n\\end{array}\n$$\n\n(b) According to Eq. (5.25c),\n\n$$\n\\begin{aligned}\n& \\quad a=\\left[\\frac{2 \\times 1}{0.25(0.1+0.05)}\\right]^{2}=53.3^{2}=2,844 \\mathrm{~V} / \\mathrm{V} \\\\\n& \\text { hence } a_{1}=a_{2}=-53.3 \\mathrm{~V} / \\mathrm{V}. Also, \\lambda_{n}=\\lambda_{n}^{\\prime} / 1=0.1 \\mathrm{~V}^{-1} \\text { and } \\lambda_{p}=\\lambda_{p}^{\\prime} / 1=0.05 \\mathrm{~V}^{-1}, \\text { so } \\\\\n& r_{o 5}=1 /\\left(0.1 \\times 100 \\times 10^{-6}\\right)=100 \\mathrm{k} \\Omega, r_{o 6}=1 /\\left(0.05 \\times 100 \\times 10^{-6}\\right)=200 \\mathrm{k} \\Omega, \\text { and } \\\\\n& \\quad R_{o}=100 / / 200=66.7 \\mathrm{k} \\Omega\n\\end{aligned}\n$$\n\nFinally, Eqs. (5.30) and (5.31) yield\n\n$$\n\\begin{aligned}\n& v_{I C(\\max )}=2.5-2 \\times 0.25-0.75=1.25 \\mathrm{~V} \\\\\n& v_{I C(\\min )}=v_{O(\\min )}=-2.5+0.25=-2.25 \\mathrm{~V} \\\\\n& v_{O(\\max )}=2.25 \\mathrm{~V}\n\\end{aligned}\n$$\n\n(c) A PSpice simulation using the circuit in Fig. 5.14a produces the VTC shown in Fig. 5.14b, revealing a (systematic) input offset of $166 \\mu \\mathrm{~V}$ and confirming output saturation levels within a $V_{O V}$ of the $\\pm 2.5-\\mathrm{V}$ supplies. (The offset can be corrected by specifying a dc component of $-166 \\mu \\mathrm{~V}$ for the ac input source $v_{p}$.) After instructing PSpice to perform the small-signal analysis (.TF), we obtain $a=v_{o} / v_{p}=4,271 \\mathrm{~V} / \\mathrm{V}$ and $R_{o}=75 \\mathrm{k} \\Omega$. The difference between calculated and simulated values mainly arises from the assumption $\\lambda=0$, particularly when calculating $g_{m 1}$ and $g_{m 5}$. For greater accuracy, we should multiply the calculated $g_{m 1}$ by $\\left(1+\\lambda V_{S D 1}\\right) \\cong(1+0.05 \\times 2.5)=1.125$ and $g_{m 5}$ by $\\left(1+\\lambda V_{D S 5}\\right) \\cong(1+0.1 \\times 2.5)=1.25$. With these adjustments, we get $a_{1} \\cong-53.3 \\times 1.125=-60 \\mathrm{~V} / \\mathrm{V}, a_{2} \\cong-53.3 \\times 1.25=-66.7 \\mathrm{~V} / \\mathrm{V}$, and $a \\cong-4,000 \\mathrm{~V} / \\mathrm{V}$, aligning better with PSpice results.\n\n(a)\nimage_name:(b)\ndescription:\n[\nname: M8, type: PMOS, ports: {S: VDD, D: x1, G: x1}\nname: M7, type: PMOS, ports: {S: VDD, D: x2, G: x1}\nname: M6, type: PMOS, ports: {S: VDD, D: vo, G: x1}\nname: M1, type: PMOS, ports: {S: x2, D: x3, G: GND}\nname: M2, type: PMOS, ports: {S: x2, D: x4, G: VP}\nname: M5, type: NMOS, ports: {S: GND, D: vo, G: x4}\nname: M4, type: NMOS, ports: {S: Vss, D: x4, G: x3}\nname: M3, type: NMOS, ports: {S: Vss, D: x3, G: x3}\nname: IREF, type: CurrentSource, value: 100uA, ports: {Np: x1, Nn: Vss}\nname: VP, type: VoltageSource, value: VP, ports: {Np: VP, Nn: GND}\n]\nextrainfo:The circuit is a differential amplifier incorporating PMOS and NMOS transistors. It employs a current source IREF for biasing, and the differential input is applied at VP. The output is taken at vo. The circuit operates between VDD and VSS supply voltages.\n\n(b)\n\nFIGURE 5.14 (a) PSpice circuit for Example 5.2, and (b) its VTC. The MOSFET parameters are as follows: $k_{n}^{\\prime}=2.5 k_{p}^{\\prime}=100 \\mu \\mathrm{~A} / \\mathrm{V}^{2}, V_{t n}=-V_{t p}=0.75 \\mathrm{~V}$, and $\\lambda_{n}=2 \\lambda_{\\rho}=0.1 \\mathrm{~V}^{-1}$."
},
{
    "text": "This specifies the range of $v_{0}$ values over which $M_{5}$ and $M_{6}$ function in saturation or at most at the EOS. By inspection, we quickly determine\n\n$$\n\\begin{equation*}\nv_{O(\\max )}=V_{D D}-V_{O V 6} \\quad v_{O(\\text { min })}=V_{S S}+V_{O V 5} \\tag{5.31}\n\\end{equation*}\n$$\n\nIn essence, $v_{O}$ can vary within a $V_{O V}$ voltage drop from each supply rail.\n\nEXAMPLE 5.2 (a) Consider the two-stage CMOS op amp shown in Fig. 5.13, fabricated using a process with $k_{n}^{\\prime}=2.5 k_{p}^{\\prime}=100 \\mu \\mathrm{~A} / \\mathrm{V}^{2}, V_{t n}=-V_{t p}=0.75 \\mathrm{~V}, \\lambda_{n}^{\\prime}=$ $0.1 \\mu \\mathrm{~m} / \\mathrm{V}$, and $\\lambda_{p}^{\\prime}=0.05 \\mu \\mathrm{~m} / \\mathrm{V}$. Furthermore, all FETs are made with $L=1 \\mu \\mathrm{~m}$ and designed for $V_{O V}=0.25 \\mathrm{~V}$. If the circuit is powered by $\\pm 2.5-\\mathrm{V}$ supplies and uses $I_{R E F}=100 \\mu \\mathrm{~A}$, determine appropriate values for $W_{1}$ through $W_{8}$ to bias both stages at $100 \\mu \\mathrm{~A}$ (for simplicity, assume $\\lambda_{n}=\\lambda_{p}=0$ in your dc calculations).\n(b) Calculate the individual-stage gains, the overall gain, the output resistance, the IVR, and the OVS.\n(c) Verify with PSpice and explain any discrepancies between calculated and simulated values.\n\n#### Solution\n\n(a) $M_{6}, M_{7}$, and $M_{8}$ must each meet the saturation-region condition\n\n$$\n100 \\mu \\mathrm{~A}=\\frac{40 \\mu \\mathrm{~A}}{2} \\frac{W}{1 \\mu \\mathrm{~m}} 0.25^{2}\n$$\n\nyielding $W=80 \\mu \\mathrm{~m}$. Thus, $W_{6}=W_{7}=W_{8}=80 \\mu \\mathrm{~m}$. $M_{1}$ and $M_{2}$ draw half the current of $M_{7}$ but with the same overdrive voltage, so $W_{1}=W_{2}=$ $W_{7} / 2=40 \\mu \\mathrm{~m}$. $M_{3}$ and $M_{4}$ must each satisfy\n\n$$\n50 \\mu \\mathrm{~A}=\\frac{100 \\mu \\mathrm{~A}}{2} \\frac{W}{1 \\mu \\mathrm{~m}} 0.25^{2}\n$$\n\nresulting in $W_{3}=W_{4}=16 \\mu \\mathrm{~m}$. By Eq. $(5.28),\\left(W_{5} / 1\\right) /(16 / 1)=2(80 / 1) /$ (80/1), or $W_{5}=32 \\mu \\mathrm{~m}$. Summarizing,\n\n$$\n\\begin{array}{ll}\nW_{1}=W_{2}=40 \\mu \\mathrm{~m} & W_{3}=W_{4}=16 \\mu \\mathrm{~m} \\\\\nW_{5}=32 \\mu \\mathrm{~m} & W_{6}=W_{7}=W_{8}=80 \\mu \\mathrm{~m}\n\\end{array}\n$$\n\n(b) From Eq. (5.25c), we have\n\n$$\n\\begin{aligned}\n& \\quad a=\\left[\\frac{2 \\times 1}{0.25(0.1+0.05)}\\right]^{2}=53.3^{2}=2,844 \\mathrm{~V} / \\mathrm{V} \\\\\n& \\text { hence } a_{1}=a_{2}=-53.3 \\mathrm{~V} / \\mathrm{V}. Also, \\lambda_{n}=\\lambda_{n}^{\\prime} / 1=0.1 \\mathrm{~V}^{-1} \\text { and } \\lambda_{p}=\\lambda_{p}^{\\prime} / 1=0.05 \\mathrm{~V}^{-1}, \\text { so } \\\\\n& r_{o 5}=1 /\\left(0.1 \\times 100 \\times 10^{-6}\\right)=100 \\mathrm{k} \\Omega, r_{o 6}=1 /\\left(0.05 \\times 100 \\times 10^{-6}\\right)=200 \\mathrm{k} \\Omega, \\text { and } \\\\\n& \\quad R_{o}=100 / / 200=66.7 \\mathrm{k} \\Omega\n\\end{aligned}\n$$\n\nFinally, Eqs. (5.30) and (5.31) yield\n\n$$\n\\begin{aligned}\n& v_{I C(\\max )}=2.5-2 \\times 0.25-0.75=1.25 \\mathrm{~V} \\\\\n& v_{I C(\\min )}=v_{O(\\min )}=-2.5+0.25=-2.25 \\mathrm{~V} \\\\\n& v_{O(\\max )}=2.25 \\mathrm{~V}\n\\end{aligned}\n$$\n\n(c) A PSpice simulation using the circuit in Fig. 5.14a produces the VTC shown in Fig. 5.14b, revealing a (systematic) input offset of $166 \\mu \\mathrm{~V}$ and confirming output saturation levels within a $V_{O V}$ of the $\\pm 2.5-\\mathrm{V}$ supplies. (The offset can be corrected by specifying a dc component of $-166 \\mu \\mathrm{~V}$ for the ac input source $v_{p}$.) After instructing PSpice to perform a small-signal analysis (.TF), we obtain $a=v_{o} / v_{p}=4,271 \\mathrm{~V} / \\mathrm{V}$ and $R_{o}=75 \\mathrm{k} \\Omega$. The discrepancy between calculated and simulated values mainly arises from the assumption $\\lambda=0$, particularly when calculating $g_{m 1}$ and $g_{m 5}$. For greater accuracy, we should multiply the calculated $g_{m 1}$ by $\\left(1+\\lambda V_{S D 1}\\right) \\cong(1+0.05 \\times 2.5)=1.125$ and $g_{m 5}$ by $\\left(1+\\lambda V_{D S 5}\\right) \\cong(1+0.1 \\times 2.5)=1.25$. With these adjustments, we get $a_{1} \\cong-53.3 \\times 1.125=-60 \\mathrm{~V} / \\mathrm{V}, a_{2} \\cong-53.3 \\times 1.25=-66.7 \\mathrm{~V} / \\mathrm{V}$, and $a \\cong-4,000 \\mathrm{~V} / \\mathrm{V}$, aligning better with PSpice results.\n\n(a)\nimage_name:(b)\ndescription:\n[\nname: M8, type: PMOS, ports: {S: VDD, D: x1, G: x1}\nname: M7, type: PMOS, ports: {S: VDD, D: x2, G: x1}\nname: M6, type: PMOS, ports: {S: VDD, D: vo, G: x1}\nname: M1, type: PMOS, ports: {S: x2, D: x3, G: GND}\nname: M2, type: PMOS, ports: {S: x2, D: x4, G: VP}\nname: M5, type: NMOS, ports: {S: GND, D: vo, G: x4}\nname: M4, type: NMOS, ports: {S: Vss, D: x4, G: x3}\nname: M3, type: NMOS, ports: {S: Vss, D: x3, G: x3}\nname: IREF, type: CurrentSource, value: 100uA, ports: {Np: x1, Nn: Vss}\nname: VP, type: VoltageSource, value: VP, ports: {Np: VP, Nn: GND}\n]\nextrainfo:The circuit is a differential amplifier with PMOS and NMOS transistors. It uses a current source IREF for biasing, and the differential input is applied at VP. The output is taken at vo. The circuit operates between VDD and VSS supply voltages.\n\n(b)\n\nThe graph in figure (b) is a Voltage Transfer Characteristic (VTC) curve. It illustrates the relationship between the input voltage difference \\( v_P - v_N \\) (in millivolts) on the x-axis and the output voltage \\( v_O \\) (in volts) on the y-axis.\n\n1. **Type of Graph and Function:**\n- This is a Voltage Transfer Characteristic curve, commonly used to depict the behavior of circuits like amplifiers or comparators.\n\n2. **Axes Labels and Units:**\n- The x-axis is labeled \"Input \\( v_P - v_N \\)\" with units in millivolts (mV), ranging from -1.0 mV to 1.0 mV.\n- The y-axis is labeled \"Output \\( v_O \\)\" with units in volts (V), ranging from -2.5 V to 2.5 V.\n- Both axes use a linear scale.\n\n3. **Overall Behavior and Trends:**\n- The graph shows a central linear region where the output voltage increases with the input voltage.\n- At the extreme ends of the input voltage range, the graph flattens, indicating saturation regions where input voltage changes have minimal impact on the output voltage.\n- The curve transitions smoothly from one saturation region through the linear region to the other saturation region.\n\n4. **Key Features and Technical Details:**\n- The linear region is approximately centered around the origin, indicating a gain where small input voltage changes result in proportional output voltage changes.\n- The saturation regions at both ends represent the output limits of the device.\n\n5. **Annotations and Specific Data Points:**\n- No specific markers or annotations are present, but critical points include the threshold where the curve deviates from the linear region and the maximum output voltage in the saturation regions.\n- The graph is symmetric around the origin, indicating balanced behavior for positive and negative input voltages.\n\n(b)\n\nFIGURE 5.14 (a) PSpice circuit for Example 5.2, and (b) its VTC. The MOSFET parameters are as follows: $k_{n}^{\\prime}=2.5 k_{p}^{\\prime}=100 \\mu \\mathrm{~A} / \\mathrm{V}^{2}, V_{t n}=-V_{t p}=0.75 \\mathrm{~V}$, and $\\lambda_{n}=2 \\lambda_{\\rho}=0.1 \\mathrm{~V}^{-1}$."
},
{
    "text": "The output of an amplifier should remain unaffected by any fluctuations in its power-supply voltages, such as ripple and noise induced by neighboring circuitry. However, in reality, amplifiers are somewhat sensitive to these variations (in addition to the well-known common-mode input voltage). Consequently, the small-signal output of an operational amplifier with split supplies can be expressed in a more general form:\n\n$$\n\\begin{equation*}\nv_{o}=a_{d m} v_{i d}+a_{c m} v_{i c}+a_{d d} v_{d d}+a_{s s} v_{s s} \\tag{5.33}\n\\end{equation*}\n$$\n\nHere, $v_{d d}$ and $v_{s s}$ represent the variations in the supply voltages $V_{D D}$ and $V_{S S}$, respectively, while $a_{d d}$ and $a_{s s}$ are the gains by which the amplifier amplifies these variations, specifically, $a_{d d}=v_{o} / v_{d d}$ and $a_{s s}=v_{o} / v_{s s}$. Ideally, both $a_{d d}$ and $a_{s s}$ should be zero (just as $a_{c m}$ should be). To assess how insensitive a real amplifier is to power-supply variations, we use a metric called the power-supply rejection ratio (PSRR), which, for split supplies, is expressed as:\n\n$$\n\\begin{equation*}\n\\mathrm{CMRR}_{d d}=\\left|\\frac{a_{d m}}{a_{d d}}\\right| \\quad \\mathrm{CMRR}_{s s}=\\left|\\frac{a_{d m}}{a_{s s}}\\right| \\tag{5.34}\n\\end{equation*}\n$$\n\nHere, $a_{d m}$ is the familiar differential-mode gain. To estimate the PSRRs of a two-stage CMOS op amp, refer to its AC equivalents shown in Fig. 5.15, based on which we make the following observations:\n\n- Applying $v_{d d}$ to the emitters of the $M_{1}-M_{2}$ pair via $r_{o 7}$ has the same effect as lifting their bases off ground and driving them with a common voltage of $-v_{d d}$ while keeping the upper terminal of $r_{o 7}$ at AC ground. We can thus adapt the common-mode gain from Eq. (4.157c) to this circuit. Ignoring the body effect for simplicity, we get:\n\n$$\nv_{d s 4}=a_{c m(\\mathrm{MOS})}\\left(-v_{d d}\\right) \\cong \\frac{v_{d d}}{2 g_{m 4} r_{o 7}}\n$$\n\nApplying KCL at node $v_{o}$ yields:\n\n$$\n\\frac{v_{d d}-v_{o}}{r_{o 6}}=g_{m 5} \\frac{v_{d d}}{2 g_{m 4} r_{o 7}}+\\frac{v_{o}}{r_{o 5}}\n$$\n\nimage_name:(a)\ndescription:\n[\nname: M1, type: PMOS, ports: {S: s1s2, D: x1, G: GND}\nname: M2, type: PMOS, ports: {S: s1s2, D: d2d4g5, G: GND}\nname: M3, type: NMOS, ports: {S: GND, D: x1, G: x1}\nname: M4, type: NMOS, ports: {S: GND, D: d2d4g5, G: x1}\nname: M5, type: NMOS, ports: {S: GND, D: vo, G: d2d4g5}\nname: ro7, type: Resistor, value: ro7, ports: {N1: Vdd, N2: s1s2}\nname: ro6, type: Resistor, value: ro6, ports: {N1: vo, N2: VDD}\nname: vdd, type: VoltageSource, value: vdd, ports: {Np: Vdd, Nn: GND}\n]\nextrainfo:The circuit is an AC equivalent model for estimating supply rejection ratios. It includes PMOS and NMOS transistors, resistors, and a voltage source. The PMOS transistors M1 and M2 are connected to the supply voltage Vdd, and M3, M4, and M5 are NMOS transistors forming a differential pair and current mirror. The resistors ro7 and ro6 are used for biasing and load, respectively.\nimage_name:(b)\ndescription:\n[\nname: M1, type: PMOS, ports: {S: s1s2, D: x1, G: GND}\nname: M2, type: PMOS, ports: {S: s1s2, D: vo, G: GND}\nname: M3, type: NMOS, ports: {S: vss, D: x1, G: x1}\nname: M4, type: NMOS, ports: {S: x1, D: d2d4g3, G: d2d4g3}\nname: M5, type: NMOS, ports: {S: vss, D: vo, G: d2d4g3}\nname: r_o7, type: Resistor, value: r_o7, ports: {N1: s1s2, N2: 0}\nname: r_o6, type: Resistor, value: r_o6, ports: {N1: vo, N2: GND}\nname: v_ss, type: VoltageSource, value: v_ss, ports: {Np: vss, Nn: GND}\n]\nextrainfo:This circuit is an AC equivalent model for estimating the supply rejection ratios to VDD and VSS. It includes PMOS and NMOS transistors arranged to analyze the effect of supply variations on the output voltage.\n\nFIGURE 5.15 Ac equivalents for the estimation of the supply rejection ratios to (a) $V_{D D}$ and (b) $V_{S S}$.\n\nGiven that $V_{O V 5}=V_{O V 4}$ and $V_{O V 6}=V_{O V 7}$, it follows that $r_{o 6} / r_{o 7}=2 g_{m 4} / g_{m 5}$, so the above expression simplifies to $v_{o}\\left(1 / r_{o 6}+1 / r_{o 5}\\right)=v_{d d}\\left(1 / r_{o 6}-1 / r_{o 6}\\right)=0$. This is feasible only if $v_{o}=0$, thus:\n\n$$\n\\begin{equation*}\na_{d d}=\\frac{v_{o}}{v_{d d}}=\\frac{0}{v_{d d}}=0 \\mathrm{~V} / \\mathrm{V} \\tag{5.35a}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{equation*}\n\\operatorname{PSRR}_{d d}=\\infty \\tag{5.35b}\n\\end{equation*}\n$$\n\nInterestingly, the contributions of $v_{d d}$ to $v_{o}$ via $r_{o 6}$ and $r_{o 7}$ cancel each other out. However, due to various approximations, $\\operatorname{PSRR}_{d d}$ will not be infinite in practice, though it is expected to be relatively high.\n\n- Considering Fig. 5.15b, we observe that the balance condition of the input stage remains undisturbed by $v_{s s}$, resulting in $v_{d s 4}=v_{d s 3}=0$. With $M_{5}$'s internal dependent source inactive, we use the voltage divider rule to express:\n\n$$\n\\begin{equation*}\na_{s s}=\\frac{v_{o}}{v_{s s}}=\\frac{r_{o 6}}{r_{o 5}+r_{o 6}} \\tag{5.36a}\n\\end{equation*}\n$$\n\nSubstituting into Eq. (5.34), along with $a_{d m}$ from Eq. (5.25a), we obtain:\n\n$$\n\\begin{equation*}\n\\operatorname{PSRR}_{s s}=g_{m 1}\\left(r_{o 2} / / r_{o 4}\\right) g_{m 5} r_{o 5} \\tag{5.36b}\n\\end{equation*}\n$$\n\nEXAMPLE 5.3 Estimate the CMRR and PSRRs of the CMOS op amp from Example 5.2 (ignore the body effect for $M_{1}$ and $M_{2}$). Compare with PSpice results and comment.\n\n#### Solution\n\nUsing $g_{m 1}=g_{m 3}=\\left(2 \\times 50 \\times 10^{-6} / 0.25\\right) \\times 1.125=0.45 \\mathrm{~mA} / \\mathrm{V}$ and $g_{m 5}=(2 \\times 100 \\times 10^{-6} / 0.25) \\times 1.25=1 \\mathrm{~mA} / \\mathrm{V}$, we find, via Eqs. (5.32), (5.35b), and (5.36):\n\n$$\n\\operatorname{CMRR}=\\frac{1+0.45 \\times 200}{1+200 / 400}[1+2(0.45+0) 200]=10,981=80.8 \\mathrm{~dB}\n$$\n\n$$\n\\operatorname{PSRR}_{d d}=\\infty \\quad \\operatorname{PSRR}_{s s}=0.45(400 / / 200) \\times 1 \\times 100=6,000=75.6 \\mathrm{~dB}\n$$\n\nTo determine the CMRR using PSpice, use the circuit from Fig. 5.14 with the inputs tied together and driven by a common AC source $v_{i c}$. The small-signal analysis (.TF) gives $a_{c m}=v_{o} / v_{i c}=0.4214 \\mathrm{~V} / \\mathrm{V}$, so CMRR $=a_{d m} / a_{c m}=4271 / 0.4214=10,135=80.1 \\mathrm{~dB}$, which aligns well with the calculated value.\n\nFor $\\operatorname{PSRR}_{d d}$, ground the inputs and insert an AC source $v_{d d}$ in series with the $V_{D D}$ source (or implement $V_{D D}$ with an AC source having a DC component of 2.5 V). The small-signal analysis (.TF) yields $a_{d d}=v_{o} / v_{d d}=-0.04158 \\mathrm{~V}$. While not zero as predicted, $a_{d d}$ is small, resulting in $\\operatorname{PSRR}_{d d}=\\left|a_{d m} / a_{d d}\\right|=4271 / 0.04158=102,718=100 \\mathrm{~dB}$, which is still quite high. Similarly, using an AC source $v_{s s}$ in series with $V_{S S}$ gives $a_{s s}=v_{o} / v_{s s}=0.6202 \\mathrm{~V} / \\mathrm{V}$, so $\\operatorname{PSRR}_{s s}=\\left|a_{d m} / a_{s s}\\right|=4271 / 0.6202=6,886=76.8 \\mathrm{~dB}$, in reasonable agreement with the calculated value.\n\nRewriting Eq. (5.33) as:\n\n$$\n\\begin{align*}\nv_{o} & =a_{d m}\\left(v_{i d}+\\frac{a_{c m}}{a_{d m}} v_{i c}+\\frac{a_{d d}}{a_{d m}} v_{d d}+\\frac{a_{s s}}{a_{d m}} v_{s s}\\right) \\\\\n& =a_{d m}\\left(v_{i d}+\\frac{v_{i c}}{\\operatorname{CMRR}}+\\frac{v_{d d}}{\\operatorname{PSRR}_{d d}}+\\frac{v_{s s}}{\\operatorname{PSRR}_{s s}}\\right) \\tag{5.37}\n\\end{align*}\n$$\n\nprovides an insightful interpretation of the rejection ratios: (a) the voltages $v_{i c}, v_{d d}$, and $v_{s s}$, when reflected to the input, are divided by their respective rejection ratios; (b) since these reflected voltages are in series with $v_{i d}$, they act as separate input offset-voltage components. Clearly, higher rejection ratios result in smaller corresponding input offset terms."
},
{
    "text": "The output of an amplifier should remain不受影响 by any variations in its power-supply voltages, such as ripple and noise induced by nearby circuitry. However, in real-world amplifiers, there is some sensitivity to these variations (in addition to the well-known common-mode input voltage). Consequently, the small-signal output of an operational amplifier with split supplies can be expressed in a more general form:\n\n$$\n\\begin{equation*}\nv_{o}=a_{d m} v_{i d}+a_{c m} v_{i c}+a_{d d} v_{d d}+a_{s s} v_{s s} \\tag{5.33}\n\\end{equation*}\n$$\n\nHere, $v_{d d}$ and $v_{s s}$ represent the variations in the supply voltages $V_{D D}$ and $V_{S S}$, respectively, while $a_{d d}$ and $a_{s s}$ are the gains by which the amplifier amplifies these variations, specifically, $a_{d d}=v_{o} / v_{d d}$ and $a_{s s}=v_{o} / v_{s s}$. Ideally, both $a_{d d}$ and $a_{s s}$ should be zero (just as $a_{c m}$ should be). To gauge how insensitive a real-world amplifier is to power-supply variations, we use a metric known as the power-supply rejection ratio (PSRR), which, for split supplies, is expressed as:\n\n$$\n\\begin{equation*}\n\\mathrm{CMRR}_{d d}=\\left|\\frac{a_{d m}}{a_{d d}}\\right| \\quad \\mathrm{CMRR}_{s s}=\\left|\\frac{a_{d m}}{a_{s s}}\\right| \\tag{5.34}\n\\end{equation*}\n$$\n\nIn these expressions, $a_{d m}$ is the familiar differential-mode gain. To estimate the PSRRs of a two-stage CMOS operational amplifier, refer to its AC equivalents shown in Fig. 5.15, based on which we make the following observations:\n\n- Applying $v_{d d}$ to the emitters of the $M_{1}-M_{2}$ pair through $r_{o 7}$ has the same effect as lifting their bases off ground and driving them with a common voltage of $-v_{d d}$ while keeping the upper terminal of $r_{o 7}$ at AC ground. We can thus adapt the common-mode gain from Eq. (4.157c) to this circuit. Ignoring the body effect for simplicity, we get:\n\n$$\nv_{d s 4}=a_{c m(\\mathrm{MOS})}\\left(-v_{d d}\\right) \\cong \\frac{v_{d d}}{2 g_{m 4} r_{o 7}}\n$$\n\nApplying Kirchhoff's Current Law (KCL) at node $v_{o}$ yields:\n\n$$\n\\frac{v_{d d}-v_{o}}{r_{o 6}}=g_{m 5} \\frac{v_{d d}}{2 g_{m 4} r_{o 7}}+\\frac{v_{o}}{r_{o 5}}\n$$\n\nimage_name:(a)\ndescription:\n[\nname: M1, type: PMOS, ports: {S: s1s2, D: x1, G: GND}\nname: M2, type: PMOS, ports: {S: s1s2, D: d2d4g5, G: GND}\nname: M3, type: NMOS, ports: {S: GND, D: x1, G: x1}\nname: M4, type: NMOS, ports: {S: GND, D: d2d4g5, G: x1}\nname: M5, type: NMOS, ports: {S: GND, D: vo, G: d2d4g5}\nname: ro7, type: Resistor, value: ro7, ports: {N1: Vdd, N2: s1s2}\nname: ro6, type: Resistor, value: ro6, ports: {N1: vo, N2: VDD}\nname: vdd, type: VoltageSource, value: vdd, ports: {Np: Vdd, Nn: GND}\n]\nextrainfo:This circuit is an AC equivalent model for estimating supply rejection ratios. It includes PMOS and NMOS transistors, resistors, and a voltage source. The PMOS transistors M1 and M2 are connected to the supply voltage Vdd, and M3, M4, and M5 are NMOS transistors forming a differential pair and current mirror. The resistors ro7 and ro6 are used for biasing and load, respectively.\nimage_name:(b)\ndescription:\n[\nname: M1, type: PMOS, ports: {S: s1s2, D: x1, G: GND}\nname: M2, type: PMOS, ports: {S: s1s2, D: vo, G: GND}\nname: M3, type: NMOS, ports: {S: vss, D: x1, G: x1}\nname: M4, type: NMOS, ports: {S: x1, D: d2d4g3, G: d2d4g3}\nname: M5, type: NMOS, ports: {S: vss, D: vo, G: d2d4g3}\nname: r_o7, type: Resistor, value: r_o7, ports: {N1: s1s2, N2: 0}\nname: r_o6, type: Resistor, value: r_o6, ports: {N1: vo, N2: GND}\nname: v_ss, type: VoltageSource, value: v_ss, ports: {Np: vss, Nn: GND}\n]\nextrainfo:This circuit is an AC equivalent model for estimating the supply rejection ratios to VDD and VSS. It includes PMOS and NMOS transistors arranged to analyze the effect of supply variations on the output voltage.\n\nFIGURE 5.15 AC equivalents for the estimation of the supply rejection ratios to (a) $V_{D D}$ and (b) $V_{S S}$.\n\nGiven that $V_{O V 5}=V_{O V 4}$ and $V_{O V 6}=V_{O V 7}$, it follows that $r_{o 6} / r_{o 7}=2 g_{m 4} / g_{m 5}$, so the above expression simplifies to $v_{o}\\left(1 / r_{o 6}+1 / r_{o 5}\\right)=v_{d d}\\left(1 / r_{o 6}-1 / r_{o 6}\\right)=0$. This is only possible if $v_{o}=0$, thus:\n\n$$\n\\begin{equation*}\na_{d d}=\\frac{v_{o}}{v_{d d}}=\\frac{0}{v_{d d}}=0 \\mathrm{~V} / \\mathrm{V} \\tag{5.35a}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{equation*}\n\\operatorname{PSRR}_{d d}=\\infty \\tag{5.35b}\n\\end{equation*}\n$$\n\nInterestingly, the contributions of $v_{d d}$ to $v_{o}$ via $r_{o 6}$ and $r_{o 7}$ cancel each other out. However, due to various approximations, $\\operatorname{PSRR}_{d d}$ will not be infinite in practice, though it is expected to be quite high.\n\n- Moving to Fig. 5.15b, we observe that the balance condition of the input stage is unaffected by $v_{s s}$, resulting in $v_{d s 4}=v_{d s 3}=0$. With $M_{5}$'s internal dependent source inactive, we use the voltage divider rule to write:\n\n$$\n\\begin{equation*}\na_{s s}=\\frac{v_{o}}{v_{s s}}=\\frac{r_{o 6}}{r_{o 5}+r_{o 6}} \\tag{5.36a}\n\\end{equation*}\n$$\n\nSubstituting into Eq. (5.34), along with $a_{d m}$ from Eq. (5.25a), we obtain:\n\n$$\n\\begin{equation*}\n\\operatorname{PSRR}_{s s}=g_{m 1}\\left(r_{o 2} / / r_{o 4}\\right) g_{m 5} r_{o 5} \\tag{5.36b}\n\\end{equation*}\n$$\n\nEXAMPLE 5.3 Estimate the CMRR and PSRRs of the CMOS op amp from Example 5.2 (ignore the body effect for $M_{1}$ and $M_{2}$). Compare with PSpice results and comment.\n\n#### Solution\n\nUsing $g_{m 1}=g_{m 3}=\\left(2 \\times 50 \\times 10^{-6} / 0.25\\right) \\times 1.125=0.45 \\mathrm{~mA} / \\mathrm{V}$ and $g_{m 5}=(2 \\times 100 \\times 10^{-6} / 0.25) \\times 1.25=1 \\mathrm{~mA} / \\mathrm{V}$, we have, by Eqs. (5.32), (5.35b), and (5.36):\n\n$$\n\\operatorname{CMRR}=\\frac{1+0.45 \\times 200}{1+200 / 400}[1+2(0.45+0) 200]=10,981=80.8 \\mathrm{~dB}\n$$\n\n$$\n\\operatorname{PSRR}_{d d}=\\infty \\quad \\operatorname{PSRR}_{s s}=0.45(400 / / 200) \\times 1 \\times 100=6,000=75.6 \\mathrm{~dB}\n$$\n\nTo find the CMRR via PSpice, use the circuit from Fig. 5.14 with the inputs tied together and driven by a common AC source $v_{i c}$. The small-signal analysis (.TF) gives $a_{c m}=v_{o} / v_{i c}=0.4214 \\mathrm{~V} / \\mathrm{V}$, so CMRR $=a_{d m} / a_{c m}=4271 / 0.4214=10,135=80.1 \\mathrm{~dB}$, which is in good agreement with the calculated value.\n\nTo determine $\\operatorname{PSRR}_{d d}$, ground the inputs and insert an AC source $v_{d d}$ in series with the $V_{D D}$ source (or implement $V_{D D}$ with an AC source having a DC component of 2.5 V). The small-signal analysis (.TF) gives $a_{d d}=v_{o} / v_{d d}=-0.04158 \\mathrm{~V}$. Though not zero as predicted, $a_{d d}$ is small, resulting in $\\operatorname{PSRR}_{d d}=\\left|a_{d m} / a_{d d}\\right|=4271 / 0.04158=102,718=100 \\mathrm{~dB}$, which is still quite high. Similarly, using an AC source $v_{s s}$ in series with $V_{S S}$ gives $a_{s s}=v_{o} / v_{s s}=0.6202 \\mathrm{~V} / \\mathrm{V}$, so $\\operatorname{PSRR}_{s s}=\\left|a_{d m} / a_{s s}\\right|=4271 / 0.6202=6,886=76.8 \\mathrm{~dB}$, which is reasonably close to the calculated value.\n\nRewriting Eq. (5.33) as:\n\n$$\n\\begin{align*}\nv_{o} & =a_{d m}\\left(v_{i d}+\\frac{a_{c m}}{a_{d m}} v_{i c}+\\frac{a_{d d}}{a_{d m}} v_{d d}+\\frac{a_{s s}}{a_{d m}} v_{s s}\\right) \\\\\n& =a_{d m}\\left(v_{i d}+\\frac{v_{i c}}{\\operatorname{CMRR}}+\\frac{v_{d d}}{\\operatorname{PSRR}_{d d}}+\\frac{v_{s s}}{\\operatorname{PSRR}_{s s}}\\right) \\tag{5.37}\n\\end{align*}\n$$\n\nprovides an insightful interpretation of the rejection ratios: (a) the voltages $v_{i c}, v_{d d}$, and $v_{s s}$, when reflected to the input, are divided by their respective rejection ratios; (b) since these reflected voltages are in series with $v_{i d}$, they act as separate input offset-voltage components. Clearly, higher rejection ratios result in smaller corresponding input offset terms."
},
{
    "text": "The output of an amplifier should remain unaffected by any fluctuations in its power-supply voltages, such as ripple and noise induced by neighboring circuitry. However, in practical amplifiers, there is some sensitivity to these variations (in addition to the well-known common-mode input voltage). Consequently, the small-signal output of an operational amplifier with split supplies can be expressed in a more generalized form:\n\n$$\n\\begin{equation*}\nv_{o}=a_{d m} v_{i d}+a_{c m} v_{i c}+a_{d d} v_{d d}+a_{s s} v_{s s} \\tag{5.33}\n\\end{equation*}\n$$\n\nHere, $v_{d d}$ and $v_{s s}$ represent the variations in the supply voltages $V_{D D}$ and $V_{S S}$, respectively, while $a_{d d}$ and $a_{s s}$ are the gains by which the amplifier amplifies these variations, specifically, $a_{d d}=v_{o} / v_{d d}$ and $a_{s s}=v_{o} / v_{s s}$. Ideally, both $a_{d d}$ and $a_{s s}$ should be zero (just as $a_{c m}$ should be). To quantify how insensitive a real amplifier is to power-supply variations, we use a metric known as the power-supply rejection ratio (PSRR), which, for split supplies, is expressed as:\n\n$$\n\\begin{equation*}\n\\mathrm{CMRR}_{d d}=\\left|\\frac{a_{d m}}{a_{d d}}\\right| \\quad \\mathrm{CMRR}_{s s}=\\left|\\frac{a_{d m}}{a_{s s}}\\right| \\tag{5.34}\n\\end{equation*}\n$$\n\nIn these equations, $a_{d m}$ is the familiar differential-mode gain. To estimate the PSRRs of a two-stage CMOS op amp, refer to its AC equivalents shown in Fig. 5.15, based on which we make the following observations:\n\n- Applying $v_{d d}$ to the emitters of the $M_{1}-M_{2}$ pair through $r_{o 7}$ has the same effect as lifting their bases off ground and driving them with a common voltage of $-v_{d d}$ while keeping the upper terminal of $r_{o 7}$ at AC ground. We can thus adapt the common-mode gain from Eq. (4.157c) to this circuit. Ignoring the body effect for simplicity, we get:\n\n$$\nv_{d s 4}=a_{c m(\\mathrm{MOS})}\\left(-v_{d d}\\right) \\cong \\frac{v_{d d}}{2 g_{m 4} r_{o 7}}\n$$\n\nApplying Kirchhoff's Current Law (KCL) at node $v_{o}$ yields:\n\n$$\n\\frac{v_{d d}-v_{o}}{r_{o 6}}=g_{m 5} \\frac{v_{d d}}{2 g_{m 4} r_{o 7}}+\\frac{v_{o}}{r_{o 5}}\n$$\n\n**Image Description (a):**\n- **Components:**\n  - M1: PMOS, Source: s1s2, Drain: x1, Gate: GND\n  - M2: PMOS, Source: s1s2, Drain: d2d4g5, Gate: GND\n  - M3: NMOS, Source: GND, Drain: x1, Gate: x1\n  - M4: NMOS, Source: GND, Drain: d2d4g5, Gate: x1\n  - M5: NMOS, Source: GND, Drain: vo, Gate: d2d4g5\n  - ro7: Resistor, Value: ro7, Nodes: Vdd, s1s2\n  - ro6: Resistor, Value: ro6, Nodes: vo, VDD\n  - vdd: Voltage Source, Value: vdd, Nodes: Vdd, GND\n- **Extra Info:** The circuit is an AC equivalent model for estimating supply rejection ratios, including PMOS and NMOS transistors, resistors, and a voltage source. PMOS transistors M1 and M2 are connected to the supply voltage Vdd, and M3, M4, and M5 are NMOS transistors forming a differential pair and current mirror. Resistors ro7 and ro6 are used for biasing and load, respectively.\n\n**Image Description (b):**\n- **Components:**\n  - M1: PMOS, Source: s1s2, Drain: x1, Gate: GND\n  - M2: PMOS, Source: s1s2, Drain: vo, Gate: GND\n  - M3: NMOS, Source: vss, Drain: x1, Gate: x1\n  - M4: NMOS, Source: x1, Drain: d2d4g3, Gate: d2d4g3\n  - M5: NMOS, Source: vss, Drain: vo, Gate: d2d4g3\n  - r_o7: Resistor, Value: r_o7, Nodes: s1s2, 0\n  - r_o6: Resistor, Value: r_o6, Nodes: vo, GND\n  - v_ss: Voltage Source, Value: v_ss, Nodes: vss, GND\n- **Extra Info:** This circuit is an AC equivalent model for estimating the supply rejection ratios to VDD and VSS. It includes PMOS and NMOS transistors arranged to analyze the effect of supply variations on the output voltage.\n\n**FIGURE 5.15** AC equivalents for the estimation of the supply rejection ratios to (a) $V_{D D}$ and (b) $V_{S S}$.\n\nGiven that $V_{O V 5}=V_{O V 4}$ and $V_{O V 6}=V_{O V 7}$, it follows that $r_{o 6} / r_{o 7}=2 g_{m 4} / g_{m 5}$, so the above expression simplifies to $v_{o}\\left(1 / r_{o 6}+1 / r_{o 5}\\right)=v_{d d}\\left(1 / r_{o 6}-1 / r_{o 6}\\right)=0$. This is only possible if $v_{o}=0$, thus:\n\n$$\n\\begin{equation*}\na_{d d}=\\frac{v_{o}}{v_{d d}}=\\frac{0}{v_{d d}}=0 \\mathrm{~V} / \\mathrm{V} \\tag{5.35a}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{equation*}\n\\operatorname{PSRR}_{d d}=\\infty \\tag{5.35b}\n\\end{equation*}\n$$\n\nInterestingly, the contributions of $v_{d d}$ to $v_{o}$ via $r_{o 6}$ and $r_{o 7}$ cancel each other out. However, due to various approximations, $\\operatorname{PSRR}_{d d}$ will not be infinite in practice, though it is expected to be relatively high.\n\n- Moving to Fig. 5.15b, we observe that the balance condition of the input stage remains undisturbed by $v_{s s}$, so $v_{d s 4}=v_{d s 3}=0$. M5's internal dependent source is now inactive, so we use the voltage divider rule to write:\n\n$$\n\\begin{equation*}\na_{s s}=\\frac{v_{o}}{v_{s s}}=\\frac{r_{o 6}}{r_{o 5}+r_{o 6}} \\tag{5.36a}\n\\end{equation*}\n$$\n\nSubstituting into Eq. (5.34), along with $a_{d m}$ from Eq. (5.25a), we finally obtain:\n\n$$\n\\begin{equation*}\n\\operatorname{PSRR}_{s s}=g_{m 1}\\left(r_{o 2} / / r_{o 4}\\right) g_{m 5} r_{o 5} \\tag{5.36b}\n\\end{equation*}\n$$\n\n**EXAMPLE 5.3** Estimate the CMRR and PSRRs of the CMOS op amp from Example 5.2 (ignore the body effect for $M_{1}$ and $M_{2}$). Compare with PSpice results and comment.\n\n#### Solution\n\nUsing $g_{m 1}=g_{m 3}=\\left(2 \\times 50 \\times 10^{-6} / 0.25\\right) \\times 1.125=0.45 \\mathrm{~mA} / \\mathrm{V}$ and $g_{m 5}=(2 \\times 100 \\times 10^{-6} / 0.25) \\times 1.25=1 \\mathrm{~mA} / \\mathrm{V}$, we have, from Eqs. (5.32), (5.35b), and (5.36):\n\n$$\n\\operatorname{CMRR}=\\frac{1+0.45 \\times 200}{1+200 / 400}[1+2(0.45+0) 200]=10,981=80.8 \\mathrm{~dB}\n$$\n\n$$\n\\operatorname{PSRR}_{d d}=\\infty \\quad \\operatorname{PSRR}_{s s}=0.45(400 / / 200) \\times 1 \\times 100=6,000=75.6 \\mathrm{~dB}\n$$\n\nTo find the CMRR via PSpice, use the circuit from Fig. 5.14 with the inputs tied together and driven by a common AC source $v_{i c}$. The small-signal analysis (.TF) gives $a_{c m}=v_{o} / v_{i c}=0.4214 \\mathrm{~V} / \\mathrm{V}$, so CMRR $=a_{d m} / a_{c m}=4271 / 0.4214=10,135=80.1 \\mathrm{~dB}$, which is in good agreement with the calculated value.\n\nTo find $\\operatorname{PSRR}_{d d}$, ground the inputs and insert an AC source $v_{d d}$ in series with the $V_{D D}$ source (or implement $V_{D D}$ with an AC source having a DC component of 2.5 V). The small-signal analysis (.TF) gives $a_{d d}=v_{o} / v_{d d}=-0.04158 \\mathrm{~V}$. Although not zero as predicted, $a_{d d}$ is small, resulting in $\\operatorname{PSRR}_{d d}=\\left|a_{d m} / a_{d d}\\right|=4271 / 0.04158=102,718=100 \\mathrm{~dB}$, which is still quite high. Similarly, using an AC source $v_{s s}$ in series with $V_{S S}$ gives $a_{s s}=v_{o} / v_{s s}=0.6202 \\mathrm{~V} / \\mathrm{V}$, so $\\operatorname{PSRR}_{s s}=\\left|a_{d m} / a_{s s}\\right|=4271 / 0.6202=6,886=76.8 \\mathrm{~dB}$, in reasonable agreement with the calculated value.\n\nRewriting Eq. (5.33) as:\n\n$$\n\\begin{align*}\nv_{o} & =a_{d m}\\left(v_{i d}+\\frac{a_{c m}}{a_{d m}} v_{i c}+\\frac{a_{d d}}{a_{d m}} v_{d d}+\\frac{a_{s s}}{a_{d m}} v_{s s}\\right) \\\\\n& =a_{d m}\\left(v_{i d}+\\frac{v_{i c}}{\\operatorname{CMRR}}+\\frac{v_{d d}}{\\operatorname{PSRR}_{d d}}+\\frac{v_{s s}}{\\operatorname{PSRR}_{s s}}\\right) \\tag{5.37}\n\\end{align*}\n$$\n\nprovides an insightful interpretation of the rejection ratios: (a) the voltages $v_{i c}, v_{d d}$, and $v_{s s}$, when reflected to the input, are divided by their respective rejection ratios; (b) since these reflected voltages are in series with $v_{i d}$, they act as separate input offset-voltage components. Clearly, higher rejection ratios result in smaller corresponding input offset terms."
},
{
    "text": "The output of an amplifier should remain unaffected by any fluctuations in its power-supply voltages, such as ripple and noise induced by neighboring circuitry. However, in real-world amplifiers, there is some sensitivity to these variations (in addition to the well-known common-mode input voltage). Consequently, the small-signal output of an operational amplifier with split supplies can be expressed in a more generalized form:\n\n$$\n\\begin{equation*}\nv_{o}=a_{d m} v_{i d}+a_{c m} v_{i c}+a_{d d} v_{d d}+a_{s s} v_{s s} \\tag{5.33}\n\\end{equation*}\n$$\n\nHere, $v_{d d}$ and $v_{s s}$ represent the variations in the supply voltages $V_{D D}$ and $V_{S S}$, respectively, while $a_{d d}$ and $a_{s s}$ are the gains by which the amplifier amplifies these variations, specifically, $a_{d d}=v_{o} / v_{d d}$ and $a_{s s}=v_{o} / v_{s s}$. Ideally, both $a_{d d}$ and $a_{s s}$ should be zero (just as $a_{c m}$ should be). To gauge how insensitive a real-world amplifier is to power-supply variations, we use a metric known as the power-supply rejection ratio (PSRR), which, for split supplies, is expressed as:\n\n$$\n\\begin{equation*}\n\\mathrm{CMRR}_{d d}=\\left|\\frac{a_{d m}}{a_{d d}}\\right| \\quad \\mathrm{CMRR}_{s s}=\\left|\\frac{a_{d m}}{a_{s s}}\\right| \\tag{5.34}\n\\end{equation*}\n$$\n\nIn this context, $a_{d m}$ is the familiar differential-mode gain. To estimate the PSRRs of the two-stage CMOS op amp, refer to its AC equivalents shown in Fig. 5.15, based on which we make the following observations:\n\n- Applying $v_{d d}$ to the emitters of the $M_{1}-M_{2}$ pair via $r_{o 7}$ has the same effect as lifting their bases off ground and driving them with a common voltage of $-v_{d d}$ while keeping the upper terminal of $r_{o 7}$ at AC ground. We can thus adapt the common-mode gain from Eq. (4.157c) to this circuit. Ignoring the body effect for simplicity, we get:\n\n$$\nv_{d s 4}=a_{c m(\\mathrm{MOS})}\\left(-v_{d d}\\right) \\cong \\frac{v_{d d}}{2 g_{m 4} r_{o 7}}\n$$\n\nApplying Kirchhoff's Current Law (KCL) at node $v_{o}$ yields:\n\n$$\n\\frac{v_{d d}-v_{o}}{r_{o 6}}=g_{m 5} \\frac{v_{d d}}{2 g_{m 4} r_{o 7}}+\\frac{v_{o}}{r_{o 5}}\n$$\n\nimage_name:(a)\ndescription:\n[\nname: M1, type: PMOS, ports: {S: s1s2, D: x1, G: GND}\nname: M2, type: PMOS, ports: {S: s1s2, D: d2d4g5, G: GND}\nname: M3, type: NMOS, ports: {S: GND, D: x1, G: x1}\nname: M4, type: NMOS, ports: {S: GND, D: d2d4g5, G: x1}\nname: M5, type: NMOS, ports: {S: GND, D: vo, G: d2d4g5}\nname: ro7, type: Resistor, value: ro7, ports: {N1: Vdd, N2: s1s2}\nname: ro6, type: Resistor, value: ro6, ports: {N1: vo, N2: VDD}\nname: vdd, type: VoltageSource, value: vdd, ports: {Np: Vdd, Nn: GND}\n]\nextrainfo:The circuit is an AC equivalent model for estimating supply rejection ratios. It includes PMOS and NMOS transistors, resistors, and a voltage source. The PMOS transistors M1 and M2 are connected to the supply voltage Vdd, and M3, M4, and M5 are NMOS transistors forming a differential pair and current mirror. The resistors ro7 and ro6 are used for biasing and load, respectively.\nimage_name:(b)\ndescription:\n[\nname: M1, type: PMOS, ports: {S: s1s2, D: x1, G: GND}\nname: M2, type: PMOS, ports: {S: s1s2, D: vo, G: GND}\nname: M3, type: NMOS, ports: {S: vss, D: x1, G: x1}\nname: M4, type: NMOS, ports: {S: x1, D: d2d4g3, G: d2d4g3}\nname: M5, type: NMOS, ports: {S: vss, D: vo, G: d2d4g3}\nname: r_o7, type: Resistor, value: r_o7, ports: {N1: s1s2, N2: 0}\nname: r_o6, type: Resistor, value: r_o6, ports: {N1: vo, N2: GND}\nname: v_ss, type: VoltageSource, value: v_ss, ports: {Np: vss, Nn: GND}\n]\nextrainfo:This circuit is an AC equivalent model for estimating the supply rejection ratios to VDD and VSS. It includes PMOS and NMOS transistors arranged to analyze the effect of supply variations on the output voltage.\n\nFIGURE 5.15 AC equivalents for the estimation of the supply rejection ratios to (a) $V_{D D}$ and (b) $V_{S S}$.\n\nGiven that $V_{O V 5}=V_{O V 4}$ and $V_{O V 6}=V_{O V 7}$, it follows that $r_{o 6} / r_{o 7}=2 g_{m 4} / g_{m 5}$, leading to $v_{o}\\left(1 / r_{o 6}+1 / r_{o 5}\\right)=v_{d d}\\left(1 / r_{o 6}-1 / r_{o 6}\\right)=0$. This is feasible only if $v_{o}=0$, thus:\n\n$$\n\\begin{equation*}\na_{d d}=\\frac{v_{o}}{v_{d d}}=\\frac{0}{v_{d d}}=0 \\mathrm{~V} / \\mathrm{V} \\tag{5.35a}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{equation*}\n\\operatorname{PSRR}_{d d}=\\infty \\tag{5.35b}\n\\end{equation*}\n$$\n\nInterestingly, the contributions of $v_{d d}$ to $v_{o}$ via $r_{o 6}$ and $r_{o 7}$ cancel each other out. However, due to various approximations, $\\operatorname{PSRR}_{d d}$ will not be infinite in practice, though it is expected to be quite high.\n\n- Moving to Fig. 5.15b, we observe that the input stage's balance condition is undisturbed by $v_{s s}$, resulting in $v_{d s 4}=v_{d s 3}=0$. With $M_{5}$'s internal dependent source inactive, we use the voltage divider rule to write:\n\n$$\n\\begin{equation*}\na_{s s}=\\frac{v_{o}}{v_{s s}}=\\frac{r_{o 6}}{r_{o 5}+r_{o 6}} \\tag{5.36a}\n\\end{equation*}\n$$\n\nSubstituting into Eq. (5.34), along with $a_{d m}$ from Eq. (5.25a), we obtain:\n\n$$\n\\begin{equation*}\n\\operatorname{PSRR}_{s s}=g_{m 1}\\left(r_{o 2} / / r_{o 4}\\right) g_{m 5} r_{o 5} \\tag{5.36b}\n\\end{equation*}\n$$\n\nEXAMPLE 5.3 Estimate the CMRR and PSRRs of the CMOS op amp from Example 5.2 (ignore the body effect for $M_{1}$ and $M_{2}$). Compare with PSpice results and provide comments.\n\n#### Solution\n\nUsing $g_{m 1}=g_{m 3}=\\left(2 \\times 50 \\times 10^{-6} / 0.25\\right) \\times 1.125=0.45 \\mathrm{~mA} / \\mathrm{V}$ and $g_{m 5}=(2 \\times 100 \\times 10^{-6} / 0.25) \\times 1.25=1 \\mathrm{~mA} / \\mathrm{V}$, we find, via Eqs. (5.32), (5.35b), and (5.36):\n\n$$\n\\operatorname{CMRR}=\\frac{1+0.45 \\times 200}{1+200 / 400}[1+2(0.45+0) 200]=10,981=80.8 \\mathrm{~dB}\n$$\n\n$$\n\\operatorname{PSRR}_{d d}=\\infty \\quad \\operatorname{PSRR}_{s s}=0.45(400 / / 200) \\times 1 \\times 100=6,000=75.6 \\mathrm{~dB}\n$$\n\nTo determine the CMRR using PSpice, use the circuit from Fig. 5.14 with the inputs tied together and driven by a common AC source $v_{i c}$. The small-signal analysis (.TF) gives $a_{c m}=v_{o} / v_{i c}=0.4214 \\mathrm{~V} / \\mathrm{V}$, so CMRR $=a_{d m} / a_{c m}=4271 / 0.4214=10,135=80.1 \\mathrm{~dB}$, which agrees well with the calculated value.\n\nFor $\\operatorname{PSRR}_{d d}$, ground the inputs and insert an AC source $v_{d d}$ in series with the $V_{D D}$ source (or implement $V_{D D}$ with an AC source having a DC component of 2.5 V). The small-signal analysis (.TF) yields $a_{d d}=v_{o} / v_{d d}=-0.04158 \\mathrm{~V}$. While not zero as predicted, $a_{d d}$ is small, resulting in $\\operatorname{PSRR}_{d d}=\\left|a_{d m} / a_{d d}\\right|=4271 / 0.04158=102,718=100 \\mathrm{~dB}$, which is still quite high. Similarly, using an AC source $v_{s s}$ in series with $V_{S S}$ gives $a_{s s}=v_{o} / v_{s s}=0.6202 \\mathrm{~V} / \\mathrm{V}$, so $\\operatorname{PSRR}_{s s}=\\left|a_{d m} / a_{s s}\\right|=4271 / 0.6202=6,886=76.8 \\mathrm{~dB}$, aligning reasonably with the calculated value.\n\nRewriting Eq. (5.33) as:\n\n$$\n\\begin{align*}\nv_{o} & =a_{d m}\\left(v_{i d}+\\frac{a_{c m}}{a_{d m}} v_{i c}+\\frac{a_{d d}}{a_{d m}} v_{d d}+\\frac{a_{s s}}{a_{d m}} v_{s s}\\right) \\\\\n& =a_{d m}\\left(v_{i d}+\\frac{v_{i c}}{\\operatorname{CMRR}}+\\frac{v_{d d}}{\\operatorname{PSRR}_{d d}}+\\frac{v_{s s}}{\\operatorname{PSRR}_{s s}}\\right) \\tag{5.37}\n\\end{align*}\n$$\n\nprovides an insightful interpretation of the rejection ratios: (a) the voltages $v_{i c}, v_{d d}$, and $v_{s s}$, when reflected to the input, are divided by their respective rejection ratios; (b) since these reflected voltages are in series with $v_{i d}$, they act as separate input offset-voltage components. Clearly, higher rejection ratios result in smaller corresponding input offset terms."
},
{
    "text": "The amplifier's output should remain unaffected by variations in its power-supply voltages, such as ripple and noise induced by nearby circuitry. However, a real amplifier will exhibit some sensitivity to these variations (in addition to the well-known common-mode input voltage), leading to a more generalized small-signal output expression for an op amp with split supplies:\n\n$$\n\\begin{equation*}\nv_{o}=a_{d m} v_{i d}+a_{c m} v_{i c}+a_{d d} v_{d d}+a_{s s} v_{s s} \\tag{5.33}\n\\end{equation*}\n$$\n\nHere, $v_{d d}$ and $v_{s s}$ represent the variations in the supply voltages $V_{D D}$ and $V_{S S}$, respectively, while $a_{d d}$ and $a_{s s}$ are the gains by which the amplifier amplifies these variations, specifically $a_{d d}=v_{o} / v_{d d}$ and $a_{s s}=v_{o} / v_{s s}$. Ideally, both $a_{d d}$ and $a_{s s}$ should be zero (just as $a_{c m}$ should be). To gauge a real amplifier's insensitivity to power-supply variations, we use a metric called the power-supply rejection ratio (PSRR), which, for split supplies, is expressed as:\n\n$$\n\\begin{equation*}\n\\mathrm{CMRR}_{d d}=\\left|\\frac{a_{d m}}{a_{d d}}\\right| \\quad \\mathrm{CMRR}_{s s}=\\left|\\frac{a_{d m}}{a_{s s}}\\right| \\tag{5.34}\n\\end{equation*}\n$$\n\nIn these expressions, $a_{d m}$ is the familiar differential-mode gain. To estimate the PSRRs of a two-stage CMOS op amp, refer to its AC equivalents shown in Fig. 5.15, leading to the following observations:\n\n- Applying $v_{d d}$ to the emitters of the $M_{1}-M_{2}$ pair via $r_{o 7}$ mimics lifting their bases off ground and driving them with a common voltage of $-v_{d d}$ while keeping the upper terminal of $r_{o 7}$ at AC ground. This allows us to adapt the common-mode gain from Eq. (4.157c) to the current circuit. Ignoring the body effect for simplicity, we get:\n\n$$\nv_{d s 4}=a_{c m(\\mathrm{MOS})}\\left(-v_{d d}\\right) \\cong \\frac{v_{d d}}{2 g_{m 4} r_{o 7}}\n$$\n\nApplying KCL at node $v_{o}$ yields:\n\n$$\n\\frac{v_{d d}-v_{o}}{r_{o 6}}=g_{m 5} \\frac{v_{d d}}{2 g_{m 4} r_{o 7}}+\\frac{v_{o}}{r_{o 5}}\n$$\n\nimage_name:(a)\ndescription:\n[\nname: M1, type: PMOS, ports: {S: s1s2, D: x1, G: GND}\nname: M2, type: PMOS, ports: {S: s1s2, D: d2d4g5, G: GND}\nname: M3, type: NMOS, ports: {S: GND, D: x1, G: x1}\nname: M4, type: NMOS, ports: {S: GND, D: d2d4g5, G: x1}\nname: M5, type: NMOS, ports: {S: GND, D: vo, G: d2d4g5}\nname: ro7, type: Resistor, value: ro7, ports: {N1: Vdd, N2: s1s2}\nname: ro6, type: Resistor, value: ro6, ports: {N1: vo, N2: VDD}\nname: vdd, type: VoltageSource, value: vdd, ports: {Np: Vdd, Nn: GND}\n]\nextrainfo:The circuit is an AC equivalent model for estimating supply rejection ratios. It includes PMOS and NMOS transistors, resistors, and a voltage source. The PMOS transistors M1 and M2 are connected to the supply voltage Vdd, and M3, M4, and M5 are NMOS transistors forming a differential pair and current mirror. The resistors ro7 and ro6 are used for biasing and load, respectively.\nimage_name:(b)\ndescription:\n[\nname: M1, type: PMOS, ports: {S: s1s2, D: x1, G: GND}\nname: M2, type: PMOS, ports: {S: s1s2, D: vo, G: GND}\nname: M3, type: NMOS, ports: {S: vss, D: x1, G: x1}\nname: M4, type: NMOS, ports: {S: x1, D: d2d4g3, G: d2d4g3}\nname: M5, type: NMOS, ports: {S: vss, D: vo, G: d2d4g3}\nname: r_o7, type: Resistor, value: r_o7, ports: {N1: s1s2, N2: 0}\nname: r_o6, type: Resistor, value: r_o6, ports: {N1: vo, N2: GND}\nname: v_ss, type: VoltageSource, value: v_ss, ports: {Np: vss, Nn: GND}\n]\nextrainfo:This circuit is an AC equivalent model for estimating the supply rejection ratios to VDD and VSS. It includes PMOS and NMOS transistors arranged to analyze the effect of supply variations on the output voltage.\n\nFIGURE 5.15 Ac equivalents for the estimation of the supply rejection ratios to (a) $V_{D D}$ and (b) $V_{S S}$.\n\nGiven that $V_{O V 5}=V_{O V 4}$ and $V_{O V 6}=V_{O V 7}$, it follows that $r_{o 6} / r_{o 7}=2 g_{m 4} / g_{m 5}$, leading to $v_{o}\\left(1 / r_{o 6}+1 / r_{o 5}\\right)=v_{d d}\\left(1 / r_{o 6}-1 / r_{o 6}\\right)=0$. This is feasible only if $v_{o}=0$, hence:\n\n$$\n\\begin{equation*}\na_{d d}=\\frac{v_{o}}{v_{d d}}=\\frac{0}{v_{d d}}=0 \\mathrm{~V} / \\mathrm{V} \\tag{5.35a}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{equation*}\n\\operatorname{PSRR}_{d d}=\\infty \\tag{5.35b}\n\\end{equation*}\n$$\n\nInterestingly, the contributions of $v_{d d}$ to $v_{o}$ via $r_{o 6}$ and $r_{o 7}$ cancel each other out. However, due to various approximations, $\\operatorname{PSRR}_{d d}$ will not be infinite in practice, though it should be relatively high.\n\n- For Fig. 5.15b, we observe that the input stage's balance is undisturbed by $v_{s s}$, resulting in $v_{d s 4}=v_{d s 3}=0$. With $M_{5}$'s internal dependent source inactive, we use the voltage divider rule to write:\n\n$$\n\\begin{equation*}\na_{s s}=\\frac{v_{o}}{v_{s s}}=\\frac{r_{o 6}}{r_{o 5}+r_{o 6}} \\tag{5.36a}\n\\end{equation*}\n$$\n\nSubstituting into Eq. (5.34), along with $a_{d m}$ from Eq. (5.25a), we obtain:\n\n$$\n\\begin{equation*}\n\\operatorname{PSRR}_{s s}=g_{m 1}\\left(r_{o 2} / / r_{o 4}\\right) g_{m 5} r_{o 5} \\tag{5.36b}\n\\end{equation*}\n$$\n\nEXAMPLE 5.3 Estimate the CMRR and PSRRs of the CMOS op amp from Example 5.2 (ignore the body effect for $M_{1}$ and $M_{2}$). Compare with PSpice results and comment.\n\n#### Solution\n\nUsing $g_{m 1}=g_{m 3}=\\left(2 \\times 50 \\times 10^{-6} / 0.25\\right) \\times 1.125=0.45 \\mathrm{~mA} / \\mathrm{V}$ and $g_{m 5}=(2 \\times 100 \\times 10^{-6} / 0.25) \\times 1.25=1 \\mathrm{~mA} / \\mathrm{V}$, we find, via Eqs. (5.32), (5.35b), and (5.36):\n\n$$\n\\operatorname{CMRR}=\\frac{1+0.45 \\times 200}{1+200 / 400}[1+2(0.45+0) 200]=10,981=80.8 \\mathrm{~dB}\n$$\n\n$$\n\\operatorname{PSRR}_{d d}=\\infty \\quad \\operatorname{PSRR}_{s s}=0.45(400 / / 200) \\times 1 \\times 100=6,000=75.6 \\mathrm{~dB}\n$$\n\nTo determine the CMRR via PSpice, use the circuit from Fig. 5.14 with the inputs tied together and driven by a common AC source $v_{i c}$. The small-signal analysis (.TF) gives $a_{c m}=v_{o} / v_{i c}=0.4214 \\mathrm{~V} / \\mathrm{V}$, resulting in CMRR $=a_{d m} / a_{c m}=4271 / 0.4214=10,135=80.1 \\mathrm{~dB}$, which aligns well with the calculated value.\n\nFor $\\operatorname{PSRR}_{d d}$, ground the inputs and insert an AC source $v_{d d}$ in series with the $V_{D D}$ source (or use an AC source with a DC component of 2.5 V for $V_{D D}$). The small-signal analysis (.TF) yields $a_{d d}=v_{o} / v_{d d}=-0.04158 \\mathrm{~V}$. Though not zero as predicted, $a_{d d}$ is small, giving $\\operatorname{PSRR}_{d d}=\\left|a_{d m} / a_{d d}\\right|=4271 / 0.04158=102,718=100 \\mathrm{~dB}$, which is still quite high. Similarly, using an AC source $v_{s s}$ in series with $V_{S S}$ results in $a_{s s}=v_{o} / v_{s s}=0.6202 \\mathrm{~V} / \\mathrm{V}$, so $\\operatorname{PSRR}_{s s}=\\left|a_{d m} / a_{s s}\\right|=4271 / 0.6202=6,886=76.8 \\mathrm{~dB}$, in reasonable agreement with the calculated value.\n\nRewriting Eq. (5.33) as:\n\n$$\n\\begin{align*}\nv_{o} & =a_{d m}\\left(v_{i d}+\\frac{a_{c m}}{a_{d m}} v_{i c}+\\frac{a_{d d}}{a_{d m}} v_{d d}+\\frac{a_{s s}}{a_{d m}} v_{s s}\\right) \\\\\n& =a_{d m}\\left(v_{i d}+\\frac{v_{i c}}{\\operatorname{CMRR}}+\\frac{v_{d d}}{\\operatorname{PSRR}_{d d}}+\\frac{v_{s s}}{\\operatorname{PSRR}_{s s}}\\right) \\tag{5.37}\n\\end{align*}\n$$\n\nprovides an insightful interpretation of the rejection ratios: (a) the voltages $v_{i c}, v_{d d}$, and $v_{s s}$, when reflected to the input, are divided by their respective rejection ratios; (b) since these reflected voltages are in series with $v_{i d}$, they act as separate input offset-voltage components. Clearly, higher rejection ratios result in smaller corresponding input offset terms."
},
{
    "text": "The amplifier's output should remain unaffected by any fluctuations in its power-supply voltages, such as ripple and noise induced by nearby circuitry. However, in reality, amplifiers are somewhat sensitive to these variations (in addition to the well-known common-mode input voltage). Consequently, the small-signal output of an operational amplifier with split supplies can be expressed in a more general form:\n\n$$\n\\begin{equation*}\nv_{o}=a_{d m} v_{i d}+a_{c m} v_{i c}+a_{d d} v_{d d}+a_{s s} v_{s s} \\tag{5.33}\n\\end{equation*}\n$$\n\nHere, $v_{d d}$ and $v_{s s}$ represent the variations in the supply voltages $V_{D D}$ and $V_{S S}$, respectively, while $a_{d d}$ and $a_{s s}$ are the gains by which the amplifier amplifies these variations, specifically, $a_{d d}=v_{o} / v_{d d}$ and $a_{s s}=v_{o} / v_{s s}$. Ideally, both $a_{d d}$ and $a_{s s}$ should be zero (just as $a_{c m}$ should be). To gauge how insensitive a real amplifier is to power-supply variations, we use a metric called the power-supply rejection ratio (PSRR), which, for split supplies, is expressed as:\n\n$$\n\\begin{equation*}\n\\mathrm{CMRR}_{d d}=\\left|\\frac{a_{d m}}{a_{d d}}\\right| \\quad \\mathrm{CMRR}_{s s}=\\left|\\frac{a_{d m}}{a_{s s}}\\right| \\tag{5.34}\n\\end{equation*}\n$$\n\nIn these expressions, $a_{d m}$ is the familiar differential-mode gain. To estimate the PSRRs of a two-stage CMOS op amp, refer to its AC equivalents shown in Fig. 5.15, based on which we make the following observations:\n\n- Applying $v_{d d}$ to the emitters of the $M_{1}-M_{2}$ pair through $r_{o 7}$ has the same effect as lifting their bases off ground and driving them with a common voltage of $-v_{d d}$ while keeping the upper terminal of $r_{o 7}$ at AC ground. We can thus adapt the common-mode gain from Eq. (4.157c) to this circuit. Ignoring the body effect for simplicity, we get:\n\n$$\nv_{d s 4}=a_{c m(\\mathrm{MOS})}\\left(-v_{d d}\\right) \\cong \\frac{v_{d d}}{2 g_{m 4} r_{o 7}}\n$$\n\nApplying Kirchhoff's Current Law (KCL) at node $v_{o}$ yields:\n\n$$\n\\frac{v_{d d}-v_{o}}{r_{o 6}}=g_{m 5} \\frac{v_{d d}}{2 g_{m 4} r_{o 7}}+\\frac{v_{o}}{r_{o 5}}\n$$\n\n**Image Description (a):**\n- **Components:**\n  - M1: PMOS, Source: s1s2, Drain: x1, Gate: GND\n  - M2: PMOS, Source: s1s2, Drain: d2d4g5, Gate: GND\n  - M3: NMOS, Source: GND, Drain: x1, Gate: x1\n  - M4: NMOS, Source: GND, Drain: d2d4g5, Gate: x1\n  - M5: NMOS, Source: GND, Drain: vo, Gate: d2d4g5\n  - ro7: Resistor, Value: ro7, Nodes: Vdd, s1s2\n  - ro6: Resistor, Value: ro6, Nodes: vo, VDD\n  - vdd: Voltage Source, Value: vdd, Nodes: Vdd, GND\n- **Extra Info:** The circuit is an AC equivalent model for estimating supply rejection ratios, including PMOS and NMOS transistors, resistors, and a voltage source. PMOS transistors M1 and M2 are connected to the supply voltage Vdd, and M3, M4, and M5 are NMOS transistors forming a differential pair and current mirror. Resistors ro7 and ro6 are used for biasing and load, respectively.\n\n**Image Description (b):**\n- **Components:**\n  - M1: PMOS, Source: s1s2, Drain: x1, Gate: GND\n  - M2: PMOS, Source: s1s2, Drain: vo, Gate: GND\n  - M3: NMOS, Source: vss, Drain: x1, Gate: x1\n  - M4: NMOS, Source: x1, Drain: d2d4g3, Gate: d2d4g3\n  - M5: NMOS, Source: vss, Drain: vo, Gate: d2d4g3\n  - r_o7: Resistor, Value: r_o7, Nodes: s1s2, 0\n  - r_o6: Resistor, Value: r_o6, Nodes: vo, GND\n  - v_ss: Voltage Source, Value: v_ss, Nodes: vss, GND\n- **Extra Info:** This circuit is an AC equivalent model for estimating the supply rejection ratios to VDD and VSS. It includes PMOS and NMOS transistors arranged to analyze the effect of supply variations on the output voltage.\n\n**FIGURE 5.15** AC equivalents for the estimation of the supply rejection ratios to (a) $V_{D D}$ and (b) $V_{S S}$.\n\nGiven that $V_{O V 5}=V_{O V 4}$ and $V_{O V 6}=V_{O V 7}$, it follows that $r_{o 6} / r_{o 7}=2 g_{m 4} / g_{m 5}$, so the above expression simplifies to $v_{o}\\left(1 / r_{o 6}+1 / r_{o 5}\\right)=v_{d d}\\left(1 / r_{o 6}-1 / r_{o 6}\\right)=0$. This is only possible if $v_{o}=0$, thus:\n\n$$\n\\begin{equation*}\na_{d d}=\\frac{v_{o}}{v_{d d}}=\\frac{0}{v_{d d}}=0 \\mathrm{~V} / \\mathrm{V} \\tag{5.35a}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{equation*}\n\\operatorname{PSRR}_{d d}=\\infty \\tag{5.35b}\n\\end{equation*}\n$$\n\nInterestingly, the contributions of $v_{d d}$ to $v_{o}$ via $r_{o 6}$ and $r_{o 7}$ cancel each other out. However, due to various approximations, $\\operatorname{PSRR}_{d d}$ will not be infinite in practice, though it is expected to be quite high.\n\n- Moving to Fig. 5.15b, we observe that the balance condition of the input stage remains undisturbed by $v_{s s}$, so $v_{d s 4}=v_{d s 3}=0$. With $M_{5}$'s internal dependent source inactive, we use the voltage divider rule to write:\n\n$$\n\\begin{equation*}\na_{s s}=\\frac{v_{o}}{v_{s s}}=\\frac{r_{o 6}}{r_{o 5}+r_{o 6}} \\tag{5.36a}\n\\end{equation*}\n$$\n\nSubstituting into Eq. (5.34), along with $a_{d m}$ from Eq. (5.25a), we obtain:\n\n$$\n\\begin{equation*}\n\\operatorname{PSRR}_{s s}=g_{m 1}\\left(r_{o 2} / / r_{o 4}\\right) g_{m 5} r_{o 5} \\tag{5.36b}\n\\end{equation*}\n$$\n\n**EXAMPLE 5.3** Estimate the CMRR and PSRRs of the CMOS op amp from Example 5.2 (ignore the body effect for $M_{1}$ and $M_{2}$). Compare with PSpice results and comment.\n\n**Solution:**\n\nUsing $g_{m 1}=g_{m 3}=\\left(2 \\times 50 \\times 10^{-6} / 0.25\\right) \\times 1.125=0.45 \\mathrm{~mA} / \\mathrm{V}$ and $g_{m 5}=(2 \\times 100 \\times 10^{-6} / 0.25) \\times 1.25=1 \\mathrm{~mA} / \\mathrm{V}$, we find, via Eqs. (5.32), (5.35b), and (5.36):\n\n$$\n\\operatorname{CMRR}=\\frac{1+0.45 \\times 200}{1+200 / 400}[1+2(0.45+0) 200]=10,981=80.8 \\mathrm{~dB}\n$$\n\n$$\n\\operatorname{PSRR}_{d d}=\\infty \\quad \\operatorname{PSRR}_{s s}=0.45(400 / / 200) \\times 1 \\times 100=6,000=75.6 \\mathrm{~dB}\n$$\n\nTo find the CMRR using PSpice, use the circuit from Fig. 5.14 with the inputs tied together and driven by a common AC source $v_{i c}$. The small-signal analysis (.TF) gives $a_{c m}=v_{o} / v_{i c}=0.4214 \\mathrm{~V} / \\mathrm{V}$, so CMRR $=a_{d m} / a_{c m}=4271 / 0.4214=10,135=80.1 \\mathrm{~dB}$, which agrees well with the calculated value.\n\nTo determine $\\operatorname{PSRR}_{d d}$, ground the inputs and insert an AC source $v_{d d}$ in series with the $V_{D D}$ source (or implement $V_{D D}$ with an AC source having a DC component of 2.5 V). The small-signal analysis (.TF) yields $a_{d d}=v_{o} / v_{d d}=-0.04158 \\mathrm{~V}$. Though not zero as predicted, $a_{d d}$ is small, resulting in $\\operatorname{PSRR}_{d d}=\\left|a_{d m} / a_{d d}\\right|=4271 / 0.04158=102,718=100 \\mathrm{~dB}$, which is still quite high. Similarly, using an AC source $v_{s s}$ in series with $V_{S S}$ gives $a_{s s}=v_{o} / v_{s s}=0.6202 \\mathrm{~V} / \\mathrm{V}$, so $\\operatorname{PSRR}_{s s}=\\left|a_{d m} / a_{s s}\\right|=4271 / 0.6202=6,886=76.8 \\mathrm{~dB}$, in reasonable agreement with the calculated value.\n\nRewriting Eq. (5.33) as:\n\n$$\n\\begin{align*}\nv_{o} & =a_{d m}\\left(v_{i d}+\\frac{a_{c m}}{a_{d m}} v_{i c}+\\frac{a_{d d}}{a_{d m}} v_{d d}+\\frac{a_{s s}}{a_{d m}} v_{s s}\\right) \\\\\n& =a_{d m}\\left(v_{i d}+\\frac{v_{i c}}{\\operatorname{CMRR}}+\\frac{v_{d d}}{\\operatorname{PSRR}_{d d}}+\\frac{v_{s s}}{\\operatorname{PSRR}_{s s}}\\right) \\tag{5.37}\n\\end{align*}\n$$\n\nprovides an insightful interpretation of the rejection ratios: (a) the voltages $v_{i c}, v_{d d}$, and $v_{s s}$, when reflected to the input, are divided by their respective rejection ratios; (b) since these reflected voltages are in series with $v_{i d}$, they act as separate input offset-voltage components. Clearly, higher rejection ratios result in smaller corresponding input offset terms."
},
{
    "text": "The amplifier's output should remain stable despite fluctuations in its power-supply voltages, such as ripple and noise from nearby circuits. However, real amplifiers exhibit some sensitivity to these variations (in addition to the well-known common-mode input voltage), so the small-signal output of an op amp with split supplies can be expressed generally as\n\n$$\n\\begin{equation*}\nv_{o}=a_{d m} v_{i d}+a_{c m} v_{i c}+a_{d d} v_{d d}+a_{s s} v_{s s} \\tag{5.33}\n\\end{equation*}\n$$\n\nHere, $v_{d d}$ and $v_{s s}$ represent the variations in the supply voltages $V_{D D}$ and $V_{S S}$, respectively, while $a_{d d}$ and $a_{s s}$ are the gains by which the amplifier amplifies these variations, specifically, $a_{d d}=v_{o} / v_{d d}$ and $a_{s s}=v_{o} / v_{s s}$. Ideally, both $a_{d d}$ and $a_{s s}$ should be zero (just as $a_{c m}$ should be). To gauge how resilient a real amplifier is to power-supply fluctuations, we use a metric called the power-supply rejection ratio (PSRR), which, for split supplies, is expressed as\n\n$$\n\\begin{equation*}\n\\mathrm{CMRR}_{d d}=\\left|\\frac{a_{d m}}{a_{d d}}\\right| \\quad \\mathrm{CMRR}_{s s}=\\left|\\frac{a_{d m}}{a_{s s}}\\right| \\tag{5.34}\n\\end{equation*}\n$$\n\nwhere $a_{d m}$ is the familiar differential-mode gain. To estimate the PSRRs of a two-stage CMOS op amp, refer to its AC equivalents shown in Fig. 5.15, leading to the following observations:\n\n- Applying $v_{d d}$ to the emitters of the $M_{1}-M_{2}$ pair via $r_{o 7}$ has the same effect as lifting their bases off ground and driving them with a common voltage of $-v_{d d}$ while keeping the upper terminal of $r_{o 7}$ at AC ground. We can thus adapt the common-mode gain from Eq. (4.157c) to this circuit. Ignoring the body effect for simplicity, we get\n\n$$\nv_{d s 4}=a_{c m(\\mathrm{MOS})}\\left(-v_{d d}\\right) \\cong \\frac{v_{d d}}{2 g_{m 4} r_{o 7}}\n$$\n\nApplying KCL at node $v_{o}$ yields\n\n$$\n\\frac{v_{d d}-v_{o}}{r_{o 6}}=g_{m 5} \\frac{v_{d d}}{2 g_{m 4} r_{o 7}}+\\frac{v_{o}}{r_{o 5}}\n$$\n\nimage_name:(a)\ndescription:\n[\nname: M1, type: PMOS, ports: {S: s1s2, D: x1, G: GND}\nname: M2, type: PMOS, ports: {S: s1s2, D: d2d4g5, G: GND}\nname: M3, type: NMOS, ports: {S: GND, D: x1, G: x1}\nname: M4, type: NMOS, ports: {S: GND, D: d2d4g5, G: x1}\nname: M5, type: NMOS, ports: {S: GND, D: vo, G: d2d4g5}\nname: ro7, type: Resistor, value: ro7, ports: {N1: Vdd, N2: s1s2}\nname: ro6, type: Resistor, value: ro6, ports: {N1: vo, N2: VDD}\nname: vdd, type: VoltageSource, value: vdd, ports: {Np: Vdd, Nn: GND}\n]\nextrainfo:The circuit is an AC equivalent model for estimating supply rejection ratios. It includes PMOS and NMOS transistors, resistors, and a voltage source. The PMOS transistors M1 and M2 are connected to the supply voltage Vdd, and M3, M4, and M5 are NMOS transistors forming a differential pair and current mirror. The resistors ro7 and ro6 are used for biasing and load, respectively.\nimage_name:(b)\ndescription:\n[\nname: M1, type: PMOS, ports: {S: s1s2, D: x1, G: GND}\nname: M2, type: PMOS, ports: {S: s1s2, D: vo, G: GND}\nname: M3, type: NMOS, ports: {S: vss, D: x1, G: x1}\nname: M4, type: NMOS, ports: {S: x1, D: d2d4g3, G: d2d4g3}\nname: M5, type: NMOS, ports: {S: vss, D: vo, G: d2d4g3}\nname: r_o7, type: Resistor, value: r_o7, ports: {N1: s1s2, N2: 0}\nname: r_o6, type: Resistor, value: r_o6, ports: {N1: vo, N2: GND}\nname: v_ss, type: VoltageSource, value: v_ss, ports: {Np: vss, Nn: GND}\n]\nextrainfo:This circuit is an AC equivalent model for estimating the supply rejection ratios to VDD and VSS. It includes PMOS and NMOS transistors arranged to analyze the effect of supply variations on the output voltage.\n\nFIGURE 5.15 AC equivalents for the estimation of the supply rejection ratios to (a) $V_{D D}$ and (b) $V_{S S}$.\n\nGiven that $V_{O V 5}=V_{O V 4}$ and $V_{O V 6}=V_{O V 7}$, it follows that $r_{o 6} / r_{o 7}=2 g_{m 4} / g_{m 5}$, leading to $v_{o}\\left(1 / r_{o 6}+1 / r_{o 5}\\right)=v_{d d}\\left(1 / r_{o 6}-1 / r_{o 6}\\right)=0$. This is feasible only if $v_{o}=0$, thus\n\n$$\n\\begin{equation*}\na_{d d}=\\frac{v_{o}}{v_{d d}}=\\frac{0}{v_{d d}}=0 \\mathrm{~V} / \\mathrm{V} \\tag{5.35a}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{equation*}\n\\operatorname{PSRR}_{d d}=\\infty \\tag{5.35b}\n\\end{equation*}\n$$\n\nInterestingly, the contributions of $v_{d d}$ to $v_{o}$ via $r_{o 6}$ and $r_{o 7}$ cancel each other out. However, due to various approximations, $\\operatorname{PSRR}_{d d}$ will not be infinite in practice, though it should be reasonably high.\n\n- Examining Fig. 5.15b, we note that the input stage's balance is unaffected by $v_{s s}$, resulting in $v_{d s 4}=v_{d s 3}=0$. With $M_{5}$'s internal dependent source inactive, we use the voltage divider rule to write\n\n$$\n\\begin{equation*}\na_{s s}=\\frac{v_{o}}{v_{s s}}=\\frac{r_{o 6}}{r_{o 5}+r_{o 6}} \\tag{5.36a}\n\\end{equation*}\n$$\n\nSubstituting into Eq. (5.34), along with $a_{d m}$ from Eq. (5.25a), we obtain\n\n$$\n\\begin{equation*}\n\\operatorname{PSRR}_{s s}=g_{m 1}\\left(r_{o 2} / / r_{o 4}\\right) g_{m 5} r_{o 5} \\tag{5.36b}\n\\end{equation*}\n$$\n\nEXAMPLE 5.3 Estimate the CMRR and PSRRs of the CMOS op amp from Example 5.2 (ignore the body effect for $M_{1}$ and $M_{2}$). Compare with PSpice results and comment.\n\n#### Solution\n\nUsing $g_{m 1}=g_{m 3}=\\left(2 \\times 50 \\times 10^{-6} / 0.25\\right) \\times 1.125=0.45 \\mathrm{~mA} / \\mathrm{V}$ and $g_{m 5}=(2 \\times$ $\\left.100 \\times 10^{-6} / 0.25\\right) \\times 1.25=1 \\mathrm{~mA} / \\mathrm{V}$, we find, via Eqs. (5.32), (5.35b), and (5.36),\n\n$$\n\\operatorname{CMRR}=\\frac{1+0.45 \\times 200}{1+200 / 400}[1+2(0.45+0) 200]=10,981=80.8 \\mathrm{~dB}\n$$\n\n$$\n\\operatorname{PSRR}_{d d}=\\infty \\quad \\operatorname{PSRR}_{s s}=0.45(400 / / 200) \\times 1 \\times 100=6,000=75.6 \\mathrm{~dB}\n$$\n\nTo determine the CMRR via PSpice, use the circuit in Fig. 5.14 with the inputs tied together and driven by a common AC source $v_{i c}$. The small-signal analysis (.TF) gives $a_{c m}=v_{o} / v_{i c}=0.4214 \\mathrm{~V} / \\mathrm{V}$, so CMRR $=a_{d m} / a_{c m}=4271 / 0.4214=$ $10,135=80.1 \\mathrm{~dB}$, closely matching the calculated value.\n\nTo find $\\operatorname{PSRR}_{d d}$, ground the inputs and insert an AC source $v_{d d}$ in series with the $V_{D D}$ source (or implement $V_{D D}$ with an AC source having a DC component of 2.5 V). The small-signal analysis (.TF) yields $a_{d d}=v_{o} / v_{d d}=-0.04158 \\mathrm{~V}$. While not zero as predicted, $a_{d d}$ is small, resulting in $\\operatorname{PSRR}_{d d}=\\left|a_{d m} / a_{d d}\\right|=4271 / 0.04158=102,718=100 \\mathrm{~dB}$, which is still quite high. Similarly, using an AC source $v_{s s}$ in series with $V_{S S}$ gives $a_{s s}=$ $v_{o} / v_{s s}=0.6202 \\mathrm{~V} / \\mathrm{V}$, so $\\operatorname{PSRR}_{s s}=\\left|a_{d m} / a_{s s}\\right|=4271 / 0.6202=6,886=76.8 \\mathrm{~dB}$, aligning well with the calculated value.\n\nRewriting Eq. (5.33) as\n\n$$\n\\begin{align*}\nv_{o} & =a_{d m}\\left(v_{i d}+\\frac{a_{c m}}{a_{d m}} v_{i c}+\\frac{a_{d d}}{a_{d m}} v_{d d}+\\frac{a_{s s}}{a_{d m}} v_{s s}\\right) \\\\\n& =a_{d m}\\left(v_{i d}+\\frac{v_{i c}}{\\operatorname{CMRR}}+\\frac{v_{d d}}{\\operatorname{PSRR}_{d d}}+\\frac{v_{s s}}{\\operatorname{PSRR}_{s s}}\\right) \\tag{5.37}\n\\end{align*}\n$$\n\nprovides insight into the rejection ratios: (a) the voltages $v_{i c}, v_{d d}$, and $v_{s s}$, when reflected to the input, are divided by their respective rejection ratios; (b) since these reflected voltages are in series with $v_{i d}$, they act as separate input offset-voltage components. Clearly, higher rejection ratios result in smaller corresponding input offset terms."
},
{
    "text": "The amplifier's output should remain unaffected by any fluctuations in its power-supply voltages, such as ripple and noise induced by nearby circuitry. However, in reality, amplifiers are somewhat sensitive to these variations (in addition to the well-known common-mode input voltage). Therefore, the small-signal output of an op amp with split supplies can be expressed in a more general form:\n\n$$\n\\begin{equation*}\nv_{o}=a_{d m} v_{i d}+a_{c m} v_{i c}+a_{d d} v_{d d}+a_{s s} v_{s s} \\tag{5.33}\n\\end{equation*}\n$$\n\nHere, $v_{d d}$ and $v_{s s}$ represent the variations in the supply voltages $V_{D D}$ and $V_{S S}$, respectively, while $a_{d d}$ and $a_{s s}$ are the gains by which the amplifier amplifies these variations, specifically $a_{d d}=v_{o} / v_{d d}$ and $a_{s s}=v_{o} / v_{s s}$. Ideally, both $a_{d d}$ and $a_{s s}$ should be zero (just as $a_{c m}$ should be). To assess how insensitive a real amplifier is to power-supply variations, we use a metric called the power-supply rejection ratio (PSRR), which, for split supplies, is expressed as:\n\n$$\n\\begin{equation*}\n\\mathrm{CMRR}_{d d}=\\left|\\frac{a_{d m}}{a_{d d}}\\right| \\quad \\mathrm{CMRR}_{s s}=\\left|\\frac{a_{d m}}{a_{s s}}\\right| \\tag{5.34}\n\\end{equation*}\n$$\n\nIn these equations, $a_{d m}$ is the familiar differential-mode gain. To estimate the PSRRs of the two-stage CMOS op amp, refer to its AC equivalents shown in Fig. 5.15, leading to the following observations:\n\n- Applying $v_{d d}$ to the emitters of the $M_{1}-M_{2}$ pair via $r_{o 7}$ has the same effect as lifting their bases off ground and driving them with a common voltage of $-v_{d d}$ while keeping the upper terminal of $r_{o 7}$ at AC ground. We can thus adapt the common-mode gain from Eq. (4.157c) to this circuit. Ignoring the body effect for simplicity, we get:\n\n$$\nv_{d s 4}=a_{c m(\\mathrm{MOS})}\\left(-v_{d d}\\right) \\cong \\frac{v_{d d}}{2 g_{m 4} r_{o 7}}\n$$\n\nApplying KCL at node $v_{o}$ yields:\n\n$$\n\\frac{v_{d d}-v_{o}}{r_{o 6}}=g_{m 5} \\frac{v_{d d}}{2 g_{m 4} r_{o 7}}+\\frac{v_{o}}{r_{o 5}}\n$$\n\nimage_name:(a)\ndescription:\n[\nname: M1, type: PMOS, ports: {S: s1s2, D: x1, G: GND}\nname: M2, type: PMOS, ports: {S: s1s2, D: d2d4g5, G: GND}\nname: M3, type: NMOS, ports: {S: GND, D: x1, G: x1}\nname: M4, type: NMOS, ports: {S: GND, D: d2d4g5, G: x1}\nname: M5, type: NMOS, ports: {S: GND, D: vo, G: d2d4g5}\nname: ro7, type: Resistor, value: ro7, ports: {N1: Vdd, N2: s1s2}\nname: ro6, type: Resistor, value: ro6, ports: {N1: vo, N2: VDD}\nname: vdd, type: VoltageSource, value: vdd, ports: {Np: Vdd, Nn: GND}\n]\nextrainfo:The circuit is an AC equivalent model for estimating supply rejection ratios. It includes PMOS and NMOS transistors, resistors, and a voltage source. The PMOS transistors M1 and M2 are connected to the supply voltage Vdd, and M3, M4, and M5 are NMOS transistors forming a differential pair and current mirror. The resistors ro7 and ro6 are used for biasing and load, respectively.\nimage_name:(b)\ndescription:\n[\nname: M1, type: PMOS, ports: {S: s1s2, D: x1, G: GND}\nname: M2, type: PMOS, ports: {S: s1s2, D: vo, G: GND}\nname: M3, type: NMOS, ports: {S: vss, D: x1, G: x1}\nname: M4, type: NMOS, ports: {S: x1, D: d2d4g3, G: d2d4g3}\nname: M5, type: NMOS, ports: {S: vss, D: vo, G: d2d4g3}\nname: r_o7, type: Resistor, value: r_o7, ports: {N1: s1s2, N2: 0}\nname: r_o6, type: Resistor, value: r_o6, ports: {N1: vo, N2: GND}\nname: v_ss, type: VoltageSource, value: v_ss, ports: {Np: vss, Nn: GND}\n]\nextrainfo:This circuit is an AC equivalent model for estimating the supply rejection ratios to VDD and VSS. It includes PMOS and NMOS transistors arranged to analyze the effect of supply variations on the output voltage.\n\nFIGURE 5.15 Ac equivalents for the estimation of the supply rejection ratios to (a) $V_{D D}$ and (b) $V_{S S}$.\n\nGiven that $V_{O V 5}=V_{O V 4}$ and $V_{O V 6}=V_{O V 7}$, it follows that $r_{o 6} / r_{o 7}=2 g_{m 4} / g_{m 5}$, leading to $v_{o}\\left(1 / r_{o 6}+1 / r_{o 5}\\right)=v_{d d}\\left(1 / r_{o 6}-1 / r_{o 6}\\right)=0$. This is only possible if $v_{o}=0$, thus:\n\n$$\n\\begin{equation*}\na_{d d}=\\frac{v_{o}}{v_{d d}}=\\frac{0}{v_{d d}}=0 \\mathrm{~V} / \\mathrm{V} \\tag{5.35a}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{equation*}\n\\operatorname{PSRR}_{d d}=\\infty \\tag{5.35b}\n\\end{equation*}\n$$\n\nInterestingly, the contributions of $v_{d d}$ to $v_{o}$ via $r_{o 6}$ and $r_{o 7}$ cancel each other out. However, due to various approximations, $\\operatorname{PSRR}_{d d}$ will not be infinite in practice, though it is expected to be quite high.\n\n- For Fig. 5.15b, we observe that the input stage's balance is unaffected by $v_{s s}$, resulting in $v_{d s 4}=v_{d s 3}=0$. With $M_{5}$'s internal dependent source inactive, we use the voltage divider rule to write:\n\n$$\n\\begin{equation*}\na_{s s}=\\frac{v_{o}}{v_{s s}}=\\frac{r_{o 6}}{r_{o 5}+r_{o 6}} \\tag{5.36a}\n\\end{equation*}\n$$\n\nSubstituting into Eq. (5.34), along with $a_{d m}$ from Eq. (5.25a), we get:\n\n$$\n\\begin{equation*}\n\\operatorname{PSRR}_{s s}=g_{m 1}\\left(r_{o 2} / / r_{o 4}\\right) g_{m 5} r_{o 5} \\tag{5.36b}\n\\end{equation*}\n$$\n\nEXAMPLE 5.3 Estimate the CMRR and PSRRs of the CMOS op amp from Example 5.2 (ignore the body effect for $M_{1}$ and $M_{2}$). Compare with PSpice results and comment.\n\n#### Solution\n\nUsing $g_{m 1}=g_{m 3}=\\left(2 \\times 50 \\times 10^{-6} / 0.25\\right) \\times 1.125=0.45 \\mathrm{~mA} / \\mathrm{V}$ and $g_{m 5}=(2 \\times 100 \\times 10^{-6} / 0.25) \\times 1.25=1 \\mathrm{~mA} / \\mathrm{V}$, we find, via Eqs. (5.32), (5.35b), and (5.36):\n\n$$\n\\operatorname{CMRR}=\\frac{1+0.45 \\times 200}{1+200 / 400}[1+2(0.45+0) 200]=10,981=80.8 \\mathrm{~dB}\n$$\n\n$$\n\\operatorname{PSRR}_{d d}=\\infty \\quad \\operatorname{PSRR}_{s s}=0.45(400 / / 200) \\times 1 \\times 100=6,000=75.6 \\mathrm{~dB}\n$$\n\nTo determine the CMRR using PSpice, use the circuit from Fig. 5.14 with the inputs tied together and driven by a common AC source $v_{i c}$. The small-signal analysis (.TF) gives $a_{c m}=v_{o} / v_{i c}=0.4214 \\mathrm{~V} / \\mathrm{V}$, so CMRR $=a_{d m} / a_{c m}=4271 / 0.4214=10,135=80.1 \\mathrm{~dB}$, closely matching the calculated value.\n\nFor $\\operatorname{PSRR}_{d d}$, ground the inputs and insert an AC source $v_{d d}$ in series with the $V_{D D}$ source (or use an AC source with a DC component of 2.5 V for $V_{D D}$). The small-signal analysis (.TF) yields $a_{d d}=v_{o} / v_{d d}=-0.04158 \\mathrm{~V} / \\mathrm{V}$. While not zero as predicted, $a_{d d}$ is small, resulting in $\\operatorname{PSRR}_{d d}=\\left|a_{d m} / a_{d d}\\right|=4271 / 0.04158=102,718=100 \\mathrm{~dB}$, which is still quite high. Similarly, using an AC source $v_{s s}$ in series with $V_{S S}$ gives $a_{s s}=v_{o} / v_{s s}=0.6202 \\mathrm{~V} / \\mathrm{V}$, so $\\operatorname{PSRR}_{s s}=\\left|a_{d m} / a_{s s}\\right|=4271 / 0.6202=6,886=76.8 \\mathrm{~dB}$, in reasonable agreement with the calculated value.\n\nRewriting Eq. (5.33) as:\n\n$$\n\\begin{align*}\nv_{o} & =a_{d m}\\left(v_{i d}+\\frac{a_{c m}}{a_{d m}} v_{i c}+\\frac{a_{d d}}{a_{d m}} v_{d d}+\\frac{a_{s s}}{a_{d m}} v_{s s}\\right) \\\\\n& =a_{d m}\\left(v_{i d}+\\frac{v_{i c}}{\\operatorname{CMRR}}+\\frac{v_{d d}}{\\operatorname{PSRR}_{d d}}+\\frac{v_{s s}}{\\operatorname{PSRR}_{s s}}\\right) \\tag{5.37}\n\\end{align*}\n$$\n\nprovides an insightful interpretation of the rejection ratios: (a) the voltages $v_{i c}, v_{d d}$, and $v_{s s}$, when reflected to the input, are divided by their respective rejection ratios; (b) since these reflected voltages are in series with $v_{i d}$, they act as separate input offset voltage components. Clearly, higher rejection ratios result in smaller corresponding input offset terms."
},
{
    "text": "The recently examined two-stage op amp achieves voltage gain expressed as $a=\\left(G_{m 1} R_{o 1}\\right) \\times \\left(G_{m 2} R_{o 2}\\right)$, which is the product of its individual stage gains. Rearranging to $a=G_{m 1}\\left(R_{o 1} G_{m 2} R_{o 2}\\right)$ suggests an alternative approach: a single stage ($G_{m 1}$) with a significantly higher output resistance ($R_{o}=R_{o 1} G_{m 2} R_{o 2}$). We initiate with an active-loaded differential pair to realize $G_{m 1}$, then cascode both the pair and the load to elevate the output resistance. To circumvent the well-known voltage-swing constraints of straightforward cascodes, we employ the folded-cascode technique introduced in Section 4.9. This leads to the widely-used CMOS op amp configuration shown in Fig. 5.16, in\nimage_name:(a)\ndescription:The circuit is a folded-cascode CMOS op amp featuring a p-channel differential pair M1-M2 cascoded by n-channel M3-M4. This architecture enhances output resistance and mitigates voltage-swing limitations. The differential pair is biased by the current source ISS, while IBIAS provides additional biasing. The capacitor CC is included for compensation purposes.\n\n(a)\nimage_name:(b)\ndescription:\n[\nname: Gm(vp-vn), type: VoltageControlledCurrentSource, ports: {Np: VO, Nn: GND}\nname: Ro, type: Resistor, value: Ro, ports: {N1: VO, N2: GND}\n]\nextrainfo:The circuit diagram (b) illustrates the Norton equivalent of a folded-cascode CMOS op amp. It comprises a voltage-controlled current source Gm(vp-vn) and a resistor Ro connected in parallel between the output node VO and ground (GND). The input nodes are designated vp and vn, with the output node labeled vo.\n\n(b)\n\nFIGURE 5.16 (a) Simplified schematic of the folded-cascode CMOS op amp and (b) its Norton equivalent.\nassociation with which we observe the following:\n\n- The core of the circuit is the $p$-channel differential pair $M_{1}-M_{2}$, which is further cascoded by the $n$-channel CG pair $M_{3}-M_{4}$. In the folded arrangement, the CG pair necessitates separate biasing, a role fulfilled here by the two $I_{B A S}$ current sinks.\n- The active load consists of the cascode current mirror formed by the $M_{5}-M_{6}$ and $M_{7}-M_{8}$ pairs. (The capacitor $C_{c}$ serves to stabilize the amplifier against potential oscillations in negative-feedback operation, a topic detailed in Chapter 7.)\n- The dc biasing circuitry includes the sources $I_{S S}, I_{B A S}$, and $V_{B A A S}$. If the $M_{1}-M_{2}$ pair is over-driven, one of its FETs would turn off. To prevent the corresponding half of the load from also turning off and subsequently requiring a delay to reactivate when the overdrive condition is removed, it is standard practice to set $I_{B A S}>I_{S S}$, such as $I_{B A S} \\approx 1.25 I_{S S}$. Fig. 5.17 presents a potential implementation of the dc biasing circuitry: $M_{9}$ and $M_{10}$ sink the $I_{B A S}$ currents, $M_{11}$ sources the $I_{S S}$ current, and $M_{12}$ through $M_{16}$ provide the necessary voltages to bias $M_{11}$ as well as the $M_{3}-M_{4}$ and $M_{9}-M_{10}$ pairs.\n\nOur objective now is to determine the element values $G_{m}$ and $R_{o}$ of the Norton equivalent depicted in Fig. 5.16b. To ascertain $G_{m}$, we need to determine $i_{o(\\mathrm{sc})}$, a task we will execute using the half-circuit concept of Fig. 5.18. The differential pair responds to an input imbalance $v_{i d}=v_{p}-v_{n}$ with the drain currents\n\n$$\ni_{1}=g_{m 1} \\frac{v_{i d}}{2} \\quad i_{2}=g_{m 2} \\frac{v_{i d}}{2}\n$$\n\nimage_name:FIGURE 5.17 Detailed circuit schematic of the folded-cascode CMOS op amp\ndescription:The circuit is a folded-cascode CMOS operational amplifier. It incorporates differential pairs, current mirrors, and cascode configurations for enhanced performance. The design utilizes NMOS and PMOS transistors, with current source biasing and differential input stages. The circuit is powered by VDD and VSS, with the output taken from vO.\n\nFIGURE 5.17 Detailed circuit schematic of the folded-cascode CMOS op amp.\nimage_name:FIGURE 5.18\ndescription:\n[\nname: M1, type: PMOS, ports: {S: s1s2, D: X1, G: Vid/2}\nname: M2, type: PMOS, ports: {S: s1s2, D: X2, G: -Vid/2}\nname: M3, type: NMOS, ports: {S: x1, D: X4, G: GND}\nname: M4, type: NMOS, ports: {S: X2, D: GND, G: GND}\nname: M5, type: PMOS, ports: {S: X3, D: X4, G: X4}\nname: M6, type: PMOS, ports: {S: GND, D: X4, G: X3}\nname: M7, type: PMOS, ports: {S: GND, D: X3, G: X3}\nname: M8, type: PMOS, ports: {S: GND, D: X3, G: X3}\nname: r09, type: Resistor, value: r09, ports: {N1: X1, N2: GND}\nname: r010, type: Resistor, value: r010, ports: {N1: X2, N2: GND}\nname: Vid, type: VoltageSource, value: Vid/2, ports: {Np: Vid/2, Nn: GND}\nname: Vid, type: VoltageSource, value: -Vid/2, ports: {Np: -Vid/2, Nn: GND}\n]\nextrainfo:The circuit is an AC model of a folded-cascode CMOS operational amplifier. It includes differential pairs, current mirrors, and cascode configurations for improved performance. The design features NMOS and PMOS transistors, with current source biasing and differential input stages. The circuit is powered by VDD and GND, with the output taken from the short-circuit current i_o(sc).\n\nFIGURE 5.18 Ac model to find the short-circuit output current $i_{o(\\mathrm{~s})}$.\n\nGiven that $g_{m 2}=g_{m 1}$, it follows that $i_{2}=i_{1}$. Once $i_{2}$ reaches $M_{4}$ 's source, it splits between the resistance seen looking into $M_{4}$ 's source and that seen looking into $M_{10}$ 's drain. The former is $R_{s 4}=\\left[1 /\\left(g_{m 4}+g_{m b 4}\\right)\\right] / / r_{o 4}$ and the latter is $R_{d 10}=r_{o 10}$. Since $R_{s 4} \\ll R_{d 10}$, nearly all of $i_{2}$ will flow into $M_{4}$ and subsequently to the output ac short, as illustrated. Similar considerations apply to the current division experienced by $i_{1}$ at $M_{3}$ 's source. Virtually all of $i_{1}$ will emerge from $M_{3}$ and be mirrored into the output ac short, as shown. By KCL, $i_{o(\\mathrm{sc})}=i_{1}+i_{2}=2\\left(g_{m 1} v_{i d} / 2\\right)=g_{m 1} v_{i d}$. Therefore,\n\n$$\n\\begin{equation*}\nG_{m}=\\frac{i_{o(\\mathrm{sc})}}{v_{p}-v_{n}}=g_{m 1} \\tag{5.38}\n\\end{equation*}\n$$\n\nTo determine the small-signal output resistance $R_{o}$, we set the input sources to zero, apply a test voltage $v$, find the current $i$ from the test source, and let $R_{o}=v / i$. The testing method is shown in Fig. 5.19, where we note that $i$ comprises three components:\n\n- The component $i_{6}=v / R_{d 6}$, where $R_{d 6}$ is the resistance seen looking into $M_{6}$ 's drain. Adapting Eq. (4.41) to this circuit, we get\n\n$$\ni_{6}=\\frac{v}{r_{o 6}+r_{o 8}+\\left(g_{m 6}+g_{m b 6}\\right) r_{o 6} r_{o 8}} \\approx \\frac{v}{\\left(g_{m 6}+g_{m b 6}\\right) r_{o 6} r_{o 8}}\n$$\n\nimage_name:FIGURE 5.19\ndescription:\n[\nname: M1, type: PMOS, ports: {S: S1S2, D: X3, G: GND}\nname: M2, type: PMOS, ports: {S: S1S2, D: X4, G: GND}\nname: M3, type: NMOS, ports: {S: X3, D: X2, G: GND}\nname: M4, type: NMOS, ports: {S: X4, D: V, G: GND}\nname: M5, type: PMOS, ports: {S: X1, D: X2, G: X2}\nname: M6, type: PMOS, ports: {S: d8s6, D: V, G: X2}\nname: M7, type: PMOS, ports: {S: GND, D: X1, G: X1}\nname: M8, type: PMOS, ports: {S: GND, D: d8s6, G: X1}\nname: ro9, type: Resistor, value: ro9, ports: {N1: X3, N2: GND}\nname: ro10, type: Resistor, value: ro10, ports: {N1: X4, N2: GND}\n]\nextrainfo:The circuit diagram is used to determine the output resistance R0 using a test voltage v. The current i is composed of three components: i6, i4, and i2. The circuit uses PMOS and NMOS transistors to achieve this measurement. The resistances ro9 and ro10 model the output resistances of the devices.\n\nFIGURE 5.19 Ac model to find the output resistance $R_{0}$.\n\n- The component $i_{4}=v / R_{d 4}$, where $R_{d 4}$ is the resistance seen looking into $M_{4}$ 's drain. Again adapting, we obtain\n\n$$\ni_{4}=\\frac{v}{r_{o 4}+\\left(2 r_{o 2} / / r_{o 10}\\right)+\\left(g_{m 4}+g_{m b 4}\\right) r_{o 4}\\left(2 r_{o 2} / / r_{o 10}\\right)} \\approx \\frac{v}{\\left(g_{m 4}+g_{m b 4}\\right) r_{o 4}\\left(2 r_{o 2} / / r_{o 10}\\right)}\n$$\n\nwhere $2 r_{o 2}$ is the resistance seen looking into $M_{2}$ 's drain.\n\n- Upon exiting $M_{4}, i_{4}$ divides between $2 r_{o 2}$ and $r_{o 10}$ to yield, by the current divider rule,\n\n$$\ni_{2}=\\frac{r_{o 10}}{2 r_{o 2}+r_{o 10}} i_{4}=\\frac{2 r_{o 2} / / r_{o 10}}{2 r_{o 2}} i_{4} \\approx \\frac{v}{\\left(g_{m 4}+g_{m b 4}\\right) 2 r_{o 2} r_{o 4}}\n$$\n\nThis current continues through $M_{1}$ to $M_{3}$ 's source, where it undergoes negligible current division to proceed through $M_{3}$ to the mirror, which then replicates it at the test source, as depicted.\n\nApplying KCL, we write\n\n$$\ni \\approx \\frac{v}{\\left(g_{m 6}+g_{m b 6}\\right) r_{o 6} r_{o 8}}+\\frac{v}{\\left(g_{m 4}+g_{m b 4}\\right) r_{o 4}\\left(2 r_{o 2} / / r_{o 10}\\right)}+\\frac{\\nu}{\\left(g_{m 4}+g_{m b 4}\\right) 2 r_{o 2} r_{o 4}}\n$$\n\nCombining the last two terms and simplifying, we write\n\n$$\ni \\approx \\frac{v}{\\left(g_{m 6}+g_{m b 6}\\right) r_{o 6} r_{o 8}}+\\frac{v}{\\left(g_{m 4}+g_{m b 4}\\right) r_{o 4}\\left(r_{o 2} / / r_{o 10}\\right)}=\\frac{v}{R_{o}}\n$$\n\nwhere\n\n$$\n\\begin{equation*}\nR_{o} \\approx\\left[\\left(g_{m 6}+g_{m b 6}\\right) r_{o 6} r_{o 8}\\right] / /\\left[\\left(g_{m 4}+g_{m b 4}\\right) r_{o 4}\\left(r_{o 2} / / r_{o 10}\\right)\\right] \\tag{5.39}\n\\end{equation*}\n$$\n\nFinally, the unloaded voltage gain is\n\n$$\n\\begin{equation*}\na=\\frac{v_{o}}{v_{p}-v_{n}}=g_{m 1} R_{o} \\tag{5.40}\n\\end{equation*}\n```"
},
{
    "text": "The recently examined two-stage op amp achieves voltage gain expressed as $a=\\left(G_{m 1} R_{o 1}\\right) \\times \\left(G_{m 2} R_{o 2}\\right)$, representing the product of its individual stage gains. By rearranging to $a=G_{m 1}\\left(R_{o 1} G_{m 2} R_{o 2}\\right)$, an alternative configuration emerges: a single stage ($G_{m 1}$) with a significantly higher output resistance ($R_{o}=R_{o 1} G_{m 2} R_{o 2}$). We initiate with an active-loaded differential pair to realize $G_{m 1}$, subsequently cascoding both the pair and the load to elevate the output resistance. To circumvent the notorious voltage-swing constraints of straightforward cascodes, we adopt the folded-cascode scheme introduced in Section 4.9. This leads to the widely-used CMOS op amp variant depicted in Fig. 5.16, in\nimage_name:(a)\ndescription:The circuit is a folded-cascode CMOS op amp featuring a p-channel differential pair M1-M2 cascoded by n-channel M3-M4. This architecture enhances output resistance and mitigates voltage-swing limitations. The differential pair is biased by the current source ISS, while IBIAS provides additional biasing. The capacitor CC is included for compensation purposes.\n\n(a)\nimage_name:(b)\ndescription:\n[\nname: Gm(vp-vn), type: VoltageControlledCurrentSource, ports: {Np: VO, Nn: GND}\nname: Ro, type: Resistor, value: Ro, ports: {N1: VO, N2: GND}\n]\nextrainfo:The circuit diagram (b) illustrates the Norton equivalent of a folded-cascode CMOS op amp. It comprises a voltage-controlled current source Gm(vp-vn) and a resistor Ro connected in parallel between the output node VO and ground (GND). The input nodes are designated vp and vn, with the output node labeled vo.\n\n(b)\n\nFIGURE 5.16 (a) Simplified schematic of the folded-cascode CMOS op amp and (b) its Norton equivalent.\nassociation with which we observe the following:\n\n- The core of the circuit is the $p$-channel differential pair $M_{1}-M_{2}$, which is cascoded by the $n$-channel CG pair $M_{3}-M_{4}$. In the folded configuration, the CG pair necessitates separate biasing, a role fulfilled by the two $I_{B A S}$ current sinks.\n- The active load consists of the cascode current mirror formed by the $M_{5}-M_{6}$ and $M_{7}-M_{8}$ pairs. (The capacitor $C_{c}$ serves to stabilize the amplifier against potential oscillations during negative-feedback operation, a topic detailed in Chapter 7.)\n- The dc biasing circuitry includes the sources $I_{S S}, I_{B A S}$, and $V_{B A A S}$. If the $M_{1}-M_{2}$ pair is over-driven, one of its FETs would turn off. To prevent the corresponding half of the load from also turning off and subsequently requiring a delay to reactivate when the overdrive condition ceases, it is standard practice to set $I_{B A S}>I_{S S}$, such as $I_{B A S} \\approx 1.25 I_{S S}$. Fig. 5.17 presents a feasible implementation of the dc biasing circuitry: $M_{9}$ and $M_{10}$ sink the $I_{B A S}$ currents, $M_{11}$ sources the $I_{S S}$ current, and $M_{12}$ through $M_{16}$ provide the necessary voltages to bias $M_{11}$ as well as the $M_{3}-M_{4}$ and $M_{9}-M_{10}$ pairs.\n\nOur objective now is to determine the element values $G_{m}$ and $R_{o}$ of the Norton equivalent shown in Fig. 5.16b. To find $G_{m}$, we need to determine $i_{o(\\mathrm{sc})}$, a task we will accomplish using the half-circuit concept of Fig. 5.18. The differential pair responds to an input imbalance $v_{i d}=v_{p}-v_{n}$ with the drain currents\n\n$$\ni_{1}=g_{m 1} \\frac{v_{i d}}{2} \\quad i_{2}=g_{m 2} \\frac{v_{i d}}{2}\n$$\n\nimage_name:FIGURE 5.17 Detailed circuit schematic of the folded-cascode CMOS op amp\ndescription:The circuit is a folded-cascode CMOS operational amplifier, incorporating differential pairs, current mirrors, and cascode configurations for enhanced performance. It utilizes NMOS and PMOS transistors, with current source biasing and differential input stages. The circuit is powered by VDD and VSS, with the output taken from vO.\n\nFIGURE 5.17 Detailed circuit schematic of the folded-cascode CMOS op amp.\nimage_name:FIGURE 5.18\ndescription:\n[\nname: M1, type: PMOS, ports: {S: s1s2, D: X1, G: Vid/2}\nname: M2, type: PMOS, ports: {S: s1s2, D: X2, G: -Vid/2}\nname: M3, type: NMOS, ports: {S: x1, D: X4, G: GND}\nname: M4, type: NMOS, ports: {S: X2, D: GND, G: GND}\nname: M5, type: PMOS, ports: {S: X3, D: X4, G: X4}\nname: M6, type: PMOS, ports: {S: GND, D: X4, G: X3}\nname: M7, type: PMOS, ports: {S: GND, D: X3, G: X3}\nname: M8, type: PMOS, ports: {S: GND, D: X3, G: X3}\nname: r09, type: Resistor, value: r09, ports: {N1: X1, N2: GND}\nname: r010, type: Resistor, value: r010, ports: {N1: X2, N2: GND}\nname: Vid, type: VoltageSource, value: Vid/2, ports: {Np: Vid/2, Nn: GND}\nname: Vid, type: VoltageSource, value: -Vid/2, ports: {Np: -Vid/2, Nn: GND}\n]\nextrainfo:The circuit is an AC model of a folded-cascode CMOS operational amplifier, featuring differential pairs, current mirrors, and cascode configurations for improved performance. It includes NMOS and PMOS transistors, with current source biasing and differential input stages. The circuit is powered by VDD and GND, with the output taken from the short-circuit current i_o(sc).\n\nFIGURE 5.18 Ac model to find the short-circuit output current $i_{o(\\mathrm{~s})}$.\n\nGiven that $g_{m 2}=g_{m 1}$, it follows that $i_{2}=i_{1}$. Once $i_{2}$ reaches $M_{4}$'s source, it divides between the resistance seen looking into $M_{4}$'s source and that seen looking into $M_{10}$'s drain. The former is $R_{s 4}=\\left[1 /\\left(g_{m 4}+g_{m b 4}\\right)\\right] / / r_{o 4}$ and the latter is $R_{d 10}=r_{o 10}$. Since $R_{s 4} \\ll R_{d 10}$, virtually all of $i_{2}$ will flow into $M_{4}$ and subsequently to the output ac short, as depicted. Similar considerations apply to the current division experienced by $i_{1}$ at $M_{3}$'s source. Virtually all of $i_{1}$ will emerge from $M_{3}$ and be mirrored into the output ac short, as shown. By KCL, $i_{o(\\mathrm{sc})}=i_{1}+i_{2}=2\\left(g_{m 1} v_{i d} / 2\\right)=g_{m 1} v_{i d}$. Consequently,\n\n$$\n\\begin{equation*}\nG_{m}=\\frac{i_{o(\\mathrm{sc})}}{v_{p}-v_{n}}=g_{m 1} \\tag{5.38}\n\\end{equation*}\n$$\n\nTo determine the small-signal output resistance $R_{o}$, we set the input sources to zero, apply a test voltage $v$, find the current $i$ from the test source, and let $R_{o}=v / i$. The testing method is illustrated in Fig. 5.19, where we note that $i$ comprises three components:\n\n- The component $i_{6}=v / R_{d 6}$, where $R_{d 6}$ is the resistance seen looking into $M_{6}$'s drain. Adapting Eq. (4.41) to this circuit, we get\n\n$$\ni_{6}=\\frac{v}{r_{o 6}+r_{o 8}+\\left(g_{m 6}+g_{m b 6}\\right) r_{o 6} r_{o 8}} \\approx \\frac{v}{\\left(g_{m 6}+g_{m b 6}\\right) r_{o 6} r_{o 8}}\n$$\n\nimage_name:FIGURE 5.19\ndescription:\n[\nname: M1, type: PMOS, ports: {S: S1S2, D: X3, G: GND}\nname: M2, type: PMOS, ports: {S: S1S2, D: X4, G: GND}\nname: M3, type: NMOS, ports: {S: X3, D: X2, G: GND}\nname: M4, type: NMOS, ports: {S: X4, D: V, G: GND}\nname: M5, type: PMOS, ports: {S: X1, D: X2, G: X2}\nname: M6, type: PMOS, ports: {S: d8s6, D: V, G: X2}\nname: M7, type: PMOS, ports: {S: GND, D: X1, G: X1}\nname: M8, type: PMOS, ports: {S: GND, D: d8s6, G: X1}\nname: ro9, type: Resistor, value: ro9, ports: {N1: X3, N2: GND}\nname: ro10, type: Resistor, value: ro10, ports: {N1: X4, N2: GND}\n]\nextrainfo:The circuit diagram is used to determine the output resistance R0 using a test voltage v. The current i is composed of three components: i6, i4, and i2. The circuit employs PMOS and NMOS transistors for this measurement. Resistors ro9 and ro10 model the output resistances of the devices.\n\nFIGURE 5.19 Ac model to find the output resistance $R_{0}$.\n\n- The component $i_{4}=v / R_{d 4}$, where $R_{d 4}$ is the resistance seen looking into $M_{4}$'s drain. Again adapting, we obtain\n\n$$\ni_{4}=\\frac{v}{r_{o 4}+\\left(2 r_{o 2} / / r_{o 10}\\right)+\\left(g_{m 4}+g_{m b 4}\\right) r_{o 4}\\left(2 r_{o 2} / / r_{o 10}\\right)} \\approx \\frac{v}{\\left(g_{m 4}+g_{m b 4}\\right) r_{o 4}\\left(2 r_{o 2} / / r_{o 10}\\right)}\n$$\n\nwhere $2 r_{o 2}$ is the resistance seen looking into $M_{2}$'s drain.\n\n- Upon exiting $M_{4}$, $i_{4}$ divides between $2 r_{o 2}$ and $r_{o 10}$ to yield, by the current divider rule,\n\n$$\ni_{2}=\\frac{r_{o 10}}{2 r_{o 2}+r_{o 10}} i_{4}=\\frac{2 r_{o 2} / / r_{o 10}}{2 r_{o 2}} i_{4} \\approx \\frac{v}{\\left(g_{m 4}+g_{m b 4}\\right) 2 r_{o 2} r_{o 4}}\n$$\n\nThis current continues through $M_{1}$ to $M_{3}$'s source, where it undergoes negligible current division to proceed through $M_{3}$ to the mirror, which then replicates it at the test source, as shown.\n\nApplying KCL, we write\n\n$$\ni \\approx \\frac{v}{\\left(g_{m 6}+g_{m b 6}\\right) r_{o 6} r_{o 8}}+\\frac{v}{\\left(g_{m 4}+g_{m b 4}\\right) r_{o 4}\\left(2 r_{o 2} / / r_{o 10}\\right)}+\\frac{\\nu}{\\left(g_{m 4}+g_{m b 4}\\right) 2 r_{o 2} r_{o 4}}\n$$\n\nCombining the last two terms and simplifying, we write\n\n$$\ni \\approx \\frac{v}{\\left(g_{m 6}+g_{m b 6}\\right) r_{o 6} r_{o 8}}+\\frac{v}{\\left(g_{m 4}+g_{m b 4}\\right) r_{o 4}\\left(r_{o 2} / / r_{o 10}\\right)}=\\frac{v}{R_{o}}\n$$\n\nwhere\n\n$$\n\\begin{equation*}\nR_{o} \\approx\\left[\\left(g_{m 6}+g_{m b 6}\\right) r_{o 6} r_{o 8}\\right] / /\\left[\\left(g_{m 4}+g_{m b 4}\\right) r_{o 4}\\left(r_{o 2} / / r_{o 10}\\right)\\right] \\tag{5.39}\n\\end{equation*}\n$$\n\nFinally, the unloaded voltage gain is\n\n$$\n\\begin{equation*}\na=\\frac{v_{o}}{v_{p}-v_{n}}=g_{m 1} R_{o} \\tag{5.40}\n\\end{equation*}\n$$"
},
{
    "text": "The recently examined two-stage op amp achieves voltage gain expressed as $a=\\left(G_{m 1} R_{o 1}\\right) \\times \\left(G_{m 2} R_{o 2}\\right)$, essentially the product of its individual stage gains. Rearranging to $a=G_{m 1}\\left(R_{o 1} G_{m 2} R_{o 2}\\right)$ hints at an alternative design: a single stage ( $G_{m 1}$ ) but with a significantly higher output resistance ( $R_{o}=R_{o 1} G_{m 2} R_{o 2}$ ). We initiate with an active-loaded differential pair to realize $G_{m 1}$, then cascode both the pair and the load to elevate the output resistance. To circumvent the well-known voltage-swing constraints of straightforward cascodes, we employ the folded-cascode technique introduced in Section 4.9. This leads to the widely-used CMOS op amp configuration shown in Fig. 5.16, in\nimage_name:(a)\ndescription:The circuit is a folded-cascode CMOS op amp featuring a p-channel differential pair M1-M2 cascoded by n-channel M3-M4. This architecture enhances output resistance and mitigates voltage-swing limitations. The differential pair is biased by the current source ISS, while IBIAS provides additional biasing. The capacitor CC is included for compensation.\n\n(a)\nimage_name:(b)\ndescription:\n[\nname: Gm(vp-vn), type: VoltageControlledCurrentSource, ports: {Np: VO, Nn: GND}\nname: Ro, type: Resistor, value: Ro, ports: {N1: VO, N2: GND}\n]\nextrainfo:The circuit diagram (b) illustrates the Norton equivalent of a folded-cascode CMOS op amp. It comprises a voltage-controlled current source Gm(vp-vn) and a resistor Ro connected in parallel between the output node VO and ground (GND). The input nodes are designated vp and vn, with the output node labeled vo.\n\n(b)\n\nFIGURE 5.16 (a) Simplified schematic of the folded-cascode CMOS op amp and (b) its Norton equivalent.\nconnection with which we observe the following:\n\n- The core of the circuit is the $p$-channel differential pair $M_{1}-M_{2}$, which is further cascoded by the $n$-channel CG pair $M_{3}-M_{4}$. In this folded setup, the CG pair necessitates separate biasing, a role fulfilled by the two $I_{B A S}$ current sinks.\n- The active load consists of a cascode current mirror formed by the $M_{5}-M_{6}$ and $M_{7}-M_{8}$ pairs. (The capacitor $C_{c}$ serves to stabilize the amplifier against potential oscillations during negative-feedback operation, a topic covered in detail in Chapter 7.)\n- The dc biasing circuitry includes the sources $I_{S S}, I_{B A S}$, and $V_{B A A S}$. If the $M_{1}-M_{2}$ pair is over-driven, one of its FETs would turn off. To prevent the corresponding half of the load from also turning off and subsequently requiring a delay to reactivate when the overdrive condition ceases, it is standard practice to set $I_{B A S}>I_{S S}$, such as $I_{B A S} \\approx 1.25 I_{S S}$. Fig. 5.17 presents a feasible implementation of the dc biasing circuitry: $M_{9}$ and $M_{10}$ sink the $I_{B A S}$ currents, $M_{11}$ sources the $I_{S S}$ current, and $M_{12}$ through $M_{16}$ provide the necessary voltages to bias $M_{11}$ as well as the $M_{3}-M_{4}$ and $M_{9}-M_{10}$ pairs.\n\nOur next step is to determine the element values $G_{m}$ and $R_{o}$ of the Norton equivalent depicted in Fig. 5.16b. To find $G_{m}$, we need to determine $i_{o(\\mathrm{sc})}$, a task we will perform using the half-circuit concept illustrated in Fig. 5.18. The differential pair responds to an input imbalance $v_{i d}=v_{p}-v_{n}$ with the drain currents\n\n$$\ni_{1}=g_{m 1} \\frac{v_{i d}}{2} \\quad i_{2}=g_{m 2} \\frac{v_{i d}}{2}\n$$\n\nimage_name:FIGURE 5.17 Detailed circuit schematic of the folded-cascode CMOS op amp\ndescription:The circuit is a folded-cascode CMOS operational amplifier, incorporating differential pairs, current mirrors, and cascode configurations for enhanced performance. It features NMOS and PMOS transistors, with current source biasing and differential input stages. The circuit is powered by VDD and VSS, with the output taken from vO.\n\nFIGURE 5.17 Detailed circuit schematic of the folded-cascode CMOS op amp.\nimage_name:FIGURE 5.18\ndescription:\n[\nname: M1, type: PMOS, ports: {S: s1s2, D: X1, G: Vid/2}\nname: M2, type: PMOS, ports: {S: s1s2, D: X2, G: -Vid/2}\nname: M3, type: NMOS, ports: {S: x1, D: X4, G: GND}\nname: M4, type: NMOS, ports: {S: X2, D: GND, G: GND}\nname: M5, type: PMOS, ports: {S: X3, D: X4, G: X4}\nname: M6, type: PMOS, ports: {S: GND, D: X4, G: X3}\nname: M7, type: PMOS, ports: {S: GND, D: X3, G: X3}\nname: M8, type: PMOS, ports: {S: GND, D: X3, G: X3}\nname: r09, type: Resistor, value: r09, ports: {N1: X1, N2: GND}\nname: r010, type: Resistor, value: r010, ports: {N1: X2, N2: GND}\nname: Vid, type: VoltageSource, value: Vid/2, ports: {Np: Vid/2, Nn: GND}\nname: Vid, type: VoltageSource, value: -Vid/2, ports: {Np: -Vid/2, Nn: GND}\n]\nextrainfo:The circuit is an AC model of a folded-cascode CMOS operational amplifier, featuring differential pairs, current mirrors, and cascode configurations for improved performance. It includes NMOS and PMOS transistors, with current source biasing and differential input stages. The circuit is powered by VDD and GND, with the output taken from the short-circuit current i_o(sc).\n\nFIGURE 5.18 Ac model to find the short-circuit output current $i_{o(\\mathrm{~s})}$.\n\nGiven that $g_{m 2}=g_{m 1}$, it follows that $i_{2}=i_{1}$. Once $i_{2}$ reaches $M_{4}$ 's source, it divides between the resistance seen looking into $M_{4}$ 's source and that seen looking into $M_{10}$ 's drain. The former is $R_{s 4}=\\left[1 /\\left(g_{m 4}+g_{m b 4}\\right)\\right] / / r_{o 4}$ and the latter is $R_{d 10}=r_{o 10}$. Since $R_{s 4} \\ll R_{d 10}$, virtually all of $i_{2}$ will flow into $M_{4}$ and thence to the output ac short, as depicted. Similar reasoning applies to the current division experienced by $i_{1}$ at $M_{3}$ 's source. Virtually all of $i_{1}$ will emerge from $M_{3}$ and be mirrored into the output ac short, as shown. By KCL, $i_{o(\\mathrm{sc})}=i_{1}+i_{2}=2\\left(g_{m 1} v_{i d} / 2\\right)=g_{m 1} v_{i d}$. Consequently,\n\n$$\n\\begin{equation*}\nG_{m}=\\frac{i_{o(\\mathrm{sc})}}{v_{p}-v_{n}}=g_{m 1} \\tag{5.38}\n\\end{equation*}\n$$\n\nTo determine the small-signal output resistance $R_{o}$, we set the input sources to zero, apply a test voltage $v$, find the current $i$ from the test source, and let $R_{o}=v / i$. The testing method is shown in Fig. 5.19, where we note that $i$ comprises three components:\n\n- The component $i_{6}=v / R_{d 6}$, where $R_{d 6}$ is the resistance seen looking into $M_{6}$ 's drain. Adapting Eq. (4.41) to this circuit, we get\n\n$$\ni_{6}=\\frac{v}{r_{o 6}+r_{o 8}+\\left(g_{m 6}+g_{m b 6}\\right) r_{o 6} r_{o 8}} \\approx \\frac{v}{\\left(g_{m 6}+g_{m b 6}\\right) r_{o 6} r_{o 8}}\n$$\n\nimage_name:FIGURE 5.19\ndescription:\n[\nname: M1, type: PMOS, ports: {S: S1S2, D: X3, G: GND}\nname: M2, type: PMOS, ports: {S: S1S2, D: X4, G: GND}\nname: M3, type: NMOS, ports: {S: X3, D: X2, G: GND}\nname: M4, type: NMOS, ports: {S: X4, D: V, G: GND}\nname: M5, type: PMOS, ports: {S: X1, D: X2, G: X2}\nname: M6, type: PMOS, ports: {S: d8s6, D: V, G: X2}\nname: M7, type: PMOS, ports: {S: GND, D: X1, G: X1}\nname: M8, type: PMOS, ports: {S: GND, D: d8s6, G: X1}\nname: ro9, type: Resistor, value: ro9, ports: {N1: X3, N2: GND}\nname: ro10, type: Resistor, value: ro10, ports: {N1: X4, N2: GND}\n]\nextrainfo:The circuit diagram is used to determine the output resistance R0 using a test voltage v. The current i is composed of three components: i6, i4, and i2. The circuit utilizes PMOS and NMOS transistors to achieve this measurement. The resistances ro9 and ro10 are used to model the output resistances of the devices.\n\nFIGURE 5.19 Ac model to find the output resistance $R_{0}$.\n\n- The component $i_{4}=v / R_{d 4}$, where $R_{d 4}$ is the resistance seen looking into $M_{4}$ 's drain. Again adapting, we obtain\n\n$$\ni_{4}=\\frac{v}{r_{o 4}+\\left(2 r_{o 2} / / r_{o 10}\\right)+\\left(g_{m 4}+g_{m b 4}\\right) r_{o 4}\\left(2 r_{o 2} / / r_{o 10}\\right)} \\approx \\frac{v}{\\left(g_{m 4}+g_{m b 4}\\right) r_{o 4}\\left(2 r_{o 2} / / r_{o 10}\\right)}\n$$\n\nwhere $2 r_{o 2}$ is the resistance seen looking into $M_{2}$ 's drain.\n\n- Upon exiting $M_{4}$, $i_{4}$ divides between $2 r_{o 2}$ and $r_{o 10}$ to give, by the current divider rule,\n\n$$\ni_{2}=\\frac{r_{o 10}}{2 r_{o 2}+r_{o 10}} i_{4}=\\frac{2 r_{o 2} / / r_{o 10}}{2 r_{o 2}} i_{4} \\approx \\frac{v}{\\left(g_{m 4}+g_{m b 4}\\right) 2 r_{o 2} r_{o 4}}\n$$\n\nThis current continues through $M_{1}$ to $M_{3}$ 's source, where it experiences negligible current division to proceed through $M_{3}$ to the mirror, which then replicates it at the test source, as shown.\n\nApplying KCL, we write\n\n$$\ni \\approx \\frac{v}{\\left(g_{m 6}+g_{m b 6}\\right) r_{o 6} r_{o 8}}+\\frac{v}{\\left(g_{m 4}+g_{m b 4}\\right) r_{o 4}\\left(2 r_{o 2} / / r_{o 10}\\right)}+\\frac{\\nu}{\\left(g_{m 4}+g_{m b 4}\\right) 2 r_{o 2} r_{o 4}}\n$$\n\nCombining the last two terms and simplifying, we write\n\n$$\ni \\approx \\frac{v}{\\left(g_{m 6}+g_{m b 6}\\right) r_{o 6} r_{o 8}}+\\frac{v}{\\left(g_{m 4}+g_{m b 4}\\right) r_{o 4}\\left(r_{o 2} / / r_{o 10}\\right)}=\\frac{v}{R_{o}}\n$$\n\nwhere\n\n$$\n\\begin{equation*}\nR_{o} \\approx\\left[\\left(g_{m 6}+g_{m b 6}\\right) r_{o 6} r_{o 8}\\right] / /\\left[\\left(g_{m 4}+g_{m b 4}\\right) r_{o 4}\\left(r_{o 2} / / r_{o 10}\\right)\\right] \\tag{5.39}\n\\end{equation*}\n$$\n\nFinally, the unloaded voltage gain is\n\n$$\n\\begin{equation*}\na=\\frac{v_{o}}{v_{p}-v_{n}}=g_{m 1} R_{o} \\tag{5.40}\n\\end{equation*}\n$$"
},
{
    "text": "The two-stage op amp recently examined achieves voltage gain expressed as $a=\\left(G_{m 1} R_{o 1}\\right) \\times \\left(G_{m 2} R_{o 2}\\right)$, representing the product of its individual stage gains. By rearranging as $a=G_{m 1}\\left(R_{o 1} G_{m 2} R_{o 2}\\right)$, an alternative configuration emerges: a single stage ($G_{m 1}$) but with a significantly higher output resistance ($R_{o}=R_{o 1} G_{m 2} R_{o 2}$). We initiate with an active-loaded differential pair to realize $G_{m 1}$, then cascode both the pair and the load to elevate the output resistance. To circumvent the well-known voltage-swing constraints of straightforward cascodes, we employ the folded-cascode scheme introduced in Section 4.9. This leads to the widely-used CMOS op amp variant shown in Fig. 5.16, in\n\nimage_name:(a)\ndescription:The circuit is a folded-cascode CMOS op amp featuring a p-channel differential pair M1-M2 cascoded by n-channel M3-M4. This architecture enhances output resistance and mitigates voltage-swing limitations. The differential pair is biased by the current source ISS, while IBIAS provides additional biasing. The capacitor CC is included for compensation purposes.\n\n(a)\nimage_name:(b)\ndescription:\n[\nname: Gm(vp-vn), type: VoltageControlledCurrentSource, ports: {Np: VO, Nn: GND}\nname: Ro, type: Resistor, value: Ro, ports: {N1: VO, N2: GND}\n]\nextrainfo:The circuit diagram (b) illustrates the Norton equivalent of a folded-cascode CMOS op amp. It comprises a voltage-controlled current source Gm(vp-vn) and a resistor Ro connected in parallel between the output node VO and ground (GND). The input nodes are designated vp and vn, with the output node labeled vo.\n\n(b)\n\nFIGURE 5.16 (a) Simplified schematic of the folded-cascode CMOS op amp and (b) its Norton equivalent.\nassociation with which we observe the following:\n\n- The core of the circuit is the $p$-channel differential pair $M_{1}-M_{2}$, subsequently cascoded by the $n$-channel CG pair $M_{3}-M_{4}$. In the folded configuration, the CG pair necessitates separate biasing, a role fulfilled here by the two $I_{B A S}$ current sinks.\n- The active load consists of the cascode current mirror formed by the $M_{5}-M_{6}$ and $M_{7}-M_{8}$ pairs. (The capacitor $C_{c}$ serves to stabilize the amplifier against potential oscillations during negative-feedback operation, a topic elaborated in Chapter 7.)\n- The dc biasing circuitry includes the sources $I_{S S}, I_{B A S}$, and $V_{B A A S}$. Should the $M_{1}-M_{2}$ pair be over-driven, one of its FETs would turn off. To avert the corresponding half of the load from also turning off and subsequently requiring a delay to reactivate when the overdrive condition ceases, it is typical to specify $I_{B A S}>I_{S S}$, such as $I_{B A S} \\approx 1.25 I_{S S}$. Fig. 5.17 presents a feasible implementation of the dc biasing circuitry: $M_{9}$ and $M_{10}$ sink the $I_{B A S}$ currents, $M_{11}$ sources the $I_{S S}$ current, and $M_{12}$ through $M_{16}$ provide the necessary voltages to bias $M_{11}$ as well as the $M_{3}-M_{4}$ and $M_{9}-M_{10}$ pairs.\n\nOur objective now is to determine the element values $G_{m}$ and $R_{o}$ of the Norton equivalent depicted in Fig. 5.16b. To ascertain $G_{m}$, we need to determine $i_{o(\\mathrm{sc})}$, a task we will execute using the half-circuit concept of Fig. 5.18. The differential pair responds to an input imbalance $v_{i d}=v_{p}-v_{n}$ with the drain currents\n\n$$\ni_{1}=g_{m 1} \\frac{v_{i d}}{2} \\quad i_{2}=g_{m 2} \\frac{v_{i d}}{2}\n$$\n\nimage_name:FIGURE 5.17 Detailed circuit schematic of the folded-cascode CMOS op amp\ndescription:The circuit is a folded-cascode CMOS operational amplifier, incorporating differential pairs, current mirrors, and cascode configurations for enhanced performance. It features NMOS and PMOS transistors, with current source biasing and differential input stages. The circuit is powered by VDD and VSS, with the output taken from vO.\n\nFIGURE 5.17 Detailed circuit schematic of the folded-cascode CMOS op amp.\nimage_name:FIGURE 5.18\ndescription:\n[\nname: M1, type: PMOS, ports: {S: s1s2, D: X1, G: Vid/2}\nname: M2, type: PMOS, ports: {S: s1s2, D: X2, G: -Vid/2}\nname: M3, type: NMOS, ports: {S: x1, D: X4, G: GND}\nname: M4, type: NMOS, ports: {S: X2, D: GND, G: GND}\nname: M5, type: PMOS, ports: {S: X3, D: X4, G: X4}\nname: M6, type: PMOS, ports: {S: GND, D: X4, G: X3}\nname: M7, type: PMOS, ports: {S: GND, D: X3, G: X3}\nname: M8, type: PMOS, ports: {S: GND, D: X3, G: X3}\nname: r09, type: Resistor, value: r09, ports: {N1: X1, N2: GND}\nname: r010, type: Resistor, value: r010, ports: {N1: X2, N2: GND}\nname: Vid, type: VoltageSource, value: Vid/2, ports: {Np: Vid/2, Nn: GND}\nname: Vid, type: VoltageSource, value: -Vid/2, ports: {Np: -Vid/2, Nn: GND}\n]\nextrainfo:The circuit is an AC model of a folded-cascode CMOS operational amplifier, featuring differential pairs, current mirrors, and cascode configurations for improved performance. It includes NMOS and PMOS transistors, with current source biasing and differential input stages. The circuit is powered by VDD and GND, with the output derived from the short-circuit current i_o(sc).\n\nFIGURE 5.18 Ac model to find the short-circuit output current $i_{o(\\mathrm{~s})}$.\n\nGiven that $g_{m 2}=g_{m 1}$, it follows that $i_{2}=i_{1}$. Once $i_{2}$ reaches $M_{4}$ 's source, it divides between the resistance seen looking into $M_{4}$ 's source and that seen looking into $M_{10}$ 's drain. The former is $R_{s 4}=\\left[1 /\\left(g_{m 4}+g_{m b 4}\\right)\\right] / / r_{o 4}$ and the latter is $R_{d 10}=r_{o 10}$. Since $R_{s 4} \\ll R_{d 10}$, virtually all of $i_{2}$ will flow into $M_{4}$ and thence to the output ac short, as depicted. Similar considerations apply to the current division experienced by $i_{1}$ at $M_{3}$ 's source. Virtually all of $i_{1}$ will emerge from $M_{3}$ and be mirrored into the output ac short, as shown. By KCL, $i_{o(\\mathrm{sc})}=i_{1}+i_{2}=2\\left(g_{m 1} v_{i d} / 2\\right)=g_{m 1} v_{i d}$. Consequently,\n\n$$\n\\begin{equation*}\nG_{m}=\\frac{i_{o(\\mathrm{sc})}}{v_{p}-v_{n}}=g_{m 1} \\tag{5.38}\n\\end{equation*}\n$$\n\nTo determine the small-signal output resistance $R_{o}$, we set the input sources to zero, apply a test voltage $v$, find the current $i$ from the test source, and let $R_{o}=v / i$. The test method is illustrated in Fig. 5.19, where we observe that $i$ comprises three components:\n\n- The component $i_{6}=v / R_{d 6}$, where $R_{d 6}$ is the resistance seen looking into $M_{6}$ 's drain. Adapting Eq. (4.41) to this circuit, we obtain\n\n$$\ni_{6}=\\frac{v}{r_{o 6}+r_{o 8}+\\left(g_{m 6}+g_{m b 6}\\right) r_{o 6} r_{o 8}} \\approx \\frac{v}{\\left(g_{m 6}+g_{m b 6}\\right) r_{o 6} r_{o 8}}\n$$\n\nimage_name:FIGURE 5.19\ndescription:\n[\nname: M1, type: PMOS, ports: {S: S1S2, D: X3, G: GND}\nname: M2, type: PMOS, ports: {S: S1S2, D: X4, G: GND}\nname: M3, type: NMOS, ports: {S: X3, D: X2, G: GND}\nname: M4, type: NMOS, ports: {S: X4, D: V, G: GND}\nname: M5, type: PMOS, ports: {S: X1, D: X2, G: X2}\nname: M6, type: PMOS, ports: {S: d8s6, D: V, G: X2}\nname: M7, type: PMOS, ports: {S: GND, D: X1, G: X1}\nname: M8, type: PMOS, ports: {S: GND, D: d8s6, G: X1}\nname: ro9, type: Resistor, value: ro9, ports: {N1: X3, N2: GND}\nname: ro10, type: Resistor, value: ro10, ports: {N1: X4, N2: GND}\n]\nextrainfo:The circuit diagram is used to determine the output resistance R0 using a test voltage v. The current i is composed of three components: i6, i4, and i2. The circuit employs PMOS and NMOS transistors to achieve this measurement. The resistances ro9 and ro10 are used to model the output resistances of the devices.\n\nFIGURE 5.19 Ac model to find the output resistance $R_{0}$.\n\n- The component $i_{4}=v / R_{d 4}$, where $R_{d 4}$ is the resistance seen looking into $M_{4}$ 's drain. Again adapting, we get\n\n$$\ni_{4}=\\frac{v}{r_{o 4}+\\left(2 r_{o 2} / / r_{o 10}\\right)+\\left(g_{m 4}+g_{m b 4}\\right) r_{o 4}\\left(2 r_{o 2} / / r_{o 10}\\right)} \\approx \\frac{v}{\\left(g_{m 4}+g_{m b 4}\\right) r_{o 4}\\left(2 r_{o 2} / / r_{o 10}\\right)}\n$$\n\nwhere $2 r_{o 2}$ is the resistance seen looking into $M_{2}$ 's drain.\n\n- Upon exiting $M_{4}, i_{4}$ divides between $2 r_{o 2}$ and $r_{o 10}$ to give, by the current divider rule,\n\n$$\ni_{2}=\\frac{r_{o 10}}{2 r_{o 2}+r_{o 10}} i_{4}=\\frac{2 r_{o 2} / / r_{o 10}}{2 r_{o 2}} i_{4} \\approx \\frac{v}{\\left(g_{m 4}+g_{m b 4}\\right) 2 r_{o 2} r_{o 4}}\n$$\n\nThis current continues through $M_{1}$ to $M_{3}$ 's source, where it undergoes negligible current division to proceed through $M_{3}$ to the mirror, which then replicates it at the test source, as shown.\n\nWe now apply KCL to write\n\n$$\ni \\approx \\frac{v}{\\left(g_{m 6}+g_{m b 6}\\right) r_{o 6} r_{o 8}}+\\frac{v}{\\left(g_{m 4}+g_{m b 4}\\right) r_{o 4}\\left(2 r_{o 2} / / r_{o 10}\\right)}+\\frac{\\nu}{\\left(g_{m 4}+g_{m b 4}\\right) 2 r_{o 2} r_{o 4}}\n$$\n\nCombining the last two terms and simplifying, we write\n\n$$\ni \\approx \\frac{v}{\\left(g_{m 6}+g_{m b 6}\\right) r_{o 6} r_{o 8}}+\\frac{v}{\\left(g_{m 4}+g_{m b 4}\\right) r_{o 4}\\left(r_{o 2} / / r_{o 10}\\right)}=\\frac{v}{R_{o}}\n$$\n\nwhere\n\n$$\n\\begin{equation*}\nR_{o} \\approx\\left[\\left(g_{m 6}+g_{m b 6}\\right) r_{o 6} r_{o 8}\\right] / /\\left[\\left(g_{m 4}+g_{m b 4}\\right) r_{o 4}\\left(r_{o 2} / / r_{o 10}\\right)\\right] \\tag{5.39}\n\\end{equation*}\n$$\n\nFinally, the unloaded voltage gain is\n\n$$\n\\begin{equation*}\na=\\frac{v_{o}}{v_{p}-v_{n}}=g_{m 1} R_{o} \\tag{5.40}\n\\end{equation*}\n```"
},
{
    "text": "The recently examined two-stage op amp achieves voltage gain expressed as $a=\\left(G_{m 1} R_{o 1}\\right) \\times \\left(G_{m 2} R_{o 2}\\right)$, essentially the product of its individual stage gains. By rearranging as $a=G_{m 1}\\left(R_{o 1} G_{m 2} R_{o 2}\\right)$, an alternative approach emerges: a single stage ($G_{m 1}$) but with a significantly higher output resistance ($R_{o}=R_{o 1} G_{m 2} R_{o 2}$). We initiate with an active-loaded differential pair to realize $G_{m 1}$, subsequently cascading both the pair and the load to elevate the output resistance. To circumvent the well-known voltage-swing constraints of straightforward cascodes, we employ the folded-cascode technique introduced in Section 4.9. This leads to the widely-used CMOS op amp configuration shown in Fig. 5.16, wherein:\n\n- The core of the circuit is the $p$-channel differential pair $M_{1}-M_{2}$, which is cascaded by the $n$-channel CG pair $M_{3}-M_{4}$. In this folded setup, the CG pair necessitates separate biasing, a role fulfilled by the two $I_{B A S}$ current sinks.\n- The active load comprises a cascode current mirror formed by the $M_{5}-M_{6}$ and $M_{7}-M_{8}$ pairs. The capacitor $C_{c}$ serves to stabilize the amplifier against potential oscillations during negative-feedback operation, a topic detailed in Chapter 7.\n- The dc biasing circuitry includes the sources $I_{S S}, I_{B A S}$, and $V_{B A A S}$. To prevent one half of the load from turning off if the $M_{1}-M_{2}$ pair is over-driven, and to avoid the subsequent delay in reactivation, it is standard practice to set $I_{B A S}>I_{S S}$, typically $I_{B A S} \\approx 1.25 I_{S S}$. Fig. 5.17 illustrates a feasible implementation of this dc biasing: $M_{9}$ and $M_{10}$ sink the $I_{B A S}$ currents, $M_{11}$ sources the $I_{S S}$ current, and $M_{12}$ through $M_{16}$ provide the necessary voltages to bias $M_{11}$ and the $M_{3}-M_{4}$ and $M_{9}-M_{10}$ pairs.\n\nNext, we aim to determine the element values $G_{m}$ and $R_{o}$ of the Norton equivalent depicted in Fig. 5.16b. To find $G_{m}$, we need to determine $i_{o(\\mathrm{sc})}$, which we will accomplish using the half-circuit concept of Fig. 5.18. The differential pair responds to an input imbalance $v_{i d}=v_{p}-v_{n}$ with the drain currents:\n\n$$\ni_{1}=g_{m 1} \\frac{v_{i d}}{2} \\quad i_{2}=g_{m 2} \\frac{v_{i d}}{2}\n$$\n\nGiven $g_{m 2}=g_{m 1}$, it follows that $i_{2}=i_{1}$. When $i_{2}$ reaches $M_{4}$'s source, it divides between the resistance seen looking into $M_{4}$'s source and that seen looking into $M_{10}$'s drain. The former is $R_{s 4}=\\left[1 /\\left(g_{m 4}+g_{m b 4}\\right)\\right] / / r_{o 4}$ and the latter is $R_{d 10}=r_{o 10}$. Since $R_{s 4} \\ll R_{d 10}$, nearly all of $i_{2}$ flows into $M_{4}$ and subsequently to the output ac short. Similar analysis applies to $i_{1}$ at $M_{3}$'s source, where most of $i_{1}$ exits $M_{3}$ and is mirrored into the output ac short. By KCL, $i_{o(\\mathrm{sc})}=i_{1}+i_{2}=2\\left(g_{m 1} v_{i d} / 2\\right)=g_{m 1} v_{i d}$. Thus,\n\n$$\n\\begin{equation*}\nG_{m}=\\frac{i_{o(\\mathrm{sc})}}{v_{p}-v_{n}}=g_{m 1} \\tag{5.38}\n\\end{equation*}\n$$\n\nTo determine the small-signal output resistance $R_{o}$, we set the input sources to zero, apply a test voltage $v$, find the current $i$ from the test source, and define $R_{o}=v / i$. This method is illustrated in Fig. 5.19, where $i$ comprises three components:\n\n- The component $i_{6}=v / R_{d 6}$, where $R_{d 6}$ is the resistance seen looking into $M_{6}$'s drain. Adapting Eq. (4.41) to this circuit, we get:\n\n$$\ni_{6}=\\frac{v}{r_{o 6}+r_{o 8}+\\left(g_{m 6}+g_{m b 6}\\right) r_{o 6} r_{o 8}} \\approx \\frac{v}{\\left(g_{m 6}+g_{m b 6}\\right) r_{o 6} r_{o 8}}\n$$\n\n- The component $i_{4}=v / R_{d 4}$, where $R_{d 4}$ is the resistance seen looking into $M_{4}$'s drain. Similarly, we obtain:\n\n$$\ni_{4}=\\frac{v}{r_{o 4}+\\left(2 r_{o 2} / / r_{o 10}\\right)+\\left(g_{m 4}+g_{m b 4}\\right) r_{o 4}\\left(2 r_{o 2} / / r_{o 10}\\right)} \\approx \\frac{v}{\\left(g_{m 4}+g_{m b 4}\\right) r_{o 4}\\left(2 r_{o 2} / / r_{o 10}\\right)}\n$$\n\n- Exiting $M_{4}$, $i_{4}$ divides between $2 r_{o 2}$ and $r_{o 10}$, resulting in:\n\n$$\ni_{2}=\\frac{r_{o 10}}{2 r_{o 2}+r_{o 10}} i_{4}=\\frac{2 r_{o 2} / / r_{o 10}}{2 r_{o 2}} i_{4} \\approx \\frac{v}{\\left(g_{m 4}+g_{m b 4}\\right) 2 r_{o 2} r_{o 4}}\n$$\n\nThis current continues through $M_{1}$ to $M_{3}$'s source, experiencing negligible division, and proceeds through $M_{3}$ to the mirror, which then replicates it at the test source.\n\nApplying KCL, we write:\n\n$$\ni \\approx \\frac{v}{\\left(g_{m 6}+g_{m b 6}\\right) r_{o 6} r_{o 8}}+\\frac{v}{\\left(g_{m 4}+g_{m b 4}\\right) r_{o 4}\\left(2 r_{o 2} / / r_{o 10}\\right)}+\\frac{v}{\\left(g_{m 4}+g_{m b 4}\\right) 2 r_{o 2} r_{o 4}}\n$$\n\nCombining and simplifying, we get:\n\n$$\ni \\approx \\frac{v}{\\left(g_{m 6}+g_{m b 6}\\right) r_{o 6} r_{o 8}}+\\frac{v}{\\left(g_{m 4}+g_{m b 4}\\right) r_{o 4}\\left(r_{o 2} / / r_{o 10}\\right)}=\\frac{v}{R_{o}}\n$$\n\nwhere\n\n$$\n\\begin{equation*}\nR_{o} \\approx\\left[\\left(g_{m 6}+g_{m b 6}\\right) r_{o 6} r_{o 8}\\right] / /\\left[\\left(g_{m 4}+g_{m b 4}\\right) r_{o 4}\\left(r_{o 2} / / r_{o 10}\\right)\\right] \\tag{5.39}\n\\end{equation*}\n$$\n\nFinally, the unloaded voltage gain is:\n\n$$\n\\begin{equation*}\na=\\frac{v_{o}}{v_{p}-v_{n}}=g_{m 1} R_{o} \\tag{5.40}\n\\end{equation*}\n```"
},
{
    "text": "The recently examined two-stage op amp achieves voltage gain expressed as $a=\\left(G_{m 1} R_{o 1}\\right) \\times \\left(G_{m 2} R_{o 2}\\right)$, essentially the product of its individual stage gains. Rearranging to $a=G_{m 1}\\left(R_{o 1} G_{m 2} R_{o 2}\\right)$ hints at an alternative approach: a single stage ($G_{m 1}$) but with a significantly higher output resistance ($R_{o}=R_{o 1} G_{m 2} R_{o 2}$). We initiate with an active-loaded differential pair to realize $G_{m 1}$, subsequently cascoding both the pair and the load to elevate the output resistance. To circumvent the well-known voltage-swing constraints of straightforward cascodes, we employ the folded-cascode technique introduced in Section 4.9. This leads to the widely-used CMOS op amp configuration shown in Fig. 5.16, in\nimage_name:(a)\ndescription:The circuit is a folded-cascode CMOS op amp featuring a p-channel differential pair M1-M2 cascoded by n-channel M3-M4. This architecture enhances output resistance and mitigates voltage-swing limitations. The differential pair is biased by the current source ISS, while IBIAS provides additional biasing. The capacitor CC is included for compensation purposes.\n\n(a)\nimage_name:(b)\ndescription:\n[\nname: Gm(vp-vn), type: VoltageControlledCurrentSource, ports: {Np: VO, Nn: GND}\nname: Ro, type: Resistor, value: Ro, ports: {N1: VO, N2: GND}\n]\nextrainfo:The circuit diagram (b) illustrates the Norton equivalent of a folded-cascode CMOS op amp. It comprises a voltage-controlled current source Gm(vp-vn) and a resistor Ro connected in parallel between the output node VO and ground (GND). The input nodes are designated vp and vn, with the output node labeled vo.\n\n(b)\n\nFIGURE 5.16 (a) Simplified schematic of the folded-cascode CMOS op amp and (b) its Norton equivalent.\nassociation with which we observe the following:\n\n- The core of the circuit is the $p$-channel differential pair $M_{1}-M_{2}$, which is further cascoded by the $n$-channel CG pair $M_{3}-M_{4}$. In the folded configuration, the CG pair necessitates separate biasing, a role fulfilled here by the two $I_{B A S}$ current sinks.\n- The active load consists of the cascode current mirror formed by the $M_{5}-M_{6}$ and $M_{7}-M_{8}$ pairs. (The capacitor $C_{c}$ serves to stabilize the amplifier against potential oscillations during negative-feedback operation, a topic elaborated in Chapter 7.)\n- The dc biasing circuitry includes the sources $I_{S S}, I_{B A S}$, and $V_{B A A S}$. If the $M_{1}-M_{2}$ pair is over-driven, one of its FETs would turn off. To prevent the corresponding half of the load from also turning off and subsequently requiring a delay to reactivate when the overdrive condition ceases, it is typical to set $I_{B A S}>I_{S S}$, such as $I_{B A S} \\approx 1.25 I_{S S}$. Fig. 5.17 presents a feasible implementation of the dc biasing circuitry: $M_{9}$ and $M_{10}$ sink the $I_{B A S}$ currents, $M_{11}$ sources the $I_{S S}$ current, and $M_{12}$ through $M_{16}$ provide the necessary voltages to bias $M_{11}$ as well as the $M_{3}-M_{4}$ and $M_{9}-M_{10}$ pairs.\n\nOur objective now is to determine the element values $G_{m}$ and $R_{o}$ of the Norton equivalent depicted in Fig. 5.16b. To ascertain $G_{m}$, we need to determine $i_{o(\\mathrm{sc})}$, a task we will execute using the half-circuit concept of Fig. 5.18. The differential pair responds to an input imbalance $v_{i d}=v_{p}-v_{n}$ with the drain currents\n\n$$\ni_{1}=g_{m 1} \\frac{v_{i d}}{2} \\quad i_{2}=g_{m 2} \\frac{v_{i d}}{2}\n$$\n\nimage_name:FIGURE 5.17 Detailed circuit schematic of the folded-cascode CMOS op amp\ndescription:The circuit is a folded-cascode CMOS operational amplifier, incorporating differential pairs, current mirrors, and cascode configurations for enhanced performance. It features NMOS and PMOS transistors, with current source biasing and differential input stages. The circuit is powered by VDD and VSS, with the output taken from vO.\n\nFIGURE 5.17 Detailed circuit schematic of the folded-cascode CMOS op amp.\nimage_name:FIGURE 5.18\ndescription:\n[\nname: M1, type: PMOS, ports: {S: s1s2, D: X1, G: Vid/2}\nname: M2, type: PMOS, ports: {S: s1s2, D: X2, G: -Vid/2}\nname: M3, type: NMOS, ports: {S: x1, D: X4, G: GND}\nname: M4, type: NMOS, ports: {S: X2, D: GND, G: GND}\nname: M5, type: PMOS, ports: {S: X3, D: X4, G: X4}\nname: M6, type: PMOS, ports: {S: GND, D: X4, G: X3}\nname: M7, type: PMOS, ports: {S: GND, D: X3, G: X3}\nname: M8, type: PMOS, ports: {S: GND, D: X3, G: X3}\nname: r09, type: Resistor, value: r09, ports: {N1: X1, N2: GND}\nname: r010, type: Resistor, value: r010, ports: {N1: X2, N2: GND}\nname: Vid, type: VoltageSource, value: Vid/2, ports: {Np: Vid/2, Nn: GND}\nname: Vid, type: VoltageSource, value: -Vid/2, ports: {Np: -Vid/2, Nn: GND}\n]\nextrainfo:The circuit is an AC model of a folded-cascode CMOS operational amplifier, featuring differential pairs, current mirrors, and cascode configurations for improved performance. It includes NMOS and PMOS transistors, with current source biasing and differential input stages. The circuit is powered by VDD and GND, with the output taken from the short-circuit current i_o(sc).\n\nFIGURE 5.18 Ac model to find the short-circuit output current $i_{o(\\mathrm{~s})}$.\n\nGiven that $g_{m 2}=g_{m 1}$, it follows that $i_{2}=i_{1}$. Once $i_{2}$ reaches $M_{4}$ 's source, it divides between the resistance seen looking into $M_{4}$ 's source and that seen looking into $M_{10}$ 's drain. The former is $R_{s 4}=\\left[1 /\\left(g_{m 4}+g_{m b 4}\\right)\\right] / / r_{o 4}$ and the latter is $R_{d 10}=r_{o 10}$. Since $R_{s 4} \\ll R_{d 10}$, virtually all of $i_{2}$ will flow into $M_{4}$ and thence to the output ac short, as depicted. Similar considerations apply to the current division experienced by $i_{1}$ at $M_{3}$ 's source. Virtually all of $i_{1}$ will come out of $M_{3}$ and be mirrored into the output ac short, as shown. By KCL, $i_{o(\\mathrm{sc})}=i_{1}+i_{2}=2\\left(g_{m 1} v_{i d} / 2\\right)=g_{m 1} v_{i d}$. Consequently,\n\n$$\n\\begin{equation*}\nG_{m}=\\frac{i_{o(\\mathrm{sc})}}{v_{p}-v_{n}}=g_{m 1} \\tag{5.38}\n\\end{equation*}\n$$\n\nTo determine the small-signal output resistance $R_{o}$, we set the input sources to zero, apply a test voltage $v$, find the current $i$ from the test source, and let $R_{o}=v / i$. The testing method is illustrated in Fig. 5.19, where we observe that $i$ comprises three components:\n\n- The component $i_{6}=v / R_{d 6}$, where $R_{d 6}$ is the resistance seen looking into $M_{6}$ 's drain. Adapting Eq. (4.41) to this circuit, we get\n\n$$\ni_{6}=\\frac{v}{r_{o 6}+r_{o 8}+\\left(g_{m 6}+g_{m b 6}\\right) r_{o 6} r_{o 8}} \\approx \\frac{v}{\\left(g_{m 6}+g_{m b 6}\\right) r_{o 6} r_{o 8}}\n$$\n\nimage_name:FIGURE 5.19\ndescription:\n[\nname: M1, type: PMOS, ports: {S: S1S2, D: X3, G: GND}\nname: M2, type: PMOS, ports: {S: S1S2, D: X4, G: GND}\nname: M3, type: NMOS, ports: {S: X3, D: X2, G: GND}\nname: M4, type: NMOS, ports: {S: X4, D: V, G: GND}\nname: M5, type: PMOS, ports: {S: X1, D: X2, G: X2}\nname: M6, type: PMOS, ports: {S: d8s6, D: V, G: X2}\nname: M7, type: PMOS, ports: {S: GND, D: X1, G: X1}\nname: M8, type: PMOS, ports: {S: GND, D: d8s6, G: X1}\nname: ro9, type: Resistor, value: ro9, ports: {N1: X3, N2: GND}\nname: ro10, type: Resistor, value: ro10, ports: {N1: X4, N2: GND}\n]\nextrainfo:The circuit diagram is used to determine the output resistance R0 using a test voltage v. The current i is composed of three components: i6, i4, and i2. The circuit utilizes PMOS and NMOS transistors to achieve this measurement. The resistances ro9 and ro10 are used to model the output resistances of the devices.\n\nFIGURE 5.19 Ac model to find the output resistance $R_{0}$.\n\n- The component $i_{4}=v / R_{d 4}$, where $R_{d 4}$ is the resistance seen looking into $M_{4}$ 's drain. Again adapting, we obtain\n\n$$\ni_{4}=\\frac{v}{r_{o 4}+\\left(2 r_{o 2} / / r_{o 10}\\right)+\\left(g_{m 4}+g_{m b 4}\\right) r_{o 4}\\left(2 r_{o 2} / / r_{o 10}\\right)} \\approx \\frac{v}{\\left(g_{m 4}+g_{m b 4}\\right) r_{o 4}\\left(2 r_{o 2} / / r_{o 10}\\right)}\n$$\n\nwhere $2 r_{o 2}$ is the resistance seen looking into $M_{2}$ 's drain.\n\n- Upon exiting $M_{4}$, $i_{4}$ divides between $2 r_{o 2}$ and $r_{o 10}$ to yield, by the current divider rule,\n\n$$\ni_{2}=\\frac{r_{o 10}}{2 r_{o 2}+r_{o 10}} i_{4}=\\frac{2 r_{o 2} / / r_{o 10}}{2 r_{o 2}} i_{4} \\approx \\frac{v}{\\left(g_{m 4}+g_{m b 4}\\right) 2 r_{o 2} r_{o 4}}\n$$\n\nThis current continues through $M_{1}$ to $M_{3}$ 's source, where it experiences negligible current division to proceed through $M_{3}$ to the mirror, which then replicates it at the test source, as shown.\n\nApplying KCL, we write\n\n$$\ni \\approx \\frac{v}{\\left(g_{m 6}+g_{m b 6}\\right) r_{o 6} r_{o 8}}+\\frac{v}{\\left(g_{m 4}+g_{m b 4}\\right) r_{o 4}\\left(2 r_{o 2} / / r_{o 10}\\right)}+\\frac{\\nu}{\\left(g_{m 4}+g_{m b 4}\\right) 2 r_{o 2} r_{o 4}}\n$$\n\nCombining the last two terms and simplifying, we write\n\n$$\ni \\approx \\frac{v}{\\left(g_{m 6}+g_{m b 6}\\right) r_{o 6} r_{o 8}}+\\frac{v}{\\left(g_{m 4}+g_{m b 4}\\right) r_{o 4}\\left(r_{o 2} / / r_{o 10}\\right)}=\\frac{v}{R_{o}}\n$$\n\nwhere\n\n$$\n\\begin{equation*}\nR_{o} \\approx\\left[\\left(g_{m 6}+g_{m b 6}\\right) r_{o 6} r_{o 8}\\right] / /\\left[\\left(g_{m 4}+g_{m b 4}\\right) r_{o 4}\\left(r_{o 2} / / r_{o 10}\\right)\\right] \\tag{5.39}\n\\end{equation*}\n$$\n\nFinally, the unloaded voltage gain is\n\n$$\n\\begin{equation*}\na=\\frac{v_{o}}{v_{p}-v_{n}}=g_{m 1} R_{o} \\tag{5.40}\n\\end{equation*}\n$$"
},
{
    "text": "The two-stage op amp recently examined achieves voltage gain as $a=\\left(G_{m 1} R_{o 1}\\right) \\times \\left(G_{m 2} R_{o 2}\\right)$, essentially the product of its individual stage gains. By rearranging as $a=G_{m 1}\\left(R_{o 1} G_{m 2} R_{o 2}\\right)$, an alternative configuration emerges: a single stage ($G_{m 1}$) but with a significantly higher output resistance ($R_{o}=R_{o 1} G_{m 2} R_{o 2}$). We initiate with an active-loaded differential pair to realize $G_{m 1}$, subsequently cascoding both the pair and the load to elevate the output resistance. To circumvent the notorious voltage-swing constraints of straightforward cascodes, we employ the folded-cascode approach introduced in Section 4.9. This leads to the widely-used CMOS op amp variant shown in Fig. 5.16, where:\n\n- The core of the circuit is the $p$-channel differential pair $M_{1}-M_{2}$, further cascoded by the $n$-channel CG pair $M_{3}-M_{4}$. In this folded configuration, the CG pair necessitates separate biasing, a role fulfilled by the two $I_{B A S}$ current sinks.\n- The active load comprises the cascode current mirror formed by $M_{5}-M_{6}$ and $M_{7}-M_{8}$ pairs. The capacitor $C_{c}$ serves to stabilize the amplifier against potential oscillations in negative-feedback mode, a topic elaborated in Chapter 7.\n- The dc biasing circuitry includes $I_{S S}, I_{B A S}$, and $V_{B A A S}$. To prevent the load from turning off if the $M_{1}-M_{2}$ pair is over-driven, it is standard to set $I_{B A S}>I_{S S}$, typically $I_{B A S} \\approx 1.25 I_{S S}$. Fig. 5.17 illustrates a feasible implementation of the dc biasing circuitry: $M_{9}$ and $M_{10}$ sink the $I_{B A S}$ currents, $M_{11}$ sources the $I_{S S}$ current, and $M_{12}$ through $M_{16}$ provide the necessary biasing voltages for $M_{11}$ and the $M_{3}-M_{4}$ and $M_{9}-M_{10}$ pairs.\n\nOur objective now is to determine the element values $G_{m}$ and $R_{o}$ of the Norton equivalent depicted in Fig. 5.16b. To find $G_{m}$, we need to determine $i_{o(\\mathrm{sc})}$, which we will accomplish using the half-circuit concept of Fig. 5.18. The differential pair responds to an input imbalance $v_{i d}=v_{p}-v_{n}$ with the drain currents:\n\n$$\ni_{1}=g_{m 1} \\frac{v_{i d}}{2} \\quad i_{2}=g_{m 2} \\frac{v_{i d}}{2}\n$$\n\nSince $g_{m 2}=g_{m 1}$, it follows that $i_{2}=i_{1}$. When $i_{2}$ reaches $M_{4}$'s source, it divides between the resistance looking into $M_{4}$'s source and that looking into $M_{10}$'s drain. The former is $R_{s 4}=\\left[1 /\\left(g_{m 4}+g_{m b 4}\\right)\\right] / / r_{o 4}$ and the latter is $R_{d 10}=r_{o 10}$. Given $R_{s 4} \\ll R_{d 10}$, nearly all of $i_{2}$ flows into $M_{4}$ and subsequently to the output ac short. Similar analysis applies to $i_{1}$ at $M_{3}$'s source. Virtually all of $i_{1}$ exits $M_{3}$ and is mirrored into the output ac short. By KCL, $i_{o(\\mathrm{sc})}=i_{1}+i_{2}=2\\left(g_{m 1} v_{i d} / 2\\right)=g_{m 1} v_{i d}$. Thus,\n\n$$\n\\begin{equation*}\nG_{m}=\\frac{i_{o(\\mathrm{sc})}}{v_{p}-v_{n}}=g_{m 1} \\tag{5.38}\n\\end{equation*}\n$$\n\nTo determine the small-signal output resistance $R_{o}$, we set the input sources to zero, apply a test voltage $v$, find the current $i$ from the test source, and define $R_{o}=v / i$. This method is illustrated in Fig. 5.19, where $i$ comprises three components:\n\n- The component $i_{6}=v / R_{d 6}$, where $R_{d 6}$ is the resistance looking into $M_{6}$'s drain. Adapting Eq. (4.41) to this circuit, we get:\n\n$$\ni_{6}=\\frac{v}{r_{o 6}+r_{o 8}+\\left(g_{m 6}+g_{m b 6}\\right) r_{o 6} r_{o 8}} \\approx \\frac{v}{\\left(g_{m 6}+g_{m b 6}\\right) r_{o 6} r_{o 8}}\n$$\n\n- The component $i_{4}=v / R_{d 4}$, where $R_{d 4}$ is the resistance looking into $M_{4}$'s drain. Again adapting, we obtain:\n\n$$\ni_{4}=\\frac{v}{r_{o 4}+\\left(2 r_{o 2} / / r_{o 10}\\right)+\\left(g_{m 4}+g_{m b 4}\\right) r_{o 4}\\left(2 r_{o 2} / / r_{o 10}\\right)} \\approx \\frac{v}{\\left(g_{m 4}+g_{m b 4}\\right) r_{o 4}\\left(2 r_{o 2} / / r_{o 10}\\right)}\n$$\n\nwhere $2 r_{o 2}$ is the resistance looking into $M_{2}$'s drain.\n\n- Exiting $M_{4}$, $i_{4}$ divides between $2 r_{o 2}$ and $r_{o 10}$, yielding, by the current divider rule:\n\n$$\ni_{2}=\\frac{r_{o 10}}{2 r_{o 2}+r_{o 10}} i_{4}=\\frac{2 r_{o 2} / / r_{o 10}}{2 r_{o 2}} i_{4} \\approx \\frac{v}{\\left(g_{m 4}+g_{m b 4}\\right) 2 r_{o 2} r_{o 4}}\n$$\n\nThis current continues through $M_{1}$ to $M_{3}$'s source, experiencing negligible division, and proceeds through $M_{3}$ to the mirror, which then replicates it at the test source.\n\nApplying KCL, we write:\n\n$$\ni \\approx \\frac{v}{\\left(g_{m 6}+g_{m b 6}\\right) r_{o 6} r_{o 8}}+\\frac{v}{\\left(g_{m 4}+g_{m b 4}\\right) r_{o 4}\\left(2 r_{o 2} / / r_{o 10}\\right)}+\\frac{v}{\\left(g_{m 4}+g_{m b 4}\\right) 2 r_{o 2} r_{o 4}}\n$$\n\nCombining the last two terms and simplifying, we have:\n\n$$\ni \\approx \\frac{v}{\\left(g_{m 6}+g_{m b 6}\\right) r_{o 6} r_{o 8}}+\\frac{v}{\\left(g_{m 4}+g_{m b 4}\\right) r_{o 4}\\left(r_{o 2} / / r_{o 10}\\right)}=\\frac{v}{R_{o}}\n$$\n\nwhere\n\n$$\n\\begin{equation*}\nR_{o} \\approx\\left[\\left(g_{m 6}+g_{m b 6}\\right) r_{o 6} r_{o 8}\\right] / /\\left[\\left(g_{m 4}+g_{m b 4}\\right) r_{o 4}\\left(r_{o 2} / / r_{o 10}\\right)\\right] \\tag{5.39}\n\\end{equation*}\n$$\n\nFinally, the unloaded voltage gain is:\n\n$$\n\\begin{equation*}\na=\\frac{v_{o}}{v_{p}-v_{n}}=g_{m 1} R_{o} \\tag{5.40}\n\\end{equation*}\n```"
}
]