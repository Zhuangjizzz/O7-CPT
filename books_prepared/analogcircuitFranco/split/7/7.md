# Frequency and Time Responses

Chapter Outline

6.1 High-Frequency BJT Model ..... 566
6.2 High-Frequency MOSFET Model ..... 574
6.3 Frequency Response of CE/CS Amplifiers ..... 581
6.4 Frequency Response of Differential Amplifiers ..... 592
6.5 Bipolar Voltage and Current Buffers ..... 599
6.6 MOS Voltage and Current Buffers ..... 606
6.7 Open-Circuit Time-Constant (OCTC) Analysis ..... 612
6.8 Frequency Response of Cascode Amplifiers ..... 623
6.9 Frequency and Transient Responses of Op Amps ..... 629
6.10 Diode Switching Transients ..... 639
6.11 BJT Switching Transients ..... 644
6.12 Transient Response of CMOS Gates and Voltage Comparators ..... 652
Appendix 6A: Transfer Functions and Bode Plots ..... 665
References ..... 672
Problems ..... 672
n our study of electronic circuits so far we have tacitly assumed that diodes and transistors react to external signals instantaneously. This is approximately true only up to certain operating frequencies, above which various parasitic reactances come into play, whose effect is to limit the frequency response and operating speed of a circuit (speed and frequency characteristics are collectively referred to as dynamics). Since diodes and transistors operate on the principle of charge control, their internal parasitics are of the capacitive type, with the junction capacitance $C_{j}$ encountered in Chapter 1 being a familiar example. But, even without any electronic devices present, a circuit exhibits inherent reactive parasitics stemming from
its dimensions and layout. In fact, viewing a circuit as a collection of nodes and branches, we can safely say that

- each node exhibits stray capacitance toward its nearby nodes, including the reference or ground node
- each branch exhibits stray self-inductance as well as inductive coupling to its nearby branches

A capacitance, whether intentional or parasitic, tends to oppose changes in the voltage across it, whereas an inductance tends to oppose changes in the current through it. These parasitics are generally small, indicating that below certain operating frequencies, stray capacitances act as open circuits and stray inductances act as short circuits and can thus be ignored. However, as a circuit's operating frequency or operating speed is increased, the roles of capacitances and inductances are reversed, so capacitance now approach short-circuit behavior and inductances open-circuit behavior. In the circuits of interest to us here it so happens that the most severe limitations stem from stray capacitances. To be able to investigate their effect upon the dynamics of a circuit we therefore need to augment the small-signal transistor models utilized so far with suitable capacitances.

Both BJTs and MOSFETs include pn junctions, so their models must incorporate the corresponding junction capacitances. The MOSFET includes also the capacitances formed by the gate with the channel as well as with the source and drain regions. There is no counterpart of these capacitances in the BJT. On the other hand, the BJT exhibits a capacitance associated with the minority charge buildup inside the base region that does not have a counterpart in the MOSFET. We thus have similarities but also differences in the physical origin of the parasitics of the two devices. Yet, the similarities are strong enough that once the student has mastered the highfrequency analysis of one of the two device types, a good deal of it can be adapted to the other.

CHAPTER HIGHLIGHTS

The chapter begins with the physical basis of the parasitic capacitances of BJTs and MOSFETs, after which suitable high-frequency models are developed for both devices.

These models are then applied to the study of the high-frequency behavior of the basic single transistor configurations (CE/CS, CC/CD) and CB/CG configurations), as well as differential pairs, both passive loaded and active loaded. Since the distinguishing feature of the $\mathrm{CC} / \mathrm{CD}$ and $\mathrm{CB} / \mathrm{CG}$ configurations is their ability to effect impedance transformation, particular attention is given to terminal impedances and modeling thereof, especially when it comes to inductive impedances due to their notorious tendency to cause ringing or even oscillations.

As circuit complexity increases, frequency analysis tends to become prohibitively difficult. The open-circuit time-constant (OCTC) technique discussed next alleviates the task by breaking it down into multiple but simpler sub-tasks, which we
then use to estimate the circuit's bandwidth. The OCTC technique proves particularly useful in the analysis of multiple-transistor circuits such as the cascode configuration.

The frequency response illuminates only certain aspects of a circuit's dynamics. To complete the picture we need to know also the transient response, the dual counterpart. Op amps offer a classic example in which it proves useful to know both viewpoints side by side.

There are situations in which only the transient response is of interest, especially when it comes to highly nonlinear applications such as switches and logic gates. The chapter concludes with the switching transients of pn junctions and BJTs, the propagation delays of CMOS logic gates, and the response times of voltage comparators.

Frequency analysis requires a certain amount of dexterity with the manipulations of transfer functions and the construction of Bode plots. For convenience, these subjects are briefly reviewed in Appendix 6A, at the end of the chapter. The chapter makes abundant use of PSpice both as a software oscilloscope to display Bode plots and transient responses, and as a verification tool for hand calculations.

## 6.1 HIGH-FREQUENCY BJT MODEL

Recall that a BJT comprises two $p n$ junctions. In junction-isolated integrated circuits (ICs) there is a third junction providing electric isolation between each BJT and its surrounding components on the chip (this junction is always reverse biased). As we know, each junction exhibits a voltage-dependent capacitance called the junction ca pacitance, whose characteristic is depicted in Fig. 1.41b. In the case of the npn BJT of Fig. 6.1, the three capacitances of interest are:

- The base-emitter junction capacitance $C_{j e}$,

$$
\begin{equation*}
C_{j e}\left(v_{B E}\right)=\frac{C_{j e 0}}{\left(1-v_{B E} / \phi_{e}\right)^{m_{e}}} \tag{6.1a}
\end{equation*}
$$

where $C_{j e 0}$ is the zero-bias value of $C_{j e}, v_{B E}$ is the base-emitter voltage, $\phi_{e}$ is the built-in potential of the base-emitter junction, and $m_{e}$ is the junction's grading coefficient, typically between $1 / 2$ for abrupt junctions, and $1 / 3$ for graded junctions. In forward-active operation $v_{B E}$ doesn't vary much from its typical value $V_{B E(\text { on })}(=0.7 \mathrm{~V})$, so it is common practice to approximate

$$
\begin{equation*}
C_{j e}\left(V_{B E(\mathrm{on})}\right) \cong 2 C_{j e 0} \tag{6.1b}
\end{equation*}
$$

- The base-collector junction capacitance $C_{j c}$, more commonly denoted as $C_{\mu}$ in analog electronics,

$$
\begin{equation*}
C_{\mu}\left(v_{B C}\right)=\frac{C_{\mu 0}}{\left(1-v_{B C} / \phi_{c}\right)^{m_{c}}} \tag{6.2}
\end{equation*}
$$

with similar meaning for the various parameters. In forward-active operation we usually have $v_{B C}<0$, so it follows that $C_{\mu}<C_{\mu 0}$.
![](https://cdn.mathpix.com/cropped/2024_11_07_10da0ce153b00c68dc1dg-067.jpg?height=667&width=1177&top_left_y=216&top_left_x=205)

FIGURE 6.1 The junction capacitances of a monolithic npn BJT.

- The collector-to-substrate junction capacitance $C_{s}$, with a similar expression as the one above. To ensure isolation, this junction must always be in reverse bias, so to prevent it from ever turning on, the substrate $S$ is internally tied to the most negative voltage (MNV) in the circuit. With $v_{S C}<0$ this junction is nonconductive, yet it presents a stray capacitance $C_{s}$ whose effect is to shunt high-frequency collector signals to the ac grounded substrate.

Figure 6.1 indicates that all three capacitances are of the distributed type and that their areas increase as we go from $C_{j e}$ to $C_{\mu}$ to $C_{s}$. However, the depletion-layer widths also increase in the same order due to progressively lighter doping levels from emitter to base to collector and to substrate. So, if we visualize each capacitance as $C_{j}=\varepsilon_{s t} A / X_{d}$ as per Fig. 1.42b, it is not surprising that the three capacitance values do not differ that much from each other. Depending on transistor size, $C_{j e 0}, C_{\mu 0}$, and $C_{s 0}$ may range from a few picofarads ( $1 \mathrm{pF}=10^{-12} \mathrm{~F}$ ) down to ten femtofarads ( $1 \mathrm{fF}=10^{-15} \mathrm{~F}$ ) or so.

### The Base-Charging Capacitance $\boldsymbol{C}_{b}$

We now wish to demonstrate that the BJT exhibits an additional capacitance $C_{b}$ due to the injection of minority charges into its base region. Recall that in order to operate a BJT in the forward-active (FA) region we need to establish an excess of minority charge-carriers in its base (this charge, already discussed in connection with Fig. 2.8, is repeated here as Fig. 6.2 for convenience). To find this charge, henceforth denoted as $Q_{F}$ and consisting of electrons in the npn BJT and holes in the pnp BJT, we consider the charge $d Q_{F}$ contained in an infinitesimal slice of thickness $d x$ located at some point $x$ along the horizontal axis, and we then integrate $d Q_{F}$ from 0 to the base width $W_{B}$. For an $n p n$ BJT with emitter area $A_{E}$, we first multiply the volume $A_{E} d x$
![](https://cdn.mathpix.com/cropped/2024_11_07_10da0ce153b00c68dc1dg-068.jpg?height=515&width=590&top_left_y=212&top_left_x=452)

FIGURE 6.2 Excess minority carrier distribution in the base region of an npn BJT operating in the forward-active mode.
by the local excess electron density $n_{B}^{\prime}(x)$ to find the number of electrons within the slice, then we multiply by the electron charge $-q$ to find $d Q_{F}$, finally we integrate

$$
Q_{F}=-q A_{E} \int_{0}^{W_{B}} n_{B}^{\prime}(x) d x=-q A_{E} \frac{W_{B} \times\left[n_{B}^{\prime}(0)-n_{B}^{\prime}\left(W_{B}\right)\right]}{2}
$$

where we have used the fact that the integral is just the area of the triangle with base $W_{B}$ and height $n_{B}^{\prime}(0)-n_{B}^{\prime}\left(W_{B}\right)$. We also know that the collector current $I_{C}$ is proportional to the slope of the triangle,

$$
I_{C}=A_{E} J_{n}=q A_{E} D \frac{d n_{B}^{\prime}(x)}{d x}=q A_{E} D_{n}\left(-\frac{n_{B}^{\prime}(0)-n_{B}^{\prime}\left(W_{B}\right)}{W_{B}}\right)
$$

where $D_{n}$ is the electron diffusivity. Eliminating the difference $n_{B}^{\prime}(0)-n_{B}^{\prime}\left(W_{B}\right)$ and simplifying, we get

$$
\begin{equation*}
Q_{F}=\tau_{F} I_{C} \tag{6.3}
\end{equation*}
$$

where

$$
\begin{equation*}
\tau_{F}=\frac{W_{B}^{2}}{2 D_{n}} \tag{6.4}
\end{equation*}
$$

is the mean transit time for electrons in the forward direction, so-called because it represents the average time an electron spends in crossing the base region. (To see why, rewrite as $I_{C}=Q_{F} / \tau_{F}$, and use the definition of current, $I=\Delta Q / \Delta t$, to view $\tau_{F}$ as the time taken by the charge $Q_{F}$ to diffuse through the base.) For monolithic npn BJTs, $\tau_{F}$ is typically in the range of 10 to $100 \mathrm{ps}\left(1 \mathrm{ps}=10^{-12} \mathrm{~s}\right)$. Equation (6.4) applies to the pnp BJT as well, provided we replace $D_{n}$ with $D_{p}$. By Einstein's equations, $D_{p}=\left(\mu_{p} / \mu_{n}\right) D_{n}$. Since $\mu_{p}<\mu_{n}$, it follows that $D_{p}<D_{p}$, indicating that pnp BJTs exhibit longer transit times than npn BJTs, a feature that makes the npn types inherently faster and thus better suited to high-speed applications.

Recall that a change $v_{b e}$ results in the change $i_{c}=g_{m} v_{b e}$, and hence, by Eq. (6.3), in the change $q_{f}=\tau_{F} i_{c}$, that is,

$$
q_{f}=\tau_{F} g_{m} v_{b e}
$$

Whenever a voltage change causes charge redistribution we have the phenomenon of capacitance, so we write $C_{b}=q_{f} / v_{b e}$, that is,

$$
\begin{equation*}
C_{b}=\tau_{F} g_{m}=\tau_{F} \frac{I_{C}}{V_{T}} \tag{6.5}
\end{equation*}
$$

where $C_{b}$ is the base-charging capacitance, also called the diffusion capacitance. Note that $C_{b}$ depends on the bias current $I_{C}$, just like $g_{m}, r_{\pi}$, and $r_{o}$ do.

### The High-Frequency BJT Model

We are now ready to incorporate all above information into a small-signal BJT model that will allow us to investigate the high-frequency behavior of bipolar ICs. The result is shown in Fig. 6.3, where small-signal voltages and currents, now frequency-dependent, are represented in terms of their Laplace's transforms (upper-case letters with lowercase subscripts). Proceeding from right to left, we make the following observations:

- First, we have the substrate capacitance $C_{s}$. Since the substrate of an npn BJT is connected to the MNV, which is a dc potential, the substrate appears as a signal ground in our model. (Oftentimes $C_{s}$ is ignored in order to simplify the calculations.)
- Next, we note the base-collector junction capacitance $C_{\mu}$. This capacitance is most intriguing, for there are situations in which its effect is negligible and it can thus be ignored, whereas there are others in which its role gets magnified because of a phenomenon known as the Miller effect, and thus becomes the dominant capacitance in the circuit.
- In parallel with $r_{\pi}$ we have a capacitance $C_{\pi}$ made up of two components,

$$
\begin{equation*}
C_{\pi}=C_{j e}+C_{b} \tag{6.6}
\end{equation*}
$$

namely, the approximately constant junction component $C_{j e}\left(\cong 2 C_{j e 0}\right)$, and the bias-dependent component $C_{b}\left(=\tau_{F} I_{C} / V_{T}\right)$.

- With reference to Fig. 6.1, we observe that as current enters the base terminal $B$ and progresses to the thin base region separating emitter and collector, where the
![](https://cdn.mathpix.com/cropped/2024_11_07_10da0ce153b00c68dc1dg-069.jpg?height=309&width=1133&top_left_y=1757&top_left_x=204)

FIGURE 6.3 High-frequency small-signal model for the BJT.
central transistor action takes place, it encounters some distributed resistance. This is simply the bulk resistance $r_{b}$ of the moderately-doped $p$-type base region. Being typically on the order of $10^{2} \Omega$ in monolithic BJTs, $r_{b}$ has been ignored so far, since the voltage drop it produces in response to $i_{b}$ is usually negligible compared to that produced by $r_{\pi}$. However, we will find that in general $r_{b}$ cannot be ignored in high-frequency operation, as it limits the dynamics of certain BJT configurations, particularly the CE configuration.

EXAMPLE 6.1 Find the element values of the small-signal model of the BJT of Fig. $6.4 a$ using the data of a typical high-voltage process: $\beta_{0}=150, V_{A}=80 \mathrm{~V}, r_{b}=250 \Omega ; \tau_{F}=$ $200 \mathrm{ps} ; C_{j e 0}=1.0 \mathrm{pF}, \phi_{e}=0.8 \mathrm{~V}, m_{e}=0.33 ; C_{\mu 0}=0.5 \mathrm{pF}, \phi_{c}=0.6 \mathrm{~V}, m_{c}=0.5$; $C_{s 0}=3.0 \mathrm{pF}, \phi_{s}=0.6 \mathrm{~V}$, and $m_{s}=0.5$. Show your final circuit.
![](https://cdn.mathpix.com/cropped/2024_11_07_10da0ce153b00c68dc1dg-070.jpg?height=501&width=203&top_left_y=773&top_left_x=267)
(a)
![](https://cdn.mathpix.com/cropped/2024_11_07_10da0ce153b00c68dc1dg-070.jpg?height=318&width=1087&top_left_y=956&top_left_x=506)
(b)

FIGURE 6.4 (a) Circuit of Example 6.1, and (b) the BJT's small-signal model values.

### Solution

By inspection, $I_{C} \cong I_{E}=(5-0.7) / 43=0.1 \mathrm{~mA}$. Proceeding as usual, we get $g_{m}=1 /(260 \Omega), r_{\pi}=39 \mathrm{k} \Omega$, and $r_{o}=800 \mathrm{k} \Omega$. We also have

$$
\begin{aligned}
& C_{b}=\tau_{F} g_{m}=\frac{200 \times 10^{-12}}{260} \cong 0.77 \mathrm{pF} \\
& C_{j e} \cong 2 C_{j e 0}=2.0 \mathrm{pF} \\
& C_{\pi}=C_{b}+C_{j e} \cong 2.77 \mathrm{pF}
\end{aligned}
$$

To find $C_{\mu}$ we observe that $V_{C}=5-20 \times 0.1=3 \mathrm{~V}$, so $V_{B C}=V_{B}-V_{C}=$ $0-3=-3 \mathrm{~V}$. To find $C_{s}$, assume the substrate is tied to the MNV ( -5 V ), so $V_{S C}=V_{S}-V_{C}=-5-3=-8 \mathrm{~V}$. Then,

$$
C_{\mu}=\frac{0.5}{\left(1-\frac{-3}{0.6}\right)^{0.5}} \cong 0.2 \mathrm{pF} \quad C_{s}=\frac{3}{\left(1-\frac{-8}{0.6}\right)^{0.5}} \cong 0.8 \mathrm{pF}
$$

The complete small-signal model is shown in Fig. 6.4b.

### Specification of the BJT Frequency Response

It is common practice to specify the frequency capability of a BJT in terms of the transition frequency $f_{T}$, representing the frequency at which its small-signal current gain $|\beta(j f)|$ drops to unity. This frequency is used as a figure of merit for high-speed operation, and it can either be calculated or measured, using the ac concept of Fig. 6.5. Specifically, we apply a small-signal ac current $i_{b}$ to the base, we find the ac current $i_{c}$ with the collector at ac ground, and we take the ratio $\beta=I_{c} / I_{b}$, where $I_{b}$ and $I_{c}$ are the Laplace's transforms of $i_{b}$ and $i_{c}$. Finally, we obtain $f_{T}$ as the frequency such that $\left|\beta\left(f_{T}\right)\right|=1$, or 0 dB .

Turning to the equivalent circuit of Fig. $6.5 b$, we observe that shorting the collector to ground renders $r_{o}$ and $C_{s}$ irrelevant and places $C_{\mu}$ in parallel with $C_{\pi}$. We can thus apply Ohm's law and write

$$
V_{\pi}=\left[r_{\pi} / / \frac{1}{s\left(C_{\pi}+C_{\mu}\right)}\right] I_{b}=\frac{r_{\pi} I_{b}}{1+s r_{\pi}\left(C_{\pi}+C_{\mu}\right)}
$$

where $s$ is the complex frequency. It turns out (see Exercise 6.1 below) that over the frequency range of interest the current fed forward via $C_{\mu}$ is negligible compared to $g_{m} V_{\pi}$, so we approximate

$$
I_{c} \cong g_{m} V_{\pi}=\frac{g_{m} r_{\pi}}{1+s r_{\pi}\left(C_{\pi}+C_{\mu}\right)} I_{b}
$$

Letting $g_{m} r_{\pi} \rightarrow \beta_{0}$ and solving for the ratio $I_{c} / I_{b}$, we get

$$
\beta(s)=\frac{I_{c}}{I_{b}}=\frac{\beta_{0}}{1+s r_{\pi}\left(C_{\pi}+C_{\mu}\right)}
$$

We are primarily interested in the transistor's ac steady-state response, also called the frequency response, so we let $s \rightarrow j \omega$ (or $s \rightarrow j 2 \pi f$ ) and get

$$
\begin{equation*}
\beta(j \omega)=\frac{\beta_{0}}{1+j \omega / \omega_{\beta}} \tag{6.7}
\end{equation*}
$$

where

$$
\begin{equation*}
\omega_{\beta}=\frac{1}{r_{\pi}\left(C_{\pi}+C_{\mu}\right)} \tag{6.8}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_11_07_10da0ce153b00c68dc1dg-071.jpg?height=433&width=1469&top_left_y=1646&top_left_x=200)

FIGURE 6.5 (a) Ac circuit to find $f_{T}$, and (b) its small-signal equivalent.
![](https://cdn.mathpix.com/cropped/2024_11_07_10da0ce153b00c68dc1dg-072.jpg?height=323&width=532&top_left_y=219&top_left_x=450)

FIGURE 6.6 Bode plot of $|\beta(j \omega)|$.
Since the denominator of the $\beta(s)$ vanishes for $s=-\omega_{\beta}$, causing $\beta(s)$ to blow up to infinity, $\omega_{\beta}$ is aptly called pole frequency (see Bode plots in Appendix 6A). The magnitude of the current gain is

$$
\begin{equation*}
|\beta(j \omega)|=\frac{\beta_{0}}{\sqrt{1+\left(\omega / \omega_{\beta}\right)^{2}}} \tag{6.9}
\end{equation*}
$$

and is plotted on logarithmic scales, with $\omega$ in decades (or octaves), and magnitude in decibels. The resulting plot, known as magnitude Bode plot and shown in Fig. 6.6, is of such a common form that it warrants some useful observations:

- For $\omega \ll \omega \beta$, Eq. (6.9) predicts the low-frequency asymptote

$$
\begin{equation*}
|\beta(j \omega)| \rightarrow \beta_{0} \tag{6.10}
\end{equation*}
$$

This is the frequency range over which we have been implicitly operating up to this chapter.

- For $\omega \gg \omega_{\beta}$, Eq. (6.9) predicts the high-frequency asymptote

$$
|\beta(j \omega)| \rightarrow \frac{\beta_{0}}{\omega / \omega_{\beta}}=\frac{\beta_{0} \omega_{\beta}}{\omega}
$$

Defining the gain-bandwidth product $\mathrm{GBP}=|\beta| \times \omega$, we observe that for $\omega \gg \omega_{\beta}$ we have

$$
\begin{equation*}
\mathrm{GBP}=|\beta(j \omega)| \times \omega=\beta_{0} \omega_{\beta} \tag{6.11}
\end{equation*}
$$

that is, the GBP is constant with frequency. In other words, if we pick any point on the high-frequency asymptote and take the product of its ordinate $|\beta(j \omega)|$ by its abscissa $\omega$, we always get the same value, namely, the GBP. In particular, increasing (decreasing) $\omega$ by a decade causes $|\beta(j \omega)|$ to decrease (increase) also by a decade, or 20 dB . Alternatively, an octave increase (or decrease) in $\omega$ results in a 6-dB decrease (or increase) in $|\beta(j \omega)|$.

- The frequency $\omega_{T}$ at which $|\beta(j \omega)|$ drops to unity, or 0 dB , is called the transition frequency because at this frequency the BJT ceases to provide current gain and starts attenuating, so it is no longer useful. By Eq. (6.11) we must have $1 \times \omega_{T}=$ $\beta_{0} \omega_{\beta}$. Using Eq. (6.8), along with $r_{\pi}=\beta_{0} / g_{m}$, we get

$$
\begin{equation*}
\omega_{T}=\frac{g_{m}}{C_{\pi}+C_{\mu}} \tag{6.12a}
\end{equation*}
$$

or, alternatively,

$$
\begin{equation*}
f_{T}=\frac{g_{m}}{2 \pi\left(C_{\pi}+C_{\mu}\right)} \tag{6.12b}
\end{equation*}
$$

In monolithic BJTs $f_{T}$ ranges from a few hundred MHz to tens of GHz .

- For $\omega=\omega_{\beta}$ Eq. (6.9) predicts $\left|\beta\left(j \omega_{\beta}\right)\right|=\beta_{0} / \sqrt{2}=0.707 \beta_{0}$, that is, at $\omega=\omega_{\beta}$ the magnitude $|\beta|$ is down to $70.7 \%$ of its low-frequency value $\beta_{0}$. Since $1 / \sqrt{2}=$ -3 db , the pole frequency $\omega_{\beta}$ is also called the $-3-d B$ frequency.

### Exercise 6.1

The current fed forward via $C_{\mu}$ in Fig. $6.5 b$ is $I_{\mu}=V_{\pi} /\left[1 /\left(j \omega C_{\mu}\right)\right]$. Using the fact that $C_{\mu} \ll C_{\pi}$, show that for frequencies up to at least $\omega_{T}$ we have $\left|I_{\mu}\right| \ll\left|g_{m} V_{\pi}\right|$, thus justifying the approximation $I_{c} \cong g_{m} V_{\pi}$.

If a certain BJT exhibits $|\beta|=200$ at $f=1 \mathrm{kHz}$ and $|\beta|=10$ at $f=500 \mathrm{MHz}$, find $\beta_{0}, f_{\beta}$, and $f_{T}$.

### Solution

Since 1 kHz is such a low frequency, the first datum must lie on the low-frequency asymptote, so $\beta_{0}=200$. Since the second datum is much smaller than $\beta_{0}$, it must lie on the high-frequency asymptote, where the GBP is constant. So, $f_{T}=\mathrm{GBP}=$ $10 \times 500=5 \mathrm{GHz}$. Finally, $f_{\beta}=f_{T} / \beta_{0}=5000 / 200=25 \mathrm{MHz}$.

It is instructive to take a closer look at the transition frequency $f_{T}$. Combining Eqs. (6.5), (6.6), and (6.12), we express this frequency in the insightful form

$$
\begin{equation*}
f_{T}=\frac{1 / 2 \pi}{\frac{C_{j e}+C_{\mu}}{I_{C}} V_{T}+\tau_{F}} \tag{6.13}
\end{equation*}
$$

which shows explicitly the dependence on the bias current $I_{C}$. At sufficiently low collector currents $f_{T}$ is dominated by $C_{j e}+C_{\mu}$, and it increases with $I_{C}$. For $I_{C}$ sufficiently high, $f_{T}$ saturates at

$$
\begin{equation*}
f_{T(\max )}=\frac{1}{2 \pi \tau_{F}} \tag{6.14}
\end{equation*}
$$

indicating that $\tau_{F}$ poses the ultimate limit on $f_{T}$. Figure 6.7 shows a decline in $f_{T}$ at high collector currents. This is due to the fact that $\tau_{F}$ increases with high-level injection and other high collector-current effects. ${ }^{2}$
![](https://cdn.mathpix.com/cropped/2024_11_07_10da0ce153b00c68dc1dg-074.jpg?height=395&width=898&top_left_y=216&top_left_x=450)

FIGURE 6.7 Dependence of $f_{T}$ on the bias current $I_{C}$.
Using Eq. (6.4), along with Einstein's relation $D_{n}=\mu_{n} V_{T}$, we can also write, for an $n p n$ BJT,

$$
\begin{equation*}
f_{T(\max )}=\frac{1}{\pi} \frac{\mu_{n}}{W_{B}^{2}} V_{T} \tag{6.15}
\end{equation*}
$$

(For a pnp BJT replace $\mu_{n}$ with $\mu_{p}$.) It is apparent that for fast operation a BJT should be fabricated with a very narrow base, and it should be of the npn type as electrons are 2 to 3 times more mobile than holes.

EXAMPLE 6.3 Find $f_{T}$ for the BJT of Example 6.1. How does this compare with $f_{T(\max )}$ ? Which parasitic dominates $f_{T}$ in this example? Which dominates the least?

### Solution

Equation (6.13) gives

$$
f_{T}=\frac{1 / 2 \pi}{\frac{(2+0.2) 10^{-12}}{0.1} 26+200 \times 10^{-12}}=\frac{1}{2 \pi(520+52+200) 10^{-12}}=206 \mathrm{MHz}
$$

Equation (6.14) gives

$$
f_{T(\max )}=\frac{1}{2 \pi 200 \times 10^{-12}}=796 \mathrm{MHz}
$$

It is apparent that the main culprit in this example is $C_{j e}$. This is followed by $C_{b}$, whereas $C_{\mu}$ has the least impact.

## 6.2 HIGH-FREQUENCY MOSFET MODEL

As depicted in Fig. 6.8, an integrated-circuit (IC) MOSFET presents a variety of internal capacitances: ${ }^{1}$

- The gate-channel oxide capacitance $C_{g c}$, also called the intrinsic capacitance,

$$
\begin{equation*}
C_{g c}=W L C_{o x} \tag{6.16}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_11_07_10da0ce153b00c68dc1dg-075.jpg?height=614&width=872&top_left_y=210&top_left_x=203)

FIGURE 6.8 The capacitances in a saturated monolithic $n$ MOSFET.
where $W$ is the channel width, $L$ is the distance between the inner edges of the source and drain diffusion regions, and $C_{o x}$ is the oxide capacitance per unit area. Recall from Chapter 3 that

$$
\begin{equation*}
C_{o x}=\frac{\varepsilon_{o x}}{t_{o x}}=\frac{34.5}{t_{o x}} \mathrm{fF} / \mu \mathrm{m}^{2} \tag{6.17}
\end{equation*}
$$

where $t_{o x}$ is the oxide thickness, in nm . For instance, a process with $t_{o x}=10 \mathrm{~nm}$ gives $C_{o x}=34.5 / 10=3.45 \mathrm{fF} / \mu \mathrm{m}^{2}$. The gate length as drawn on the mask before fabrication is denoted as $L_{\text {drawn }}$. During fabrication of the $n^{+}$source and drain regions via ion implantation, ions diffuse laterally, resulting in some overlap between the inner edges of these regions and the outer edges of the gate electrode. Denoting the amount of overlap as $L_{o v}$ (in PSpice this is denoted as Ld) we thus have

$$
\begin{equation*}
L=L_{d r a w n}-2 L_{o v} \tag{6.18}
\end{equation*}
$$

Typically, $L_{o v}$ is on the order of 10-20\% of $L_{\text {drawn }}$. (Note that when calculating the device transconductance parameter $k=k^{\prime}(W / L)$ we must use $L$ as given above, and also use the multiplicative factor $\left(1+\lambda v_{D S}\right)$ to account for the channel length modulation $\Delta L$. When referring to a particular fabrication process, engineers use $L$ to denote what is actually $L_{\text {drawn }}$. This is also the convention used by PSpice, where statements of the type $\mathrm{L}=1$. 0u $L d=0.15 \mathrm{u}$ imply a fabrication process with $L_{\text {drawn }}=1.0 \mu \mathrm{~m}$ and $L_{o v}=0.15 \mu \mathrm{~m}$, and thus $L=1-2 \times 0.15=$ $0.7 \mu \mathrm{~m}$. For consistency with previous chapters we shall continue using $L$ to denote the distance between the inner edges of the source and drain regions.)

- The channel-body depletion capacitance $C_{c b}$. In saturation operation, which is the region of greatest interest in analog applications, this capacitance is shielded from the gate by the inversion layer and therefore plays a negligible role.
- The overlap capacitances at the source and drain edges of the gate electrode, each of which is

$$
\begin{equation*}
C_{o v} \cong W L_{o v} C_{o x} \tag{6.19}
\end{equation*}
$$

- The junction capacitances $C_{s b}$ and $C_{d b}$ between the $n^{+}$regions of the source and drain, and the $p^{-}$body, also called bulk or substrate. As we know, these capacitances take on the forms

$$
\begin{equation*}
C_{s b}=\frac{C_{s b 0}}{\left(1+v_{S B} / \phi_{0}\right)^{m}} \quad C_{d b}=\frac{C_{d b 0}}{\left(1+v_{D B} / \phi_{0}\right)^{m}} \tag{6.20}
\end{equation*}
$$

The role played by each of the above capacitances varies with the operating conditions of the MOSFET. ${ }^{2}$ In analog applications the FETs are operated in saturation, where the channel takes on the familiar tapered form (see Fig. 6.8), where $\Delta L$ is the SCL portion extending into the channel side. This asymmetry causes $(2 / 3)$ of $C_{g c}$ to go to the source side, and none to the drain side. ${ }^{2}$ Based on these considerations, the complete high-frequency model of the MOSFET is as in Fig. 6.9. As usual, smallsignal voltages and currents, now frequency-dependent, are represented in terms of their Laplace's transforms (upper-case letters with lower-case subscripts). We shall see that the capacitances playing the biggest roles in the frequency response of a FET are $C_{g s}$ and $C_{g d}$, which take on the forms

$$
\begin{equation*}
C_{g s} \cong \frac{2}{3} W L C_{o x}+W L_{o v} C_{o x} \quad C_{g d} \cong W L_{o v} C_{o x} \tag{6.21}
\end{equation*}
$$

The model includes also the stray capacitance $C_{g b}$, not immediately obvious from the structure of Fig. 6.8, to account for the capacitive coupling between the gate interconnections and the underlying substrate outside the active device area. In today's technology, the various capacitances appearing in a MOSFET's small-signal model are in the femtofarad range $\left(1 \mathrm{fF}=10^{-15} \mathrm{~F}\right)$.
![](https://cdn.mathpix.com/cropped/2024_11_07_10da0ce153b00c68dc1dg-076.jpg?height=480&width=1041&top_left_y=1632&top_left_x=447)

FIGURE 6.9 Complete high-frequency small-signal model for the MOSFET.
![](https://cdn.mathpix.com/cropped/2024_11_07_10da0ce153b00c68dc1dg-077.jpg?height=304&width=769&top_left_y=219&top_left_x=207)

FIGURE 6.10 High-frequency small-signal model for a MOSFET with body and source tied together.

The model of Fig. 6.9 is certainly intimidating for hand calculations-though not necessarily so for PSpice simulations. In the cases in which body and source are tied together, the model simplifies as in Fig. 6.10, where the expression for $C_{g s}$ in Eq. (6.21) is now changed as

$$
\begin{equation*}
C_{g s} \cong \frac{2}{3} W L C_{o x}+W L_{o v} C_{o x}+C_{g b} \tag{6.22}
\end{equation*}
$$

### Specification of the MOSFET Frequency Response

As in the BJT case, the frequency capability of a MOSFET is expressed in terms of the transition frequency $f_{T}$ at which the magnitude of its small-signal current gain drops to unity. As we know, no current flows into the gate terminal at dc. However, as the operating frequency is increased, the stray capacitances associated with the gate terminal draw increasing current, thus decreasing the current gain of the FET. The transition frequency represents a figure of merit for high-frequency operation, and it can either be calculated or measured, using the ac concept of Fig. 6.11a. Specifically, we apply a small-signal ac current $I_{g}$ to the gate terminal, we find the current $I_{d}$ drawn by the FET with the drain at ac ground, we take the ratio $I_{d} / I_{g}$, and we finally determine the frequency $\omega_{T}$ at which $\left|I_{d} / I_{g}\right|=1$, or 0 dB .
![](https://cdn.mathpix.com/cropped/2024_11_07_10da0ce153b00c68dc1dg-077.jpg?height=395&width=1189&top_left_y=1688&top_left_x=192)

FIGURE 6.11 (a) Ac circuit to find $f_{T}$, and (b) its small-signal equivalent.

Turning to the equivalent circuit of Fig. 6.11 b , we note that shorting the drain to ground renders $r_{o}$ and $C_{d b}$ irrelevant, and places $C_{g d}$ in parallel with $C_{g s}$. Moreover, with body and source tied together, $C_{g s}$ is given by Eq. (6.20). Applying the generalized Ohm's law,

$$
V_{g s}=\frac{1}{s\left(C_{g s}+C_{g d}\right)} I_{g}
$$

As in BJT case, one can verify that over our frequency range of interest, the current fed forward via $C_{g d}$ is negligible compared to that of the dependent source, so we approximate

$$
I_{d} \cong g_{m} V_{g s}=\frac{g_{m}}{s\left(C_{g s}+C_{g d}\right)} I_{g}
$$

Taking the ratio $I_{d} / I_{g}$ and letting $s \rightarrow j \omega$, we get

$$
\begin{equation*}
\frac{I_{d}}{I_{g}}=\frac{1}{j \omega / \omega_{T}} \tag{6.23}
\end{equation*}
$$

where

$$
\begin{equation*}
\omega_{T}=\frac{g_{m}}{C_{g s}+C_{g d}} \tag{6.24a}
\end{equation*}
$$

or, alternatively,

$$
\begin{equation*}
f_{T}=\frac{g_{m}}{2 \pi\left(C_{g s}+C_{g d}\right)} \tag{6.24b}
\end{equation*}
$$

(Note the formal similarity with Eq. (6.12) of the BJT.) Since $g_{m}$ depends on the bias current $I_{D}$, so does $f_{T}$. Figure 6.12 shows the Bode plot of the MOSFET's current gain. At low frequencies this gain tends to infinity because the gate draws no dc current. But, at $f=f_{T}$, the current entering the gate equals that drawn by the drain. In current monolithic MOSFETs, $f_{T}$ ranges from hundreds of MHz to tens of GHz .
![](https://cdn.mathpix.com/cropped/2024_11_07_10da0ce153b00c68dc1dg-078.jpg?height=384&width=523&top_left_y=1682&top_left_x=450)

FIGURE 6.12 Bode plot of a MOSFET's current gain.

### Exercise 6.2

The current fed forward via $C_{g d}$ in Fig. $6.11 b$ is $I_{g d}=V_{g s} /\left[1 /\left(j \omega C_{g d}\right)\right]$. Exploiting the fact that $C_{g d} \ll C_{g s}$, show that for frequencies up to at least $\omega_{T}$ we have $\left|I_{g d}\right| \ll\left|g_{m} V_{g s}\right|$, thus justifying the approximation $I_{d} \cong g_{m} V_{g s}$.
(a) Assuming $V_{G S}$ has been adjusted for $I_{D}=100 \mu \mathrm{~A}$ in the circuit of Fig. 6.13a, find the element values in the small-signal model of the MOSFET, and show the final circuit. The process parameters are: $k^{\prime}=250 \mu \mathrm{~A} / \mathrm{V}^{2}, C_{o x}=4 \mathrm{fF} / \mu \mathrm{m}^{2}$, $\lambda^{\prime}=0.02 \mu \mathrm{~m} / \mathrm{V}, \gamma=0.5 \mathrm{~V}^{1 / 2}, \phi_{p}=-0.3 \mathrm{~V}, \phi_{0}=0.6 \mathrm{~V}$, and $m=0.5$. The device parameters are $W=10 \mu \mathrm{~m}, L=1.0 \mu \mathrm{~m}, L_{o v}=25 \mathrm{~nm}, C_{s b 0}=C_{d b 0}=10 \mathrm{fF}$, and $C_{g b}=5 \mathrm{fF}$.
(b) Estimate $f_{T}$.
![](https://cdn.mathpix.com/cropped/2024_11_07_10da0ce153b00c68dc1dg-079.jpg?height=546&width=1438&top_left_y=875&top_left_x=244)

FIGURE 6.13 (a) Circuit of Example 6.2, and (b) the MOSFET's small-signal model values.

### Solution

(a) The device transconductance parameter is $k=k^{\prime}(W / L)=0.25(10 / 1)=$ $2.5 \mathrm{~mA} / \mathrm{V}$, and the overdrive voltage is $V_{O V}=\sqrt{2 I_{D} / k}=\sqrt{2 \times 0.1 / 2.5}=$ 0.283 V . Since $V_{S}=10 \times 0.1=1 \mathrm{~V}$ and $V_{D S}=3-1=2 \mathrm{~V}$, it follows that $V_{D S}>V_{O V}$, indicating a saturated FET. We have

$$
\begin{aligned}
\lambda & =\lambda^{\prime} / L=0.02 / 1=0.02 \mathrm{~V}^{-1} \\
r_{o} & =\frac{1}{\lambda I_{D}}=\frac{1}{0.02 \times 0.1}=500 \mathrm{k} \Omega \\
g_{m} & =\sqrt{2 k I_{D}}=\sqrt{2 \times 2.5 \times 0.1}=\frac{1}{1.41 \mathrm{k} \Omega} \\
g_{m b} & =\frac{\gamma g_{m}}{2 \sqrt{V_{S B}+2\left|\phi_{p}\right|}}=\frac{0.5 / 1.41}{2 \sqrt{1+2 \times 0.3}}=\frac{1}{7.16 \mathrm{k} \Omega}
\end{aligned}
$$

### EXAMPLE 6.4

$$
\begin{aligned}
& C_{s b}=\frac{C_{s b 0}}{\left(1+v_{S B} / \phi_{0}\right)^{m}}=\frac{10}{(1+1 / 0.6)^{0.5}} \cong 6 \mathrm{fF} \\
& C_{d b}=\frac{C_{d b 0}}{\left(1+v_{D B} / \phi_{0}\right)^{m}}=\frac{10}{(1+3 / 0.6)^{0.5}} \cong 4 \mathrm{fF} \\
& C_{g s} \cong \frac{2}{3} W L C_{o x}+W L_{o v} C_{o x}=\frac{2}{3} 10 \times 1 \times 4+10 \times 0.025 \times 4 \cong 27+1=28 \mathrm{fF} \\
& C_{g d}=1 \mathrm{fF}
\end{aligned}
$$

The complete small-signal model is shown in Fig. 6.13b.
(b) Find $f_{T}$ using Eq. (6.24b), but with $C_{g s}$ as in Eq. (6.22), namely, $C_{g s}=27+$ $1+5=33 \mathrm{fF}$. Thus

$$
f_{T}=\frac{g_{m}}{2 \pi\left(C_{g s}+C_{g d}\right)}=\frac{1 /\left(1.41 \times 10^{3}\right)}{2 \pi(33+1) 10^{-15}}=3.31 \mathrm{GHz}
$$

As in the BJT case, it is instructive to take a closer look at $f_{T}$, which we now express as

$$
\begin{equation*}
f_{T}=\frac{\sqrt{2 k I_{D}}}{2 \pi\left(C_{g s}+C_{g d}\right)} \tag{6.25}
\end{equation*}
$$

Clearly, the $f_{T}$ of a MOSFET increases with the square root of the bias current $I_{D}$. By contrast, at sufficiently low bias currents, the $f_{T}$ of a BJT increases in direct proportion to $I_{C}$. This increase continues until it saturates at $f_{T}=1 /\left(2 \pi \tau_{F}\right)$ due to the fact that current in a BJT is the result of minority-charge diffusion. By contrast, the current of a FET is by majority-charge drift, so the limiting factors in this case are exclusively the stray capacitances.

Of all capacitances in a MOSFET, the dominant one is usually the first component in the right-hand side of Eq. (6.21). If we approximate Eq. (6.24b) as $f_{T} \cong$ $g_{m} /\left(2 \pi C_{g s}\right)$ with $C_{g s} \cong(2 / 3) W L C_{o x}$, then

$$
f_{T} \cong \frac{g_{m}}{2 \pi(2 / 3) W L C_{o x}}=\frac{0.75}{\pi} \frac{g_{m}}{W L C_{o x}}
$$

Letting $g_{m}=k V_{O V}=\left[(W / L) \mu_{n} C_{o x}\right] V_{O V}$ and simplifying, we can finally place an upper limit on the $f_{T}$ of a $n$ MOSFET for a given $V_{O V}$ by writing

$$
\begin{equation*}
f_{T(\max )}=\frac{0.75}{\pi} \frac{\mu_{n}}{L^{2}} V_{O V} \tag{6.26}
\end{equation*}
$$

(For a $p$ MOSFET replace $\mu_{n}$ with $\mu_{p}$.) It is apparent that for fast operation a MOSFET should have a very short channel, and it should be of the $n$ type as electrons are 2 to 3 times as mobile as the holes of a $p$-type. Note the striking similarity to the BJT limit of Eq. (6.15), except for the replacement of the (fixed) thermal voltage $V_{T}$ by the (user-imposed) overdrive voltage $V_{O V}$ : the higher $V_{O V}$ the faster the MOSFET is likely to operate.

## 6.3 FREQUENCY RESPONSE OF CE/CS AMPLIFIERS

With the high-frequency models in hand, we are now eager to investigate the frequency response of the most popular transistor configurations. The first to come to mind are the common-emitter (CE) and common-source (CS) configurations, the workhorses of voltage amplification. Their ac equivalents, shown in Figs. $6.14 a$ and $6.15 a$, could refer to any of the discrete CE realizations of Chapters 2 and 3 , so long as the operating frequencies are such that the ac coupling and bypassing capacitors act as ac short circuits. But, they could also represent the differential-mode half-circuits of the dc-coupled EC and SC pairs of Chapter 4. Consequently, the analysis we are about to undertake is quite general.

Replacing the transistors with their high-frequency small-signal models we obtain the ac circuits of $6.14 b$ and $6.15 b$. (For the time being we are deliberately ignoring the output-node parasitics, namely, $C_{s}$ for the BJT and $C_{d b}$ for the FET, so we can focus on the two remaining capacitances and develop valuable intuition in the process. These parasitics will be taken up later in this section.) The two circuits exhibit inevitable differences, but also formal similarities. In fact, using simple circuit transformations, we can reduce them to a common form, and then perform a single analysis on this common circuit to avoid duplication (mercifully, opportunities of this type will arise often as we proceed).

- Turning first to the BJT equivalent of Fig. $6.14 b$, we simplify its left side by applying Thévenin's theorem, and its right side by combining the two parallel resistances into a single one,

$$
\begin{equation*}
V_{i}=\frac{r_{\pi}}{R_{s i g}+r_{b}+r_{\pi}} V_{s i g} \quad R_{1}=\left(R_{s i g}+r_{b}\right) / / r_{\pi} \quad R_{2}=R_{C} / / r_{o} \tag{6.27}
\end{equation*}
$$

After this, the circuit of Fig. $6.14 b$ reduces to that of Fig. 6.16, where the inputnode capacitance $C_{1}$ plays the role of $C_{\pi}$, the feedback capacitance $C_{f}$ plays that of $C_{\mu}$, and $V_{1}$ that of $V_{\pi}$.

- Likewise, turning to the MOS equivalent of Fig. $6.15 b$ and letting

$$
\begin{equation*}
V_{i}=V_{s i g} \quad R_{1}=R_{s i g} \quad R_{2}=R_{D} / / r_{o} \tag{6.28}
\end{equation*}
$$

we reduce it to the same equivalent of Fig. 6.16, where now the input-node capacitance $C_{1}$ plays the role of $C_{g s}$, the feedback capacitance $C_{f}$ plays that of $C_{g d}$, and $V_{1}$ that of $V_{g s}$.
![](https://cdn.mathpix.com/cropped/2024_11_07_10da0ce153b00c68dc1dg-081.jpg?height=471&width=1373&top_left_y=1648&top_left_x=194)

FIGURE 6.14 (a) Ac equivalent of the CE amplifier, and (b) its high-frequency small-signal model.
![](https://cdn.mathpix.com/cropped/2024_11_07_10da0ce153b00c68dc1dg-082.jpg?height=449&width=1112&top_left_y=184&top_left_x=444)

FIGURE 6.15 (a) Ac equivalent of the CS amplifier, and (b) its high-frequency small-signal model.

Let us investigate the common circuit of Fig. 6.16, and then adapt our results to the BJT and the FET circuits of Figs. 6.14 and 6.15 with the aid of Eqs. (6.27) and (6.28), respectively. The analysis of this circuit is facilitated further if we take advantage of the Miller effect, to be discussed next. The results, though not exact, will prove quite insightful, as we shall see.
![](https://cdn.mathpix.com/cropped/2024_11_07_10da0ce153b00c68dc1dg-082.jpg?height=285&width=677&top_left_y=1083&top_left_x=448)

FIGURE 6.16 General model for the CE and CS amplifiers.

### The Miller Effect

With $C_{f}$ absent, the circuit of Fig. 6.16 gives $V_{o}=-g_{m} R_{2} V_{1}$, indicating that we can model its portion from $V_{1}$ to $V_{o}$ with an inverting amplifier as in Fig. 6.17. With $C_{f}$ present there will be some loading at the output of the amplifier; however, actual examples below will reveal that loading is negligible over the frequency range of
![](https://cdn.mathpix.com/cropped/2024_11_07_10da0ce153b00c68dc1dg-082.jpg?height=276&width=1053&top_left_y=1799&top_left_x=446)

FIGURE 6.17 Illustrating the Miller effect.
interest. We now wish to find the equivalent impedance $Z_{e q}$ seen looking toward the right by the $V_{1}$ source of Fig. 6.17. By Ohm's law, the current supplied by $V_{1}$ is

$$
\begin{equation*}
I_{f}=\frac{V_{1}-V_{o}}{1 /\left(s C_{f}\right)} \cong s C_{f}\left[V_{1}-\left(-g_{m} R_{2} V_{1}\right)\right]=s C_{f}\left(1+g_{m} R_{2}\right) V_{1}=s C_{M} V_{1} \tag{6.29}
\end{equation*}
$$

Where

$$
\begin{equation*}
C_{M}=C_{f}\left(1+g_{m} R_{2}\right) \tag{6.30}
\end{equation*}
$$

Letting $Z_{e q}=V_{1} / I_{f}=1 /\left(s C_{M}\right)$, we conclude that the block consisting of the amplifier and its feedback capacitance appears to the $V_{1}$ source as a mere equivalent capacitance $C_{M}$ toward ground. This capacitance is $\left(1+g_{m} R_{2}\right)$ times as large as $C_{f}$ This intriguing phenomenon is called the Miller effect for John M. Miller, who first described it in 1920. The term $\left(1+g_{m} R_{2}\right)$ is called the Miller multiplier and $C_{M}$ the Miller capacitance. In general, $C_{M} \gg C_{f}$

To better understand the Miller effect, let us investigate the process of changing the voltage across a $1-\mathrm{pF}$ capacitor from 0 V to 1 mV , first for the case in which the capacitor is grounded, then for the case in which it is placed in the feedback path of an amplifier with a gain of $-99 \mathrm{~V} / \mathrm{V}$. Let us compare the two cases and comment.

### Solution

With reference to Fig. $6.18 a$ we note that applying $\Delta V=1 \mathrm{mV}$ causes a charge transfer of $\Delta Q=C \Delta V=10^{-12} \times 10^{-3}=10^{-15} \mathrm{C}=1 \mathrm{fC}$. Consider next the case in which the (initially discharged) capacitor is in the feedback path of the amplifier as in Fig. 6.18b. As we raise the left plate from 0 V to 1 mV , the amplifier will lower the right plate from 0 V to -99 mV , causing a $100-\mathrm{mV}$ total change across the capacitor. The charge transfer is now $\Delta Q=C \Delta V=10^{-2} \times\left(100 \times 10^{-3}\right)=$ 100 fC . Even though the physical capacitance of Fig. $6.18 b$ is still 1 pF , the charge transfer is 100 times that of Fig. 6.18a. Yet, the applied voltage is still 1 mV . So if we regroup the terms as $\Delta Q=\left(10^{-12} \times 100\right) \times 10^{-3}=(100 \mathrm{pF})(1 \mathrm{mV})=$ 100 fC , we can state that things go as if the input source were driving a fictitious capacitance 100 times as large, or $C_{M}=100 \mathrm{pF}$ !
![](https://cdn.mathpix.com/cropped/2024_11_07_10da0ce153b00c68dc1dg-083.jpg?height=262&width=1476&top_left_y=1715&top_left_x=241)
(a)
(b)

FIGURE 6.18 Quantitative illustration of the Miller effect.

### Analysis Using the Miller Approximation

Thanks to the Miller effect, the circuit of Fig. 6.16 simplifies as in Fig 6.19a. In fact, we can combine the two parallel capacitances into a single total capacitance $C_{t}$,

$$
\begin{equation*}
C_{t}=C_{1}+C_{M} \tag{6.31}
\end{equation*}
$$

and work with the even simpler circuit of Fig. 6.19b. Using the ac voltage divider formula,

$$
V_{o}=-g_{m} V_{1} R_{2}=-g_{m} R_{2} \frac{1 / s C_{t}}{R_{1}+1 / s C_{t}} V_{i}=\frac{-g_{m} R_{2}}{1+s R_{1} C_{t}} V_{i}
$$

so the voltage gain of the circuit is

$$
\begin{equation*}
a(s)=\frac{V_{o}}{V_{i}}=\frac{-g_{m} R_{2}}{1+s R_{1} C_{t}} \tag{6.32}
\end{equation*}
$$

The value of $s$ that makes the denominator vanish and therefore causes $a(s)$ to blow up to infinity is referred to as a pole. This value is

$$
\begin{equation*}
s=-\frac{1}{R_{1} C_{t}} \tag{6.33}
\end{equation*}
$$

indicating a real and negative pole. Letting $s \rightarrow j \omega$ in Eq. (6.32) gives the frequency response, which we express in the standard for of Eq. (6A.1) of Appendix 6A as

$$
\begin{equation*}
a(j \omega)=\frac{a_{0}}{1+j \omega / \omega_{p}} \tag{6.34}
\end{equation*}
$$

where

$$
\begin{equation*}
a_{0}=-g_{m} R_{2} \tag{6.35a}
\end{equation*}
$$

is the value of $a$ in the limit $\omega \rightarrow 0$, aptly called the low-frequency gain, and

$$
\begin{equation*}
\omega_{p}=\frac{1}{R_{1} C_{t}} \tag{6.35b}
\end{equation*}
$$

is called the pole frequency.
![](https://cdn.mathpix.com/cropped/2024_11_07_10da0ce153b00c68dc1dg-084.jpg?height=341&width=1469&top_left_y=1741&top_left_x=172)

FIGURE 6.19 Equivalent-circuit simplifications using the Miller approximation.
![](https://cdn.mathpix.com/cropped/2024_11_07_10da0ce153b00c68dc1dg-085.jpg?height=347&width=548&top_left_y=207&top_left_x=210)

FIGURE 6.20 Magnitude gain plot for the circuit of Fig. 6.19b.

The magnitude Bode plot is shown in Fig. 6.20 (see also Bode plots in Appendix 6A). It is instructive to justify this plot using physical insight. With reference to Fig. 6.19b, we observe that the frequency response is governed by the ac voltage divider formed by $C_{t}$ with $R_{1}$, the equivalent resistance seen by $C_{t}$ itself. The impedance presented by $C_{t}$ is $Z_{t}(j \omega)=1 /\left(j \omega C_{t}\right)$, and depending on how its magnitude $\left|Z_{t}(j \omega)\right|=1 /\left(\omega C_{t}\right)$ compares with $R_{1}$, we have three significant cases:

- At low frequencies we have $\left|Z_{t}(\omega)\right| \gg R_{1}$, indicating that $C_{t}$ approximates an open circuit compared to $R_{1}$. Consequently, $V_{1} \rightarrow V_{i}$, and thus $|a| \rightarrow a_{0}$. This is the situation we have been dealing with before embarking upon the present chapter.
- At high frequencies we have $\left|Z_{t}(\omega)\right| \ll R_{\mathrm{l}}$, indicating that $C_{t}$ now approximates a short circuit compared to $R_{1}$. Consequently, $V_{1} \rightarrow 0$, and $|a|$ rolls off with frequency, as shown.
- The borderline between the two limiting cases occurs when $\omega=\omega_{p}$. Rewriting Eq. (6.35b) as $1 /\left(\omega_{p} C_{t}\right)=R_{1}$, we see that at this frequency we have

$$
\begin{equation*}
\left|Z_{t}\left(\omega_{p}\right)\right|=R_{1} \tag{6.36}
\end{equation*}
$$

We now have a physical interpretation for $\omega_{p}$ : this is the frequency at which the capacitance's impedance equals, in magnitude, the equivalent resistance seen by the capacitance itself. In the MOS case of Fig. 6.15 this resistance is simply $R_{s i g}$, but in the bipolar case of Fig. 6.14 it is $r_{\pi} /\left(R_{s i g}+r_{b}\right)$. A circuit designer will always use physical insight to check the results of mathematical derivations as well as to develop a feel for the workings of the circuit at hand.

- Because of the gain roll-off with frequency, an amplifier is in effect a lowpass filter, this being the reason why $\omega_{p}$ is also variously known as corner frequency, cutoff frequency, or also break frequency. At $\omega=\omega_{p},\left|V_{1}\right|$ is down to $1 / \sqrt{2}(=0.707$, or $-3-\mathrm{dB})$ of its low-frequency value, so $\omega_{p}$ is also called the $-3-d B$ frequency. Since the power of an ac signal is proportional to the square of its magnitude, another name of $\omega_{p}$ is half-power frequency. The gain-bandwidth product is

$$
\begin{equation*}
\mathrm{GBP}=\left|a_{0}\right| \times f_{p} \tag{6.37}
\end{equation*}
$$

We are now ready to apply our results to the specific circuits of Figs. 6.14 and 6.15. Turning first to the common-emitter (CE) case, we combine Eqs. (6.27) and (6.35) to write

$$
\begin{equation*}
a_{0(\mathrm{BJT})}=\left.\frac{V_{o}}{V_{s i g}}\right|_{\omega \rightarrow 0}=\frac{r_{\pi}}{R_{s i g}+r_{b}+r_{\pi}}\left[-g_{m}\left(R_{C} / / r_{o}\right)\right] \tag{6.38a}
\end{equation*}
$$

$$
\begin{equation*}
\omega_{p(\mathrm{BJT})}=\frac{1}{\left\{r_{\pi} / /\left(R_{s i g}+r_{b}\right)\right\} \times\left\{C_{\pi}+C_{\mu}\left[1+g_{m}\left(R_{C} / / r_{o}\right)\right]\right\}} \tag{6.38b}
\end{equation*}
$$

Turning next to the common-source (CS) case, we combine Eqs. (6.28) and (6.35) to write

$$
\begin{gather*}
a_{0(\mathrm{FET})}=\left.\frac{V_{o}}{V_{s i g}}\right|_{\omega \rightarrow 0}=-g_{m}\left(R_{D} / / r_{o}\right)  \tag{6.39a}\\
\omega_{p(\mathrm{FET})}=\frac{1}{R_{s i g}\left\{C_{g s}+C_{g d}\left[1+g_{m}\left(R_{D} / / r_{o}\right)\right]\right\}} \tag{6.39b}
\end{gather*}
$$

To develop a better feel, let us look at some actual examples.

EXAMPLE 6.6 Let the CE amplifier of Fig. 6.14 use a BJT with $\beta_{0}=200, V_{A}=50 \mathrm{~V}, r_{b}=$ $200 \Omega$, and $C_{\mu}=0.5 \mathrm{pF}$. The BJT is biased at $I_{C}=1 \mathrm{~mA}$, where it exhibits $f_{T}=$ 500 MHz . Moreover, let $R_{s i g}=1 \mathrm{k} \Omega$ and $R_{C}=5 \mathrm{k} \Omega$.
(a) Estimate the amplifier's low-frequency gain as well as its $-3-\mathrm{dB}$ frequency. What is the gain-bandwidth product of this amplifier?
(b) Verify that loading of the output node by the feedback capacitance is negligible over the frequency range of interest $\left(f \leq f_{p}\right)$, thus validating the Miller approximation.

### Solution

(a) Proceeding as usual, we find $g_{m}=1 /(26 \Omega), r_{\pi}=5.2 \mathrm{k} \Omega$, and $r_{o}=50 \mathrm{k} \Omega$. Moreover,

$$
\begin{aligned}
& R_{1}=r_{\pi} / /\left(R_{s i g}+r_{b}\right)=5.2 / /(1+0.2)=0.975 \mathrm{k} \Omega \\
& R_{2}=R_{C} / / r_{o}=5 / / 50=4.55 \mathrm{k} \Omega
\end{aligned}
$$

The low-frequency gain is

$$
\begin{aligned}
a_{0} & =\frac{r_{\pi}}{R_{s i g}+r_{b}+r_{\pi}}\left(-g_{m} R_{2}\right)=\frac{5.2}{1+0.2+5.2}(-4.55 / 0.026) \\
& \cong 0.81 \times(-175)=-142 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$

By Eq. (6.12b) we have

$$
C_{\pi}=\frac{g_{m}}{2 \pi f_{T}}-C_{\mu}=\frac{1 / 26}{2 \pi \times 500 \times 10^{6}}-0.5 \times 10^{-12} \cong 12 \mathrm{pF}
$$

The Miller capacitance is

$$
C_{M}=C_{\mu}\left[1+g_{m}\left(R_{C} / / r_{o}\right)\right]=0.5 \times 10^{-12}[1+175]=88 \mathrm{pF}
$$

indicating a Miller multiplier of 176. The total capacitance is thus

$$
C_{t}=C_{\pi}+C_{M}=12+88=100 \mathrm{pF}
$$

Clearly, the Miller capacitance plays a dominant role in this amplifier. Together, $R_{1}$ and $C_{t}$ create a pole frequency at

$$
f_{p}=\frac{1}{2 \pi R_{1} C_{t}}=\frac{1}{2 \pi \times 975 \times 100 \times 10^{-12}}=1.63 \mathrm{MHz}
$$

The gain-bandwidth product is

$$
\text { GBP }=\left|a_{0}\right| \times f_{p}=142 \times 1.63 \cong 230 \mathrm{MHz}
$$

(b) By Eq. (6.29), the current fed forward via $C_{\mu}$ is maximized at the upper edge of the frequency band of interest, where

$$
I_{f}\left(j f_{p}\right) \cong j 2 \pi f_{p} C_{M} V_{\pi}=j 2 \pi \times 1.63 \times 10^{6} \times 88 \times 10^{-12} V_{\pi}=j V_{\pi} /(1110 \Omega)
$$

On the other hand, the current drawn by the dependent source is

$$
g_{m} V_{\pi}=V_{\pi} /(26 \Omega)
$$

The ratio of the two currents is thus

$$
\frac{\left|I_{f}\left(j f_{p}\right)\right|}{\left|g_{m} V_{\pi}\right|}=\frac{26}{1110} \ll 1
$$

This confirms the validity of the approximation $V_{o} \cong-g_{m} R_{2} V_{\pi}$ for the BJT.

Repeat Example 6.6, but for the CS amplifier of Fig. 6.15. Assume the MOSFET has $k=8 \mathrm{~mA} / \mathrm{V}^{2}, \lambda=1 /(50 \mathrm{~V})$, and $C_{g d}=0.1 \mathrm{pF}$, and is biased at $I_{D}=1 \mathrm{~mA}$, where it exhibits $f_{T}=500 \mathrm{MHz}$. Moreover, let $R_{s i g}=10 \mathrm{k} \Omega$ and $R_{D}=5 \mathrm{k} \Omega$.

### Solution

(a) Proceeding as usual we find $g_{m}=4 \mathrm{~mA} / \mathrm{V}$ and $r_{o}=50 \mathrm{k} \Omega$, so the lowfrequency gain is

$$
a_{0}=-g_{m}\left(R_{D} / / r_{o}\right)=-4(5 / / 50)=-4 \times 4.55=-18.2 \mathrm{~V} / \mathrm{V}
$$

By Eq. (6.24b) we have

$$
C_{g s}=\frac{g_{m}}{2 \pi f_{T}}-C_{g d}=\frac{4 \times 10^{-3}}{2 \pi 500 \times 10^{6}}-0.1 \times 10^{-12} \cong 1.17 \mathrm{pF}
$$

EXAMPLE 6.7
-

The Miller capacitance is

$$
C_{M}=C_{g d}\left[1+g_{m}\left(R_{D} / / r_{o}\right)\right]=0.1 \times 10^{-12}[1+18.2] \cong 1.92 \mathrm{pF}
$$

indicating a Miller multiplier of 19.2. (In general, this multiplier is lower in FETs than in BJTs because a FET has notoriously a lower $g_{m}$.) The total capacitance is thus

$$
C_{t}=C_{g s}+C_{M}=1.17+1.92=3.09 \mathrm{pF}
$$

so the Miller capacitance plays a dominant role also in this amplifier. The resistance seen by $C_{t}$ is now $R_{s i g}$. Together, they create a pole frequency at

$$
f_{p}=\frac{1}{2 \pi R_{s i g} C_{t}}=\frac{1}{2 \pi \times 10^{4} \times 3.09 \times 10^{-12}}=5.15 \mathrm{MHz}
$$

The gain-bandwidth product is

$$
\mathrm{GBP}=\left|a_{0}\right| \times f_{p}=18.2 \times 5.2 \cong 94 \mathrm{MHz}
$$

(b) By Eq. (6.29), the current fed forward via $C_{g d}$ at the upper edge of the frequency band of interest is

$$
I_{f}\left(j f_{p}\right) \cong j 2 \pi f_{p} C_{M} V_{g s}=j 2 \pi \times 5.2 \times 10^{6} \times 1.92 \times 10^{-12} V_{g s}=j V_{g s} /(16 \mathrm{k} \Omega)
$$

whereas the current drawn by the dependent source is

$$
g_{m} V_{g s}=V_{g s} /(0.25 \mathrm{k} \Omega)
$$

Consequently, the ratio of the two currents is

$$
\frac{\left|I_{f}\left(j f_{p}\right)\right|}{\left|g_{m} V_{g s}\right|}=\frac{0.25}{16} \ll 1
$$

thus confirming the validity of the approximation $V_{o} \cong-g_{m} R_{2} V_{g s}$ for the MOSFET.

### A More Accurate Analysis

To assess the accuracy of the Miller approximation and also to gain additional insight into circuit behavior, let us perform the exact analysis of the small-signal circuit of Fig. 6.16. Since we are at it, we may as well generalize by including also the outputnode capacitance $C_{2}$, as in Fig. 6.21. As we know, the collector of a monolithic BJT exhibits the collector-to-substrate capacitance $C_{s}$, and the drain of a FET exhibits the drain-to-body capacitance $C_{d b}$. Moreover, in actual application, the output node is likely to be loaded by an external capacitance $C_{L}$, so, in general, $C_{2}=C_{s}+C_{L}$ for the BJT, and $C_{2}=C_{d b}+C_{L}$ for the FET.

Applying KCL at the node to the left of $C_{f}$ gives

$$
\frac{V_{i}-V_{1}}{R_{1}}=\frac{V_{1}}{1 /\left(s C_{1}\right)}+\frac{V_{1}-V_{o}}{1 /\left(s C_{f}\right)}
$$

![](https://cdn.mathpix.com/cropped/2024_11_07_10da0ce153b00c68dc1dg-089.jpg?height=283&width=682&top_left_y=206&top_left_x=204)

FIGURE 6.21 Ac circuit for a more accurate analysis of the CE/CS amplifiers.

Likewise, KCL at the node to the right of $C_{f}$ gives

$$
\frac{V_{1}-V_{o}}{1 / s C_{f}}=g_{m} V_{1}+\frac{V_{o}}{R_{2}}+\frac{V_{o}}{1 / s C_{2}}
$$

Eliminating $V_{1}$ and solving for the ratio $V_{o} / V_{i}$ we get, after a bit of algebraic labor,

$$
\begin{align*}
a(s) & =\frac{V_{o}}{V_{i}} \\
& =\frac{\left(-g_{m} R_{2}\right) \times\left(1-s C_{f} / g_{m}\right)}{1+s\left\{R_{1}\left[C_{1}+C_{f}\left(1+g_{m} R_{2}\right)\right]+R_{2}\left(C_{f}+C_{2}\right)\right\}+s^{2} R_{1} R_{2}\left(C_{1} C_{f}+C_{1} C_{2}+C_{f} C_{2}\right)} \tag{6.40}
\end{align*}
$$

The denominator is a quandratic polynomial in $s$, so $a(s)$ admits two poles. Denoting the corresponding pole frequencies as $\omega_{1}$ and $\omega_{2}$, we express gain more concisely in the standard form of Eq. (6A.1) in the Appendix,

$$
\begin{equation*}
a(s)=a_{0} \frac{1-s / \omega_{0}}{\left(1+s / \omega_{1}\right)\left(1+s / \omega_{2}\right)} \tag{6.41}
\end{equation*}
$$

where

$$
\begin{equation*}
a_{0}=-g_{m} R_{2} \tag{6.42}
\end{equation*}
$$

is the familiar low-frequency gain, and

$$
\begin{equation*}
\omega_{0}=\frac{g_{m}}{C_{f}} \tag{6.43}
\end{equation*}
$$

is the zero frequency of $a(s)$. Physically, the current fed forward via $C_{f}$ at this frequency equals the current drawn by the dependent source, resulting in a net current of zero through the parallel combination of $R_{2}$ and $C_{2}$. Consequently, $V_{o}$ drops to zero, implying a gain of zero at this frequency. As a physical check, when $V_{o}=0$ we have $I_{f}=\left(V_{\pi}-0\right) /\left(1 / s C_{f}\right)=s C_{f} V_{\pi}$, so imposing $s C_{f} V_{\pi}=g_{m} V_{\pi}$ yields $s=g_{m} / C_{f}$ In the $s$ plane this zero is located on the positive real axis. Note that for $\omega>\omega_{0}$ the current through $C_{f}$ exceeds that of the dependent source, indicating gain-polarity reversal. This provides a physical justification for the presence of the negative sign in
the numerator of Eq. (6.41); combined with the negative sign of Eq. (6.42), it causes gain to become positive for $\omega>\omega_{0}$. By Eqs. (6.12) and (6.24), $\omega_{0} \gg \omega_{T}$.

We now wish to derive expressions for the pole frequencies $\omega_{1}$ and $\omega_{2}$. Based on the Miller approximation, we expect $\omega_{1}$ to be close to $\omega_{p}$, and $\omega_{2}$ to be much higher than $\omega_{p}$. Consequently, expanding the denominator of Eq. (6.41) and anticipating $\omega_{2} \gg \omega_{1}$, we write

$$
\begin{equation*}
a(s)=a_{0} \frac{1-s / \omega_{0}}{1+s\left(1 / \omega_{1}+1 / \omega_{2}\right)+s^{2} /\left(\omega_{1} \omega_{2}\right)} \cong a_{0} \frac{1-s / \omega_{0}}{1+s / \omega_{1}+s^{2} /\left(\omega_{1} \omega_{2}\right)} \tag{6.44}
\end{equation*}
$$

Equating the coefficients of $s$ in the denominators of Eqs. (6.40) and (6.44), we readily find

$$
\begin{equation*}
\omega_{1}=\frac{1}{R_{1}\left[C_{1}+C_{f}\left(1+g_{m} R_{2}+R_{2} / R_{1}\right)\right]+R_{2} C_{2}} \tag{6.45}
\end{equation*}
$$

We observe that in the limit $C_{2} \rightarrow 0$ this expression differs from that of $\omega_{p}$ derived earlier only in the denominator term $R_{2} / R_{1}$. But, $R_{2} / R_{1} \ll g_{m} R_{2}$, so $\omega_{1} \cong \omega_{p}$, confirming that the Miller approximation is an excellent one, considering also how quicker is its derivation. Likewise, equating the coefficients of $s^{2}$ in the denominators of Eqs. (6.40) and (6.44),

$$
\begin{equation*}
\omega_{2}=\frac{1}{R_{1} R_{2}\left(C_{1} C_{f}+C_{1} C_{2}+C_{f} C_{2}\right) \omega_{1}} \tag{6.46}
\end{equation*}
$$

The next examples will confirm that $\omega_{2} \gg \omega_{1}$, indicating that the frequency response of Fig. 6.20, though approximate, provides a good indication of the actual response over the frequency range of interest.

EXAMPLE 6.8 (a) Find $f_{0}, f_{1}$, and $f_{2}$ for the CE amplifier of Example 6.6. Compare with the example and comment.
(b) Repeat, but taking into account a substrate capacitance $C_{s}=1 \mathrm{pF}$.
(c) Verify with PSpice.

### Solution

(a) For the BJT, Eq. (6.43) predicts a zero frequency at

$$
f_{0}=\frac{g_{m}}{2 \pi C_{\mu}}=\frac{1 / 2 \pi}{26 \times 0.5 \times 10^{-12}} \cong 12 \mathrm{GHz}
$$

Moreover, with $R_{1}=975 \Omega, R_{2}=4.55 \mathrm{k} \Omega$, and $C_{2}=0$, Eqs. (6.45) and (6.46) predict pole frequencies at

$$
\begin{aligned}
f_{1} & =\frac{1 / 2 \pi}{R_{1}\left[C_{\pi}+C_{\mu}\left(1+g_{m} R_{2}+R_{2} / R_{1}\right)\right]} \\
& =\frac{1 / 2 \pi}{975[12+0.5(1+175+4.55 / 0.975)] 10^{-12}}=1.56 \mathrm{MHz}
\end{aligned}
$$

and

$$
\begin{aligned}
f_{2} & =\frac{1 /(2 \pi)^{2}}{R_{1} R_{2} C_{\pi} C_{\mu} f_{1}} \\
& =\frac{1 /(2 \pi)^{2}}{975 \times 4.55 \times 10^{3} \times 12 \times 10^{-12} \times 0.5 \times 10^{-12} \times 1.56 \times 10^{6}} \\
& \cong 600 \mathrm{MHz}
\end{aligned}
$$

Both $f_{0}$ and $f_{2}$ are well above $f_{1}$, so they are of irrelevant consequence in this example and can be ignored. The first pole frequency $\left(f_{1}=1.56 \mathrm{MHz}\right)$ is slightly lower than that predicted via the Miller approximation $\left(f_{p}=1.63 \mathrm{MHz}\right)$, indicating that the Miller estimate suffices for all practical pusposes.
(b) Recalculating with $C_{2}=C_{s}=1 \mathrm{pF}$ we get $f_{0}=12 \mathrm{GHz}, f_{1}=1.55 \mathrm{MHz}$, and $f_{2} \cong 1.3 \mathrm{GHz}$. The effect of $C_{s}$ is negligible in this example.
![](https://cdn.mathpix.com/cropped/2024_11_07_10da0ce153b00c68dc1dg-091.jpg?height=368&width=1314&top_left_y=774&top_left_x=240)

FIGURE 6.22 PSpice circuit to display the gain of the CE amplifier of Example 6.8.
![](https://cdn.mathpix.com/cropped/2024_11_07_10da0ce153b00c68dc1dg-091.jpg?height=506&width=720&top_left_y=1198&top_left_x=241)

FIGURE 6.23 Gain plot of the circuit of Fig. 6.22.
(c) Using the PSpice circuit of Fig. 6.22 we get the gain plot of Fig. 6.23. Using the cursor facilty, we find $\left|a_{0}\right|=43.057 \mathrm{~dB}$, or $142 \mathrm{~V} / \mathrm{V}$, and $f_{-3 \mathrm{~dB}}=$ 1.522 MHz , in agreement with the calculations. The plot confirms the minimal role played by $C_{s}$ in this example.

Remark: an IC designer will simulate an amplifier using a PSpice model for the transistor. But here, for pedagogical purposes, it is more convenient to work with the homebrew model depicted in Fig. 6.22.

### Exercise 6.3

Find $f_{0}, f_{1}$, and $f_{2}$ for the CS amplifier of Example 6.7, if $C_{d b}=0.1 \mathrm{pF}$. Compare with the results obtained there and comment.
Ans. $f_{0}=6.4 \mathrm{GHz}, f_{1}=5.0 \mathrm{MHz}$, and $f_{2} \cong 1 \mathrm{GHz} ; f_{p}=5.15 \mathrm{MHz}\left(\cong f_{1}\right)$.

## 6.4 FREQUENCY RESPONSE OF DIFFERENTIAL AMPLIFIERS

Given the importance of the differential amplifier as an analog building block, it is only appropriate that we investigate its frequency response in detail. If the frequency analysis of a single-transistor stage may be laborious, that of a transistor pair can become exceedingly complex. Mercifully, the use of the half-circuit concepts introduced in Chapter 4 simplifies our task dramatically while providing precious insight with a minimum of mathematical manipulations. (Physical insight much more than formulas is what guides IC designers in their daily endeavors.)

As we know, the role of a differential amplifier is to magnify the voltage difference between two signals irrespective of their common-mode component. The common-mode rejection ratio

$$
\begin{equation*}
\mathrm{CMRR}=\left|\frac{a_{d m}(j f)}{a_{c m}(j f)}\right| \tag{6.47}
\end{equation*}
$$

constitutes a figure of merit of the differential amplifier, and as such it should be as large as possible (ideally, infinite). In practice we will find that the CMRR, however high initially, deteriorates with frequency because so do both the differential-mode gain $a_{d m}(j f)$ and the common-mode gain $a_{c m}(j f)$.

### Resistive-Loaded Differential Amplifiers

Figure 6.24 shows the basic emitter-coupled (EC) and source-coupled (SC) pairs. Recall from Chapter 4 that $a_{c m}$ is inversely proportional to the equivalent resistance $R_{E E}$ (or $R_{S S}$ ) presented to the pair by the external biasing circuitry, so in order to maximize the CMRR a designer will strive to maximize $R_{E E}$ (or $R_{S S}$ ). To this end, the current sinking transistor $Q_{3}$ (or $M_{3}$ ), whose biasing details have been omitted for simplicity, is likely to be part of a very high output-resistance topology such as the Wilson or the cascode types. As a rule, the impedance $Z_{E E}$ (or $Z_{S S}$ ) presented to the EC (or SC) pair consists of a resistive component $R_{E E}$ (or $R_{S S}$ ) in parallel with a capacitive component $C_{E E}$ (or $C_{S S}$ ). As we are about to see, it is precisely the capacitive component that causes $a_{c m}(j f)$, and thus CMRR, to deteriorate with frequency.

To investigate the CMMR, we first need to find the differential-mode and common-mode gains $a_{d m}(j f)$ and $a_{c m}(j f)$. We shall do so using the differential-mode and common-mode half circuits. Though the analysis will be carried out for the
![](https://cdn.mathpix.com/cropped/2024_11_07_10da0ce153b00c68dc1dg-093.jpg?height=738&width=1434&top_left_y=206&top_left_x=201)

FIGURE 6.24 (a) The EC and (b) SC pairs with resistive loads.

EC pair, the results are readily adapted to the SC pair as well. To find $a_{d m}(j f)$ we use the half-circuit equivalent of Fig. 6.25. This is the familiar CE configuration, whose gain contains a dominant pole due primarily to the Miller capacitance. Adapting Eq. (6.45),

$$
\begin{equation*}
f_{p(\mathrm{dm})} \cong \frac{1 / 2 \pi}{\left[\left(R_{B}+r_{b}\right) / / r_{\pi}\right] \times\left\{C_{\pi}+C_{\mu}\left[1+g_{m}\left(R_{C} / / r_{o}\right)\right]\right\}+\left(R_{C} / / r_{o}\right) \times C_{s}} \tag{6.48}
\end{equation*}
$$

To find $a_{c m}(j f)$ we use the half-circuit equivalent of Fig. 6.26. Note that as we split the impedance $Z_{E E}$ into two identical parts, $R_{E E}$ must be doubled to give $\left(2 R_{E E}\right) / /\left(2 R_{E E}\right)=$ $R_{E E}$, whereas $C_{E E}$ must be halved to give $\left(C_{E E} / 2\right) / /\left(C_{E E} / 2\right)=C_{E E} / 2+C_{E E} / 2=C_{E E}$.
![](https://cdn.mathpix.com/cropped/2024_11_07_10da0ce153b00c68dc1dg-093.jpg?height=501&width=1486&top_left_y=1574&top_left_x=201)

FIGURE 6.25 (a) Differential-mode half circuit, and (b) its high-frequency small-signal equivalent.
![](https://cdn.mathpix.com/cropped/2024_11_07_10da0ce153b00c68dc1dg-094.jpg?height=621&width=1497&top_left_y=185&top_left_x=139)

FIGURE 6.26 (a) Common-mode half circuit, and (b) its high-frequency small-signal equivalent.

The circuit of Fig. 6.26 is the familiar CE-ED configuration, but with degeneration now provided by the impedance $2 Z_{E E}=\left(2 R_{E E}\right) / /\left[1 / s\left(C_{E E} / 2\right)\right]$. At sufficiently low frequencies $C_{E E} / 2$ acts as an open circuit compared to $2 R_{E E}$, so $a_{c m}(\mathrm{ff})$ starts out low and CMRR starts out high. As the operating frequency is increased, the impedance provided by $C_{E E} / 2$ decreases, causing $Z_{E E}$ to decrease as well. This, in turn, causes $a_{c m}(j f)$ to increase and CMRR to decrease with frequency. Clearly, $a_{c m}(j f)$ exhibits a zero frequency $f_{z(\mathrm{~cm})}$. This is the frequency at which the impedance provided by $C_{E E} / 2$ equals, in magnitude, $2 R_{E E}$. This condition yields the familiar result $f_{z(\mathrm{~cm})}=$ $1 /\left[2 \pi\left(2 R_{E E}\right)\left(C_{E E} / 2\right)\right]$, or

$$
\begin{equation*}
f_{z(c m)}=\frac{1}{2 \pi R_{E E} C_{E E}} \tag{6.49}
\end{equation*}
$$

Since $R_{E E}$ is usually quite high, $f_{z(\mathrm{~cm})}$ is usually lower than $f_{p(\mathrm{dm})}$. We can thus state the following:

- The CMRR starts out high for $f \ll f_{z(\mathrm{~cm})}$.
- At $f=f_{z(\mathrm{~mm})}$ the CMRR begins to roll off with frequency. Clearly, the zero frequency of $a_{c m}$ is a pole frequency for CMRR.
- For $f_{z(\mathrm{~cm})}<f<f_{p(\mathrm{dm})}$ the CMRR rolls off with $f$ at a rate of $-20 \mathrm{db} / \mathrm{dec}$.
- At $f=f_{p(\mathrm{dm})}$ the CMRR picks up an additional roll-off rate of $-20-\mathrm{dB} / \mathrm{dec}$. Clearly, the first pole frequency of $a_{d m}$ is a second pole frequency for CMRR.
- For $f>f_{p(\mathrm{dm})}$ the CMRR rolls off with $f$ at a rate of $-40 \mathrm{db} / \mathrm{dec}$.
- This roll-off with $f$ continues until higher-order poles and zeros come into play, by which point the CMRR has already deteriorated to fairly low values.
(a) Let the EC pair of Fig. $6.24 a$ use BJTs having $\beta_{0}=200, V_{A}=50 \mathrm{~V}, r_{b}=$ $200 \Omega, C_{\pi}=25 \mathrm{pF}, C_{\mu}=0.3 \mathrm{pF}$, and $C_{s}=1 \mathrm{pF}$. Moreover, let $R_{B}=2 \mathrm{k} \Omega$ and $R_{C}=10 \mathrm{k} \Omega$, and let the emitter-biasing current sink have $I_{E E}=1 \mathrm{~mA}, R_{E E}=$ $1 \mathrm{M} \Omega$, and $C_{E E}=1.5 \mathrm{pF}$. Estimate the low-frequency value of the CMRR as well as its two principal poles.
(b) Use PSpice to display the Bode plots of $\left|a_{d m}\right|,\left|a_{c m}\right|$, and $\left|a_{d m} / a_{c m}\right|$, and comment.

### Solution

(a) We have $g_{m}=(200 / 201) \times(0.5) / 26=19.1 \mathrm{~mA} / \mathrm{V}, r_{\pi}=10.5 \mathrm{k} \Omega, r_{o}=$ $100 \mathrm{k} \Omega, 2 R_{E E}=2 \mathrm{M} \Omega$, and $C_{E E} / 2=0.75 \mathrm{pF}$. Also, $\left(R_{B}+r_{b}\right) / / r_{\pi}=1.82 \mathrm{k} \Omega$ and $R_{C} / / r_{o}=9.09 \mathrm{k} \Omega$. Then, Eqs. (6.48) and (6.49) give

$$
\begin{aligned}
f_{p(\mathrm{dm})} & \cong \frac{1}{2 \pi 1.82 \times 10^{3}[25+0.3 \times(1+19.1 \times 9.09)+(9.09 / 1.82) \times 1] 10^{-12}} \\
& =1.06 \mathrm{MHz}
\end{aligned}
$$

and

$$
f_{z(\mathrm{~cm})} \cong \frac{1}{2 \pi \times 1 \times 10^{6} \times 1.5 \times 10^{-12}}=106 \mathrm{kHz}
$$

At low frequencies, $\mathrm{CMRR}=\left|a_{d m 0} / a_{c m 0}\right| \cong\left|-g_{m}\left(R_{C} / / r_{o}\right) /\left(-R_{C} / 2 R_{E E}\right)\right|=$ $174 / 0.005=34,800=90.8 \mathrm{~dB}$.
(b) To generate the Bode plot of $\left|a_{d m}\right|$ we reuse the PSpice circuit of Fig. 6.22, but with the present parameter values. To generate that of $\left|a_{d m}\right|$ we use again the same circuit, but after lifting the emitter terminal off ground and inserting the parallel combination of a $2-\mathrm{M} \Omega$ resistance and a $0.75-\mathrm{pF}$ capacitance between emitter and ground, in accordance with Fig. 6.26. The plots of $\left|a_{d m}\right|$, $\left|a_{c m}\right|$, and $\left|a_{d m} / a_{c m}\right|$ are shown in Fig. 6.27. The PSpice values $\left|a_{d m 0} / a_{c m 0}\right|=$ $90.1 \mathrm{~dB}, f_{p(\mathrm{dm})}=1.05 \mathrm{MHz}$, and $f_{z(\mathrm{~cm})}=161 \mathrm{kHz}$ are in fair agreement with the calculated values.
![](https://cdn.mathpix.com/cropped/2024_11_07_10da0ce153b00c68dc1dg-095.jpg?height=560&width=792&top_left_y=1458&top_left_x=313)

FIGURE 6.27 Bode plots for the EC pair of Example 6.9.

The results obtained above for the EC pair are readily adapted to the SC pair. The dominant pole of $a_{d m}(j f)$, being also the second pole of the CMRR, is now

$$
\begin{equation*}
f_{p(\mathrm{dm})} \cong \frac{1 / 2 \pi}{R_{s i g}\left\{C_{g s}+C_{g d}\left[1+g_{m}\left(R_{D} / / r_{o}\right)\right]\right\}+\left(R_{D} / / r_{o}\right) C_{d b}} \tag{6.50}
\end{equation*}
$$

whereas the dominant zero of $a_{c m}(j f)$, being also the first pole of CMRR, is

$$
\begin{equation*}
f_{z(\mathrm{~cm})}=\frac{1}{2 \pi R_{S S} C_{S S}} \tag{6.51}
\end{equation*}
$$

The Bode plots are qualitatively similar to those of Fig. 6.27.

### Active-Loaded Differential Amplifiers

With an active load, the circuit loses its symmetry and the additional parasitics introduced by the load transistors tend to complicate the analysis. It is nevertheless possible to gain quick insight into the predominant characteristics of the circuit if we are willing to make suitable approximations. As shown in the CMOS version of Fig. 6.28, the circuit possesses two significant nodes, denoted as $V_{1}$ and $V_{o}$. With a balanced input drive, the third node, denoted as $V_{s s}$, would be at ac ground if the drains of $M_{1}$ and $M_{1}$ were terminated equally. In practice $M_{1}$ 's drain is terminated on the resistance $\left(1 / g_{m 3}\right) / / r_{o 3} \cong$ $1 / g_{m 3}$ while $M_{2}$ 's drain is terminated on the resistance $r_{o 4}$, such that $r_{o 4} \gg 1 / g_{m 3}$. This imbalance results in $V_{s s} \neq 0$. Let us nevertheless continue to assume an ac ground at $V_{s s}$ so that we can apply the half-circuit concept to simplify our analysis.

The net capacitances associated with the nodes $V_{1}$ and $V_{o}$ are, respectively,

$$
\begin{align*}
& C_{1} \cong C_{g s 3}+C_{g s 4}+C_{d b 3}+C_{d b 1}+C_{g d 1}  \tag{6.52a}\\
& C_{2} \cong C_{g d 4}+C_{d b 4}+C_{g d 2}+C_{d b 2}+C_{L} \tag{6.52b}
\end{align*}
$$

![](https://cdn.mathpix.com/cropped/2024_11_07_10da0ce153b00c68dc1dg-096.jpg?height=585&width=671&top_left_y=1384&top_left_x=444)

FIGURE 6.28 High-frequency model of the active-loaded CMOS differential amplifier (to facilitate analysis, all stray capacitances have been moved outside of the FETs and lumped together into two equivalent capacitances $C_{1}$ and $C_{2}$ as shown).
where $C_{L}$ is the capacitance of the external load, if any. It can be proved that these capacitances see, respectively, the equivalent resistances

$$
\begin{gather*}
R_{1}=\frac{r_{o p} / /\left(2 r_{o n}+r_{o p}\right)}{1+g_{m p} r_{o p}}  \tag{6.53a}\\
R_{2}=r_{o p} / / r_{o n} \tag{6.53b}
\end{gather*}
$$

and as such yield two pole frequencies at $\omega_{1}=1 /\left(R_{1} C_{1}\right)$ and $\omega_{2}=1 /\left(R_{2} C_{2}\right)$.

### Exercise 6.4

Prove Eq. (6.53).
Hint: replace each transistor with its small-signal model and use the test method, exploiting also the fact that $M_{1}$ and $M_{2}$ are matched, and so are $M_{3}$ and $M_{4}$.

By the superposition principle, $V_{o}=V_{o 4}+V_{o 2}$, where $V_{o 4}$ is due to $M_{4}$ 's response to $+V_{i d} / 2$, and $V_{o 2}$ to $M_{2}$ 's response to $-V_{i d} / 2$. By inspection, $V_{o 2}=\left[R_{2} / /\left(1 / s C_{2}\right)\right] I_{2}$, where $I_{2}=g_{m 2} V_{i d} / 2$. Expanding, we get

$$
\begin{equation*}
V_{o 2}=\frac{g_{m 2} R_{2}}{1+s R_{2} C_{2}} \frac{V_{i d}}{2} \tag{6.54a}
\end{equation*}
$$

Similarly, $V_{o 4}=\left[R_{2} / /\left(1 / s C_{2}\right)\right] I_{4}$, where $I_{4}=g_{m 4} V_{1}$. But,

$$
V_{1} \cong \frac{\left(1 / g_{m 3}\right) I_{1}}{1+s R_{1} C_{1}}=\frac{\left(1 / g_{m 3}\right)}{1+s R_{1} C_{1}} g_{m 1} \frac{V_{i d}}{2}
$$

Substituting, and exploiting the fact that $g_{m 4} / g_{m 3}=1$ because of matching, we get

$$
\begin{equation*}
V_{o 4} \cong \frac{1}{1+s R_{1} C_{1}} \frac{g_{m 2} R_{2}}{1+s R_{2} C_{2}} \frac{V_{i d}}{2} \tag{6.54b}
\end{equation*}
$$

It is interesting to note that $V_{i d}$ contributes to $V_{o}$ via the shorter signal path made up of $M_{2}$ as well as via the longer signal path made up of $M_{1}-M_{3}-M_{4}$. Both paths converge at the common output-node pole formed by $R_{2}$ and $C_{2}$. However, the longer path is slower because it includes also the additional pole due to $R_{1}$ and $C_{1}$. Letting $V_{o}=V_{o 4}+V_{o 2}$, collecting and simplifying, we finally get

$$
a_{d m}(s)=\frac{V_{o}}{V_{i d}}=g_{m 2} R_{2} \frac{1+s 0.5 R_{1} C_{1}}{1+s R_{1} C_{1}} \frac{1}{1+s R_{2} C_{2}}
$$

Letting $s \rightarrow 2 \pi f$ and $g_{m 1}=g_{m 2}=g_{m n}$, we express gain in the insightful form

$$
\begin{equation*}
a_{d m}(j f)=a_{d m 0} \frac{1+j f / f_{0}}{\left(1+j f / f_{1}\right)\left(1+j f / f_{2}\right)} \tag{6.55}
\end{equation*}
$$

where

$$
\begin{equation*}
a_{d m 0}=g_{m n}\left(r_{o p} / / r_{o p}\right) \tag{6.56}
\end{equation*}
$$

$$
\begin{equation*}
f_{1}=\frac{1}{2 \pi R_{1} C_{1}} \quad f_{2}=\frac{1}{2 \pi R_{2} C_{2}} \quad f_{0}=2 f_{1} \tag{6.57}
\end{equation*}
$$

It is apparent that beside the aforementioned pole frequencies $f_{1}$ and $f_{2}, a_{d m}(j f)$ exhibits also a zero frequency $f_{0}$ stemming from the direct signal path via $M_{2}$. At sufficiently high frequencies the slower signal path via $M_{1}-M_{3}-M_{4}$ is shunted by $C_{1}$, leaving only the faster path via $M_{2}$. Regardless, the overall frequency response is dominated by $f_{2}$ due to the fact that $R_{2} \gg R_{1}$.

EXAMPLE 6.10 In the circuit of Fig. 6.28 let all FETs have $g_{m}=1 \mathrm{~mA} / \mathrm{V}, r_{o}=50 \mathrm{k} \Omega, C_{g s}=50 \mathrm{fF}$, and $C_{g d}=C_{d b}=5 \mathrm{fF}$. Moreover, assume the circuit is terminated on a load capacitance $C_{L}=0.25 \mathrm{pF}$. Estimate all the parameters intervening in the calculation of $a_{d m}(j f)$. Hence, verify with PSpice, and comment.

### Solution

Plugging the given data into Eqs. (6.52) and (6.53) gives $C_{1}=115 \mathrm{fF}, R_{1}=735 \Omega$, $C_{2}=270 \mathrm{fF}$, and $R_{2}=25 \mathrm{k} \Omega$. Plugging in turn into Eqs. (6.56) and (6.57) we get

$$
a_{d m 0}=25 \mathrm{~V} / \mathrm{V} \quad f_{2}=23.6 \mathrm{MHz} \quad f_{1}=1.88 \mathrm{GHz} \quad f_{0}=3.27 \mathrm{GHz}
$$

A PSpice simulation yields the gain plot of Fig. 6.29a. Using the cursor facility we find $a_{d m 0}=24.7 \mathrm{~V} / \mathrm{V}$ and $f_{-3 \mathrm{~dB}}=23.3 \mathrm{MHz}$, in good agreement with the calculated values. Figure $6.29 b$ shows the magnitude plot of the amplifier's shortcircuit transconductance $G_{m}=I_{o(\mathrm{sc})} / V_{i d}$. Short-circuiting the output node eliminates the pole frequency $f_{2}$, so the plot evidences only the pole-zero frequency pair $f_{1}$ and $f_{0}$, both of which are in the GHz range.
![](https://cdn.mathpix.com/cropped/2024_11_07_10da0ce153b00c68dc1dg-098.jpg?height=527&width=1408&top_left_y=1519&top_left_x=193)

FIGURE 6.29 Frequency response of the active-loaded CMOS amplifier of Example 6.10.

## 6.5 BIPOLAR VOLTAGE AND CURRENT BUFFERS

Recall that the role of a voltage buffer is to provide unity voltage gain with high input impedance and low output impedance, whereas that of a current buffer is to provide unity current gain with low input impedance and high output impedance. We are about to see that the CC and CB configurations approach the above characteristics over a fairly wide frequency band because they are exempt from the Miller effect, the main frequency bottleneck of CE amplifiers. However, the BJT's stray capacitances do come into play at high frequencies, where they tend to degrade both the gain and the terminal impedances. In particular, impedances that start out high tend to decrease with frequency, thus exhibiting capacitive behavior, and impedances that start out low tend to increase with frequency (at least up to a point), thus exhibiting inductive behavior. Moreover, gain may depart appreciably from unity at high frequencies.

If the study of voltage amplifiers focuses on the frequency behavior of gain because gain is the most important amplifier parameter, the study of buffers must emphasize the frequency behavior of the terminal impedances because impedance transformation is the primary function of a buffer.

### Frequency Characteristics of the Emitter Follower

Figure 6.30 shows the ac equivalent of the emitter follower, along with its highfrequency model. Since its right plate is grounded, $C_{\mu}$ is exempt from the Miller multiplication, so we expect the CC to be an inherently fast configuration. In fact, to develop a quick (if only approximate) feel for the circuit, let us ignore $C_{\mu}$ altogether (the general case with $C_{\mu}$ present will be addressed in Section 6.7). We wish to investigate the frequency dependence of the impedance $Z_{i}(j \omega)$ seen by the signal source, the source-to-load voltage gain $a(j \omega)=V_{o} / V_{s i g}$, and the impedance $Z_{o}(j \omega)$ seen by the load.

The starting point is offered by Eqs. (2.83), (2.84), and (2.86), provided we make the substitutions

$$
\begin{equation*}
\beta_{0} \rightarrow \beta(j \omega) \quad r_{\pi} \rightarrow z_{\pi}(j \omega) \tag{6.58}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_11_07_10da0ce153b00c68dc1dg-099.jpg?height=522&width=1506&top_left_y=1561&top_left_x=191)

FIGURE 6.30 (a) The emitter follower and (b) its high-frequency small-signal model.
where

$$
\begin{equation*}
\beta(j \omega)=\frac{\beta_{0}}{1+j \omega / \omega_{\beta}} \tag{6.59a}
\end{equation*}
$$

and

$$
z_{\pi}(j \omega)=r_{\pi} / / \frac{1}{j \omega C_{\pi}}=\frac{r_{\pi}}{1+j \omega r_{\pi} C_{\pi}}
$$

By Eq. (6.8), $\omega_{\beta}=1 /\left[r_{\pi}\left(C_{\pi}+C_{\mu}\right)\right]$. As long as $C_{\mu} \ll C_{\pi}$, we can approximate $\omega_{\beta} \cong 1 /\left(r_{\pi} C_{\pi}\right)$ and write

$$
\begin{equation*}
z_{\pi}(j \omega) \cong \frac{r_{\pi}}{1+j \omega / \omega_{\beta}}=\frac{\beta(j \omega)}{g_{m}} \tag{6.59b}
\end{equation*}
$$

With the above substitutions, the emitter-follower parameters become

$$
\begin{gather*}
Z_{i}(j \omega)=r_{b}+z_{\pi}(j \omega)+[\beta(j \omega)+1]\left(R_{L} / / r_{o}\right) \\
Z_{o}(j \omega)=\frac{R_{s i g}+r_{b}+z_{\pi}(j \omega)}{\beta(j \omega)+1} / / r_{o}  \tag{6.60a}\\
a(j \omega)=\frac{V_{o}}{V_{s i g}}=\frac{1}{1+\frac{R_{s i g}+r_{b}+z_{\pi}(j \omega)}{[\beta(j \omega)+1]\left(R_{L} / / r_{o}\right)}} \tag{6.60b}
\end{gather*}
$$

At sufficiently low frequencies, where $C_{\pi}$ acts as an open circuit, we have $\beta \rightarrow \beta_{0}$ and $z_{\pi} \rightarrow r_{\pi}$, so the above expressions tend to their familiar low-frequency forms, which we identify with subscript 0 ,

$$
\begin{gather*}
Z_{i 0}=r_{b}+r_{\pi}+\left(\beta_{0}+1\right)\left(R_{L} / / r_{o}\right) \quad Z_{o 0}=\frac{R_{s i g}+r_{b}+r_{\pi}}{\beta_{0}+1} / / r_{o}  \tag{6.61a}\\
a_{0}=\frac{1}{1+\frac{R_{s i g}+r_{b}+r_{\pi}}{\left(\beta_{0}+1\right)\left(R_{L} / / r_{o}\right)}} \tag{6.61b}
\end{gather*}
$$

On the other hand, at sufficiently high frequencies, where $C_{\pi}$ acts as a short circuit, we have $\beta \rightarrow 0$ and $z_{\pi} \rightarrow 0$, so the high-frequency asymptotes, identified by subscript $\infty$, are

$$
\begin{gather*}
Z_{i \infty}=r_{b}+\left(R_{L} / / r_{o}\right) \quad Z_{o \infty}=\left(R_{s i g}+r_{b}\right) / / r_{o}  \tag{6.62a}\\
a_{\infty}=\frac{1}{1+\frac{R_{s i g}+r_{b}}{R_{L} / / r_{o}}} \tag{6.62b}
\end{gather*}
$$

We observe that $Z_{i \infty} \ll Z_{i 0}$, indicating that $Z_{i}$ is always a capacitive impedance. However, $Z_{o}$ may be inductive, capacitive, or even purely resistive, depending on how the product $g_{m}\left(R_{s i g}+r_{b}\right)$ compares with unity. One can prove (see Problem 6.18) that if the BJT is biased at a sufficiently low current to make $g_{m}\left(R_{s i g}+r_{b}\right) \leq 1$, then we have $a_{\infty} \geq a_{0}$ and $Z_{o \infty} \leq Z_{o 0}$. In practical circuits it is far more common to have $g_{m}\left(R_{s i g}+r_{b}\right) \gg 1$, in which case $a_{\infty}<a_{0}$ and $Z_{o \infty} \gg Z_{o 0}$, indicating an inductive $Z_{o}$.

Figure 6.31 shows typical magnitude plots of $Z_{i}, a$, and $Z_{o}$ for $C_{\mu}=0$ and $g_{m}\left(R_{s i g}+r_{b}\right) \gg 1$. In accordance with Appendix 6A, these parameters must take on the forms

$$
\begin{gather*}
Z_{i}(j \omega)=Z_{i 0} \frac{1+j \omega / \omega_{z i}}{1+j \omega / \omega_{p i}} \quad a(j \omega)=a_{0} \frac{1+j \omega / \omega_{z a}}{1+j \omega / \omega_{p a}} \\
Z_{o}(j \omega)=Z_{o 0} \frac{1+j \omega / \omega_{z o}}{1+j \omega / \omega_{p o}} \tag{6.63}
\end{gather*}
$$

We now seek to estimate, for each of the above expressions, the zero and pole frequencies $\omega_{z}$ and $\omega_{p}$, also known as the breakfrequencies. This task is facilitated by the fact that letting $\omega \rightarrow \infty$ in the above expressions we obtain the following constraints

$$
\begin{equation*}
\frac{Z_{i 0}}{Z_{i \infty}}=\frac{\omega_{z i}}{\omega_{p i}} \quad \frac{a_{0}}{a_{\infty}}=\frac{\omega_{z a}}{\omega_{p a}} \quad \frac{Z_{o \infty}}{Z_{o 0}}=\frac{\omega_{p o}}{\omega_{z o}} \tag{6.64}
\end{equation*}
$$

Consequently, for each expression we need only to estimate one of its two break frequencies. The other can be found via the appropriate constraint of Eq. (6.64). Though the exact derivations are left as an exercise in Problem 6.19, here we wish to pursue quick estimations to gain basic insight. Thus, according to Eq. (6.60), each of $Z_{i}(j \omega)$, $Z_{o}(j \omega)$, and $a(j \omega)$ contains the terms $z_{\pi}(j \omega)$ and $\beta(j \omega)+1$. These terms affect the frequency response up to $\omega_{T}$, beyond which $z_{\pi}(j \omega)$ becomes negligible compared to the other resistances in the circuit, and $\beta(j \omega)$ becomes negligible compared to 1 . So, we expect each curve in Fig. 6.31 to make the transition to its high-frequency asymptote in the vicinity of $\omega_{T}$, thus giving

$$
\begin{equation*}
\omega_{z i} \cong \omega_{z a} \cong \omega_{p o} \cong \omega_{T} \tag{6.65}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-001.jpg?height=424&width=1539&top_left_y=1622&top_left_x=196)

FIGURE 6.31 Typical emitter-follower characteristics for $C_{\mu}=0$ : (a) input impedance $Z_{i}$, (b) voltage gain a, and (c) output impedance $Z_{o}$. The plots of $a$ and $Z_{o}$ are for the case $g_{m}\left(R_{s i g}+r_{b}\right) \gg 1$.

EXAMPLE 6.11 (a) Let the BJT of Fig. 6.30 have $\beta_{0}=150, V_{A}=80 \mathrm{~V}, r_{b}=200 \Omega$, and $C_{\mu}=1 \mathrm{pF}$, and suppose it is biased at $I_{C}=2 \mathrm{~mA}$, where it has $f_{T}=400 \mathrm{MHz}$. Moreover, let $R_{\text {sig }}=2 \mathrm{k} \Omega$ and $R_{L}=5 \mathrm{k} \Omega$. Ignoring $C_{\mu}$, provide quick estimates for the asymptotic values as well as the pole and zero frequencies of $a, Z_{i}$, and $Z_{o}$.
(b) Verify with PSpice and compare with the calculated values.
(c) Re-run PSpice with $C_{\mu}=1 \mathrm{pF}$ and use physical insight to justify the ensuing changes in the plots.

### Solution

(a) Proceeding as usual we find $g_{m}=1 /(13 \Omega), r_{\pi}=1.95 \mathrm{k} \Omega$, and $r_{o}=40 \mathrm{k} \Omega$, so that $R_{s i g}+r_{b}=2+0.2=2.2 \mathrm{k} \Omega$ and $R_{L} / / r_{o}=5 / / 40=4.44 \mathrm{k} \Omega$. The asymptotic values of gain are

$$
\begin{aligned}
& a_{0}=\frac{1}{1+\frac{2.2+1.95}{151 \times 4.44}}=0.994 \mathrm{~V} / \mathrm{V}=-0.05 \mathrm{~dB} \\
& a_{\infty}=\frac{1}{1+\frac{2.2}{4.44}}=0.669 \mathrm{~V} / \mathrm{V}=-3.5 \mathrm{~dB}
\end{aligned}
$$

and its zero and pole frequencies are

$$
f_{z a} \cong f_{T}=400 \mathrm{MHz} \quad f_{p a} \cong \frac{a_{\infty}}{a_{0}} f_{z a}=\frac{0.669}{0.994} 400=269 \mathrm{MHz}
$$

which are fairly high and close to each other. The asymptotic vales of $Z_{i}$ are

$$
Z_{i 0}=0.2+1.95+151 \times 4.44=673 \mathrm{k} \Omega \quad Z_{i o}=0.2+4.44=4.64 \mathrm{k} \Omega
$$

and the approximate zero and pole frequencies of $Z_{i}$ are

$$
f_{z i} \cong f_{T}=400 \mathrm{MHz} \quad f_{p i} \cong \frac{Z_{i \infty}}{Z_{i 0}} f_{T}=\frac{4.64}{673} 400=2.76 \mathrm{MHz}
$$

Finally, the asymptotic vales of $Z_{o}$ are

$$
Z_{o 0}=\frac{2.2+1.95}{151}=27.5 \Omega \quad Z_{o \infty}=(2+0.2) / / 40=2.09 \mathrm{k} \Omega
$$

and the approximate pole and zero frequencies of $Z_{o}$ are

$$
f_{p o} \cong f_{T}=400 \mathrm{MHz} \quad f_{z 0} \cong \frac{Z_{o 0}}{Z_{o \infty}} f_{T}=\frac{27.5}{2090} 400=5.26 \mathrm{MHz}
$$

(b) Using the PSpice circuit of Fig. 6.32 we get the plots of Fig. 6.33, whose asymptotic values and break frequencies for $C_{\mu}=0$ are in good agreement with the values estimated above.
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-003.jpg?height=447&width=1109&top_left_y=211&top_left_x=197)

FIGURE 6.32 PSpice circuit to display the Bode plots of the emitter follower of Example 6.11.
(c) Re-running PSpice with $C_{\mu}=1 \mathrm{pF}$ indicates the presence of an additional pole frequency for each plot. Using physical insight we estimate the additional pole frequency of $Z_{i}$ in the vicinity of $1 /\left(2 \pi Z_{i 0} C_{\mu}\right)=236 \mathrm{MHz}$, that of $a$ in the vicinity of $1 /\left[2 \pi\left(R_{s i g}+r_{b}\right) C_{\mu}\right]=72 \mathrm{MHz}$, and that of $Z_{o}$ in the vicinity of $1 /\left\{2 \pi\left[\left(R_{s i g}+r_{b}\right) / / R_{L}\right] C_{\mu}\right\}=104 \mathrm{MHz}$. Above this frequency $Z_{o}$ changes from inductive to capacitive.
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-003.jpg?height=480&width=1532&top_left_y=1110&top_left_x=218)

FIGURE 6.33 Gain and impedance plots for the emitter follower of Example 6.11.

Inductive behavior may pose problems when an emitter follower drives a capacitive load because of the tendency by capacitive and inductive impedances to resonate with each other. Depending on the damping conditions, the emitter follower may exhibit undesirable ringing or even oscillations. To better assess the situation, it is often convenient to model $Z_{o}$ in terms of a suitable network, such as the one of Fig. 6.34, consisting of an equivalent inductance $L_{o}$ with a series resistance $R_{s}$ and a parallel resistance $R_{p}$. Their values are found by matching the asymptotic values and break frequencies of the equivalent network to those of $Z_{o}$.
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-004.jpg?height=456&width=842&top_left_y=183&top_left_x=375)

FIGURE 6.34 Equivalent network for the output impedance $Z_{e}$ of an emitter follower for the case $C_{\mu}=0$.

EXAMPLE 6.12 Find $R_{p}, R_{s}$, and $L_{o}$ for the emitter follower of Example 6.11. Again, ignore $C_{\mu}$.

### Solution

In the limit $f \rightarrow \infty, L_{o}$ acts as an open circuit, resulting in $R_{p}=Z_{o \infty}$. By Example 6.11 we must thus have

$$
R_{p}=2.09 \mathrm{k} \Omega
$$

In the limit $f \rightarrow 0, L_{o}$ acts as a short circuit, giving $R_{s} / / R_{p}=Z_{o 0}$. By Example 6.11 we must thus have $1 / R_{s}+1 / 2090=1 / 27.5$, which gives

$$
R_{s} \cong 27.5 \Omega
$$

To find $L_{o}$, assume we start with $f=0$, where $L_{o}$ acts as a short compared to $R_{s}$, and we gradually increase $f$ until $\left|Z_{L}\right|$ becomes equal to $R_{s}$. This marks the zero frequency of $Z_{o}(j f)$, so imposing $\left|j 2 \pi f_{z o} L_{o}\right|=R_{s}$ gives

$$
L_{o}=\frac{R_{s}}{2 \pi f_{z o}}=\frac{27.5}{2 \pi 5 \times 10^{6}} \cong 875 \mathrm{nH}
$$

Alternatively, we could have applied physical insight at the pole frequency to get $L_{o}=R_{p} /\left(2 \pi f_{p o}\right)$.

### Frequency Characteristics of Bipolar Current Buffers

Figure 6.35 shows the ac equivalent of a bipolar current buffer, along with its highfrequency model. Like the CC configuration, the CB configuration is inherently fast because $C_{\mu}$ is exempt from the Miller effect. We wish to find the frequency dependence of the impedance $Z_{i}(j \omega)$ seen looking into the emitter, the current gain $a(j \omega)=$ $I_{o} / I_{i}$, and the impedance $Z_{o}(j \omega)$ seen looking into the collector.

To gain quick-if approximate-insight into $Z_{i}$ and $a$ it is convenient to ignore $r_{o}$ and $C_{\mu}$ for then the input port is isolated from the output port and can
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-005.jpg?height=560&width=1490&top_left_y=185&top_left_x=138)

FIGURE 6.35 (a) The bipolar current buffer, and (b) its high-frequency small-signal model.
thus be analyzed separately. To find $Z_{i}(j \omega)$ we simply recycle the expression for $Z_{o}(j \omega)$ derived earlier for the CC configuration, but with $R_{s i g}=0$. The result is, for $r_{o} \rightarrow \infty$,

$$
\begin{equation*}
Z_{i}(j \omega)=Z_{i 0} \frac{1+j \omega / \omega_{z i}}{1+j \omega / \omega_{p i}} \tag{6.66a}
\end{equation*}
$$

where

$$
\begin{equation*}
Z_{i 0} \cong \frac{r_{b}+r_{\pi}}{\beta_{0}+1} \quad \omega_{p i} \cong \omega_{T} \quad \omega_{z i}=\frac{Z_{i 0}}{r_{b}} \omega_{p i} \tag{6.66b}
\end{equation*}
$$

Again, one can readily prove that this impedance is inductive for $g_{m} r_{b}>1$, capacitive for $g_{m} r_{b}<1$, and purely resistive for $g_{m} r_{b}=1$.

Using Eq. (6.59a) and expanding, we readily obtain the short-circuit current gain

$$
\begin{equation*}
\alpha(j \omega)=\frac{I_{o(\mathrm{sc})}}{I_{i}}=\frac{\beta(j \omega)}{\beta(j \omega)+1} \cong \frac{\alpha_{0}}{1+j \omega / \omega_{T}} \tag{6.67}
\end{equation*}
$$

where $I_{o(\mathrm{sc})}$ is the collector current in the limit $R_{L} \rightarrow 0$, and $\alpha_{0}=\beta_{0} /\left(\beta_{0}+1\right)$. Once it reaches the collector node, $I_{o(\mathrm{sc})}$ divides among $R_{L}, C_{\mu}$, and $C_{s}$. Since $r_{b}$ is small, we can treat $C_{\mu}$ as if its left plate was directly grounded, so we can lump $C_{\mu}$ with $C_{s}$. Using the current-divider formula we get, for $r_{o} \rightarrow \infty$,

$$
I_{o} \cong \frac{1 /\left[j \omega\left(C_{\mu}+C_{s}\right)\right]}{R_{L}+1 /\left[j \omega\left(C_{\mu}+C_{s}\right)\right]} \alpha(j \omega) I_{i}=\frac{\alpha(j \omega)}{1+j \omega R_{L}\left(C_{\mu}+C_{s}\right)} I_{i}
$$

Substituting Eq. (6.67), we finally obtain the overall current gain

$$
\begin{equation*}
a(j \omega)=\frac{I_{i}}{I_{i}} \cong \frac{\alpha_{0}}{\left(1+j \omega / \omega_{L}\right)\left(1+j \omega / \omega_{T}\right)} \quad \omega_{L} \cong \frac{1}{R_{L}\left(C_{\mu}+C_{s}\right)} \tag{6.68}
\end{equation*}
$$

It is apparent that the CB configuration provides its maximum bandwidth of $\omega_{T}$ when the load is a short circuit. For $R_{L} \neq 0$, the additional pole formed by $R_{L}$ with the effective collector capacitance $C_{\mu}+C_{s}$ reduces the bandwidth accordingly.

To develop an expression for the impedance $Z_{o}(j \omega)$ seen looking into the collector in Fig. 6.35, recall that at low frequencies this impedance takes on the familiar form $Z_{o 0}=\left(\beta_{0}+1\right) r_{o}$. This resistance forms a pole $\omega_{p o}$ with the capacitance $C_{\mu}+C_{s}$, so we have

$$
\begin{equation*}
Z_{o}(j \omega)=\frac{\left(\beta_{0}+1\right) r_{o}}{1+j \omega / \omega_{p o}} \quad \omega_{p o}=\frac{1}{\left(\beta_{0}+1\right) r_{o}\left(C_{\mu}+C_{s}\right)} \tag{6.69}
\end{equation*}
$$

EXAMPLE 6.13 The CB amplifier of Fig. $6.35 a$ uses a BJT with $\beta_{0}=200, V_{A}=50 \mathrm{~V}, r_{b}=250 \Omega$, $C_{\mu}=0.5 \mathrm{pF}$, and $C_{s}=1 \mathrm{pF}$. Also, the BJT is biased at $I_{C}=1 \mathrm{~mA}$, where it exhibits $f_{T}=500 \mathrm{MHz}$. If $R_{L}=5 \mathrm{k} \Omega$, estimate expressions for $a(j f), Z_{i}(j f)$, and $Z_{o}(j f)$.

### Solution

We have $r_{\pi}=5.2 \mathrm{k} \Omega, r_{o}=50 \mathrm{k} \Omega$, and $C_{\mu}+C_{s}=0.5+1=1.5 \mathrm{pF}$. Plugging into the above formulas we get $\alpha_{0}=0.995, f_{L} \cong 21 \mathrm{MHz}, Z_{i 0} \cong 27 \Omega, f_{z i} \cong 54 \mathrm{MHz}$, $Z_{o 0} \cong 10 \mathrm{M} \Omega$, and $f_{p o} \cong 10.6 \mathrm{kHz}$. Consequently,

$$
a(j f) \cong \frac{0.995}{[1+j f /(21 \mathrm{MHz})][1+j f /(500 \mathrm{MHz})]}
$$

indicating that the band-limiting bottleneck for $a(j f)$ is the pole $f_{L}$. We also have

$$
Z_{i}(j f) \cong(27 \Omega) \frac{1+j f /(54 \mathrm{MHz})}{1+j f /(500 \mathrm{MHz})} \quad Z_{o}(j f)=\frac{10 \mathrm{M} \Omega}{1+j f /(10.6 \mathrm{kHz})}
$$

indicating an inductive $Z_{i}$ and a capacitive $Z_{o}$ (as we know, because of $C_{\mu}$ and $C_{s}$, $Z_{i}$ eventually will turn capacitive.
Remark: Even an apparently simple circuit such as a buffer may prove too complex for a thorough paper-and-pencil analysis. A reasonable approach is (a) to start out with a simplied but more manageable circuit version (such as Fig. 6.30b, where we ignore $C_{\mu}$ to focus on the more important $C_{\pi}$ ), (b) develop a basic feel for this simplified circuit, and $(c)$ then use PSpice to investigate higher-order effects (such as the effect of $C_{\mu}=1 \mathrm{pF}$ in Fig. 6.33). Regardless, we still need hand analysis in order to anticipate the results of computer simulation, and thus provide a form of check. This is how engineers proceed on their daily jobs.

## 6.6 MOS VOLTAGE AND CURRENT BUFFERS

The voltage/current buffer considerations at the beginning of Section 6.5 , which you are encouraged to review, hold also for MOSFETs, so our analysis will proceed along the lines of the bipolar case, with special emphasis on the frequency behavior of the terminal impedances.

### Frequency Characteristics of the Source Follower

Figure 6.36 shows the ac equivalent of the source follower, along with its highfrequency model. Since its right plate is grounded, $C_{g d}$ is exempt from the Miller multiplication, so we expect the CD to be an inherently fast configuration. In fact, to develop a quick (if only approximate) feel for the circuit, let us ignore all capacitances except for $C_{g s}$, which is the dominant capacitance in the circuit. We wish to investigate the frequency dependence of the impedance $Z_{i}(j \omega)$ seen by the signal source, the source-to-load voltage gain $a(j \omega)=V_{o} / V_{s i g}$, and the impedance $Z_{o}(j \omega)$ seen by the load.
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-007.jpg?height=497&width=1551&top_left_y=583&top_left_x=201)

FIGURE 6.36 (a) The source follower and (b) its high-frequency small-signal model.
To find the voltage gain, refer to the simplified equivalent of Fig. 6.37, obtained from that of Fig. $6.36 b$ by lumping $R_{L}, r_{o}$, and $1 / g_{m b}$ into a single equivalent resistance,

$$
\begin{equation*}
R_{1}=R_{L} / / r_{o} / / \frac{1}{g_{m b}} \tag{6.70}
\end{equation*}
$$

(Though $C_{g d}$ and $C_{g b}$ are being ignored in the present analysis, they too have been lumped together as they are in parallel in the original circuit). Applying Ohm's law, KCL, and the voltage divider rule, we write

$$
\begin{aligned}
V_{o} & =R_{1}\left(\frac{V_{g s}}{1 /\left(j \omega C_{g s}\right)}+g_{m} V_{g s}\right)=R_{1}\left(j \omega C_{g s}+g_{m}\right) V_{g s} \\
V_{g s} & =\frac{1 / j \omega C_{g s}}{R_{s i g}+1 /\left(j \omega C_{g s}\right)}\left(V_{s i g}-V_{o}\right)=\frac{1}{1+j \omega R_{s i g} C_{g s}}\left(V_{s i g}-V_{o}\right)
\end{aligned}
$$

![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-007.jpg?height=412&width=628&top_left_y=1729&top_left_x=203)

FIGURE 6.37 Simplified equivalent of the circuit of Fig. 6.36b.

Eliminating $V_{g s}$ and collecting gives

$$
a(j \omega)=\frac{V_{o}}{V_{s i g}}=\frac{g_{m} R_{1}+j \omega R_{1} C_{g s}}{1+g_{m} R_{1}+j \omega\left(R_{s i g}+R_{1}\right) C_{g s}}
$$

With a bit of algebraic manipulation we put gain in the more insightful form advocated in Appendix 6A,

$$
\begin{equation*}
a(j \omega)=a_{0} \frac{1+j \omega / \omega_{z a}}{1+j \omega / \omega_{p a}} \tag{6.71a}
\end{equation*}
$$

where

$$
\begin{equation*}
a_{0}=\frac{1}{1+1 /\left(g_{m} R_{1}\right)} \quad \omega_{z a}=\frac{g_{m}}{C_{g s}} \quad \omega_{p a}=\frac{1+g_{m} R_{1}}{\left(R_{s i g}+R_{1}\right) C_{g s}} \tag{6.71b}
\end{equation*}
$$

For $C_{g d} \ll C_{g s}$ we can approximate $\omega_{z a} \cong \omega_{T}$, by Eq. (6.24). We also note that at sufficiently high frequencies, where $C_{g s}$ acts as a short circuit, $R_{1}$ forms a voltage divider with $R_{s i g}$, resulting in the asymptotic gain value $a_{\infty}=1 /\left(1+R_{s i g} / R_{1}\right)$. One can easily prove that $a_{\infty} / a_{0} \leq 1$ for $g_{m} R_{s i g} \geq 1$, and $a_{\infty} / a_{0} \geq 1$ for $g_{m} R_{s i g} \leq 1$ (this, of course, under the assumption that $C_{g b}, C_{g d}$, and $C_{s b}$ are negligible).

Next, we turn to the impedance $Z_{i}(j \omega)$ seen by the signal source, that is, the impedance seen looking into the gate. Using the test circuit of Fig. 6.38a, one can prove (see Problem 6.24) that

$$
\begin{equation*}
Z_{i}(j \omega)=\frac{V_{i}}{I_{i}}=\frac{1}{j \omega C_{1}}+R_{1} \tag{6.72a}
\end{equation*}
$$

where

$$
\begin{equation*}
C_{1}=\frac{C_{g s}}{1+g_{m} R_{1}} \tag{6.72b}
\end{equation*}
$$

indicating that $Z_{i}$ appears as an equivalent capacitance $C_{1}$ in series with the resistance $R_{1}$. As depicted in Fig. 6.39a, $C_{1}$ dominates at low frequencies, leading to the familiar dc limit $Z_{i 0}=\infty$. At high frequencies, where $C_{g s}$ acts as a short circuit, $R_{1}$ dominates,
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-008.jpg?height=398&width=621&top_left_y=1684&top_left_x=284)

FIGURE 6.38 Finding (a) the impedance $Z_{i}$ seen looking into the gate and (b) $Z_{o}$ seen looking into the source.
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-009.jpg?height=421&width=1535&top_left_y=203&top_left_x=200)

FIGURE 6.39 Typical source-follower characteristics for $C_{g b}=C_{g d}=C_{s b}=0$ : (a) input impedance $Z_{i}$, (b) voltage gain $a$, and (c) output impedance $Z_{o}$. The plots of $a$ and $Z_{o}$ are for the case $g_{m} R_{s i g} \gg 1$.
giving $Z_{i \infty}=R_{1}$. The zero frequency is $\omega_{z i}=1 /\left(R_{1} C_{1}\right)$. For $g_{m} R_{1} \gg 1$ we can approximate $\omega_{z i} \cong \omega_{T}$.

Finally, to find the impedance $Z_{o}(j \omega)$ seen by the load, we use the test circuit of Fig. 6.38b, where

$$
\begin{equation*}
R_{2}=r_{o} / / \frac{1}{g_{m b}} \tag{6.73}
\end{equation*}
$$

The result (see Problem 6.24) is

$$
\begin{equation*}
Z_{o}(j \omega)=Z_{o 0} \frac{1+j \omega / \omega_{z o}}{1+j \omega / \omega_{p o}} \tag{6.74a}
\end{equation*}
$$

where $Z_{o 0}$ is the familiar low-frequency resistance seen looking into the source terminal, and $\omega_{z o}$ and $\omega_{p o}$ are the zero and pole frequencies,

$$
\begin{equation*}
Z_{o 0}=\frac{1}{g_{m}} / / R_{2} \quad \omega_{z o}=\frac{1}{R_{s i g} C_{g s}} \quad \omega_{p o}=\frac{1+g_{m} R_{2}}{\left(R_{s i g}+R_{2}\right) C_{g s}} \tag{6.74b}
\end{equation*}
$$

By inspection, the high-frequency asymptotic value is $Z_{o \infty}=R_{s i l} / / R_{1}$. One can easily verify that as long as $C_{g b}, C_{g d}$, and $C_{s b}$ can be ignored, $Z_{o}$ is inductive for $g_{m} R_{s i g}>1$ and capacitive for $g_{m} R_{s i g}<1$.
(a) The source follower of Fig. 6.36 uses a FET with $g_{m}=1 \mathrm{~mA} / \mathrm{V}, g_{m b}=$ $0.1 \mathrm{~mA} / \mathrm{V}, r_{o}=50 \mathrm{k} \Omega$, and $C_{g s}=400 \mathrm{fF}$. Moreover, $R_{s i g}=R_{L}=10 \mathrm{k} \Omega$. Assuming $C_{g b}=C_{g d}=C_{s b}=0$, find the frequency characteristics of $Z_{i}, a$, and $Z_{o}$.
(b) Verify with PSpice both for $C_{g b}=C_{g d}=C_{s b}=0$ and for $C_{g b}=C_{g d}=C_{s b}=$ 25 fF , and comment.

### Solution

We have

$$
\begin{aligned}
& f_{T} \cong \frac{g_{m}}{2 \pi C_{g s}}=\frac{10^{-3}}{2 \pi 400 \times 10^{-12}} \cong 400 \mathrm{MHz} \\
& R_{1}=10 / / 50 / / \frac{1}{0.1}=4.55 \mathrm{k} \Omega
\end{aligned}
$$

$C_{1}=\frac{400}{1+1 \times 4.55} \cong 72 \mathrm{fF}$
$R_{2}=50 / / \frac{1}{0.1}=8.33 \mathrm{k} \Omega$
By Eq. (6.72) the impedance seen by the signal source is
$Z_{i}=\left(\frac{1}{j 2 \pi f \times 72 \times 10^{-15}}+4.55 \times 10^{3}\right) \Omega=\left(\frac{-j 2.21 \times 10^{9}}{f}+4.55\right) \mathrm{k} \Omega$
which has a zero frequency is $f_{z i}=1 /\left(2 \pi R_{1} C_{1}\right)=486 \mathrm{MHz}$. By Eq. (6.71) the gain parameters are
$a_{0}=\frac{1}{1+1 /(1 \times 4.55)}=0.820 \mathrm{~V} / \mathrm{V}=-1.72 \mathrm{~dB}$
$a_{\infty}=\frac{1}{1+10 / 4.55}=0.312 \mathrm{~V} / \mathrm{V}=-10.1 \mathrm{~dB}$
$f_{z a}=400 \mathrm{MHz}$
$f_{p a}=\frac{1+1 \times 4.55}{2 \pi(10+4.55) 10^{3} \times 400 \times 10^{-15}}=152 \mathrm{MHz}$
By. Eq. (6.74) the parameters of the impedance seen by the load are
$Z_{o 0}=\frac{1}{1} / / 8.33=0.893 \mathrm{k} \Omega \quad Z_{o \infty}=10 / / 8.33=4.55 \mathrm{k} \Omega$
$f_{z o}=\frac{1 /(2 \pi)}{10^{4} \times 400 \times 10^{-15}} \cong 40 \mathrm{MHz}$
$f_{p o}=\frac{1+1 \times 8.33}{2 \pi(10+8.33) 10^{3} \times 400 \times 10^{-15}}=202 \mathrm{MHz}$
It is apparent that $Z_{o}$ is inductive, at least up to a point.
(b) Adapting the PSpice circuit of Fig. 6.32 to the present case we obtain the frequency plots of Fig. 6.40. The asymptotic values and break frequencies are in good agreement with the estimated ones under the assumption $C_{g b}=C_{g d}=$ $C_{s b}=0$. With $C_{g b}=C_{g d}=C_{s b}=25 \mathrm{fF}$, the high-frequency asymptotic values tend to zero, turning $Z_{o}$ from inductive to capacitive at high frequencies.
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-010.jpg?height=465&width=1495&top_left_y=1569&top_left_x=119)

FIGURE 6.40 Gain and impedance plots for the source follower of Example 6.14.

### Frequency Characteristics of MOS Current Buffers

Figure 6.41 shows the ac equivalent of the MOS current buffer, along with its highfrequency model. Like the CD configuration, the CG configuration is inherently fast because $C_{g d}$ is exempt from the Miller effect. We wish to find the impedance $Z_{i}(j \omega)$ seen looking into the source terminal, the current gain $a(j \omega)=I_{o} / I_{i}$, and the impedance $Z_{o}(j \omega)$ seen looking into the drain. To this end, refer to the more compact equivalent of Fig. 6.42, obtained by lumping together the capacitances as shown.
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-011.jpg?height=553&width=248&top_left_y=564&top_left_x=200)
(a)
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-011.jpg?height=482&width=970&top_left_y=661&top_left_x=473)
(b)

FIGURE 6.41 (a) The MOS current buffer and (b) its high-frequency small-signal model.

To gain quick insight into the frequency dependence of $Z_{i}$ and $a$ it is convenient to ignore $r_{o}$ for then the input port is isolated from the output port and can thus be analyzed separately. KCL at the input node gives, for $r_{o} \rightarrow \infty$,

$$
I_{i}=\left(g_{m}+g_{m b}\right) V_{i}+\frac{V_{i}}{1 /\left[j \omega\left(C_{g s}+C_{s b}\right)\right]}=\left(g_{m}+g_{m b}\right)\left[1+\frac{j \omega\left(C_{g s}+C_{s b}\right)}{g_{m}+g_{m b}}\right] V_{i}
$$

![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-011.jpg?height=471&width=913&top_left_y=1610&top_left_x=201)

FIGURE 6.42 Compact rendition of the MOS current buffer.

Consequently, the impedance seen by the signal source is

$$
\begin{equation*}
Z_{i}=\frac{V_{i}}{I_{i}}=\frac{1}{g_{m}+g_{m b}} \times \frac{1}{1+j \omega / \omega_{p i}} \quad \omega_{p i}=\frac{g_{m}+g_{m b}}{C_{g s}+C_{s b}} \tag{6.75}
\end{equation*}
$$

The current into a short-circuit load $\left(R_{L}=0\right)$ is, for $r_{o} \rightarrow \infty, I_{o(\mathrm{sc})}=\left(g_{m}+g_{m b}\right) V_{i}=$ $\left(g_{m}+g_{m b}\right) Z_{i} I_{i}$, so the short-circuit current gain is

$$
\begin{equation*}
\alpha(j \omega)=\frac{I_{o(\mathrm{sc})}}{I_{i}}=\frac{1}{1+j \omega / \omega_{p i}} \tag{6.76}
\end{equation*}
$$

with $\omega_{p i}$ as given in Eq. (6.75). Once it reaches the drain node, $I_{o(\mathrm{sc})}$ divides between $R_{L}$ and the capacitance pair $C_{g d}+C_{d b}$, so we use the current-divider rule to write, for $r_{o} \rightarrow \infty$,

$$
I_{o}=\frac{1 /\left[j \omega\left(C_{g d}+C_{d b}\right)\right]}{R_{L}+1 /\left[j \omega\left(C_{g d}+C_{d b}\right)\right]} \alpha(j \omega) I_{i}=\frac{\alpha(j \omega)}{1+j \omega R_{L}\left(C_{g d}+C_{d b}\right)} I_{i}
$$

Substituting Eq. (6.76), we finally obtain the overall current gain

$$
\begin{equation*}
a(j \omega)=\frac{I_{o}}{I_{i}} \cong \frac{1}{\left(1+j \omega / \omega_{p i}\right)\left(1+j \omega / \omega_{L}\right)} \quad \omega_{L} \cong \frac{1}{R_{L}\left(C_{g d}+C_{d b}\right)} \tag{6.77}
\end{equation*}
$$

It is apparent that the CG configuration provides its maximum bandwidth of $\omega_{p i}\left(\cong \omega_{T}\right)$ when the load is a short circuit. For $R_{L} \neq 0$, the additional pole formed by $R_{L}$ with the effective drain capacitance $C_{g d}+C_{d b}$ reduces the bandwidth accordingly.

It is left as an exercise (see Problem 6.28) to prove that the impedance seen by the load is

$$
\begin{gather*}
Z_{o}(j \omega)=\frac{1}{j \omega C_{o}} \times \frac{1+j \omega / \omega_{z o}}{1+j \omega / \omega_{p o}} \quad C_{o}=C_{g d}+C_{d b}+\frac{C_{g s}+C_{s b}}{1+\left(g_{m}+g_{m b}\right) r_{o}}  \tag{6.78a}\\
\omega_{z o}=\frac{1+\left(g_{m}+g_{m b}\right) r_{o}}{r_{o}\left(C_{g s}+C_{s b}\right)} \quad \omega_{p o}=\omega_{z o}+\frac{1}{r_{o}\left(C_{g d}+C_{d b}\right)} \tag{6.78b}
\end{gather*}
$$

The frequency dependence of $Z_{o}$ is dominated by $C_{o}$, and $Z_{o 0} \rightarrow \infty$ at dc because the signal source has been assumed ideal. A practical signal source will have $R_{s i g}<\infty$, in which case we can approximate

$$
\begin{equation*}
Z_{o}(j \omega) \cong \frac{Z_{o 0}}{1+j \omega / \omega_{o}} \quad Z_{o 0}=r_{o}+\left[1+\left(g_{m}+g_{m b}\right) r_{o}\right] R_{s i g} \quad \omega_{o}=\frac{1}{Z_{o 0} C_{o}} \tag{6.79}
\end{equation*}
$$

The CG configuration is investigated further in the end-of-chapter problems.

## 6.7 OPEN-CIRCUIT TIME-CONSTANT (OCTC) ANALYSIS

The preceding sections indicate that ac analysis can become fairly complex even in the case of simple circuits such as single-transistor stages. As the capacitor count increases, exact analysis by paper and pencil may soon become prohibitive. Yet, in everyday practice a designer must be able to come up with quick, if approximate, estimates of a circuit's most salient ac characteristics, such as its $-3-\mathrm{dB}$ frequency,
and identify what changes need to be made in case the circuit fails to meet the specifications. Then, we turn to computer simulation to verify the modified design.

If the circuit contains a single pole, its $-3-\mathrm{dB}$ frequency is the pole frequency itself. Even if it contains additional poles and/or zeros but at sufficiently higher frequencies, $\omega_{-3 \mathrm{~dB}}$ will still be close to the frequency of the lowest pole, aptly referred to as the dominant pole. Eloquent examples were offered by the common-emitter/commonsource amplifiers of Section 6.3, where we used the Miller approximation to speed up the estimation of $\omega_{-3 \mathrm{~dB}}$. We wonder whether there is a quick way to estimate $\omega_{-3 \mathrm{~dB}}$ also in a multi-pole circuit. A widely used such technique is the Open-Circuit TimeConstant (OCTC) Analysis Technique pioneered by P. E. Gray and C. L. Searle in 1969. ${ }^{2}$

To develop an intuitive feel for this technique, start out with a circuit containing a single capacitor $C_{k}$. As we know, a pole arises at the frequency $\omega_{k}$ at which the impedance of $C_{k}$ equals, in magnitude, the equivalent resistance $R_{k}$ presented to $C_{k}$ by the surrounding circuit, a condition that we express as $1 /\left(\omega_{k} C_{k}\right)=R_{k}$. This gives $\omega_{k}=1 / \tau_{k}$, where $\tau_{k}=R_{k} C_{k}$ is the time constant formed by $C_{k}$ and $R_{k}$. As a function of frequency, $C_{k}$ starts out as an open circuit for $\omega \ll \omega_{k}$, it presents an impedance equal in magnitude to $R_{k}$ at $\omega=\omega_{k}$, and it becomes a short circuit for $\omega \gg \omega_{p}$.

What if the circuit contains more than just one capacitance? If there is a dominant pole, we can say that at that pole frequency all capacitances still act as open circuits, except for the capacitance responsible for that one pole, which will exhibit an impedance equal in magnitude to the resistance presented by the surrounding circuit. To find which capacitance is responsible for the dominant pole we need to test one capacitance at a time, assuming all remaining capacitances are acting as open circuits. We find the equivalent resistance seen by the capacitance under scrutiny, and we calculate the corresponding time constant. We repeat this procedure for each capacitance present, and finally we let $\omega_{-3 \mathrm{~dB}} \cong 1 / \tau_{D}$, where $\tau_{D}$ is by far the longest and thus dominant time constant.

What if there isn't a definite dominant time constant in the circuit? The information gathered is still useful, for the OCTC technique states that we can estimate the $-3-\mathrm{dB}$ frequency $\mathrm{as}^{2}$

$$
\begin{equation*}
\omega_{-3 \mathrm{~dB}} \cong \frac{1}{R_{1} C_{1}+R_{2} C_{2}+\cdots+R_{n} C_{n}} \tag{6.80}
\end{equation*}
$$

where $R_{i}$ is the equivalent resistance seen by the capacitance $C_{i}(i=1,2, \ldots n)$ with all other capacitances open-circuited. Note that this technique provides no information about higher-order poles and possibly zeros. It gives only an estimate of the $-3-\mathrm{dB}$ frequency, also called the half-power bandwidth, but via $n$ simple time-constant calculations. Moreover, by showing explicitly which time constant contributes most heavily to the $-3-\mathrm{dB}$ frequency, it pinpoints the parameters that need to be altered if the design fails to meet specific bandwidth requirements. Some examples will better illustrate the OCTC technique.

### OCTC Analysis of the CE/CS Amplifiers

As our first application of the open-circuit time-constant (OCTC) technique, let us return to the circuit of Fig. 6.21 (repeated in Fig. 6.43), representing the com-mon-emitter/common-source voltage amplifier. With three capacitances present
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-014.jpg?height=310&width=802&top_left_y=216&top_left_x=444)

FIGURE 6.43 Revisiting the CE/CS amplifier.
$\left(C_{1}, C_{2}\right.$, and $C_{f}$ ), we need to find three open-circuit equivalent resistances. With reference to Fig. 6.44a, it is apparent that the resistances seen by $C_{1}$ and $C_{2}$ are just $R_{1}$ and $R_{2}$. However, to find $R_{f}$, we can no longer rely on mere inspection, as the presence of the dependent source mandates using the test method instead. With reference to Fig. $6.44 b$ we have, by Ohm's law, $v_{1}=R_{1} i$. By KCL, $R_{2}$ must supply the current $i+g_{m} v_{1}=i+g_{m} R_{1} i$, so $v_{2}=-R_{2}\left(i+g_{m} R_{1} i\right)=-R_{2}\left(1+g_{m} R_{1}\right) i$. By KVL,

$$
v=v_{1}-v_{2}=R_{1} i-\left[-R_{2}\left(1+g_{m} R_{1}\right) i\right]
$$

so, taking the ratio $R_{f}=v / i$ we get

$$
\begin{equation*}
R_{f}=R_{1}+R_{2}+g_{m} R_{1} R_{2} \tag{6.81}
\end{equation*}
$$

Finally, we estimate the 3-dB frequency using Eq. (6.80),

$$
\begin{equation*}
\omega_{-3 \mathrm{~dB}} \cong \frac{1}{R_{1} C_{1}+R_{f} C_{f}+R_{2} C_{2}}=\frac{1}{R_{1} C_{1}+\left(R_{1}+R_{2}+g_{m} R_{1} R_{2}\right) C_{f}+R_{2} C_{2}} \tag{6.82}
\end{equation*}
$$

Aside from a rearrangement of its denominator terms, Eq. (6.82) is identical to Eq. (6.45), which was obtained via the much more laborious exact analysis. Of course, exact analysis provides information also about the higher order pole and zero frequencies, while the OCTC method estimates only $\omega_{-3 \mathrm{~dB}}$. But this is often all the designer wants to know, so if we consider the much simpler calculations required
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-014.jpg?height=389&width=1424&top_left_y=1656&top_left_x=216)

FIGURE 6.44 (a) The open-circuit resistances seen by the capacitances in the generalized voltage amplifier of Fig. 6.43. (b) Using the test method to find $R_{f}$
by the OCTC technique, the latter is a powerful tool indeed. As a final remark, we observe that if we define the multiplier term

$$
\begin{equation*}
M=1+g_{m} R_{2}+\frac{R_{2}}{R_{1}} \tag{6.83}
\end{equation*}
$$

then the time constant $\tau_{f}$ associated with $C_{f}$ is expressed as $\tau_{f}=\left(R_{1} M\right) C_{f}$ in the OCTC approximation, but as $\tau_{f}=R_{1}\left(M C_{f}\right)$ in the Miller approximation. We have two different viewpoints for the same result!

Reconsider the CE amplifier of Example 6.8, for which $g_{m}=1 /(26 \Omega)$, $R_{1}=0.975 \mathrm{k} \Omega, R_{2}=4.55 \mathrm{k} \Omega, C_{\pi}=12 \mathrm{pF}, C_{\mu}=0.5 \mathrm{pF}$ and $C_{s}=1 \mathrm{pF}$.
(a) Estimate $f_{-3 \mathrm{~dB}}$ via the OCTC method, and comment on which capacitor contributes the most and which the least to the dominant-pole frequency.
(b) Propose a way to increase the circuit's bandwidth without reducing its low-frequency gain $a_{0}$.

### Solution

(a) By inspection, the resistances seen by $C_{\pi}$ and $C_{s}$ are, respectively, $R_{\pi}=0.975 \mathrm{k} \Omega$ and $R_{s}=4.55 \mathrm{k} \Omega$. Adapting Eq. (6.81) to the present case we get $R_{\mu}=0.975+$ $4.55+0.975 \times 4.55 / 0.026=176 \mathrm{k} \Omega$. With resistances in $\mathrm{k} \Omega\left(10^{3}\right)$ and capacitances in $\mathrm{pF}\left(10^{-12}\right)$, the time constants in Eq. (6.82) will be in $\mathrm{ns}\left(10^{-9}\right)$,

$$
\begin{aligned}
f_{-3 \mathrm{~dB}} & \cong \frac{1 / 2 \pi}{(0.975 \times 12+176 \times 0.5+4.55 \times 1) \mathrm{ns}} \\
& =\frac{1 / 2 \pi}{(11.7+88+4.6) \mathrm{ns}}=1.53 \mathrm{MHz}
\end{aligned}
$$

This is in excellent agreement with Example 6.8. As expected, the main band-limiting culprit is the time constant associated with $C_{\mu}$, whereas that associated with $C_{s}$ counts the least.
(b) An obvious way to increase the bandwidth is to reduce $R_{\mu}$ as it intervenes in the longest time constant. By Eq. (6.81), this resistance depends both on $R_{1}$ and $R_{2}$. To avoid significantly perturbing the low-frequency gain $a_{0}$, don't change $R_{2}$. This leaves $R_{1}$, which can be reduced by driving the amplifier with a low output-impedance signal source. In the limit $R_{s i g} \rightarrow 0$ we have $R_{1}=r_{n} / / r_{b}$, so

$$
\begin{aligned}
& R_{\pi}=R_{1}=5.2 / / 0.2=0.193 \mathrm{k} \Omega \\
& R_{\mu}=0.193+4.55+0.193 \times 4.55 / 0.026=38.4 \mathrm{k} \Omega
\end{aligned}
$$

Consequently, in the limit $R_{s i g} \rightarrow 0$ we get

$$
\begin{aligned}
f_{-3 \mathrm{~dB}} & \cong \frac{1 / 2 \pi}{(0.193 \times 12+38.4 \times 0.5+4.55 \times 1) \mathrm{ns}} \\
& =\frac{1 / 2 \pi}{(2.3+19.2+4.6) \mathrm{ns}} \cong 6 \mathrm{MHz}
\end{aligned}
$$

indicating a bandwidth expansion of almost two octaves. (It can be seen that with $R_{s i g}=0, a_{0}$ is raised from $-142 \mathrm{~V} / \mathrm{V}$ to $-169 \mathrm{~V} / \mathrm{V}$. Usually this is not a problem, but if it is, we can always tweak with the value of $R_{2}$ to re-establish the original gain.)

Remark: If the available signal source doesn't have a sufficiently low $R_{s i g}$, we can interpose a voltage buffer between source and amplifier. A buffer provides high input impedance, low output impedance, and close-to-unity gain over a much wider bandwidth than the voltage amplifier under consideration, so it will serve the required function of impedance translation quite well.

EXAMPLE 6.16 Reconsider the CS amplifier of Exercise 6.3, for which $g_{m}=4 \mathrm{~mA} / \mathrm{V}, R_{1}=10 \mathrm{k} \Omega$, $R_{2}=4.55 \mathrm{k} \Omega, C_{g s}=1.17 \mathrm{pF}$, and $C_{g d}=0.1 \mathrm{pF}$. Assuming $C_{d b}=0.2 \mathrm{pF}$, estimate $f_{-3 \mathrm{~dB}}$ via the OCTC method.

### Solution

By inspection, $R_{g s}=10 \mathrm{k} \Omega$ and $R_{d b}=4.55 \mathrm{k} \Omega$. Adapting Eq. (6.81) to the present case, $R_{g d}=10+4.55+4 \times 10 \times 4.55=196 \mathrm{k} \Omega$. With resistances in $\mathrm{k} \Omega$ and capacitances in pF , the time constants will be in ns ,

$$
\begin{aligned}
f_{-3 \mathrm{~dB}} & \cong \frac{1 / 2 \pi}{(10 \times 1.17+196 \times 0.1+4.55 \times 0.2) \mathrm{ns}} \\
& =\frac{1 / 2 \pi}{(11.7+19.6+0.91) \mathrm{ns}}=4.9 \mathrm{MHz}
\end{aligned}
$$

in close agreement with Exercise 6.3.

### OCTC Analysis of Voltage Buffers

The emitter follower of Fig. 6.30b, repeated for convenience in Fig. 6.45, was analyzed under the assumption $C_{\mu}=0$ to keep the derivations manageable. We now wish to estimate its $-3-\mathrm{dB}$ frequency via the OCTC technique, but with $C_{\mu}$ present. To find the open-circuit equivalent resistances, use the circuit of Fig. $6.46 a$ with $R_{1}=R_{s i g}+r_{b}$ and $R_{2}=R_{L} / / r_{o}$, as shown. With reference to the node common to $R_{1}$ and $r_{\pi}$ we observe that looking to the left we see $R_{1}$, and looking down toward the right we see $r_{\pi}+\left(\beta_{0}+1\right) R_{2}$, so the resistance seen by $C_{\mu}$ is

$$
\begin{equation*}
R_{\mu}=R_{1} / /\left[r_{\pi}+\left(\beta_{0}+1\right) R_{2}\right] \tag{6.84}
\end{equation*}
$$

To find $R_{\pi}$ we need to apply the test method of Fig. 6.46b. By KCL, the current into $R_{1}$ is $i_{1}=i-v / r_{\pi}$ and that into $R_{2}$ is $i_{2}=v / r_{\pi}+g_{m} v-i$, so we can write

$$
v=R_{1} i_{1}-R_{2} i_{2}=R_{1}\left(i-\frac{v}{r_{\pi}}\right)-R_{2}\left(\frac{v}{r_{\pi}}+g_{m} v-i\right)
$$

![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-017.jpg?height=473&width=971&top_left_y=200&top_left_x=198)

FIGURE 6.45 Revisiting the emitter follower.
Collecting and taking the ratio $R_{\pi}=v / i$ we get, after some algebra,

$$
\begin{equation*}
R_{\pi}=r_{\pi} / / \frac{R_{1}+R_{2}}{1+g_{m} R_{2}} \tag{6.85}
\end{equation*}
$$

Finally,

$$
\begin{align*}
\omega_{-3 \mathrm{~dB}} & \cong \frac{1}{R_{\pi} C_{\pi}+R_{\mu} C_{\mu}} \\
& =\frac{1}{\left\{r_{\pi} / /\left[\left(R_{1}+R_{2}\right) /\left(1+g_{m} R_{2}\right)\right]\right\} C_{\pi}+\left\{R_{1} / /\left[r_{\pi}+\left(\beta_{0}+1\right) R_{2}\right]\right\} C_{\mu}} \tag{6.86}
\end{align*}
$$

![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-017.jpg?height=440&width=1486&top_left_y=1245&top_left_x=201)

FIGURE 6.46 (a) The open-circuit resistances seen by the capacitances of the emitter follower of Fig. 6.45. (b) Using the test method to find $R_{\pi}$.

Reconsider the emitter follower of Example 6.11, for which $\beta_{0}=150, g_{m}=$
EXAMPLE 6.17 $1 /(13 \Omega), r_{\pi}=1.95 \mathrm{k} \Omega, R_{1}=2.2 \mathrm{k} \Omega, R_{2}=4.44 \mathrm{k} \Omega, C_{\pi}=29.6 \mathrm{pF}$, and $C_{\mu}=$ 1 pF . Estimate $f_{-3 \mathrm{~dB}}$ via the OCTC method, comment.

### Solution

By Eqs. (6.84) through (6.86), we have

$$
R_{\pi}=1.95 / / \frac{2.2+4.44}{1+4.44 / 0.013} \mathrm{k} \Omega=19.2 \Omega
$$

$$
\begin{aligned}
R_{\mu}= & 2.2 / /(1.95+151 \times 4.44)=2.19 \mathrm{k} \Omega \\
f_{-3 \mathrm{~dB}} & \cong \frac{1 / 2 \pi}{19.2 \times 29.6 \times 10^{-12}+2.19 \times 10^{3} \times 10^{-12}} \\
& =\frac{1 / 2 \pi}{(0.57+2.19) \mathrm{ns}}=58 \mathrm{MHz}
\end{aligned}
$$

This estimate is in reasonable agreement with the value of 66 MHz obtained via the PSpice circuit of Fig. 6.32. Clearly, the time constant due to $C_{\mu}$ is the dominant one in this case.
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-018.jpg?height=433&width=1050&top_left_y=758&top_left_x=447)

Next, we turn to the source follower of Fig. $6.36 b$, repeated for convenience in Fig. 6.47. To find its open-circuit equivalent resistances we rearrange it in the form of Fig. 6.48. By inspection,

$$
\begin{equation*}
R_{g b}=R_{s i g} \quad R_{s b}=R_{L} / / r_{o} / / \frac{1}{g_{m b}} / / / \frac{1}{g_{m}} \tag{6.87}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-018.jpg?height=428&width=776&top_left_y=1615&top_left_x=448)

FIGURE 6.48 The open-circuit resistances seen by the capacitances in the source follower of Fig. 6.47.

To find $R_{g s}$ and $R_{g d}$ we note this circuit's similarity to its bipolar counterpart of Fig. 6.46, except that now $r_{\pi} \rightarrow \infty$. To save labor we thus recycle Eqs. (6.84) and (6.85) by letting $r_{\pi} \rightarrow \infty$ and $\beta_{0} \rightarrow \infty$, and get

$$
\begin{equation*}
R_{g d}=R_{1}=R_{s i g} \quad R_{g s}=\frac{R_{1}+R_{2}}{1+g_{m} R_{2}}=\frac{R_{s i g}+\left[R_{L} / / r_{o} / /\left(1 / g_{m b}\right)\right]}{1+g_{m}\left[R_{L} / / r_{o} / /\left(1 / g_{m b}\right)\right]} \tag{6.88}
\end{equation*}
$$

We now have all the parameters needed to estimate $f_{-3 \mathrm{~dB}}$.

### Exercise 6.5

Reconsider the source follower of Example 6.14, having $g_{m}=1 \mathrm{~mA} / \mathrm{V}, g_{m b}=$ $0.1 \mathrm{~mA} / \mathrm{V}, r_{o}=50 \mathrm{k} \Omega, C_{g s}=400 \mathrm{fF}, C_{g b}=C_{g d}=C_{s b}=25 \mathrm{fF}$, and $R_{s i g}=R_{L}=$ $10 \mathrm{k} \Omega$. Use the OCTC technique to estimate $f_{-3 \mathrm{~dB}}$.
Ans. 122 MHz.

### Voltage Amplifiers with Emitter/Source Degeneration

Recall that degeneration reduces gain in a CE/CS amplifier. Consequently, we expect a reduced Miller multiplier and, hence, a higher value for $f_{-3 \mathrm{~dB}}$. Gain-bandwidth tradeoffs arise all the time in electronics, as we shall frequently see. We wish to use the OCTC technique to estimate the $-3-\mathrm{dB}$ frequency of a voltage amplifier with degeneration.

Consider first the CE-ED amplifier shown in ac form in Fig. 6.49a. As long as $r_{o}$ is fairly large compared with the resistances external to the BJT, we can ignore $r_{o}$ altogether to simplify our analysis. Turning to the open-circuit equivalent of Fig. 6.49b, we adapt Eq. (6.85) to obtain an expression for $R_{\pi}$,

$$
\begin{equation*}
R_{\pi} \cong r_{\pi} / / \frac{R_{B}+R_{E}}{1+g_{m} R_{E}} \tag{6.89}
\end{equation*}
$$

Also, by inspection,
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-019.jpg?height=492&width=391&top_left_y=1553&top_left_x=206)
(a)

$$
R_{s} \cong R_{C}
$$

![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-019.jpg?height=414&width=1006&top_left_y=1629&top_left_x=650)
(b)

FIGURE 6.49 (a) The CE-ED amplifier, and (b) the open-circuit resistances seen by its capacitances.
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-020.jpg?height=269&width=530&top_left_y=220&top_left_x=444)

FIGURE 6.50 Equivalent circuit to find $R_{\mu}$ in Fig. 6.49b.

To find $R_{\mu}$ we use the test method, but after having reduced the circuit of Fig. 6.49b to the more compact form of Fig. 6.50. Here, $R_{1}$ and $R_{2}$ represent the equivalent resistances seen looking from the positive and from the negative terminals of the test source, and $G_{m}$ represents the degenerated transconductance. Adapting the expressions tabulated in Fig. 4.9, we have, for $R_{C} \ll r_{o}$,

$$
\begin{gather*}
R_{1} \cong\left(R_{s i g}+r_{b}\right) / /\left[r_{\pi}+\left(\beta_{0}+1\right) R_{E}\right] \quad R_{2} \cong R_{C}  \tag{6.91}\\
G_{m}=\frac{g_{m}}{1+g_{m} R_{E}} \tag{6.92}
\end{gather*}
$$

But the circuit of Fig. 6.50 is formally identical to that of Fig. 6.44b, so we adapt Eq. (6.81) to the present case and write

$$
\begin{equation*}
R_{\mu} \cong R_{1}+R_{2}+G_{m} R_{1} R_{2} \tag{6.93}
\end{equation*}
$$

We now have all the parameters needed to estimate $f_{-3 \mathrm{~dB}}$.

EXAMPLE 6.18 (a) Investigate the effect of adding an emitter-degeneration resistance $R_{E}=500 \Omega$ to the CE amplifier of Example 6.8. Compare with the example, and comment. (b) Verify via PSpice.

### Solution

(a) Recall that $\beta_{0}=200, r_{b}=200 \Omega, g_{m}=1 /(26 \Omega), r_{\pi}=5.2 \mathrm{k} \Omega, r_{o}=50 \mathrm{k} \Omega$, $C_{\pi}=12 \mathrm{pF}, C_{\mu}=0.5 \mathrm{pF}$, and $C_{s}=1 \mathrm{pF}$. With $R_{s i g}=1 \mathrm{k} \Omega, R_{C}=5 \mathrm{k} \Omega$, and $R_{E}=0.5 \Omega$ we have $R_{B}=1+0.2=1.2 \mathrm{k} \Omega$. All these resistances are much smaller than $r_{o}$, so we expect the above approximations to be reasonable. By Eqs. (6.89) and (6.90),

$$
R_{\pi} \cong 5.2 / / \frac{1.2+0.5}{1+0.5 / 0.026}=82.7 \Omega \quad R_{s} \cong 5 \mathrm{k} \Omega
$$

By Eq. (6.91), $R_{1} \cong 1.2 / /(5.2+201 \times 0.5)=1.2 / / 105.7=1.19 \mathrm{k} \Omega$ and $R_{2} \cong$ $5 \mathrm{k} \Omega$. By Eqs. (6.92) and (6.93),

$$
G_{m}=\frac{1 / 26}{1+500 / 26}=\frac{1}{526 \Omega} \quad R_{\mu}=1.19+5+\frac{1.99 \times 5}{0.526}=17.5 \mathrm{k} \Omega
$$

Finally, expressing resistances in $\mathrm{k} \Omega$ and capacitances in pF , we get

$$
f_{-3 d B}=\frac{1 / 2 \pi}{R_{\pi} C_{\pi}+R_{\mu} C_{\mu}+R_{s} C_{s}} \cong \frac{1 / 2 \pi}{(1+8.75+5) \mathrm{ns}}=10.8 \mathrm{MHz}
$$

Compared to the case $R_{E}=0$ of Example 6.15, there has been an order-of-magnitude reduction both in $\tau_{\pi}$ and in $\tau_{\mu}$, causing $f_{-3 \mathrm{~dB}}$ to increase from about 1.53 MH to 10.8 MHz . On the other hand, the low-frequency gain has dropped from $a_{0}=-142 \mathrm{~V} / \mathrm{V}(43 \mathrm{~dB})$ of Example 6.8 to the present value

$$
a_{0}=\frac{105.7}{1.2+105.7} \times \frac{-5}{0.526} \cong-9.4 \mathrm{~V} / \mathrm{V}(19.5 \mathrm{~dB})
$$

(b) To verify via PSpice, reuse the circuit of Fig. 6.22, but after lifting the emitter terminal off ground to insert $R_{E}=500 \Omega$ between emitter and ground. The simulation yields the Bode plots of Fig. 6.51, which are in good agreement with the results found via the OCRC technique.
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-021.jpg?height=461&width=1314&top_left_y=819&top_left_x=240)

FIGURE 6.51 Gain plots for the CE amplifier of Example $6.8\left(R_{E}=0\right)$, and the CE-ED amplifier of Example $6.18\left(R_{E}=0.5 \mathrm{k} \Omega\right)$.

Next, we turn to the CS-SD amplifier of Fig. 6.52a. With reference to its opencircuit equivalent of Fig. $6.52 b$ we find, by inspection,

$$
\begin{equation*}
R_{g b}=R_{s i g} \quad R_{s b}=R_{S} / / R_{s} \quad R_{d b}=R_{D} / / R_{d} \tag{6.94}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-021.jpg?height=495&width=1448&top_left_y=1579&top_left_x=194)

FIGURE 6.52 (a) The CS-SD amplifier and (b) the open-circuit resistances seen by its capacitances.
where $R_{s}$ and $R_{d}$ are the resistances seen looking into the source and the drain, both of which are tabulated in Fig. 4.23. To find $R_{g d}$ we simply adapt Eqs. (6.92) and (6.93) to the MOS case,

$$
\begin{equation*}
R_{g d} \cong R_{s i g}+R_{d b}+\frac{g_{m}}{1+\left(g_{m}+g_{m b}\right) R_{S}} R_{s i g} R_{d b} \tag{6.95}
\end{equation*}
$$

Finally, to find $R_{g s}$ we apply the test method as usual. The result, whose derivation is left as an exercise for the reader, is

$$
\begin{equation*}
R_{g s}=\frac{R_{s i g}+R_{S}+g_{m b} R_{s i g} R_{S}+\left(R_{s i g} R_{S}+R_{s i g} R_{D}+R_{D} R_{S}\right) / r_{o}}{1+\left(g_{m}+g_{m b}\right) R_{S}+\left(R_{D}+R_{S}\right) / r_{o}} \tag{6.96}
\end{equation*}
$$

We now have all the parameters needed to estimate $f_{-3 \mathrm{~dB}}$.

EXAMPLE 6.19 Let the CS-SD amplifier of Fig. $6.52 a$ have $g_{m}=2 \mathrm{~mA} / \mathrm{V}, g_{m b}=0.25 \mathrm{~mA} / \mathrm{V}$, $r_{o}=25 \mathrm{k} \Omega, C_{g s}=100 \mathrm{fF}, C_{g b}=C_{s b}=C_{g d}=C_{d b}=7.5 \mathrm{fF}$. If $R_{s i g}=10 \mathrm{k} \Omega, R_{D}=$ $20 \mathrm{k} \Omega$, and $R_{S}=1 \mathrm{k} \Omega$, estimate its gain-bandwidth product via the OCTC method.

### Solution

By Eq. (4.39a), the low-frequency gain is

$$
a_{0}=\frac{-2 \times 20}{1+(2+0.25) 1+(20+1) / 25}=-9.78 \mathrm{~V} / \mathrm{V}
$$

and the resistances seen looking into the source and drain are $R_{s}=0.786 \Omega$ and $R_{d}=82.3 \mathrm{k} \Omega$, so Eq. (6.94) gives

$$
R_{g b}=10 \mathrm{k} \Omega \quad R_{s b}=1 / / 0.786=0.44 \mathrm{k} \Omega \quad R_{d b}=20 / / 82.3=16.1 \mathrm{k} \Omega
$$

Likewise, Eqs. (6.95) and (6.96) give

$$
R_{g d} \cong 125 \mathrm{k} \Omega \quad R_{g s}=5.55 \mathrm{k} \Omega
$$

Consequently,

$$
\begin{aligned}
f_{-3 \mathrm{~dB}} & =\frac{1 / 2 \pi}{\tau_{g b}+\tau_{s b}+\tau_{g d}+\tau_{g s}+\tau_{d b}} \\
& \cong \frac{1 / 2 \pi}{(75+3.3+937.5+555+121) \mathrm{ps}} \cong 94.1 \mathrm{MHz}
\end{aligned}
$$

Finally, $\mathrm{GBP} \cong 9.78 \times 94.1 \cong 920 \mathrm{MHz}$. The main band-limiting culprits are $C_{g d}$ and $C_{g s^{\circ}}$. A PSpice simulation confirms the above results.

Additional examples of OCTC analysis are addressed in the end-of-chapter problems.

## 6.8 FREQUENCY RESPONSE OF CASCODE AMPLIFIERS

In Chapter 4 we investigated the use of cascoding as a means to raise the unloaded voltage gain dramatically. We are now ready to appreciate another inherent advantage of cascoding, namely, an increase in the gain-bandwidth product (GBP).

### The Bipolar Cascode

Shown in Fig. 6.53a is the ac equivalent of the bipolar cascode configuration, highlighting the capacitances intervening in the frequency response. We wish to estimate the $-3-\mathrm{dB}$ frequency via OCTC analysis. The node labeled as $V_{x}$ plays an important role in this circuit, so we start out by finding the open-circuit equivalent resistance $R_{x}$ between this node and ground. With reference to Fig. $6.53 b$ we note that $R_{x}=r_{o 1} / / R_{e 2}$, where $R_{e 2}$ is the resistance seen looking into $Q_{2}$ 's emitter. This is obtained by adapting Eq. (4.10) to the present case. The result is

$$
\begin{equation*}
R_{x}=r_{o 1} / l\left[\left(\frac{r_{b 2}+r_{\pi 2}}{\beta_{02}+1} / / r_{o 2}\right) \times \frac{1+R_{C} / r_{o 2}}{1+R_{C} /\left[\left(\beta_{02}+1\right) r_{o 2}+r_{b 2}+r_{\pi 2}\right]}\right] \tag{6.97}
\end{equation*}
$$

(Note that for large $r_{o 1}$ and $\beta_{02}$ we have $R_{x} \cong r_{e 2}+r_{b 2} /\left(\beta_{02}+1\right)$ for $R_{C} \rightarrow 0$, and $R_{x} \cong$ $r_{\pi 2}+r_{b 2}$ for $R_{C} \rightarrow \infty$ ).

We observe that $Q_{1}$ is similar to the circuit of Fig. 6.43, but with $R_{2}=R_{x}$. We can thus recycle the results developed there and write,

$$
\begin{equation*}
R_{\pi 1}=\left(R_{s i g}+r_{b 1}\right) / / r_{\pi 1} \quad R_{\mu 1}=R_{\pi 1}+R_{x}+g_{m 1} R_{\pi 1} R_{x} \quad R_{s 1}=R_{x} \tag{6.98}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-023.jpg?height=846&width=1332&top_left_y=1195&top_left_x=198)

FIGURE 6.53 (a) The bipolar cascode configuration, with all relevant stray capacitances explicitly shown outside of the BJTs. (b) Circuit for the calculation of the open-circuit equivalent resistances.

Likewise, $Q_{2}$ is similar to the circuit of Fig. 6.49b, but with $R_{B}=r_{b 2}$ and $R_{E}=r_{o 1}$. We can thus recycle the results developed there and write,

$$
\begin{equation*}
R_{\pi 2} \cong r_{\pi 2} / / \frac{r_{b 2}+r_{o 1}}{1+g_{m 2} r_{o 1}} \cong r_{e 2} \quad R_{\mu 2} \cong R_{1}+R_{2}+G_{m 2} R_{1} R_{2} \quad R_{s 2} \cong R_{C} \tag{6.99}
\end{equation*}
$$

where

$$
\begin{equation*}
R_{1} \cong r_{b 2} / /\left[r_{\pi 2}+\left(\beta_{02}+1\right) r_{o 1}\right] \cong r_{b 2} \quad R_{2} \cong R_{C} \quad G_{m 2}=\frac{g_{m 2}}{1+g_{m 2} r_{o 1}} \cong \frac{1}{r_{o 1}} \tag{6.100}
\end{equation*}
$$

It is now a straightforward matter to apply Eq. (6.80) to estimate the $f_{-3 \mathrm{~dB}}$ for the bipolar cascode.

EXAMPLE 6.20 The CE amplifier of Example 6.15 was found to have $f_{-3 \mathrm{~dB}}=1.53 \mathrm{MHz}$ with $R_{s i g}=1 \mathrm{k} \Omega$ and $R_{C}=5 \mathrm{k} \Omega$. What happens if we buffer it to $R_{C}$ via a CB stage, thus implementing a cascoded pair? Compare and comment. (For simplicity assume identical BJT parameters, namely, $\beta_{0}=200, r_{b}=200 \Omega, g_{m}=1 /(26 \Omega), r_{\pi}=$ $5.2 \mathrm{k} \Omega, r_{o}=50 \mathrm{k} \Omega, C_{\pi}=12 \mathrm{pF}, C_{\mu}=0.5 \mathrm{pF}$ and $C_{s}=1 \mathrm{pF}$. Also, assume $r_{\mu}=\infty$.)

### Solution

Applying Eq. (6.97) with suitable approximations we get

$$
R_{x} \cong \frac{200+5200}{201} \times \frac{1+5 / 50}{1+0}=29.5 \Omega
$$

We immediately observe that with such a small equivalent collector resistance, $Q_{1}$ is going to provide very little voltage gain, resulting in a very small Miller multiplier for $C_{\mu 1}$. With the given data, this gain is $v_{x} / v_{b 1}=-g_{m 1} R_{x}=-29.5 / 26=$ $-1.13 \mathrm{~V} / \mathrm{V}$, indicating a Miller multiplier of just over 2 . We thus anticipate a wider bandwidth for the CE-CB pair compared to the basic CE amplifier of Example 6.15. Using Eqs. (6.98) through (6.100) we readily calculate

$$
\begin{array}{lll}
R_{\pi 1}=975 \Omega & R_{\mu 1}=2111 \Omega & R_{s 1}=29.5 \Omega \\
R_{\pi 2} \cong 26 \Omega & R_{\mu 2} \cong 5 \mathrm{k} \Omega & R_{s 2}=5 \mathrm{k} \Omega
\end{array}
$$

With resistances in $\mathrm{k} \Omega\left(10^{3}\right)$ and capacitances in $\mathrm{pF}\left(10^{-12}\right)$, the time constants will be in ns $\left(10^{-9}\right)$,

$$
\begin{aligned}
f_{-3 \mathrm{~dB}} & \cong \frac{1}{2 \pi\left(\tau_{\pi 1}+\tau_{\mu 1}+\tau_{s 1}+\tau_{\pi 2}+\tau_{\mu 2}+\tau_{s 2}\right)} \\
& =\frac{1 / 2 \pi}{(11.7+1.06+0.03+0.31+2.5+5) \mathrm{ns}} \cong 7.7 \mathrm{MHz}
\end{aligned}
$$

Compared to the basic CE amplifier of Example 6.15, the cascode pair is far less affected by the Miller effect. In fact, $\tau_{\mu 1}$ is now rather small, and the main bandlimiting culprits are $C_{\pi 1}$ and $C_{s 2}$.

Investigate the limiting case in which the cascode circuit of Example 6.20 is terminated on an ideal current-source load so that $R_{C} \rightarrow \infty$. Compare the two situations, verify with PSpice, and comment.

### Solution

Letting $R_{C} \rightarrow \infty$ in Eq. (6.97) raises $R_{x}$ to

$$
R_{x}=r_{o 1} / /\left(r_{b 2}+r_{\pi 2}\right)=50 / /(0.2+5.2)=4.87 \mathrm{k} \Omega
$$

This increase has no effect on $R_{\pi 1}$, but raises $R_{\mu 1}$ and $R_{s 1}$. Using again Eqs. (6.98) through (6.100) we get

$$
R_{\pi 1}=975 \Omega \quad R_{\mu 1} \cong 188 \mathrm{k} \Omega \quad R_{s 1}=4.87 \mathrm{k} \Omega
$$

Also, adapting Eq. (4.11) to the present case we find, for negligible $r_{b}$,

$$
R_{s 2}=R_{c 2} \cong r_{o 2}\left(1+\beta_{02} \frac{r_{o 1}}{r_{o 1}+r_{\pi 2}}\right)=9.1 \mathrm{M} \Omega \quad R_{\mu 2} \cong R_{s 2}=9.1 \mathrm{M} \Omega
$$

With $Q_{2}$ 's collector terminated on an ac open circuit, we now have

$$
R_{\pi 2}=r_{\pi 2} / /\left(r_{b 2}+r_{o 1}\right)=4.95 \mathrm{k} \Omega
$$

Finally,

$$
\begin{aligned}
f_{-3 \mathrm{~dB}} & \cong \frac{1 / 2 \pi}{\tau_{\pi 1}+\tau_{\mu 1}+\tau_{s 1}+\tau_{\pi 2}+\tau_{\mu 2}+\tau_{s 2}} \\
& \cong \frac{1 / 2 \pi}{(12+94+5+59+4550+9100) \mathrm{ns}} \cong 11.5 \mathrm{kHz}
\end{aligned}
$$

We observe that letting $R_{C} \rightarrow \infty$ increases $R_{x}$ significantly, causing $Q_{1}$ to provide a much higher gain, namely, $v_{x} / v_{b 1}=-g_{m 1} R_{x}=-4870 / 26=-187 \mathrm{~V} / \mathrm{V}$. Consequently, we now have a Miller multiplier of 188 , which raises $\tau_{\mu 1}$ from about 1 ns to 94 ns . The other major effect of letting $R_{C} \rightarrow \infty$ is the dramatic increase in the output resistance $R_{o}$, namely, from $5 \mathrm{k} \Omega$ to $9.1 \mathrm{M} \Omega$. While raising the unloaded gain $a_{0}$, this also reduces the pole frequency $f_{-3 \mathrm{~dB}}$ in proportion.

Using the PSpice circuit of Fig. 6.54 we obtain the frequency plots of Fig. 6.55. It is apparent that in the limit $R_{C} \rightarrow \infty$ the main band-limiting culprits are $C_{\mu 2}$ and $C_{s 2}$, which establish a dominant pole at

$$
f_{p}=\frac{1}{2 \pi R_{o}\left(C_{s 2}+C_{\mu 2}\right)}=11.7 \mathrm{kHz}
$$

![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-026.jpg?height=722&width=1343&top_left_y=212&top_left_x=296)

FIGURE 6.54 PSpice circuit to display gain vs. frequency for the CE-CB amplifier.
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-026.jpg?height=510&width=1334&top_left_y=1088&top_left_x=263)

FIGURE 6.55 Gain plots for the CE-CB amplifier of Example $6.20\left(R_{C}=5 \mathrm{k} \Omega\right)$ and of Example $6.21\left(R_{C}=\infty\right)$.

### The MOS Cascode

Shown in Fig. $6.56 a$ is the ac equivalent of the MOS cascode configuration, along with all capacitances affecting its frequency response. We wish to estimate the $-3-\mathrm{dB}$ frequency via the OCTC technique. As in the bipolar case, the node labeled as $V_{x}$ plays an important role in this circuit, so we start out by finding the opencircuit equivalent resistance $R_{x}$ between this node and ground. With reference to
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-027.jpg?height=949&width=1072&top_left_y=162&top_left_x=201)

FIGURE 6.56 (a) The MOS cacode configuration, with all relevant stray capacitances explicitly shown outside of the FETs. (b) Circuit for the calculation of the open-circuit equivalent resistances.

Fig. $6.56 b$ we note that $R_{x}=R_{d 1} / / R_{s 2}$, where $R_{d 1}$ and $R_{s 2}$ are the resistances seen looking into $M_{1}$ 's drain and $M_{2}$ 's source, respectively. The former is simply $r_{o 1}$, and the latter is obtained by adapting Eq. (4.40a) to the present case. The result can be written as

$$
\begin{equation*}
R_{x}=r_{o 1} / / \frac{r_{o 2}+R_{D}}{1+\left(g_{m 2}+g_{m b 2}\right) r_{o 2}} \tag{6.101}
\end{equation*}
$$

(Note that for $R_{D} \rightarrow 0$ we have $R_{x} \cong 1 /\left(g_{m 2}+g_{m 2}\right)$, whereas for $R_{D} \rightarrow \infty$ we have $R_{x} \cong$ $r_{o 1}$.) Next, using inspection and also adapting Eq. (6.81) to the present case we write

$$
\begin{equation*}
R_{g s 1}=R_{s i g} \quad R_{g d 1}=R_{s i g}+R_{x}+g_{m 1} R_{s i g} R_{x} \quad R_{d b 1}=R_{x} \tag{6.102}
\end{equation*}
$$

Finally, using again inspection and adapting Eq. (4.41) to the present case we write

$$
\begin{equation*}
R_{g s 2}=R_{x} \quad R_{g d 2}=R_{D} / /\left[r_{o 1}+r_{o 2}+\left(g_{m 2}+g_{m b 2}\right) r_{o 1} r_{o 2}\right] \quad R_{d b 2}=R_{g d 2} \tag{6.103}
\end{equation*}
$$

It is now a straightforward matter to apply Eq. (6.80) to estimate the $-3-\mathrm{dB}$ frequency of the MOS cascode.
(a) Find the product $\left|a_{0}\right| \times f_{-3 \mathrm{~dB}}$ of a CS amplifier implemented with a MOSFET having $g_{m}=1.0 \mathrm{~mA} / \mathrm{V}, r_{o}=25 \mathrm{k} \Omega, C_{g s}=100 \mathrm{fF}$, and $C_{g d}=C_{d b}=20 \mathrm{fF}$. Assume the circuit is driven by a source with $R_{s i g}=10 \mathrm{k} \Omega$ and is terminated on an ideal current-source load so that $R_{D}=\infty$ and the low-frequency gain coincides with the intrinsic gain.
(b) Repeat, but for the case in which the CS stage is buffered to the active load via a CG stage, thus implementing a cascode pair. Compare and comment. (For simplicity, assume identical parameters for the two FETs. Also, assume $\chi_{2}=0.1$.)
(c) Verify with PSpice.

### Solution

(a) The plain CS amplifier has a low-frequency intrinsic gain of

$$
a_{0}=-g_{m} r_{o}=-1 \times 25=-25 \mathrm{~V} / \mathrm{V} \cong 28 \mathrm{~dB}
$$

Using inspection and adapting Eq. (6.81), we write

$$
R_{g d}=R_{s i g}+r_{o}+g_{m} R_{s i g} r_{o}=10+25+1 \times 10 \times 25=285 \mathrm{k} \Omega
$$

With resistances in $\mathrm{k} \Omega\left(10^{3}\right)$ and capacitances in $\mathrm{fF}\left(10^{-15}\right)$, the time constants will be in ps ( $10^{-12}$ ),

$$
\begin{aligned}
f_{-3 \mathrm{~dB}} & \cong \frac{1}{2 \pi\left(\tau_{g s}+\tau_{g d}+\tau_{d b}\right)}=\frac{1 / 2 \pi}{(10 \times 100+285 \times 20+25 \times 20) \mathrm{ps}} \\
& =\frac{1 / 2 \pi}{(1+5.7+0.5) \mathrm{ns}} \cong 22 \mathrm{MHz}
\end{aligned}
$$

Finally, $\left|a_{0}\right| \times f_{-3 \mathrm{~dB}}=25 \times 22=550 \mathrm{MHz}$.
(b) Cascoding will raise the intrinsic gain to

$$
\begin{aligned}
a_{0} & =-g_{m 1} r_{o 1}\left[1+\left(g_{m 2}+g_{m b 2}\right) r_{o 2}\right]=-25(1+1.1 \times 25) \\
& =-712.5 \mathrm{~V} / \mathrm{V}=57 \mathrm{~dB}
\end{aligned}
$$

To apply the OCTC method we note that with an ideal current-source load we have $R_{D}=\infty$, so Eq. (6.102) gives $R_{x}=r_{o 1}=25 \mathrm{k} \Omega$. Using inspection, along with Eqs. (6.102) and (6.103), we now have

$$
\begin{aligned}
& R_{g s 1}=10 \mathrm{k} \Omega \quad R_{d b 1}=R_{g s 2}=25 \mathrm{k} \Omega \quad R_{g d 1}=285 \mathrm{k} \Omega \\
& R_{g d 2}=R_{d b 2}=737.5 \mathrm{k} \Omega
\end{aligned}
$$

With resistances in $\mathrm{k} \Omega\left(10^{3}\right)$ and capacitances in $\mathrm{pF}\left(10^{-12}\right)$, the time constants will be in ns $\left(10^{-9}\right)$,

$$
\begin{aligned}
f_{-3 \mathrm{~dB}} & \cong \frac{1 / 2 \pi}{\tau_{g s 1}+\tau_{g d 1}+\tau_{d b 1}+\tau_{g s 2}+\tau_{g d 2}+\tau_{d b 2}} \\
& =\frac{1 / 2 \pi}{(1+5.7+0.5+2.5+14.7+14.7) \mathrm{ns}}=4.1 \mathrm{MHz}
\end{aligned}
$$

![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-029.jpg?height=503&width=1260&top_left_y=211&top_left_x=194)

FIGURE 6.57 Gain plots for the Cs and the CS-CB amplifiers of Example 6.22.
We now have $\left|a_{0}\right| \times f_{-3 \mathrm{~dB}}=712.5 \times 4.1=2.9 \mathrm{GHz}$. Cascoding has raised $a_{0}$ while lowering $f_{-3 \mathrm{~dB}}$. Yet their product is still higher than in part (a). The main band-limiting culprits are now $C_{g d 2}$ and $C_{d b 2}$, which form a pole with the high output resistance $R_{o}$ of the cascode structure.
(c) Using a PSpice circuit of the type of Fig. 6.54 we obtain the plots of Fig. 6.57, which are in excellent agreement with the hand calculations.

We summarize the advantages of cascoding by stating that the CE/CS stages $Q_{1} / M_{1}$ overcome their inherent Miller-effect drawbacks by delegating the task of voltage amplification to the $\mathrm{CB} / \mathrm{CG}$ stages $Q_{2} / M_{2}$, which are inherently much faster because they are immune from the Miller effect. The result is a dramatic increase in the gain-bandwidth product.

## 6.9 FREQUENCY AND TRANSIENT RESPONSES OF OP AMPS

Most op amps are designed for a gain that is dominated by a single low-frequency pole (the reason, to be investigated in detail in Chapter 7, is to prevent possible oscillations in negative-feedback operation). For the traditional voltage-feedback op amp of Fig. $6.58 a$ the gain $a(j f)$ exhibits the frequency profile of Fig. $6.58 b$ and takes on the mathematical form

$$
\begin{equation*}
a(j f)=\frac{V_{o}}{V_{p}-V_{n}} \cong \frac{a_{0}}{1+j f / f_{b}} \tag{6.104}
\end{equation*}
$$

where $V_{o}, V_{p}$, and $V_{n}$ are the Laplace transforms of the small signals $v_{o}, v_{p}$, and $v_{n}, a_{0}$ is the dc gain, and $f_{b}$ is the dominant-pole frequency. Gain is approximately constant up to $f_{b}$. At $f_{b}$ it is $3-\mathrm{dB}$ below its dc value. Above $f_{b}$ it rolls off with frequency at a uniform rate of $-20 \mathrm{~dB} / \mathrm{dec}$ until it drops to unity, or 0 dB , at the transition frequency $f_{t}$.
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-030.jpg?height=175&width=341&top_left_y=370&top_left_x=447)
(a)
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-030.jpg?height=337&width=511&top_left_y=207&top_left_x=900)
(b)

FIGURE 6.58 The frequency response of a voltage-feedback op amp having a dominant pole.

Exploiting the constancy of the gain-bandwidth product (GBP) we write $a_{0} \times f_{b}=$ $1 \times f_{t}$. Consequently, a dominant-pole op amp has a constant GBP,

$$
\begin{equation*}
\text { GBP }=f_{t}=a_{0} \times f_{b} \tag{6.105}
\end{equation*}
$$

The frequency response of an op amp is easily visualized via PSpice, as demonstrated in Fig. 6.59 for the case of the 741 op amp. Using PSpice's cursor facility on the magnitude plot we find $a_{0}=105.3 \mathrm{~dB}, f_{b}=5.2 \mathrm{~Hz}$, and $f_{t}=871 \mathrm{MHz}$. Above $f_{t}$ the rolloff rate increases, indicating the presence of additional root frequencies there. (Higher-order roots will be addressed in greater detail in Chapter 7.)

Let us now investigate how the dominant pole is established in the three representative op amps discussed in Chapter 5, namely, the 741 bipolar and the two-stage and folded cascode CMOS op amps.

- Figure 6.60 shows the portion of the $\mathbf{7 4 1} \mathbf{~ o p ~ a m p ~ i n v o l v e d ~ i n ~ f r e q u e n c y ~ c o m p e n - ~}$ sation. The goal is to establish a dominant pole at a sufficiently low frequency $f_{b}$ to force gain to drop to unity before the phase shift by higher-order poles
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-030.jpg?height=320&width=503&top_left_y=1763&top_left_x=244)
(a)
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-030.jpg?height=518&width=734&top_left_y=1554&top_left_x=899)
(b)

FIGURE 6.59 Using the 741 macromodel available in PSpice's library to plot the frequency response.
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-031.jpg?height=762&width=1506&top_left_y=217&top_left_x=205)

FIGURE 6.60 The 2nd stage of the 741 op amp and its ac equivalent for the calculation of the resistance $R_{e q}$ as seen by the frequency-compensation capacitor $C_{c}$.
destabilizes the op amp in negative-feedback operation. This pole is obtained by placing a small capacitance $C_{c}(=30 \mathrm{pF})$ across the 2 nd stage and taking advantage of the Miller effect to achieve the much larger effective value needed to establish this low-frequency pole. Since $C_{c}$ is small enough that it can be fabricated on chip, the 741 is said to be internally compensated. (In fact, the 741 was the first op amp in this category, whereas previous op amps had to be compensated externally by the user. Once internal compensation became a technological reality, the op amp took off to become the most widely used analog IC.)

Using OCTC analysis we get

$$
f_{b}=\frac{1}{2 \pi R_{e q} C_{c}}
$$

where $R_{e q}$ is the equivalent resistance seen by $C_{c}$. This resistance is depicted in the ac equivalent shown at the right. Taking advantage of the similarity to Fig. 6.44a, we adapt Eq. (6.81) and write

$$
R_{e q}=\left(R_{o 1} / / R_{i 2}\right)+\left(R_{o 2} / / R_{i 3}\right)+G_{m 2}\left(R_{o 1} / / R_{i 2}\right)\left(R_{o 2} / / R_{i 3}\right)
$$

Substituting the values shown we get

$$
\begin{gathered}
R_{e q}=\left[(6.12 / / 4.63)+(0.0813 / / 9.33)+\frac{(6.12 / / 4.63)+(0.0813 / / 9.33)}{161}\right] 10^{6}=1.32 \mathrm{G} \Omega \\
f_{b}=\frac{1}{2 \pi \times 1.32 \times 10^{9} \times 30 \times 10^{-12}}=4 \mathrm{~Hz}
\end{gathered}
$$

![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-032.jpg?height=652&width=1511&top_left_y=1393&top_left_x=109)

Alternatively, we can regard $f_{b}$ as arising from the interaction between the net input-node resistance $R_{o 1} / / R_{i 2}$ and the Miller capacitance $C_{M}=[1+$ $\left.G_{m 2}\left(R_{o 2} / / R_{i 3}\right)\right] C_{c}$. With $R_{o 1} / / R_{i 2}=6.12 / / 4.63=2.64 \mathrm{M} \Omega$ and $G_{m 2}\left(R_{o 2} / / R_{i 3}\right)=$ $[(0.0813 / / 9.33) / 161] 10^{6} \cong 500 \mathrm{~V} / \mathrm{V}$ we get $C_{M}=(1+500) \times 30 \mathrm{pF} \cong$ 15 nF . It is apparent that if it weren't for the Miller effect, which makes $C_{c}$ appear 501 times as large, internal compensation would be unfeasible as a $15-\mathrm{nF}$ capacitor cannot realistically be fabricated on chip!

In Eq. (5.22) we calculated $a_{0}=241 \times 10^{3} \mathrm{~V} / \mathrm{V}$, so $f_{t}=a_{0} \times f_{b}=241 \times$ $10^{3} \times 4 \cong 1 \mathrm{MHz}$. The manufacturer's data sheets (which you can search on the Web) give $a_{0}=200 \times 10^{3} \mathrm{~V} / \mathrm{V}, f_{b}=5 \mathrm{~Hz}$, and $f_{t}=200 \times 10^{3} \times 5=1 \mathrm{MHz}$. The discrepancy between the calculated and the data-sheet values stems primarily from the values assumed for $\beta_{0}$ and $V_{A}$ in the course of our hand calculations.

- Figure $6.61 a$ shows the portion of the two-Stage CMOS op amp involved in frequency compensation (the resistance $R_{c}$ appearing in Fig. 5.13 has been ignored because $R_{c} \ll R_{e q}$ ). Like the 741 , this amplifier is stabilized via Miller compensation, so

$$
f_{b}=\frac{1}{2 \pi R_{e q} C_{c}}
$$

where $R_{e q}$ is the equivalent resistance seen by $C_{c}$,

$$
R_{e q} \cong R_{o 1}+R_{o 2}+g_{m 5} R_{o 1} R_{o 2}
$$

- Figure $6.61 b$ shows the portion of the folded-cascode CMOS op amp involved in frequency compensation. This configuration differs from the two op amps just

FIGURE 6.61 Portions of the (a) two-stage and (b) folded-cascode CMOS op amps involved in frequency compensation, along with the ac equivalents showing the ac resistance seen by the compensation capacitance.
investigated because the dominant pole is established by the output resistance $R_{o}$ and the net output-node capacitance $C_{c}$ as

$$
f_{b}=\frac{1}{2 \pi R_{o} C_{c}}
$$

Here, $C_{c}$ is the sum of the capacitances associated with the drains of $M_{4}$ and $M_{8}$ and any external load capacitance $C_{L}$. Moreover, by Eq. (5.39),

$$
R_{o} \cong\left[\left(g_{m 6}+g_{m b 6}\right) r_{o 6} r_{o 8}\right] / /\left[\left(g_{m 4}+g_{m b 4}\right) r_{o 4}\left(r_{o 2} / / r_{o l 0}\right)\right]
$$

Looking at the folded-cascode schematic of Fig. 5.16, we expect additional poles due to the stray capacitances of the other nodes along the signal path. However, each of these nodes exhibits an equivalent resistance on the order of $1 /\left(g_{m}+g_{m b}\right)$, which is much lower than $R_{o}$, so the output-node pole dominates the entire response. This is why the folded cascode is often regarded as a single stage op amp!
(a) For the two-stage CMOS op amp of Example 5.2, find $f_{b}$ and $f_{t}$ if $C_{c}=3 \mathrm{pF}$.

### EXAMPLE 6.23

(b) Repeat, but for the folded-cascode CMOS op amp of Example 5.4 if $C_{c}=2.5 \mathrm{pF}$.

### Solution

(a) From Example 5.2 we have $a_{0}=2,844 \mathrm{~V} / \mathrm{V}, R_{o 1}=r_{o 2} / / r_{o 4}=400 / / 200=$ $133 \mathrm{k} \Omega, R_{o 2}=r_{o 5} / / r_{o 6}=100 / / 200=66.7 \mathrm{k} \Omega$, and $g_{m 5}=2 \times 0.1 / 0.25=$ $1 /(1.25 \mathrm{k} \Omega)$. We thus write $R_{e q}=133+66.7+133 \times 66.7 / 1.25=7.31 \mathrm{M} \Omega$, so

$$
\begin{aligned}
f_{b} & =\frac{1}{2 \pi \times 7.31 \times 10^{6} \times 3 \times 10^{-12}}=7.34 \mathrm{kHz} \\
f_{t} & =a_{0} \times f_{b}=2,844 \times 7.34 \times 10^{3}=20.9 \mathrm{MHz}
\end{aligned}
$$

(b) From Example 5.4 we have $a_{0}=2,088 \mathrm{~V} / \mathrm{V}$ and $R_{o}=5.22 \mathrm{M} \Omega$, so

$$
\begin{aligned}
f_{b} & =\frac{1}{2 \pi \times 5.22 \times 10^{6} \times 2.5 \times 10^{-12}} \cong 12.2 \mathrm{kHz} \\
f_{t} & =2,088 \times 12.2 \times 10^{3}=25.5 \mathrm{MHz}
\end{aligned}
$$

### The Transient Response

Op amps are characterized both in the frequency and the time domains. An important time-domain characteristic is the transient response, which shows how an op amp circuit reacts to an input voltage step. The circuit commonly used is the unitygain voltage follower of Fig. $6.62 a$ because this is the most difficult configuration to stabilize, as we shall see in Chapter 7. To facilitate the transient analysis, refer to the simplified renditions of Fig. 6.63, where the second stage and the compensation
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-034.jpg?height=189&width=334&top_left_y=295&top_left_x=448)

GND
(a)
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-034.jpg?height=302&width=539&top_left_y=220&top_left_x=881)
(b)

FIGURE 6.62 (a) Voltage follower and (b) small-signal transient response for a dominant-pole op amp.
capacitance have been combined together to form an integrator. As long as the gain $a_{2}$ of this stage is sufficiently high, the integrator's input terminal will approximate a virtual ground, so we have $C_{c} d\left(v_{O}-0\right) / d t=i_{C}$, or

$$
\begin{equation*}
C_{c} \frac{d v_{O}}{d t}=i_{C} \tag{6.106}
\end{equation*}
$$

We make the following considerations:

- In dc steady state both circuits yield $i_{C}=0$ and $v_{O} \cong v_{I}$. Moreover, the inputstage bias current $I_{1}$ splits equally between the two halves of the differential pair.
- Applying a positive voltage step at the input will make $Q_{2} / M_{2}$ less conductive, so a greater portion of $I_{1}$ will be diverted to $Q_{1} / M_{1}$ to be subsequently replicated at the integrator's input by the current mirror. This results in $i_{C}>0$ and causes $C_{c}$ to charge up as per Eq. (6.106). As long as the step amplitude $V_{m}$ is sufficiently
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-034.jpg?height=606&width=733&top_left_y=1369&top_left_x=115)
(a)
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-034.jpg?height=621&width=625&top_left_y=1354&top_left_x=993)
(b)

FIGURE 6.63 Simplified equivalents of (a) the 741 op amp and (b) the two-stage CMOS op amp (the foldedcascode CMOS op amp is similar, except that there is no second stage and $C_{c}$ is connected to ground.)
small, we can use the small-signal approximation to write $i_{C}=G_{m 1}\left(v_{P}-v_{N}\right)=$ $G_{m 1}\left(V_{m}-v_{o}\right)$, where $G_{m 1}$ is the input-stage transconductance. Substituting into Eq. (6.106) and rearranging gives

$$
\begin{equation*}
\tau \frac{d v_{O}}{d t}+v_{O}=V_{m} \tag{6.107}
\end{equation*}
$$

where

$$
\begin{equation*}
\tau=\frac{C_{c}}{G_{m 1}} \tag{6.108}
\end{equation*}
$$

Recall from basic circuit courses that the solution to the above differential equation is an exponential transient governed by the time constant $\tau$. For $v_{O}=0$, Eq. (6.107) reduces to $\tau d v_{o} / d t=V_{m}$, indicating an initial slope of $d v_{o} / d t=V_{m} / \tau$ (see Fig. 6.62b). As the transient dies out, $v_{o}$ eventually settles at $V_{m}$.

- We can obtain an insightful alternative expression for $\tau$ by noting that for $f=f_{t}$ we have

$$
V_{o}\left(j f_{t}\right)=\frac{1}{j 2 \pi f_{t} C_{c}} I_{c}=\frac{1}{j 2 \pi f_{t} C_{c}} G_{m 1}\left(V_{p}-V_{n}\right)
$$

But, we also have $V_{o}\left(j f_{t}\right)=a\left(j f_{t}\right) \times\left(V_{p}-V_{n}\right)=(1 / j) \times\left(V_{p}-V_{n}\right)$, so $G_{m 1} /\left(2 \pi f_{t} C_{c}\right)=1$. Combining with Eq. (6.108) gives

$$
\begin{equation*}
\tau=\frac{1}{2 \pi f_{t}} \tag{6.109}
\end{equation*}
$$

This provides a link between the frequency-domain parameter $f_{t}$ and the timedomain parameter $\tau$. The 741 op amp has $\tau=1 /\left(2 \pi \times 10^{6}\right)=159 \mathrm{~ns}$.

### Slew-Rate (SR) Limiting

If we raise $V_{m}$ further, the small-signal approximation ceases to hold. This is so because the $i_{C}$ characteristic as a function of the difference $v_{P}-v_{N}$ takes on the familiar $s$-shaped form of Section 4.5 , so the transient response becomes a sluggish exponential. Still, $v_{O}$ will settle at $V_{m}$ once the transient has died out. For $V_{m}$ sufficiently large, all of $I_{1}$ will be diverted to $Q_{2} / M_{2}$, so $i_{C}$ will saturate at $i_{C(\max )}=I_{1}$, causing $v_{O}$ to ramp up at the maximum possible rate. This rate is called the slew rate (SR) and is expressed in $\mathrm{V} / \mu \mathrm{s}$. By Eq. (6.106),

$$
\begin{equation*}
\mathrm{SR}=\left.\frac{d v_{o}}{d t}\right|_{\max }=\frac{I_{1}}{C_{c}} \tag{6.110}
\end{equation*}
$$

The 741 op amp has $I_{1}=19 \mu \mathrm{~A}$, so $\mathrm{SR}=(19 \mu \mathrm{~A}) /(30 \mathrm{pF})=0.633 \times 10^{6} \mathrm{~V} / \mathrm{s}=$ $0.633 \mathrm{~V} / \mu \mathrm{s}$, which is fairly close to the more conservative data-sheet value of $0.5 \mathrm{~V} / \mu \mathrm{s}$.

It is of interest to know the step amplitude $V_{m(\text { onset })}$ that marks the onset of SR limiting. This occurs for $V_{m \text { (onset) }} / \tau=\mathrm{SR}$, or $V_{m \text { (onset) }}=\mathrm{SR} /\left(2 \pi f_{t}\right)$. The 741 has $V_{m \text { (onset) }}=$ $0.5 \times 10^{6} /\left(2 \pi 10^{6}\right) \cong 80 \mathrm{mV}$.

### Exercise 6.6

Find $\tau$, SR, and $V_{m(\text { onset })}$ for (a) the two-stage and (b) the folded-cascode CMOS op amps of Example 6.23. Assume $I_{1}=100 \mu \mathrm{~A}$ for both circuits.
Ans. (a) $7.73 \mathrm{~ns}, 33.3 \mathrm{~V} / \mu \mathrm{s}, 257 \mathrm{mV}$; (b) $6.24 \mathrm{~ns}, 40 \mathrm{~V} / \mu \mathrm{s}, 250 \mathrm{mV}$.

We can readily visualize transient responses via PSpice. The circuit of $6.64 a$ uses the 741 macro-model available in PSpice's Library to display the response to an input step of magnitude $V_{m}=10 \mathrm{mV}$. Recall from Fig. 5.2 that the differential input stage of the 741 involves four base-emitter junctions, so each junction is subjected to a step of $10 / 4=2.5 \mathrm{mV}$, which is quite adequate for the small-signal approximation. The actual response, shown in Fig. 6.64b, differs somewhat from the exponential form predicted by single-pole analysis, and also exhibits overshoot. This is due to the presence of additional pole frequencies above $f_{t}$, as per Fig. 6.59 (more on this in Chapter 7).

Using the $60-\mathrm{mV}$ rule of thumb we can state that raising $V_{m}$ to $2 \times 60=120 \mathrm{mV}$ will make the current of one side of the differential stage ten times as large as the other side, thus bringing the 741 on the verge of slew-rate limiting. The pulse response of Fig. $6.65 a$ is based on $V_{m}=1.0 \mathrm{~V}$, a convincingly large overdrive. Consequently, $v_{O}$ ramps up at a constant rate of about $0.5 \mathrm{~V} / \mu \mathrm{s}$, taking about $2 \mu \mathrm{~s}$ to approach the $1.0-\mathrm{V}$ plateau. As $v_{O}$ approaches the plateau, the op amp ceases to slew-rate limit and $v_{O}$ completes the last part of the transient in small-signal fashion, according to Fig. 6.64b.

Slew-rate limiting is a form of nonlinear distortion that limits the useful frequency range for large-signal operation. This distortion is illustrated in Fig. 6.65b for the case of a sinusoidal input

$$
v_{I}=V_{m} \sin (2 \pi f t)
$$

with $V_{m}=10 \mathrm{~V}$ and $f=15 \mathrm{kHz}$. The slope of a sinusoid is steepest at the $0-\mathrm{V}$ crossings, where we have

$$
\left|\frac{d v_{t}}{d t}\right|_{\max }=\left|-2 \pi f V_{m} \cos (2 \pi f t)\right|_{\max }=2 \pi f V_{m}
$$

![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-036.jpg?height=344&width=567&top_left_y=1683&top_left_x=447)
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-036.jpg?height=414&width=595&top_left_y=1575&top_left_x=1036)
(b)

FIGURE 6.64 (a) PSpice circuit to display the 741 transient responses. (b) Small-signal step response.
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-037.jpg?height=560&width=1426&top_left_y=199&top_left_x=189)

FIGURE 6.65 Slew-rate limited responses of the 741 follower to (a) a pulse and (b) a sinusoid.

If we want to avoid slew-rate limiting, this slope must be less than the slew rate,

$$
\begin{equation*}
2 \pi f V_{m} \leq \mathrm{SR} \tag{6.111}
\end{equation*}
$$

For instance, a 741 op amp with $V_{m}=10 \mathrm{~V}$ requires that its frequency $f$ meet the condition

$$
f \leq \frac{\mathrm{SR}}{2 \pi V_{m}}=\frac{0.5 / 10^{-6}}{2 \pi 10} \cong 8 \mathrm{kHz}
$$

Figure $6.65 b$ shows the effect of exceeding the above limit with $f=15 \mathrm{kHz}(>8 \mathrm{kHz})$. It is apparent that as soon as the slope of $v_{I}$ exceeds the $\mathrm{SR}, v_{O}$ ceases to track $v_{I}$ and ramps up or down at a fixed rate of $\pm 0.5 \mathrm{~V} / \mu \mathrm{s}$. We can avoid slew-rate limiting either by lowering $f$ to 8 kHz or less while keeping $V_{m}=10 \mathrm{~V}$, or by suitably lowering $V_{m}$ while keeping $f=15 \mathrm{kHz}$. In fact, we can turn around Eq. (6.111) and find $V_{m} \leq$ $\mathrm{SR} /(2 \pi f)=\left(0.5 / 10^{-6}\right) /\left(2 \pi \times 15 \times 10^{3}\right) \cong 5.3 \mathrm{~V}$. Likewise, if we wish the 741 follower to give an undistorted sine wave over the entire audio range, whose upper limit is $f=20 \mathrm{kHz}$, then we must ensure that $V_{m} \leq\left(0.5 / 10^{-6}\right) /\left(2 \pi \times 20 \times 10^{3}\right) \cong 4 \mathrm{~V}$.

### Insightful Expressions for the Slew Rate

Combining Eqs. (6.108) through (6.110) we can express the slew rate in the insightful alternative form

$$
\begin{equation*}
\mathrm{SR}=2 \pi \frac{I_{1}}{G_{m 1}} f_{t} \tag{6.112}
\end{equation*}
$$

where $f_{t}$ is the op amp's transition frequency, $G_{m 1}$ is the transconductance of the differential input pair, and $I_{1}$ is the pair's bias current. In the case of CMOS op amps we use $G_{m 1}=2\left(I_{1} / 2\right) / V_{O V 1}=I_{1} / V_{O V 1}$ to obtain yet another insightful form,

$$
\begin{equation*}
\mathrm{SR}_{\mathrm{CMOS}}=2 \pi V_{O V 1} f_{t} \tag{6.113}
\end{equation*}
$$

We make the following observations:

- Whether bipolar or CMOS, an op amp with a high $f_{t}$ is likely to exhibit also a high SR.
- The IC designer can raise the SR by raising $I_{1}$ so as to charge/discharge $C_{c}$ more rapidly. The price is more power dissipation and, in the bipolar case, a higher input bias current $I_{B}\left(=I_{1} / 2 \beta_{F}\right)$.
- The IC designer can raise the SR by suitably reducing the transconductance of the differential input pair, such as via degeneration or other forms (see, for instance, Problem 5.11). The notoriously low transconductance of FETs compared to BJTs comes as a blessing in this case as it helps achieve higher slew rates. The price of a reduced transconductance is less voltage gain.
- In the case of CMOS op amps the IC designer can raise the SR by raising the overdrive voltage $V_{O V 1}$ of the differential input pair (another way of signifying low $G_{m 1}$ ). This is another reason why preference is given to $p$ MOSTETs in the differential pair: for similar dimensions and biasing conditions, the lower mobility of holes compared to electrons makes $V_{O V p}$ two to three times higher than $V_{O V n}$.

### Current-Feedback Amplifiers

The current-feedback amplifier (CFA) circuit of Fig. 5.39 reveals the presence of a number of internal low-resistance nodes along with a single high-resistance node denoted as node $C$. We anticipate the frequency response to be dominated by the pole associated with this one node. Denoting this node's total stray capacitance to ground as $C_{e q}$, as depicted in Fig. $6.66 a$, we have $V_{o}=z(s) I_{n}$, where $z(s)=R_{e q} / /\left[1 /\left(s C_{e q}\right)\right]$. Expanding and letting $s \rightarrow j 2 \pi f$, we readily find the gain of the CFA as

$$
\begin{equation*}
z(j f)=\frac{V_{o}}{I_{n}}=\frac{R_{e q}}{1+j f / f_{b}} \tag{6.114}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-038.jpg?height=651&width=729&top_left_y=1370&top_left_x=281)
(a)
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-038.jpg?height=330&width=511&top_left_y=1681&top_left_x=1125)
(b)

FIGURE 6.66 The frequency response of a current-feedback op amp (CFA).
where $R_{e q}$ represents the dc value of gain, and

$$
\begin{equation*}
f_{b}=\frac{1}{2 \pi R_{e q} C_{e q}} \tag{6.115}
\end{equation*}
$$

represents the frequency at which gain drops to $1 / \sqrt{2}(=70.7 \%)$ of its low-frequency value. Above $f_{b}$ gain rolls off by one $\Omega$-decade for every Hz -decade, or by $-1 \mathrm{dec} / \mathrm{dec}$, as shown. Since it has the dimensions of impedance, $z$ is also referred to as transimpedance gain, and the CFA as transimpedance amplifier.

We observe that the current dumped into $C_{e q}$ at the onset of a step in $V_{p}$ depends on the external resistance on which node $V_{n}$ is terminated as well as the step magnitude. Consequently, there are no current-saturation effects in CFAs, and, hence, no slew-rate-limiting. For instance, with $C_{e q} \sim 1 \mathrm{pF}$ and $I_{n} \sim 1 \mathrm{~mA}$ the initial slope is $d V_{o} / d t \sim 10^{-3} / 10^{-12}=10^{9}=1,000 \mathrm{~V} / \mu \mathrm{s}$. To fully appreciate the dynamic advantages of the CFA we need to investigate its frequency response in negative-feedback operation, in Chapter 7.

## 6.10 DIODE SWITCHING TRANSIENTS

Up to now diodes have been assumed to turn on or off instantaneously. An actual pn junction diode takes time to switch from one state to the other because charge must be transferred in or out of the device to effect the switching, and charge transfers cannot occur instantaneously. The transient behavior of a $p n$ junction is governed by the charge-control equation ${ }^{1,8}$

$$
\begin{equation*}
i_{D}=\frac{d Q_{j}}{d t}+\frac{d Q_{F}}{d t}+\frac{Q_{F}}{\tau_{F}} \tag{6.116}
\end{equation*}
$$

where $i_{D}$ is the diode current, $Q_{j}$ is the charge of the junction capacitance $C_{j}$, and $Q_{F}$ is the excess minority charge in forward bias. In words, the current $i_{D}$ supplied to a diode in the forward mode goes toward (a) charging up the capacitance $C_{j}$, (b) building up the excess charge $Q_{F}$, and (c) sustaining the charge $Q_{F}$ built up to that point. Once all transients have died out, the diode reaches its dc steady state, where $i_{D}=Q_{F} / \tau_{F}$. Consequently, the time-constant $\tau_{F}$ represents the ratio $Q_{F} / i_{D}$ in the forward steady state.

Recall that most practical junctions are fabricated with one side much more heavily doped than the other. For a junction with $N_{A} \gg N_{D}$ we can approximate $Q_{F} \cong$ $Q_{p}$; moreover, $\tau_{F} \cong \tau_{p}=L_{p}^{2} / D_{p}$ in the case of a long-base diode, $\tau_{F}=W_{n}^{2} /\left(2 D_{p}\right)$ in the short-base case (refer to Figs. 1.43 and 1.45). Likewise, for a junction with $N_{D} \gg N_{A}$ we have $Q_{F} \cong Q_{n}$, and $\tau_{F} \cong \tau_{n}=L_{n}^{2} / D_{n}$ for a long-base diode, $\tau_{F}=W_{p}^{2} /\left(2 D_{n}\right)$ for a short-base diode. In the long-base case $\tau_{F}$ is called the minority-carrier mean recombination time, or also the minority-carrier mean lifetime, whereas in the short-base case it is called the minority-carrier mean transit time and it is denoted as $\tau_{T}$ (this is also the symbol used by PSpice).

Figure 6.67 shows a PSpice circuit to display the switching characteristics of a diode having the parameters shown in the table. Figure 6.68 shows all relevant
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-040.jpg?height=316&width=811&top_left_y=208&top_left_x=449)

FIGURE 6.67 PSpice circuit to visualize the switching
transients of a pn junction diode.
waveforms for the case in which the driving source $v_{S}$ is switched from $V_{R}(=-2 \mathrm{~V})$ to $V_{F}(=5 \mathrm{~V})$ at $t=t_{0}=0 \mathrm{~ns}$, and back to -2 V at $t=t_{2}=50 \mathrm{~ns}$, with the diode in steady state prior to $t=t_{0}$. We make the following observations.

- Right after the leading edge of $v_{S}$ there is no excess charge $Q_{F}$ yet, so Eq. (6.116) simplifies as

$$
\begin{equation*}
i_{D} \cong \frac{d Q_{j}}{d t} \tag{6.117}
\end{equation*}
$$

indicating that initially all of $i_{D}$ goes toward charging $C_{j}$. As $C_{j}$ charges up, $v_{D}$ increases until the diode reaches the edge of conduction (EOC) at the instant $t_{1}$ when $v_{D} \cong 0.6 \mathrm{~V}$. Recall from Chapter 1 that the junction capacitance is

$$
\begin{equation*}
C_{j}\left(v_{D}\right)=\frac{C_{j 0}}{\left(1-v_{D} / \phi_{0}\right)^{m}} \tag{6.118}
\end{equation*}
$$

where $C_{j 0}$ is the zero-bias value of $C_{j}, \phi_{0}$ is the built-in potential, and $m$ the grading coefficient. Since $C_{j}$ is nonlinear, its charging process is rather complex, but we can estimate its charging time $t_{1}-t_{0}\left(=t_{1}\right)$ by approximating Eq. (6.117) as

$$
i_{D(\mathrm{avg})} \cong \frac{\Delta Q_{j}}{\Delta t}=\frac{C_{j(\mathrm{eq})} \Delta v_{D}}{t_{1}-t_{0}}
$$

where $i_{D(\text { avg })}$ is the average of $i_{D}\left(t_{0}^{+}\right)=[5-(-2)] / 4.3=1.63 \mathrm{~mA}$ and $i_{D}\left(t_{1}\right)=$ $(5-0.6) / 4.3=1.02 \mathrm{~mA}$, that is, $i_{D(\text { avg })}=(1.63+1.02) / 2=1.3 \mathrm{~mA}$, and $\Delta v_{D}=v_{D}\left(t_{1}\right)-v_{D}\left(t_{0}\right)=0.6-(-2)=2.6 \mathrm{~V}$. Making the crude approximation $C_{j(\mathrm{eq})} \cong C_{j 0}=2.5 \mathrm{pF}$ (see Problem 6.49 for a better estimate) we get $t_{1} \cong 2.5 \times$ $10^{-12} \times 2.6 /\left(1.3 \times 10^{-3}\right)=5 \mathrm{~ns}$. This well agrees with $t_{1}=4.77 \mathrm{~ns}$ measured via the cursor facility of PSpice.

- Following $t_{1}$, the diode is brought from the EOC $\left(v_{D} \cong 0.6 \mathrm{~V}\right)$ to full conduction $\left(v_{D} \cong 0.7 \mathrm{~V}\right)$, and this is when $Q_{F}$ comes into play. The change in $v_{D}$ from 0.6 V to 0.7 V is small enough that we can ignore the term $d Q_{j} / d t$ and simplify Eq. (6.116) as

$$
\begin{equation*}
I_{F} \cong \frac{d Q_{F}}{d t}+\frac{Q_{F}}{\tau_{F}} \tag{6.119}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-041.jpg?height=1561&width=1297&top_left_y=208&top_left_x=204)

FIGURE 6.68 Relevant waveforms for the circuit of Fig. 6.67.
where $I_{F} \cong\left(V_{F}-V_{D(\text { (n) })}\right) / R=(5-0.7) / 4.3=1 \mathrm{~mA}$. The solution to this equation is an exponential buildup of $Q_{F}$, governed by the time constant $\tau_{F}=\tau_{T}=10 \mathrm{~ns}$ and tending asymptotically toward the steady-state value

$$
Q_{F(\mathrm{~s})}=\tau_{F} I_{F}=10 \times 10^{-9} \times 10^{-3}=10 \mathrm{pC}
$$

![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-042.jpg?height=537&width=1176&top_left_y=201&top_left_x=443)

FIGURE 6.69 Minority hole distributions during (a) the buildup and (b) the removal of the hole charge $Q_{p}$.

The buildup of $Q_{F}$ is depicted in Fig. 6.69a for the case of a long-base diode with $N_{A} \gg N_{D}$ so that $Q_{F} \cong Q_{p}$. Recall that $I_{F}$ defines the initial slope of the excess hole concentration in the $n$ region, and the area defines $Q_{p}$ itself. Consequently, all curves exhibit the same slope at $x=x_{n}$, and the area builds up exponentially with time.

- Following the trailing edge of $v_{S}$ at the instant $t_{2}=50 \mathrm{~ns}$, we need to remove the stored charge $Q_{F}$ if we want to bring the diode back to the edge of conduction, now more properly called the edge of cutoff (EOC). Charge removal is governed by the equation

$$
\begin{equation*}
I_{R} \cong \frac{d Q_{F}}{d t}+\frac{Q_{F}}{\tau_{F}} \tag{6.120}
\end{equation*}
$$

where $I_{R} \cong\left(V_{R}-V_{D(\text { on })}\right) / R=(-2-0.7) / 4.3=-0.62 \mathrm{~mA}$. The solution to this equation is an exponential decay of $Q_{F}$, again governed by the time constant $\tau_{F}=\tau_{T}=10 \mathrm{~ns}$ and tending asymptotically toward the (fictitious) steadystate value

$$
Q_{F}(\infty)=\tau_{F} I_{R}=10 \times 10^{-9} \times(-0.62) 10^{-3}=-6.2 \mathrm{pC}
$$

The decay holds up to the instant $t_{3}$ at which $Q_{F}$ becomes to zero (hence the reason for calling $Q_{F}(\infty)$ fictitious). To find the time interval $t_{S}=t_{3}-t_{2}$, aptly called the storage time, we use ${ }^{7}$

$$
t_{S}=\tau_{F} \ln \frac{Q_{F}\left(t_{2}\right)-Q_{F}(\infty)}{Q_{F}\left(t_{3}\right)-Q_{F}(\infty)}=\tau_{F} \ln \frac{\tau_{F} I_{F}-\tau_{F} I_{R}}{0-\tau_{F} I_{R}}
$$

that is,

$$
\begin{equation*}
t_{S}=\tau_{F} \ln \frac{I_{F}-I_{R}}{-I_{R}} \tag{6.121}
\end{equation*}
$$

Presently, $t_{S}=(10 \mathrm{~ns}) \ln [(1+0.62) / 0.62]=9.6 \mathrm{~ns}$. This well agrees with the measured PSpice value of 9.5 ns . The removal of $Q_{F}$ is depicted in Fig. 6.69b, where we note that the initial slope is now defined by $I_{R}$, which is negative.

- Once all the stored charge has been removed, the diode will retrace the initial voltage transient, but in reverse. Were $C_{j}$ linear, the reverse transient would be an exponential transient from +0.6 V to -2 V governed by the time constant $\tau=R C_{j}$. In practice this transient is pseudo exponential, a bit slower at the beginning where $C_{j} \cong 2 C_{j 0}$, but getting faster as $C_{j}$ decreases in reverse bias, where $C_{j}<C_{j 0}$.
Looking at the waveforms of $v_{D}$ and $i_{D}$ we observe that the diode starts conducting right away when we turn it on. However, when we try to turn it off, it continues to remain on for $t_{s}$ nanoseconds. During this time it acts as a $\sim 0.7-\mathrm{V}$ battery and the reverse current, far from dropping instantaneously to zero as it would in the case of an ideal diode, remains at $I_{R}\left(\left|I_{R}\right| \geqslant 0\right)$, as confirmed by the waveform of $i_{D}$. It is apparent that the storage time $t_{S}$ can be a drawback, especially in high-speed applications.

According to Eq. (6.120) $t_{S}$ depends on the intrinsic $p n$-junction parameter $\tau_{F}$ as well as on the user-provided drives $I_{F}$ and $I_{R}$. Short-base diodes are preferable in high-speed applications because they have $\tau_{T} \ll \tau_{F}$. We can also reduce the logarithmic term of Eq. (6.121) by driving the diode with a large reverse current $I_{R}$ to wipe out the stored charge more rapidly. However, other design constraints may limit the reverse drive, indicating that the circuit designer must learn to live with storage-time limitations.

If a diode has $t_{S}=25 \mathrm{~ns}$ with $I_{F}=10 \mathrm{~mA}$ and $I_{R}=-2 \mathrm{~mA}$, find $t_{S}$ if $I_{F}=4 \mathrm{~mA}$ and $I_{R}=-5 \mathrm{~mA}$. Comment.

### Solution

Imposing $25 \mathrm{~ns}=\tau_{F} \ln [(10+2) / 2]$ gives $\tau_{F} \cong 14 \mathrm{~ns}$. (This provides a means of finding $\tau_{F}$ experimentally via storage-time and current-drive measurements.) Now $t_{S}=14 \ln [(4+5) / 5]=8.23 \mathrm{~ns}$. Lowering $I_{F}$ from 10 mA to 4 mA reduces the amount of stored charge, and raising $-I_{R}$ from 2 mA to 5 mA wipes out the stored charge more rapidly. However, because of the logarithmic dependence, the reduction in $t_{S}$ is not that dramatic.

### Schottky-Barrier Diodes

Schottky-barrier diodes (SBDs) overcome the charge-storage limitation of pn junctions by avoiding minority charges altogether. The two diode types are compared in Fig. 6.70. A conventional monolithic diode, shown in Fig. 6.70a, consists of a $p-n^{-}$ junction and corresponding metal electrodes, for instance made of aluminum (Al). Consider now the Al- $n^{-}$junction of Fig. 6.70b. Because of the lightly doped $n^{-}$region (typically $N_{D} \leq 10^{-16} / \mathrm{cm}^{3}$ ), a space-charge layer (SCL) with rectifying properties forms just below the Al electrode. Applying a positive bias to the Al electrode
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-044.jpg?height=401&width=1318&top_left_y=201&top_left_x=332)

FIGURE 6.70 (a) Ordinary pn diode structure, and (b) Schottky barrier diode (SBD) structure.
relative to the $n^{-}$region will overcome the ensuing electrostatic barrier and cause electrons to flow from the $n^{-}$region, through the SCL, to the Al electrode. Since conduction is exclusively via electrons, which are the (only) charge carriers in the Al metal and are the majority carriers in the $n^{-}$material, there is no minority-charge storage in SBDs (aptly enough, SBDs are also called hot-carrier diodes because of this.) However, the SBD exhibits a junction capacitance $C_{j}$ just like the conventional $p n$ diode, indicating similar behavior during turn-on from $t_{0}$ to $t_{1}$ as well as during turnoff past $t_{3}$. But, in the $\operatorname{SBD}$ case $t_{3}$ coincides with $t_{2}$ because $t_{S}=0$.

SBDs exhibit an exponential $i-v$ characteristic just like ordinary $p n$ diodes, except that the saturation current $I_{s}$ of a SBD is some 5 orders of magnitude higher than that of a $p n$ diode of comparable dimensions. Using the $60-\mathrm{mV} /$ decade rule, we conclude that SBDs have typically $V_{D(\text { on })} \cong 0.7-5 \times 0.06=0.4 \mathrm{~V}$. The advantages of (a) a lower voltage drop and (b) the absence of minority-charge storage effects makes SBDs preferable to $p n$ diodes in applications such as switching power supplies and high-speed diode circuits. Figure $6.70 b$ shows also the circuit symbol in common use for the SBD.

Before concluding, we observe that both structures of Fig. 6.70 include an Al- $n^{+}$ junction at the cathode side. This junction too results in the formation of an SCL below the cathode electrode; however, because of heavy doping, this SCL is so narrow that electrons can easily tunnel across it in either direction to form what is known as an ohmic contact. Were the $n^{+}$region absent, the "cathode" electrode would form another SBD with the $n^{-}$material underneath, resulting in a back-to-back diode pair that would serve no useful purpose. As we know, ohmic contacts play an important role in connection with the collector of bipolar transistors as well as the tubs of CMOS transistors.

## 6.11 BJT SWITCHING TRANSIENTS

The analysis of BJT transients draws heavily from the diode treatment of the previous section, except that the BJT comprises two junctions and the analysis is therefore more complex. When used as a switch, a BJT usually alternates between the cutoff (CO) and saturation (Sat) modes, with brief transitions through the forward-active mode. In saturation both junctions are forward biased, so this mode is a combination
of forward-active (FA) and reverse-active (RA) operation. The transient behavior of the npn BJT is governed by the charge-control equations ${ }^{1,8}$

$$
\begin{gather*}
i_{B}=\frac{Q_{F}}{\tau_{B F}}+\frac{Q_{R}}{\tau_{B R}}+\frac{d}{d t}\left(Q_{F}+Q_{R}+Q_{j e}+Q_{j c}\right)  \tag{6.122}\\
i_{C}=\frac{Q_{F}}{\tau_{F}}-Q_{R}\left(\frac{1}{\tau_{R}}+\frac{1}{\tau_{B R}}\right)-\frac{d}{d t}\left(Q_{R}+Q_{j c}\right) \tag{6.123}
\end{gather*}
$$

where $i_{B}$ and $i_{C}$ are the currents into the base and into the collector terminals; $Q_{F}$ and $Q_{R}$ are the FA and RA excess minority-carrier charges in the base; $Q_{j e}$ and $Q_{j c}$ are the charges of the base-emitter (BE) and base-collector (BC) capacitances $C_{j e}$ and $C_{j c}\left(=C_{\mu}\right.$ in ac analysis). The time constants $\tau_{F}$ and $\tau_{B F}$ are called, respectively, the mean transit time and the mean lifetime of the base minority carriers in FA operation. According to Eq. (6.4) the npn BJT has

$$
\begin{equation*}
\tau_{F}=\frac{W_{B}^{2}}{2 D_{n}} \tag{6.124}
\end{equation*}
$$

where $W_{B}$ is the base width and $D_{n}$ is the electron diffusivity. The two time constants are related as ${ }^{1}$

$$
\begin{equation*}
\tau_{B F}=\beta_{F} \tau_{F} \tag{6.125}
\end{equation*}
$$

where $\beta_{F}$ is the familiar FA current gain. Similar terminology holds for the time constants $\tau_{R}$ and $\tau_{B R}\left(=\beta_{R} \tau_{R}\right)$, except that they pertain to RA operation, where the current gain is $\beta_{R}\left(\ll \beta_{F}\right)$. Equation (6.122) describes the effect of $i_{B}$ on the various charges, whereas Eq. (6.123) describes the effect of these charges on $i_{C}$, indicating a relationship of cause-and-effect between the two currents. Also, once we know $i_{B}$ and $i_{C}$, we can find the emitter current via KVL as $i_{E}=i_{B}+i_{E}$.

However intimidating the above equations might appear, we shall use them in simple and intuitive ways to investigate the response of a basic BJT inverter/switch to an input pulse. To this end we use the PSpice circuit of Fig. 6.71 to display all
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-045.jpg?height=476&width=951&top_left_y=1608&top_left_x=203)

FIGURE 6.71 PSpice circuit to visualize the switching transients of a BJT inverter/switch.
relevant waveforms for the case of a BJT inverter with the parameters shown in the table, and then we apply the above equations to calculate ${ }^{8}$ the various transient components. As shown in Fig. 6.72, the driving source $v_{S}$ is switched from $V_{R}(=-2 \mathrm{~V})$ to $V_{F}(=5 \mathrm{~V})$ at $t=t_{0}=0 \mathrm{~ns}$ and back to -2 V at $t=t_{3}=100 \mathrm{~ns}$. Assuming the BJT is in steady state prior to $t=t_{0}$, we identify the following operating regions and corresponding time intervals.

- Cutoff Region $\left(t_{0}\right.$ to $\left.t_{1}\right)$ : right after the leading edge of $v_{S}$ there are no base excess charges $Q_{F}$ and $Q_{R}$ yet, so Eqs. (6.122) and (6.123) simplify as

$$
\begin{equation*}
i_{B}=\frac{d}{d t}\left(Q_{j e}+Q_{j c}\right) \quad i_{C}=-\frac{d Q_{j c}}{d t} \tag{6.126}
\end{equation*}
$$

The first equation states that $i_{B}$ merely goes toward charging up the capacitances $C_{j e}$ and $C_{j c}$, and the second that the portion of $i_{B}$ flowing through $C_{j c}$ exits (hence the "-" sign in the second tem above) the collector terminal. This current then flows into $R_{C}$ to produce the initial voltage bump visible in the plot of $v_{C}$. As $C_{j e}$ and $C_{j c}$ charge up, $v_{B}$ rises until the BJT reaches the edge of conduction (EOC) at the instant $t_{1}$ when $v_{B} \cong 0.6 \mathrm{~V}$. As we know, the junction capacitances are

$$
\begin{equation*}
C_{j e}=\frac{C_{j e 0}}{\left(1-v_{B E} / \phi_{e}\right)^{m_{e}}} \quad C_{j c}=\frac{C_{j c 0}}{\left(1-v_{B C} / \phi_{c}\right)^{m_{c}}} \tag{6.127}
\end{equation*}
$$

where $C_{j e 0}$ and $C_{j c 0}$ are their zero-bias values, $\phi_{e}$ and $\phi_{c}$ are the built-in potentials of the two junctions, and $m_{e}$ and $m_{c}$ are their grading coefficients. Following the diode treatment of the previous section we estimate the charging time $t_{1}-t_{0}\left(=t_{1}\right)$ by approximating the first of Eq. (6.126) as

$$
i_{B(\mathrm{avg})} \cong \frac{\Delta Q_{j e}+\Delta Q_{j c}}{\Delta t}=\frac{C_{j e(\mathrm{eq})} \Delta v_{B E}+C_{j c(\mathrm{eq})} \Delta v_{B C}}{t_{1}-t_{0}}
$$

where $i_{B(\text { avg })}$ is the average of $i_{B}\left(t_{0}^{+}\right)=[5-(-2)] / 10=0.7 \mathrm{~mA}$ and $i_{B}\left(t_{1}\right)=$ $(5-0.6) / 10=0.44 \mathrm{~mA}$, that is, $i_{B(\text { avg })}=(0.7+0.44) / 2=0.57 \mathrm{~mA}$; moreover, $\Delta v_{B E}=v_{B E}\left(t_{1}\right)-v_{B E}\left(t_{0}\right)=0.6-(-2)=2.6 \mathrm{~V}=\Delta v_{B C}$. Making the crude approximations $C_{j e(\mathrm{eq})} \cong C_{j e 0}=1 \mathrm{pF}$ and $C_{j c(\mathrm{eq})} \cong C_{j e 0} / 2=0.5 / 2=$ 0.25 pF (see Problem 6.53 for better estimates) we get $t_{1}=(1+0.5 / 2) \times$ $10^{-12} \times 2.6 /\left(0.57 \times 10^{-3}\right)=5.7 \mathrm{~ns}$, in fair agreement with the value $t_{1}=5.2 \mathrm{~ns}$ measured via the cursor facility of PSpice.

- Active Region $\left(t_{1}\right.$ to $\left.t_{2}\right)$ : following $t_{1}$, the BJT is brought from the EOC ( $\left.v_{B} \cong 0.6 \mathrm{~V}\right)$ to full conduction ( $v_{B} \cong 0.7 \mathrm{~V}$ ). During this time $Q_{R}$ is still zero, but $Q_{F}$ builds up, causing $i_{C}$ to rise and thus $v_{C}$ to drop. At the instant $t_{2}$ when $v_{C}$ drops to $v_{C}=V_{C E(\mathrm{OSS})} \cong 0.2 \mathrm{~V}$ the BJT reaches the edge of saturation (EOS). During this time interval Eq. (6.122) simplifies as

$$
\begin{equation*}
i_{B}=\frac{Q_{F}}{\tau_{B F}}+\frac{d}{d t}\left(Q_{F}+Q_{j e}+Q_{j c}\right) \tag{6.128}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-047.jpg?height=1959&width=1426&top_left_y=185&top_left_x=203)

FIGURE 6.72 Plot of all relevant waveforms for the BJT inverter/switch of Fig. 6.71.

We estimate the time interval $t_{2}-t_{1}$ by approximating the above expression as

$$
\begin{align*}
i_{B(\mathrm{avg})} & \cong \frac{Q_{F(\mathrm{avg})}}{\tau_{B F}}+\frac{\Delta Q_{F}+\Delta Q_{j e}+\Delta Q_{j c}}{\Delta t} \\
& =\frac{Q_{F(\mathrm{avg})}}{\tau_{B F}}+\frac{\Delta Q_{F}+C_{j e(\mathrm{eq})} \Delta v_{B E}+C_{j c(\mathrm{eq})} \Delta v_{B C}}{t_{2}-t_{1}} \tag{6.129}
\end{align*}
$$

where $i_{B \text { (avg) }}$ is the average of $i_{B}\left(t_{1}\right)=440 \mu \mathrm{~A}$ and $i_{B}\left(t_{2}\right)=(5-0.7) / 10=430 \mu \mathrm{~A}$, that is, $i_{B \text { (avg) }}=435 \mu \mathrm{~A}$. Moreover, $\Delta v_{B E}=v_{B E}\left(t_{2}\right)-v_{B E}\left(t_{1}\right)=0.7-0.6=$ $0.1 \mathrm{~V}, \Delta v_{B C}=v_{B C}\left(t_{2}\right)-v_{B C}\left(t_{1}\right)=(0.7-0.2)-(0.6-5)=4.9 \mathrm{~V}, \Delta Q_{F}=Q_{F}\left(t_{2}\right)-$ $Q_{F}\left(t_{1}\right)=\tau_{F} i_{C}\left(t_{2}\right)-0=0.2 \times 10^{-9} \times(5-0.2) / 10^{3}=0.96 \mathrm{pC}$, so $Q_{F(\text { avg })}=$ $(0+0.96) / 2=0.48 \mathrm{pC}$. Using the crude approximations $C_{j e} \cong 2 C_{j e 0}=2 \mathrm{pF}$ and $C_{j c} \cong C_{j c 0}=0.5 \mathrm{pF}$ we get

$$
435 \times 10^{-6}=\frac{0.48 \times 10^{-12}}{50 \times 0.2 \times 10^{-9}}+\frac{(0.96+2 \times 0.1+0.5 \times 4.9) 10^{-12}}{t_{2}-t_{1}}
$$

Solving gives $t_{2}-t_{1}=9.3 \mathrm{~ns}$, in fair agreement with the value of 7.8 ns measured with the cursor.

- Saturation Region $\left(t_{2}\right.$ to $\left.t_{3}\right)$ : past $t_{2}$ the BJT enters deep saturation, where both junctions are forward biased and therefore both $Q_{F}$ and $Q_{R}$ are different from zero. Since $v_{B E}$ and $v_{B C}$ remain fairly constant in this region, $C_{j e}$ and $C_{j c}$ play an insignificant role now, so we can simplify Eq. (6.122) as

$$
\begin{equation*}
I_{B F}=\frac{Q_{F}}{\tau_{B F}}+\frac{Q_{R}}{\tau_{B R}}+\frac{d}{d t}\left(Q_{F}+Q_{R}\right) \tag{6.130}
\end{equation*}
$$

where

$$
\begin{equation*}
I_{B F}=\frac{V_{F}-V_{B E \text { (sat) }}}{R_{B}} \cong \frac{5-0.8}{10}=420 \mu \mathrm{~A} \tag{6.131}
\end{equation*}
$$

The total excess base charge in saturation is $Q_{B}=Q_{F}+Q_{R}$ (see Fig. 6.73b). Rewriting as

$$
\begin{equation*}
Q_{B}=Q_{F(\mathrm{EOS})}+Q_{S} \tag{6.132}
\end{equation*}
$$

suggests that we can regard $Q_{B}$ as the sum of the charge $Q_{F(\text { EOS })}$ needed to bring the BJT to the EOS (see Fig. 6.73a), and the charge $Q_{S}$ arising as the BJT is driven deeply into saturation proper (see Fig. 6.73c). We can likewise express $I_{B F}$ as

$$
I_{B F}=I_{B(\mathrm{EOS})}+I_{B S}
$$

where

$$
\begin{equation*}
I_{B(\mathrm{EOS})}=\frac{I_{C(\mathrm{EOS})}}{\beta_{F}}=\frac{\left(V_{C C}-V_{C E(\mathrm{EOS})}\right) / R_{C}}{\beta_{F}} \cong \frac{(5-0.2) / 1}{50}=96 \mu \mathrm{~A} \tag{6.133}
\end{equation*}
$$

is the base current needed to bring the BJT to the EOS, and

$$
I_{B S}=I_{B F}-I_{B(\mathrm{EOS})}=420-96=324 \mu \mathrm{~A}
$$

![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-049.jpg?height=423&width=1041&top_left_y=204&top_left_x=198)

FIGURE 6.73 Excess minority charges in the base: (a) at the EOS, and (b), (c) in deep saturation.
is the amount of base current above $I_{B(\operatorname{EOS})}$ that drives the BJT in deep saturation (note that the BJT is indeed saturated because $\beta_{s a t}=4.9 / 0.42=11.7 \ll \beta_{F}$ ). Aptly called the overdrive base current, $I_{B S}$ causes the overdrive base charge $Q_{S}$ to build up according to the charge-control equation ${ }^{8}$

$$
\begin{equation*}
I_{B S}=\frac{Q_{S}}{\tau_{S}}+\frac{d Q_{S}}{d t} \tag{6.134}
\end{equation*}
$$

where the time constant $\tau_{S}$ is a linear combination ${ }^{8}$ of $\tau_{B F}$ and $\tau_{B R}$,

$$
\begin{equation*}
\tau_{S}=\frac{\left(\beta_{R}+1\right) \tau_{B F}+\beta_{F} \tau_{B R}}{\beta_{F}+\beta_{R}+1} \tag{6.135}
\end{equation*}
$$

Using the data tabulated in Fig. 6.71 we get $\tau_{S}=[(2+1) 50 \times 0.2+50 \times$ $2 \times 10] /(50+2+1)=19.4$ ns. The solution to Eq. (6.134) is an exponential buildup of $Q_{S}$, governed by the time constant $\tau_{S}$ and tending asymptotically toward the steady-state value

$$
Q_{S(\mathrm{ss})}=\tau_{S} I_{B S}=19.4 \times 10^{-9} \times 324 \times 10^{-6}=6.3 \mathrm{pC}
$$

- Storage Time $\left(t_{3}\right.$ to $\left.t_{4}\right)$ : once $v_{S}$ is switched back to -2 V at $t=t_{3}=100 \mathrm{~ns}$, we need to remove the overdrive charge $Q_{S}$ if we want to bring the BJT back to the EOS. The removal of $Q_{S}$ is still governed by Eq. (6.134) provided we now use

$$
\begin{aligned}
I_{B S} & =I_{B R}-I_{B(\mathrm{EOS})}=\frac{V_{R}-V_{B E(\mathrm{sat})}}{R_{B}}-I_{B(\mathrm{EOS})}=\frac{-2-0.7}{10 \times 10^{3}}-(96 \mu \mathrm{~A}) \\
& =-270-96=-366 \mu \mathrm{~A}
\end{aligned}
$$

(Cognizant of the small step decrease in $v_{B}$, which is $\Delta v_{B}=r_{b} \Delta I_{B}$, we are now assuming $V_{B E(\text { sat })} \cong 0.7 \mathrm{~V}$ instead of the usual 0.8 V .) Since $I_{B S}$ is now negative, the solution to Eq. (6.134) is an exponential decay in $Q_{S}$, still governed by the time constant $\tau_{S}$ but tending asymptotically toward the (fictitious) steady-state value

$$
Q_{S}(\infty)=\tau_{S} I_{B S}=19.4 \times 10^{-9} \times\left(-366 \times 10^{-6}\right)=-7.1 \mathrm{pC}
$$

The decay holds up to the instant $t_{4}$ at which $Q_{S}$ becomes zero. The time interval $t_{S}=t_{4}-t_{3}$, aptly called the storage time, is readily found as ${ }^{7}$

$$
t_{S}=\tau_{S} \ln \frac{Q_{S}\left(t_{3}\right)-Q_{S}(\infty)}{Q_{S}\left(t_{4}\right)-Q_{S}(\infty)}=\tau_{S} \ln \frac{\tau_{S}\left(I_{B F}-I_{B(\mathrm{EO})}\right)-\tau_{S}\left(I_{B R}-I_{B(\mathrm{EOS})}\right)}{0-\tau_{S}\left(I_{B R}-I_{B(\mathrm{EOS})}\right)}
$$

that is,

$$
\begin{equation*}
t_{S}=\tau_{S} \ln \frac{I_{B F}-I_{B R}}{I_{B(\mathrm{EOS})}-I_{B R}} \tag{6.136}
\end{equation*}
$$

Presently we get $t_{s}=(19.4 \mathrm{~ns}) \ln [(420+270) /(96+270)]=12.3 \mathrm{~ns}$, which matches PSpice exactly.

- Active Region Again $\left(t_{4}\right.$ to $\left.t_{5}\right)$ : after removing $Q_{S}$ to bring the BJT back to the EOS, we need to remove $Q_{F}$ to bring it back to the edge of conduction, now more properly called the edge of cutoff (EOC). The removal of $Q_{F}$ is still governed by Eq. (6.128), but with $i_{B}=\left(V_{R}-V_{B E}\right) / R_{B}$. Using $i_{B(\text { avg })}=(-2-0.65) / 10=$ $-265 \mu \mathrm{~A}$, we suitably recycle Eq. (6.129) to write

$$
-265 \times 10^{-6}=\frac{0.48 \times 10^{-12}}{50 \times 0.2 \times 10^{-9}}-\frac{(0.96+2 \times 0.1+0.5 \times 4.9) 10^{-12}}{t_{5}-t_{4}}
$$

Solving gives $t_{5}-t_{4}=11.5 \mathrm{~ns}$, in fair agreement with the PSpice value of 9.2 ns .

- Recovery Region $\left(t>t_{5}\right)$ : once all the excess base charge has been wiped out, the BJT goes through a recovery phase to return $C_{j e}$ and $C_{j c}$ to the steady-state conditions preceding $t_{0}$. During this phase $v_{B}$ makes a pseudo exponential transistion from $v_{B}=V_{B E(\mathrm{EOC})} \cong 0.6 \mathrm{~V}$ to $v_{B}=V_{R}=-2 \mathrm{~V}$, as shown.
It is apparent that a BJT inverter/switch takes time to turn on and off. In particular, during turn-off, the BE junction continues to remain on from $t_{3}$ to $t_{5}$, during which time it acts as a $0.7-\mathrm{V}$ battery. Of special significance is the storage time $t_{s}$ from $t_{3}$ to $t_{4}$, during which the BJT remains saturated. This is usually a serious drawback, especially in high-speed logic or in power-switch applications.

### Schottky-Clamped BJTs

We can eliminate the storage time $t_{S}$ altogether by placing a Schottky barrier diode (SBD) in parallel with the base-collector (BC) junction, as shown in Fig. $6.74 a$ for the case of the $n p n$ BJT. Recall that the saturation current of a SBD is typically five orders of magnitude higher than that of an ordinary $p n$ junction, indicating that the forward voltage drop across a SBD is lower than that across a pn junction by about $5 \times(60 \mathrm{mV})=0.3 \mathrm{~V}$, giving $V_{S B D(\text { on })} \cong 0.7-0.3 \cong 0.4 \mathrm{~V}$ typical. Because of the SBD clamp, the BC junction is subject to the constraint $v_{B C} \leq 0.4 \mathrm{~V}$, which is insufficient to allow the BC junction to turn convincingly on. Hence, the BJT will always have $Q_{R}=0$ and, as such, it will never saturate.

Shown in Fig. $11.4 b$ is the monolithic realization of a Schottky-clamped npn BJT. Comparing with the structure of Fig. 2.1, we observe that all it takes to Schottkyclamp the BJT is to extend the metal electrode of the base over the $n^{-}$collector
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-051.jpg?height=452&width=1241&top_left_y=201&top_left_x=185)

FIGURE 6.74 (a) Schottky-clamped BJT and its circuit symbol. (a) Planar process fabrication.
region, where it forms the SBD. (Also shown at the right is the metal- $n^{+}$structure, which provides an ohmic contact between the metal electrode of the collector and the $n^{-}$epitaxial layer underneath.)
(a) Assuming the BJT of Fig. 6.71 is equipped with a SBD clamp having $V_{S B D(\text { (n) })} \cong 0.4 \mathrm{~V}$, find the steady-state currents $I_{B}, I_{C}$, and $I_{S B D}$ when $v_{S}=V_{F}=5 \mathrm{~V}$, and comment on your findings.
(b) Rerun the PSpice circuit of Fig. 6.71, but using a SBD. Comment on your findings.

### Solution

(a) The current through $R_{B}$ is $I\left(R_{B}\right)=\left(V_{F}-V_{B}\right) / R_{B} \cong(5-0.7) / 10=0.43 \mathrm{~mA}$. By KVL, $V_{C}=V_{B}-V_{S B D(\text { on })} \cong 0.7-0.4=0.3 \mathrm{~V}$, so the current through $R_{C}$ is $I\left(R_{C}\right)=\left(V_{C C}-V_{C}\right) / R_{C} \cong(5-0.3) / 1=4.7 \mathrm{~mA}$. Moreover, the BJT is operating in the FA region because $V_{C E} \cong 0.3 \mathrm{~V}$, which is $0.1-\mathrm{V}$ higher than $V_{C E(\mathrm{BOS})}(\cong 0.2 \mathrm{~V})$. Consequently, we can write $I_{C}=\beta_{F} I_{B}=50 I_{B}$. We need two more equations to solve for the three unknowns. These are provided by KCL at the base and at the collector nodes, where $I_{B}=I\left(R_{B}\right)-I_{S B D}=0.43-I_{S B D}$, and $I_{C}=I\left(R_{C}\right)+I_{S B D}=4.73+I_{S B D}$. Solving, we get

$$
I_{B}=100.6 \mu \mathrm{~A} \quad I_{C}=5.03 \mathrm{~mA} \quad I_{S B D}=0.33 \mathrm{~mA}
$$

Because of the SBD, only enough current is allowed into the base to keep the BJT about $0.1-\mathrm{V}$ away from the EOS. The overdrive current is diverted by the SBD to the collector, thus preventing the BJT from ever saturating.
(b) The clamped BJT of Fig. $6.75 a$ uses a SBD with the following PSpice model:

```
.model DSBD D(IS=1nA CJO=0.25pF VJ=1.6V M=0.4 EG=0.7)
```

The waveforms of Fig. $6.75 b$ confirm the elimination of the storage time. The rise and fall times of $v_{C}$ are a bit longer than those of the unclamped circuit of Fig. 6.71 because of the SBD's junction capacitance $C_{j}$, which is in parallel with $C_{j c}$. Moreover, $v_{C}$ is clamped at about 0.3 V , a bit higher than the 0.1 V of the circuit of Fig. 6.71.
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-052.jpg?height=830&width=1468&top_left_y=200&top_left_x=177)

FIGURE 6.75 (a) Schottky-clamped BJT inverter/switch, and (b) input and output waveforms.

## 6.12 TRANSIENT RESPONSE OF CMOS GATES AND VOLTAGE COMPARATORS

In binary-output circuits such as logic gates and voltage comparators it is of interest to know how rapidly the output changes state in response to a sudden change at the input. It takes time for the stray capacitances of the transistors and their interconnections to charge/discharge in response to an input step. As a rule, the smaller the capacitances and the higher the currents available to charge/discharge them, the faster the response.

### Propagation Delays in Logic Gates

The dynamics of a logic gate are characterized via the propagation delays, usually specified for the case of an inverter (the most basic representative of a logic family) driving $n$ similar inverters, or for a fanout of $n$ in logic-design jargon (see Fig. 6.76). A propagation delay is the amount of time it takes for the output to accomplish 50\% of its transition from one output level to the other following an input-step edge. Denoting the output levels as $V_{O L}$ and $V_{O H}$, we define the $50 \%$-point as

$$
\begin{equation*}
V_{50 \%}=\frac{V_{O L}+V_{O H}}{2} \tag{6.137}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-053.jpg?height=405&width=1178&top_left_y=208&top_left_x=200)

FIGURE 6.76 (a) Logic inverter $I_{0}$ with a fanout of $n$. (b) The propagation delays $t_{P H L}$ and $t_{P L H}$.

The time it takes for $v_{O}$ to rise from $V_{O L}$ to $V_{50 \%}$ is denoted as $t_{P L H}$, and the time it takes to drop from $V_{O H}$ to $V_{50 \%}$ is denoted as $t_{P H L}$. (Because of inherent internal circuit dissymmetries, $t_{P L H}$ and $t_{P H L}$ are not necessarily identical.) In the following we investigate the propagation delays of CMOS gates, presently the predominant digital technology. These gates have $V_{O L}=0$ and $V_{O H}=V_{D D}$, so $V_{50 \%}=V_{D D} / 2$. As circuit complexity increases, transient analysis by paper and pencil can easily become prohibitive, so we shall find the propagation delays via PSpice, and then use simplified hand analysis to obtain approximate estimates, both as a check on PSpice and as a means to gain insight into the inner workings of the gate.

### Transient Analysis of CMOS Gates via PSpice

In order to display the transient response, PSpice calculates all parasitic capacitances in the gate, so we need to provide PSpice with suitable process and device parameters. To this end, refer to the conceptual rendition of Fig. 6.77, which is similar to the basic structure of Fig. 6.8, except for an additional detail hitherto omitted for simplicity; these are the $p^{+}$channel-stop implants surrounding the $n^{+}$source and drain regions on three sides other than that facing the channel. The function of these implants is to electrically isolate adjacent FETs sharing the same bulk. (The portion of the bulk between the source/drain regions of two adjacent FETs forms a spurious channel that might become accidentally conductive. The $p^{+}$implants are designed to greatly increase the $V_{t}$ of these spurious channels and thus prevent them from accidentally turning on. Typically, the doping of the $p^{+}$implants is an order of magnitude higher than that of the $p^{-}$bulk, or $N_{\text {implant }} \cong 10 N_{\text {bulk }}$.) Because of the channel stops, each of the junction capacitances $C_{s b}$ and $C_{d b}$ consists of a bottom component $C_{j(\mathrm{btm})}$ associated with the $p^{-}-n^{+}$junction at the bottom of the source and drain region, and a sidewall component $C_{j(\mathrm{sw})}$ associated with the $p^{+}-n^{+}$junction around the region's perimeter. The net junction capacitance of the drain region is expressed as

$$
\begin{equation*}
C_{d b}=\frac{A_{d} \times C_{\mathrm{j} 0(\mathrm{btm})}}{\left(1-v_{B D} / \phi_{0(\mathrm{btm})}\right)^{m_{\mathrm{bm}}}}+\frac{P_{d} \times C_{j 0(\mathrm{sw})}}{\left(1-v_{B D} / \phi_{0(\mathrm{sw})}\right)^{m_{\mathrm{sw}}}} \tag{6.138}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-054.jpg?height=1239&width=999&top_left_y=207&top_left_x=449)

FIGURE 6.77 Conceptual views (top as well as cross sectional) of an nMOSFET. Note the $p^{+}$channel-stop implants surrounding the source and drain regions on the three sides other than the side facing the channel.
where

- $A_{d}$ is the area of the drain's bottom junction and $C_{j 0(\mathrm{bm})}$ is the zero-bias junction capacitance per unit area. Moreover, $\phi_{0(b \mathrm{bm})}$ is the bottom-junction built-in potential and $m_{\mathrm{btm}}$ is the grading coefficient.
- $P_{d}$ is the perimeter of the drain's sidewall junction, $C_{j 0(\mathrm{sw})}$ is the zero-bias junction capacitance per unit perimeter, $\phi_{0(\mathrm{sw})}$ is the sidewall-junction built-in potential, and $m_{\mathrm{sw}}$ is the grading coefficient.

For the geometry depicted at the top of Fig. 6.77 we have $A_{d}=Y_{d} \times W$ and $P_{d}=$ $2 Y_{d}+W$. Moreover, adapting Eq. (1.47b) to the present case, and simplifying owing
to the fact that $N_{A \text { (bulk) }} \ll N_{D(\text { drain })}$ and $N_{A(\text { implant })} \ll N_{D(\text { drain }),}$ we have

$$
\begin{equation*}
C_{j 0(\mathrm{btm})} \cong \sqrt{\frac{\varepsilon_{s i} q N_{A(\mathrm{bulk})}}{2 \phi_{0(\mathrm{bum})}}} \quad C_{j 0(\mathrm{sw})} \cong X_{j} \sqrt{\frac{\varepsilon_{s i} q N_{A(\mathrm{mpllat})}}{2 \phi_{0(\mathrm{sw})}}} \tag{6.139}
\end{equation*}
$$

where $X_{j}$ is the depth of the drain region, also shown in the figure. The process parameters of Eq. (6.139) apply also to the source region, the only possible differences being in its area $A_{s}$ and perimeter $P_{s}$, depending on device layout geometry. The above expressions are readily adapted to the case of the $p$ MOSFET, as the following example illustrates.
(a) Assuming an $n$ MOSFET with the process parameters $t_{o x}=20 \mathrm{~nm}, \mu_{n}=$

### EXAMPLE 6.26

$600 \mathrm{~cm}^{2} / \mathrm{Vs}, V_{t}=0.7 \mathrm{~V}, \lambda^{\prime}=0.1 \mu \mathrm{~m} / \mathrm{V}, L_{o v}=0.15 \mu \mathrm{~m}, X_{j}=0.25 \mu \mathrm{~m}$, $N_{D \text { (poly) }}=10^{20} \mathrm{~cm}^{-3}, N_{A \text { (bulk) }}=3 \times 10^{15} \mathrm{~cm}^{-3}, N_{A \text { (implant) }}=10 N_{A \text { (bulk) }}, m_{\text {btm }}=0.5$, and $m_{\text {sw }}=0.33$, find its process-related capacitances. Hence, find $A_{d}, P_{d}, A_{s}$, and $P_{s}$ if $L_{\text {drawn }}=1.0 \mu \mathrm{~m}, W=2.0 \mu \mathrm{~m}$, and $Y_{d}=Y_{s}=2.5 \mu \mathrm{~m}$.
(b) Assuming a $p$ MOSFET with the process parameters $t_{o x}=20 \mathrm{~nm}, \mu_{p}=$ $250 \mathrm{~cm}^{2} / \mathrm{Vs}, V_{t}=-0.7 \mathrm{~V}, \lambda^{\prime}=0.05 \mu \mathrm{~m} / \mathrm{V}, L_{o v}=0.2 \mu \mathrm{~m}, X_{j}=0.3 \mu \mathrm{~m}$, $N_{\text {A(poly) }}=10^{20} \mathrm{~cm}^{-3}, N_{D \text { (bulk) }}=1.8 \times 10^{16} \mathrm{~cm}^{-3}, N_{D(\text { implant })}=10 N_{D(\text { bulk })}, m_{\text {btm }}=0.5$, and $m_{\mathrm{sw}}=0.33$, find its process-related capacitances. Hence, find $A_{d}, P_{d}, A_{s}$, and $P_{s}$ if $L_{\text {drawn }}=1.0 \mu \mathrm{~m}, W=4.0 \mu \mathrm{~m}$, and $Y_{d}=Y_{s}=3.0 \mu \mathrm{~m}$.

### Solution

(a) For the $n$ MOSFET we have

$$
\begin{aligned}
& C_{o x}=\frac{\varepsilon_{o x}}{t_{o x}}=\frac{34.5}{20}=1.725 \frac{\mathrm{fF}}{\mu \mathrm{~m}^{2}} \\
& C_{o v}=C_{o x} L_{o v}=1.725 \times 0.15=0.259 \frac{\mathrm{fF}}{\mu \mathrm{~m}}=0.259 \frac{\mathrm{nF}}{\mathrm{~m}} \\
& \phi_{0(\mathrm{btm})}=V_{T} \ln \frac{N_{A(\text { bulk })} N_{D \text { (poly })}^{2}}{n_{i}^{2}}=0.026 \ln \frac{3 \times 10^{15} \times 10^{20}}{2 \times 10^{20}}=0.909 \mathrm{~V} \\
& \phi_{0(\text { sw })}=V_{T} \ln \frac{N_{A \text { (implant }} N_{D(\text { poly })}}{n_{i}^{2}}=0.026 \ln \frac{30 \times 10^{15} \times 10^{20}}{2 \times 10^{20}}=0.968 \mathrm{~V} \\
& C_{j 0(\text { thm })} \cong \sqrt{\frac{1.04 \times 10^{-12} \times 1.602 \times 10^{-19} \times 3 \times 10^{15}}{2 \times 0.909}}=16.6 \frac{\mathrm{nF}}{\mathrm{~cm}^{2}} \\
& =0.166 \frac{\mathrm{fF}}{\mu \mathrm{~m}^{2}}=166 \frac{\mu \mathrm{~F}}{\mathrm{~m}^{2}} \\
& C_{j 0(\mathrm{sw})} \cong\left(0.25 \times 10^{-4}\right) \sqrt{\frac{1.04 \times 10^{-12} \times 1.602 \times 10^{-19} \times 30 \times 10^{15}}{2 \times 0.968}} \\
& =12.7 \frac{\mathrm{nF}}{\mathrm{~cm}}=0.127 \frac{\mathrm{fF}}{\mu \mathrm{~m}}=0.127 \frac{\mathrm{nF}}{\mathrm{~m}}
\end{aligned}
$$

Finally, $A_{s}=A_{d}=Y_{d} \times W=2.5 \times 2=5 \mu \mathrm{~m}^{2}=5 \times 10^{-12} \mathrm{~m}^{2}$, and $P_{s}=P_{d}=$ $2 Y_{d}+W=2 \times 2.5+2=7 \mu \mathrm{~m}$.
(b) For the $p$ MOSFET we likewise find

$$
\begin{aligned}
C_{o x} & =1.725 \frac{\mathrm{fF}}{\mu \mathrm{~m}^{2}} \quad C_{o v}=1.725 \times 0.2=0.345 \frac{\mathrm{fF}}{\mu \mathrm{~m}}=0.345 \frac{\mathrm{nF}}{\mathrm{~m}} \\
\phi_{0(\mathrm{btm})} & =V_{T} \ln \frac{N_{D(\text { bulk })} N_{A(\text { poly })}}{n_{i}^{2}}=0.026 \ln \frac{1.8 \times 10^{16} \times 10^{20}}{2 \times 10^{20}}=0.955 \mathrm{~V} \\
\phi_{0(\mathrm{sw})} & =V_{T} \ln \frac{N_{D(\text { implant })} N_{A(\text { poly })}}{n_{i}^{2}}=0.026 \ln \frac{18 \times 10^{16} \times 10^{20}}{2 \times 10^{20}}=1.01 \mathrm{~V} \\
C_{j 0(\mathrm{btm})} & \cong \sqrt{\frac{1.04 \times 10^{-12} \times 1.602 \times 10^{-19} \times 1.8 \times 10^{16}}{2 \times 0.955}} \\
& =39.6 \frac{\mathrm{nF}}{\mathrm{~cm}^{2}}=0.396 \frac{\mathrm{fF}}{\mu \mathrm{~m}^{2}}=396 \frac{\mu \mathrm{~F}}{\mathrm{~m}^{2}} \\
C_{j 0(\mathrm{ss})} & \cong\left(0.3 \times 10^{-4}\right) \sqrt{\frac{1.04 \times 10^{-12} \times 1.602 \times 10^{-19} \times 18 \times 10^{16}}{2 \times 1.01}} \\
& =36.6 \frac{\mathrm{nF}}{\mathrm{~cm}}=0.366 \frac{\mathrm{fF}}{\mu \mathrm{~m}}=0.366 \frac{\mathrm{nF}}{\mathrm{~m}}
\end{aligned}
$$

Finally, $A_{s}=A_{d}=Y_{d} \times W=3 \times 4=12 \mu \mathrm{~m}^{2}=12 \times 10^{-12} \mathrm{~m}^{2}$, and $P_{s}=$ $P_{d}=2 Y_{d}+W=2 \times 3+4=10 \mu \mathrm{~m}$.

We are now ready to input the above data to PSpice for the transient analysis of a CMOS inverter based on the above MOSFETs and using $V_{D D}=3.3 \mathrm{~V}$. The circuit, shown in Fig. 6.78, has been created by recycling that of Fig. 3.65, and then by suitably editing the FET models and the circuit's netlist. The example shown is for a fanout of 1 , but it can easily be adapted to a higher fanout. The circuit includes also the wire capacitance $C_{w}$ to model the parasitic capacitance of the interconnections.

Following the instructions of Appendix 3A, we create the PSpice models as follows:

```
.model Mn NMOS(Level=1 Tox=20n Uo=600 Vto=0.7 Lambda=0.1
+ Ld=0.15u Gamma=0.18 phi=0.64 Cj=166u Mj=0.5 Cjsw=0.127n
+ Mjsw=0.33 Pb=0.909 Cgso=0.259n Cgdo=0.259n)
.model Mp PMOS(Level=1 Tox=20n Uo=250 Vto=-0.7 Lambda=0.05
+ Ld=0.2u Gamma=0.42 phi=0.73 Cj=396u Mj=0.5 Cjsw=0.366n
+ Mjsw=0.33 Pb=0.955 Cgso=0.345n Cgdo=0.345n)
```

A few remarks are in order. First, note that the dimensions are V, A, m, and s, with the exception of mobilities, which must be expressed in $\mathrm{cm}^{2} / \mathrm{Vs}$ (also, doping densities, when specified, must be expressed in atoms/cm ${ }^{3}$ ). In PSpice the zero-bias bottom and sidewall capacitances are denoted as Cj and Cj sw, and both use the same built-in potential Pb . Moreover, the unit-length overlap capacitances associated with the source
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-057.jpg?height=475&width=860&top_left_y=218&top_left_x=204)

FIGURE 6.78 PSpice circuit to display the transient response of CMOS inverter $I_{0}$ with a fanout of 1 .
and drain are denoted as Cgso and Cgdo. PSpice calculates automatically the parasitic capacitances of each FET in accordance with its instantaneous region of operation.

Once the process parameters have been entered in the model statements, we need to enter the device parameters in the netlist. To this end, use PSpice $\rightarrow$ Create Netlist to direct PSpice to generate the netlist, and then use PSpice $\rightarrow$ View Netlist to visualize it. The result is

```
* source CKT_of_Fig_6.78
V_VDD VDD 0 3.3Vdc
C_Cw 0 VO 5fF
C_Cx 0 VX 5fF
M_M1 VO IN VDD VDD Mp
M_M2 VO IN O O Mn
M_M3 VX VO VDD VDD Mp
M_M4 VX VO O O Mn
V_VI IN 0 PULSE 0 3.3V 100ps 0.1ps 0.1ps 400ps 1ns
```

Next, type in the individual transistor dimensions $L, W, A_{s}, P_{s}, A_{d}$, and $P_{d}$ as follows:

```
* source CKT_of_Fig_6.78
V_VDD VDD 0 3.3Vdc
C_Cw O VO 5fF
C_Cx O VX 5fF
M_M1 VO IN VDD VDD Mp L=1u W=4u As=12p Ps=10u Ad=12p
+ Pd=10u
M_M2 VO IN 0 0 Mn L=1u W=2u As=5p Ps=7u Ad=5p
+ Pd=7u
M_M3 VX VO VDD VDD Mp L=1u W=4u As=12p Ps=10u Ad=12p
+ Pd=10u
M_M4 VX VO O 0 Mn L=1u W=2u As=5p Ps=7u Ad=5p
+ Pd=7u
V_VI IN 0 PULSE 0 3.3V 100ps 0.1ps 0.1ps 400ps 1ns
```

![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-058.jpg?height=1213&width=1525&top_left_y=211&top_left_x=111)

FIGURE 6.79 Waveforms for the PSpice circuit of Fig. 6.78.

Finally, use File $\rightarrow$ Save to save it, and PSpice $\rightarrow$ Run to launch PSpice. This gives the waveforms of Fig. 6.79. Using the cursor facility we measure the delays and find $t_{P H L} \cong 39.6 \mathrm{ps}$ and $t_{P L H} \cong 43.3 \mathrm{ps}$.

### Hand Calculation of CMOS Gate Delays

No matter how powerful the computational tools at hand, a scrupulous engineer will always try to anticipate/check the results of simulation via hand calculations, even if the latter may provide only gross approximations. Shown in Fig. 6.80 are all parasitic capacitances for the case of a CMOS inverter with a fanout of 1. To facilitate hand analysis we lump all stray capacitances into a single equivalent capacitance $C_{e q}$ at the output node of the driving inverter $I_{0}$. Using inspection, we express the net capacitance between node $v_{o}$ and ground as

$$
\begin{equation*}
C_{e q}=C_{0}+C_{w}+C_{1} \tag{6.140}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-059.jpg?height=783&width=1534&top_left_y=210&top_left_x=205)

FIGURE 6.80 Showing all stray capacitances for a CMOS inverter with a fanout of 1 . To simplify hand calculations, $I_{0}$ can be regarded as a parasitics-free inverter driving a suitable equivalent capacitance $C_{e q}$.
where:

- $C_{0}$ is the equivalent capacitance seen looking into the output terminal of the inverter $I_{0}$ made up of $M_{1}$ and $M_{2}$. We have

$$
\begin{equation*}
C_{0}=C_{d b n}+C_{d b p}+2\left(C_{g d n}+C_{g d p}\right) \tag{6.141}
\end{equation*}
$$

with the factor of 2 stemming from the Miller effect (as $v_{I}$ changes from 0 to $V_{D D}$, $v_{O}$ changes from $V_{D D}$ to 0 , subjecting each of $C_{g d n}$ and $C_{g d p}$ to a voltage change of $2 V_{D D}$, in effect doubling both capacitances). Note that $C_{g s n}$ and $C_{g s p}$ are not connected to node $v_{o}$, so they do not contribute to $C_{0}$ (they only load down the input source $v_{I}$ ).

- $C_{w}$ is the capacitance of the wire interconnecting the two inverters ( $C_{w}$ increases with the fanout.)
- $C_{1}$ is the equivalent capacitance seen looking into the input terminal of the load inverter made up of $M_{3}$ and $M_{4}$. According to Fig. 6.79, the output $v_{X}$ of this inverter doesn't change significantly during $I_{0}$ 's $t_{P L H}$ or $t_{P H L}$, so we can ignore $C_{d b n}$ and $C_{d b p}$ and approximate $C_{1} \cong C_{g s n}+C_{g d n}+C_{g s p}+C_{g d n}$. Regardless of how the gate-channel capacitance splits between source and drain, we simply have

$$
\begin{equation*}
C_{1} \cong C_{o x}\left(W_{n} \times L_{n(\text { drawn })}+W_{p} \times L_{p(\text { drawn })}\right) \tag{6.142}
\end{equation*}
$$

where $L_{n(\text { drawn })}$ and $L_{p(\text { drawn })}$ are the drawn channel lengths, as depicted in Fig. 6.77.

EXAMPLE 6.27 Calculate all relevant stray capacitances in the CMOS inverter of Example 6.26.

### Solution

Using the data of Example 6.26 we get

$$
\begin{aligned}
& C_{d b n}=\frac{C_{j 0(\mathrm{btm})} A_{d n}}{\left(1-v_{B D} / \phi_{0(\mathrm{btm})}\right)^{m_{\mathrm{bum}}}}+\frac{C_{j 0(\mathrm{sw})} P_{d n}}{\left(1-v_{B D} / \phi_{0(\mathrm{btm})}\right)^{m_{\mathrm{mim}}}} \\
& =\frac{0.166 \times 5}{\left(1+v_{o} / 0.909\right)^{0.5}}+\frac{0.127 \times 7}{\left(1+v_{o} / 0.968\right)^{0.33}} \\
& C_{d b p}=\frac{C_{j 0(\mathrm{btm})} A_{d n}}{\left(1-v_{D B} / \phi_{0(\mathrm{bmm})}\right)^{m_{\mathrm{dum}}}}+\frac{C_{j 0(\mathrm{sw})} P_{d n}}{\left(1-v_{D B} / \phi_{0(\mathrm{btm})}\right)^{m_{\mathrm{sw}}}} \\
& =\frac{0.396 \times 12}{\left[1+\left(3.3-v_{o}\right) / 0.909\right]^{0.5}}+\frac{0.366 \times 10}{\left[1+\left(3.3-v_{o}\right) / 0.968\right]^{0.33}}
\end{aligned}
$$

that is,

$$
\begin{aligned}
C_{d b n} & =\frac{0.83 \mathrm{fF}}{\left(1+v_{o} / 0.909\right)^{0.5}}+\frac{0.89 \mathrm{fF}}{\left(1+v_{o} / 0.968\right)^{0.33}} \\
C_{d b p} & =\frac{4.75 \mathrm{fF}}{\left(4.63-v_{O} / 0.909\right)^{0.5}}+\frac{3.66 \mathrm{fF}}{\left(4.41-v_{o} / 0.968\right)^{0.33}}
\end{aligned}
$$

Moreover,

$$
\begin{aligned}
2\left(C_{g d n}+C_{g d p}\right) & =2\left(C_{o v n} \times W_{n}+C_{o v p} \times W_{p}\right)=2(0.259 \times 2+0.345 \times 4) \\
& =3.80 \mathrm{fF}
\end{aligned}
$$

and

$$
\begin{aligned}
C_{1} & =C_{o x}\left(W_{n} \times L_{n(\text { drawn })}+W_{p} \times L_{p(\text { drawn })}\right)=1.725(2 \times 1+4 \times 1) \\
& =10.35 \mathrm{fF}
\end{aligned}
$$

Taking also $C_{w}=5 \mathrm{fF}$ into account and combining according to Eq. (6.140) we finally obtain

$$
\begin{aligned}
C_{e q}= & \frac{0.83 \mathrm{fF}}{\left(1+\frac{v_{O}}{0.909}\right)^{0.5}}+\frac{0.89 \mathrm{fF}}{\left(1+\frac{v_{O}}{0.968}\right)^{0.33}}+\frac{4.75 \mathrm{fF}}{\left(4.63-\frac{v_{o}}{0.909}\right)^{0.5}} \\
& +\frac{3.66 \mathrm{fF}}{\left(4.41-\frac{v_{O}}{0.968}\right)^{0.33}}+19.15 \mathrm{fF}
\end{aligned}
$$

![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-061.jpg?height=424&width=518&top_left_y=211&top_left_x=201)
(a)
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-061.jpg?height=355&width=442&top_left_y=250&top_left_x=784)
(b)

FIGURE 6.81 (a) Equivalent circuit for the estimation of $t_{P H L}$ and (b) waveforms.

We now wish to find quick estimates for the propagation delays. To estimate $t_{P H L}$ refer to Fig. 6.81, showing the situation after the transition of $v_{I}$ from 0 to $V_{D D}$. With $M_{p}$ off, $M_{n}$ pulls the current $i_{D n}$ out of $C_{e q}$, thus discharging it. Given the various approximations already made, we make one more and estimate the discharge from $V_{D D}$ to $V_{50 \%}\left(=0.5 V_{D D}\right)$ via the rule $C \Delta V=I \Delta t$ (cee delta vee equals aye delta tee), where $C=C_{e q}, \Delta V=0.5 V_{D D}, \Delta t=t_{P H L}$, and $I=i_{D n(\text { (avg })}$ is the average of $i_{D n}$ over the $t_{P H L}$ interval. We thus have

$$
\begin{equation*}
t_{P H L} \cong \frac{0.5 V_{D D} C_{e q}}{i_{D n(\text { avg })}} \tag{6.143a}
\end{equation*}
$$

Considering that at the beginning of the $t_{P H L}$ interval $M_{n}$ is in saturation and at the end it is in the triode region, we write

$$
\begin{equation*}
i_{D n(\mathrm{avg})}=\frac{1}{2} k_{n}^{\prime} W_{n}\left\{\frac{1}{2}\left(V_{D D}-V_{t n}\right)^{2}\left(1+\lambda_{n} V_{D D}\right)+\left[\left(V_{D D}-V_{t n}\right) \frac{V_{D D}}{2}-\frac{1}{2}\left(\frac{V_{D D}}{2}\right)^{2}\right]\left(1+\lambda_{n} \frac{V_{D D}}{2}\right)\right\} \tag{6.143b}
\end{equation*}
$$

Similar considerations hold for the estimation of $t_{P L H}$. Shown in Fig. 6.82 is the situation after the transition of $v_{I}$ from $V_{D D}$ to 0 . Now $M_{n}$ is off while $M_{p}$ sources the current $i_{D p}$ to $C_{e q}$, thus charging it. Adapting the above equations we write

$$
\begin{equation*}
t_{P L H} \cong \frac{0.5 V_{D D} C_{e q}}{i_{D p(\text { avg })}} \tag{6.144a}
\end{equation*}
$$

where

$$
\begin{equation*}
i_{D p(\mathrm{avg})}=\frac{1}{2} k_{p}^{\prime} \frac{W_{p}}{L_{p}}\left\{\frac{1}{2}\left(V_{D D}+V_{t p}\right)^{2}\left(1+\lambda_{p} V_{D D}\right)+\left[\left(V_{D D}+V_{t p}\right) \frac{V_{D D}}{2}-\frac{1}{2}\left(\frac{V_{D D}}{2}\right)^{2}\right]\left(1+\lambda_{p} \frac{V_{D D}}{2}\right)\right\} \tag{6.144b}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-062.jpg?height=466&width=1081&top_left_y=206&top_left_x=443)

FIGURE 6.82 (a) Equivalent circuit for the estimation of $t_{P L H}$ and (b) waveforms.
(a) Using the data of Example 6.27, estimate the propagation delays of the CMOS inverter of Fig. 6.78 and compare with PSpice.
(b) What would be the delays with a fanout of 0 and $C_{w}=0$ ?

### Solution

(a) We have $k_{n}^{\prime}=600 \times\left(10^{-2}\right)^{2} \times 1.725 \times 10^{-15} /\left(10^{-6}\right)^{2}=103.5 \mu \mathrm{~A} / \mathrm{V}^{2}, L_{n}=$ $1.0-2 \times 0.15=0.7 \mu \mathrm{~m}, k_{p}^{\prime}=250 \times 1.725 \times(0.1)=43.1 \mu \mathrm{~A} / \mathrm{V}^{2}$, and $L_{p}=1.0-2 \times 0.2=0.6 \mu \mathrm{~m}$. By Eqs. (6.143b) and (6.144b),

$$
\begin{aligned}
i_{D n(\mathrm{avg})}= & \frac{1}{2} 103.5 \frac{2}{0.7}\left\{\frac{1}{2}(3.3-0.7)^{2}(1+0.1 \times 3.3)\right. \\
& \left.+\left[(3.3-0.7) \frac{3.3}{2}-\frac{1}{2}\left(\frac{3.3}{2}\right)^{2}\right]\left(1+0.1 \frac{3.3}{2}\right)\right\}=1.17 \mathrm{~mA} \\
i_{D p(\mathrm{avg})}= & \frac{1}{2} 43.1 \frac{4}{0.6}\left\{\frac{1}{2}(3.3-0.7)^{2}(1+0.05 \times 3.3)\right. \\
& \left.+\left[(3.3-0.7) \frac{3.3}{2}-\frac{1}{2}\left(\frac{3.3}{2}\right)^{2}\right]\left(1+0.05 \frac{3.3}{2}\right)\right\}=1.02 \mathrm{~mA}
\end{aligned}
$$

A problem with $C_{e q}$ is that its components $C_{d b n}$ and $C_{d b p}$ depend on $v_{o}$. We can simplify our analysis by computing them at the beginning and at the end of the propagation interval under consideration, and then using their average value. Thus, at the beginning of $t_{P H L}$ we have $v_{O}=3.3 \mathrm{~V}$, where we calculate $C_{d b n}(3.3)=0.93 \mathrm{fF}$ and $C_{d b p}(3.3)=8.41 \mathrm{fF}$. At the end of $t_{P H L}$ we have $v_{O}=$ 1.65 V , where we calculate $C_{d b n}(1.65)=1.15 \mathrm{fF}$ and $C_{d b p}(1.65)=5.47 \mathrm{fF}$. The average of their sum is thus $0.5(0.93+8.41+1.15+5.47)=7.98 \mathrm{fF}$. Consequently, $C_{e q}=7.98+19.15=27.13 \mathrm{fF}$, and

$$
t_{P H L} \cong \frac{1.65 \times 27.13 \times 10^{-15}}{1.17 \times 10^{-3}}=38.3 \mathrm{ps}(39.6 \mathrm{ps} \text { with PSpice })
$$

Likewise, at the beginning of $t_{P L H}$ we have $v_{O}=0$, where $C_{d b n}(0)=1.72 \mathrm{fF}$ and $C_{d b p}(0)=4.45 \mathrm{fF}$. At the end of $t_{P L H}$ we have $v_{O}=1.65 \mathrm{~V}$, so we recycle $C_{d b n}(1.65)=1.15 \mathrm{fF}$ and $C_{d b p}(3.3)=5.47 \mathrm{fF}$. The average of their sum is thus $0.5(1.72+4.45+1.65+5.47)=6.65 \mathrm{fF}$. Consequently, $C_{e q}=6.65+$ $19.15=25.80 \mathrm{fF}$, and

$$
t_{P L H} \cong \frac{1.65 \times 25.80 \times 10^{-15}}{1.02 \times 10^{-3}}=41.7 \mathrm{ps}(43.3 \mathrm{ps} \text { with PSpice })
$$

(b) With a fanout of 0 , only $C_{0}$ will appear in the calculations, so we need to recalculate but with $C_{e q}$ reduced by the sum $C_{1}+C_{w}(=10.35+5=15.35 \mathrm{fF})$. So, for $t_{P H L}$ we have $C_{e q}=27.13-15.35=11.78 \mathrm{fF}$, and we use proportionality to find $t_{P H L}=38.3(11.78 / 27.13) \cong 16.6 \mathrm{ps}$ ( 20 ps with PSpice). Likewise, using $C_{e q}=28.80-15.35=13.45 \mathrm{fF}$ we get $t_{P L H}=41.7(13.45 / 25.80) \cong$ 21.7 ps (18.7 ps with PSpice).

### Power Dissipation of CMOS Logic Gates

As a CMOS inverter is sitting in either state ( $v_{O}=0$ or $v_{O}=V_{D D}$ ), one of its two transistors is off, drawing only leakage current. We say that the static power dissipation of a CMOS gate is virtually zero. However, when the output is switched from one state to the other, energy is expended to charge/discharge the stray capacitances, thus resulting in nonzero dynamic power dissipation.

Specifically, to switch $v_{O}$ from 0 to $V_{D D}, M_{p}$ must expend some energy $E_{p}$ in order to charge $C_{e q}$ to $V_{D D}$ (see Fig. 6.82a). Once charged, $C_{e q}$ holds the energy $E_{C}=$ $(1 / 2) C_{e q} V_{D D}^{2}$. Likewise, to return $v_{O}$ from $V_{D D}$ to $0, M_{n}$ must expend some energy $E_{n}$ in order to discharge $C_{e q}$ to 0 (see Fig. 6.81a). By the energy conservation principle we must have $E_{n}=E_{C}$. Also, by symmetry, $E_{p}=E_{n}$. The amount of energy dissipated by the gate during a complete cycle is thus $E_{\text {cycle }}=E_{p}+E_{n}=2 E_{C}=C_{e q} V_{D D}^{2}$. If the gate is operated at an average frequency of $f_{\text {avg }}$ cycles/sec, the average power $P$ dissipated by the gate equals, by definition, the amount of energy dissipated in 1 sec , or $P=$ $E_{\text {cycle }} \times f_{\text {avg }}$. Consequently, we have

$$
\begin{equation*}
P=C_{e q} V_{D D}^{2} f_{a v g} \tag{6.145}
\end{equation*}
$$

It is apparent that the higher the operating frequency, the higher the dissipation. Moreover, power scales quadratically with the power supply.

Using the data of Example 6.28 , estimate $P$ for $f_{\text {avg }}=1 \mathrm{kHz}$. What happens if $f_{\text {avg }}$ is raised to 100 MHz ?

### Solution

By Eq. (6.145), $P=25.80 \times 10^{-15} \times 3.3^{2} \times 10^{3}=0.281 \mathrm{nW}$. Now $P=$ $(0.281 \mathrm{nW}) \times\left(10^{8} / 10^{3}\right)=28.1 \mu \mathrm{~W}$.

### Transient Response of Voltage Comparators

Being digital-ouput devices, comparators are characterized via propagation delays just like logic gates. However, being analog-input devices, the input test conditions are specified differently. As shown in Fig. 6.83, the input is usually a pulse with a $100-\mathrm{mV}$ baseline and an overdrive $V_{O V}$ designed to barely exceed a level that will cause the comparator to trip (typically, $V_{O V}$ is in the mV range). Given the circuit complexity of a comparator, hand analysis is generally prohibitive, so computer simulation becomes a necessity. The IC designer will simulate a comparator at the transistor level, whereas the user will most likely simulate it using the macro-model supplied by the manufacturer.
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-064.jpg?height=222&width=344&top_left_y=934&top_left_x=446)

GND (a)
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-064.jpg?height=218&width=468&top_left_y=626&top_left_x=844)
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-064.jpg?height=297&width=410&top_left_y=847&top_left_x=901)
(b)

FIGURE 6.83 (a) Test circuit to investigate (b) the transient response of a voltage comparator.

Shown in Fig. 6.84 is a PSpice circuit to display the transient response of the popular LM339 comparator, using its SPICE macro-model. Figure 6.85 shows the responses to the leading as well as the trailing edge of the input pulse (note the dissymmetry reflecting internal circuit dissymmetries, particularly in the output stage). The overdrives used are $V_{O V}=5 \mathrm{mV}, 20 \mathrm{mV}$, and 100 mV . As a rule, the higher the overdrive, the shorter the propagation delays.
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-064.jpg?height=456&width=506&top_left_y=1573&top_left_x=414)

FIGURE 6.84 PSpice circuit to display the transient responses of the LM339 voltage comparator for different input overdrives.
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-065.jpg?height=837&width=1469&top_left_y=194&top_left_x=186)

FIGURE 6.85 The transient responses of the PSpice circuit of Fig. 6.84 for different input overdrives.

## APPENDIX 6A

### Transfer Functions and Bode Plots

The frequency characteristics of circuits are represented mathematically via transfer functions and are visualized graphically via Bode plots. A transfer function is a function of the complex frequency s, the most common examples being gain and input/ output impedances. Gain is the ratio of the Laplace's transforms of the output and input signals, or $a(s)=S_{o}(s) / S_{i}(s)$. The transfer functions of interest to us can always be put, through suitable algebraic manipulations, in the following insightful standard form

$$
a(s)=a_{0} \frac{\left(1+s / \omega_{z 1}\right)\left(1+s / \omega_{z 2}\right) \ldots\left(1+s / \omega_{z n}\right)}{\left(1+s / \omega_{p 1}\right)\left(1+s / \omega_{p 2}\right) \ldots\left(1+s / \omega_{p n}\right)}
$$

where $a_{0}$ is the value of $a(s)$ in the limit $s \rightarrow 0$ and is thus referred to as the lowfrequency gain. (This is the gain that we have been dealing with in the previous chapters). Since the numerator vanishes for $s=-\omega_{z 1}, s=-\omega_{z 2}, \ldots s=-\omega_{z n}$, the $\omega_{z} \mathrm{~s}$ are referred to as the zero frequencies of $a(s)$. These frequencies are real, and may be positive, negative, or even infinite. The denominator vanishes for $s=-\omega_{p 1}$, $s=-\omega_{p 2}, \ldots s=-\omega_{p n}$, causing $a(s)$ to blow up to infinity. The $\omega_{p} \mathrm{~s}$ are referred to as the pole frequencies of $a(s)$, and in this chapter they are real and positive. Poles and zeros are jointly referred to as roots.

An important tenet of systems theory ${ }^{7}$ states that if we are interested only in the ac steady-state response of a circuit, also called the frequency response, then we can restrict our transfer-function calculations to the $j \omega$ axis only. We do this simply by letting $s \rightarrow j \omega$, after which we get

$$
\begin{equation*}
a(j \omega)=a_{0} \frac{\left(1+j \omega / \omega_{z 1}\right)\left(1+j \omega / \omega_{z 2}\right) \ldots\left(1+j \omega / \omega_{z n}\right)}{\left(1+j \omega / \omega_{p 1}\right)\left(1+j \omega / \omega_{p 2}\right) \ldots\left(1+j \omega / \omega_{p n}\right)} \tag{6A.1}
\end{equation*}
$$

Clearly, $a(j \omega)$ is a complex function. Its magnitude $|a|$ and phase angle $\mathrm{ph} a$ are found as

$$
\begin{equation*}
|a(j \omega)|=\left|a_{0}\right| \sqrt{\frac{\left(1+\omega^{2} / \omega_{z 2}^{2}\right)\left(1+\omega^{2} / \omega_{z 2}^{2}\right) \ldots\left(1+\omega^{2} / \omega_{z n}^{2}\right)}{\left(1+\omega^{2} / \omega_{p 1}^{2}\right)\left(1+\omega^{2} / \omega_{p 2}^{2}\right) \ldots\left(1+\omega^{2} / \omega_{p n}^{2}\right)}} \tag{6A.2}
\end{equation*}
$$

and

$$
\begin{equation*}
\operatorname{ph} a(j \omega)=\tan ^{-1} \frac{\omega}{\omega_{z 1}}+\tan ^{-1} \frac{\omega}{\omega_{z 2}}+\cdots \tan ^{-1} \frac{\omega}{\omega_{z \mathrm{n}}}-\tan ^{-1} \frac{\omega}{\omega_{p 1}}-\tan ^{-1} \frac{\omega}{\omega_{p 2}} \cdots-\tan ^{-1} \frac{\omega}{\omega_{p n}} \tag{6A.3}
\end{equation*}
$$

The frequency behavior of $|a(j \omega)|$ and $\operatorname{ph} a(j \omega)$ is best visualized via frequency plots. Magnitude is expressed in decibels as

$$
\begin{equation*}
|a(j \omega)|_{\mathrm{dB}}=20 \log _{10}|a(j \omega)| \tag{6A.4}
\end{equation*}
$$

and $\mathrm{ph} a(j \omega)$ is expressed in degrees, and both functions are plotted versus $\omega$ on a logarithmic scale. The most common frequency intervals are decades ( $\omega=\ldots 10^{-2}$, $10^{-1}, 10^{0}, 10^{1}, 10^{2} \ldots \mathrm{rad} / \mathrm{s}$ ), though octave intervals are also used ( $\omega=\ldots 2^{-2}$, $2^{-1}, 2^{0}, 2^{1}, 2^{2} \ldots \mathrm{rad} / \mathrm{s}$ ), especially in connection with audio circuits. Following is a worth-remembering list of frequently occurring gains as well as their decibel values:

$$
\begin{equation*}
|1|_{\mathrm{dB}}=0 \mathrm{~dB} \quad\left|2^{ \pm 1 / 2}\right|_{\mathrm{dB}}= \pm 3 \mathrm{~dB} \quad\left|2^{ \pm n}\right|_{\mathrm{dB}}= \pm 6 n \mathrm{~dB} \quad\left|10^{ \pm n}\right|_{\mathrm{dB}}= \pm 20 n \mathrm{~dB} \tag{6A.5}
\end{equation*}
$$

Note that positive decibels imply amplification and negative decibels imply attenuation, with the borderline between the two being 0 dB , or unity gain. Moreover, given two transfer functions $a_{1}(j \omega)$ and $a_{2}(j \omega)$, we have, by familiar properties of logarithms,

$$
\begin{gather*}
\left|a_{1} \times a_{2}\right|_{\mathrm{dB}}=\left|a_{1}\right|_{\mathrm{dB}}+\left|a_{2}\right|_{\mathrm{dB}}  \tag{6A.6a}\\
\left|a_{1}(j \omega) / a_{2}(j \omega)\right|_{\mathrm{dB}}=\left|a_{1}\right|_{\mathrm{dB}}-\left|a_{2}\right|_{\mathrm{dB}} \tag{6A.6b}
\end{gather*}
$$

that is, the magnitude plot of a product (ratio) is simply the sum (difference) of the individual magnitude plots. In particular, $|1 / a|_{\mathrm{dB}}=-|a|_{\mathrm{AB}}$, that is, the magnitude plot of the reciprocal is simply the magnitude plot of the original, but reflected about the horizontal axis.

Given a root $\omega_{0}$, we will make use of the following approximations:

$$
\begin{gather*}
\left(\omega \ll \omega_{0}\right) \Rightarrow\left(1+j \omega / \omega_{0}\right) \rightarrow 1  \tag{6A.7a}\\
\left(\omega \gg \omega_{0}\right) \Rightarrow\left(1+j \omega / \omega_{0}\right) \rightarrow j \omega / \omega_{0} \tag{6~A.7~b}
\end{gather*}
$$

![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-067.jpg?height=536&width=1090&top_left_y=204&top_left_x=197)

FIGURE 6A. 1 Frequency plots of the (a) differentiator $j \omega / \omega_{0}$ and (b) integrator $1 /\left(j \omega / \omega_{0}\right)$ functions.

The function $j \omega / \omega_{0}$ is called the differentiator function, and its reciprocal $1 /\left(j \omega / \omega_{0}\right)$ is called the integrator function. These functions have, respectively, a zero and a pole at the origin, and their magnitudes are, $\left|j \omega / \omega_{0}\right|_{\mathrm{AB}}=20 \log \left(\omega / \omega_{0}\right)$ and $\left|1 /\left(j \omega / \omega_{0}\right)\right|_{\mathrm{dB}}=$ $-20 \log \left(\omega / \omega_{0}\right)$. With a logarithmic frequency scale, these equations are of the type $y= \pm 20 x$, that is, straight lines with a slope of $+20 \mathrm{~dB} /$ decade $(+6 \mathrm{~dB} /$ octave $)$ in the differentiator case, and $-20 \mathrm{~dB} /$ decade ( $-6 \mathrm{~dB} /$ octave) in the integrator case. These curves are shown in Fig. 6A.1. Since the two functions are the reciprocal of each other, the plot of one is obtained from the other by a simple reflection about the $0-\mathrm{dB}$ axis. Both curves intersect the $0-\mathrm{dB}$ axis at $\omega=\omega_{0}$, so $\omega_{0}$ is aptly called the unity-gain frequency.

### Bode Plots

To speed up drawing frequency plots by hand, Hendrik W. Bode (1905-1982) proposed a piecewise linear approximation consisting of suitably sloped straight segments joined together at the various root frequencies. This technique assumes the approximations of Eqs. (6A.7) to be valid not only far away from a given root, but also in the vicinity of it. It turns out that this technique is quite adequate if the roots are widely spaced, say by a decade or more. Even if they aren't, it still provides valuable insight into the frequency behavior of a circuit.

To illustrate the technique, consider the function

$$
\begin{equation*}
a(j \omega)=100 \frac{\left(1+j \omega / 10^{1}\right)\left(1+j \omega / 10^{5}\right)}{\left(1+j \omega / 10^{2}\right)\left(1+j \omega / 10^{3}\right)\left(1+j \omega / 10^{4}\right)} \tag{6A.8}
\end{equation*}
$$

having a dc gain of 100 , two zero frequencies at $10^{1}$ and $10^{5} \mathrm{rad} / \mathrm{s}$, and three pole frequencies at $10^{2}, 10^{3}$, and $10^{4} \mathrm{rad} / \mathrm{s}$. (For simplicity the roots have been assumed to have nicely rounded values, spaced a decade apart from each other.) To construct the

Bode plot, start out at low frequencies and proceed toward high frequencies, stopping at each root to determine the slope of the next segment.

- For $\omega \ll 10^{1} \mathrm{rad} / \mathrm{s}$ (first root), all numerator and denominator terms in Eq. (6A.8) satisfy Eq. (6A.7a), giving $a(j \omega) \cong 100=40 \mathrm{~dB}$. Bode's approximation is to assume that this holds all the way up to the first root of $10^{1} \mathrm{rad} / \mathrm{s}$, that is, for $\omega \leq 10^{1} \mathrm{rad} / \mathrm{s}$ (not just for $\omega \ll 10^{1} \mathrm{rad} / \mathrm{s}$ ). Consequently, the first portion of the plot is a horizontal segment positioned at 40 dB .
- For $10^{1} \ll \omega \ll 10^{2} \mathrm{rad} / \mathrm{s}$, the first numerator term satisfies Eq. (6A.7b) while all others still satisfy Eq. $(6 \mathrm{~A} .7 a)$, giving $a(j \omega) \cong 100 \times\left(j \omega / 10^{1}\right)$. This is a differentiator function with a unity-gain frequency of $\omega=10^{1} \mathrm{rad} / \mathrm{s}$, but shifted upwards by 40 dB , as per Eq. (6A.6a). The result is a segment with a slope of $+20 \mathrm{~dB} / \mathrm{dec}$. Bode's approximation is to assume that this holds over the entire interval $10^{1} \leq \omega \leq 10^{2} \mathrm{rad} / \mathrm{s}$, not just well away from its extremes.
- Proceeding in similar manner, we can say that for $10^{2} \leq \omega \leq 10^{3} \mathrm{rad} / \mathrm{s}$, the first numerator and the first denominator terms satisfy Eq. (6A.7b) while all others still satisfy Eq. $(6 \mathrm{~A} \cdot 7 a)$. Consequently, $a(j \omega) \cong 100 \times\left(j \omega / 10^{1}\right) /\left(j \omega / 10^{2}\right)=$ $1000=60 \mathrm{~dB}$. This is again a horizontal segment but positioned at 60 dB .
- For $10^{3} \leq \omega \leq 10^{4} \mathrm{rad} / \mathrm{s}$, the first numerator term, and the second and third denominator terms satisfy Eq. (6A.7b) while all others still satisfy Eq. (6A.7a), so $a(j \omega) \cong 100 \times\left(j \omega / 10^{1}\right) /\left[\left(j \omega / 10^{2}\right)\left(j \omega / 10^{3}\right)\right]=1000 /\left(j \omega / 10^{3}\right)$. This is an integrator function with a unity-gain frequency of $\omega=10^{3} \mathrm{rad} / \mathrm{s}$, but shifted upwards by 60 dB , as per Eq. (6A.6a). The result is a segment with a slope of $-20 \mathrm{~dB} / \mathrm{dec}$.
- Likewise, for $10^{4} \leq \omega \leq 10^{5} \mathrm{rad} / \mathrm{s}$ we write $a(j \omega) \cong 1000 /\left[\left(j \omega / 10^{3}\right)\left(j \omega / 10^{4}\right)\right]$, indicating that another integrator term has kicked in at $\omega=10^{4} \mathrm{rad} / \mathrm{s}$, causing an additional $-20-\mathrm{dB}$ change in slope, for a net slope of $-40 \mathrm{~dB} / \mathrm{dec}$ over this frequency interval. We can say that over this frequency interval our transfer function exhibits double-integrator behavior.
- For $\omega \geq 10^{5} \mathrm{rad} / \mathrm{s}$, all numerator and denominator terms satisfy Eq. (6A.7b), thus giving, after simplifications, $a(j \omega) \cong 1 /\left(j \omega / 10^{5}\right)$. This is again an integrator function, now with a unity-gain frequency of $10^{5} \mathrm{rad} / \mathrm{s}$. Above this breakpoint gain rolls off with frequency with a slope of $-20 \mathrm{~dB} / \mathrm{dec}$.

To get an idea of the errors incurred in using linearized magnitude plots, consider the gain at $\omega=10^{1} \mathrm{rad} / \mathrm{s}$ (first root). By Eq. (6A.2) we have

$$
\begin{aligned}
|a(j 10)| & =100 \sqrt{\frac{\left[1+\left(10 / 10^{1}\right)^{2}\right]\left[1+\left(10 / 10^{5}\right)^{2}\right]}{\left[1+\left(10 / 10^{2}\right)^{2}\right]\left[1+\left(10 / 10^{3}\right)^{2}\right]\left[1+\left(10 / 10^{4}\right)^{2}\right]}} \\
& \cong 100 \sqrt{2}=(40+3) \mathrm{dB}=43 \mathrm{~dB}
\end{aligned}
$$

indicating that our linearized plot underestimates magnitude by 3 dB at the first root frequency. Likewise, you can verify that $\left|a\left(j 10^{2}\right)\right| \cong 1000 / \sqrt{2}=60-3=57 \mathrm{~dB}$, indicating a $3-\mathrm{dB}$ overestimate at the second root. A quick look at Fig. 6A. 2 confirms that the piecewise linear approximation is fairly close to the exact plot, shown in shaded form.
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-069.jpg?height=470&width=682&top_left_y=211&top_left_x=204)

FIGURE 6A. 2 Linearized Bode plot for the gain of Eq. (6A.8). The shaded curves show the exact plot.

The procedure for drawing linearized Bode plots can be speeded up considerably as follows:

- Starting out at low frequencies, draw the low-frequency asymptote up to the first nonzero root. This asymptote will be horizontal if the transfer function has no roots at the origin, or will have a slope of $\pm 20-\mathrm{dB} / \mathrm{dec}$ for each zero/pole at the origin.
- As you move toward the right and hit a root frequency, change the present slope by either $+20 \mathrm{~dB} / \mathrm{dec}$ or by $-20 \mathrm{~dB} / \mathrm{dec}$, depending on whether this root is, respectively, a zero ( + ) or a pole ( - ).
- Proceed toward the right till all roots have been exhausted.

As another example, consider the function

$$
\begin{equation*}
a(j \omega)=10 \frac{j \omega\left(1+j \omega / 10^{3}\right)}{\left(1+j \omega / 10^{1}\right)\left(1+j \omega / 10^{2}\right)\left(1+j \omega / 10^{4}\right)} \tag{6A.9}
\end{equation*}
$$

To draw the linearized magnitude plot, proceed as follows:

- At low frequencies all terms within parentheses reduce to unity, so the lowfrequency asymptote is $a(j \omega) \cong 10 j \omega=j \omega / 10^{-1}$. This is a differentiator function with a unity-gain frequency of $\omega=10^{-1} \mathrm{rad} / \mathrm{s}$, so the asymptote is a straight line with a slope of $+20 \mathrm{~dB} / \mathrm{dec}$ and a $0-\mathrm{dB}$ axis intercept at $10^{-1} \mathrm{rad} / \mathrm{s}$.
- Coming from the left, draw this asymptote till you hit the first nonzero root at $10^{1} \mathrm{rad} / \mathrm{s}$.
- Since $10^{1} \mathrm{rad} / \mathrm{s}$ is a pole, change the present slope by $-20 \mathrm{db} / \mathrm{dec}$, that is, change it from $+20 \mathrm{~dB} / \mathrm{dec}$ to $+20-20=0 \mathrm{~dB} / \mathrm{dec}$. This yields a horizontal segment till the next root at $10^{2} \mathrm{rad} / \mathrm{s}$.
- Since $10^{2} \mathrm{rad} / \mathrm{s}$ is a pole, change the slope from 0 to $-20 \mathrm{~dB} / \mathrm{dec}$, and continue till the next root at $10^{3} \mathrm{rad} / \mathrm{s}$.
- Since $10^{3} \mathrm{rad} / \mathrm{s}$ is a zero, change the slope from $-20 \mathrm{~dB} / \mathrm{dec}$ back to $-20+$ $20=0 \mathrm{~dB} / \mathrm{dec}$, and continue till the next root at $10^{4} \mathrm{rad} / \mathrm{s}$.
- Since $10^{4} \mathrm{rad} / \mathrm{s}$ is a pole, change the slope to $-20 \mathrm{~dB} / \mathrm{dec}$, and draw the final asymptote accordingly. The final plot is shown in Fig. 6A.3.
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-070.jpg?height=294&width=663&top_left_y=210&top_left_x=453)

FIGURE 6A. 3 Linearized Bode plot for the gain of Eq. (6A.9)

### Impedance Plots

Just like gain, impedances are plotted using logarithmic scales. However, impedances are expressed in Ohms (not in dBs!), so while the horizontal axis is still marked in frequency decades (or octaves), the vertical axis is now marked in resistance decades (or octaves). To give an idea, consider Fig. 6A.4a, showing the magnitude plots of the impedances

$$
Z_{R}=R=10^{3} \Omega \quad Z_{C}=\frac{1}{j \omega C}=\frac{1}{j \omega 10^{-6}}=-j \frac{10^{6}}{\omega}
$$

The plot of $\left|Z_{R}\right|(=R)$ is just a horizontal line positioned at $10^{3} \Omega$, whereas that of $\left|Z_{C}\right|\left(=10^{6} / \omega\right)$ is a slanted line with a slope of $-(1$ resistance-decade $) /$ (frequencydecade), or simply $-1 \mathrm{dec} / \mathrm{dec}$. Moreover, the two curves intersect each other at $\omega_{0}=1 \mathrm{krad} / \mathrm{s}$.

Knowing the individual plots of $\left|Z_{R}\right|$ and $\left|Z_{C}\right|$, we find it instructive to construct the magnitude plots of their series and parallel combinations $Z_{s}$ and $Z_{p}$ using mere
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-070.jpg?height=771&width=1408&top_left_y=1272&top_left_x=235)

FIGURE 6A. 4 Magnitude plots of (a) the individual impedances $Z_{R}$ and $Z_{C}$, (b) their series combination $Z_{s}=Z_{R}+Z_{C}$, and (c) their parallel combination $Z_{p}=Z_{R} / / Z_{C}$.
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-071.jpg?height=187&width=581&top_left_y=207&top_left_x=207)

FIGURE 6A. 5 An impedance network.
inspection. To this end, recall that in a series combination the larger of the two impedances dominates, whereas in a parallel combination the smaller of the two dominates. We make the following observations:

- At low frequencies, where $\left|Z_{C}\right| \gg\left|Z_{R}\right|$, we have $Z_{s} \cong Z_{C}$ and $Z_{p} \cong Z_{R}$.
- At high frequencies, where $\left|Z_{C}\right| \ll\left|Z_{R}\right|$, the opposite holds, namely, $Z_{s} \cong Z_{R}$ and $Z_{p} \cong Z_{C}$.
- The individual impedances exhibit equal magnitudes ( $=1 \mathrm{k} \Omega$ in the example) at a special frequency that we shall call $\omega_{0}(=1 \mathrm{krad} / \mathrm{s}$ in the example $)$, so this frequency marks the breakpoint between the low-frequency and the high-frequency asymptotes. Imposing $\left|Z_{C}\left(j \omega_{0}\right)\right|=\left|Z_{R}\right|$, or $1 /\left(\omega_{0} C\right)=R$, we readily find $\omega_{0}=$ $1 /(R C)=1 /\left(10^{3} \times 10^{-6}\right)=1 \mathrm{krad} / \mathrm{s}$. At this frequency we have $\left|Z_{s}\left(j \omega_{0}\right)\right|=R \sqrt{ } 2$ ( $=1.414 \mathrm{k} \Omega$ in our example), and $\left|Z_{p}\left(j \omega_{0}\right)\right|=R / \sqrt{2}(=0.707 \mathrm{k} \Omega$ in the example).

As an additional example, let us apply the above intuitive reasoning to plot the magnitude of the equivalent impedance $Z$ presented by the network of Fig. 6A.5. First, plot the individual impedances as in Fig. 6A.6a. Then, starting at the lowfrequency end and gradually moving toward higher frequencies, construct the plot of $|Z|$ as in Fig 6A.6b, based on the following observations.

- At sufficiently low frequencies, where $Z_{2}$ and $Z_{4}$ act as open circuits, $Z_{1}$ dominates.
- Next, $Z_{2}$ kicks in $\omega=10^{1} \mathrm{rad} / \mathrm{s}$ because $\left|Z_{2}\right|=\left|Z_{1}\right|$ there.
- $Z_{2}$ dominates till $\omega=10^{3} \mathrm{rad} / \mathrm{s}$, where $Z_{3}$ kicks in and dominates till $\omega=$ $10^{5} \mathrm{rad} / \mathrm{s}$.
- At this final point $Z_{4}$ kicks in to dominate for the rest of the frequency spectrum.
![](https://cdn.mathpix.com/cropped/2024_11_07_f5d45e005f7810c66228g-071.jpg?height=492&width=1288&top_left_y=1553&top_left_x=194)

FIGURE 6A. 6 Magnitude plots of (a) the individual impedances of Fig. 6A.5, and (b) the overall equivalent impedance $Z$.
