# Differential Amplifiers

The elegant concept of "differential" signals and amplifiers was invented in the 1940s and first utilized in vacuum-tube circuits. Since then, differential circuits have found increasingly wider usage in microelectronics and serve as a robust, high-performance design paradigm in many of today's systems. This chapter describes bipolar and MOS differential amplifiers and formulates their large-signal and small-signal properties. The concepts are outlined below.

General Considerations

- Differential Signals
- Differential Pair

Bipolar Differential Pair

- Qualitative Analysis
- Large-Signal Analysis
- Small-Signal Analysis

MOS Differential Pair

- Qualitative Analysis
- Large-Signal Analysis
- Small-Signal Analysis

Other Concepts

- Cascode Pair
- Common-Mode Rejection
- Pair with Active Load

## 10.1 GENERAL CONSIDERATIONS

### 10.1.1 Initial Thoughts

We have already seen that op amps have two inputs, a point of contrast to the amplifiers studied in previous chapters. In order to further understand the need for differential circuits, let us first consider an example.

Example Having learned the design of rectifiers and basic amplifier stages, an electrical engineering student constructs the circuit shown in Fig. 10.1(a) to amplify the signal produced by a microphone. Unfortunately, upon applying the result to a speaker, the student observes that the amplifier output contains a strong "humming" noise, i.e., a steady low-frequency component. Explain what happens.

Recall from Chapter 3 that the current drawn from the rectified output creates a ripple waveform at twice the ac line frequency ( 50 or 60 Hz ) [Fig. 10.1(b)]. Examining the output of the common-emitter stage, we can identify two components: (1) the amplified version of the microphone signal and (2) the ripple waveform present on $V_{C C}$. For the latter, we can write

$$
\begin{equation*}
V_{\text {out }}=V_{C C}-R_{C} I_{C} \tag{10.1}
\end{equation*}
$$

noting that $V_{\text {out }}$ simply "tracks" $V_{C C}$ and hence contains the ripple in its entirety. The "hum" originates from the ripple. Figure 10.1(c) depicts the overall output in the presence of both the signal and the ripple. Illustrated in Fig. 10.1(d), this phenomenon is summarized as the "supply noise goes to the output with a gain of unity." (A MOS implementation would suffer from the same problem.)
![](https://cdn.mathpix.com/cropped/2024_11_08_ec107b452e55233dbf32g-49.jpg?height=1257&width=2809&top_left_y=1792&top_left_x=896)

Figure 10.1 (a) CE stage powered by a rectifier, (b) ripple on supply voltage, (c) effect at output, (d) ripple and signal paths to output.

Exercise What is the hum frequency for a full-wave rectifier or a half-wave rectifier?

How should we suppress the hum in the above example? We can increase $C_{1}$, thus lowering the ripple amplitude, but the required capacitor value may become prohibitively large if many circuits draw current from the rectifier. Alternatively, we can modify the amplifier topology such that the output is insensitive to $V_{C C}$. How is that possible? Equation (10.1) implies that a change in $V_{C C}$ directly appears in $V_{\text {out }}$, fundamentally because both $V_{\text {out }}$ and $V_{C C}$ are measured with respect to ground and differ by $R_{C} I_{C}$. But what if $V_{\text {out }}$ is not "referenced" to ground?! More specifically, what if $V_{\text {out }}$ is measured with respect to another point that itself experiences the supply ripple to the same extent? It is thus possible to eliminate the ripple from the "net" output.

While rather abstract, the above conjecture can be readily implemented. Figure 10.2(a) illustrates the core concept. The CE stage is duplicated on the right, and the output is now measured between nodes $X$ and $Y$ rather than from $X$ to ground. What happens if $V_{C C}$
![](https://cdn.mathpix.com/cropped/2024_11_08_ec107b452e55233dbf32g-50.jpg?height=806&width=1183&top_left_y=921&top_left_x=1144)
(a)
![](https://cdn.mathpix.com/cropped/2024_11_08_ec107b452e55233dbf32g-50.jpg?height=777&width=1069&top_left_y=953&top_left_x=2525)
(b)

Figure 10.2 Use of two CE stages to remove effect of ripple.
contains ripple? Both $V_{X}$ and $V_{Y}$ rise and fall by the same amount and hence the difference between $V_{X}$ and $V_{Y}$ remains free from the ripple.

In fact, denoting the ripple by $v_{r}$, we express the small-signal voltages at these nodes as

$$
\begin{align*}
& v_{X}=A_{v} v_{i n}+v_{r}  \tag{10.2}\\
& v_{Y}=v_{r} \tag{10.3}
\end{align*}
$$

That is,

$$
\begin{equation*}
v_{X}-v_{Y}=A_{v} v_{i n} \tag{10.4}
\end{equation*}
$$

Note that $Q_{2}$ carries no signal, simply serving as a constant current source.
The above development serves as the foundation for differential amplifiers: the symmetric CE stages provide two output nodes whose voltage difference remains free from the supply ripple.

### 10.1.2 Differential Signals

Let us return to the circuit of Fig. 10.2(a) and recall that the duplicate stage consisting of $Q_{2}$ and $R_{C 2}$ remains "idle," thereby "wasting" current. We may therefore wonder if this stage can provide signal amplification in addition to establishing a reference point for $V_{\text {out }}$. In our first attempt, we directly apply the input signal to the base of $Q_{2}$ [Fig. 10.3(a)]. Unfortunately, the signal components at $X$ and $Y$ are in phase, canceling each other as they appear in $v_{X}-v_{Y}$ :

$$
\begin{align*}
v_{X} & =A_{v} v_{i n}+v_{r}  \tag{10.5}\\
v_{Y} & =A_{v} v_{i n}+v_{r}  \tag{10.6}\\
& \Rightarrow v_{X}-v_{Y}=0 . \tag{10.7}
\end{align*}
$$

For the signal components to enhance each other at the output, we can invert one of the input phases as shown in Fig. 10.3(b), obtaining

$$
\begin{align*}
& v_{X}=A_{v} v_{i n}+v_{r}  \tag{10.8}\\
& v_{Y}=-A_{v} v_{i n}+v_{r} \tag{10.9}
\end{align*}
$$

and hence

$$
\begin{equation*}
v_{X}-v_{Y}=2 A_{v} v_{i n} \tag{10.10}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_11_08_ec107b452e55233dbf32g-51.jpg?height=1377&width=2636&top_left_y=533&top_left_x=982)

Figure 10.3 (a) Application of one input signal to two CE stages, (b) use of differential input signals, (c) generation of differential phases from one signal.

Compared to the circuit of Fig. 10.2(a), this topology provides twice the output swing by exploiting the amplification capability of the duplicate stage.

The reader may wonder how $-v_{\text {in }}$ can be generated. Illustrated in Fig. 10.3(c), a simple approach is to utilize a transformer to convert the microphone signal to two components bearing a phase difference of $180^{\circ}$.

Our thought process has led us to the specific waveforms in Fig. 10.3(b): the circuit senses two inputs that vary by equal and opposite amounts and generates two outputs that behave in a similar fashion. These waveforms are examples of "differential" signals and stand in contrast to "single-ended" signals-the type to which we are accustomed from basic circuits and previous chapters of this book. More specifically, a single-ended signal is one measured with respect to the common ground [Fig. 10.4(a)] and "carried by one line," whereas a differential signal is measured between two nodes that have equal and opposite swings [Fig. 10.4(b)] and is thus "carried by two lines."

Figure 10.4(c) summarizes the foregoing development. Here, $V_{1}$ and $V_{2}$ vary by equal and opposite amounts and have the same average (dc) level, $V_{C M}$, with respect to ground:

$$
\begin{align*}
& V_{1}=V_{0} \sin \omega t+V_{C M}  \tag{10.11}\\
& V_{2}=-V_{0} \sin \omega t+V_{C M} \tag{10.12}
\end{align*}
$$

Since each of $V_{1}$ and $V_{2}$ has a peak-to-peak swing of $2 V_{0}$, we say the "differential swing" is $4 V_{0}$. We may also say $V_{1}$ and $V_{2}$ are differential signals to emphasize that they vary by equal and opposite amounts around a fixed level, $V_{C M}$.

The dc voltage that is common to both $V_{1}$ and $V_{2}$ [ $V_{C M}$ in Fig. 10.4(c)] is called the "common-mode (CM) level." That is, in the absence of differential signals, the two nodes remain at a potential equal to $V_{C M}$ with respect to the global ground. For example, in the transformer of Fig. 10.3(c),$+v_{\text {in }}$ and $-v_{\text {in }}$ display a CM level of zero because the center tap of the transformer is grounded.
![](https://cdn.mathpix.com/cropped/2024_11_08_ec107b452e55233dbf32g-52.jpg?height=595&width=1371&top_left_y=587&top_left_x=1700)
(a)
![](https://cdn.mathpix.com/cropped/2024_11_08_ec107b452e55233dbf32g-52.jpg?height=964&width=2028&top_left_y=1276&top_left_x=676)
(b)
![](https://cdn.mathpix.com/cropped/2024_11_08_ec107b452e55233dbf32g-52.jpg?height=572&width=903&top_left_y=1649&top_left_x=2785)
(c)

Figure 10.4 (a) Single-ended signals, (b) differential signals, (c) illustration of commonmode level.

Solution The center tap can simply be tied to a voltage equal to +2 V (Fig. 10.5).
![](https://cdn.mathpix.com/cropped/2024_11_08_ec107b452e55233dbf32g-52.jpg?height=558&width=1790&top_left_y=3079&top_left_x=1490)

Figure 10.5

Exercise Does the CM level change if the inputs of the amplifier draw a bias current?

| Example <br> 10.3 | Determine the common-mode level at the output of the circuit shown in Fig. 10.3(b). |
| :---: | :---: |
| Solution | In the absence of signals, $V_{X}=V_{Y}=V_{C C}-R_{C} I_{C}$ (with respect to ground), where $R_{C}=R_{C 1}=R_{C 2}$ and $I_{C}$ denotes the bias current of $Q_{1}$ and $Q_{2}$. Thus, $V_{C M}=V_{C C}-R_{C} I_{C}$. Interestingly, the ripple affects $V_{C M}$ but not the differential output. |
| Exercise | If a resistor of value $R_{1}$ is inserted between $V_{C C}$ and the top terminals of $R_{C 1}$ and $R_{C 2}$, what is the output CM level? |

Our observations regarding supply ripple and the use of the "duplicate stage" provide sufficient justification for studying differential signals. But, how about the common-mode level? What is the significance of $V_{C M}=V_{C C}-R_{C} I_{C}$ in the above example? Why is it interesting that the ripple appears in $V_{C M}$ but not in the differential output? We will answer these important questions in the following sections.

### 10.1.3 Differential Pair

Before formally introducing the differential pair, we must recognize that the circuit of Fig. 10.4(b) senses two inputs and can therefore serve as $A_{1}$ in Fig. 10.2(b). This observation leads to the differential pair.

While sensing and producing differential signals, the circuit of Fig. 10.4(b) suffers from some drawbacks. Fortunately, a simple modification yields an elegant, versatile topology. Illustrated in Fig. 10.6(a), the (bipolar) "differential pair" ${ }^{1}$ is similar to the circuit of Fig. 10.4(b), except that the emitters of $Q_{1}$ and $Q_{2}$ are tied to a constant current source rather than to ground. We call $I_{E E}$ the "tail current source." The MOS counterpart is shown in Fig. 10.6(b). In both cases, the sum of the transistor currents is equal to the tail current. Our objective is to analyze the large-signal and small-signal behavior of these circuits and demonstrate their advantages over the "single-ended" stages studied in previous chapters.
![](https://cdn.mathpix.com/cropped/2024_11_08_ec107b452e55233dbf32g-53.jpg?height=949&width=1982&top_left_y=2094&top_left_x=1235)

Figure 10.6 (a) Bipolar and (b) MOS differential pairs.
For each differential pair, we begin with a qualitative, intuitive analysis and subsequently formulate the large-signal and small-signal behavior. We also assume each circuit is perfectly symmetric, i.e., the transistors are identical and so are the resistors.

## 10.2 BIPOLAR DIFFERENTIAL PAIR

### 10.2.1 Qualitative Analysis

It is instructive to first examine the bias conditions of the circuit. Recall from Section 10.1.2 that in the absence of signals, differential nodes reside at the common-mode level. We therefore draw the pair as shown in Fig. 10.7, with the two inputs tied to $V_{C M}$ to indicate no signal exists at the input. By virtue of symmetry,

$$
\begin{align*}
V_{B E 1} & =V_{B E 2}  \tag{10.13}\\
I_{C 1} & =I_{C 2}=\frac{I_{E E}}{2}, \tag{10.14}
\end{align*}
$$

[^8]![](https://cdn.mathpix.com/cropped/2024_11_08_ec107b452e55233dbf32g-54.jpg?height=789&width=1269&top_left_y=262&top_left_x=1740)

Figure 10.7 Response of differential pair to input CM change.
where the collector and emitter currents are assumed equal. We say the circuit is in "equilibrium."

Thus, the voltage drop across each load resistor is equal to $R_{C} I_{E E} / 2$ and hence

$$
\begin{equation*}
V_{X}=V_{Y}=V_{C C}-R_{C} \frac{I_{E E}}{2} . \tag{10.15}
\end{equation*}
$$

In other words, if the two input voltages are equal, so are the two outputs. We say a zero differential input produces a zero differential output. The circuit also "rejects" the effect of supply ripple: if $V_{C C}$ experiences a change, the differential output, $V_{X}-V_{Y}$, does not.

Are $Q_{1}$ and $Q_{2}$ in the active region? To avoid saturation, the collector voltages must not fall below the base voltages:

$$
\begin{equation*}
V_{C C}-R_{C} \frac{I_{E E}}{2} \geq V_{C M}, \tag{10.16}
\end{equation*}
$$

revealing that $V_{C M}$ cannot be arbitrarily high.

Did you know?

The amplifiers studied in previous chapters have one input with respect to ground [Fig. (a)] whereas the differential pair has two distinct inputs. An important application of the differential pair is at the input of op amps, where inverting and noninverting input terminals are necessary [Fig. (b)]. Without this second input, many op-amp-based functions would be difficult to realize. For example, the noninverting amplifier and the precision rectifier utilize both inputs.
![](https://cdn.mathpix.com/cropped/2024_11_08_ec107b452e55233dbf32g-54.jpg?height=731&width=1434&top_left_y=2380&top_left_x=2502)
(a)

Amplifiers with single-ended and differential inputs.

| $\begin{array}{\|l\|l\|}  & \text { Example } \\ 10.4 \end{array}$ | A bipolar differential pair employs a load resistance of $1 \mathrm{k} \Omega$ and a tail current of 1 mA . How close to $V_{C C}$ can $V_{C M}$ be chosen? |  |
| :---: | :---: | :---: |
| Solution | Equation 10.16 gives $\begin{aligned} V_{C C}-V_{C M} & \geq R_{C} \frac{I_{E E}}{2} \\ & \geq 0.5 \mathrm{~V} . \end{aligned}$ | $\begin{aligned} & (10.17) \\ & (10.18) \end{aligned}$ |
|  | That is, $V_{C M}$ must remain below $V_{C C}$ by at least 0.5 V . |  |

[^9]![](https://cdn.mathpix.com/cropped/2024_11_08_ec107b452e55233dbf32g-55.jpg?height=618&width=2027&top_left_y=673&top_left_x=1270)

Figure 10.8 Effect of $V_{C M 1}$ and $V_{C M 2}$ at output.

Now, let us vary $V_{C M}$ in Fig. 10.7 by a small amount and determine the circuit's response. Interestingly, Eqs. (10.13)-(10.15) remain unchanged, thereby suggesting that neither the collector current nor the collector voltage of the transistors is affected. We say the circuit does not respond to changes in the input common-mode level, or the circuit "rejects" input CM variations. Figure 10.8 summarizes these results.

The "common-mode rejection" capability of the differential pair distinctly sets it apart from our original circuit in Fig. 10.4(b). In the latter, if the base voltage of $Q_{1}$ and $Q_{2}$ changes, so do their collector currents and voltages (why?). The reader may recognize that it is the tail current source in the differential pair that guarantees constant collector currents and hence rejection of the input CM level.

With our treatment of the common-mode response, we now turn to the more interesting case of differential response. We hold one input constant, vary the other, and examine the currents flowing in the two transistors. While not exactly differential, such input signals provide a simple, intuitive starting point. Recall that $I_{C 1}+I_{C 2}=I_{E E}$.

Consider the circuit shown in Fig. 10.9(a), where the two transistors are drawn with a vertical offset to emphasize that $Q_{1}$ senses a more positive base voltage. Since the difference between the base voltages of $Q_{1}$ and $Q_{2}$ is so large, we postulate that $Q_{1}$ "hogs" all of the tail current, thereby turning $Q_{2}$ off. That is,

$$
\begin{align*}
I_{C 1} & =I_{E E}  \tag{10.19}\\
I_{C 2} & =0, \tag{10.20}
\end{align*}
$$

![](https://cdn.mathpix.com/cropped/2024_11_08_ec107b452e55233dbf32g-55.jpg?height=1062&width=2764&top_left_y=3904&top_left_x=924)

Figure 10.9 Response of bipolar differential pair to (a) large positive input difference and (b) large negative input difference.
and hence

$$
\begin{align*}
& V_{X}=V_{C C}-R_{C} I_{E E}  \tag{10.21}\\
& V_{Y}=V_{C C} \tag{10.22}
\end{align*}
$$

But, how can we prove that $Q_{1}$ indeed absorbs all of $I_{E E}$ ? Let us assume that it is not so; i.e., $I_{C 1}<I_{E E}$ and $I_{C 2} \neq 0$. If $Q_{2}$ carries an appreciable current, then its base-emitter voltage must reach a typical value of, say, 0.8 V . With its base held at +1 V , the device therefore requires an emitter voltage of $V_{P} \approx 0.2 \mathrm{~V}$. However, this means that $Q_{1}$ sustains a baseemitter voltage of $V_{i n 1}-V_{P}=+2 \mathrm{~V}-0.2 \mathrm{~V}=1.8 \mathrm{~V}$ !! Since with $V_{B E}=1.8 \mathrm{~V}$, a typical transistor carries an enormous current, and since $I_{C 1}$ cannot exceed $I_{E E}$, we conclude that the conditions $V_{B E 1}=1.8 \mathrm{~V}$ and $V_{P} \approx 0.2 \mathrm{~V}$ cannot occur. In fact, with a typical baseemitter voltage of $0.8 \mathrm{~V}, Q_{1}$ holds node $P$ at approximately +1.2 V , ensuring that $Q_{2}$ remains off.

Symmetry of the circuit implies that swapping the base voltages of $Q_{1}$ and $Q_{2}$ reverses the situation [Fig. 10.9(b)], giving

$$
\begin{align*}
I_{C 2} & =I_{E E}  \tag{10.23}\\
I_{C 1} & =0 \tag{10.24}
\end{align*}
$$

and hence

$$
\begin{align*}
V_{Y} & =V_{C C}-R_{C} I_{E E}  \tag{10.25}\\
V_{X} & =V_{C C} \tag{10.26}
\end{align*}
$$

The above experiments reveal that, as the difference between the two inputs departs from zero, the differential pair "steers" the tail current from one transistor to the other. In fact, based on Eqs. (10.14), (10.19), and (10.23), we can sketch the collector currents of $Q_{1}$ and $Q_{2}$ as a function of the input difference [Fig. 10.10(a)]. We have not yet formulated these characteristics but we do observe that the collector current of each transistor goes from 0 to $I_{E E}$ if $\left|V_{i n 1}-V_{i n 2}\right|$ becomes sufficiently large.

It is also important to note that $V_{X}$ and $V_{Y}$ vary differentially in response to $V_{i n 1}-V_{\text {in } 2}$. From Eqs. (10.15), (10.21), and (10.25), we can sketch the input/output characteristics of the circuit as shown in Fig. 10.10(b). That is, a nonzero differential input yields a nonzero differential output-a behavior in sharp contrast to the CM response. Since $V_{X}$ and $V_{Y}$
![](https://cdn.mathpix.com/cropped/2024_11_08_ec107b452e55233dbf32g-56.jpg?height=1068&width=2941&top_left_y=3987&top_left_x=904)

Figure 10.10 Variation of (a) collector currents and (b) output voltages as a function of input.
are differential, we can define a common-mode level for them. Given by $V_{C C}-R_{C} I_{E E} / 2$, this quantity is called the "output CM level."

| Example | A bipolar differential pair employs a tail current of 0.5 mA and a collector resistance <br> of $1 \mathrm{k} \Omega$. What is the maximum allowable base voltage if the differential input is large <br> enough to completely steer the tail current? Assume $V_{C C}=2.5 \mathrm{~V}$. |
| :---: | :--- |
| Solution | If $I_{E E}$ is completely steered, the transistor carrying the current lowers its collector voltage <br> to $V_{C C}-R_{C} I_{E E}=2 \mathrm{~V}$. Thus, the base voltage must remain below this value so as to avoid <br> saturation. |

Exercise Repeat the above example if the tail current is raised to 1 mA .

In the last step of our qualitative analysis, we "zoom in" around $V_{i n 1}-V_{i n 2}=0$ (the equilibrium condition) and study the circuit's behavior for a small input difference. As illustrated in Fig. 10.11(a), the base voltage of $Q_{1}$ is raised from $V_{C M}$ by $\Delta V$ while that of $Q_{2}$ is lowered from $V_{C M}$ by the same amount. We surmise that $I_{C 1}$ increases slightly and, since $I_{C 1}+I_{C 2}=I_{E E}, I_{C 2}$ decreases by the same amount:

$$
\begin{align*}
& I_{C 1}=\frac{I_{E E}}{2}+\Delta I  \tag{10.27}\\
& I_{C 2}=\frac{I_{E E}}{2}-\Delta I \tag{10.28}
\end{align*}
$$

How is $\Delta I$ related to $\Delta V$ ? If the emitters of $Q_{1}$ and $Q_{2}$ were directly tied to ground, then $\Delta I$ would simply be equal to $g_{m} \Delta V$. In the differential pair, however, node $P$ is free to rise or fall. We must therefore compute the change in $V_{P}$.

Suppose, as shown in Fig. 10.11(b), $V_{P}$ rises by $\Delta V_{P}$. As a result, the net increase in $V_{B E 1}$ is equal to $\Delta V-\Delta V_{P}$ and hence

$$
\begin{equation*}
\Delta I_{C 1}=g_{m}\left(\Delta V-\Delta V_{P}\right) \tag{10.29}
\end{equation*}
$$

Similarly, the net decrease in $V_{B E 2}$ is equal to $\Delta V+\Delta V_{P}$, yielding

$$
\begin{equation*}
\Delta I_{C 2}=-g_{m}\left(\Delta V+\Delta V_{P}\right) \tag{10.30}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_11_08_ec107b452e55233dbf32g-57.jpg?height=943&width=3112&top_left_y=4066&top_left_x=642)

Figure 10.11 (a) Differential pair sensing small, differential input changes, (b) hypothetical change at $P$.

But recall from Eqs. (10.27) and (10.28) that $\Delta I_{C 1}$ must be equal to $-\Delta I_{C 2}$, dictating that

$$
\begin{equation*}
g_{m}\left(\Delta V-\Delta V_{P}\right)=g_{m}\left(\Delta V+\Delta V_{P}\right) \tag{10.31}
\end{equation*}
$$

and hence

$$
\begin{equation*}
\Delta V_{P}=0 . \tag{10.32}
\end{equation*}
$$

Interestingly, the tail voltage remains constant if the two inputs vary differentially and by a small amount-an observation critical to the small-signal analysis of the circuit.

The reader may wonder why Eq. (10.32) does not hold if $\Delta V$ is large. Which one of the above equations is violated? For a large differential input, $Q_{1}$ and $Q_{2}$ carry significantly different currents, thus exhibiting unequal transconductances and prohibiting the omission of $g_{m}$ 's from the two sides of Eq. (10.31).

With $\Delta V_{P}=0$ in Fig. 10.11(a), we can rewrite Eqs. (10.29) and (10.30) respectively as

$$
\begin{align*}
& \Delta I_{C 1}=g_{m} \Delta V  \tag{10.33}\\
& \Delta I_{C 2}=-g_{m} \Delta V \tag{10.34}
\end{align*}
$$

and

$$
\begin{align*}
\Delta V_{X} & =-g_{m} \Delta V R_{C}  \tag{10.35}\\
\Delta V_{Y} & =g_{m} \Delta V R_{C} . \tag{10.36}
\end{align*}
$$

The differential output therefore goes from 0 to

$$
\begin{equation*}
\Delta V_{X}-\Delta V_{Y}=-2 g_{m} \Delta V R_{C} \tag{10.37}
\end{equation*}
$$

We define the small-signal differential gain of the circuit as

$$
\begin{align*}
A_{v} & =\frac{\text { Change in Differential Output }}{\text { Change in Differential Input }}  \tag{10.38}\\
& =\frac{-2 g_{m} \Delta V R_{C}}{2 \Delta V}  \tag{10.39}\\
& =-g_{m} R_{C} \tag{10.40}
\end{align*}
$$

(Note that the change in the differential input is equal to $2 \Delta V$.) This expression is similar to that of the common-emitter stage.

Example Design a bipolar differential pair for a gain of 10 and a power budget of 1 mW with a
10.6 supply voltage of 2 V .

Solution With $V_{C C}=2 \mathrm{~V}$, the power budget translates to a tail current of 0.5 mA . Each transistor thus carries a current of 0.25 mA near equilibrium, providing a transconductance of $0.25 \mathrm{~mA} / 26 \mathrm{mV}=(104 \Omega)^{-1}$. It follows that

$$
\begin{align*}
R_{C} & =\frac{\left|A_{v}\right|}{g_{m}}  \tag{10.41}\\
& =1040 \Omega . \tag{10.42}
\end{align*}
$$

Exercise Redesign the circuit for a power budget of 0.5 mW and compare the results.

Example Compare the power dissipation of a bipolar differential pair with that of a CE stage <br> 10.7 if both circuits are designed for equal voltage gains, collector resistances, and supply voltages.

Solution The gain of the differential pair is written from Eq. (10.40) as

$$
\begin{equation*}
\left|A_{V, \mathrm{diff}}\right|=g_{m 1,2} R_{C} \tag{10.43}
\end{equation*}
$$

where $g_{m 1,2}$ denotes the transconductance of each of the two transistors. For a CE stage

$$
\begin{equation*}
\left|A_{V, C E}\right|=g_{m} R_{C} \tag{10.44}
\end{equation*}
$$

Thus,

$$
\begin{equation*}
g_{m 1,2} R_{C}=g_{m} R_{C} \tag{10.45}
\end{equation*}
$$

and hence

$$
\begin{equation*}
\frac{I_{E E}}{2 V_{T}}=\frac{I_{C}}{V_{T}} \tag{10.46}
\end{equation*}
$$

where $I_{E E} / 2$ is the bias current of each transistor in the differential pair, and $I_{C}$ represents the bias current of the CE stage. In other words,

$$
\begin{equation*}
I_{E E}=2 I_{C} \tag{10.47}
\end{equation*}
$$

indicating that the differential pair consumes twice as much power. This is one of the drawbacks of differential circuits.

Exercise
If both circuits are designed for the same power budget, equal collector resistances, and equal supply voltages, compare their voltage gains.

### 10.2.2 Large-Signal Analysis

Having obtained insight into the operation of the bipolar differential pair, we now quantify its large-signal behavior, aiming to formulate the input/output characteristic of the circuit (the sketches in Fig. 10.10). Not having seen any large-signal analysis in the previous chapters, the reader may naturally wonder why we are suddenly interested in this aspect of the differential pair. Our interest arises from (a) the need to understand the circuit's limitations in serving as a linear amplifier, and (b) the application of the differential pair as a (nonlinear) current-steering circuit.

In order to derive the relationship between the differential input and output of the circuit, we first note from Fig. 10.12 that

$$
\begin{align*}
& V_{\text {out } 1}=V_{C C}-R_{C} I_{C 1}  \tag{10.48}\\
& V_{\text {out } 2}=V_{C C}-R_{C} I_{C 2} \tag{10.49}
\end{align*}
$$

and hence

$$
\begin{align*}
V_{\text {out }} & =V_{\text {out } 1}-V_{\text {out } 2}  \tag{10.50}\\
& =-R_{C}\left(I_{C 1}-I_{C 2}\right) \tag{10.51}
\end{align*}
$$

We must therefore compute $I_{C 1}$ and $I_{C 2}$ in terms of the input difference. Assuming $\alpha=1$ and $V_{A}=\infty$, and recalling from Chapter 4 that $V_{B E}=V_{T} \ln \left(I_{C} / I_{S}\right)$, we write a KVL around
![](https://cdn.mathpix.com/cropped/2024_11_08_ec107b452e55233dbf32g-60.jpg?height=789&width=920&top_left_y=593&top_left_x=1915)

Figure 10.12 Bipolar differential pair for large-signal analysis.
the input network,

$$
\begin{equation*}
V_{i n 1}-V_{B E 1}=V_{P}=V_{i n 2}-V_{B E 2} \tag{10.52}
\end{equation*}
$$

obtaining

$$
\begin{align*}
V_{i n 1}-V_{i n 2} & =V_{B E 1}-V_{B E 2}  \tag{10.53}\\
& =V_{T} \ln \frac{I_{C 1}}{I_{S 1}}-V_{T} \ln \frac{I_{C 2}}{I_{S 2}}  \tag{10.54}\\
& =V_{T} \ln \frac{I_{C 1}}{I_{C 2}} \tag{10.55}
\end{align*}
$$

Also, a KCL at node $P$ gives

$$
\begin{equation*}
I_{C 1}+I_{C 2}=I_{E E} \tag{10.56}
\end{equation*}
$$

Equations (10.55) and (10.56) contain two unknowns. Substituting for $I_{C 1}$ from Eq. (10.55) in Eq. (10.56) yields

$$
\begin{equation*}
I_{C 2} \exp \frac{V_{i n 1}-V_{i n 2}}{V_{T}}+I_{C 2}=I_{E E} \tag{10.57}
\end{equation*}
$$

and, therefore,

$$
\begin{equation*}
I_{C 2}=\frac{I_{E E}}{1+\exp \frac{V_{i n 1}-V_{i n 2}}{V_{T}}} \tag{10.58}
\end{equation*}
$$

The symmetry of the circuit with respect to $V_{i n 1}$ and $V_{i n 2}$ and with respect to $I_{C 1}$ and $I_{C 2}$ suggests that $I_{C 1}$ exhibits the same behavior as Eq. (10.58) but with the roles of $V_{i n 1}$ and $V_{i n 2}$ exchanged:

$$
\begin{align*}
I_{C 1} & =\frac{I_{E E}}{1+\exp \frac{V_{i n 2}-V_{i n 1}}{V_{T}}}  \tag{10.59}\\
& =\frac{I_{E E} \exp \frac{V_{i n 1}-V_{i n 2}}{V_{T}}}{1+\exp \frac{V_{i n 1}-V_{i n 2}}{V_{T}}} \tag{10.60}
\end{align*}
$$

Alternatively, the reader can substitute for $I_{C 2}$ from Eq. (10.58) in Eq. (10.56) to obtain $I_{C 1}$.

[^0]:    ${ }^{6}$ The reader can show that placing $V_{o s}$ in series with the inverting input of the op amp yields the same result.

[^1]:    ${ }^{7}$ Recall that in a linear system, if $x(t) \rightarrow y(t)$, then $2 x(t) \rightarrow 2 y(t)$.

[^2]:    ${ }^{8} \mathrm{Op}$ amps employing MOS transistors at their input exhibit a very high input impedance at low frequencies.

[^3]:    ${ }^{1}$ Coined in the vacuum-tube era, the term "cascode" is believed to be an abbreviation of "cascaded triodes."

[^4]:    ${ }^{3}$ In integrated circuits, all bipolar transistors fabricated on the same wafer exhibit the same Early voltage. This example applies to discrete implementations.

[^5]:    ${ }^{4}$ In reality, other second-order effects limit the output impedance of MOS cascodes.

[^6]:    ${ }^{5}$ While omitted for simplicity in Chapters 4 and 6, the condition $v_{\text {out }}=0$ is also required for the transconductance of transistors. That is, the collector or drain must by shorted to ac ground.

[^7]:    ${ }^{6}$ In deep-submicron CMOS technologies, the gate oxide thickness is reduced to less than $30 \AA$, leading to "tunneling" and hence noticeable gate current. This effect is beyond the scope of this book.

[^8]:    ${ }^{1}$ Also called the "emitter-coupled pair" or the "long-tailed pair."

[^9]:    Exercise What value of $R_{C}$ allows the input CM level to approach $V_{C C}$ if the transistors can tolerate a base-collector forward bias of 400 mV ?

Equations (10.58) and (10.60) play a crucial role in our quantitative understanding of the differential pair's operation. In particular, if $V_{i n 1}-V_{i n 2}$ is very negative, then $\exp \left(V_{i n 1}-V_{i n 2}\right) / V_{T} \rightarrow 0$ and

$$
\begin{align*}
I_{C 1} & \rightarrow 0  \tag{10.61}\\
I_{C 2} & \rightarrow I_{E E} \tag{10.62}
\end{align*}
$$

as predicted by our qualitative analysis [Fig.10.9(b)]. Similarly, if $V_{i n 1}-V_{i n 2}$ is very positive, $\exp \left(V_{i n 1}-V_{i n 2}\right) / V_{T} \rightarrow \infty$ and

$$
\begin{align*}
I_{C 1} \rightarrow I_{E E}  \tag{10.63}\\
I_{C 2} \rightarrow 0 \tag{10.64}
\end{align*}
$$

What is meant by "very" negative or positive? For example, can we say $I_{C 1} \approx 0$ and $I_{C 2} \approx I_{E E}$ if $V_{i n 1}-V_{i n 2}=-10 V_{T}$ ? Since $\exp (-10) \approx 4.54 \times 10^{-5}$,

$$
\begin{align*}
I_{C 1} & \approx \frac{I_{E E} \times 4.54 \times 10^{-5}}{1+4.54 \times 10^{-5}}  \tag{10.65}\\
& \approx 4.54 \times 10^{-5} I_{E E} \tag{10.66}
\end{align*}
$$

and

$$
\begin{align*}
I_{C 2} & \approx \frac{I_{E E}}{1+4.54 \times 10^{-5}}  \tag{10.67}\\
& \approx I_{E E}\left(1-4.54 \times 10^{-5}\right) \tag{10.68}
\end{align*}
$$

In other words, $Q_{1}$ carries only $0.0045 \%$ of the tail current; and $I_{E E}$ can be considered steered completely to $Q_{2}$.

| Example $10.8$ | Determine the differential input voltage that steers $98 \%$ of the tail current to one transistor. |
| :---: | :---: |
| Solution | We require that |
|  | $I_{C 1}=0.02 I_{E E}$ |
|  | $\begin{equation*} \approx I_{E E} \exp \frac{V_{i n 1}-V_{i n 2}}{V_{T}} \tag{10.70} \end{equation*}$ |
|  | and hence |
|  | $V_{i n 1}-V_{i n 2} \approx-3.91 V_{T}$ |
|  | We often say a differential input of $4 V_{T}$ is sufficient to turn one side of the bipolar pair nearly off. Note that this value remains independent of $I_{E E}$ and $I_{S}$. |

Exercise What differential input is necessary to steer $90 \%$ of the tail current?

For the output voltages in Fig. 10.12, we have

$$
\begin{align*}
V_{\text {out } 1} & =V_{C C}-R_{C} I_{C 1}  \tag{10.72}\\
& =V_{C C}-R_{C} \frac{I_{E E} \exp \frac{V_{i n 1}-V_{\text {in } 2}}{V_{T}}}{1+\exp \frac{V_{i n 1}-V_{i n 2}}{V_{T}}} \tag{10.73}
\end{align*}
$$

and

$$
\begin{align*}
V_{\text {out } 2} & =V_{C C}-R_{C} I_{C 2}  \tag{10.74}\\
& =V_{C C}-R_{C} \frac{I_{E E}}{1+\exp \frac{V_{\text {in } 1}-V_{\text {in } 2}}{V_{T}}} \tag{10.75}
\end{align*}
$$

Of particular importance is the output differential voltage:

$$
\begin{align*}
V_{\text {out } 1}-V_{\text {out } 2} & =-R_{C}\left(I_{C 1}-I_{C 2}\right)  \tag{10.76}\\
& =R_{C} I_{E E} \frac{1-\exp \frac{V_{i n 1}-V_{\text {in } 2}}{V_{T}}}{1+\exp \frac{V_{i n 1}-V_{\text {in } 2}}{V_{T}}}  \tag{10.77}\\
& =-R_{C} I_{E E} \tanh \frac{V_{\text {in } 1}-V_{\text {in } 2}}{2 V_{T}} \tag{10.78}
\end{align*}
$$

Figure 10.13 summarizes the results, indicating that the differential output voltage begins from a "saturated" value of $+R_{C} I_{E E}$ for a very negative differential input, gradually becomes a linear function of $V_{i n 1}-V_{i n 2}$ for relatively small values of $\left|V_{i n 1}-V_{i n 2}\right|$, and reaches a saturated level of $-R_{C} I_{E E}$ as $V_{i n 1}-V_{i n 2}$ becomes very positive. From Example 10.8, we recognize that even a differential input of $4 V_{T} \approx 104 \mathrm{mV}$ "switches" the differential pair, thereby concluding that $\left|V_{i n 1}-V_{i n 2}\right|$ must remain well below this value for linear operation.
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-02.jpg?height=1434&width=1788&top_left_y=3130&top_left_x=1492)

Figure 10.13 Variation of currents and voltages as a function of input.

Sketch the output waveforms of the bipolar differential pair in Fig. 10.14(a) in response to the sinusoidal inputs shown in Figs. 10.14(b) and (c). Assume $Q_{1}$ and $Q_{2}$ remain in the forward active region.

Solution For the sinusoids depicted in Fig. 10.14(b), the circuit operates linearly because the maximum differential input is equal to $\pm 2 \mathrm{mV}$. The outputs are therefore sinusoids having a peak amplitude of $1 \mathrm{mV} \times g_{m} R_{C}$ [Fig.10.14(d)]. On the other hand, the sinusoids in Fig. 10.14(c) force a maximum input difference of $\pm 200 \mathrm{mV}$, turning $Q_{1}$ or $Q_{2}$ off. For example, as $V_{\text {in } 1}$ approaches 50 mV above $V_{C M}$ and $V_{i n 2}$ reaches 50 mV below $V_{C M}$ (at $t=t_{1}$ ), $Q_{1}$ absorbs most of the tail current, thus producing

$$
\begin{align*}
& V_{\text {out } 1} \approx V_{C C}-R_{C} I_{E E}  \tag{10.79}\\
& V_{\text {out } 2} \approx V_{C C} . \tag{10.80}
\end{align*}
$$

Thereafter, the outputs remain saturated until $\left|V_{i n 1}-V_{i n 2}\right|$ falls to less than 100 mV . The result is sketched in Fig. 10.14(e). We say the circuit operates as a "limiter" in this case, playing a role similar to the diode limiters studied in Chapter 3.
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-03.jpg?height=817&width=852&top_left_y=1692&top_left_x=967)
(a)
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-03.jpg?height=583&width=766&top_left_y=1695&top_left_x=1792)
(b)
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-03.jpg?height=640&width=972&top_left_y=2363&top_left_x=1803)
(d)
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-03.jpg?height=714&width=777&top_left_y=1561&top_left_x=2734)
(c)
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-03.jpg?height=658&width=823&top_left_y=2365&top_left_x=2819)
(e)

Figure 10.14

Exercise
What happens to the above results if the tail current is halved?

Did you know?

Differential pairs can operate as limiters if their input difference is large. In this case, they "clip" the top and bottom of the signal waveform. Of course, limiting a signal such as your voice creates distortion and is undesirable. However, limiting proves useful in some applications. A common example is in FM radios, where the RF waveform ideally contains only frequency modulation [Fig. (a)], but in practice incurs some noise [Fig. (b)]. A limiter removes the noise on the amplitude, improving the signal quality.
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-03.jpg?height=731&width=2895&top_left_y=4144&top_left_x=710)

Effect of clipping on FM waveform.

### 10.2.3 Small-Signal Analysis

Our brief investigation of the differential pair in Fig. 10.11 revealed that, for small differential inputs, the tail node maintains a constant voltage (and hence is called a "virtual ground"). We also obtained a voltage gain equal to $g_{m} R_{C}$. We now study the small-signal behavior of the circuit in greater detail. As explained in previous chapters, the definition of "small signals" is somewhat arbitrary, but the requirement is that the input signals not influence the bias currents of $Q_{1}$ and $Q_{2}$ appreciably. In other words, the two transistors must exhibit approximately equal transconductances-the same condition required for node $P$ to appear as virtual ground. In practice, an input difference of less than 10 mV is considered "small" for most applications.

Assuming perfect symmetry, an ideal tail current source, and $V_{A}=\infty$, we construct the small-signal model of the circuit as shown in Fig. 10.15(a). Here, $v_{i n 1}$ and $v_{i n 2}$ represent small changes in each input and must satisfy $v_{i n 1}=-v_{i n 2}$ for differential operation. Note that the tail current source is replaced with an open circuit. As with the foregoing largesignal analysis, let us write a KVL around the input network and a KCL at node $P$ :

$$
\begin{gather*}
v_{i n 1}-v_{\pi 1}=v_{P}=v_{i n 2}-v_{\pi 2}  \tag{10.81}\\
\frac{v_{\pi 1}}{r_{\pi 1}}+g_{m 1} v_{\pi 1}+\frac{v_{\pi 2}}{r_{\pi 2}}+g_{m 2} v_{\pi 2}=0 \tag{10.82}
\end{gather*}
$$

With $r_{\pi 1}=r_{\pi 2}$ and $g_{m 1}=g_{m 2}$, Eq. (10.82) yields

$$
\begin{equation*}
v_{\pi 1}=-v_{\pi 2} \tag{10.83}
\end{equation*}
$$

and since $v_{i n 1}=-v_{i n 2}$, Eq. (10.81) translates to

$$
\begin{equation*}
2 v_{i n 1}=2 v_{\pi 1} \tag{10.84}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-04.jpg?height=1976&width=2131&top_left_y=2979&top_left_x=1309)

Figure 10.15 (a) Small-signal model of bipolar pair, (b) simplified small-signal model, (c) simplied diagram.

That is,

$$
\begin{align*}
v_{P} & =v_{i n 1}-v_{\pi 1}  \tag{10.85}\\
& =0 . \tag{10.86}
\end{align*}
$$

Thus, the small-signal model confirms the prediction made by Eq. (10.32). In Problem 10.28, we prove that this property holds in the presence of the Early effect as well.

The virtual-ground nature of node $P$ for differential small-signal inputs simplifies the analysis considerably. Since $v_{P}=0$, this node can be shorted to ac ground, reducing the differential pair of Fig. 10.15(a) to two "half circuits" [Fig. 10.15(b)]. With each half resembling a common-emitter stage, we can write

$$
\begin{align*}
v_{\text {out } 1} & =-g_{m} R_{C} v_{\text {in } 1}  \tag{10.87}\\
v_{\text {out } 2} & =-g_{m} R_{C} v_{\text {in } 2} \tag{10.88}
\end{align*}
$$

It follows that the differential voltage gain of the differential pair is equal to

$$
\begin{equation*}
\frac{v_{\text {out } 1}-v_{\text {out } 2}}{v_{\text {in } 1}-v_{\text {in } 2}}=-g_{m} R_{C} \tag{10.89}
\end{equation*}
$$

the same as that expressed by Eq. (10.40). For simplicity, we may draw the two half circuits as in Fig. 10.15(c), with the understanding that the incremental inputs are small and differential. Also, since the two halves are identical, we may draw only one half.

Example Compute the differential gain of the circuit shown in Fig. 10.16(a), where ideal current 10.10 sources are used as loads to maximize the gain.
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-05.jpg?height=818&width=926&top_left_y=2502&top_left_x=1175)
(a)
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-05.jpg?height=492&width=1080&top_left_y=2648&top_left_x=2337)
(b)

Figure 10.16

Solution With ideal current sources, the Early effect in $Q_{1}$ and $Q_{2}$ cannot be neglected, and the half circuits must be visualized as depicted in Fig. 10.16(b). Thus,

$$
\begin{align*}
& v_{\text {out } 1}=-g_{m} r_{O} v_{\text {in } 1}  \tag{10.90}\\
& v_{\text {out } 2}=-g_{m} r_{O} v_{\text {in } 2} \tag{10.91}
\end{align*}
$$

and hence

$$
\begin{equation*}
\frac{v_{\text {out } 1}-v_{\text {out } 2}}{v_{\text {in } 1}-v_{\text {in } 2}}=-g_{m} r_{O} \tag{10.92}
\end{equation*}
$$

Exercise Calculate the gain for $V_{A}=5 \mathrm{~V}$.

Example Figure 10.17(a) illustrates an implementation of the topology shown in Fig. 10.16(a).
10.11 Calculate the differential voltage gain.

Solution Noting that each pnp device introduces a resistance of $r_{O P}$ at the output nodes and drawing the half circuit as in Fig. 10.17(b), we have

$$
\begin{equation*}
\frac{v_{\text {out } 1}-v_{\text {out } 2}}{v_{\text {in } 1}-v_{\text {in } 2}}=-g_{m}\left(r_{O N} \| r_{O P}\right) \tag{10.93}
\end{equation*}
$$

where $r_{O N}$ denotes the output impedance of the $n p n$ transistors.
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-06.jpg?height=829&width=925&top_left_y=1321&top_left_x=1404)
(a)
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-06.jpg?height=674&width=589&top_left_y=1421&top_left_x=2776)
(b)

Figure 10.17

Exercise Calculate the gain if $Q_{3}$ and $Q_{4}$ are configured as diode-connected devices.

We must emphasize that the differential voltage gain is defined as the difference between the outputs divided by the difference between the inputs. As such, this gain is equal to the single-ended gain of each half circuit.

We now make an observation that proves useful in the analysis of differential circuits. As noted above, the symmetry of the circuit $\left(g_{m 1}=g_{m 2}\right)$ establishes a virtual ground at node $P$ in Fig. 10.12 if the incremental inputs are small and differential. This property holds for any other node that appears on the axis of symmetry. For example, the two resistors shown in Fig. 10.18 create a virtual ground at $X$ if (1) $R_{1}=R_{2}$ and (2) nodes $A$ and $B$ vary by equal and opposite amounts. ${ }^{2}$ Additional examples make this concept clearer. We assume perfect symmetry in each case.
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-06.jpg?height=201&width=1199&top_left_y=3644&top_left_x=1775)

Figure 10.18

Example Determine the differential gain of the circuit in Fig. 10.19(a) if $V_{A}<\infty$ and the circuit 10.12 is symmetric.

Solution Drawing one of the half circuits as shown in Fig. 10.19(b), we express the total resistance seen at the collector of $Q_{1}$ as

$$
\begin{equation*}
R_{o u t}=r_{O 1}\left\|r_{O 3}\right\| R_{1} \tag{10.94}
\end{equation*}
$$

[^0]![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-07.jpg?height=1125&width=2878&top_left_y=385&top_left_x=450)

Figure 10.19
Thus, the voltage gain is equal to

$$
\begin{equation*}
A_{v}=-g_{m 1}\left(r_{O 1}\left\|r_{O 3}\right\| R_{1}\right) \tag{10.95}
\end{equation*}
$$

Exercise $\quad$ Repeat the above example if $R_{1} \neq R_{2}$.

Calculate the differential gain of the circuit illustrated in Fig. 10.20(a) if $V_{A}<\infty$.

## 10.13

![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-07.jpg?height=1015&width=2091&top_left_y=2785&top_left_x=1277)
(a)
(b)

Figure 10.20
Solution For small differential inputs and outputs, $V_{X}$ remains constant, leading to the conceptual half circuit shown in Fig. 10.20(b) -the same as that in the above example. This is because $Q_{3}$ and $Q_{4}$ experience a constant base-emitter voltage in both cases, thereby serving as current sources and exhibiting only an output resistance. It follows that

$$
\begin{equation*}
A_{v}=-g_{m 1}\left(r_{O 1}\left\|r_{O 3}\right\| R_{1}\right) \tag{10.96}
\end{equation*}
$$

Exercise Calculate the gain if $V_{A}=4 \mathrm{~V}$ for all transistors, $R_{1}=R_{2}=10 \mathrm{k} \Omega$, and $I_{E E}=1 \mathrm{~mA}$.

Example
Determine the gain of the degenerated differential pairs shown in Figs. 10.21(a) and (b).
Assume $V_{A}=\infty$. Assume $V_{A}=\infty$.
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-08.jpg?height=1810&width=2661&top_left_y=716&top_left_x=924)

Figure 10.21

Solution

In the topology of Fig. 10.21(a), node $P$ is a virtual ground, yielding the half circuit depicted in Fig. 10.21(c). From Chapter 5, we have

$$
\begin{equation*}
A_{v}=-\frac{R_{C}}{R_{E}+\frac{1}{g_{m}}} \tag{10.97}
\end{equation*}
$$

In the circuit of Fig. 10.21(b), the line of symmetry passes through the "midpoint" of $R_{E}$. In other words, if $R_{E}$ is regarded as two $R_{E} / 2$ units in series, then the node between the units acts as a virtual ground [Fig. 10.21(d)]. It follows that

$$
\begin{equation*}
A_{v}=-\frac{R_{C}}{\frac{R_{E}}{2}+\frac{1}{g_{m}}} \tag{10.98}
\end{equation*}
$$

The two circuits provide equal gains if the pair in Fig. 10.21(b) incorporates a total degeneration resistance of $2 R_{E}$.

Exercise Design each circuit for a gain of 5 and power consumption of 2 mW . Assume $V_{C C}=2.5 \mathrm{~V}$, $V_{A}=\infty$, and $R_{E}=2 / g_{m}$.

I/O Impedances For a differential pair, we can define the input impedance as illustrated in Fig. 10.22(a). From the equivalent circuit in Fig. 10.22(b), we have

$$
\begin{equation*}
\frac{v_{\pi 1}}{r_{\pi 1}}=i_{X}=-\frac{v_{\pi 2}}{r_{\pi 2}} \tag{10.99}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-09.jpg?height=1086&width=3067&top_left_y=359&top_left_x=784)

Figure 10.22 (a) Method for calculation of differential input impedance, (b) equivalent circuit of (a).

Also,

$$
\begin{align*}
v_{X} & =v_{\pi 1}-v_{\pi 2}  \tag{10.100}\\
& =2 r_{\pi 1} i_{X} \tag{10.101}
\end{align*}
$$

It follows that

$$
\begin{equation*}
\frac{v_{X}}{i_{X}}=2 r_{\pi 1} \tag{10.102}
\end{equation*}
$$

as if the two base-emitter junctions appear in series.
The above quantity is called the "differential input impedance" of the circuit. It is also possible to define a "single-ended input impedance" with the aid of a half circuit (Fig. 10.23), obtaining

$$
\begin{equation*}
\frac{v_{X}}{i_{X}}=r_{\pi 1} \tag{10.103}
\end{equation*}
$$

This result provides no new information with respect to that in Eq. (10.102) but proves useful in some calculations.
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-09.jpg?height=555&width=623&top_left_y=3330&top_left_x=1972)

Figure 10.23 Calculation of single-ended input impedance.

In a manner similar to the foregoing development, the reader can show that the differential and single-ended output impedances are equal to $2 R_{C}$ and $R_{C}$, respectively.

## 10.3 MOS DIFFERENTIAL PAIR

Most of the principles studied in the previous section for the bipolar differential pair apply directly to the MOS counterpart as well. For this reason, our treatment of the MOS circuit in this section is more concise. We continue to assume perfect symmetry.
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-10.jpg?height=766&width=954&top_left_y=365&top_left_x=1909)

Figure 10.24 Response of MOS differential pair to input CM variation.

### 10.3.1 Qualitative Analysis

Figure 10.24(a) depicts the MOS pair with the two inputs tied to $V_{C M}$, yielding

$$
\begin{equation*}
I_{D 1}=I_{D 2}=\frac{I_{S S}}{2} \tag{10.104}
\end{equation*}
$$

and

$$
\begin{equation*}
V_{X}=V_{Y}=V_{D D}-R_{D} \frac{I_{S S}}{2} . \tag{10.105}
\end{equation*}
$$

That is, a zero differential input gives a zero differential output. Note that the output CM level is equal to $V_{D D}-R_{D} I_{S S} / 2$.

For our subsequent derivations, it is useful to compute the "equilibrium overdrive voltage" of $M_{1}$ and $M_{2},\left(V_{G S}-V_{T H}\right)_{\text {equil. }}$. We assume $\lambda=0$ and hence $I_{D}=$ $(1 / 2) \mu_{n} C_{o x}(W / L)\left(V_{G S}-V_{T H}\right)^{2}$. Carrying a current of $I_{S S} / 2$, each device exhibits an overdrive of

$$
\begin{equation*}
\left(V_{G S}-V_{T H}\right)_{e q u i l .}=\sqrt{\frac{I_{S S}}{\mu_{n} C_{o x} \frac{W}{L}}} \tag{10.106}
\end{equation*}
$$

As expected, a greater tail current or a smaller $W / L$ translates to a larger equilibrium overdrive.

To guarantee that $M_{1}$ and $M_{2}$ operate in saturation, we require that their drain voltages not fall below $V_{C M}-V_{T H}$ :

$$
\begin{equation*}
V_{D D}-R_{D} \frac{I_{S S}}{2}>V_{C M}-V_{T H} \tag{10.107}
\end{equation*}
$$

It can also be observed that a change in $V_{C M}$ cannot alter $I_{D 1}=I_{D 2}=I_{S S} 2$, leaving $V_{X}$ and $V_{Y}$ undisturbed. The circuit thus rejects input CM variations.

Example A MOS differential pair is driven with an input CM level of 1.6 V . If $I_{S S}=0.5 \mathrm{~mA}$, 10.15 $V_{T H}=0.5 \mathrm{~V}$, and $V_{D D}=1.8 \mathrm{~V}$, what is the maximum allowable load resistance?

Solution From Eq. (10.107), we have

$$
\begin{align*}
R_{D} & <2 \frac{V_{D D}-V_{C M}+V_{T H}}{I_{S S}}  \tag{10.108}\\
& <2.8 \mathrm{k} \Omega . \tag{10.109}
\end{align*}
$$

We may suspect that this limitation in turn constrains the voltage gain of the circuit, as explained later.

What is the maximum tail current if the load resistance is $5 \mathrm{k} \Omega$ ?

Figure 10.25 illustrates the response of the MOS pair to large differential inputs. If $V_{i n 1}$ is well above $V_{i n 2}$ [Fig. 10.25(a)], then $M_{1}$ carries the entire tail current, generating

$$
\begin{align*}
& V_{X}=V_{D D}-R_{D} I_{S S}  \tag{10.110}\\
& V_{Y}=V_{D D} . \tag{10.111}
\end{align*}
$$

Similarly, if $V_{\text {in2 }}$ is well above $V_{\text {in } 1}$ [Fig. 10.25(b)], then

$$
\begin{align*}
& V_{X}=V_{D D}  \tag{10.112}\\
& V_{Y}=V_{D D}-R_{D} I_{S S} \tag{10.113}
\end{align*}
$$

The circuit therefore steers the tail current from one side to the other, producing a differential output in response to a differential input. Figure 10.25(c) sketches the characteristics of the circuit.

Let us now examine the circuit's behavior for a small input difference. Depicted in Fig. 10.26(a), such a scenario maintains $V_{P}$ constant because Eqs. (10.27)-(10.32) apply to this case equally well. It follows that

$$
\begin{align*}
\Delta I_{D 1} & =g_{m} \Delta V  \tag{10.114}\\
\Delta I_{D 2} & =-g_{m} \Delta V \tag{10.115}
\end{align*}
$$

![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-11.jpg?height=938&width=920&top_left_y=2893&top_left_x=1230)
(a)
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-11.jpg?height=475&width=1228&top_left_y=3941&top_left_x=950)
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-11.jpg?height=920&width=915&top_left_y=2919&top_left_x=2271)
(b)
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-11.jpg?height=463&width=1388&top_left_y=3958&top_left_x=2251)
(c)

Figure 10.25 (a) Response of MOS differential pair to very positive input, (b) response of MOS differential pair to very negative input, (c) qualitative plots of currents and voltages.
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-12.jpg?height=778&width=1565&top_left_y=273&top_left_x=1592)

Figure 10.26 Response of MOS pair to small differential inputs.
and

$$
\begin{equation*}
\Delta V_{X}-\Delta V_{Y}=-2 g_{m} R_{D} \Delta V \tag{10.116}
\end{equation*}
$$

As expected, the differential voltage gain is given by

$$
\begin{equation*}
A_{v}=-g_{m} R_{D}, \tag{10.117}
\end{equation*}
$$

similar to that of a common-source stage.

Example Design an NMOS differential pair for a voltage gain of 5 and a power budget of 2 mW
10.16 subject to the condition that the stage following the differential pair requires an input CM level of at least 1.6 V . Assume $\mu_{n} C_{o x}=100 \mu \mathrm{~A} / \mathrm{V}^{2}, \lambda=0$, and $V_{D D}=1.8 \mathrm{~V}$.

Solution From the power budget and the supply voltage, we have

$$
\begin{equation*}
I_{S S}=1.11 \mathrm{~mA} \tag{10.118}
\end{equation*}
$$

The output CM level (in the absence of signals) is equal to

$$
\begin{equation*}
V_{C M, \text { out }}=V_{D D}-R_{D} \frac{I_{S S}}{2} \tag{10.119}
\end{equation*}
$$

For $V_{C M, \text { out }}=1.6 \mathrm{~V}$, each resistor must sustain a voltage drop of no more than 200 mV , thereby assuming a maximum value of

$$
\begin{equation*}
R_{D}=360 \Omega . \tag{10.120}
\end{equation*}
$$

Setting $g_{m} R_{D}=5$, we must choose the transistor dimensions such that $g_{m}=5 /(360 \Omega)$. Since each transistor carries a drain current of $I_{S S} / 2$,

$$
\begin{equation*}
g_{m}=\sqrt{2 \mu_{n} C_{o x} \frac{W}{L} \frac{I_{S S}}{2}}, \tag{10.121}
\end{equation*}
$$

and hence

$$
\begin{equation*}
\frac{W}{L}=1738 \tag{10.122}
\end{equation*}
$$

The large aspect ratio arises from the small drop allowed across the load resistors.
Exercise If the aspect ratio must remain below 200, what voltage gain can be achieved?

We rewrite Eq. (10.107) as

$$
\begin{align*}
V_{C M, \text { in }} & <V_{D D}-R_{D} \frac{I_{S S}}{2}+V_{T H}  \tag{10.123}\\
& <V_{C M, \text { out }}+V_{T H} \tag{10.124}
\end{align*}
$$

This is conceptually illustrated in Fig. 10.27. Thus,

$$
\begin{equation*}
V_{C M, \text { in }}<2 \mathrm{~V} \tag{10.125}
\end{equation*}
$$

Interestingly, the input CM level can comfortably remain at $V_{D D}$. In contrast to Example 10.5 , the constraint on the load resistor in this case arises from the output CM level requirement.
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-13.jpg?height=771&width=1950&top_left_y=1966&top_left_x=1324)

Figure 10.27

Exercise Does the above result hold if $V_{T H}=0.2 \mathrm{~V}$ ?
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-13.jpg?height=1280&width=2670&top_left_y=3350&top_left_x=480)

Figure 10.28

Solution (a) For the two circuits to consume the same amount of power $I_{D 1}=I_{S S}=2 I_{D 2}=2 I_{D 3}$; i.e., each transistor in the differential pair carries a current equal to half of the drain current of the CS transistor. Equation (10.121) therefore requires that the differential pair transistors be twice as wide as the CS device to obtain the same voltage gain. (b) If the transistors in both circuits have the same dimensions, then the tail current of the differential pair must be twice the bias current of the CS stage for $M_{1}-M_{3}$ to have the same transconductance, doubling the power consumption.

Exercise Discuss the above results if the CS stage and the differential pair incorporate equal source degeneration resistors.

### 10.3.2 Large-Signal Analysis

As with the large-signal analysis of the bipolar pair, our objective here is to derive the input/output characteristics of the MOS pair as the differential input varies from very negative to very positive values. From Fig. 10.29, we have

$$
\begin{align*}
V_{\text {out }} & =V_{\text {out } 1}-V_{\text {out } 2}  \tag{10.126}\\
& =-R_{D}\left(I_{D 1}-I_{D 2}\right) \tag{10.127}
\end{align*}
$$

To obtain $I_{D 1}-I_{D 2}$, we neglect channellength modulation and write a KVL around the input network and a KCL at the tail node:

$$
\begin{gather*}
V_{i n 1}-V_{G S 1}=V_{i n 2}-V_{G S 2}  \tag{10.128}\\
I_{D 1}+I_{D 2}=I_{S S} . \tag{10.129}
\end{gather*}
$$

Did you know?

The MOS differential pair was a natural extension of its bipolar counterpart, offering an important advantage: very little input current. But the need for high-input-impedance op amps had in fact arisen well before MOS op amps became manufacturable. The challenge was to integrate fieldeffect transistors (which generally have a small gate current) on the same chip as the other bipolar devices. The FETs were poorly controlled and suffered from a large offset. It was not until 1970s that high-input-impedance op amps became common. MOS op amps also began to play a profound role in analog integrated circuits, serving as the core of "switched-capacitor" filters and analog-to-digital converters.

Since $I_{D}=(1 / 2) \mu_{n} C_{o x}(W / L)\left(V_{G S}-V_{T H}\right)^{2}$,

$$
\begin{equation*}
V_{G S}=V_{T H}+\sqrt{\frac{2 I_{D}}{\mu_{n} C_{o x} \frac{W}{L}}} \tag{10.130}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-14.jpg?height=755&width=903&top_left_y=4012&top_left_x=1923)

Figure 10.29 MOS differential pair for large-signal analysis.

Substituting for $V_{G S 1}$ and $V_{G S 2}$ in Eq. (10.128), we have

$$
\begin{align*}
V_{i n 1}-V_{i n 2} & =V_{G S 1}-V_{G S 2}  \tag{10.131}\\
& =\sqrt{\frac{2}{\mu_{n} C_{o x} \frac{W}{L}}}\left(\sqrt{I_{D 1}}-\sqrt{I_{D 2}}\right) \tag{10.132}
\end{align*}
$$

Squaring both sides yields

$$
\begin{align*}
\left(V_{i n 1}-V_{i n 2}\right)^{2} & =\frac{2}{\mu_{n} C_{o x} \frac{W}{L}}\left(I_{D 1}+I_{D 2}-2 \sqrt{I_{D 1} I_{D 2}}\right)  \tag{10.133}\\
& =\frac{2}{\mu_{n} C_{o x} \frac{W}{L}}\left(I_{S S}-2 \sqrt{I_{D 1} I_{D 2}}\right) \tag{10.134}
\end{align*}
$$

We now find $\sqrt{I_{D 1} I_{D 2}}$,

$$
\begin{equation*}
4 \sqrt{I_{D 1} I_{D 2}}=2 I_{S S}-\mu_{n} C_{o x} \frac{W}{L}\left(V_{i n 1}-V_{i n 2}\right)^{2} \tag{10.135}
\end{equation*}
$$

square the result again,

$$
\begin{equation*}
16 I_{D 1} I_{D 2}=\left[2 I_{S S}-\mu_{n} C_{o x} \frac{W}{L}\left(V_{i n 1}-V_{i n 2}\right)^{2}\right]^{2} \tag{10.136}
\end{equation*}
$$

and substitute $I_{S S}-I_{D 1}$ for $I_{D 2}$,

$$
\begin{equation*}
16 I_{D 1}\left(I_{S S}-I_{D 1}\right)=\left[2 I_{S S}-\mu_{n} C_{o x} \frac{W}{L}\left(V_{i n 1}-V_{i n 2}\right)^{2}\right]^{2} \tag{10.137}
\end{equation*}
$$

It follows that

$$
\begin{equation*}
16 I_{D 1}^{2}-16 I_{S S} I_{D 1}+\left[2 I_{S S}-\mu_{n} C_{o x} \frac{W}{L}\left(V_{i n 1}-V_{i n 2}\right)^{2}\right]^{2}=0 \tag{10.138}
\end{equation*}
$$

and hence

$$
\begin{equation*}
I_{D 1}=\frac{I_{S S}}{2} \pm \frac{1}{4} \sqrt{4 I_{S S}^{2}-\left[\mu_{n} C_{o x} \frac{W}{L}\left(V_{i n 1}-V_{i n 2}\right)^{2}-2 I_{S S}\right]^{2}} \tag{10.139}
\end{equation*}
$$

In Problem 10.44, we show that only the solution with the sum of the two terms is acceptable:

$$
\begin{equation*}
I_{D 1}=\frac{I_{S S}}{2}+\frac{V_{i n 1}-V_{i n 2}}{4} \sqrt{\mu_{n} C_{o x} \frac{W}{L}\left[4 I_{S S}-\mu_{n} C_{o x} \frac{W}{L}\left(V_{i n 1}-V_{i n 2}\right)^{2}\right]} \tag{10.140}
\end{equation*}
$$

The symmetry of the circuit also implies that

$$
\begin{equation*}
I_{D 2}=\frac{I_{S S}}{2}+\frac{V_{i n 2}-V_{i n 1}}{4} \sqrt{\mu_{n} C_{o x} \frac{W}{L}\left[4 I_{S S}-\mu_{n} C_{o x} \frac{W}{L}\left(V_{i n 2}-V_{i n 1}\right)^{2}\right]} \tag{10.141}
\end{equation*}
$$

That is,

$$
\begin{equation*}
I_{D 1}-I_{D 2}=\frac{1}{2} \mu_{n} C_{o x} \frac{W}{L}\left(V_{i n 1}-V_{i n 2}\right) \sqrt{\frac{4 I_{S S}}{\mu_{n} C_{o x} \frac{W}{L}}-\left(V_{i n 1}-V_{i n 2}\right)^{2}} \tag{10.142}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-16.jpg?height=589&width=1028&top_left_y=225&top_left_x=1866)

Figure 10.30 MOS differential pair with one device off.
Equations (10.140)-(10.142) form the foundation of our understanding of the MOS differential pair.

Let us now examine Eq. (10.142) closely. As expected from the characteristics in Fig. 10.25 (c), the right-hand side is an odd (symmetric) function of $V_{i n 1}-V_{i n 2}$, dropping to zero for a zero input difference. But, can the difference under the square root vanish, too? That would suggest that $I_{D 1}-I_{D 2}$ falls to zero as $\left(V_{i n 1}-V_{i n 2}\right)^{2}$ reaches $4 I_{S S} /\left(\mu_{n} C_{o x} W / L\right)$, an effect not predicted by our qualitative sketches in Fig. 10.25(c). Furthermore, it appears that the argument of the square root becomes negative as $\left(V_{i n 1}-V_{i n 2}\right)^{2}$ exceeds this value! How should these results be interpreted?

Implicit in our foregoing derivations is the assumption both transistors are on. However, as $\left|V_{i n 1}-V_{i n 2}\right|$ rises, at some point $M_{1}$ or $M_{2}$ turns off, violating the above equations. We must therefore determine the input difference that places one of the transistors at the edge of conduction. This can be accomplished by equating Eqs. (10.140), (10.141), or (10.142) to $I_{S S}$, but this leads to lengthy algebra. Instead, we recognize from Fig. 10.30 that if, for example, $M_{1}$ approaches the edge of conduction, then its gate-source voltage falls to a value equal to $V_{T H}$. Also, the gate-source voltage of $M_{2}$ must be sufficiently large to accommodate a drain current of $I_{S S}$ :

$$
\begin{align*}
V_{G S 1} & =V_{T H}  \tag{10.143}\\
V_{G S 2} & =V_{T H}+\sqrt{\frac{2 I_{S S}}{\mu_{n} C_{o x} \frac{W}{L}}} \tag{10.144}
\end{align*}
$$

It follows from Eq. (10.128) that

$$
\begin{equation*}
\left|V_{i n 1}-V_{i n 2}\right|_{\max }=\sqrt{\frac{2 I_{S S}}{\mu_{n} C_{o x} \frac{W}{L}}} \tag{10.145}
\end{equation*}
$$

where $\left|V_{i n 1}-V_{i n 2}\right|_{\text {max }}$ denotes the input difference that places one transistor at the edge of conduction. Equation (10.145) is invalid for input differences greater than this value. Indeed, substituting from Eq. (10.145) in (10.142) also yields $\left|I_{D 1}-I_{D 2}\right|=I_{S S}$. We also note that $\left|V_{i n 1}-V_{i n 2}\right|_{\max }$ can be related to the equilibrium overdrive [Eq. (10.106)] as follows:

$$
\begin{equation*}
\left|V_{i n 1}-V_{i n 2}\right|_{\max }=\sqrt{2}\left(V_{G S}-V_{T H}\right)_{\text {equil. }} . \tag{10.146}
\end{equation*}
$$

The above findings are very important and stand in contrast to the behavior of the bipolar differential pair and Eq. (10.78): the MOS pair steers all of the tail current ${ }^{3}$ for $\left|V_{i n 1}-V_{i n 2}\right|_{\text {max }}$ whereas the bipolar counterpart only approaches this condition for a finite

[^1]![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-17.jpg?height=492&width=1439&top_left_y=165&top_left_x=1718)
(a)
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-17.jpg?height=417&width=1560&top_left_y=739&top_left_x=1606)
(b)
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-17.jpg?height=435&width=1734&top_left_y=1278&top_left_x=1416)
(c)

Figure 10.31 Variation of (a) drain currents, (b) the difference between drain currents, and (c) differential output voltage as a function of input.
input difference. Equation (10.146) provides a great deal of intuition into the operation of the MOS pair. Specifically, we plot $I_{D 1}$ and $I_{D 2}$ as in Fig. 10.31(a), where $\Delta V_{i n}=V_{i n 1}-V_{i n 2}$, arriving at the differential characteristics in Figs. 10.31(b) and (c). The circuit thus behaves linearly for small values of $\Delta V_{\text {in }}$ and becomes completely nonlinear for $\Delta V_{\text {in }}>\Delta V_{i n, \max }$. In other words, $\Delta V_{\text {in,max }}$ serves as an absolute bound on the input signal levels that have any effect on the output.

Example <br> Examine the input/output characteristic of a MOS differential pair if (a) the tail current

10.19 is doubled, or (b) the transistor aspect ratio is doubled.

Solution (a) Equation (10.145) suggests that doubling $I_{S S}$ increases $\Delta V_{i n, \max }$ by a factor of $\sqrt{2}$. Thus, the characteristic of Fig. 10.31(c) expands horizontally. Furthermore, since $I_{S S} R_{D}$ doubles, the characteristic expands vertically as well. Figure 10.32(a) illustrates the result, displaying a greater slope.
(b) Doubling $W / L$ lowers $\Delta V_{i n, \max }$ by a factor of $\sqrt{2}$ while maintaining $I_{S S} R_{D}$ constant. The characteristic therefore contracts horizontally [Fig. 10.32(b)], exhibiting a larger slope in the vicinity of $\Delta V_{i n}=0$.

Exercise Repeat the above example if (a) the tail current is halved, or (b) the transistor aspect ratio is halved.

```
Example
10.20
Design an NMOS differential pair for a power budget of 3 mW and \DeltaV \ \ \ max
Assume }\mp@subsup{\mu}{n}{}\mp@subsup{C}{ox}{}=100 \mu\textrm{A}/\mp@subsup{\textrm{V}}{}{2}\mathrm{ and V VDD
```

![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-18.jpg?height=2073&width=1993&top_left_y=356&top_left_x=1389)

Figure 10.32

Solution The tail current must not exceed $3 \mathrm{~mW} / 1.8 \mathrm{~V}=1.67 \mathrm{~mA}$. From Eq. (10.145), we write

$$
\begin{align*}
\frac{W}{L} & =\frac{2 I_{S S}}{\mu_{n} C_{o x} \Delta V_{i n, \max }^{2}}  \tag{10.147}\\
& =133.6 \tag{10.148}
\end{align*}
$$

The value of the load resistors is determined by the required voltage gain.

Exercise How does the above design change if the power budget is raised to 5 mW ?

### 10.3.3 Small-Signal Analysis

The small-signal analysis of the MOS differential pair proceeds in a manner similar to that in Section 10.2.3 for the bipolar counterpart. The definition of "small" signals in this case can be seen from Eq. (10.142); if

$$
\begin{equation*}
\left|V_{i n 1}-V_{i n 2}\right| \ll \frac{4 I_{S S}}{\mu_{n} C_{o x} \frac{W}{L}}, \tag{10.149}
\end{equation*}
$$

then

$$
\begin{align*}
I_{D 1}-I_{D 2} & \approx \frac{1}{2} \mu_{n} C_{o x} \frac{W}{L}\left(V_{i n 1}-V_{i n 2}\right) \sqrt{\frac{4 I_{S S}}{\mu_{n} C_{o x} \frac{W}{L}}}  \tag{10.150}\\
& =\sqrt{\mu_{n} C_{o x} \frac{W}{L} I_{S S}\left(V_{i n 1}-V_{i n 2}\right) .} \tag{10.151}
\end{align*}
$$

Now, the differential inputs and outputs are linearly proportional, and the circuit operates linearly.

We now use the small-signal model to prove that the tail node remains constant in the presence of small differential inputs. If $\lambda=0$, the circuit reduces to that shown in Fig. 10.33(a), yielding

$$
\begin{align*}
v_{i n 1}-v_{1} & =v_{i n 2}-v_{2}  \tag{10.152}\\
g_{m 1} v_{1}+g_{m 2} v_{2} & =0 \tag{10.153}
\end{align*}
$$

Assuming perfect symmetry, we have from Eq. (10.153)

$$
\begin{equation*}
v_{1}=-v_{2} \tag{10.154}
\end{equation*}
$$

and for differential inputs, we require $v_{i n 1}=-v_{i n 2}$. Thus, Eq. (10.152) translates to

$$
\begin{equation*}
v_{i n 1}=v_{1} \tag{10.155}
\end{equation*}
$$

and hence

$$
\begin{align*}
v_{P} & =v_{i n 1}-v_{1}  \tag{10.156}\\
& =0 \tag{10.157}
\end{align*}
$$

Alternatively, we can simply utilize Eqs. (10.81)-(10.86) with the observation that $v_{\pi} / r_{\pi}=0$ for a MOSFET, arriving at the same result.
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-19.jpg?height=1251&width=2227&top_left_y=3461&top_left_x=1238)
(b)

Figure 10.33 (a) Small-signal model of MOS differential pair, (b) simplified circuit.

With node $P$ acting as a virtual ground, the concept of half circuit applies, leading to the simplified topology in Fig. 10.33(b). Here,

$$
\begin{align*}
& v_{\text {out } 1}=-g_{m} R_{D} v_{\text {in } 1}  \tag{10.158}\\
& v_{\text {out } 2}=-g_{m} R_{D} v_{\text {in } 2} \tag{10.159}
\end{align*}
$$

and, therefore,

$$
\begin{equation*}
\frac{v_{\text {out } 1}-v_{\text {out } 2}}{v_{\text {in } 1}-v_{\text {in } 2}}=-g_{m} R_{D} \tag{10.160}
\end{equation*}
$$

Example
Prove that Eq. (10.151) can also yield the differential voltage gain.
10.21

Solution $\quad$ Since $V_{\text {out } 1}-V_{\text {our } 2}=-R_{D}\left(I_{D 1}-I_{D 2}\right)$ and since $g_{m}=\sqrt{\mu_{n} C_{o x}(W / L) I_{S S}}$ (why?), we have from Eq. (10.151)

$$
\begin{align*}
V_{\text {out } 1}-V_{\text {out } 2} & =-R_{D} \sqrt{\mu_{n} C_{o x} \frac{W}{L} I_{S S}}\left(V_{\text {in } 1}-V_{\text {in } 2}\right)  \tag{10.161}\\
& =-g_{m} R_{D}\left(V_{\text {in } 1}-V_{\text {in } 2}\right) . \tag{10.162}
\end{align*}
$$

This is, of course, to be expected. After all, small-signal operation simply means approximating the input/output characteristic [Eq. (10.142)] with a straight line [Eq. (10.151)] around an operating point (equilibrium).

Exercise Using the equation $g_{m}=2 I_{D} /\left(V_{G S}-V_{T H}\right)$, express the above result in terms of the equilibrium overdrive voltage.

As with the bipolar circuits studied in Examples 10.10 and 10.14, the analysis of MOS differential topologies is greatly simplified if virtual grounds can be identified. The following examples reinforce this concept.

Example Determine the voltage gain of the circuit shown in Fig. 10.34(a). Assume $\lambda \neq 0$.
10.22
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-20.jpg?height=886&width=1707&top_left_y=3667&top_left_x=1544)

Figure 10.34

Solution Drawing the half circuit as in Fig. 10.34(b), we note that the total resistance seen at the drain of $M_{1}$ is equal to $\left(1 / g_{m 3}\right)\left\|r_{O 3}\right\| r_{O 1}$. The voltage gain is therefore equal to

$$
\begin{equation*}
A_{v}=-g_{m 1}\left(\frac{1}{g_{m 3}}\left\|r_{O 3}\right\| r_{O 1}\right) \tag{10.163}
\end{equation*}
$$

Exercise $\quad$ Repeat the above example if a resistance of value $R_{1}$ is inserted in series with the sources of $M_{3}$ and $M_{4}$.

Example Assuming $\lambda=0$, compute the voltage gain of the circuit illustrated in Fig. 10.35(a).
10.23
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-21.jpg?height=1051&width=2535&top_left_y=1315&top_left_x=1027)
(a)
(b)

Figure 10.35

Solution Identifying both nodes $P$ and $Q$ as virtual grounds, we construct the half circuit shown in Fig. 10.35(b), and write

$$
\begin{equation*}
A_{v}=-\frac{g_{m 1}}{g_{m 3}} \tag{10.164}
\end{equation*}
$$

Exercise Repeat the above example if $\lambda \neq 0$.

Example 10.24

Assuming $\lambda=0$, calculate the voltage gain of the topology shown in Fig. 10.36(a).
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-21.jpg?height=914&width=999&top_left_y=3556&top_left_x=1270)
(a)
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-21.jpg?height=806&width=726&top_left_y=3650&top_left_x=2605)
(b)

Figure 10.36

Solution Grounding the midpoint of $R_{S S}$ and $R_{D D}$, we obtain the half circuit in Fig. 10.36(b), where

$$
\begin{equation*}
A_{v}=-\frac{\frac{R_{D D}}{2}}{\frac{R_{S S}}{2}+\frac{1}{g_{m}}} \tag{10.165}
\end{equation*}
$$

Exercise Repeat the above example if the load current sources are replaced with diode-connected PMOS devices.

## 10.4 CASCODE DIFFERENTIAL AMPLIFIERS

Recall from Chapter 9 that cascode stages provide a substantially higher voltage gain than simple CE and CS stages do. Noting that the differential gain of differential pairs is equal to the single-ended gain of their corresponding half circuits, we surmise that cascoding boosts the gain of differential pairs as well.

We begin our study with the structure depicted in Fig. 10.37(a), where $Q_{3}$ and $Q_{4}$ serve as cascode devices and $I_{1}$ and $I_{2}$ are ideal. Recognizing that the bases of $Q_{3}$ and $Q_{4}$ are at ac ground, we construct the half circuit shown in Fig. 10.37(b). Equation (9.51) readily gives the gain as

$$
\begin{equation*}
A_{v}=-g_{m 1}\left[g_{m 3}\left(r_{O 1} \| r_{\pi 3}\right) r_{O 3}+r_{O 1} \| r_{\pi 3}\right], \tag{10.166}
\end{equation*}
$$

confirming that a differential cascode achieves a much higher gain.
The developments in Chapter 9 also suggest the use of $p n p$ cascodes for current sources $I_{1}$ and $I_{2}$ in Fig. 10.37(a). Illustrated in Fig. 10.38(a), the resulting configuration can be analyzed with the aid of its half circuit, Fig. 10.38(b). Utilizing Eq. (9.61), we express the voltage gain as

$$
\begin{equation*}
A_{v} \approx-g_{m 1}\left[g_{m 3} r_{O 3}\left(r_{O 1} \| r_{\pi 3}\right)\right] \|\left[g_{m 5} r_{O 5}\left(r_{O 7} \| r_{\pi 5}\right)\right] . \tag{10.167}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-22.jpg?height=1040&width=920&top_left_y=3476&top_left_x=1504)
(a)
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-22.jpg?height=554&width=561&top_left_y=3867&top_left_x=2682)
(b)

Figure 10.37 (a) Bipolar cascode differential pair, (b) half circuit of (a).
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-23.jpg?height=1416&width=1816&top_left_y=308&top_left_x=1381)

Figure 10.38 (a) Bipolar cascode differential pair with cascode loads, (b) half circuit of (a).

Called a "telescopic cascode," the topology of Fig. 10.38(b) exemplifies the internal circuit of some operational amplifiers.

Example
10.25

Due to a manufacturing defect, a parasitic resistance has appeared between nodes $A$ and $B$ in the circuit of Fig. 10.39(a). Determine the voltage gain of the circuit.
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-23.jpg?height=1406&width=926&top_left_y=2836&top_left_x=1409)
(a)
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-23.jpg?height=1109&width=720&top_left_y=3053&top_left_x=2568)
(b)

Figure 10.39

Solution
The symmetry of the circuit implies that the midpoint of $R_{1}$ is a virtual ground, leading to the half circuit shown in Fig. 10.39(b). Thus, $R_{1} / 2$ appears in parallel with $r_{O 7}$, lowering the output impedance of the pnp cascode. Since the value of $R_{1}$ is not given, we cannot
make approximations and must return to the original expression for the cascode output impedance, Eq. (9.1):

$$
\begin{equation*}
R_{o p}=\left[1+g_{m 5}\left(r_{O 7}\left\|r_{\pi 5}\right\| \frac{R_{1}}{2}\right)\right] r_{O 5}+r_{O 7}\left\|r_{\pi 5}\right\| \frac{R_{1}}{2} \tag{10.168}
\end{equation*}
$$

The resistance seen looking down into the $n p n$ cascode remains unchanged and approximately equal to $g_{m 3} r_{O 3}\left(r_{O 1} \| r_{\pi 3}\right)$. The voltage gain is therefore equal to

$$
\begin{equation*}
A_{v}=-g_{m 1}\left[g_{m 3} r_{O 3}\left(r_{O 1} \| r_{\pi 3}\right)\right] \| R_{o p} \tag{10.169}
\end{equation*}
$$

Exercise If $\beta=50$ and $V_{A}=4 \mathrm{~V}$ for all transistors and $I_{E E}=1 \mathrm{~mA}$, what value of $R_{1}$ degrades the gain by a factor of two?
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-24.jpg?height=949&width=898&top_left_y=1649&top_left_x=1526)
(a)
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-24.jpg?height=457&width=583&top_left_y=2049&top_left_x=2648)
(b)

Figure 10.40 (a) MOS cascode differential pair, (b) half circuit of (a).

We now turn our attention to differential MOS cascodes. Following the above developments for bipolar counterparts, we consider the simplified topology of Fig. 10.40(a) and draw the half circuit as depicted in Fig. 10.40(b). From Eq. (9.69),

$$
\begin{equation*}
A_{v} \approx-g_{m 3} r_{O 3} g_{m 1} r_{O 1} \tag{10.170}
\end{equation*}
$$

Illustrated in Fig. 10.41(a), the complete CMOS telescopic cascode amplifier incorporates PMOS cascades as load current sources, yielding the half circuit shown in Fig. 10.41(b). It follows from Eq. (9.72) that the voltage gain is given by

$$
\begin{equation*}
A_{v} \approx-g_{m 1}\left[\left(g_{m 3} r_{O 3} r_{O 1}\right) \|\left(g_{m 5} r_{O 5} r_{O 7}\right)\right] \tag{10.171}
\end{equation*}
$$

Did you know?

Most stand-alone bipolar op amps do not use the telescopic cascode differential pair. One reason may be that the input common-mode range of this circuit is quite limited, a serious issue for generalpurpose op amps. In analog integrated circuits, on the other hand, telescopic cascode op amps have been utilized extensively because they provide a high voltage gain and have a better high-frequency behavior than other op amp topologies. If you open up your WiFi or cell phone receiver, it is likely that you will see some analog filters and analog-todigital converters using telescopic op amps.

Due to a manufacturing defect, two equal parasitic resistances, $R_{1}$ and $R_{2}$, have appeared as shown in Fig. 10.42(a). Compute the voltage gain of the circuit.
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-25.jpg?height=1109&width=898&top_left_y=159&top_left_x=1446)
(a)
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-25.jpg?height=1006&width=583&top_left_y=182&top_left_x=2557)
(b)

Figure 10.41 (a) MOS telescopic cascode amplifier, (b) half circuit of (a).

Solution Noting that $R_{1}$ and $R_{2}$ appear in parallel with $r_{O 5}$ and $r_{O 6}$, respectively, we draw the half circuit as depicted in Fig. 10.42(b). Without the value of $R_{1}$ given, we must resort to the original expression for the output impedance, Eq. (9.3):

$$
\begin{equation*}
R_{p}=\left[1+g_{m 5}\left(r_{O 5} \| R_{1}\right)\right] r_{O 7}+r_{O 5} \| R_{1} \tag{10.172}
\end{equation*}
$$

The resistance seen looking into the drain of the NMOS cascode can still be approximated as

$$
\begin{equation*}
R_{n} \approx g_{m 3} r_{O 3} r_{O 1} \tag{10.173}
\end{equation*}
$$

The voltage gain is then simply equal to

$$
\begin{equation*}
A_{v}=-g_{m 1}\left(R_{p} \| R_{n}\right) \tag{10.174}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-25.jpg?height=1080&width=977&top_left_y=3010&top_left_x=1452)
(a)
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-25.jpg?height=1009&width=567&top_left_y=3000&top_left_x=2582)
(b)

Figure 10.42

Exercise
Repeat the above example if in addition to $R_{1}$ and $R_{2}$, a resistor of value $R_{3}$ appears between the sources of $M_{3}$ and $M_{4}$.

## 10.5 COMMON-MODE REJECTION

In our study of bipolar and MOS differential pairs, we have observed that these circuits produce no change in the output if the input CM level changes. The common-mode rejection property of differential circuits plays a critical role in today's electronic systems. As the reader may have guessed, in practice the CM rejection is not infinitely high. In this section, we examine the CM rejection in the presence of nonidealities.

The first nonideality relates to the output impedance of the tail current source. Consider the topology shown in Fig. 10.43(a), where $R_{E E}$ denotes the output impedance of $I_{E E}$. What happens if the input CM level changes by a small amount? The symmetry requires that $Q_{1}$ and $Q_{2}$ still carry equal currents and $V_{\text {out } 1}=V_{\text {out } 2}$. But, since the base voltages of both $Q_{1}$ and $Q_{2}$ rise, so does $V_{P}$. In fact, noting that $V_{\text {out } 1}=V_{\text {out } 2}$, we can place a short circuit between the output nodes, reducing the topology to that shown in Fig. 10.43(b). That is, as far as node $P$ is concerned, $Q_{1}$ and $Q_{2}$ operate as an emitter follower. As $V_{P}$ increases, so does the current through $R_{E E}$ and hence the collector currents of $Q_{1}$ and $Q_{2}$. Consequently, the output common-mode level falls. The change in the output CM level can be computed by noting that the stage in Fig. 10.43(b) resembles a degenerated CE stage. That is, from Chapter 5,

$$
\begin{align*}
\frac{\Delta V_{\text {out }, C M}}{\Delta V_{i n, C M}} & =-\frac{\frac{R_{C}}{2}}{R_{E E}+\frac{1}{2 g_{m}}}  \tag{10.175}\\
& =-\frac{R_{C}}{2 R_{E E}+g_{m}^{-1}}, \tag{10.176}
\end{align*}
$$

where the term $2 g_{m}$ represents the transconductance of the parallel combination of $Q_{1}$ and $Q_{2}$. This quantity is called the "common-mode gain." These observations apply to the MOS counterpart equally well. An alternative approach to arriving at Eq. (10.175) is outlined in Problem 10.65.

In summary, if the tail current exhibits a finite output impedance, the differential pair produces an output CM change in response to an input CM change. The reader
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-26.jpg?height=1005&width=2313&top_left_y=3596&top_left_x=1218)

Figure 10.43 (a) CM response of differential pair in the presence of finite tail impedance, (b) simplified circuit of (a).
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-27.jpg?height=1713&width=2912&top_left_y=388&top_left_x=827)

Figure 10.44 (a) Differential pair sensing input CM noise, (b) effect of CM noise at output with $R_{E E}=\infty$, (c) effect of CM noise at the output with $R_{E E} \neq \infty$.
may naturally wonder whether this is a serious issue. After all, so long as the quantity of interest is the difference between the outputs, a change in the output CM level introduces no corruption. Figure 10.44(a) illustrates such a situation. Here, two differential inputs, $V_{i n 1}$ and $V_{i n 2}$, experience some common-mode noise, $V_{i n, C M}$. As a result, the base voltages of $Q_{1}$ and $Q_{2}$ with respect to ground appear as shown in Fig. 10.44(b). With an ideal tail current source, the input CM variation would have no effect at the output, leading to the output waveforms shown in Fig. 10.44(b). On the other hand, with $R_{E E}<\infty$, the single-ended outputs are corrupted, but not the differential output [Fig. 10.44(c)].

In summary, the above study indicates that, in the presence of input CM noise, a finite CM gain does not corrupt the differential output and hence proves benign. ${ }^{4}$ However, if the circuit suffers from asymmetries and a finite tail current source impedance, then the differential output is corrupted. During manufacturing, random "mismatches" appear between the two sides of the differential pair; for example, the transistors or the load resistors may display slightly different dimensions. Consequently, the change in the tail current due to an input CM variation may affect the differential output.

As an example of the effect of asymmetries, we consider the simple case of load resistor mismatch. Depicted in Fig. 10.45(a) for a MOS pair, ${ }^{5}$ this imperfection leads to a difference between $V_{\text {out } 1}$ and $V_{\text {our } 2}$. We must compute the change in $I_{D 1}$ and $I_{D 2}$ and multiply the result by $R_{D}$ and $R_{D}+\Delta R_{D}$.

[^2]![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-28.jpg?height=886&width=1120&top_left_y=196&top_left_x=1820)

Figure 10.45 MOS pair with asymmetric loads.

How do we determine the change in $I_{D 1}$ and $I_{D 2}$ ? Neglecting channel-length modulation, we first observe that

$$
\begin{align*}
& I_{D 1}=\frac{1}{2} \mu_{n} C_{o x} \frac{W}{L}\left(V_{G S 1}-V_{T H}\right)^{2}  \tag{10.177}\\
& I_{D 2}=\frac{1}{2} \mu_{n} C_{o x} \frac{W}{L}\left(V_{G S 2}-V_{T H}\right)^{2}, \tag{10.178}
\end{align*}
$$

concluding that $\Delta I_{D 1}$ must be equal to $\Delta I_{D 2}$ because $V_{G S 1}=V_{G S 2}$ and hence $\Delta V_{G S 1}=$ $\Delta V_{G S 2}$. In other words, the load resistor mismatch does not impact the symmetry of currents carried by $M_{1}$ and $M_{2}{ }^{6}$ Writing $\Delta I_{D 1}=\Delta I_{D 2}=\Delta I_{D}$ and $\Delta V_{G S 1}=\Delta V_{G S 2}=\Delta V_{G S}$, we recognize that both $\Delta I_{D 1}$ and $\Delta I_{D 2}$ flow through $R_{S S}$, creating a voltage change of $2 \Delta I_{D} R_{S S}$ across it. Thus,

$$
\begin{equation*}
\Delta V_{C M}=\Delta V_{G S}+2 \Delta I_{D} R_{S S} \tag{10.179}
\end{equation*}
$$

and, since $\Delta V_{G S}=\Delta I_{D} / g_{m}$,

$$
\begin{equation*}
\Delta V_{C M}=\Delta I_{D}\left(\frac{1}{g_{m}}+2 R_{S S}\right) \tag{10.180}
\end{equation*}
$$

That is,

$$
\begin{equation*}
\Delta I_{D}=\frac{\Delta V_{C M}}{\frac{1}{g_{m}}+2 R_{S S}} \tag{10.181}
\end{equation*}
$$

Produced by each transistor, this current change flows through both $R_{D}$ and $R_{D}+\Delta R_{D}$, thereby generating a differential output change of

$$
\begin{align*}
\Delta V_{\text {out }} & =\Delta V_{\text {out } 1}-\Delta V_{\text {out } 2}  \tag{10.182}\\
& =\Delta I_{D} R_{D}-\Delta I_{D}\left(R_{D}+\Delta R_{D}\right)  \tag{10.183}\\
& =-\Delta I_{D} \cdot \Delta R_{D}  \tag{10.184}\\
& =-\frac{\Delta V_{C M}}{\frac{1}{g_{m}}+2 R_{S S}} \Delta R_{D} . \tag{10.185}
\end{align*}
$$

[^3]It follows that

$$
\begin{equation*}
\left|\frac{\Delta V_{\text {out }}}{\Delta V_{C M}}\right|=\frac{\Delta R_{D}}{\frac{1}{g_{m}}+2 R_{S S}} \tag{10.186}
\end{equation*}
$$

(This result can also be obtained through small-signal analysis.) We say the circuit exhibits "common mode to differential mode (DM) conversion" and denote the above gain by $A_{C M-D M}$. In practice, we strive to minimize this corruption by maximizing the output impedance of the tail current source. For example, a bipolar current source may employ emitter degeneration and a MOS current source may incorporate a relatively long transistor. It is therefore reasonable to assume $R_{S S} \gg 1 / g_{m}$ and

$$
\begin{equation*}
A_{C M-D M} \approx \frac{\Delta R_{D}}{2 R_{S S}} \tag{10.187}
\end{equation*}
$$

Example Determine $A_{C M-D M}$ for the circuit shown in Fig. 10.46. Assume $V_{A}=\infty$ for $Q_{1}$ and $Q_{2}$.
10.27
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-29.jpg?height=1068&width=1097&top_left_y=2046&top_left_x=1746)

Figure 10.46

Solution Recall from Chapter 5 that emitter degeneration raises the output impedance to

$$
\begin{equation*}
R_{\text {out } 3}=\left[1+g_{m 3}\left(R_{1} \| r_{\pi 3}\right)\right] r_{O 3}+R_{1} \| r_{\pi 3} \tag{10.188}
\end{equation*}
$$

Replacing this value for $R_{S S}$ in Eq. (10.186) yields

$$
\begin{equation*}
A_{C M-D M}=\frac{\Delta R_{C}}{\frac{1}{g_{m 1}}+2\left\{\left[1+g_{m 3}\left(R_{1} \| r_{\pi 3}\right)\right] r_{O 3}+R_{1} \| r_{\pi 3}\right\}} \tag{10.189}
\end{equation*}
$$

Exercise $\quad$ Calculate the above result if $R_{1} \rightarrow \infty$.

The mismatches between the transistors in a differential pair also lead to CM-DM conversion. This effect is beyond the scope of this book [1].

While undesirable, CM-DM conversion cannot be simply quantified by $A_{C M-D M}$. If the circuit provides a large differential gain, $A_{D M}$, then the relative corruption at the output is small. We therefore define the "common-mode rejection ratio" (CMRR) as

$$
\begin{equation*}
\text { CMRR }=\frac{A_{D M}}{A_{C M-D M}} \tag{10.190}
\end{equation*}
$$

Representing the ratio of "good" to "bad," CMRR serves as a measure of how much wanted signal and how much unwanted corruption appear at the output if the input consists of a differential component and common-mode noise.

Example

10.28

Calculate the CMRR of the circuit in Fig. 10.46.

Solution For small mismatches (e.g., $1 \%$ ), $\Delta R_{C} \ll R_{C}$, and the differential gain is equal to $g_{m 1} R_{C}$. Thus,

$$
\begin{equation*}
\mathrm{CMRR}=\frac{g_{m 1} R_{C}}{\Delta R_{C}}\left\{\frac{1}{g_{m 1}}+2\left[1+g_{m 3}\left(R_{1} \| r_{\pi 3}\right)\right] r_{O 3}+2\left(R_{1} \| r_{\pi 3}\right)\right\} \tag{10.191}
\end{equation*}
$$

## 10.6 DIFFERENTIAL PAIR WITH ACTIVE LOAD

In this section, we study an interesting combination of differential pairs and current mirrors that proves useful in many applications. To arrive at the circuit, let us first address a problem encountered in some cases.

Recall that the op amps used in Chapter 8 have a differential input but a single-ended output [Fig. 10.47(a)]. Thus, the internal circuits of such op amps must incorporate a stage
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-30.jpg?height=1326&width=2601&top_left_y=3338&top_left_x=1074)

Figure 10.47 (a) Circuit with differential input and single-ended output, (b) possible implementation of (a).
that "converts" a differential input to a single-ended output. We may naturally consider the topology shown in Fig. 10.47(b) as a candidate for this task. Here, the output is sensed at node $Y$ with respect to ground rather than with respect to node $X .{ }^{7}$ Unfortunately, the voltage gain is now halved because the signal swing at node $X$ is not used.

We now introduce a topology that serves the task of "differential to single-ended" conversion while resolving the above issues. Shown in Fig. 10.48, the circuit employs a symmetric differential pair, $Q_{1}-Q_{2}$, along with a current-mirror load, $Q_{3}-Q_{4}$. (Transistors $Q_{3}$ and $Q_{4}$ are also identical.) The output is sensed with respect to ground.
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-31.jpg?height=811&width=1171&top_left_y=1284&top_left_x=1755)

Figure 10.48 Differential pair with active load.

### 10.6.1 Qualitative Analysis

It is instructive to first decompose the circuit of Fig. 10.48 into two sections: the input differential pair and the current-mirror load. As depicted in Fig. 10.49(a) (along with a fictitious load $R_{L}$ ), $Q_{1}$ and $Q_{2}$ produce equal and opposite changes in their collector currents in response to a differential change at the input, creating a voltage change of $\Delta I R_{L}$ across $R_{L}$. Now consider the circuit in Fig. 10.49(b) and suppose the current drawn from $Q_{3}$ increases from $I_{E E} / 2$ to $I_{E E} / 2+\Delta I$. What happens? First, since the small-signal impedance seen at node $N$ is approximately equal to $1 / g_{m 3}, V_{N}$ changes by $\Delta I / g_{m 3}$ (for small $\Delta I$ ). Second, by virtue of current mirror action, the collector current of $Q_{4}$ also increases by $\Delta I$. As a result, the voltage across $R_{L}$ changes by $\Delta I R_{L}$.
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-31.jpg?height=915&width=2592&top_left_y=3561&top_left_x=993)

Figure 10.49 (a) Response of input pair to input change, (b) response of active load to current change.
${ }^{7}$ In practice, additional stages precede this stage so as to provide a high gain.
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-32.jpg?height=1085&width=1804&top_left_y=234&top_left_x=1524)

Figure 10.50 Detailed operation of pair with active load.

In order to understand the detailed operation of the circuit, we apply small, differential changes at the input and follow the signals to the output (Fig. 10.50). The load resistor, $R_{L}$, is added to augment our intuition but it is not necessary for the actual operation. With the input voltage changes shown here, we note that $I_{C 1}$ increases by some amount $\Delta I$ and $I_{C 2}$ decreases by the same amount. Ignoring the role of $Q_{3}$ and $Q_{4}$ for the moment, we observe that the fall in $I_{C 2}$ translates to a rise in $V_{\text {out }}$ because $Q_{2}$ draws less current from $R_{L}$. The output change can therefore be an amplified version of $\Delta V$.

Let us now determine how the change in $I_{C 1}$ travels through $Q_{3}$ and $Q_{4}$. Neglecting the base currents of these two transistors, we recognize that the change in $I_{C 3}$ is also equal to $\Delta I$. This change is copied into $I_{C 4}$ by virtue of the current mirror action. In other words, in response to the differential input shown in Fig. 10.50, $I_{C 1},\left|I_{C 3}\right|$, and $\left|I_{C 4}\right|$ increase by $\Delta I$. Since $Q_{4}$ "injects" a greater current into the output node, $V_{\text {out }}$ rises.

In summary, the circuit of Fig. 10.50 contains two signal paths, one through $Q_{1}$ and $Q_{2}$ and another through $Q_{1}, Q_{3}$ and $Q_{4}$ [Fig. 10.51(a)]. For a differential input change, each path experiences a current change, which translates to a voltage change at the output node. The key point here is that the two paths enhance each other at the output; in the above example, each path forces $V_{\text {out }}$ to increase.

Our initial examination of $Q_{3}$ and $Q_{4}$ in Fig. 10.50 indicates an interesting difference with respect to current mirrors studied in Chapter 9: here $Q_{3}$ and $Q_{4}$ carry signals in
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-32.jpg?height=812&width=1217&top_left_y=3795&top_left_x=1806)

Figure 10.51 Signal paths in pair with active load.
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-33.jpg?height=852&width=920&top_left_y=282&top_left_x=1835)
(a)

Figure 10.52 Differential pair with current-source loads.

Did you know?

The active load was a significant breakthrough in op amp design. Earlier op amps employed a differential pair at the input but discarded the signal on one side at the final output. The first trace of active loads can be seen in the LM101A op amp designed by Robert Widlar at National Semiconductor in 1967. Widlar recognized that the active load avoids large resistor values (which would occupy a large chip area), saves voltage headroom, and provides a high gain. The differential pair with active load is also known as the "five-transistor OTA," where OTA stands for "operational transconductance amplifier" and was used to refer to CMOS op amps in olden days.
addition to bias currents. This also stands in contrast to the current-source loads in Fig. 10.52, where the baseemitter voltage of the load transistors remains constant and independent of signals. Called an "active load" to distinguish it from the load transistors in Fig. 10.52, the combination of $Q_{3}$ and $Q_{4}$ plays a critical role in the operation of the circuit.

The foregoing analysis directly applies to the CMOS counterpart, shown in Fig. 10.53. Specifically, in response to a small, differential input, $I_{D 1}$ rises to $I_{S S} / 2+\Delta I$ and $I_{D 2}$ falls to $I_{S S} / 2-\Delta I$. The change in $I_{D 2}$ tends to raise $V_{\text {out }}$. Also, the change in $I_{D 1}$ and $I_{D 3}$ is copied into $I_{D 4}$, increasing $\left|I_{D 4}\right|$ and raising $V_{\text {out }}$. (In this circuit, too, the current mirror transistors are identical.)
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-33.jpg?height=783&width=1788&top_left_y=2908&top_left_x=1446)

Figure 10.53 MOS differential pair with active load.

### 10.6.2 Quantitative Analysis

The existence of the signal paths in the differential to single-ended converter circuit suggests that the voltage gain of the circuit must be greater than that of a differential topology in which only one output node is sensed with respect to ground [e.g., Fig. 10.47(b)]. To confirm this conjecture, we wish to determine the small-signal single-ended output, $v_{\text {out }}$, divided by the small-signal differential input, $v_{i n 1}-v_{i n 2}$. We deal with a CMOS implementation here (Fig. 10.54) to demonstrate that both CMOS and bipolar versions are treated identically.
![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-34.jpg?height=691&width=948&top_left_y=351&top_left_x=1912)

Figure 10.54 MOS pair for small-signal analysis.

The circuit of Fig. 10.54 presents a quandary. While the transistors themselves are symmetric and the input signals are small and differential, the circuit is asymmetric. With the diode-connected device, $M_{3}$, creating a low impedance at node $A$, we expect a relatively small voltage swing-on the order of the input swing-at this node. On the other hand, transistors $M_{2}$ and $M_{4}$ provide a high impedance and hence a large voltage swing at the output node. (After all, the circuit serves as an amplifier.) The asymmetry resulting from the very different voltage swings at the drains of $M_{1}$ and $M_{2}$ disallows grounding node $P$ for small-signal analysis. We present two approaches to solving this circuit.

Approach I Without a half circuit available, the analysis can be performed through the use of a complete small-signal model of the amplifier. Referring to the equivalent circuit shown in Fig. 10.55, where the dashed boxes indicate each transistor, we perform the analysis in two steps. In the first step, we note that $i_{X}$ and $i_{Y}$ must add up to zero at node $P$ and hence $i_{X}=-i_{Y}$. Also, $v_{A}=-i_{X}\left(g_{m P}^{-1} \| r_{O P}\right)$ and

$$
\begin{align*}
-i_{Y} & =\frac{v_{\text {out }}}{r_{O P}}+g_{m P} v_{A}  \tag{10.192}\\
& =\frac{v_{\text {out }}}{r_{O P}}-g_{m P} i_{X}\left(\frac{1}{g_{m P}} \| r_{O P}\right)  \tag{10.193}\\
& =i_{X} \tag{10.194}
\end{align*}
$$

Thus,

$$
\begin{equation*}
i_{X}=\frac{v_{\text {out }}}{r_{O P}\left[1+g_{m P}\left(\frac{1}{g_{m P}} \| r_{O P}\right)\right]} \tag{10.195}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-34.jpg?height=857&width=2125&top_left_y=3824&top_left_x=1312)

Figure 10.55 Small-signal equivalent circuit of differential pair with active load.

In the second step, we write a KVL around the loop consisting of all four transistors. The current through $r_{O N}$ of $M_{1}$ is equal to $i_{X}-g_{m N} v_{1}$ and that through $r_{O N}$ of $M_{2}$ equal to $i_{Y}-g_{m N} v_{2}$. It follows that

$$
\begin{equation*}
-v_{A}+\left(i_{X}-g_{m N} v_{1}\right) r_{O N}-\left(i_{Y}-g_{m N} v_{2}\right) r_{O N}+v_{\text {out }}=0 \tag{10.196}
\end{equation*}
$$

Since $v_{1}-v_{2}=v_{i n 1}-v_{i n 2}$ and $i_{X}=-i_{Y}$,

$$
\begin{equation*}
-v_{A}+2 i_{X} r_{O N}-g_{m N} r_{O N}\left(v_{i n 1}-v_{i n 2}\right)+v_{o u t}=0 \tag{10.197}
\end{equation*}
$$

Substituting for $v_{A}$ and $i_{X}$ from above, we have

$$
\begin{align*}
\frac{v_{\text {out }}}{r_{O P}\left[1+g_{m P}\left(\frac{1}{g_{m P}} \| r_{O P}\right)\right]}\left(\frac{1}{g_{m P}} \| r_{O P}\right) & +2 r_{\text {ON }} \frac{v_{\text {out }}}{r_{O P}\left[1+g_{m P}\left(\frac{1}{g_{m P}} \| r_{O P}\right)\right]} \\
+v_{\text {out }} & =g_{m N} r_{\text {ON }}\left(v_{\text {in } 1}-v_{\text {in } 2}\right) \tag{10.198}
\end{align*}
$$

Solving for $v_{\text {out }}$ yields

$$
\begin{equation*}
\frac{v_{\text {out }}}{v_{\text {in } 1}-v_{\text {in } 2}}=g_{m N} r_{O N} \frac{r_{O P}\left[1+g_{m P}\left(\frac{1}{g_{m P}} \| r_{O P}\right)\right]}{2 r_{O N}+2 r_{O P}} \tag{10.199}
\end{equation*}
$$

This is the exact expression for the gain. If $g_{m P} r_{O P} \gg 1$, then

$$
\begin{equation*}
\frac{v_{\text {out }}}{v_{\text {in } 1}-v_{\text {in } 2}}=g_{m N}\left(r_{O N} \| r_{O P}\right) \tag{10.200}
\end{equation*}
$$

The gain is indepedent of $g_{m P}$ and equal to that of the fully-differential circuit. In other words, the use of the active load has restored the gain.

Approach II* In this approach, we decompose the circuit into sections that more easily lend themselves to analysis by inspection. As illustrated in Fig. 10.56(a), we first seek a Thevenin equivalent for the section consisting of $v_{i n 1}, v_{i n 2}, M_{1}$ and $M_{2}$, assuming $v_{i n 1}$ and $v_{i n 2}$ are differential. Recall that $v_{T h e v}$ is the voltage between $A$ and $B$ in the "open-circuit condition" [Fig. 10.56(b)]. Under this condition, the circuit is symmetric, resembling the topology of Fig. 10.16(a). Equation (10.92) thus yields

$$
\begin{equation*}
v_{\text {Thev }}=-g_{m N} r_{O N}\left(v_{i n 1}-v_{i n 2}\right) \tag{10.201}
\end{equation*}
$$

where the subscript $N$ refers to NMOS devices.
To determine the Thevenin resistance, we set the inputs to zero and apply a voltage between the output terminals [Fig. 10.56(c)]. Noting that $M_{1}$ and $M_{2}$ have equal gate-source voltages $\left(v_{1}=v_{2}\right)$ and writing a KVL around the "output" loop, we have

$$
\begin{equation*}
\left(i_{X}-g_{m 1} v_{1}\right) r_{O 1}+\left(i_{X}+g_{m 2} v_{2}\right) r_{O 2}=v_{X} \tag{10.202}
\end{equation*}
$$

and hence

$$
\begin{equation*}
R_{\text {Thev }}=2 r_{O N} \tag{10.203}
\end{equation*}
$$

The reader is encouraged to obtain this result using half circuits as well.
Having reduced the input sources and transistors to a Thevenin equivalent, we now compute the gain of the overall amplifier. Figure 10.57 depicts the simplified circuit, where the diode-connected transistor $M_{3}$ is replaced with $\left(1 / g_{m 3}\right) \| r_{O 3}$ and the output impedance

[^4]![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-36.jpg?height=1776&width=2284&top_left_y=219&top_left_x=1318)

Figure 10.56 (a) Thevenin equivalent, (b) Thevenin voltage, and (c) Thevenin resistance of input pair.
of $M_{4}$ is drawn explicitly. The objective is to calculate $v_{\text {out }}$ in terms of $v_{T h e v}$. Since the voltage at node $E$ with respect to ground is equal to $v_{\text {out }}+v_{\text {Thev }}$, we can view $v_{A}$ as a divided version of $v_{E}$ :

$$
\begin{equation*}
v_{A}=\frac{\frac{1}{g_{m 3}} \| r_{O 3}}{\frac{1}{g_{m 3}} \| r_{O 3}+R_{T h e v}}\left(v_{\text {out }}+v_{\text {Thev }}\right) . \tag{10.204}
\end{equation*}
$$

Given by $g_{m 4} v_{A}$, the small-signal drain current of $M_{4}$ must satisfy KCL at the output node:

$$
\begin{equation*}
g_{m 4} v_{A}+\frac{v_{\text {out }}}{r_{O 4}}+\frac{v_{\text {out }}+v_{\text {Thev }}}{\frac{1}{g_{m 3}} \| r_{O 3}+R_{\text {Thev }}}=0, \tag{10.205}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_11_08_fa3a663eee928a6916c6g-36.jpg?height=623&width=1136&top_left_y=3981&top_left_x=1818)

Figure 10.57 Simplified circuit for calculation of voltage gain.
where the last term on the left-hand side represents the current flowing through $R_{\text {Thev }}$. It follows from Eqs. (10.204) and (10.205) that

$$
\begin{equation*}
\left(g_{m 4} \frac{\frac{1}{g_{m 3}} \| r_{O 3}}{\frac{1}{g_{m 3}} \| r_{O 3}+R_{\text {Thev }}}+\frac{1}{\frac{1}{g_{m 3}} \| r_{O 3}+R_{\text {Thev }}}\right)\left(v_{\text {out }}+v_{\text {Thev }}\right)+\frac{v_{\text {out }}}{r_{O 4}}=0 . \tag{10.206}
\end{equation*}
$$

Recognizing that $1 / g_{m 3} \ll r_{O 3}$, and $1 / g_{m 3} \ll R_{T h e v}$ and assuming $g_{m 3}=g_{m 4}=g_{m p}$ and $r_{O 3}=r_{O 4}=r_{O P}$, we reduce Eq. (10.206) to

$$
\begin{equation*}
\frac{2}{R_{\text {Thev }}}\left(v_{\text {out }}+v_{\text {Thev }}\right)+\frac{v_{\text {out }}}{r_{O P}}=0 . \tag{10.207}
\end{equation*}
$$

Equations (10.201) and (10.207) therefore give

$$
\begin{equation*}
v_{\text {out }}\left(\frac{1}{r_{O N}}+\frac{1}{r_{O P}}\right)=\frac{g_{m N} r_{O N}\left(v_{i n 1}-v_{i n 2}\right)}{r_{O N}} \tag{10.208}
\end{equation*}
$$

and hence

$$
\begin{equation*}
\frac{v_{\text {out }}}{v_{\text {in } 1}-v_{\text {in } 2}}=g_{m N}\left(r_{O N} \| r_{O P}\right) . \tag{10.209}
\end{equation*}
$$

The gain is independent of $g_{m p}$. Interestingly, the gain of this circuit is the same as the differential gain of the topology in Fig. 10.51(b). In other words, the path through the active load restores the gain even though the output is single-ended.

Example In our earlier observations, we surmised that the voltage swing at node $A$ in Fig. 10.56 is 10.29 much less than that at the output. Prove this point.

Solution As depicted in Fig. 10.58, KCL at the output node indicates that the total current drawn by $M_{2}$ must be equal to $-v_{\text {out }} / r_{O 4}-g_{m 4} v_{A}$. This current flows through $M_{1}$ and hence through $M_{3}$, generating

$$
\begin{equation*}
v_{A}=-\left(v_{\text {out }} / r_{O 4}+g_{m 4} v_{A}\right)\left(\frac{1}{g_{m 3}} \| r_{O 3}\right) . \tag{10.210}
\end{equation*}
$$

Figure 10.58

That is,

$$
\begin{equation*}
v_{A} \approx-\frac{v_{\text {out }}}{2 g_{m P} r_{O P}} \tag{10.211}
\end{equation*}
$$

revealing that $v_{A}$ is indeed much less that $v_{\text {out }}$.

Exercise Calculate the voltage gain from the differential input to node $A$.

## 10.7 CHAPTER SUMMARY

- Single-ended signals are voltages measured with respect to ground. A differential signal consists of two single-ended signals carried over two wires, with the two components beginning from the same dc (common-mode) level and changing by equal and opposite amounts.
- Compared with single-ended signals, differential signals are more immune to common-mode noise.
- A differential pair consists of two identical transistors, a tail current, and two identical loads.
- The transistor currents in a differential pair remain constant as the input CM level changes, i.e., the circuit "rejects" input CM changes.
- The transistor currents change in opposite directions if a differential input is applied, i.e., the circuit responds to differential inputs.
- For small, differential changes at the input, the tail node voltage of a differential pair remains constant and is thus considered a virtual ground node.
- Bipolar differential pairs exhibit a hyperbolic tangent input/output characteristic. The tail current can be mostly steered to one side with a differential input of about $4 V_{T}$.
- For small-signal operation, the input differential swing of a bipolar differential pair must remain below roughly $V_{T}$. The pair can then be decomposed into two half circuits, each of which is simply a common-emitter stage.
- MOS differential pairs can steer the tail current with a differential input equal to $\sqrt{2 I_{S S} /\left(\mu_{n} C_{o x} W / L\right)}$, which is $\sqrt{2}$ larger than the equilibrium overdrive of each transistor.
- Unlike their bipolar counterparts, MOS differential pairs can provide more or less linear characteristics depending on the choice of the device dimensions.
- The input transistors of a differential pair can be cascoded so as to achieve a higher voltage gain. Similarly, the loads can be cascoded to maximize the voltage gain.
- The differential output of a perfectly symmetric differential pair remains free from input CM changes. In the presence of asymmetries and a finite tail current source impedance, a fraction of the input CM change appears as a differential component at the output, corrupting the desired signal.
- The gain seen by the CM change normalized to the gain seen by the desired signal is called the common-mode rejection ration.
- It is possible to replace the loads of a differential pair with a current mirror so as to provide a single-ended output while maintaining the original gain. The circuit is called a differential pair with active load.
