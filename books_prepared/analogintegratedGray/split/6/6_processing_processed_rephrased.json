[

{
    "text": "In the preceding three chapters, the key circuit building blocks used in analog integrated circuits (ICs) have been examined. The majority of analog ICs are primarily composed of these fundamental circuits, interconnected to execute the intended functions. Despite the nearly limitless variety of both standard and custom special-purpose ICs, certain standard circuits are notable for their broad application across diverse systems. These include operational amplifiers, voltage regulators, and analog-to-digital (A/D) and digital-to-analog (D/A) converters. This chapter focuses on monolithic operational amplifiers (op amps) with single-ended outputs, serving both as an illustration of the previously discussed circuit building blocks and as an introduction to the design and application of this significant category of analog circuits. Op amps with fully differential outputs are addressed in Chapter 12, while voltage-regulator circuits are covered in Chapter 8. The design of A/D and D/A converters is not included here, but it entails the application of circuit techniques detailed throughout the book.\n\nAn ideal op amp with a single-ended output features a differential input, infinite voltage gain, infinite input resistance, and zero output resistance. A conceptual schematic diagram is depicted in Fig. 6.1. Although real op amps do not possess these ideal traits, their performance is typically adequate enough that their behavior closely mirrors that of an ideal op amp in most scenarios.\n\nIn op-amp design, bipolar transistors present several advantages over CMOS transistors, such as higher transconductance for a given current, greater gain $\\left(g_{m} r_{o}\\right)$, higher speed, lower input-referred offset voltage, and reduced input-referred noise voltage. (The subject of noise is discussed in Chapter 11.) Consequently, bipolar transistor-based op amps often deliver superior performance in many applications, including dc-coupled, low-offset, low-drift uses. For these reasons, bipolar op amps were the first to gain commercial significance and generally still offer better analog performance. However, CMOS technology has become prevalent in constructing the digital segments of signal-processing systems due to the smaller size and lower power consumption of CMOS digital circuits compared to their bipolar equivalents. Since these systems frequently process signals that originate in analog form, analog circuits like op amps are necessary to interface with the digital CMOS circuits. To lower system costs and enhance portability, analog and digital circuits are now commonly integrated, creating a strong economic motivation to utilize CMOS op amps.\n\nThis chapter begins by exploring various applications of op amps to highlight their versatility in analog circuit and system design. It then examines CMOS op amps. Following this, a general-purpose bipolar monolithic op amp, the NE5234, is analyzed, and the ways in which its performance deviates from ideal characteristics are detailed. Design strategies for enhancing different aspects of monolithic op-amp low-frequency performance are discussed. The high-frequency and transient responses of op amps are addressed in Chapters 7 and 9.\n\nimage_name: Figure 6.1 Ideal operational amplifier\ndescription:\n[\nname: A0, type: OpAmp, value: A0, ports: {InP: Vip, InN: Vin, OutP: Vo, OutN: GND}\n]\nextrainfo: The diagram illustrates an ideal operational amplifier with infinite gain (a → ∞). It features a differential input with Vip and Vin, and the output is Vo. The op-amp is grounded at the negative output terminal.\n\nFigure 6.1 Ideal operational amplifier."
},
{
    "text": "In the preceding three chapters, we have examined the key circuit building blocks used in analog integrated circuits (ICs). The majority of analog ICs are primarily composed of these fundamental circuits, interconnected to fulfill specific functions. Despite the vast array of both standard and custom-designed ICs, certain standard circuits are particularly prevalent across various systems. These include operational amplifiers, voltage regulators, and analog-to-digital (A/D) and digital-to-analog (D/A) converters. This chapter focuses on monolithic operational amplifiers (op amps) with single-ended outputs, serving both as a demonstration of the previously discussed circuit building blocks and as an introduction to the design and application of this significant category of analog circuits. Op amps with fully differential outputs are addressed in Chapter 12, while voltage-regulator circuits are covered in Chapter 8. The design of A/D and D/A converters is not included here, but it relies on the circuit techniques detailed throughout the book.\n\nAn ideal op amp with a single-ended output features a differential input, infinite voltage gain, infinite input resistance, and zero output resistance. A conceptual schematic diagram is depicted in Fig. 6.1. Although real op amps do not possess these ideal traits, their performance is typically adequate for the circuit behavior to closely resemble that of an ideal op amp in most applications.\n\nIn op-amp design, bipolar transistors present several advantages over CMOS transistors, such as higher transconductance for a given current, higher gain ($g_{m} r_{o}$), greater speed, lower input-referred offset voltage, and lower input-referred noise voltage. (The subject of noise is explored in Chapter 11.) Consequently, bipolar transistor-based op amps often deliver the best performance, particularly in applications like dc-coupled, low-offset, and low-drift scenarios. For these reasons, bipolar op amps were the first to gain commercial significance and generally still provide superior analog performance. However, CMOS technology has become the preferred choice for the digital sections of signal-processing systems due to the smaller size and lower power consumption of CMOS digital circuits compared to their bipolar counterparts. Since these systems frequently process signals that originate in analog form, analog circuits such as op amps are necessary to interface with the digital CMOS circuits. To lower system costs and enhance portability, analog and digital circuits are now commonly integrated, creating a strong economic motivation to utilize CMOS op amps.\n\nThis chapter begins by exploring various applications of op amps to highlight their versatility in analog circuit and system design. It then examines CMOS op amps. Following this, a general-purpose bipolar monolithic op amp, the NE5234, is analyzed, with a focus on how its performance deviates from the ideal. Design strategies for enhancing different aspects of monolithic op-amp low-frequency performance are discussed. The high-frequency and transient responses of op amps are addressed in Chapters 7 and 9.\n\n**Figure 6.1: Ideal Operational Amplifier**\n- **Description**: The diagram illustrates an ideal operational amplifier with infinite gain (a → ∞). It features a differential input with terminals Vip and Vin, and a single output Vo. The op-amp is grounded at the negative output terminal."
},
{
    "text": "In the preceding three chapters, we examined the key circuit building blocks employed in analog integrated circuits (ICs). The majority of analog ICs are predominantly composed of these fundamental circuits, interconnected to execute the intended functions. Despite the nearly boundless variety of standard and custom.special-purpose ICs, certain standard circuits are notable for their extensive use across diverse systems. These include operational amplifiers, voltage regulators, and analog-to-digital (A/D) and digital-to-analog (D/A) converters. This chapter focuses on monolithic operational amplifiers (op amps) with single-ended outputs, serving as both an illustration of the previously discussed circuit building blocks and as an introductory guide to the design and application of this crucial category of analog circuits. Op amps with fully differential outputs are addressed in Chapter 12, while voltage-regulator circuits are discussed in Chapter 8. The design of A/D and D/A converters is not included here but relies on the circuit techniques detailed throughout the book.\n\nAn ideal op amp with a single-ended output features a differential input, infinite voltage gain, infinite input resistance, and zero output resistance. A conceptual schematic diagram is depicted in Fig. 6.1. Although real op amps do not possess these ideal traits, their performance is typically adequate for the circuit behavior to closely mirror that of an ideal op amp in most scenarios.\n\nIn op-amp design, bipolar transistors present several advantages over CMOS transistors, such as higher transconductance at a given current, higher gain $\\left(g_{m} r_{o}\\right)$, greater speed, lower input-referred offset voltage, and reduced input-referred noise voltage. (Noise is explored in Chapter 11.) Consequently, bipolar transistor-based op amps often deliver superior performance, particularly in applications like dc-coupled, low-offset, and low-drift circuits. For these reasons, bipolar op amps were the first to gain commercial prominence and generally still provide better analog performance. However, CMOS technology has become the preferred choice for the digital segments of signal-processing systems due to the smaller size and lower power consumption of CMOS digital circuits compared to their bipolar equivalents. Since these systems frequently handle signals that start in analog form, analog circuits like op amps are necessary to interface with the digital CMOS circuits. To lower system costs and enhance portability, analog and digital circuits are now commonly integrated, creating a strong economic motivation to utilize CMOS op amps.\n\nThis chapter begins by exploring various applications of op amps to highlight their adaptability in analog circuit and system design. We then delve into CMOS op amps. Following this, a general-purpose bipolar monolithic op amp, the NE5234, is analyzed, with an explanation of how its performance deviates from ideal characteristics. Strategies for enhancing different aspects of monolithic op-amp low-frequency performance are outlined. The high-frequency and transient responses of op amps are discussed in Chapters 7 and 9.\n\nimage_name: Figure 6.1 Ideal operational amplifier\ndescription:\n[\nname: A0, type: OpAmp, value: A0, ports: {InP: Vip, InN: Vin, OutP: Vo, OutN: GND}\n]\nextrainfo: The diagram illustrates an ideal operational amplifier with infinite gain (a → ∞). It features a differential input with Vip and Vin, and the output is Vo. The op-amp is grounded at the negative output terminal.\n\nFigure 6.1 Ideal operational amplifier."
},
{
    "text": "In the preceding three chapters, we have examined the key circuit building blocks used in analog integrated circuits (ICs). Most analog ICs are primarily composed of these fundamental circuits, interconnected to fulfill specific functions. Despite the vast array of both standard and custom-designed ICs, certain standard circuits are particularly prevalent in diverse systems. These include operational amplifiers, voltage regulators, and analog-to-digital (A/D) and digital-to-analog (D/A) converters. This chapter focuses on monolithic operational amplifiers (op amps) with single-ended outputs, serving as both an example of the previously discussed circuit building blocks and as an introduction to the design and application of this significant class of analog circuits. Op amps with fully differential outputs are addressed in Chapter 12, while voltage-regulator circuits are covered in Chapter 8. The design of A/D and D/A converters is not included here, but it relies on the circuit techniques detailed throughout the book.\n\nAn ideal op amp with a single-ended output features a differential input, infinite voltage gain, infinite input resistance, and zero output resistance. A conceptual schematic diagram is depicted in Fig. 6.1. Although real op amps do not possess these ideal traits, their performance is typically adequate for the circuit behavior to closely resemble that of an ideal op amp in most scenarios.\n\nIn op-amp design, bipolar transistors provide several advantages over CMOS transistors, such as higher transconductance at a given current, higher gain ($g_{m} r_{o}$), greater speed, lower input-referred offset voltage, and lower input-referred noise voltage. (The topic of noise is explored in Chapter 11.) Consequently, bipolar transistor-based op amps often deliver superior performance, especially in applications like dc-coupled, low-offset, low-drift systems. For these reasons, bipolar op amps were the first to gain commercial significance and generally still offer better analog performance. However, CMOS technology has become the preferred choice for the digital components of signal-processing systems due to its smaller size and lower power consumption compared to bipolar technology. Since these systems frequently process signals that start in analog form, analog circuits like op amps are necessary to interface with digital CMOS circuits. To lower system costs and enhance portability, analog and digital circuits are now commonly integrated, creating a strong economic motivation to use CMOS op amps.\n\nThis chapter begins by examining various applications of op amps to highlight their versatility in analog circuit and system design. It then delves into CMOS op amps. Following this, a general-purpose bipolar monolithic op amp, the NE5234, is analyzed, with a focus on how its performance deviates from ideal characteristics. The chapter also discusses design considerations for enhancing different aspects of monolithic op-amp low-frequency performance. The high-frequency and transient responses of op amps are addressed in Chapters 7 and 9.\n\nimage_name: Figure 6.1 Ideal operational amplifier\ndescription:\n[\nname: A0, type: OpAmp, value: A0, ports: {InP: Vip, InN: Vin, OutP: Vo, OutN: GND}\n]\nextrainfo: The diagram illustrates an ideal operational amplifier with infinite gain (a → ∞). It has a differential input with Vip and Vin, and the output is Vo. The op-amp is grounded at the negative output terminal.\n\nFigure 6.1 Ideal operational amplifier."
},
{
    "text": "In the preceding three chapters, the fundamental circuit building blocks used in analog integrated circuits (ICs) have been examined. The majority of analog ICs are primarily composed of these basic circuits interconnected to fulfill specific functions. Despite the nearly limitless variety of both standard and custom ICs, certain standard circuits are widely used across various systems. These include operational amplifiers, voltage regulators, and analog-to-digital (A/D) and digital-to-analog (D/A) converters. This chapter focuses on monolithic operational amplifiers (op amps) with single-ended outputs, serving as an example of the application of previously discussed circuit building blocks and as an introduction to the design and use of this significant class of analog circuits. Op amps with fully differential outputs are addressed in Chapter 12, while voltage-regulator circuits are covered in Chapter 8. The design of A/D and D/A converters is not included, but it involves the circuit techniques detailed throughout the book.\n\nAn ideal op amp with a single-ended output features a differential input, infinite voltage gain, infinite input resistance, and zero output resistance. A conceptual schematic diagram is depicted in Fig. 6.1. Although real op amps do not possess these ideal traits, their performance is typically adequate for the circuit behavior to closely mimic that of an ideal op amp in most applications.\n\nIn op-amp design, bipolar transistors provide several advantages over CMOS transistors, such as higher transconductance for a given current, higher gain ($g_{m} r_{o}$), greater speed, lower input-referred offset voltage, and lower input-referred noise voltage. (The topic of noise is discussed in Chapter 11.) Consequently, bipolar transistor-based op amps often deliver superior performance, particularly in applications like dc-coupled, low-offset, and low-drift scenarios. For these reasons, bipolar op amps were the first to gain commercial significance and generally still offer better analog performance. However, CMOS technology has become prevalent in constructing the digital parts of signal-processing systems due to the smaller size and lower power consumption of CMOS digital circuits compared to bipolar ones. Since these systems frequently process signals that start in analog form, analog circuits like op amps are necessary to interface with digital CMOS circuits. To lower system costs and enhance portability, analog and digital circuits are now often integrated, creating a strong economic motivation to use CMOS op amps.\n\nThis chapter begins by exploring various applications of op amps to highlight their versatility in analog circuit and system design. It then examines CMOS op amps. Following this, a general-purpose bipolar monolithic op amp, the NE5234, is analyzed, and the deviations of its performance from ideal characteristics are described. Design strategies for enhancing different aspects of monolithic op-amp low-frequency performance are outlined. The high-frequency and transient response of op amps are discussed in Chapters 7 and 9.\n\n**Figure 6.1 Ideal operational amplifier.**\n- **Description:**\n  - **Name:** A0\n  - **Type:** OpAmp\n  - **Value:** A0\n  - **Ports:** {InP: Vip, InN: Vin, OutP: Vo, OutN: GND}\n- **Extra Info:** The diagram illustrates an ideal operational amplifier with infinite gain (a → ∞). It has a differential input with Vip and Vin, and the output is Vo. The op-amp is grounded at the negative output terminal."
},
{
    "text": "In the preceding three chapters, we examined the key circuit building blocks commonly used in analog integrated circuits (ICs). The majority of analog ICs are primarily composed of these fundamental circuits, interconnected to fulfill specific functions. Despite the vast array of both standard and custom-designed ICs, certain standard circuits are notable for their broad application across diverse systems. These include operational amplifiers, voltage regulators, and analog-to-digital (A/D) and digital-to-analog (D/A) converters. This chapter focuses on monolithic operational amplifiers (op amps) with single-ended outputs, serving as both an example of the previously discussed circuit building blocks and as an introduction to the design and application of this significant class of analog circuits. Op amps with fully differential outputs are addressed in Chapter 12, while voltage-regulator circuits are discussed in Chapter 8. The design of A/D and D/A converters is not included here but involves the application of circuit techniques detailed throughout the book.\n\nAn ideal op amp with a single-ended output features a differential input, infinite voltage gain, infinite input resistance, and zero output resistance. A conceptual schematic diagram is depicted in Fig. 6.1. Although real op amps do not possess these ideal traits, their performance is typically adequate such that their behavior closely mirrors that of an ideal op amp in most applications.\n\nIn op-amp design, bipolar transistors present numerous advantages over CMOS transistors, including higher transconductance at a given current, higher gain $\\left(g_{m} r_{o}\\right)$, greater speed, lower input-referred offset voltage, and lower input-referred noise voltage. (The subject of noise is explored in Chapter 11.) Consequently, bipolar transistor-based op amps often deliver superior performance in various scenarios, such as in dc-coupled, low-offset, low-drift applications. For these reasons, bipolar op amps were the first to gain commercial significance and generally still provide better analog performance. However, CMOS technology has become prevalent in constructing the digital sections of signal-processing systems due to the smaller size and lower power consumption of CMOS digital circuits compared to bipolar ones. Since these systems frequently process signals that originate in analog form, analog circuits like op amps are necessary to interface with the digital CMOS circuits. To lower system costs and enhance portability, analog and digital circuits are now often integrated, creating a strong economic motivation to use CMOS op amps.\n\nThis chapter begins by exploring various applications of op amps to highlight their versatility in analog circuit and system design. It then examines CMOS op amps. Subsequently, a general-purpose bipolar monolithic op amp, the NE5234, is analyzed, with a focus on how its performance deviates from the ideal. Design strategies for enhancing different aspects of monolithic op-amp low-frequency performance are discussed. The high-frequency and transient response of op amps are covered in Chapters 7 and 9.\n\nimage_name: Figure 6.1 Ideal operational amplifier\ndescription:\n[\nname: A0, type: OpAmp, value: A0, ports: {InP: Vip, InN: Vin, OutP: Vo, OutN: GND}\n]\nextrainfo: The diagram illustrates an ideal operational amplifier with infinite gain (a → ∞). It features a differential input with Vip and Vin, and the output is Vo. The op-amp is grounded at the negative output terminal.\n\nFigure 6.1 Ideal operational amplifier."
},
{
    "text": "In the preceding three chapters, we have examined the key circuit building blocks employed in analog integrated circuits (ICs). The majority of analog ICs are primarily composed of these fundamental circuits, interconnected to execute the intended functions. Despite the nearly endless variety of both standard and specialized custom ICs, certain standard circuits are notable for their extensive application across diverse systems. These include operational amplifiers, voltage regulators, and analog-to-digital (A/D) and digital-to-analog (D/A) converters. In this chapter, we will delve into monolithic operational amplifiers (op amps) with single-ended outputs, both as a demonstration of the application of the previously discussed circuit building blocks and as an introduction to the design and usage of this crucial category of analog circuits. Op amps with fully differential outputs are addressed in Chapter 12, while voltage-regulator circuits are covered in Chapter 8. The design of A/D and D/A converters is not included here, but it entails the application of circuit techniques detailed throughout the book.\n\nAn ideal op amp with a single-ended output features a differential input, infinite voltage gain, infinite input resistance, and zero output resistance. A conceptual schematic diagram is depicted in Fig. 6.1. Although real op amps do not possess these ideal traits, their performance is typically adequate enough that their circuit behavior closely mirrors that of an ideal op amp in most scenarios.\n\nIn op-amp design, bipolar transistors present numerous advantages over CMOS transistors, such as higher transconductance for a given current, higher gain $\\left(g_{m} r_{o}\\right)$, greater speed, lower input-referred offset voltage, and lower input-referred noise voltage. (The subject of noise is explored in Chapter 11.) Consequently, op amps constructed from bipolar transistors often deliver the best performance, particularly in applications like dc-coupled, low-offset, low-drift systems. For these reasons, bipolar op amps were the first to gain commercial significance and generally still provide superior analog performance. However, CMOS technologies have become prevalent in constructing the digital segments of signal-processing systems due to the smaller size and lower power consumption of CMOS digital circuits compared to their bipolar equivalents. Since these systems frequently process signals that originate in analog form, analog circuits such as op amps are necessary to interface with the digital CMOS circuits. To lower system costs and enhance portability, analog and digital circuits are now commonly integrated, creating a strong economic motivation to utilize CMOS op amps.\n\nThis chapter begins by exploring various applications of op amps to highlight their versatility in analog circuit and system design. We then examine CMOS op amps. Following this, a general-purpose bipolar monolithic op amp, the NE5234, is analyzed, and the ways in which its performance deviates from ideality are discussed. Design strategies for enhancing different aspects of monolithic op-amp low-frequency performance are outlined. The high-frequency and transient response of op amps are addressed in Chapters 7 and 9.\n\nimage_name: Figure 6.1 Ideal operational amplifier\ndescription:\n[\nname: A0, type: OpAmp, value: A0, ports: {InP: Vip, InN: Vin, OutP: Vo, OutN: GND}\n]\nextrainfo: The diagram illustrates an ideal operational amplifier with infinite gain (a → ∞). The input is differential with Vip and Vin, and the output is Vo. The op-amp is grounded at the negative output terminal.\n\nFigure 6.1 Ideal operational amplifier."
},
{
    "text": "In the preceding three chapters, the fundamental circuit building blocks employed in analog integrated circuits (ICs) have been examined. The majority of analog ICs are primarily composed of these basic circuits, interconnected to execute the intended function. Despite the nearly limitless variety of both standard and custom ICs designed for specific purposes, certain standard circuits are notable for their extensive application across diverse systems. These include operational amplifiers, voltage regulators, and analog-to-digital (A/D) and digital-to-analog (D/A) converters. This chapter focuses on monolithic operational amplifiers (op amps) with single-ended outputs, serving both as an illustration of the application of the previously discussed circuit building blocks and as an introductory exploration of the design and use of this significant category of analog circuits. Op amps featuring fully differential outputs are addressed in Chapter 12, while voltage-regulator circuits are discussed in Chapter 8. The design of A/D and D/A converters is not included here but relies on the circuit techniques outlined throughout the book.\n\nAn ideal op amp with a single-ended output is characterized by a differential input, infinite voltage gain, infinite input resistance, and zero output resistance. A conceptual schematic diagram is depicted in Fig. 6.1. Although real op amps do not possess these ideal traits, their performance is typically adequate to closely mimic the behavior of an ideal op amp in most scenarios.\n\nIn the design of op amps, bipolar transistors present several advantages over CMOS transistors, such as higher transconductance at a given current, greater gain $\\left(g_{m} r_{o}\\right)$, faster speed, lower input-referred offset voltage, and reduced input-referred noise voltage. (The subject of noise is explored in Chapter 11.) Consequently, bipolar transistor-based op amps often deliver superior performance in various applications, including dc-coupled, low-offset, and low-drift uses. For these reasons, bipolar op amps were the first to gain commercial prominence and generally still provide better analog performance. However, CMOS technology has become the preferred choice for constructing the digital segments of signal-processing systems due to the smaller size and lower power consumption of CMOS digital circuits compared to their bipolar equivalents. Since these systems frequently process signals that originate in analog form, analog components like op amps are necessary to interface with the digital CMOS circuits. To lower system costs and enhance portability, analog and digital circuits are now commonly integrated, creating a strong economic motivation to utilize CMOS op amps.\n\nThis chapter begins by examining various applications of op amps to highlight their versatility in analog circuit and system design. It then proceeds to discuss CMOS op amps. Following this, a general-purpose bipolar monolithic op amp, the NE5234, is analyzed, with an explanation of how its performance deviates from the ideal. The chapter also covers design considerations aimed at enhancing different aspects of monolithic op-amp low-frequency performance. The high-frequency and transient response characteristics of op amps are addressed in Chapters 7 and 9.\n\nimage_name: Figure 6.1 Ideal operational amplifier\ndescription:\n[\nname: A0, type: OpAmp, value: A0, ports: {InP: Vip, InN: Vin, OutP: Vo, OutN: GND}\n]\nextrainfo: The diagram illustrates an ideal operational amplifier with infinite gain (a → ∞). It features a differential input with Vip and Vin, and the output is Vo. The op-amp is grounded at the negative output terminal.\n\nFigure 6.1 Ideal operational amplifier."
},
{
    "text": "Nearly all operational amplifier applications are grounded in the principles of feedback. Detailed coverage of feedback amplifiers is found in Chapter 8; here, we delve into some fundamental concepts essential for comprehending op-amp circuits. Figure 6.2 illustrates a generalized feedback amplifier. The block marked $a$ represents the forward or basic amplifier, while the block marked $f$ denotes the feedback network. The gain of the basic amplifier without the feedback network is termed the open-loop gain, $a$. The feedback network's role is to detect the output signal $S_{o}$ and generate a feedback signal $S_{f b}$, which equals $f S_{o}$, where $f$ is typically less than one. This feedback signal is subtracted from the input signal $S_{i}$, and the resultant difference $S_{\\epsilon}$ is fed to the basic amplifier. The system's gain with the feedback network in place is known as the closed-loop gain. For the basic amplifier, we have\n\n$$\n\\begin{equation*}\nS_{o}=a S_{\\epsilon}=a\\left(S_{i}-S_{f b}\\right)=a\\left(S_{i}-f S_{o}\\right) \\tag{6.1}\n\\end{equation*}\n$$\n\nand therefore\n\n$$\n\\begin{equation*}\n\\frac{S_{o}}{S_{i}}=\\frac{a}{1+a f}=\\frac{1}{f}\\left(\\frac{a f}{1+a f}\\right)=\\frac{1}{f}\\left(\\frac{T}{1+T}\\right) \\tag{6.2}\n\\end{equation*}\n$$\n\nwhere $T=a f$ is referred to as the loop gain. When $T$ is significantly larger than unity, the closed-loop gain becomes\n\n$$\n\\begin{equation*}\n\\lim _{T \\rightarrow \\infty} \\frac{S_{o}}{S_{i}}=\\frac{1}{f} \\tag{6.3}\n\\end{equation*}\n$$\n\nimage_name:Figure 6.2 A conceptual feedback amplifier\ndescription:The block diagram labeled \"Figure 6.2 A conceptual feedback amplifier\" depicts a feedback amplifier system. It includes the following primary components and information flow:\n\n1. **Main Components:**\n- **Amplifier Block (a):** This block symbolizes the main amplifier with an open-loop gain 'a'. It boosts the input error signal \\( S_\\epsilon \\) to produce the output signal \\( S_o \\).\n- **Feedback Network (f):** This block stands for the feedback network with a feedback factor 'f'. It processes the output signal \\( S_o \\) to create the feedback signal \\( S_{fb} \\).\n- **Summing Junction:** This junction calculates the error signal \\( S_\\epsilon \\) by subtracting the feedback signal \\( S_{fb} \\) from the input signal \\( S_i \\).\n\n2. **Flow of Information or Control:**\n- The input signal \\( S_i \\) enters the system and heads to the summing junction.\n- The summing junction determines the error signal \\( S_\\epsilon = S_i - S_{fb} \\).\n- The error signal \\( S_\\epsilon \\) is then input into the amplifier block 'a', which amplifies it to yield the output signal \\( S_o \\).\n- The output signal \\( S_o \\) is split; one path goes to the final output, while the other feeds back into the feedback network 'f'.\n- The feedback network processes \\( S_o \\) to produce the feedback signal \\( S_{fb} = f \\times S_o \\), which loops back to the summing junction.\n\n3. **Labels, Annotations, and Key Indicators:**\n- The diagram features labels for each signal and block, such as \\( S_i \\) for input, \\( S_o \\) for output, \\( S_\\epsilon \\) for error signal, and \\( S_{fb} \\) for feedback signal.\n- The amplifier's gain is indicated by 'a', and the feedback factor is denoted by 'f'.\n\n4. **Overall System Function:**\n- The main function of this feedback amplifier system is to regulate the gain and stability of the amplifier output. By employing feedback, the system can achieve a closed-loop gain that is largely unaffected by the open-loop gain 'a', particularly when the loop gain \\( T = a \\times f \\) is much greater than 1. This setup allows the system to maintain a stable and precise gain of \\( 1/f \\), making it resilient to variations in the amplifier's open-loop characteristics. This concept is fundamental in operational amplifier design and application.\n\nFigure 6.2 A conceptual feedback amplifier.\n\nGiven that the feedback network comprises passive components, the value of $f$ can be precisely set, establishing the gain at $1 / f$ if $T \\gg 1$, regardless of any fluctuations in the open-loop gain $a$. This independence of closed-loop performance from the active amplifier's parameters is the key reason for the widespread use of op amps as active elements in analog circuits.\n\nIn the circuit depicted in Fig. 6.2, the feedback signal tends to decrease the magnitude of $S_{\\epsilon}$ compared to the open-loop scenario (where $f=0$) when $a$ and $f$ share the same sign. This situation is known as negative feedback and is the focus of practical interest in this chapter.\n\nWith this concise introduction to feedback principles, we move on to examining several examples of useful op-amp configurations. These example circuits are straightforward, making direct analysis with Kirchoff's laws more feasible than treating them as feedback amplifiers. In Chapter 8, more complex feedback configurations are explored, where employing feedback concepts as an analytical tool is more beneficial than in these simpler examples."
},
{
    "text": "Nearly all operational amplifier applications are based on the principles of feedback. The subject of feedback amplifiers is thoroughly explored in Chapter 8; here, we examine a few fundamental concepts essential for understanding op-amp circuits. A generalized feedback amplifier is depicted in Fig. 6.2. The block marked $a$ is termed the forward or basic amplifier, while the block marked $f$ is known as the feedback network. The gain of the basic amplifier in the absence of the feedback network is referred to as the open-loop gain, $a$, of the amplifier. The role of the feedback network is to detect the output signal $S_{o}$ and generate a feedback signal $S_{f b}$, which equals $f S_{o}$, where $f$ is typically less than unity. This feedback signal is subtracted from the input signal $S_{i}$, and the resulting difference $S_{\\epsilon}$ is fed to the basic amplifier. The gain of the system when the feedback network is active is termed the closed-loop gain. For the basic amplifier, we have\n\n$$\n\\begin{equation*}\nS_{o}=a S_{\\epsilon}=a\\left(S_{i}-S_{f b}\\right)=a\\left(S_{i}-f S_{o}\\right) \\tag{6.1}\n\\end{equation*}\n$$\n\nand consequently\n\n$$\n\\begin{equation*}\n\\frac{S_{o}}{S_{i}}=\\frac{a}{1+a f}=\\frac{1}{f}\\left(\\frac{a f}{1+a f}\\right)=\\frac{1}{f}\\left(\\frac{T}{1+T}\\right) \\tag{6.2}\n\\end{equation*}\n$$\n\nwhere $T=a f$ is known as the loop gain. When $T$ becomes significantly larger than unity, the closed-loop gain simplifies to\n\n$$\n\\begin{equation*}\n\\lim _{T \\rightarrow \\infty} \\frac{S_{o}}{S_{i}}=\\frac{1}{f} \\tag{6.3}\n\\end{equation*}\n$$\n\nimage_name:Figure 6.2 A conceptual feedback amplifier\ndescription:The system block diagram, labeled \"Figure 6.2 A conceptual feedback amplifier,\" illustrates a feedback amplifier system. It comprises the following primary components and information flow:\n\n1. **Main Components:**\n- **Amplifier Block (a):** This block represents the main amplifier with an open-loop gain denoted by 'a'. It amplifies the input error signal \\( S_\\epsilon \\) to produce the output signal \\( S_o \\).\n- **Feedback Network (f):** This block represents the feedback network with a feedback factor 'f'. It processes the output signal \\( S_o \\) to generate the feedback signal \\( S_{fb} \\).\n- **Summing Junction:** This junction calculates the error signal \\( S_\\epsilon \\) by subtracting the feedback signal \\( S_{fb} \\) from the input signal \\( S_i \\).\n\n2. **Flow of Information or Control:**\n- The input signal \\( S_i \\) enters the system and is directed to the summing junction.\n- The summing junction computes the error signal \\( S_\\epsilon = S_i - S_{fb} \\).\n- The error signal \\( S_\\epsilon \\) is then fed into the amplifier block 'a', which amplifies it to produce the output signal \\( S_o \\).\n- The output signal \\( S_o \\) splits; one path leads to the final output, while the other is fed back into the feedback network 'f'.\n- The feedback network processes \\( S_o \\) to produce the feedback signal \\( S_{fb} = f \\times S_o \\), which is looped back to the summing junction.\n\n3. **Labels, Annotations, and Key Indicators:**\n- The diagram includes labels for each signal and block, such as \\( S_i \\) for input, \\( S_o \\) for output, \\( S_\\epsilon \\) for error signal, and \\( S_{fb} \\) for feedback signal.\n- The amplifier gain is denoted by 'a', and the feedback factor is represented by 'f'.\n\n4. **Overall System Function:**\n- The primary function of this feedback amplifier system is to regulate the gain and stability of the amplifier output. By employing feedback, the system can achieve a closed-loop gain that is largely independent of the open-loop gain 'a', especially when the loop gain \\( T = a \\times f \\) is much greater than 1. This configuration allows the system to maintain a stable and precise gain of \\( 1/f \\), making it robust against variations in the amplifier's open-loop characteristics. This is a fundamental concept in operational amplifier design and application.\n\nFigure 6.2 A conceptual feedback amplifier.\n\nSince the feedback network consists of passive components, the value of $f$ can be set with high precision and will determine the gain at a value of $1 / f$ if $T \\gg 1$, regardless of any variations in the open-loop gain $a$. This independence of closed-loop performance from the active amplifier's parameters is the key reason for the widespread use of op amps as active elements in analog circuits.\n\nFor the circuit shown in Fig. 6.2, the feedback signal tends to decrease the magnitude of $S_{\\epsilon}$ compared to the open-loop case (where $f=0$) when $a$ and $f$ have the same sign. This scenario is known as negative feedback and is the focus of practical interest in this chapter.\n\nWith this brief introduction to feedback concepts, we move on to examining several examples of useful op-amp configurations. Because these example circuits are straightforward, direct analysis using Kirchoff's laws is more manageable than treating them as feedback amplifiers. In Chapter 8, more complex feedback configurations are discussed, where the application of feedback concepts as an analytical tool is more beneficial than in these simpler examples."
},
{
    "text": "Nearly all operational amplifier applications are based on feedback principles. Detailed coverage of feedback amplifiers is provided in Chapter 8; here, we discuss a few fundamental concepts essential for understanding op-amp circuits. A generalized feedback amplifier is illustrated in Fig. 6.2. The block marked $a$ represents the forward or basic amplifier, while the block marked $f$ is the feedback network. The gain of the basic amplifier without the feedback network is termed the open-loop gain, $a$. The feedback network's role is to detect the output signal $S_{o}$ and produce a feedback signal $S_{f b}$, which equals $f S_{o}$, with $f$ typically less than one. This feedback signal is subtracted from the input signal $S_{i}$, and the resultant difference $S_{\\epsilon}$ is fed to the basic amplifier. The system's gain with the feedback network present is known as the closed-loop gain. For the basic amplifier, we have\n\n$$\n\\begin{equation*}\nS_{o}=a S_{\\epsilon}=a\\left(S_{i}-S_{f b}\\right)=a\\left(S_{i}-f S_{o}\\right) \\tag{6.1}\n\\end{equation*}\n$$\n\nand therefore\n\n$$\n\\begin{equation*}\n\\frac{S_{o}}{S_{i}}=\\frac{a}{1+a f}=\\frac{1}{f}\\left(\\frac{a f}{1+a f}\\right)=\\frac{1}{f}\\left(\\frac{T}{1+T}\\right) \\tag{6.2}\n\\end{equation*}\n$$\n\nwhere $T=a f$ is referred to as the loop gain. When $T$ is significantly larger than one, the closed-loop gain becomes\n\n$$\n\\begin{equation*}\n\\lim _{T \\rightarrow \\infty} \\frac{S_{o}}{S_{i}}=\\frac{1}{f} \\tag{6.3}\n\\end{equation*}\n$$\n\nimage_name:Figure 6.2 A conceptual feedback amplifier\ndescription:The system block diagram, labeled \"Figure 6.2 A conceptual feedback amplifier,\" depicts a feedback amplifier system. It includes the following primary components and information flow:\n\n1. **Main Components:**\n- **Amplifier Block (a):** This block signifies the main amplifier with an open-loop gain 'a'. It amplifies the input error signal \\( S_\\epsilon \\) to generate the output signal \\( S_o \\).\n- **Feedback Network (f):** This block denotes the feedback network with a feedback factor 'f'. It processes the output signal \\( S_o \\) to create the feedback signal \\( S_{fb} \\).\n- **Summing Junction:** This junction calculates the error signal \\( S_\\epsilon \\) by subtracting the feedback signal \\( S_{fb} \\) from the input signal \\( S_i \\).\n\n2. **Flow of Information or Control:**\n- The input signal \\( S_i \\) enters the system and is directed to the summing junction.\n- The summing junction computes the error signal \\( S_\\epsilon = S_i - S_{fb} \\).\n- The error signal \\( S_\\epsilon \\) is then input to the amplifier block 'a', which amplifies it to produce the output signal \\( S_o \\).\n- The output signal \\( S_o \\) splits; one path goes to the final output, while the other feeds back into the feedback network 'f'.\n- The feedback network processes \\( S_o \\) to produce the feedback signal \\( S_{fb} = f \\times S_o \\), which is returned to the summing junction.\n\n3. **Labels, Annotations, and Key Indicators:**\n- The diagram includes labels for each signal and block, such as \\( S_i \\) for input, \\( S_o \\) for output, \\( S_\\epsilon \\) for error signal, and \\( S_{fb} \\) for feedback signal.\n- The amplifier gain is denoted by 'a', and the feedback factor is indicated by 'f'.\n\n4. **Overall System Function:**\n- The main function of this feedback amplifier system is to regulate the gain and stability of the amplifier output. By employing feedback, the system can achieve a closed-loop gain that is largely independent of the open-loop gain 'a', particularly when the loop gain \\( T = a \\times f \\) is much greater than 1. This setup enables the system to maintain a stable and precise gain of \\( 1/f \\), making it resilient to variations in the amplifier's open-loop characteristics. This is a key concept in operational amplifier design and application.\n\nFigure 6.2 A conceptual feedback amplifier.\n\nSince the feedback network comprises passive components, the value of $f$ can be precisely set, establishing the gain at $1 / f$ if $T \\gg 1$, regardless of variations in the open-loop gain $a$. This independence of closed-loop performance from the active amplifier's parameters is the primary reason for the widespread use of op amps in analog circuits.\n\nFor the circuit depicted in Fig. 6.2, the feedback signal tends to decrease the magnitude of $S_{\\epsilon}$ compared to the open-loop case (where $f=0$) when $a$ and $f$ have the same sign. This scenario is known as negative feedback and is the focus of practical interest in this chapter.\n\nWith this concise introduction to feedback concepts, we move on to examining several examples of useful op-amp configurations. Because these example circuits are straightforward, direct analysis using Kirchoff's laws is more feasible than treating them as feedback amplifiers. In Chapter 8, more complex feedback configurations are explored, where the application of feedback concepts as an analytical tool is more beneficial than in these simpler examples."
},
{
    "text": "Nearly all operational amplifier applications are based on the principles of feedback. The subject of feedback amplifiers is extensively discussed in Chapter 8; here, we examine a few fundamental concepts essential for comprehending op-amp circuits. A generalized feedback amplifier is illustrated in Fig. 6.2. The block designated as $a$ is termed the forward or basic amplifier, while the block labeled $f$ is known as the feedback network. The gain of the basic amplifier in the absence of the feedback network is referred to as the open-loop gain, $a$, of the amplifier. The role of the feedback network is to detect the output signal $S_{o}$ and produce a feedback signal $S_{f b}$, which equals $f S_{o}$, where $f$ is typically less than unity. This feedback signal is subtracted from the input signal $S_{i}$, and the resultant difference $S_{\\epsilon}$ is applied to the basic amplifier. The gain of the system when the feedback network is present is termed the closed-loop gain. For the basic amplifier, we have\n\n$$\n\\begin{equation*}\nS_{o}=a S_{\\epsilon}=a\\left(S_{i}-S_{f b}\\right)=a\\left(S_{i}-f S_{o}\\right) \\tag{6.1}\n\\end{equation*}\n$$\n\nand consequently\n\n$$\n\\begin{equation*}\n\\frac{S_{o}}{S_{i}}=\\frac{a}{1+a f}=\\frac{1}{f}\\left(\\frac{a f}{1+a f}\\right)=\\frac{1}{f}\\left(\\frac{T}{1+T}\\right) \\tag{6.2}\n\\end{equation*}\n$$\n\nwhere $T=a f$ is known as the loop gain. When $T$ becomes significantly larger than unity, the closed-loop gain simplifies to\n\n$$\n\\begin{equation*}\n\\lim _{T \\rightarrow \\infty} \\frac{S_{o}}{S_{i}}=\\frac{1}{f} \\tag{6.3}\n\\end{equation*}\n$$\n\nimage_name:Figure 6.2 A conceptual feedback amplifier\ndescription:The system block diagram, labeled \"Figure 6.2 A conceptual feedback amplifier,\" depicts a feedback amplifier system. It includes the following primary components and information flow:\n\n1. **Main Components:**\n- **Amplifier Block (a):** This block represents the main amplifier with an open-loop gain denoted by 'a'. It amplifies the input error signal \\( S_\\epsilon \\) to generate the output signal \\( S_o \\).\n- **Feedback Network (f):** This block symbolizes the feedback network with a feedback factor 'f'. It processes the output signal \\( S_o \\) to produce the feedback signal \\( S_{fb} \\).\n- **Summing Junction:** A junction that calculates the error signal \\( S_\\epsilon \\) by subtracting the feedback signal \\( S_{fb} \\) from the input signal \\( S_i \\).\n\n2. **Flow of Information or Control:**\n- The input signal \\( S_i \\) enters the system and is directed to the summing junction.\n- The summing junction computes the error signal \\( S_\\epsilon = S_i - S_{fb} \\).\n- The error signal \\( S_\\epsilon \\) is then input to the amplifier block 'a', which amplifies it to yield the output signal \\( S_o \\).\n- The output signal \\( S_o \\) is split; one path leads to the final output, while the other is fed back into the feedback network 'f'.\n- The feedback network processes \\( S_o \\) to create the feedback signal \\( S_{fb} = f \\times S_o \\), which is then looped back to the summing junction.\n\n3. **Labels, Annotations, and Key Indicators:**\n- The diagram includes labels for each signal and block, such as \\( S_i \\) for input, \\( S_o \\) for output, \\( S_\\epsilon \\) for error signal, and \\( S_{fb} \\) for feedback signal.\n- The amplifier gain is denoted by 'a', and the feedback factor is indicated by 'f'.\n\n4. **Overall System Function:**\n- The main function of this feedback amplifier system is to control the gain and stability of the amplifier output. By employing feedback, the system can achieve a closed-loop gain that is largely independent of the open-loop gain 'a', particularly when the loop gain \\( T = a \\times f \\) is much greater than 1. This setup allows the system to maintain a stable and precise gain of \\( 1/f \\), making it resilient to variations in the amplifier's open-loop characteristics. This concept is fundamental in operational amplifier design and application.\n\nFigure 6.2 A conceptual feedback amplifier.\n\nSince the feedback network comprises passive components, the value of $f$ can be precisely set, establishing the gain at $1 / f$ if $T \\gg 1$, regardless of variations in the open-loop gain $a$. This independence of closed-loop performance from the active amplifier's parameters is the key reason for the widespread use of op amps as active elements in analog circuits.\n\nFor the circuit depicted in Fig. 6.2, the feedback signal tends to decrease the magnitude of $S_{\\epsilon}$ compared to the open-loop scenario (where $f=0$) when $a$ and $f$ have the same sign. This scenario is known as negative feedback and is the focus of practical interest in this chapter.\n\nWith this concise introduction to feedback concepts, we move on to examining several examples of practical op-amp configurations. Because these example circuits are straightforward, direct analysis using Kirchoff's laws is more feasible than treating them as feedback amplifiers. In Chapter 8, more complex feedback configurations are explored where the application of feedback concepts as an analytical tool is more beneficial than in these simpler examples."
},
{
    "text": "Nearly all operational amplifier applications are grounded in the principles of feedback. Detailed coverage of feedback amplifiers is provided in Chapter 8; here, we delve into some fundamental concepts essential for grasping op-amp circuitry. A generalized feedback amplifier is depicted in Fig. 6.2. The block designated as $a$ is termed the forward or basic amplifier, while the block labeled $f$ is known as the feedback network. The gain of the basic amplifier in the absence of the feedback network is referred to as the open-loop gain, $a$. The role of the feedback network is to detect the output signal $S_{o}$ and produce a feedback signal $S_{f b}$, which equals $f S_{o}$, with $f$ typically being less than one. This feedback signal is subtracted from the input signal $S_{i}$, and the resultant difference $S_{\\epsilon}$ is fed to the basic amplifier. The system's gain when the feedback network is active is termed the closed-loop gain. For the basic amplifier, we have\n\n$$\n\\begin{equation*}\nS_{o}=a S_{\\epsilon}=a\\left(S_{i}-S_{f b}\\right)=a\\left(S_{i}-f S_{o}\\right) \\tag{6.1}\n\\end{equation*}\n$$\n\nand consequently\n\n$$\n\\begin{equation*}\n\\frac{S_{o}}{S_{i}}=\\frac{a}{1+a f}=\\frac{1}{f}\\left(\\frac{a f}{1+a f}\\right)=\\frac{1}{f}\\left(\\frac{T}{1+T}\\right) \\tag{6.2}\n\\end{equation*}\n$$\n\nwhere $T=a f$ is known as the loop gain. When $T$ is significantly larger than unity, the closed-loop gain simplifies to\n\n$$\n\\begin{equation*}\n\\lim _{T \\rightarrow \\infty} \\frac{S_{o}}{S_{i}}=\\frac{1}{f} \\tag{6.3}\n\\end{equation*}\n$$\n\nimage_name:Figure 6.2 A conceptual feedback amplifier\ndescription:The system block diagram, labeled \"Figure 6.2 A conceptual feedback amplifier,\" illustrates a feedback amplifier system. It comprises the following primary components and information flow:\n\n1. **Main Components:**\n- **Amplifier Block (a):** This block represents the core amplifier with an open-loop gain denoted by 'a'. It amplifies the input error signal \\( S_\\epsilon \\) to generate the output signal \\( S_o \\).\n- **Feedback Network (f):** This block symbolizes the feedback network with a feedback factor 'f'. It processes the output signal \\( S_o \\) to create the feedback signal \\( S_{fb} \\).\n- **Summing Junction:** This junction calculates the error signal \\( S_\\epsilon \\) by subtracting the feedback signal \\( S_{fb} \\) from the input signal \\( S_i \\).\n\n2. **Flow of Information or Control:**\n- The input signal \\( S_i \\) enters the system and is directed to the summing junction.\n- The summing junction computes the error signal \\( S_\\epsilon = S_i - S_{fb} \\).\n- The error signal \\( S_\\epsilon \\) is then input into the amplifier block 'a', which amplifies it to produce the output signal \\( S_o \\).\n- The output signal \\( S_o \\) is split; one path leads to the final output, while the other is fed back into the feedback network 'f'.\n- The feedback network processes \\( S_o \\) to generate the feedback signal \\( S_{fb} = f \\times S_o \\), which is looped back to the summing junction.\n\n3. **Labels, Annotations, and Key Indicators:**\n- The diagram includes labels for each signal and block, such as \\( S_i \\) for input, \\( S_o \\) for output, \\( S_\\epsilon \\) for error signal, and \\( S_{fb} \\) for feedback signal.\n- The gain of the amplifier is indicated by 'a', and the feedback factor is denoted by 'f'.\n\n4. **Overall System Function:**\n- The primary role of this feedback amplifier system is to control the gain and stability of the amplifier output. By employing feedback, the system can achieve a closed-loop gain that is largely unaffected by the open-loop gain 'a', particularly when the loop gain \\( T = a \\times f \\) is much greater than 1. This setup enables the system to maintain a stable and precise gain of \\( 1/f \\), making it resilient to variations in the amplifier's open-loop characteristics. This is a fundamental concept in operational amplifier design and application.\n\nFigure 6.2 A conceptual feedback amplifier.\n\nGiven that the feedback network consists of passive components, the value of $f$ can be precisely set, establishing the gain at $1 / f$ if $T \\gg 1$, regardless of any fluctuations in the open-loop gain $a$. This independence of closed-loop performance from the active amplifier's parameters is the key reason for the widespread use of op amps as active elements in analog circuits.\n\nIn the circuit shown in Fig. 6.2, the feedback signal tends to decrease the magnitude of $S_{\\epsilon}$ compared to the open-loop scenario (where $f=0$) when $a$ and $f$ share the same sign. This situation is termed negative feedback and is the focus of practical interest in this chapter.\n\nWith this concise introduction to feedback principles, we move on to examining several illustrative op-amp configurations. Due to their simplicity, direct analysis using Kirchoff's laws is more straightforward than treating them as feedback amplifiers. In Chapter 8, more complex feedback configurations are explored, where the application of feedback concepts as an analytical tool is more beneficial than in these simpler examples."
},
{
    "text": "Nearly all operational amplifier applications are based on feedback principles. Detailed coverage of feedback amplifiers is found in Chapter 8; here, we discuss some fundamental concepts essential for grasping op-amp circuits. A typical feedback amplifier is illustrated in Fig. 6.2. The block marked $a$ represents the forward or basic amplifier, while the block marked $f$ denotes the feedback network. The gain of the basic amplifier without the feedback network is termed the open-loop gain, $a$. The role of the feedback network is to detect the output signal $S_{o}$ and produce a feedback signal $S_{f b}$, which equals $f S_{o}$, with $f$ typically less than one. This feedback signal is subtracted from the input signal $S_{i}$, and the resulting difference $S_{\\epsilon}$ is fed to the basic amplifier. The system's gain with the feedback network in place is known as the closed-loop gain. For the basic amplifier, we have\n\n$$\n\\begin{equation*}\nS_{o}=a S_{\\epsilon}=a\\left(S_{i}-S_{f b}\\right)=a\\left(S_{i}-f S_{o}\\right) \\tag{6.1}\n\\end{equation*}\n$$\n\nleading to\n\n$$\n\\begin{equation*}\n\\frac{S_{o}}{S_{i}}=\\frac{a}{1+a f}=\\frac{1}{f}\\left(\\frac{a f}{1+a f}\\right)=\\frac{1}{f}\\left(\\frac{T}{1+T}\\right) \\tag{6.2}\n\\end{equation*}\n$$\n\nwhere $T=a f$ is termed the loop gain. When $T$ is significantly larger than one, the closed-loop gain simplifies to\n\n$$\n\\begin{equation*}\n\\lim _{T \\rightarrow \\infty} \\frac{S_{o}}{S_{i}}=\\frac{1}{f} \\tag{6.3}\n\\end{equation*}\n$$\n\nimage_name:Figure 6.2 A conceptual feedback amplifier\ndescription:The block diagram labeled \"Figure 6.2 A conceptual feedback amplifier\" depicts a feedback amplifier system. It includes the following key components and information flow:\n\n1. **Main Components:**\n- **Amplifier Block (a):** This block signifies the primary amplifier with an open-loop gain 'a', which amplifies the input error signal \\( S_\\epsilon \\) to generate the output signal \\( S_o \\).\n- **Feedback Network (f):** This block represents the feedback network with a feedback factor 'f', processing the output signal \\( S_o \\) to create the feedback signal \\( S_{fb} \\).\n- **Summing Junction:** This junction calculates the error signal \\( S_\\epsilon \\) by subtracting the feedback signal \\( S_{fb} \\) from the input signal \\( S_i \\).\n\n2. **Flow of Information or Control:**\n- The input signal \\( S_i \\) enters and is directed to the summing junction.\n- The summing junction computes the error signal \\( S_\\epsilon = S_i - S_{fb} \\).\n- The error signal \\( S_\\epsilon \\) is then input to the amplifier block 'a', which amplifies it to produce the output signal \\( S_o \\).\n- The output signal \\( S_o \\) splits; one path leads to the final output, and the other feeds back into the feedback network 'f'.\n- The feedback network processes \\( S_o \\) to produce the feedback signal \\( S_{fb} = f \\times S_o \\), which is returned to the summing junction.\n\n3. **Labels, Annotations, and Key Indicators:**\n- The diagram includes labels for each signal and block, such as \\( S_i \\) for input, \\( S_o \\) for output, \\( S_\\epsilon \\) for error signal, and \\( S_{fb} \\) for feedback signal.\n- The amplifier gain is denoted by 'a', and the feedback factor is indicated by 'f'.\n\n4. **Overall System Function:**\n- The main function of this feedback amplifier system is to control the gain and stability of the amplifier output. By employing feedback, the system can achieve a closed-loop gain that is largely unaffected by the open-loop gain 'a', particularly when the loop gain \\( T = a \\times f \\) is much greater than 1. This setup allows the system to maintain a stable and precise gain of \\( 1/f \\), making it resilient to changes in the amplifier's open-loop characteristics. This principle is fundamental in operational amplifier design and application.\n\nFigure 6.2 A conceptual feedback amplifier.\n\nSince the feedback network comprises passive components, the value of $f$ can be precisely set, ensuring the gain is $1 / f$ when $T \\gg 1$, regardless of variations in the open-loop gain $a$. This independence of closed-loop performance from the active amplifier's parameters is a key reason for the widespread use of op amps in analog circuits.\n\nIn the circuit shown in Fig. 6.2, the feedback signal generally reduces the magnitude of $S_{\\epsilon}$ compared to the open-loop scenario (where $f=0$) when $a$ and $f$ share the same sign. This situation is known as negative feedback and is the focus of this chapter.\n\nWith this concise introduction to feedback concepts, we move on to examining several practical op-amp configurations. These example circuits are straightforward, making direct analysis using Kirchoff's laws more feasible than treating them as feedback amplifiers. In Chapter 8, more complex feedback configurations are explored, where applying feedback concepts as an analytical tool is more beneficial than in these simpler examples."
},
{
    "text": "Nearly all operational amplifier applications are based on the principles of feedback. The subject of feedback amplifiers is thoroughly explored in Chapter 8; here, we discuss a few fundamental concepts essential for understanding op-amp circuits. A generalized feedback amplifier is illustrated in Fig. 6.2. The block designated as $a$ is referred to as the forward or basic amplifier, while the block labeled $f$ is known as the feedback network. The gain of the basic amplifier in the absence of the feedback network is termed the open-loop gain, $a$. The role of the feedback network is to detect the output signal $S_{o}$ and produce a feedback signal $S_{f b}$, which equals $f S_{o}$, with $f$ typically being less than unity. This feedback signal is subtracted from the input signal $S_{i}$, and the resulting difference $S_{\\epsilon}$ is fed to the basic amplifier. The gain of the system with the feedback network in place is known as the closed-loop gain. For the basic amplifier, we have\n\n$$\n\\begin{equation*}\nS_{o}=a S_{\\epsilon}=a\\left(S_{i}-S_{f b}\\right)=a\\left(S_{i}-f S_{o}\\right) \\tag{6.1}\n\\end{equation*}\n$$\n\nand therefore\n\n$$\n\\begin{equation*}\n\\frac{S_{o}}{S_{i}}=\\frac{a}{1+a f}=\\frac{1}{f}\\left(\\frac{a f}{1+a f}\\right)=\\frac{1}{f}\\left(\\frac{T}{1+T}\\right) \\tag{6.2}\n\\end{equation*}\n$$\n\nwhere $T=a f$ is referred to as the loop gain. When $T$ is significantly larger than unity, the closed-loop gain becomes\n\n$$\n\\begin{equation*}\n\\lim _{T \\rightarrow \\infty} \\frac{S_{o}}{S_{i}}=\\frac{1}{f} \\tag{6.3}\n\\end{equation*}\n$$\n\nimage_name:Figure 6.2 A conceptual feedback amplifier\ndescription:The system block diagram, labeled as \"Figure 6.2 A conceptual feedback amplifier,\" depicts a feedback amplifier system. It includes the following main components and the flow of information:\n\n1. **Main Components:**\n- **Amplifier Block (a):** This block represents the main amplifier with an open-loop gain denoted by 'a'. It amplifies the input error signal \\( S_\\epsilon \\) to generate the output signal \\( S_o \\).\n- **Feedback Network (f):** This block symbolizes the feedback network with a feedback factor 'f'. It processes the output signal \\( S_o \\) to produce the feedback signal \\( S_{fb} \\).\n- **Summing Junction:** A summing junction calculates the error signal \\( S_\\epsilon \\) by subtracting the feedback signal \\( S_{fb} \\) from the input signal \\( S_i \\).\n\n2. **Flow of Information or Control:**\n- The input signal \\( S_i \\) enters the system and is directed to the summing junction.\n- The summing junction computes the error signal \\( S_\\epsilon = S_i - S_{fb} \\).\n- The error signal \\( S_\\epsilon \\) is then input to the amplifier block 'a', which amplifies it to yield the output signal \\( S_o \\).\n- The output signal \\( S_o \\) is split; one path leads to the final output, while the other is fed back into the feedback network 'f'.\n- The feedback network processes \\( S_o \\) to create the feedback signal \\( S_{fb} = f \\times S_o \\), which is looped back to the summing junction.\n\n3. **Labels, Annotations, and Key Indicators:**\n- The diagram includes labels for each signal and block, such as \\( S_i \\) for input, \\( S_o \\) for output, \\( S_\\epsilon \\) for error signal, and \\( S_{fb} \\) for feedback signal.\n- The gain of the amplifier is indicated by 'a', and the feedback factor is denoted by 'f'.\n\n4. **Overall System Function:**\n- The primary function of this feedback amplifier system is to control the gain and stability of the amplifier output. By employing feedback, the system can achieve a closed-loop gain that is largely independent of the open-loop gain 'a', particularly when the loop gain \\( T = a \\times f \\) is much greater than 1. This setup enables the system to maintain a stable and precise gain of \\( 1/f \\), making it resilient to variations in the amplifier's open-loop characteristics. This is a fundamental concept in operational amplifier design and application.\n\nFigure 6.2 A conceptual feedback amplifier.\n\nSince the feedback network comprises passive components, the value of $f$ can be precisely set, establishing the gain at $1 / f$ if $T \\gg 1$, regardless of any variations in the open-loop gain $a$. This independence of closed-loop performance from the active amplifier's parameters is the key reason for the widespread use of op amps as active elements in analog circuits.\n\nFor the circuit depicted in Fig. 6.2, the feedback signal tends to decrease the magnitude of $S_{\\epsilon}$ compared to the open-loop case (where $f=0$) when $a$ and $f$ have the same sign. This scenario is known as negative feedback and is the focus of practical interest in this chapter.\n\nWith this concise introduction to feedback concepts, we move on to examining several examples of useful op-amp configurations. Because these example circuits are straightforward, direct analysis using Kirchoff's laws is more feasible than treating them as feedback amplifiers. In Chapter 8, more complex feedback configurations are discussed, where the application of feedback concepts as an analytical tool is more beneficial than in these simpler examples."
},
{
    "text": "Nearly all operational amplifier applications are based on feedback principles. The subject of feedback amplifiers is extensively discussed in Chapter 8; here, we examine a few fundamental concepts essential for grasping op-amp circuitry. A typical feedback amplifier is illustrated in Fig. 6.2. The block designated as $a$ represents the forward or basic amplifier, while the block labeled $f$ denotes the feedback network. The gain of the basic amplifier in the absence of the feedback network is termed the open-loop gain, $a$. The role of the feedback network is to detect the output signal $S_{o}$ and generate a feedback signal $S_{f b}$, which equals $f S_{o}$, with $f$ typically being less than one. This feedback signal is subtracted from the input signal $S_{i}$, and the resulting difference $S_{\\epsilon}$ is fed to the basic amplifier. The system's gain when the feedback network is active is known as the closed-loop gain. For the basic amplifier, we have\n\n$$\n\\begin{equation*}\nS_{o}=a S_{\\epsilon}=a\\left(S_{i}-S_{f b}\\right)=a\\left(S_{i}-f S_{o}\\right) \\tag{6.1}\n\\end{equation*}\n$$\n\nand therefore\n\n$$\n\\begin{equation*}\n\\frac{S_{o}}{S_{i}}=\\frac{a}{1+a f}=\\frac{1}{f}\\left(\\frac{a f}{1+a f}\\right)=\\frac{1}{f}\\left(\\frac{T}{1+T}\\right) \\tag{6.2}\n\\end{equation*}\n$$\n\nwhere $T=a f$ is referred to as the loop gain. When $T$ is significantly larger than one, the closed-loop gain simplifies to\n\n$$\n\\begin{equation*}\n\\lim _{T \\rightarrow \\infty} \\frac{S_{o}}{S_{i}}=\\frac{1}{f} \\tag{6.3}\n\\end{equation*}\n$$\n\nimage_name:Figure 6.2 A conceptual feedback amplifier\ndescription:The system block diagram, labeled as \"Figure 6.2 A conceptual feedback amplifier,\" depicts a feedback amplifier system. It comprises the following main components and information flow:\n\n1. **Main Components:**\n- **Amplifier Block (a):** This block symbolizes the primary amplifier with an open-loop gain denoted by 'a'. It amplifies the input error signal \\( S_\\epsilon \\) to generate the output signal \\( S_o \\).\n- **Feedback Network (f):** This block represents the feedback network with a feedback factor 'f'. It processes the output signal \\( S_o \\) to produce the feedback signal \\( S_{fb} \\).\n- **Summing Junction:** A junction that calculates the error signal \\( S_\\epsilon \\) by subtracting the feedback signal \\( S_{fb} \\) from the input signal \\( S_i \\).\n\n2. **Flow of Information or Control:**\n- The input signal \\( S_i \\) enters the system and is directed to the summing junction.\n- The summing junction computes the error signal \\( S_\\epsilon = S_i - S_{fb} \\).\n- The error signal \\( S_\\epsilon \\) is then input into the amplifier block 'a', which amplifies it to yield the output signal \\( S_o \\).\n- The output signal \\( S_o \\) is split; one path leads to the final output, while the other is routed back to the feedback network 'f'.\n- The feedback network processes \\( S_o \\) to create the feedback signal \\( S_{fb} = f \\times S_o \\), which is then fed back to the summing junction.\n\n3. **Labels, Annotations, and Key Indicators:**\n- The diagram includes labels for each signal and block, such as \\( S_i \\) for input, \\( S_o \\) for output, \\( S_\\epsilon \\) for error signal, and \\( S_{fb} \\) for feedback signal.\n- The amplifier's gain is indicated by 'a', and the feedback factor is denoted by 'f'.\n\n4. **Overall System Function:**\n- The main function of this feedback amplifier system is to control the gain and stability of the amplifier output. By employing feedback, the system can achieve a closed-loop gain that is largely independent of the open-loop gain 'a', particularly when the loop gain \\( T = a \\times f \\) is much greater than 1. This setup allows the system to maintain a stable and precise gain of \\( 1/f \\), making it resilient to variations in the amplifier's open-loop characteristics. This is a key concept in operational amplifier design and application.\n\nFigure 6.2 A conceptual feedback amplifier.\n\nGiven that the feedback network consists of passive components, the value of $f$ can be precisely set, ensuring the gain is $1 / f$ when $T \\gg 1$, regardless of variations in the open-loop gain $a$. This independence of closed-loop performance from the active amplifier's parameters is a major reason for the widespread use of op amps in analog circuits.\n\nIn the circuit depicted in Fig. 6.2, the feedback signal generally reduces the magnitude of $S_{\\epsilon}$ compared to the open-loop scenario (where $f=0$) when $a$ and $f$ share the same sign. This situation is known as negative feedback and is the focus of practical interest in this chapter.\n\nWith this concise introduction to feedback principles, we move on to examining several illustrative op-amp configurations. These example circuits are straightforward, making direct analysis using Kirchoff's laws more feasible than treating them as feedback amplifiers. In Chapter 8, more complex feedback configurations are explored, where employing feedback concepts as an analytical tool is more beneficial than in these simpler examples."
},
{
    "text": "The inverting amplifier setup is depicted in Fig. 6.3a. ${ }^{1,2,3}$ We presuppose that the op-amp's input resistance is infinite and its output resistance is zero, as illustrated in Fig. 6.1. Applying KCL at node $X$,\n\n$$\n\\begin{equation*}\n\\frac{V_{s}-V_{i}}{R_{1}}+\\frac{V_{o}-V_{i}}{R_{2}}=0 \\tag{6.4}\n\\end{equation*}\n$$\n\nGiven that $R_{2}$ links the amplifier's output to the inverting input, the feedback is negative. Consequently, with infinite open-loop gain, $V_{i}$ would be driven to zero. Conversely, with a finite open-loop gain $a$,\n\n$$\n\\begin{equation*}\nV_{i}=\\frac{-V_{o}}{a} \\tag{6.5}\n\\end{equation*}\n$$\n\nimage_name:(a)\ndescription:\n[\nname: VS, type: VoltageSource, value: VS, ports: {Np: VS, Nn: GND}\nname: R1, type: Resistor, value: R1, ports: {N1: VS, N2: X}\nname: R2, type: Resistor, value: R2, ports: {N1: X, N2: Vo}\nname: A0, type: OpAmp, value: A0, ports: {InP: GND, InN: X, OutP: Vo}\n]\nextrainfo:The circuit represents an inverting amplifier. Voltage source VS connects to resistor R1, leading to node X, which is the inverting input of op-amp A0. Resistor R2 provides negative feedback from output Vo back to the inverting input. The non-inverting input of the op-amp is grounded. The output voltage Vo is inverted relative to the input voltage.\nimage_name:(b)\ndescription:\n[\nname: VS, type: VoltageSource, value: VS, ports: {Np: Vs, Nn: GND}\nname: R1, type: Resistor, value: R1, ports: {N1: Vx, N2: GND}\nname: R2, type: Resistor, value: R2, ports: {N1: Vx, N2: Vo}\nname: A0, type: OpAmp, value: A0, ports: {InP: Vs, InN: Vx, Out: Vo}\n]\nextrainfo:This configuration is a non-inverting amplifier. The input voltage is applied to the non-inverting terminal of the op-amp.\nimage_name:(c)\ndescription:\n[\nname: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\nname: A0, type: OpAmp, value: A0, ports: {InP: Vs, InN: Vo, OutP: Vo}\n]\nextrainfo:The circuit in diagram (c) is a voltage follower where output voltage Vo tracks the input voltage Vs. Op-amp A0 is set up to provide a unity gain buffer.\n\nFigure 6.3 (a) Inverting amplifier setup. (b) Non-inverting amplifier setup. (c) Voltage follower setup.\n\nSubstituting (6.5) into (6.4) and rearranging yields\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=-\\frac{R_{2}}{R_{1}}\\left[\\frac{1}{1+\\frac{1}{a}\\left(1+\\frac{R_{2}}{R_{1}}\\right)}\\right] \\tag{6.6}\n\\end{equation*}\n$$\n\nIf the op amp's gain is sufficiently high such that\n\n$$\n\\begin{equation*}\na\\left(\\frac{R_{1}}{R_{1}+R_{2}}\\right) \\gg 1 \\tag{6.7}\n\\end{equation*}\n$$\n\nthen the closed-loop gain approximates\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}} \\simeq-\\frac{R_{2}}{R_{1}} \\tag{6.8}\n\\end{equation*}\n$$\n\nWhen the condition in (6.7) is met, (6.8) indicates that the closed-loop gain is predominantly influenced by the external passive components $R_{1}$ and $R_{2}$. Since these components can be chosen with high precision, the closed-loop performance can achieve a significant degree of accuracy, independent of variations in the op-amp's parameters. For instance, if the op-amp gain shifts from $5 \\times 10^{4}$ to $10^{5}$, this 100 percent gain increase would have negligible impact on the closed-loop performance, provided (6.7) holds true.\n\n#### EXAMPLE\n\nDetermine the gain of the circuit in Fig. 6.3a for $a=10^{4}$ and $a=10^{5}$, with $R_{1}=1 \\mathrm{k} \\Omega$ and $R_{2}=$ $10 \\mathrm{k} \\Omega$.\n\nFrom (6.6) with $a=10^{4}$,\n\n$$\n\\begin{equation*}\nA=\\frac{V_{o}}{V_{s}}=-10\\left(\\frac{1}{1+\\frac{11}{10^{4}}}\\right)=-9.9890 \\tag{6.9a}\n\\end{equation*}\n$$\n\nFrom (6.6) with $a=10^{5}$,\n\n$$\n\\begin{equation*}\nA=\\frac{V_{o}}{V_{s}}=-10\\left(\\frac{1}{1+\\frac{11}{10^{5}}}\\right)=-9.99890 \\tag{6.9b}\n\\end{equation*}\n$$\n\nThe high gain of op-amps facilitates the approximate analysis of circuits like Fig. 6.3a using summing-point constraints. ${ }^{1}$ If the op-amp is part of a negative-feedback circuit and its gain is very high, then for a finite output voltage, the input voltage must approach zero, as\n\n$$\n\\begin{equation*}\nV_{i}=-\\frac{V_{o}}{a} \\tag{6.10}\n\\end{equation*}\n$$\n\nThus, such circuits can be analyzed approximately by assuming the op-amp input voltage is driven to zero. This assumption implicitly requires that the feedback is negative and that the circuit has a stable operating point where (6.10) applies.\n\nThe presumption that $V_{i}=0$ is termed a summing-point constraint. Another constraint is that no current flows into the op-amp's input terminals, as no voltage exists across the input resistance if $V_{i}=0$. This summing-point method aids in intuitively understanding the inverting amplifier setup in Fig. 6.3a. Since the inverting input terminal is driven to ground potential, resistor $R_{1}$ converts the voltage $V_{s}$ into an input current of $V_{s} / R_{1}$. This current cannot flow into the ideal op-amp's input; hence, it flows through $R_{2}$, creating a voltage drop of $V_{s} R_{2} / R_{1}$. Because the op-amp's input terminal is at ground potential, the overall circuit's input resistance as seen by $V_{s}$ is $R_{1}$. Due to the negative feedback forcing the inverting input to ground potential, it is often referred to as a virtual ground."
},
{
    "text": "The configuration of the inverting amplifier is depicted in Fig. 6.3a. ${ }^{1,2,3}$ We presume that the op-amp's input resistance is infinite and its output resistance is zero, as illustrated in Fig. 6.1. Applying KCL at node $X$,\n\n$$\n\\begin{equation*}\n\\frac{V_{s}-V_{i}}{R_{1}}+\\frac{V_{o}-V_{i}}{R_{2}}=0 \\tag{6.4}\n\\end{equation*}\n$$\n\nGiven that $R_{2}$ links the amplifier's output to the inverting input, the feedback is negative. Consequently, with infinite open-loop gain, $V_{i}$ would be driven to zero. Conversely, with a finite open-loop gain $a$,\n\n$$\n\\begin{equation*}\nV_{i}=\\frac{-V_{o}}{a} \\tag{6.5}\n\\end{equation*}\n$$\n\nimage_name:(a)\ndescription:\n[\nname: VS, type: VoltageSource, value: VS, ports: {Np: VS, Nn: GND}\nname: R1, type: Resistor, value: R1, ports: {N1: VS, N2: X}\nname: R2, type: Resistor, value: R2, ports: {N1: X, N2: Vo}\nname: A0, type: OpAmp, value: A0, ports: {InP: GND, InN: X, OutP: Vo}\n]\nextrainfo:The circuit represents an inverting amplifier setup. Voltage source VS is linked to resistor R1, connecting to node X, which is the inverting input of op-amp A0. Resistor R2 establishes negative feedback from output Vo back to the inverting input. The non-inverting input of the op-amp is grounded. The output voltage Vo is inverted relative to the input voltage.\nimage_name:(b)\ndescription:\n[\nname: VS, type: VoltageSource, value: VS, ports: {Np: Vs, Nn: GND}\nname: R1, type: Resistor, value: R1, ports: {N1: Vx, N2: GND}\nname: R2, type: Resistor, value: R2, ports: {N1: Vx, N2: Vo}\nname: A0, type: OpAmp, value: A0, ports: {InP: Vs, InN: Vx, Out: Vo}\n]\nextrainfo:This setup is a non-inverting amplifier. The input voltage is applied to the non-inverting terminal of the op-amp.\nimage_name:(c)\ndescription:\n[\nname: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\nname: A0, type: OpAmp, value: A0, ports: {InP: Vs, InN: Vo, OutP: Vo}\n]\nextrainfo:The circuit (c) illustrates a voltage follower configuration where output voltage Vo tracks input voltage Vs. Op-amp A0 is configured for unity gain buffering.\n\nFigure 6.3 (a) Inverting amplifier setup. (b) Non-inverting amplifier setup. (c) Voltage follower setup.\n\nBy substituting (6.5) into (6.4) and rearranging, we obtain\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=-\\frac{R_{2}}{R_{1}}\\left[\\frac{1}{1+\\frac{1}{a}\\left(1+\\frac{R_{2}}{R_{1}}\\right)}\\right] \\tag{6.6}\n\\end{equation*}\n$$\n\nIf the op amp's gain is sufficiently high such that\n\n$$\n\\begin{equation*}\na\\left(\\frac{R_{1}}{R_{1}+R_{2}}\\right) \\gg 1 \\tag{6.7}\n\\end{equation*}\n$$\n\nthen the closed-loop gain approximates\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}} \\simeq-\\frac{R_{2}}{R_{1}} \\tag{6.8}\n\\end{equation*}\n$$\n\nWhen (6.7) holds true, (6.8) indicates that the closed-loop gain is predominantly influenced by the external passive components $R_{1}$ and $R_{2}$. Since these components can be chosen with high precision, the closed-loop performance can achieve a significant level of accuracy, independent of variations in the op-amp's parameters. For instance, if the op-amp gain changes from $5 \\times 10^{4}$ to $10^{5}$, this 100 percent gain increase would have a negligible impact on closed-loop performance, provided (6.7) remains valid.\n\n#### EXAMPLE\n\nDetermine the gain of the circuit in Fig. 6.3a for $a=10^{4}$ and $a=10^{5}$, with $R_{1}=1 \\mathrm{k} \\Omega$ and $R_{2}=10 \\mathrm{k} \\Omega$.\n\nFrom (6.6) with $a=10^{4}$,\n\n$$\n\\begin{equation*}\nA=\\frac{V_{o}}{V_{s}}=-10\\left(\\frac{1}{1+\\frac{11}{10^{4}}}\\right)=-9.9890 \\tag{6.9a}\n\\end{equation*}\n$$\n\nFrom (6.6) with $a=10^{5}$,\n\n$$\n\\begin{equation*}\nA=\\frac{V_{o}}{V_{s}}=-10\\left(\\frac{1}{1+\\frac{11}{10^{5}}}\\right)=-9.99890 \\tag{6.9b}\n\\end{equation*}\n$$\n\nThe high gain of op-amps permits the approximate analysis of circuits like Fig. 6.3a using summing-point constraints. ${ }^{1}$ If the op-amp is configured in a negative-feedback circuit and has a very high gain, then for a finite output voltage, the input voltage must approach zero, as\n\n$$\n\\begin{equation*}\nV_{i}=-\\frac{V_{o}}{a} \\tag{6.10}\n\\end{equation*}\n$$\n\nThus, such circuits can be analyzed approximately by assuming the op-amp input voltage is driven to zero. This assumption implicitly relies on negative feedback and a stable operating point where (6.10) holds true.\n\nThe presumption that $V_{i}=0$ is termed a summing-point constraint. A second constraint is that no current flows into the op-amp input terminals, as no voltage exists across the input resistance if $V_{i}=0$. This summing-point method facilitates an intuitive grasp of the inverting amplifier setup in Fig. 6.3a. Since the inverting input terminal is driven to ground potential, resistor $R_{1}$ converts voltage $V_{s}$ into an input current of $V_{s} / R_{1}$. This current cannot flow into the ideal op-amp's input; hence, it flows through $R_{2}$, creating a voltage drop of $V_{s} R_{2} / R_{1}$. Given that the op-amp's input terminal operates at ground potential, the overall circuit's input resistance as seen by $V_{s}$ equals $R_{1}$. Due to the negative feedback forcing the inverting input to ground potential, it is often referred to as a virtual ground."
},
{
    "text": "The configuration of the inverting amplifier is depicted in Fig. 6.3a. ${ }^{1,2,3}$ We presume that the op-amp's input resistance is infinite and its output resistance is zero, as illustrated in Fig. 6.1. Applying KCL at node $X$,\n\n$$\n\\begin{equation*}\n\\frac{V_{s}-V_{i}}{R_{1}}+\\frac{V_{o}-V_{i}}{R_{2}}=0 \\tag{6.4}\n\\end{equation*}\n$$\n\nGiven that $R_{2}$ connects the amplifier's output to the inverting input, the feedback is negative. Consequently, with infinite open-loop gain, $V_{i}$ would be driven to zero. Conversely, with a finite open-loop gain $a$,\n\n$$\n\\begin{equation*}\nV_{i}=\\frac{-V_{o}}{a} \\tag{6.5}\n\\end{equation*}\n$$\n\nimage_name:(a)\ndescription:\n[\nname: VS, type: VoltageSource, value: VS, ports: {Np: VS, Nn: GND}\nname: R1, type: Resistor, value: R1, ports: {N1: VS, N2: X}\nname: R2, type: Resistor, value: R2, ports: {N1: X, N2: Vo}\nname: A0, type: OpAmp, value: A0, ports: {InP: GND, InN: X, OutP: Vo}\n]\nextrainfo:The circuit represents an inverting amplifier setup. The voltage source VS is linked to resistor R1, which connects to node X, the inverting input of op-amp A0. Resistor R2 establishes negative feedback from the output Vo back to the inverting input. The non-inverting input of the op-amp is grounded. The output voltage Vo is inverted relative to the input voltage.\nimage_name:(b)\ndescription:\n[\nname: VS, type: VoltageSource, value: VS, ports: {Np: Vs, Nn: GND}\nname: R1, type: Resistor, value: R1, ports: {N1: Vx, N2: GND}\nname: R2, type: Resistor, value: R2, ports: {N1: Vx, N2: Vo}\nname: A0, type: OpAmp, value: A0, ports: {InP: Vs, InN: Vx, Out: Vo}\n]\nextrainfo:This circuit is configured as a non-inverting amplifier. The input voltage is applied to the non-inverting terminal of the op-amp.\nimage_name:(c)\ndescription:\n[\nname: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\nname: A0, type: OpAmp, value: A0, ports: {InP: Vs, InN: Vo, OutP: Vo}\n]\nextrainfo:The circuit in diagram (c) is a voltage follower where the output voltage Vo mirrors the input voltage Vs. Op-amp A0 is set up to provide a unity gain buffer.\n\nFigure 6.3 (a) Inverting amplifier setup. (b) Non-inverting amplifier setup. (c) Voltage follower setup.\n\nSubstituting (6.5) into (6.4) and rearranging yields\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=-\\frac{R_{2}}{R_{1}}\\left[\\frac{1}{1+\\frac{1}{a}\\left(1+\\frac{R_{2}}{R_{1}}\\right)}\\right] \\tag{6.6}\n\\end{equation*}\n$$\n\nIf the op amp's gain is sufficiently high such that\n\n$$\n\\begin{equation*}\na\\left(\\frac{R_{1}}{R_{1}+R_{2}}\\right) \\gg 1 \\tag{6.7}\n\\end{equation*}\n$$\n\nthen the closed-loop gain approximates\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}} \\simeq-\\frac{R_{2}}{R_{1}} \\tag{6.8}\n\\end{equation*}\n$$\n\nWhen the condition in (6.7) is met, (6.8) indicates that the closed-loop gain is predominantly influenced by the external passive components $R_{1}$ and $R_{2}$. Since these components can be chosen with high precision, the closed-loop performance can achieve a significant level of accuracy, independent of variations in the op-amp's parameters. For instance, if the op-amp gain changes from $5 \\times 10^{4}$ to $10^{5}$, this 100 percent increase in gain would have a negligible impact on the closed-loop performance, provided (6.7) holds true.\n\n#### EXAMPLE\n\nDetermine the gain of the circuit in Fig. 6.3a for $a=10^{4}$ and $a=10^{5}$, with $R_{1}=1 \\mathrm{k} \\Omega$ and $R_{2}=10 \\mathrm{k} \\Omega$.\n\nUsing (6.6) with $a=10^{4}$,\n\n$$\n\\begin{equation*}\nA=\\frac{V_{o}}{V_{s}}=-10\\left(\\frac{1}{1+\\frac{11}{10^{4}}}\\right)=-9.9890 \\tag{6.9a}\n\\end{equation*}\n$$\n\nUsing (6.6) with $a=10^{5}$,\n\n$$\n\\begin{equation*}\nA=\\frac{V_{o}}{V_{s}}=-10\\left(\\frac{1}{1+\\frac{11}{10^{5}}}\\right)=-9.99890 \\tag{6.9b}\n\\end{equation*}\n$$\n\nThe high gain of op amps facilitates the approximate analysis of circuits like Fig. 6.3a using summing-point constraints. ${ }^{1}$ If the op amp is part of a negative-feedback circuit and its gain is very high, then for a finite output voltage, the input voltage must approach zero, as\n\n$$\n\\begin{equation*}\nV_{i}=-\\frac{V_{o}}{a} \\tag{6.10}\n\\end{equation*}\n$$\n\nThus, such circuits can be analyzed approximately by assuming the op-amp input voltage is driven to zero. This assumption relies on the presence of negative feedback and a stable operating point where (6.10) is valid.\n\nThe presumption that $V_{i}=0$ is termed a summing-point constraint. Another constraint is that no current flows into the op-amp input terminals, as no voltage exists across the input resistance if $V_{i}=0$. This summing-point method aids in intuitively understanding the inverting amplifier setup in Fig. 6.3a. Since the inverting input terminal is driven to ground potential, resistor $R_{1}$ converts the voltage $V_{s}$ into an input current of $V_{s} / R_{1}$. This current cannot flow into the ideal op amp's input; hence, it flows through $R_{2}$, creating a voltage drop of $V_{s} R_{2} / R_{1}$. Given that the op-amp input terminal operates at ground potential, the overall circuit's input resistance as seen by $V_{s}$ equals $R_{1}$. Due to the negative feedback forcing the inverting input to ground potential, it is often referred to as a virtual ground."
},
{
    "text": "The configuration of the inverting amplifier is depicted in Fig. 6.3a. ${ }^{1,2,3}$ We presuppose that the op-amp's input resistance is infinitely high and its output resistance is nil, as illustrated in Fig. 6.1. Applying KCL at node $X$,\n\n$$\n\\begin{equation*}\n\\frac{V_{s}-V_{i}}{R_{1}}+\\frac{V_{o}-V_{i}}{R_{2}}=0 \\tag{6.4}\n\\end{equation*}\n$$\n\nGiven that $R_{2}$ connects the amplifier's output to the inverting input, the feedback is inherently negative. Consequently, with infinite open-loop gain, $V_{i}$ would be driven to zero. Conversely, with a finite open-loop gain $a$,\n\n$$\n\\begin{equation*}\nV_{i}=\\frac{-V_{o}}{a} \\tag{6.5}\n\\end{equation*}\n$$\n\nimage_name:(a)\ndescription:\n[\nname: VS, type: VoltageSource, value: VS, ports: {Np: VS, Nn: GND}\nname: R1, type: Resistor, value: R1, ports: {N1: VS, N2: X}\nname: R2, type: Resistor, value: R2, ports: {N1: X, N2: Vo}\nname: A0, type: OpAmp, value: A0, ports: {InP: GND, InN: X, OutP: Vo}\n]\nextrainfo:The depicted circuit is an inverting amplifier setup. The voltage source VS is linked to resistor R1, which connects to node X, the inverting input of op-amp A0. Resistor R2 establishes negative feedback from the output Vo back to the inverting input. The non-inverting input of the op-amp is grounded. The output voltage Vo is phase-inverted relative to the input voltage.\nimage_name:(b)\ndescription:\n[\nname: VS, type: VoltageSource, value: VS, ports: {Np: Vs, Nn: GND}\nname: R1, type: Resistor, value: R1, ports: {N1: Vx, N2: GND}\nname: R2, type: Resistor, value: R2, ports: {N1: Vx, N2: Vo}\nname: A0, type: OpAmp, value: A0, ports: {InP: Vs, InN: Vx, Out: Vo}\n]\nextrainfo:This configuration is a non-inverting amplifier. The input voltage is directly applied to the non-inverting terminal of the op-amp.\nimage_name:(c)\ndescription:\n[\nname: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\nname: A0, type: OpAmp, value: A0, ports: {InP: Vs, InN: Vo, OutP: Vo}\n]\nextrainfo:The circuit in diagram (c) exemplifies a voltage follower setup where the output voltage Vo mirrors the input voltage Vs. Op-amp A0 is configured to act as a unity gain buffer.\n\nFigure 6.3 (a) Inverting amplifier setup. (b) Non-inverting amplifier setup. (c) Voltage follower setup.\n\nBy substituting (6.5) into (6.4) and rearranging, we obtain\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=-\\frac{R_{2}}{R_{1}}\\left[\\frac{1}{1+\\frac{1}{a}\\left(1+\\frac{R_{2}}{R_{1}}\\right)}\\right] \\tag{6.6}\n\\end{equation*}\n$$\n\nIf the op amp's gain is sufficiently high such that\n\n$$\n\\begin{equation*}\na\\left(\\frac{R_{1}}{R_{1}+R_{2}}\\right) \\gg 1 \\tag{6.7}\n\\end{equation*}\n$$\n\nthen the closed-loop gain approximates\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}} \\simeq-\\frac{R_{2}}{R_{1}} \\tag{6.8}\n\\end{equation*}\n$$\n\nWhen the condition in (6.7) is met, (6.8) indicates that the closed-loop gain is predominantly influenced by the external passive components $R_{1}$ and $R_{2}$. Since these components can be chosen with high precision, the closed-loop performance can achieve a significant level of accuracy, independent of variations in the op-amp's parameters. For instance, if the op-amp's gain changes from $5 \\times 10^{4}$ to $10^{5}$, this 100 percent increase in gain would scarcely affect the closed-loop performance, provided (6.7) remains valid.\n\n#### EXAMPLE\n\nDetermine the gain of the circuit in Fig. 6.3a for $a=10^{4}$ and $a=10^{5}$, with $R_{1}=1 \\mathrm{k} \\Omega$ and $R_{2}=10 \\mathrm{k} \\Omega$.\n\nUsing (6.6) for $a=10^{4}$,\n\n$$\n\\begin{equation*}\nA=\\frac{V_{o}}{V_{s}}=-10\\left(\\frac{1}{1+\\frac{11}{10^{4}}}\\right)=-9.9890 \\tag{6.9a}\n\\end{equation*}\n$$\n\nFor $a=10^{5}$,\n\n$$\n\\begin{equation*}\nA=\\frac{V_{o}}{V_{s}}=-10\\left(\\frac{1}{1+\\frac{11}{10^{5}}}\\right)=-9.99890 \\tag{6.9b}\n\\end{equation*}\n$$\n\nThe high gain of op-amps facilitates an approximate analysis of circuits like Fig. 6.3a using summing-point constraints. ${ }^{1}$ When an op-amp is configured in a negative-feedback circuit with a very high gain, the input voltage must approach zero for any finite output voltage, as\n\n$$\n\\begin{equation*}\nV_{i}=-\\frac{V_{o}}{a} \\tag{6.10}\n\\end{equation*}\n$$\n\nThus, such circuits can be approximately analyzed by initially assuming the op-amp's input voltage is driven to zero. This assumption implicitly relies on negative feedback and a stable operating point where (6.10) holds true.\n\nThe presumption that $V_{i}=0$ is termed a summing-point constraint. Another constraint is the absence of current flow into the op-amp's input terminals, as no voltage exists across the input resistance if $V_{i}=0$. This summing-point method aids in intuitively understanding the inverting amplifier setup of Fig. 6.3a. Since the inverting input is driven to ground potential, resistor $R_{1}$ converts the voltage $V_{s}$ into an input current of $V_{s} / R_{1}$. This current cannot enter the ideal op-amp's input; hence, it flows through $R_{2}$, creating a voltage drop of $V_{s} R_{2} / R_{1}$. Given that the op-amp's input terminal operates at ground potential, the overall circuit's input resistance as perceived by $V_{s}$ equals $R_{1}$. Due to the negative feedback forcing the inverting input to ground potential, it is often referred to as a virtual ground."
},
{
    "text": "The configuration of the inverting amplifier is depicted in Fig. 6.3a. ${ }^{1,2,3}$ We presume that the input resistance of the op-amp is infinite and the output resistance is zero, as illustrated in Fig. 6.1. Applying KCL at node $X$,\n\n$$\n\\begin{equation*}\n\\frac{V_{s}-V_{i}}{R_{1}}+\\frac{V_{o}-V_{i}}{R_{2}}=0 \\tag{6.4}\n\\end{equation*}\n$$\n\nGiven that $R_{2}$ connects the amplifier output to the inverting input, the feedback is negative. Consequently, with infinite open-loop gain, $V_{i}$ would be driven to zero. Conversely, with a finite open-loop gain $a$,\n\n$$\n\\begin{equation*}\nV_{i}=\\frac{-V_{o}}{a} \\tag{6.5}\n\\end{equation*}\n$$\n\nimage_name:(a)\ndescription:\n[\nname: VS, type: VoltageSource, value: VS, ports: {Np: VS, Nn: GND}\nname: R1, type: Resistor, value: R1, ports: {N1: VS, N2: X}\nname: R2, type: Resistor, value: R2, ports: {N1: X, N2: Vo}\nname: A0, type: OpAmp, value: A0, ports: {InP: GND, InN: X, OutP: Vo}\n]\nextrainfo:The circuit represents an inverting amplifier setup. The voltage source VS connects to resistor R1, leading to node X, which is the inverting input of op-amp A0. Resistor R2 provides negative feedback from the output Vo back to the inverting input. The non-inverting input of the op-amp is grounded. The output voltage Vo is inverted relative to the input voltage.\nimage_name:(b)\ndescription:\n[\nname: VS, type: VoltageSource, value: VS, ports: {Np: Vs, Nn: GND}\nname: R1, type: Resistor, value: R1, ports: {N1: Vx, N2: GND}\nname: R2, type: Resistor, value: R2, ports: {N1: Vx, N2: Vo}\nname: A0, type: OpAmp, value: A0, ports: {InP: Vs, InN: Vx, Out: Vo}\n]\nextrainfo:This circuit is configured as a non-inverting amplifier. The input voltage is applied to the non-inverting terminal of the op-amp.\nimage_name:(c)\ndescription:\n[\nname: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\nname: A0, type: OpAmp, value: A0, ports: {InP: Vs, InN: Vo, OutP: Vo}\n]\nextrainfo:The circuit in diagram (c) is a voltage follower where the output voltage Vo tracks the input voltage Vs. Op-amp A0 is set up to provide a unity gain buffer.\n\nFigure 6.3 (a) Inverting amplifier setup. (b) Non-inverting amplifier setup. (c) Voltage follower setup.\n\nSubstituting (6.5) into (6.4) and rearranging yields\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=-\\frac{R_{2}}{R_{1}}\\left[\\frac{1}{1+\\frac{1}{a}\\left(1+\\frac{R_{2}}{R_{1}}\\right)}\\right] \\tag{6.6}\n\\end{equation*}\n$$\n\nIf the op amp's gain is sufficiently large such that\n\n$$\n\\begin{equation*}\na\\left(\\frac{R_{1}}{R_{1}+R_{2}}\\right) \\gg 1 \\tag{6.7}\n\\end{equation*}\n$$\n\nthen the closed-loop gain approximates\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}} \\simeq-\\frac{R_{2}}{R_{1}} \\tag{6.8}\n\\end{equation*}\n$$\n\nWhen the condition in (6.7) is met, (6.8) indicates that the closed-loop gain is primarily determined by the external passive components $R_{1}$ and $R_{2}$. Since these components can be chosen with high precision, the closed-loop performance can achieve a high degree of accuracy, independent of variations in the op-amp's parameters. For instance, if the op-amp gain changes from $5 \\times 10^{4}$ to $10^{5}$, this 100 percent increase in gain would have negligible impact on the closed-loop performance, provided (6.7) holds true.\n\n#### EXAMPLE\n\nDetermine the gain of the circuit in Fig. 6.3a for $a=10^{4}$ and $a=10^{5}$, with $R_{1}=1 \\mathrm{k} \\Omega$ and $R_{2}=10 \\mathrm{k} \\Omega$.\n\nUsing (6.6) with $a=10^{4}$,\n\n$$\n\\begin{equation*}\nA=\\frac{V_{o}}{V_{s}}=-10\\left(\\frac{1}{1+\\frac{11}{10^{4}}}\\right)=-9.9890 \\tag{6.9a}\n\\end{equation*}\n$$\n\nUsing (6.6) with $a=10^{5}$,\n\n$$\n\\begin{equation*}\nA=\\frac{V_{o}}{V_{s}}=-10\\left(\\frac{1}{1+\\frac{11}{10^{5}}}\\right)=-9.99890 \\tag{6.9b}\n\\end{equation*}\n$$\n\nThe high gain of op-amps enables the approximate analysis of circuits like Fig. 6.3a using summing-point constraints. ${ }^{1}$ When the op-amp is part of a negative-feedback circuit and its gain is very high, the input voltage must approach zero for a finite output voltage, as\n\n$$\n\\begin{equation*}\nV_{i}=-\\frac{V_{o}}{a} \\tag{6.10}\n\\end{equation*}\n$$\n\nThus, such circuits can be analyzed approximately by assuming the op-amp input voltage is driven to zero. This assumption implicitly relies on negative feedback and a stable operating point where (6.10) is valid.\n\nThe assumption of $V_{i}=0$ is termed a summing-point constraint. Another constraint is that no current flows into the op-amp input terminals, as no voltage exists across the input resistance if $V_{i}=0$. This summing-point method facilitates an intuitive grasp of the inverting amplifier configuration in Fig. 6.3a. Since the inverting input terminal is driven to ground potential, resistor $R_{1}$ converts the voltage $V_{s}$ into an input current of $V_{s} / R_{1}$. This current cannot flow into the ideal op-amp's input; hence, it flows through $R_{2}$, creating a voltage drop of $V_{s} R_{2} / R_{1}$. Because the op-amp input terminal operates at ground potential, the overall circuit's input resistance as seen by $V_{s}$ equals $R_{1}$. Due to the negative feedback forcing the inverting input to ground potential, it is often referred to as a virtual ground."
},
{
    "text": "The configuration of the inverting amplifier is depicted in Fig. 6.3a. ${ }^{1,2,3}$ We presuppose that the operational amplifier's input resistance is infinite and its output resistance is zero, as illustrated in Fig. 6.1. Applying Kirchhoff's Current Law (KCL) at node $X$ yields:\n\n$$\n\\begin{equation*}\n\\frac{V_{s}-V_{i}}{R_{1}}+\\frac{V_{o}-V_{i}}{R_{2}}=0 \\tag{6.4}\n\\end{equation*}\n$$\n\nGiven that $R_{2}$ connects the amplifier's output to the inverting input, the feedback is inherently negative. Consequently, with infinite open-loop gain, $V_{i}$ would be driven to zero. Conversely, with a finite open-loop gain $a$,\n\n$$\n\\begin{equation*}\nV_{i}=\\frac{-V_{o}}{a} \\tag{6.5}\n\\end{equation*}\n$$\n\nimage_name:(a)\ndescription:\n[\nname: VS, type: VoltageSource, value: VS, ports: {Np: VS, Nn: GND}\nname: R1, type: Resistor, value: R1, ports: {N1: VS, N2: X}\nname: R2, type: Resistor, value: R2, ports: {N1: X, N2: Vo}\nname: A0, type: OpAmp, value: A0, ports: {InP: GND, InN: X, OutP: Vo}\n]\nextrainfo:The depicted circuit is an inverting amplifier setup. The voltage source VS is linked to resistor R1, culminating at node X, which serves as the inverting input of op-amp A0. Resistor R2 establishes negative feedback from the output Vo back to the inverting input. The non-inverting input of the op-amp is grounded. The output voltage Vo is phase-inverted relative to the input voltage.\nimage_name:(b)\ndescription:\n[\nname: VS, type: VoltageSource, value: VS, ports: {Np: Vs, Nn: GND}\nname: R1, type: Resistor, value: R1, ports: {N1: Vx, N2: GND}\nname: R2, type: Resistor, value: R2, ports: {N1: Vx, N2: Vo}\nname: A0, type: OpAmp, value: A0, ports: {InP: Vs, InN: Vx, Out: Vo}\n]\nextrainfo:This configuration represents a non-inverting amplifier. The input voltage is directly applied to the non-inverting terminal of the op-amp.\nimage_name:(c)\ndescription:\n[\nname: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\nname: A0, type: OpAmp, value: A0, ports: {InP: Vs, InN: Vo, OutP: Vo}\n]\nextrainfo:The circuit (c) illustrates a voltage follower setup where the output voltage Vo mirrors the input voltage Vs. Op-amp A0 is configured to provide a unity gain buffer.\n\nFigure 6.3 (a) Inverting amplifier setup. (b) Non-inverting amplifier setup. (c) Voltage follower setup.\n\nSubstituting (6.5) into (6.4) and rearranging the terms results in:\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=-\\frac{R_{2}}{R_{1}}\\left[\\frac{1}{1+\\frac{1}{a}\\left(1+\\frac{R_{2}}{R_{1}}\\right)}\\right] \\tag{6.6}\n\\end{equation*}\n$$\n\nIf the op amp's gain is sufficiently high such that\n\n$$\n\\begin{equation*}\na\\left(\\frac{R_{1}}{R_{1}+R_{2}}\\right) \\gg 1 \\tag{6.7}\n\\end{equation*}\n$$\n\nthen the closed-loop gain approximates to:\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}} \\simeq-\\frac{R_{2}}{R_{1}} \\tag{6.8}\n\\end{equation*}\n$$\n\nWhen the condition in (6.7) is met, (6.8) indicates that the closed-loop gain is predominantly determined by the external passive components $R_{1}$ and $R_{2}$. Since these components can be chosen with high precision, the closed-loop performance can achieve a significant level of accuracy, independent of variations in the op-amp's parameters. For instance, if the op-amp's gain changes from $5 \\times 10^{4}$ to $10^{5}$, this 100 percent increase in gain would have negligible impact on the closed-loop performance, provided (6.7) remains valid.\n\n#### EXAMPLE\n\nDetermine the gain of the circuit in Fig. 6.3a for $a=10^{4}$ and $a=10^{5}$, with $R_{1}=1 \\mathrm{k} \\Omega$ and $R_{2}=10 \\mathrm{k} \\Omega$.\n\nUsing (6.6) for $a=10^{4}$,\n\n$$\n\\begin{equation*}\nA=\\frac{V_{o}}{V_{s}}=-10\\left(\\frac{1}{1+\\frac{11}{10^{4}}}\\right)=-9.9890 \\tag{6.9a}\n\\end{equation*}\n$$\n\nFor $a=10^{5}$,\n\n$$\n\\begin{equation*}\nA=\\frac{V_{o}}{V_{s}}=-10\\left(\\frac{1}{1+\\frac{11}{10^{5}}}\\right)=-9.99890 \\tag{6.9b}\n\\end{equation*}\n$$\n\nThe high gain of op-amps facilitates the approximate analysis of circuits like Fig. 6.3a using summing-point constraints. ${ }^{1}$ If the op-amp is incorporated in a negative-feedback circuit and its gain is very high, then for a finite output voltage, the input voltage must approach zero, as\n\n$$\n\\begin{equation*}\nV_{i}=-\\frac{V_{o}}{a} \\tag{6.10}\n\\end{equation*}\n$$\n\nHence, such circuits can be analyzed approximately by assuming the op-amp's input voltage is driven to zero. This assumption implicitly relies on the presence of negative feedback and a stable operating point where (6.10) holds true.\n\nThe presumption that $V_{i}=0$ is termed a summing-point constraint. Another constraint is that no current flows into the op-amp's input terminals, given that no voltage exists across the input resistance if $V_{i}=0$. This summing-point method aids in intuitively grasping the operation of the inverting amplifier setup in Fig. 6.3a. Since the inverting input terminal is driven to ground potential, resistor $R_{1}$ converts the voltage $V_{s}$ into an input current of $V_{s} / R_{1}$. This current cannot flow into the ideal op-amp's input; thus, it passes through $R_{2}$, creating a voltage drop of $V_{s} R_{2} / R_{1}$. Given that the op-amp's input terminal operates at ground potential, the overall circuit's input resistance as seen by $V_{s}$ equals $R_{1}$. Due to the negative feedback forcing the inverting input to ground potential, it is often referred to as a virtual ground."
},
{
    "text": "The configuration of the inverting amplifier is depicted in Fig. 6.3a. ${ }^{1,2,3}$ We presuppose that the op-amp's input resistance is infinite and its output resistance is zero, as illustrated in Fig. 6.1. Applying KCL at node $X$ yields:\n\n$$\n\\begin{equation*}\n\\frac{V_{s}-V_{i}}{R_{1}}+\\frac{V_{o}-V_{i}}{R_{2}}=0 \\tag{6.4}\n\\end{equation*}\n$$\n\nGiven that $R_{2}$ links the amplifier's output to the inverting input, the feedback is negative. Consequently, with infinite open-loop gain, $V_{i}$ would be driven to zero. Conversely, with a finite open-loop gain $a$,\n\n$$\n\\begin{equation*}\nV_{i}=\\frac{-V_{o}}{a} \\tag{6.5}\n\\end{equation*}\n$$\n\nimage_name:(a)\ndescription:\n[\nname: VS, type: VoltageSource, value: VS, ports: {Np: VS, Nn: GND}\nname: R1, type: Resistor, value: R1, ports: {N1: VS, N2: X}\nname: R2, type: Resistor, value: R2, ports: {N1: X, N2: Vo}\nname: A0, type: OpAmp, value: A0, ports: {InP: GND, InN: X, OutP: Vo}\n]\nextrainfo:The depicted circuit is an inverting amplifier setup. The voltage source VS is linked to resistor R1, which connects to node X, the inverting input of op-amp A0. Resistor R2 establishes negative feedback from the output Vo back to the inverting input. The non-inverting input of the op-amp is grounded. The output voltage Vo is inverted relative to the input voltage.\nimage_name:(b)\ndescription:\n[\nname: VS, type: VoltageSource, value: VS, ports: {Np: Vs, Nn: GND}\nname: R1, type: Resistor, value: R1, ports: {N1: Vx, N2: GND}\nname: R2, type: Resistor, value: R2, ports: {N1: Vx, N2: Vo}\nname: A0, type: OpAmp, value: A0, ports: {InP: Vs, InN: Vx, Out: Vo}\n]\nextrainfo:This circuit exemplifies a non-inverting amplifier configuration. The input voltage is applied to the non-inverting terminal of the op-amp.\nimage_name:(c)\ndescription:\n[\nname: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\nname: A0, type: OpAmp, value: A0, ports: {InP: Vs, InN: Vo, OutP: Vo}\n]\nextrainfo:The circuit diagram (c) illustrates a voltage follower configuration where the output voltage Vo mirrors the input voltage Vs. Op-amp A0 is configured to provide a unity gain buffer.\n\nFigure 6.3 (a) Inverting amplifier setup. (b) Non-inverting amplifier setup. (c) Voltage follower setup.\n\nSubstituting (6.5) into (6.4) and rearranging results in:\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=-\\frac{R_{2}}{R_{1}}\\left[\\frac{1}{1+\\frac{1}{a}\\left(1+\\frac{R_{2}}{R_{1}}\\right)}\\right] \\tag{6.6}\n\\end{equation*}\n$$\n\nIf the op amp's gain is sufficiently high such that\n\n$$\n\\begin{equation*}\na\\left(\\frac{R_{1}}{R_{1}+R_{2}}\\right) \\gg 1 \\tag{6.7}\n\\end{equation*}\n$$\n\nthen the closed-loop gain approximates:\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}} \\simeq-\\frac{R_{2}}{R_{1}} \\tag{6.8}\n\\end{equation*}\n$$\n\nWhen the condition in (6.7) is met, (6.8) indicates that the closed-loop gain is predominantly influenced by the external passive components $R_{1}$ and $R_{2}$. Since these components can be chosen with high precision, the closed-loop performance can achieve a significant level of accuracy, independent of variations in the op-amp's parameters. For instance, if the op-amp's gain changes from $5 \\times 10^{4}$ to $10^{5}$, this 100 percent increase in gain would have negligible impact on the closed-loop performance, provided (6.7) holds true.\n\n#### EXAMPLE\n\nDetermine the gain of the circuit in Fig. 6.3a for $a=10^{4}$ and $a=10^{5}$, with $R_{1}=1 \\mathrm{k} \\Omega$ and $R_{2}=10 \\mathrm{k} \\Omega$.\n\nUsing (6.6) with $a=10^{4}$,\n\n$$\n\\begin{equation*}\nA=\\frac{V_{o}}{V_{s}}=-10\\left(\\frac{1}{1+\\frac{11}{10^{4}}}\\right)=-9.9890 \\tag{6.9a}\n\\end{equation*}\n$$\n\nUsing (6.6) with $a=10^{5}$,\n\n$$\n\\begin{equation*}\nA=\\frac{V_{o}}{V_{s}}=-10\\left(\\frac{1}{1+\\frac{11}{10^{5}}}\\right)=-9.99890 \\tag{6.9b}\n\\end{equation*}\n$$\n\nThe high gain of op-amps facilitates the approximate analysis of circuits like Fig. 6.3a using summing-point constraints. ${ }^{1}$ When an op-amp is part of a negative-feedback circuit and its gain is very high, the input voltage must approach zero for a finite output voltage, as per\n\n$$\n\\begin{equation*}\nV_{i}=-\\frac{V_{o}}{a} \\tag{6.10}\n\\end{equation*}\n$$\n\nThus, such circuits can be analyzed approximately by assuming the op-amp's input voltage is driven to zero. This assumption relies on the presence of negative feedback and a stable operating point where (6.10) is valid.\n\nThe presumption that $V_{i}=0$ is termed a summing-point constraint. Another constraint is that no current flows into the op-amp's input terminals, as no voltage exists across the input resistance if $V_{i}=0$. This summing-point method provides an intuitive grasp of the inverting amplifier configuration in Fig. 6.3a. Since the inverting input terminal is driven to ground potential, resistor $R_{1}$ converts the voltage $V_{s}$ into an input current of $V_{s} / R_{1}$. This current cannot flow into the ideal op-amp's input; hence, it flows through $R_{2}$, creating a voltage drop of $V_{s} R_{2} / R_{1}$. Given that the op-amp's input terminal operates at ground potential, the overall circuit's input resistance as seen by $V_{s}$ equals $R_{1}$. Due to the negative feedback forcing the inverting input to ground potential, it is often referred to as a virtual ground."
},
{
    "text": "The configuration of the inverting amplifier is depicted in Fig. 6.3a. ${ }^{1,2,3}$ We presuppose that the op-amp's input resistance is infinitely high and its output resistance is nil, as illustrated in Fig. 6.1. Applying KCL at node $X$,\n\n$$\n\\begin{equation*}\n\\frac{V_{s}-V_{i}}{R_{1}}+\\frac{V_{o}-V_{i}}{R_{2}}=0 \\tag{6.4}\n\\end{equation*}\n$$\n\nGiven that $R_{2}$ links the amplifier's output to the inverting input, the feedback is negative. Consequently, with infinite open-loop gain, $V_{i}$ would be driven to zero. Conversely, with a finite open-loop gain $a$,\n\n$$\n\\begin{equation*}\nV_{i}=\\frac{-V_{o}}{a} \\tag{6.5}\n\\end{equation*}\n$$\n\nimage_name:(a)\ndescription:\n[\nname: VS, type: VoltageSource, value: VS, ports: {Np: VS, Nn: GND}\nname: R1, type: Resistor, value: R1, ports: {N1: VS, N2: X}\nname: R2, type: Resistor, value: R2, ports: {N1: X, N2: Vo}\nname: A0, type: OpAmp, value: A0, ports: {InP: GND, InN: X, OutP: Vo}\n]\nextrainfo:The depicted circuit is an inverting amplifier setup. The voltage source VS is linked to resistor R1, which connects to node X, the inverting input of op-amp A0. Resistor R2 provides negative feedback from the output Vo back to the inverting input. The non-inverting input of the op-amp is grounded. The output voltage Vo is inverted relative to the input voltage.\nimage_name:(b)\ndescription:\n[\nname: VS, type: VoltageSource, value: VS, ports: {Np: Vs, Nn: GND}\nname: R1, type: Resistor, value: R1, ports: {N1: Vx, N2: GND}\nname: R2, type: Resistor, value: R2, ports: {N1: Vx, N2: Vo}\nname: A0, type: OpAmp, value: A0, ports: {InP: Vs, InN: Vx, Out: Vo}\n]\nextrainfo:This setup is a non-inverting amplifier configuration. The input voltage is applied to the non-inverting terminal of the op-amp.\nimage_name:(c)\ndescription:\n[\nname: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\nname: A0, type: OpAmp, value: A0, ports: {InP: Vs, InN: Vo, OutP: Vo}\n]\nextrainfo:The circuit diagram (c) illustrates a voltage follower configuration where the output voltage Vo mirrors the input voltage Vs. The op-amp A0 is set up to provide a unity gain buffer.\n\nFigure 6.3 (a) Inverting amplifier setup. (b) Non-inverting amplifier setup. (c) Voltage follower setup.\n\nSubstituting (6.5) into (6.4) and rearranging yields\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=-\\frac{R_{2}}{R_{1}}\\left[\\frac{1}{1+\\frac{1}{a}\\left(1+\\frac{R_{2}}{R_{1}}\\right)}\\right] \\tag{6.6}\n\\end{equation*}\n$$\n\nIf the op amp's gain is sufficiently high such that\n\n$$\n\\begin{equation*}\na\\left(\\frac{R_{1}}{R_{1}+R_{2}}\\right) \\gg 1 \\tag{6.7}\n\\end{equation*}\n$$\n\nthen the closed-loop gain approximates\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}} \\simeq-\\frac{R_{2}}{R_{1}} \\tag{6.8}\n\\end{equation*}\n$$\n\nWhen the condition in (6.7) is met, (6.8) indicates that the closed-loop gain is predominantly determined by the external passive components $R_{1}$ and $R_{2}$. Since these components can be chosen with high precision, the closed-loop performance can achieve a significant level of accuracy, independent of variations in the op-amp's parameters. For instance, if the op-amp gain changes from $5 \\times 10^{4}$ to $10^{5}$, this 100 percent increase in gain would have a negligible impact on the closed-loop performance, provided (6.7) holds true.\n\n#### EXAMPLE\n\nDetermine the gain of the circuit in Fig. 6.3a for $a=10^{4}$ and $a=10^{5}$, with $R_{1}=1 \\mathrm{k} \\Omega$ and $R_{2}=10 \\mathrm{k} \\Omega$.\n\nFrom (6.6) with $a=10^{4}$,\n\n$$\n\\begin{equation*}\nA=\\frac{V_{o}}{V_{s}}=-10\\left(\\frac{1}{1+\\frac{11}{10^{4}}}\\right)=-9.9890 \\tag{6.9a}\n\\end{equation*}\n$$\n\nFrom (6.6) with $a=10^{5}$,\n\n$$\n\\begin{equation*}\nA=\\frac{V_{o}}{V_{s}}=-10\\left(\\frac{1}{1+\\frac{11}{10^{5}}}\\right)=-9.99890 \\tag{6.9b}\n\\end{equation*}\n$$\n\nThe high gain of op-amps permits the simplified analysis of circuits like Fig. 6.3a using summing-point constraints. ${ }^{1}$ When the op-amp is part of a negative-feedback circuit and its gain is very high, the input voltage must approach zero for a finite output voltage, as\n\n$$\n\\begin{equation*}\nV_{i}=-\\frac{V_{o}}{a} \\tag{6.10}\n\\end{equation*}\n$$\n\nThus, one can approximately analyze such circuits by initially assuming that the op-amp input voltage is driven to zero. An underlying assumption here is that the feedback is negative and the circuit has a stable operating point where (6.10) applies.\n\nThe presumption that $V_{i}=0$ is termed a summing-point constraint. Another constraint is that no current flows into the op-amp's input terminals, as no voltage exists across the input resistance if $V_{i}=0$. This summing-point method facilitates an intuitive grasp of the inverting amplifier setup in Fig. 6.3a. Since the inverting input terminal is driven to ground potential, resistor $R_{1}$ converts the voltage $V_{s}$ into an input current of $V_{s} / R_{1}$. This current cannot flow into the ideal op-amp's input; hence, it flows through $R_{2}$, creating a voltage drop of $V_{s} R_{2} / R_{1}$. Because the op-amp's input terminal operates at ground potential, the overall circuit's input resistance as seen by $V_{s}$ is $R_{1}$. Due to the negative feedback forcing the inverting input to ground potential, it is often referred to as a virtual ground."
},
{
    "text": "The noninverting amplifier is depicted in Fig. 6.3b. ${ }^{1,2,3}$ Referring to Fig. 6.1, it is assumed that no current enters the inverting input terminal of the op-amp. Given an open-loop gain of $a$, we have $V_{i}=V_{o} / a$ and\n\n$$\n\\begin{equation*}\nV_{x}=V_{o}\\left(\\frac{R_{1}}{R_{1}+R_{2}}\\right)=V_{s}-\\frac{V_{o}}{a} \\tag{6.11}\n\\end{equation*}\n$$\n\nRearranging equation (6.11) yields\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\left(1+\\frac{R_{2}}{R_{1}}\\right) \\frac{\\frac{a R_{1}}{R_{1}+R_{2}}}{1+\\frac{a R_{1}}{R_{1}+R_{2}}} \\approx\\left(1+\\frac{R_{2}}{R_{1}}\\right) \\tag{6.12}\n\\end{equation*}\n$$\n\nThe approximation in (6.12) holds true when $a R_{1} /\\left(R_{1}+R_{2}\\right) \\gg 1$.\nUnlike the inverting configuration, this circuit exhibits a significantly high input resistance as viewed by $V_{s}$ due to the nature of the feedback employed. (Refer to Chapter 8.) Additionally, unlike the inverting setup, the noninverting connection results in the op amp's common-mode input voltage being equal to $V_{s}$. A notable variant of this configuration is the voltage follower, where $R_{1} \\rightarrow \\infty$ and $R_{2}=0$. This circuit is illustrated in Fig. 6.3c, and its gain approaches unity if $a \\gg 1$."
},
{
    "text": "The noninverting amplifier is depicted in Fig. 6.3b. ${ }^{1,2,3}$ Referring to Fig. 6.1, it is assumed that no current enters the inverting op-amp input terminal. With an open-loop gain of $a$, $V_{i}$ is given by $V_{i}=V_{o} / a$, and\n\n$$\n\\begin{equation*}\nV_{x}=V_{o}\\left(\\frac{R_{1}}{R_{1}+R_{2}}\\right)=V_{s}-\\frac{V_{o}}{a} \\tag{6.11}\n\\end{equation*}\n$$\n\nRearranging equation (6.11) yields\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\left(1+\\frac{R_{2}}{R_{1}}\\right) \\frac{\\frac{a R_{1}}{R_{1}+R_{2}}}{1+\\frac{a R_{1}}{R_{1}+R_{2}}} \\approx \\left(1+\\frac{R_{2}}{R_{1}}\\right) \\tag{6.12}\n\\end{equation*}\n$$\n\nThe approximation in (6.12) holds true when $a R_{1} /\\left(R_{1}+R_{2}\\right) \\gg 1$.\nUnlike the inverting configuration, this circuit exhibits a significantly high input resistance as viewed by $V_{s}$ due to the nature of the feedback employed. (Refer to Chapter 8.) Additionally, unlike the inverting setup, the noninverting connection results in the op amp's common-mode input voltage being equal to $V_{s}$. A notable variation of this configuration is the voltage follower, where $R_{1}$ approaches infinity and $R_{2}$ equals zero. This circuit is illustrated in Fig. 6.3c, and its gain approaches unity if $a \\gg 1$."
},
{
    "text": "The noninverting amplifier is depicted in Fig. 6.3b. ${ }^{1,2,3}$ Referring to Fig. 6.1, it is assumed that no current enters the inverting op-amp input terminal. With an open-loop gain of $a$, we have $V_{i}=V_{o} / a$ and\n\n$$\n\\begin{equation*}\nV_{x}=V_{o}\\left(\\frac{R_{1}}{R_{1}+R_{2}}\\right)=V_{s}-\\frac{V_{o}}{a} \\tag{6.11}\n\\end{equation*}\n$$\n\nRewriting (6.11) yields\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\left(1+\\frac{R_{2}}{R_{1}}\\right) \\frac{\\frac{a R_{1}}{R_{1}+R_{2}}}{1+\\frac{a R_{1}}{R_{1}+R_{2}}} \\approx\\left(1+\\frac{R_{2}}{R_{1}}\\right) \\tag{6.12}\n\\end{equation*}\n$$\n\nThe approximation in (6.12) holds true when $a R_{1} /\\left(R_{1}+R_{2}\\right) \\gg 1$.\nUnlike the inverting configuration, this circuit exhibits a significantly high input resistance as viewed by $V_{s}$ due to the feedback mechanism employed. (Refer to Chapter 8.) Additionally, unlike the inverting setup, the noninverting connection results in the op amp's common-mode input voltage being equal to $V_{s}$. A notable variation of this configuration is the voltage follower, where $R_{1} \\rightarrow \\infty$ and $R_{2}=0$. This circuit is illustrated in Fig. 6.3c, and its gain approaches unity if $a \\gg 1$."
},
{
    "text": "The noninverting amplifier is depicted in Fig. 6.3b. ${ }^{1,2,3}$ Referring to Fig. 6.1, let's assume no current enters the inverting op-amp input terminal. With an open-loop gain of $a$, we have $V_{i}=V_{o} / a$ and\n\n$$\n\\begin{equation*}\nV_{x}=V_{o}\\left(\\frac{R_{1}}{R_{1}+R_{2}}\\right)=V_{s}-\\frac{V_{o}}{a} \\tag{6.11}\n\\end{equation*}\n$$\n\nRearranging equation (6.11) yields\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\left(1+\\frac{R_{2}}{R_{1}}\\right) \\frac{\\frac{a R_{1}}{R_{1}+R_{2}}}{1+\\frac{a R_{1}}{R_{1}+R_{2}}} \\simeq\\left(1+\\frac{R_{2}}{R_{1}}\\right) \\tag{6.12}\n\\end{equation*}\n$$\n\nThe approximation in (6.12) holds true when $a R_{1} /\\left(R_{1}+R_{2}\\right) \\gg 1$.\nUnlike the inverting configuration, this circuit exhibits a significantly high input resistance as viewed by $V_{s}$ due to the nature of the feedback employed. (Refer to Chapter 8.) Additionally, unlike the inverting setup, the noninverting connection results in the op amp's common-mode input voltage being equal to $V_{s}$. A notable variant of this configuration is the voltage follower, where $R_{1} \\rightarrow \\infty$ and $R_{2}=0$. This circuit is illustrated in Fig. 6.3c, and its gain approaches unity if $a \\gg 1$."
},
{
    "text": "The noninverting amplifier is depicted in Fig. 6.3b. ${ }^{1,2,3}$ Referring to Fig. 6.1, it is assumed that no current enters the inverting op-amp input terminal. Given an open-loop gain of $a$, we have $V_{i}=V_{o} / a$ and\n\n$$\n\\begin{equation*}\nV_{x}=V_{o}\\left(\\frac{R_{1}}{R_{1}+R_{2}}\\right)=V_{s}-\\frac{V_{o}}{a} \\tag{6.11}\n\\end{equation*}\n$$\n\nRearranging equation (6.11) yields\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\left(1+\\frac{R_{2}}{R_{1}}\\right) \\frac{\\frac{a R_{1}}{R_{1}+R_{2}}}{1+\\frac{a R_{1}}{R_{1}+R_{2}}} \\simeq\\left(1+\\frac{R_{2}}{R_{1}}\\right) \\tag{6.12}\n\\end{equation*}\n$$\n\nThe approximation in (6.12) holds true as long as $a R_{1} /\\left(R_{1}+R_{2}\\right) \\gg 1$.\nUnlike the inverting configuration, this circuit exhibits a significantly high input resistance as perceived by $V_{s}$ due to the nature of the feedback employed. (Refer to Chapter 8.) Additionally, unlike the inverting setup, the noninverting connection results in the op amp's common-mode input voltage being equal to $V_{s}$. A notable variant of this configuration is the voltage follower, where $R_{1} \\rightarrow \\infty$ and $R_{2}=0$. This circuit is illustrated in Fig. 6.3c, and its gain approaches unity when $a \\gg 1$."
},
{
    "text": "The noninverting amplifier is depicted in Fig. 6.3b. ${ }^{1,2,3}$ Referring to Fig. 6.1, it is assumed that no current enters the inverting op-amp input terminal. With an open-loop gain of $a$, we have $V_{i}=V_{o} / a$ and\n\n$$\n\\begin{equation*}\nV_{x}=V_{o}\\left(\\frac{R_{1}}{R_{1}+R_{2}}\\right)=V_{s}-\\frac{V_{o}}{a} \\tag{6.11}\n\\end{equation*}\n$$\n\nRewriting equation (6.11) yields\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\left(1+\\frac{R_{2}}{R_{1}}\\right) \\frac{\\frac{a R_{1}}{R_{1}+R_{2}}}{1+\\frac{a R_{1}}{R_{1}+R_{2}}} \\approx\\left(1+\\frac{R_{2}}{R_{1}}\\right) \\tag{6.12}\n\\end{equation*}\n$$\n\nThe approximation in (6.12) holds true when $a R_{1} /\\left(R_{1}+R_{2}\\right) \\gg 1$.\nUnlike the inverting configuration, this circuit exhibits a significantly high input resistance as viewed by $V_{s}$ due to the nature of the feedback employed. (Refer to Chapter 8.) Additionally, unlike the inverting setup, the noninverting connection results in the op amp's common-mode input voltage being equal to $V_{s}$. A notable variation of this configuration is the voltage follower, where $R_{1} \\rightarrow \\infty$ and $R_{2}=0$. This circuit is illustrated in Fig. 6.3c, and its gain approaches unity if $a \\gg 1$."
},
{
    "text": "The noninverting amplifier is depicted in Fig. 6.3b. ${ }^{1,2,3}$ Referring to Fig. 6.1, it is assumed that no current enters the inverting op-amp input terminal. Given an open-loop gain of $a$, $V_{i}$ equals $V_{o} / a$, and\n\n$$\n\\begin{equation*}\nV_{x}=V_{o}\\left(\\frac{R_{1}}{R_{1}+R_{2}}\\right)=V_{s}-\\frac{V_{o}}{a} \\tag{6.11}\n\\end{equation*}\n$$\n\nRearranging equation (6.11) yields\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\left(1+\\frac{R_{2}}{R_{1}}\\right) \\frac{\\frac{a R_{1}}{R_{1}+R_{2}}}{1+\\frac{a R_{1}}{R_{1}+R_{2}}} \\approx\\left(1+\\frac{R_{2}}{R_{1}}\\right) \\tag{6.12}\n\\end{equation*}\n$$\n\nThe approximation in (6.12) holds true when $a R_{1} /\\left(R_{1}+R_{2}\\right) \\gg 1$.\nUnlike the inverting configuration, this circuit exhibits a significantly high input resistance as perceived by $V_{s}$ due to the nature of the feedback employed. (Refer to Chapter 8.) Additionally, unlike the inverting scenario, the noninverting setup results in the op amp's common-mode input voltage being equivalent to $V_{s}$. A notable variant of this configuration is the voltage follower, where $R_{1} \\rightarrow \\infty$ and $R_{2}=0$. This circuit is illustrated in Fig. 6.3c, and its gain approaches unity if $a \\gg 1$."
},
{
    "text": "The noninverting amplifier is depicted in Fig. 6.3b. ${ }^{1,2,3}$ Referring to Fig. 6.1, it is assumed that no current enters the inverting op-amp input terminal. Given an open-loop gain of $a$, we have $V_{i}=V_{o} / a$ and\n\n$$\n\\begin{equation*}\nV_{x}=V_{o}\\left(\\frac{R_{1}}{R_{1}+R_{2}}\\right)=V_{s}-\\frac{V_{o}}{a} \\tag{6.11}\n\\end{equation*}\n$$\n\nRewriting equation (6.11) yields\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\left(1+\\frac{R_{2}}{R_{1}}\\right) \\frac{\\frac{a R_{1}}{R_{1}+R_{2}}}{1+\\frac{a R_{1}}{R_{1}+R_{2}}} \\approx\\left(1+\\frac{R_{2}}{R_{1}}\\right) \\tag{6.12}\n\\end{equation*}\n$$\n\nThe approximation in (6.12) holds true when $a R_{1} /\\left(R_{1}+R_{2}\\right) \\gg 1$.\nUnlike the inverting configuration, this circuit exhibits a significantly high input resistance as perceived by $V_{s}$ due to the nature of the feedback employed. (Refer to Chapter 8.) Additionally, in contrast to the inverting setup, the noninverting connection results in the op amp's common-mode input voltage being equal to $V_{s}$. A notable variant of this configuration is the voltage follower, where $R_{1} \\rightarrow \\infty$ and $R_{2}=0$. This circuit is illustrated in Fig. 6.3c, and its gain approaches unity when $a \\gg 1$."
},
{
    "text": "The differential amplifier serves to amplify the difference between two voltages. The circuit is depicted in Fig. 6.4. ${ }^{1,2}$ In this setup, $I_{i 1}=0$, causing resistors $R_{1}$ and $R_{2}$ to create a voltage divider. The configuration is detailed as follows:\n\nImage Description:\n[\nname: V1, type: VoltageSource, value: V1, ports: {Np: V1, Nn: GND}\nname: V2, type: VoltageSource, value: V2, ports: {Np: V2, Nn: GND}\nname: R1, type: Resistor, value: R1, ports: {N1: V1, N2: Vx}\nname: R1, type: Resistor, value: R1, ports: {N1: V2, N2: Vy}\nname: R2, type: Resistor, value: R2, ports: {N1: Vy, N2: Vo}\nname: R2, type: Resistor, value: R2, ports: {N1: Vx, N2: GND}\nname: A0, type: OpAmp, value: A0, ports: {InP: Vx, InN: Vy, OutP: Vo}\n]\n\nAdditional Info: This circuit represents a differential amplifier configuration, enhancing the difference between two input voltages, V1 and V2. The output voltage Vo is influenced by the interplay between resistors R1 and R2 and the input voltages.\n\nFigure 6.4 Differential amplifier configuration.\n\nThe voltage $V_{x}$ is expressed by\n\n$$\n\\begin{equation*}\nV_{x}=V_{1}\\left(\\frac{R_{2}}{R_{1}+R_{2}}\\right) \\tag{6.13}\n\\end{equation*}\n$$\n\nThe current $I_{1}$ is\n\n$$\n\\begin{equation*}\nI_{1}=\\left(\\frac{V_{2}-V_{y}}{R_{1}}\\right)=I_{2} \\tag{6.14}\n\\end{equation*}\n$$\n\nThe output voltage is calculated as\n\n$$\n\\begin{equation*}\nV_{o}=V_{y}-I_{2} R_{2} \\tag{6.15}\n\\end{equation*}\n$$\n\nWith an infinite open-loop gain, the summing-point constraint $V_{i}=0$ holds, leading to $V_{y}=V_{x}$. Substituting $V_{y}=V_{x}$, (6.13), and (6.14) into (6.15) and rearranging yields\n\n$$\n\\begin{equation*}\nV_{o}=\\frac{R_{2}}{R_{1}}\\left(V_{1}-V_{2}\\right) \\tag{6.16}\n\\end{equation*}\n$$\n\nThus, the circuit amplifies the differential voltage ( $V_{1}-V_{2}$ ). Differential amplifiers are essential for detecting and amplifying minor differences between significant voltages. A common application is measuring the differential voltage across the arms of a Wheatstone bridge. Similar to noninverting amplifiers, the op amp in Fig. 6.4 encounters a common-mode input nearly equal to the common-mode voltage ( $V_{1}+V_{2}$ )/2 at the input terminals when $R_{2} \\gg R_{1}$."
},
{
    "text": "The differential amplifier serves to amplify the difference between two voltages. The circuit is depicted in Fig. 6.4. ${ }^{1,2}$ In this circuit, $I_{i 1}=0$, resulting in resistors $R_{1}$ and $R_{2}$ forming a voltage divider. \n\nimage_name: Figure 6.4 Differential amplifier configuration\ndescription:\n[\nname: V1, type: VoltageSource, value: V1, ports: {Np: V1, Nn: GND}\nname: V2, type: VoltageSource, value: V2, ports: {Np: V2, Nn: GND}\nname: R1, type: Resistor, value: R1, ports: {N1: V1, N2: Vx}\nname: R1, type: Resistor, value: R1, ports: {N1: V2, N2: Vy}\nname: R2, type: Resistor, value: R2, ports: {N1: Vy, N2: Vo}\nname: R2, type: Resistor, value: R2, ports: {N1: Vx, N2: GND}\nname: A0, type: OpAmp, value: A0, ports: {InP: Vx, InN: Vy, OutP: Vo}\n]\nextrainfo: This circuit represents a differential amplifier configuration. It enhances the difference between two input voltages, V1 and V2. The output voltage Vo is influenced by the relationship among resistors R1 and R2 and the input voltages.\n\nFigure 6.4 Differential amplifier configuration.\nThe voltage $V_{x}$ is subsequently calculated as\n\n$$\n\\begin{equation*}\nV_{x}=V_{1}\\left(\\frac{R_{2}}{R_{1}+R_{2}}\\right) \\tag{6.13}\n\\end{equation*}\n$$\n\nThe current $I_{1}$ is determined by\n\n$$\n\\begin{equation*}\nI_{1}=\\left(\\frac{V_{2}-V_{y}}{R_{1}}\\right)=I_{2} \\tag{6.14}\n\\end{equation*}\n$$\n\nThe output voltage is expressed as\n\n$$\n\\begin{equation*}\nV_{o}=V_{y}-I_{2} R_{2} \\tag{6.15}\n\\end{equation*}\n$$\n\nWhen the open-loop gain is infinite, the summing-point constraint $V_{i}=0$ holds true, enforcing $V_{y}=V_{x}$. By substituting $V_{y}=V_{x}$, (6.13), and (6.14) into (6.15) and rearranging, we obtain\n\n$$\n\\begin{equation*}\nV_{o}=\\frac{R_{2}}{R_{1}}\\left(V_{1}-V_{2}\\right) \\tag{6.16}\n\\end{equation*}\n$$\n\nThus, the circuit amplifies the difference voltage ( $V_{1}-V_{2}$ ). Differential amplifiers are frequently needed to detect and amplify minor differences between two substantial voltages. A common application is measuring the difference voltage across the two arms of a Wheatstone bridge. Similar to the noninverting amplifier, the op amp in Fig. 6.4 encounters a common-mode input nearly equivalent to the common-mode voltage ( $V_{1}+V_{2}$ )/2 at the input terminals when $R_{2} \\gg R_{1}$."
},
{
    "text": "The differential amplifier serves to amplify the disparity between two voltages. The circuit is depicted in Fig. 6.4. ${ }^{1,2}$ For this configuration, $I_{i 1}=0$, meaning resistors $R_{1}$ and $R_{2}$ constitute a voltage\nimage_name:Figure 6.4 Differential amplifier setup\ndescription:\n[\nname: V1, type: VoltageSource, value: V1, ports: {Np: V1, Nn: GND}\nname: V2, type: VoltageSource, value: V2, ports: {Np: V2, Nn: GND}\nname: R1, type: Resistor, value: R1, ports: {N1: V1, N2: Vx}\nname: R1, type: Resistor, value: R1, ports: {N1: V2, N2: Vy}\nname: R2, type: Resistor, value: R2, ports: {N1: Vy, N2: Vo}\nname: R2, type: Resistor, value: R2, ports: {N1: Vx, N2: GND}\nname: A0, type: OpAmp, value: A0, ports: {InP: Vx, InN: Vy, OutP: Vo}\n]\nextrainfo:This setup is a differential amplifier. It enhances the difference between input voltages V1 and V2. The output voltage Vo is governed by the interplay between resistors R1 and R2 and the input voltages.\n\nFigure 6.4 Differential amplifier setup.\ndivider. Consequently, the voltage $V_{x}$ is expressed as\n\n$$\n\\begin{equation*}\nV_{x}=V_{1}\\left(\\frac{R_{2}}{R_{1}+R_{2}}\\right) \\tag{6.13}\n\\end{equation*}\n$$\n\nThe current $I_{1}$ is calculated as\n\n$$\n\\begin{equation*}\nI_{1}=\\left(\\frac{V_{2}-V_{y}}{R_{1}}\\right)=I_{2} \\tag{6.14}\n\\end{equation*}\n$$\n\nThe output voltage is determined by\n\n$$\n\\begin{equation*}\nV_{o}=V_{y}-I_{2} R_{2} \\tag{6.15}\n\\end{equation*}\n$$\n\nWith an infinite open-loop gain, the summing-point constraint $V_{i}=0$ holds true, enforcing $V_{y}=V_{x}$. By substituting $V_{y}=V_{x}$, (6.13), and (6.14) into (6.15) and rearranging, we obtain\n\n$$\n\\begin{equation*}\nV_{o}=\\frac{R_{2}}{R_{1}}\\left(V_{1}-V_{2}\\right) \\tag{6.16}\n\\end{equation*}\n$$\n\nThus, the circuit amplifies the difference voltage ( $V_{1}-V_{2}$ ).\nDifferential amplifiers are frequently needed to detect and amplify minor differences between two substantial voltages. A common application is measuring the difference voltage across the two arms of a Wheatstone bridge. Similar to the noninverting amplifier, the op amp in Fig. 6.4 encounters a common-mode input nearly equivalent to the common-mode voltage ( $V_{1}+V_{2}$ )/2 at the input terminals when $R_{2} \\gg R_{1}$."
},
{
    "text": "The differential amplifier serves to amplify the disparity between two voltages. The circuit is depicted in Fig. 6.4. ${ }^{1,2}$ For this configuration, $I_{i 1}=0$, hence resistors $R_{1}$ and $R_{2}$ constitute a voltage\nimage_name: Figure 6.4 Differential amplifier setup\ndescription:\n[\nname: V1, type: VoltageSource, value: V1, ports: {Np: V1, Nn: GND}\nname: V2, type: VoltageSource, value: V2, ports: {Np: V2, Nn: GND}\nname: R1, type: Resistor, value: R1, ports: {N1: V1, N2: Vx}\nname: R1, type: Resistor, value: R1, ports: {N1: V2, N2: Vy}\nname: R2, type: Resistor, value: R2, ports: {N1: Vy, N2: Vo}\nname: R2, type: Resistor, value: R2, ports: {N1: Vx, N2: GND}\nname: A0, type: OpAmp, value: A0, ports: {InP: Vx, InN: Vy, OutP: Vo}\n]\nextrainfo: The setup is a differential amplifier configuration. It enhances the difference between two input voltages V1 and V2. The output voltage Vo is dictated by the relationship among the resistors R1 and R2 and the input voltages.\n\nFigure 6.4 Differential amplifier setup.\ndivider. The voltage $V_{x}$ is subsequently expressed as\n\n$$\n\\begin{equation*}\nV_{x}=V_{1}\\left(\\frac{R_{2}}{R_{1}+R_{2}}\\right) \\tag{6.13}\n\\end{equation*}\n$$\n\nThe current $I_{1}$ is\n\n$$\n\\begin{equation*}\nI_{1}=\\left(\\frac{V_{2}-V_{y}}{R_{1}}\\right)=I_{2} \\tag{6.14}\n\\end{equation*}\n$$\n\nThe output voltage is articulated as\n\n$$\n\\begin{equation*}\nV_{o}=V_{y}-I_{2} R_{2} \\tag{6.15}\n\\end{equation*}\n$$\n\nWhen the open-loop gain is infinite, the summing-point constraint $V_{i}=0$ holds true, compelling $V_{y}=V_{x}$. By substituting $V_{y}=V_{x}$, (6.13), and (6.14) into (6.15) and rearranging, we obtain\n\n$$\n\\begin{equation*}\nV_{o}=\\frac{R_{2}}{R_{1}}\\left(V_{1}-V_{2}\\right) \\tag{6.16}\n\\end{equation*}\n$$\n\nThus, the circuit amplifies the difference voltage ( $V_{1}-V_{2}$ ).\nDifferential amplifiers are frequently needed to detect and amplify minor differences between two substantial voltages. For instance, a common application involves measuring the difference voltage between the two branches of a Wheatstone bridge. Similar to the noninverting amplifier, the op amp in Fig. 6.4 encounters a common-mode input nearly equivalent to the common-mode voltage ( $V_{1}+V_{2}$ )/2 applied to the input terminals when $R_{2} \\gg R_{1}$."
},
{
    "text": "The differential amplifier is employed to enhance the disparity between two voltages. This circuit is depicted in Fig. 6.4. ${ }^{1,2}$ In this configuration, $I_{i 1}=0$, resulting in resistors $R_{1}$ and $R_{2}$ creating a voltage divider. \n\nimage_name: Figure 6.4 Differential amplifier setup\ndescription:\n[\nname: V1, type: VoltageSource, value: V1, ports: {Np: V1, Nn: GND}\nname: V2, type: VoltageSource, value: V2, ports: {Np: V2, Nn: GND}\nname: R1, type: Resistor, value: R1, ports: {N1: V1, N2: Vx}\nname: R1, type: Resistor, value: R1, ports: {N1: V2, N2: Vy}\nname: R2, type: Resistor, value: R2, ports: {N1: Vy, N2: Vo}\nname: R2, type: Resistor, value: R2, ports: {N1: Vx, N2: GND}\nname: A0, type: OpAmp, value: A0, ports: {InP: Vx, InN: Vy, OutP: Vo}\n]\nextrainfo: The setup is a differential amplifier configuration. It enhances the difference between two input voltages, V1 and V2. The output voltage, Vo, is influenced by the relationship among resistors R1 and R2 and the input voltages.\n\nFigure 6.4 Differential amplifier setup.\nThe voltage $V_{x}$ is subsequently calculated by\n\n$$\n\\begin{equation*}\nV_{x}=V_{1}\\left(\\frac{R_{2}}{R_{1}+R_{2}}\\right) \\tag{6.13}\n\\end{equation*}\n$$\n\nThe current $I_{1}$ is\n\n$$\n\\begin{equation*}\nI_{1}=\\left(\\frac{V_{2}-V_{y}}{R_{1}}\\right)=I_{2} \\tag{6.14}\n\\end{equation*}\n$$\n\nThe output voltage is expressed as\n\n$$\n\\begin{equation*}\nV_{o}=V_{y}-I_{2} R_{2} \\tag{6.15}\n\\end{equation*}\n$$\n\nWhen the open-loop gain is infinite, the summing-point constraint $V_{i}=0$ holds true, necessitating $V_{y}=V_{x}$. By substituting $V_{y}=V_{x}$, (6.13), and (6.14) into (6.15) and rearranging, we obtain\n\n$$\n\\begin{equation*}\nV_{o}=\\frac{R_{2}}{R_{1}}\\left(V_{1}-V_{2}\\right) \\tag{6.16}\n\\end{equation*}\n$$\n\nThus, the circuit amplifies the difference voltage ( $V_{1}-V_{2}$ ).\nDifferential amplifiers are frequently needed to detect and amplify minor differences between two substantial voltages. A common application is measuring the difference voltage across the two arms of a Wheatstone bridge. Similar to the noninverting amplifier, the op amp in Fig. 6.4 encounters a common-mode input nearly equivalent to the common-mode voltage ( $V_{1}+V_{2}$ )/2 at the input terminals when $R_{2} \\gg R_{1}$."
},
{
    "text": "The differential amplifier is designed to enhance the disparity between two voltage levels. This configuration is illustrated in Fig. 6.4. ${ }^{1,2}$ In this setup, $I_{i 1}=0$, resulting in resistors $R_{1}$ and $R_{2}$ creating a voltage divider. \n\nimage_name: Figure 6.4 Differential amplifier configuration\ndescription:\n[\nname: V1, type: VoltageSource, value: V1, ports: {Np: V1, Nn: GND}\nname: V2, type: VoltageSource, value: V2, ports: {Np: V2, Nn: GND}\nname: R1, type: Resistor, value: R1, ports: {N1: V1, N2: Vx}\nname: R1, type: Resistor, value: R1, ports: {N1: V2, N2: Vy}\nname: R2, type: Resistor, value: R2, ports: {N1: Vy, N2: Vo}\nname: R2, type: Resistor, value: R2, ports: {N1: Vx, N2: GND}\nname: A0, type: OpAmp, value: A0, ports: {InP: Vx, InN: Vy, OutP: Vo}\n]\nextrainfo: This circuit represents a differential amplifier setup. It boosts the difference between two input voltages, V1 and V2. The output voltage, Vo, is influenced by the interplay between resistors R1 and R2 and the input voltages.\n\nFigure 6.4 Differential amplifier configuration.\nThe voltage $V_{x}$ can be expressed as\n\n$$\n\\begin{equation*}\nV_{x}=V_{1}\\left(\\frac{R_{2}}{R_{1}+R_{2}}\\right) \\tag{6.13}\n\\end{equation*}\n$$\n\nThe current $I_{1}$ is calculated as\n\n$$\n\\begin{equation*}\nI_{1}=\\left(\\frac{V_{2}-V_{y}}{R_{1}}\\right)=I_{2} \\tag{6.14}\n\\end{equation*}\n$$\n\nThe output voltage is determined by\n\n$$\n\\begin{equation*}\nV_{o}=V_{y}-I_{2} R_{2} \\tag{6.15}\n\\end{equation*}\n$$\n\nWhen the open-loop gain is infinitely large, the summing-point constraint $V_{i}=0$ holds true, leading to $V_{y}=V_{x}$. By substituting $V_{y}=V_{x}$, (6.13), and (6.14) into (6.15) and rearranging, we obtain\n\n$$\n\\begin{equation*}\nV_{o}=\\frac{R_{2}}{R_{1}}\\left(V_{1}-V_{2}\\right) \\tag{6.16}\n\\end{equation*}\n$$\n\nThus, the circuit enhances the difference voltage ( $V_{1}-V_{2}$ ). Differential amplifiers are frequently employed to detect and amplify minor differences between two substantial voltages. A common application is measuring the voltage difference across the two branches of a Wheatstone bridge. Similar to the noninverting amplifier, the operational amplifier in Fig. 6.4 encounters a common-mode input nearly equivalent to the common-mode voltage ( $V_{1}+V_{2}$ )/2 at the input terminals when $R_{2} \\gg R_{1}$."
},
{
    "text": "The differential amplifier is employed to enhance the disparity between two voltages. The circuit is depicted in Fig. 6.4. ${ }^{1,2}$ In this setup, $I_{i 1}=0$, leading to resistors $R_{1}$ and $R_{2}$ creating a voltage divider. \n\nimage_name: Figure 6.4 Differential amplifier configuration\ndescription:\n[\nname: V1, type: VoltageSource, value: V1, ports: {Np: V1, Nn: GND}\nname: V2, type: VoltageSource, value: V2, ports: {Np: V2, Nn: GND}\nname: R1, type: Resistor, value: R1, ports: {N1: V1, N2: Vx}\nname: R1, type: Resistor, value: R1, ports: {N1: V2, N2: Vy}\nname: R2, type: Resistor, value: R2, ports: {N1: Vy, N2: Vo}\nname: R2, type: Resistor, value: R2, ports: {N1: Vx, N2: GND}\nname: A0, type: OpAmp, value: A0, ports: {InP: Vx, InN: Vy, OutP: Vo}\n]\nextrainfo: This circuit represents a differential amplifier configuration. It enhances the difference between two input voltages, V1 and V2. The output voltage, Vo, is governed by the interplay between the resistors R1 and R2 and the input voltages.\n\nFigure 6.4 Differential amplifier configuration.\nThe voltage $V_{x}$ is subsequently calculated as\n\n$$\n\\begin{equation*}\nV_{x}=V_{1}\\left(\\frac{R_{2}}{R_{1}+R_{2}}\\right) \\tag{6.13}\n\\end{equation*}\n$$\n\nThe current $I_{1}$ is determined by\n\n$$\n\\begin{equation*}\nI_{1}=\\left(\\frac{V_{2}-V_{y}}{R_{1}}\\right)=I_{2} \\tag{6.14}\n\\end{equation*}\n$$\n\nThe output voltage is expressed as\n\n$$\n\\begin{equation*}\nV_{o}=V_{y}-I_{2} R_{2} \\tag{6.15}\n\\end{equation*}\n$$\n\nWhen the open-loop gain is infinite, the summing-point constraint $V_{i}=0$ holds true, compelling $V_{y}=V_{x}$. By substituting $V_{y}=V_{x}$, (6.13), and (6.14) into (6.15) and rearranging, we obtain\n\n$$\n\\begin{equation*}\nV_{o}=\\frac{R_{2}}{R_{1}}\\left(V_{1}-V_{2}\\right) \\tag{6.16}\n\\end{equation*}\n$$\n\nThus, the circuit amplifies the difference voltage ( $V_{1}-V_{2}$ ). Differential amplifiers are frequently needed to detect and amplify minor differences between two substantial voltages. A common application is measuring the difference voltage across the two branches of a Wheatstone bridge. Similar to the noninverting amplifier, the op amp in Fig. 6.4 encounters a common-mode input nearly equivalent to the common-mode voltage ( $V_{1}+V_{2}$ )/2 at the input terminals when $R_{2} \\gg R_{1}$."
},
{
    "text": "The differential amplifier is utilized to enhance the disparity between two voltages. The configuration is depicted in Fig. 6.4. ${ }^{1,2}$ For this setup, $I_{i 1}=0$, hence resistors $R_{1}$ and $R_{2}$ constitute a voltage\nimage_name: Figure 6.4 Differential amplifier setup\ndescription:\n[\nname: V1, type: VoltageSource, value: V1, ports: {Np: V1, Nn: GND}\nname: V2, type: VoltageSource, value: V2, ports: {Np: V2, Nn: GND}\nname: R1, type: Resistor, value: R1, ports: {N1: V1, N2: Vx}\nname: R1, type: Resistor, value: R1, ports: {N1: V2, N2: Vy}\nname: R2, type: Resistor, value: R2, ports: {N1: Vy, N2: Vo}\nname: R2, type: Resistor, value: R2, ports: {N1: Vx, N2: GND}\nname: A0, type: OpAmp, value: A0, ports: {InP: Vx, InN: Vy, OutP: Vo}\n]\nextrainfo: The setup is a differential amplifier configuration. It enhances the difference between two input voltages V1 and V2. The output voltage Vo is dictated by the relationship among the resistors R1 and R2 and the input voltages.\n\nFigure 6.4 Differential amplifier setup.\ndivider. The voltage $V_{x}$ is subsequently determined by\n\n$$\n\\begin{equation*}\nV_{x}=V_{1}\\left(\\frac{R_{2}}{R_{1}+R_{2}}\\right) \\tag{6.13}\n\\end{equation*}\n$$\n\nThe current $I_{1}$ is\n\n$$\n\\begin{equation*}\nI_{1}=\\left(\\frac{V_{2}-V_{y}}{R_{1}}\\right)=I_{2} \\tag{6.14}\n\\end{equation*}\n$$\n\nThe output voltage is expressed as\n\n$$\n\\begin{equation*}\nV_{o}=V_{y}-I_{2} R_{2} \\tag{6.15}\n\\end{equation*}\n$$\n\nIf the open-loop gain is infinite, the summing-point constraint that $V_{i}=0$ holds true, compelling $V_{y}=V_{x}$. By substituting $V_{y}=V_{x}$, (6.13), and (6.14) into (6.15) and rearranging, we obtain\n\n$$\n\\begin{equation*}\nV_{o}=\\frac{R_{2}}{R_{1}}\\left(V_{1}-V_{2}\\right) \\tag{6.16}\n\\end{equation*}\n$$\n\nThus, the circuit amplifies the difference voltage ( $V_{1}-V_{2}$ ).\nDifferential amplifiers are frequently needed to detect and amplify minor discrepancies between two substantial voltages. For instance, a common application is measuring the difference voltage across the two arms of a Wheatstone bridge. Similar to the noninverting amplifier, the op amp in Fig. 6.4 encounters a common-mode input nearly equivalent to the common-mode voltage ( $V_{1}+V_{2}$ )/2 applied to the input terminals when $R_{2} \\gg R_{1}$."
},
{
    "text": "By incorporating nonlinear components into the feedback network, operational amplifiers (op amps) can execute nonlinear operations on one or more analog signals. The logarithmic amplifier, depicted in Fig. 6.5, exemplifies such an application. Logarithmic amplifiers are extensively used in instrumentation systems where signals with a broad dynamic range need to be detected and recorded. The functioning of this circuit can be comprehended by applying summing-point constraints. Given that the input voltage of the op amp must be zero, the resistor $R$ transforms the input voltage $V_{s}$ into a current. This current subsequently flows into the transistor's collector. Hence, the circuit ensures that the transistor's collector current is proportional to the input voltage. Additionally, the transistor operates in the forward-active region due to $V_{C B} \\simeq 0$. Since the base-emitter voltage of a bipolar transistor in the forward-active region is logarithmically related to the collector current, and the output voltage corresponds to the transistor's emitter-base voltage, a logarithmic transfer characteristic is achieved. Mathematically,\n\n$$\n\\begin{equation*}\nI_{1}=\\frac{V_{s}}{R}=I_{c}=I_{S}\\left[\\exp \\left(\\frac{V_{b e}}{V_{T}}\\right)-1\\right] \\simeq I_{S} \\exp \\left(\\frac{V_{b e}}{V_{T}}\\right) \\tag{6.17}\n\\end{equation*}\n$$\n\nimage_name:Figure 6.5 Logarithmic amplifier configuration\ndescription:\n[\nname: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\nname: R, type: Resistor, value: R, ports: {N1: Vs, N2: InN(A0)}\nname: A0, type: OpAmp, value: A0, ports: {InP: GND, InN: InN(A0), Out: Vo}\nname: NMOS, type: NMOS, ports: {S: V0, D: InN(A0), G: GND}\n]\nextrainfo:The circuit represents a logarithmic amplifier configuration utilizing an op-amp and an NMOS transistor. The input voltage Vs is transformed into a logarithmic output voltage Vo. The op-amp A0 is set up with negative feedback via the NMOS transistor, facilitating the logarithmic characteristic. The resistor R is串联 with the input voltage source.\n\nFigure 6.5 Logarithmic amplifier configuration.\nand\n\n$$\n\\begin{equation*}\nV_{o}=-V_{b e} \\tag{6.18}\n\\end{equation*}\n$$\n\nThus\n\n$$\n\\begin{equation*}\nV_{o}=-V_{T} \\ln \\left(\\frac{V_{s}}{I_{S} R}\\right) \\tag{6.19}\n\\end{equation*}\n$$\n\nThe logarithmic amplifier is just one instance among numerous op-amp applications where a nonlinear feedback element is employed to create a nonlinear transfer characteristic. For instance, two log amplifiers can compute the logarithms of two distinct signals. These voltages can be summed, and the exponential of the sum can be derived using an inverting amplifier configuration with $R_{1}$ replaced by a diode, resulting in an analog multiplier. Other nonlinear operations, such as limiting, rectification, peak detection, squaring, square rooting, exponentiation, and division, can be executed using similar conceptual approaches."
},
{
    "text": "By incorporating nonlinear elements into the feedback network, operational amplifiers can execute nonlinear operations on one or more analog signals. The logarithmic amplifier, depicted in Fig. 6.5, exemplifies such an application. Logarithmic amplifiers are extensively used in instrumentation systems that require sensing and recording signals with vast dynamic ranges. The circuit's operation can be comprehended through the application of summing-point constraints. Since the input voltage of the op amp must be zero, resistor $R$ converts the input voltage $V_{s}$ into a current, which then flows into the transistor's collector. This ensures the collector current is proportional to the input voltage. The transistor operates in the forward-active region due to $V_{C B} \\simeq 0$. Given that the base-emitter voltage of a bipolar transistor in this region logarithmically relates to the collector current, and the output voltage equals the transistor's emitter-base voltage, a logarithmic transfer characteristic is achieved. Mathematically,\n\n$$\n\\begin{equation*}\nI_{1}=\\frac{V_{s}}{R}=I_{c}=I_{S}\\left[\\exp \\left(\\frac{V_{b e}}{V_{T}}\\right)-1\\right] \\simeq I_{S} \\exp \\left(\\frac{V_{b e}}{V_{T}}\\right) \\tag{6.17}\n\\end{equation*}\n$$\n\nimage_name:Figure 6.5 Logarithmic amplifier configuration\ndescription:\n[\nname: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\nname: R, type: Resistor, value: R, ports: {N1: Vs, N2: InN(A0)}\nname: A0, type: OpAmp, value: A0, ports: {InP: GND, InN: InN(A0), Out: Vo}\nname: NMOS, type: NMOS, ports: {S: V0, D: InN(A0), G: GND}\n]\nextrainfo:The circuit is a logarithmic amplifier configuration using an op-amp and an NMOS transistor. The input voltage Vs is converted into a logarithmic output voltage Vo. The op-amp A0 is configured with negative feedback through the NMOS transistor, achieving the logarithmic characteristic. The resistor R is connected in series with the input voltage source.\n\nFigure 6.5 Logarithmic amplifier configuration.\nand\n\n$$\n\\begin{equation*}\nV_{o}=-V_{b e} \\tag{6.18}\n\\end{equation*}\n$$\n\nThus\n\n$$\n\\begin{equation*}\nV_{o}=-V_{T} \\ln \\left(\\frac{V_{s}}{I_{S} R}\\right) \\tag{6.19}\n\\end{equation*}\n$$\n\nThe logarithmic amplifier is just one instance among numerous op-amp applications where a nonlinear feedback element creates a nonlinear transfer characteristic. For instance, two log amplifiers can compute the logarithms of two distinct signals, whose voltages can be summed and then exponentiated using an inverting amplifier with $R_{1}$ replaced by a diode, resulting in an analog multiplier. Other nonlinear operations, such as limiting, rectification, peak detection, squaring, square rooting, power functions, and division, can be implemented using similar conceptual approaches."
},
{
    "text": "By incorporating nonlinear components into the feedback network, operational amplifiers can execute nonlinear operations on one or more analog signals. The logarithmic amplifier, depicted in Fig. 6.5, exemplifies such an application. These amplifiers are extensively used in instrumentation systems where signals with vast dynamic ranges need to be detected and recorded. The circuit's functionality can be comprehended through the application of summing-point constraints. Since the op amp's input voltage must be zero, resistor $R$ transforms the input voltage $V_{s}$ into a current, which then flows into the transistor's collector. This ensures the collector current is proportional to the input voltage. Additionally, the transistor operates in the forward-active region due to $V_{C B} \\simeq 0$. Given that the base-emitter voltage of a bipolar transistor in this region is logarithmically related to the collector current, and the output voltage corresponds to the transistor's emitter-base voltage, a logarithmic transfer characteristic is achieved. Mathematically,\n\n$$\n\\begin{equation*}\nI_{1}=\\frac{V_{s}}{R}=I_{c}=I_{S}\\left[\\exp \\left(\\frac{V_{b e}}{V_{T}}\\right)-1\\right] \\simeq I_{S} \\exp \\left(\\frac{V_{b e}}{V_{T}}\\right) \\tag{6.17}\n\\end{equation*}\n$$\n\nimage_name:Figure 6.5 Logarithmic amplifier configuration\ndescription:\n[\nname: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\nname: R, type: Resistor, value: R, ports: {N1: Vs, N2: InN(A0)}\nname: A0, type: OpAmp, value: A0, ports: {InP: GND, InN: InN(A0), Out: Vo}\nname: NMOS, type: NMOS, ports: {S: V0, D: InN(A0), G: GND}\n]\nextrainfo:The circuit is a logarithmic amplifier configuration using an op-amp and an NMOS transistor. The input voltage Vs is converted into a logarithmic output voltage Vo. The op-amp A0 is configured with negative feedback through the NMOS transistor, which helps achieve the logarithmic characteristic. The resistor R is connected in series with the input voltage source.\n\nFigure 6.5 Logarithmic amplifier configuration.\nand\n\n$$\n\\begin{equation*}\nV_{o}=-V_{b e} \\tag{6.18}\n\\end{equation*}\n$$\n\nThus\n\n$$\n\\begin{equation*}\nV_{o}=-V_{T} \\ln \\left(\\frac{V_{s}}{I_{S} R}\\right) \\tag{6.19}\n\\end{equation*}\n$$\n\nThe logarithmic amplifier is just one instance among numerous op-amp applications where a nonlinear feedback element creates a nonlinear transfer characteristic. For instance, two log amplifiers can compute the logarithms of two distinct signals, whose voltages can then be summed. An inverting amplifier configuration, with $R_{1}$ replaced by a diode, can subsequently derive the exponential of the sum, resulting in an analog multiplier. Similarly, other nonlinear operations such as limiting, rectification, peak detection, squaring, square rooting, power functions, and division can be implemented using analogous methodologies."
},
{
    "text": "By incorporating nonlinear components into the feedback network, operational amplifiers (op amps) can execute nonlinear operations on one or more analog signals. The logarithmic amplifier, depicted in Fig. 6.5, exemplifies such an application. Logarithmic amplifiers are extensively used in instrumentation systems that require the sensing and recording of signals with vast dynamic ranges. The functioning of this circuit can be comprehended through the application of summing-point constraints. Given that the input voltage of the op amp must be zero, the resistor $R$ transforms the input voltage $V_{s}$ into a current. This current then flows into the transistor's collector. Consequently, the circuit ensures the transistor's collector current is proportional to the input voltage. Additionally, the transistor operates in the forward-active region due to $V_{C B} \\approx 0$. Since the base-emitter voltage of a bipolar transistor in the forward-active region is logarithmically related to the collector current, and the output voltage corresponds to the transistor's emitter-base voltage, a logarithmic transfer characteristic is achieved. The relevant equations are:\n\n$$\n\\begin{equation*}\nI_{1}=\\frac{V_{s}}{R}=I_{c}=I_{S}\\left[\\exp \\left(\\frac{V_{b e}}{V_{T}}\\right)-1\\right] \\approx I_{S} \\exp \\left(\\frac{V_{b e}}{V_{T}}\\right) \\tag{6.17}\n\\end{equation*}\n$$\n\nimage_name:Figure 6.5 Logarithmic amplifier configuration\ndescription:\n[\nname: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\nname: R, type: Resistor, value: R, ports: {N1: Vs, N2: InN(A0)}\nname: A0, type: OpAmp, value: A0, ports: {InP: GND, InN: InN(A0), Out: Vo}\nname: NMOS, type: NMOS, ports: {S: V0, D: InN(A0), G: GND}\n]\nextrainfo:The circuit is a logarithmic amplifier configuration using an op-amp and an NMOS transistor. The input voltage Vs is converted into a logarithmic output voltage Vo. The op-amp A0 is configured with negative feedback through the NMOS transistor, which helps achieve the logarithmic characteristic. The resistor R is connected in series with the input voltage source.\n\nFigure 6.5 Logarithmic amplifier configuration.\nand\n\n$$\n\\begin{equation*}\nV_{o}=-V_{b e} \\tag{6.18}\n\\end{equation*}\n$$\n\nThus\n\n$$\n\\begin{equation*}\nV_{o}=-V_{T} \\ln \\left(\\frac{V_{s}}{I_{S} R}\\right) \\tag{6.19}\n\\end{equation*}\n$$\n\nThe logarithmic amplifier is just one instance among numerous op-amp applications where a nonlinear feedback element is employed to create a nonlinear transfer characteristic. For instance, two log amplifiers can be utilized to compute the logarithms of two distinct signals. These voltages can be summed, and the exponential of the sum can be derived using an inverting amplifier setup with $R_{1}$ replaced by a diode, resulting in an analog multiplier. Other nonlinear operations, such as limiting, rectification, peak detection, squaring, square rooting, exponentiation, and division, can be executed using similar conceptual approaches."
},
{
    "text": "By incorporating nonlinear elements into the feedback network, operational amplifiers can execute nonlinear operations on one or more analog signals. The logarithmic amplifier, depicted in Fig. 6.5, exemplifies such an application. Logarithmic amplifiers are extensively used in instrumentation systems where signals with vast dynamic ranges need to be detected and recorded. The functioning of this circuit can be comprehended through the application of summing-point constraints. Since the input voltage of the op amp must be zero, the resistor $R$ transforms the input voltage $V_{s}$ into a current. This current subsequently flows into the transistor's collector. Consequently, the circuit ensures that the transistor's collector current is proportional to the input voltage. Moreover, the transistor operates in the forward-active region due to $V_{C B} \\simeq 0$. Given that the base-emitter voltage of a bipolar transistor in the forward-active region is logarithmically related to the collector current, and since the output voltage corresponds to the transistor's emitter-base voltage, a logarithmic transfer characteristic is achieved. Mathematically,\n\n$$\n\\begin{equation*}\nI_{1}=\\frac{V_{s}}{R}=I_{c}=I_{S}\\left[\\exp \\left(\\frac{V_{b e}}{V_{T}}\\right)-1\\right] \\simeq I_{S} \\exp \\left(\\frac{V_{b e}}{V_{T}}\\right) \\tag{6.17}\n\\end{equation*}\n$$\n\nimage_name:Figure 6.5 Logarithmic amplifier configuration\ndescription:\n[\nname: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\nname: R, type: Resistor, value: R, ports: {N1: Vs, N2: InN(A0)}\nname: A0, type: OpAmp, value: A0, ports: {InP: GND, InN: InN(A0), Out: Vo}\nname: NMOS, type: NMOS, ports: {S: V0, D: InN(A0), G: GND}\n]\nextrainfo:The circuit is a logarithmic amplifier configuration using an op-amp and an NMOS transistor. The input voltage Vs is converted into a logarithmic output voltage Vo. The op-amp A0 is configured with negative feedback through the NMOS transistor, which helps achieve the logarithmic characteristic. The resistor R is connected in series with the input voltage source.\n\nFigure 6.5 Logarithmic amplifier configuration.\nand\n\n$$\n\\begin{equation*}\nV_{o}=-V_{b e} \\tag{6.18}\n\\end{equation*}\n$$\n\nThus\n\n$$\n\\begin{equation*}\nV_{o}=-V_{T} \\ln \\left(\\frac{V_{s}}{I_{S} R}\\right) \\tag{6.19}\n\\end{equation*}\n$$\n\nThe logarithmic amplifier is just one instance among numerous op-amp applications where a nonlinear feedback element is employed to create a nonlinear transfer characteristic. For instance, two log amplifiers can be utilized to compute the logarithms of two distinct signals. These voltages can be summed, and the exponential of the sum can be derived using an inverting amplifier configuration with $R_{1}$ replaced by a diode, resulting in an analog multiplier. Other nonlinear operations, such as limiting, rectification, peak detection, squaring, square rooting, raising to a power, and division, can be executed using similar conceptual approaches."
},
{
    "text": "By incorporating nonlinear elements within the feedback network, operational amplifiers can execute nonlinear operations on one or more analog signals. The logarithmic amplifier, depicted in Fig. 6.5, exemplifies such an application. Logarithmic amplifiers are extensively utilized in instrumentation systems that require sensing and recording signals with a broad dynamic range. The circuit's functionality can be comprehended through the application of summing-point constraints. Given that the op amp's input voltage must be zero, the resistor $R$ transforms the input voltage $V_{s}$ into a current, which subsequently flows into the transistor's collector. This configuration ensures the collector current is proportional to the input voltage. Additionally, the transistor operates in the forward-active region due to $V_{C B} \\approx 0$. Since the base-emitter voltage of a bipolar transistor in this region logarithmically correlates with the collector current, and the output voltage equates to the transistor's emitter-base voltage, a logarithmic transfer characteristic is achieved. Mathematically,\n\n$$\n\\begin{equation*}\nI_{1}=\\frac{V_{s}}{R}=I_{c}=I_{S}\\left[\\exp \\left(\\frac{V_{b e}}{V_{T}}\\right)-1\\right] \\approx I_{S} \\exp \\left(\\frac{V_{b e}}{V_{T}}\\right) \\tag{6.17}\n\\end{equation*}\n$$\n\nimage_name:Figure 6.5 Logarithmic amplifier configuration\ndescription:\n[\nname: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\nname: R, type: Resistor, value: R, ports: {N1: Vs, N2: InN(A0)}\nname: A0, type: OpAmp, value: A0, ports: {InP: GND, InN: InN(A0), Out: Vo}\nname: NMOS, type: NMOS, ports: {S: V0, D: InN(A0), G: GND}\n]\nextrainfo:The circuit is a logarithmic amplifier configuration employing an op-amp and an NMOS transistor. The input voltage Vs is transformed into a logarithmic output voltage Vo. The op-amp A0 is set up with negative feedback via the NMOS transistor, facilitating the logarithmic characteristic. The resistor R is串联 with the input voltage source.\n\nFigure 6.5 Logarithmic amplifier configuration.\nand\n\n$$\n\\begin{equation*}\nV_{o}=-V_{b e} \\tag{6.18}\n\\end{equation*}\n$$\n\nThus\n\n$$\n\\begin{equation*}\nV_{o}=-V_{T} \\ln \\left(\\frac{V_{s}}{I_{S} R}\\right) \\tag{6.19}\n\\end{equation*}\n$$\n\nThe logarithmic amplifier is merely one instance among numerous op-amp applications where a nonlinear feedback element is employed to establish a nonlinear transfer characteristic. For instance, two log amplifiers can compute the logarithms of two distinct signals. These voltages can be summed, and their exponential can be derived using an inverting amplifier configuration with $R_{1}$ substituted by a diode, resulting in an analog multiplier. Other nonlinear operations, such as limiting, rectification, peak detection, squaring, square rooting, exponentiation, and division, can be executed using similar conceptual approaches."
},
{
    "text": "By incorporating nonlinear components into the feedback network, operational amplifiers can execute nonlinear operations on one or more analog signals. The logarithmic amplifier, depicted in Fig. 6.5, exemplifies such an application. Logarithmic amplifiers are extensively used in instrumentation systems where signals with a vast dynamic range need to be detected and recorded. The functioning of this circuit can be comprehended by applying summing-point constraints. Given that the input voltage of the op amp must be zero, the resistor $R$ converts the input voltage $V_{s}$ into a current. This current then flows into the transistor's collector. Consequently, the circuit ensures the transistor's collector current is proportional to the input voltage. Additionally, the transistor operates in the forward-active region due to $V_{C B} \\simeq 0$. Since the base-emitter voltage of a bipolar transistor in the forward-active region is logarithmically related to the collector current, and the output voltage corresponds to the transistor's emitter-base voltage, a logarithmic transfer characteristic is achieved. Mathematically,\n\n$$\n\\begin{equation*}\nI_{1}=\\frac{V_{s}}{R}=I_{c}=I_{S}\\left[\\exp \\left(\\frac{V_{b e}}{V_{T}}\\right)-1\\right] \\simeq I_{S} \\exp \\left(\\frac{V_{b e}}{V_{T}}\\right) \\tag{6.17}\n\\end{equation*}\n$$\n\nimage_name:Figure 6.5 Logarithmic amplifier configuration\ndescription:\n[\nname: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\nname: R, type: Resistor, value: R, ports: {N1: Vs, N2: InN(A0)}\nname: A0, type: OpAmp, value: A0, ports: {InP: GND, InN: InN(A0), Out: Vo}\nname: NMOS, type: NMOS, ports: {S: V0, D: InN(A0), G: GND}\n]\nextrainfo:The circuit is a logarithmic amplifier configuration using an op-amp and an NMOS transistor. The input voltage Vs is converted into a logarithmic output voltage Vo. The op-amp A0 is configured with negative feedback through the NMOS transistor, which facilitates the logarithmic characteristic. The resistor R is connected in series with the input voltage source.\n\nFigure 6.5 Logarithmic amplifier configuration.\nand\n\n$$\n\\begin{equation*}\nV_{o}=-V_{b e} \\tag{6.18}\n\\end{equation*}\n$$\n\nThus\n\n$$\n\\begin{equation*}\nV_{o}=-V_{T} \\ln \\left(\\frac{V_{s}}{I_{S} R}\\right) \\tag{6.19}\n\\end{equation*}\n$$\n\nThe logarithmic amplifier is just one instance among numerous op-amp applications where a nonlinear feedback element is employed to create a nonlinear transfer characteristic. For instance, two log amplifiers can compute the logarithms of two distinct signals. These voltages can be summed, and the exponential of the sum can be determined using an inverting amplifier setup with $R_{1}$ replaced by a diode, resulting in an analog multiplier. Other nonlinear operations, such as limiting, rectification, peak detection, squaring, square rooting, power functions, and division, can be executed using similar conceptual approaches."
},
{
    "text": "By incorporating nonlinear components within the feedback network, operational amplifiers can execute nonlinear operations on one or more analog signals. The logarithmic amplifier, depicted in Fig. 6.5, exemplifies such an application. Logarithmic amplifiers are extensively used in instrumentation systems that require sensing and recording signals with a vast dynamic range. The functionality of this circuit can be comprehended through the application of summing-point constraints. Given that the input voltage of the op amp must be zero, the resistor $R$ transforms the input voltage $V_{s}$ into a current. This current then flows into the transistor's collector, ensuring the collector current is proportional to the input voltage. Additionally, the transistor operates in the forward-active region due to $V_{C B} \\simeq 0$. Since the base-emitter voltage of a bipolar transistor in the forward-active region logarithmically relates to the collector current, and the output voltage corresponds to the transistor's emitter-base voltage, a logarithmic transfer characteristic is achieved. Mathematically,\n\n$$\n\\begin{equation*}\nI_{1}=\\frac{V_{s}}{R}=I_{c}=I_{S}\\left[\\exp \\left(\\frac{V_{b e}}{V_{T}}\\right)-1\\right] \\simeq I_{S} \\exp \\left(\\frac{V_{b e}}{V_{T}}\\right) \\tag{6.17}\n\\end{equation*}\n$$\n\nimage_name:Figure 6.5 Logarithmic amplifier configuration\ndescription:\n[\nname: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\nname: R, type: Resistor, value: R, ports: {N1: Vs, N2: InN(A0)}\nname: A0, type: OpAmp, value: A0, ports: {InP: GND, InN: InN(A0), Out: Vo}\nname: NMOS, type: NMOS, ports: {S: V0, D: InN(A0), G: GND}\n]\nextrainfo:The circuit is a logarithmic amplifier configuration utilizing an op-amp and an NMOS transistor. The input voltage Vs is transformed into a logarithmic output voltage Vo. The op-amp A0 is set up with negative feedback via the NMOS transistor, facilitating the logarithmic characteristic. The resistor R is串联 with the input voltage source.\n\nFigure 6.5 Logarithmic amplifier configuration.\nand\n\n$$\n\\begin{equation*}\nV_{o}=-V_{b e} \\tag{6.18}\n\\end{equation*}\n$$\n\nThus\n\n$$\n\\begin{equation*}\nV_{o}=-V_{T} \\ln \\left(\\frac{V_{s}}{I_{S} R}\\right) \\tag{6.19}\n\\end{equation*}\n$$\n\nThe logarithmic amplifier is merely one instance among numerous op-amp applications where a nonlinear feedback element generates a nonlinear transfer characteristic. For instance, two log amplifiers can compute the logarithms of two distinct signals. These voltages can be summed, and their exponential can be derived using an inverting amplifier setup with $R_{1}$ replaced by a diode, resulting in an analog multiplier. Other nonlinear operations, such as limiting, rectification, peak detection, squaring, square rooting, exponentiation, and division, can be executed using similar conceptual approaches."
},
{
    "text": "The integrator and differentiator circuits, depicted in Fig. 6.6, exemplify the use of operational amplifiers with reactive components in the feedback network to achieve a specific frequency or time-domain response. ${ }^{1,2}$ For the integrator, resistor $R$ generates a current $I_{1}$ that is directly proportional to the input voltage. This current then flows into capacitor $C$, where the voltage developed is proportional to the integral of $I_{1}$ over time. Since the output voltage is the negative of the capacitor voltage, the output is thus proportional to the integral of the input voltage over time. Mathematically, this is expressed as:\n\n$$\n\\begin{equation*}\nI_{1}=\\frac{V_{s}}{R}=I_{2} \\tag{6.20}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{equation*}\nV_{o}=-\\frac{1}{C} \\int_{0}^{t} I_{2} d \\tau+V_{o}(0) \\tag{6.21}\n\\end{equation*}\n$$\n\nCombining equations (6.20) and (6.21) results in:\n\n$$\n\\begin{equation*}\nV_{o}(t)=-\\frac{1}{R C} \\int_{0}^{t} V_{s}(\\tau) d \\tau+V_{o}(0) \\tag{6.22}\n\\end{equation*}\n$$\n\nHowever, the practical limitations of operational amplifiers constrain the range of $V_{o}$ and the rate at which $V_{o}$ can change while maintaining this relationship.\n\nIn the differentiator circuit, capacitor $C$ is placed between the voltage source $V_{s}$ and the inverting input of the op-amp. The current through the capacitor, which is proportional to the time derivative of the input voltage, flows through the feedback resistor $R$, generating an output voltage proportional to this current. This output voltage is thus proportional to the rate of change of the input voltage. The equations for this are:\n\n$$\n\\begin{gather*}\nI_{1}=C \\frac{d V_{s}}{d t}=I_{2}  \\tag{6.23}\\\\\nV_{o}=-R I_{2}=-R C \\frac{d V_{s}}{d t} \\tag{6.24}\n\\end{gather*}\n$$\n\n**Image Descriptions:**\n\n**Image (a):**\n- **Components:**\n  - **Vs:** Voltage source, connected between Vs and GND.\n  - **R:** Resistor, connected from Vs to InN(A0).\n  - **C:** Capacitor, connected from InN(A0) to Vo.\n  - **A0:** Operational amplifier, with InP grounded, InN connected to InN(A0), and OutP connected to Vo.\n- **Additional Info:** This configuration is an integrator circuit where the input voltage Vs is integrated over time to produce the output voltage Vo. Current I1 flows through resistor R, and current I2 flows through capacitor C.\n\n**Image (b):**\n- **Components:**\n  - **Vs:** Voltage source, connected between Vs and GND.\n  - **C:** Capacitor, connected from Vs to InN(A0).\n  - **R:** Resistor, connected from InN(A0) to Vo.\n  - **A0:** Operational amplifier, with InP grounded, InN connected to InN(A0), and output Vo.\n- **Additional Info:** This circuit is a differentiator configuration. Capacitor C is connected between the input voltage source Vs and the inverting input of the op-amp A0. The feedback resistor R is connected between the inverting input and the output Vo of the op-amp.\n\n**Figure 6.6:**\n- (a) Integrator configuration.\n- (b) Differentiator configuration."
},
{
    "text": "The integrator and differentiator circuits depicted in Fig. 6.6 exemplify the use of operational amplifiers with reactive components in the feedback network to achieve specific frequency or time-domain responses. ${ }^{1,2}$ For the integrator, resistor $R$ generates a current $I_{1}$ that corresponds to the input voltage. This current flows into capacitor $C$, whose voltage is directly related to the integral of $I_{1}$ over time. Since the output voltage is the negative of the capacitor voltage, the output is thus proportional to the integral of the input voltage over time. Mathematically, this is expressed as:\n\n$$\n\\begin{equation*}\nI_{1}=\\frac{V_{s}}{R}=I_{2} \\tag{6.20}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{equation*}\nV_{o}=-\\frac{1}{C} \\int_{0}^{t} I_{2} d \\tau+V_{o}(0) \\tag{6.21}\n\\end{equation*}\n$$\n\nCombining equations (6.20) and (6.21) results in:\n\n$$\n\\begin{equation*}\nV_{o}(t)=-\\frac{1}{R C} \\int_{0}^{t} V_{s}(\\tau) d \\tau+V_{o}(0) \\tag{6.22}\n\\end{equation*}\n$$\n\nHowever, the practical limitations of operational amplifiers constrain the range and rate of change of $V_{o}$ for which this relationship holds true.\n\nIn the differentiator circuit, capacitor $C$ is placed between $V_{s}$ and the inverting input of the op-amp. The current through the capacitor is proportional to the time derivative of the input voltage. This current then flows through feedback resistor $R$, generating an output voltage proportional to the capacitor current, which reflects the rate of change of the input voltage. The equations for this are:\n\n$$\n\\begin{gather*}\nI_{1}=C \\frac{d V_{s}}{d t}=I_{2}  \\tag{6.23}\\\\\nV_{o}=-R I_{2}=-R C \\frac{d V_{s}}{d t} \\tag{6.24}\n\\end{gather*}\n$$\n\n**Figure Descriptions:**\n- **(a) Integrator Configuration:** This setup integrates the input voltage $V_s$ over time to produce the output voltage $V_o$. Current $I_1$ flows through resistor $R$, while current $I_2$ flows through capacitor $C$.\n- **(b) Differentiator Configuration:** Here, capacitor $C$ is connected between the input voltage source $V_s$ and the inverting input of op-amp $A_0$. The feedback resistor $R$ links the inverting input to the output $V_o$.\n\nFigure 6.6: (a) Integrator configuration. (b) Differentiator configuration."
},
{
    "text": "The integrator and differentiator circuits depicted in Fig. 6.6 exemplify the use of operational amplifiers with reactive components in the feedback network to achieve a specific frequency or time-domain response. ${ }^{1,2}$ For the integrator, resistor $R$ generates a current $I_{1}$ that is proportional to the input voltage. This current flows into capacitor $C$, whose voltage is proportional to the integral of $I_{1}$ over time. Since the output voltage is the negative of the capacitor voltage, the output corresponds to the integral of the input voltage over time. Mathematically,\n\n$$\n\\begin{equation*}\nI_{1}=\\frac{V_{s}}{R}=I_{2} \\tag{6.20}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{equation*}\nV_{o}=-\\frac{1}{C} \\int_{0}^{t} I_{2} d \\tau+V_{o}(0) \\tag{6.21}\n\\end{equation*}\n$$\n\nCombining (6.20) and (6.21) results in\n\n$$\n\\begin{equation*}\nV_{o}(t)=-\\frac{1}{R C} \\int_{0}^{t} V_{s}(\\tau) d \\tau+V_{o}(0) \\tag{6.22}\n\\end{equation*}\n$$\n\nReal op amps' performance constraints limit the range of $V_{o}$ and the rate of change of $V_{o}$ for which this relationship holds true.\n\nFor the differentiator, capacitor $C$ is connected between $V_{s}$ and the inverting op-amp input. The current through the capacitor is proportional to the time derivative of the\nimage_name:(a)\ndescription:\n[\nname: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\nname: R, type: Resistor, value: R, ports: {N1: Vs, N2: InN(A0)}\nname: C, type: Capacitor, value: C, ports: {Np: InN(A0), Nn: Vo}\nname: A0, type: OpAmp, value: A0, ports: {InP: GND, InN: InN(A0), OutP: Vo}\n]\nextrainfo:This is an integrator circuit configuration (a) where the input voltage Vs is integrated over time to produce the output voltage Vo. The current I1 flows through the resistor R, and the current I2 flows through the capacitor C.\nimage_name:(b)\ndescription:\n[\nname: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\nname: C, type: Capacitor, value: C, ports: {Np: Vs, Nn: InN(A0)}\nname: R, type: Resistor, value: R, ports: {N1: InN(A0), N2: Vo}\nname: A0, type: OpAmp, value: A0, ports: {InP: GND, InN: InN(A0), Out: Vo}\n]\nextrainfo:The circuit is a differentiator configuration. The capacitor C is connected between the input voltage source Vs and the inverting input of the op-amp A0. The feedback resistor R is connected between the inverting input and the output Vo of the op-amp.\n\nFigure 6.6 (a) Integrator configuration. (b) Differentiator configuration.\ninput voltage. This current passes through the feedback resistor $R$, creating an output voltage proportional to the capacitor current, which is equivalent to the time rate of change of the input voltage. In mathematical terms,\n\n$$\n\\begin{gather*}\nI_{1}=C \\frac{d V_{s}}{d t}=I_{2}  \\tag{6.23}\\\\\nV_{o}=-R I_{2}=-R C \\frac{d V_{s}}{d t} \\tag{6.24}\n\\end{gather*}\n$$"
},
{
    "text": "The integrator and differentiator circuits, depicted in Fig. 6.6, exemplify the use of operational amplifiers with reactive components in the feedback network to achieve a specific frequency or time-domain response. ${}^{1,2}$ For the integrator, a resistor $R$ generates a current $I_{1}$ that is directly proportional to the input voltage. This current then flows into a capacitor $C$, whose voltage is proportional to the integral of $I_{1}$ over time. Since the output voltage is the negative of the capacitor voltage, the output is thus proportional to the integral of the input voltage over time. Mathematically, this is expressed as:\n\n$$\n\\begin{equation*}\nI_{1}=\\frac{V_{s}}{R}=I_{2} \\tag{6.20}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{equation*}\nV_{o}=-\\frac{1}{C} \\int_{0}^{t} I_{2} d \\tau+V_{o}(0) \\tag{6.21}\n\\end{equation*}\n$$\n\nCombining equations (6.20) and (6.21) results in:\n\n$$\n\\begin{equation*}\nV_{o}(t)=-\\frac{1}{R C} \\int_{0}^{t} V_{s}(\\tau) d \\tau+V_{o}(0) \\tag{6.22}\n\\end{equation*}\n$$\n\nHowever, the practical limitations of real operational amplifiers restrict the range of $V_{o}$ and the rate of change of $V_{o}$ for which this relationship holds true.\n\nIn the differentiator circuit, the capacitor $C$ is placed between the voltage source $V_{s}$ and the inverting input of the op-amp. The current through the capacitor is proportional to the time derivative of the voltage across it, which is the input voltage. This current passes through the feedback resistor $R$, creating an output voltage that is proportional to the capacitor current, and thus to the rate of change of the input voltage. The equations for this are:\n\n$$\n\\begin{gather*}\nI_{1}=C \\frac{d V_{s}}{d t}=I_{2}  \\tag{6.23}\\\\\nV_{o}=-R I_{2}=-R C \\frac{d V_{s}}{d t} \\tag{6.24}\n\\end{gather*}\n$$\n\nImage descriptions:\n- **(a) Integrator Configuration**: This circuit integrates the input voltage $V_{s}$ over time to produce the output voltage $V_{o}$. The current $I_{1}$ flows through the resistor $R$, and the current $I_{2}$ flows through the capacitor $C$.\n- **(b) Differentiator Configuration**: Here, the capacitor $C$ is connected between the input voltage source $V_{s}$ and the inverting input of the op-amp $A_{0}$. The feedback resistor $R$ links the inverting input to the output $V_{o}$ of the op-amp.\n\nFigure 6.6 (a) Integrator configuration. (b) Differentiator configuration."
},
{
    "text": "The integrator and differentiator circuits depicted in Fig. 6.6 exemplify the use of operational amplifiers with reactive components in the feedback network to achieve a specific frequency or time-domain response. ${ }^{1,2}$ For the integrator, a resistor $R$ generates a current $I_{1}$ that is directly proportional to the input voltage. This current then flows into the capacitor $C$, where the voltage across the capacitor is proportional to the integral of the current $I_{1}$ over time. Since the output voltage is the negative of the capacitor voltage, the output is thus proportional to the integral of the input voltage over time. This relationship can be expressed through the following equations:\n\n$$\n\\begin{equation*}\nI_{1}=\\frac{V_{s}}{R}=I_{2} \\tag{6.20}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{equation*}\nV_{o}=-\\frac{1}{C} \\int_{0}^{t} I_{2} d \\tau+V_{o}(0) \\tag{6.21}\n\\end{equation*}\n$$\n\nCombining equations (6.20) and (6.21) results in:\n\n$$\n\\begin{equation*}\nV_{o}(t)=-\\frac{1}{R C} \\int_{0}^{t} V_{s}(\\tau) d \\tau+V_{o}(0) \\tag{6.22}\n\\end{equation*}\n$$\n\nHowever, the practical limitations of real operational amplifiers constrain the range and rate of change of $V_{o}$ for which this relationship holds true.\n\nIn the case of the differentiator, the capacitor $C$ is positioned between the voltage source $V_{s}$ and the inverting input of the op-amp. The current through the capacitor, which is proportional to the time derivative of the input voltage, flows through the feedback resistor $R$, generating an output voltage proportional to this current. This can be mathematically represented as:\n\n$$\n\\begin{gather*}\nI_{1}=C \\frac{d V_{s}}{d t}=I_{2}  \\tag{6.23}\\\\\nV_{o}=-R I_{2}=-R C \\frac{d V_{s}}{d t} \\tag{6.24}\n\\end{gather*}\n$$\n\n(image_name:(a)\ndescription:\n[\nname: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\nname: R, type: Resistor, value: R, ports: {N1: Vs, N2: InN(A0)}\nname: C, type: Capacitor, value: C, ports: {Np: InN(A0), Nn: Vo}\nname: A0, type: OpAmp, value: A0, ports: {InP: GND, InN: InN(A0), OutP: Vo}\n]\nextrainfo:This is an integrator circuit configuration (a) where the input voltage Vs is integrated over time to produce the output voltage Vo. The current I1 flows through the resistor R, and the current I2 flows through the capacitor C.\nimage_name:(b)\ndescription:\n[\nname: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\nname: C, type: Capacitor, value: C, ports: {Np: Vs, Nn: InN(A0)}\nname: R, type: Resistor, value: R, ports: {N1: InN(A0), N2: Vo}\nname: A0, type: OpAmp, value: A0, ports: {InP: GND, InN: InN(A0), Out: Vo}\n]\nextrainfo:The circuit is a differentiator configuration. The capacitor C is connected between the input voltage source Vs and the inverting input of the op-amp A0. The feedback resistor R is connected between the inverting input and the output Vo of the op-amp.\n\nFigure 6.6 (a) Integrator configuration. (b) Differentiator configuration.)"
},
{
    "text": "The integrator and differentiator circuits, depicted in Fig. 6.6, exemplify the use of op amps with reactive elements in the feedback network to achieve a specific frequency or time-domain response. ${ }^{1,2}$ For the integrator, resistor $R$ generates a current $I_{1}$ that is proportional to the input voltage. This current flows into capacitor $C$, whose voltage is proportional to the integral of $I_{1}$ over time. Since the output voltage is the negative of the capacitor voltage, the output is proportional to the integral of the input voltage over time. The relevant equations are:\n\n$$\n\\begin{equation*}\nI_{1}=\\frac{V_{s}}{R}=I_{2} \\tag{6.20}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{equation*}\nV_{o}=-\\frac{1}{C} \\int_{0}^{t} I_{2} d \\tau+V_{o}(0) \\tag{6.21}\n\\end{equation*}\n$$\n\nCombining (6.20) and (6.21) results in:\n\n$$\n\\begin{equation*}\nV_{o}(t)=-\\frac{1}{R C} \\int_{0}^{t} V_{s}(\\tau) d \\tau+V_{o}(0) \\tag{6.22}\n\\end{equation*}\n$$\n\nReal op amps' performance limitations restrict the range of $V_{o}$ and the rate of change of $V_{o}$ for which this relationship holds true.\n\nIn the differentiator circuit, capacitor $C$ is connected between $V_{s}$ and the inverting op-amp input. The current through the capacitor is proportional to the time derivative of the input voltage. This current passes through feedback resistor $R$, generating an output voltage proportional to the capacitor current, which is proportional to the rate of change of the input voltage. The equations are:\n\n$$\n\\begin{gather*}\nI_{1}=C \\frac{d V_{s}}{d t}=I_{2}  \\tag{6.23}\\\\\nV_{o}=-R I_{2}=-R C \\frac{d V_{s}}{d t} \\tag{6.24}\n\\end{gather*}\n$$\n\n**Image Descriptions:**\n\n- **Integrator Circuit (a):** This configuration integrates the input voltage $V_s$ over time to produce the output voltage $V_o$. Current $I_1$ flows through resistor $R$, and current $I_2$ flows through capacitor $C$.\n  \n- **Differentiator Circuit (b):** In this setup, capacitor $C$ is connected between the input voltage source $V_s$ and the inverting input of op-amp $A_0$. The feedback resistor $R$ links the inverting input to the output $V_o$.\n\n**Figure 6.6:**\n(a) Integrator configuration.\n(b) Differentiator configuration."
},
{
    "text": "The circuits depicted in Fig. 6.6, namely the integrator and differentiator, exemplify the use of operational amplifiers with reactive components in the feedback network to achieve a specific frequency or time-domain response. ${ }^{1,2}$ For the integrator, a resistor $R$ generates a current $I_{1}$ that is directly proportional to the input voltage. This current then flows into a capacitor $C$, where the voltage across the capacitor is proportional to the integral of $I_{1}$ over time. Given that the output voltage is the negative of the capacitor voltage, the output is thus proportional to the integral of the input voltage over time. Mathematically, this is expressed as:\n\n$$\n\\begin{equation*}\nI_{1}=\\frac{V_{s}}{R}=I_{2} \\tag{6.20}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{equation*}\nV_{o}=-\\frac{1}{C} \\int_{0}^{t} I_{2} d \\tau+V_{o}(0) \\tag{6.21}\n\\end{equation*}\n$$\n\nCombining equations (6.20) and (6.21) results in:\n\n$$\n\\begin{equation*}\nV_{o}(t)=-\\frac{1}{R C} \\int_{0}^{t} V_{s}(\\tau) d \\tau+V_{o}(0) \\tag{6.22}\n\\end{equation*}\n$$\n\nHowever, the inherent limitations of actual operational amplifiers constrain the range and rate of change of $V_{o}$ for which this relationship holds true.\n\nIn the case of the differentiator, the capacitor $C$ is placed between the voltage source $V_{s}$ and the inverting input of the op-amp. The current through the capacitor, which is proportional to the time derivative of the input voltage, flows through the feedback resistor $R$, thereby generating an output voltage proportional to the rate of change of the input voltage. This is represented by the equations:\n\n$$\n\\begin{gather*}\nI_{1}=C \\frac{d V_{s}}{d t}=I_{2}  \\tag{6.23}\\\\\nV_{o}=-R I_{2}=-R C \\frac{d V_{s}}{d t} \\tag{6.24}\n\\end{gather*}\n$$\n\nimage_name:(a)\ndescription:\n[\nname: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\nname: R, type: Resistor, value: R, ports: {N1: Vs, N2: InN(A0)}\nname: C, type: Capacitor, value: C, ports: {Np: InN(A0), Nn: Vo}\nname: A0, type: OpAmp, value: A0, ports: {InP: GND, InN: InN(A0), OutP: Vo}\n]\nextrainfo:This configuration represents an integrator circuit (a) where the input voltage Vs is integrated over time to produce the output voltage Vo. The current I1 flows through the resistor R, and the current I2 flows through the capacitor C.\nimage_name:(b)\ndescription:\n[\nname: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\nname: C, type: Capacitor, value: C, ports: {Np: Vs, Nn: InN(A0)}\nname: R, type: Resistor, value: R, ports: {N1: InN(A0), N2: Vo}\nname: A0, type: OpAmp, value: A0, ports: {InP: GND, InN: InN(A0), Out: Vo}\n]\nextrainfo:This circuit is a differentiator setup. The capacitor C is connected between the input voltage source Vs and the inverting input of the op-amp A0. The feedback resistor R is linked between the inverting input and the output Vo of the op-amp.\n\nFigure 6.6 (a) Integrator configuration. (b) Differentiator configuration."
},
{
    "text": "The integrator and differentiator circuits, depicted in Fig. 6.6, exemplify the use of op amps with reactive elements in the feedback network to achieve a specific frequency or time-domain response. ${ }^{1,2}$ For the integrator, resistor $R$ generates a current $I_{1}$ proportional to the input voltage. This current flows into capacitor $C$, whose voltage corresponds to the integral of $I_{1}$ over time. Since the output voltage is the negative of the capacitor voltage, the output is proportional to the integral of the input voltage over time. Mathematically,\n\n$$\n\\begin{equation*}\nI_{1}=\\frac{V_{s}}{R}=I_{2} \\tag{6.20}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{equation*}\nV_{o}=-\\frac{1}{C} \\int_{0}^{t} I_{2} d \\tau+V_{o}(0) \\tag{6.21}\n\\end{equation*}\n$$\n\nCombining (6.20) and (6.21) results in\n\n$$\n\\begin{equation*}\nV_{o}(t)=-\\frac{1}{R C} \\int_{0}^{t} V_{s}(\\tau) d \\tau+V_{o}(0) \\tag{6.22}\n\\end{equation*}\n$$\n\nReal op amps' performance limitations restrict the range of $V_{o}$ and the rate of change of $V_{o}$ for which this relationship holds true.\n\nIn the differentiator circuit, capacitor $C$ is connected between $V_{s}$ and the inverting op-amp input. The current through the capacitor is proportional to the time derivative of the voltage across it, which equals the input voltage. This current passes through feedback resistor $R$, generating an output voltage proportional to the capacitor current, which is proportional to the time rate of change of the input voltage. The equations are:\n\n$$\n\\begin{gather*}\nI_{1}=C \\frac{d V_{s}}{d t}=I_{2}  \\tag{6.23}\\\\\nV_{o}=-R I_{2}=-R C \\frac{d V_{s}}{d t} \\tag{6.24}\n\\end{gather*}\n$$\n\nImage descriptions:\n- **Figure 6.6 (a) Integrator configuration:** This circuit integrates the input voltage $V_s$ over time to produce the output voltage $V_o$. Current $I_1$ flows through resistor $R$, and current $I_2$ flows through capacitor $C$.\n- **Figure 6.6 (b) Differentiator configuration:** The capacitor $C$ is connected between the input voltage source $V_s$ and the inverting input of op-amp $A_0$. The feedback resistor $R$ links the inverting input to the output $V_o$ of the op-amp."
},
{
    "text": "The operational objectives for operational amplifiers (op amps) intended for use within a monolithic analog subsystem are frequently distinct from those of standard op amps that employ external feedback components. In monolithic analog subsystems, a minority of amplifiers need to drive a signal off-chip where the capacitive and resistive loads are notable and variable. These amplifiers are designated as output buffers, whereas the amplifiers whose outputs remain on-chip are termed internal amplifiers. The most significant distinction is that the load driven by an internal amplifier is clearly defined and is usually purely capacitive, with a value of a few picofarads. Conversely, standalone general-purpose amplifiers typically must be designed to achieve a certain performance level that is unaffected by changes in capacitive loads up to several hundred picofarads and resistive loads down to $2 \\mathrm{k} \\Omega$ or less.\n\n#### 6.1.7.1 Switched-Capacitor Amplifier\n\nIn MOS technologies, capacitors are frequently used as passive elements in feedback amplifiers instead of resistors, partly because capacitors are often the most suitable passive components available. Additionally, capacitors can store charge proportional to the analog signals of interest, and MOS transistors can function as switches to connect to the capacitors without offset and with minimal leakage, enabling the discrete-time signal processing of analog quantities. The subject of MOS switched-capacitor amplifiers is a significant application of internal amplifiers. Here, we introduce the application to aid in explaining the construction of MOS op amps.\n\nFigure 6.7 depicts the schematic of an inverting amplifier with capacitive feedback, in contrast to the resistive feedback shown in Fig. 6.3a. If the op amp is ideal, the gain from a change in the input $\\Delta V_{s}$ to a change in the output $\\Delta V_{o}$ is still determined by the ratio of the impedance of the feedback element $C_{2}$ to the impedance of the input element $C_{1}$, or\n\n$$\n\\begin{equation*}\n\\frac{\\Delta V_{o}}{\\Delta V_{s}}=-\\frac{\\frac{1}{\\omega C_{2}}}{\\frac{1}{\\omega C_{1}}}=-\\frac{C_{1}}{C_{2}} \\tag{6.25}\n\\end{equation*}\n$$\n\nHowever, unlike when resistors are used as passive elements, this circuit does not provide DC bias for the inverting op-amp input because the impedances of both capacitors are infinite at DC. To address this issue, switches controlled by a two-phase nonoverlapping clock are utilized to control the operation of the aforementioned circuit. The resulting circuit is known as a switched-capacitor amplifier.\n\nFigure $6.8 a$ illustrates the schematic of a switched-capacitor amplifier. Each switch in the schematic is controlled by one of two clock phases $\\phi_{1}$ and $\\phi_{2}$, and the timing diagram is shown in Fig. 6.8b. We will assume that each switch is closed when its controlling clock signal is high, and open when its clock signal is low. Since $\\phi_{1}$ and $\\phi_{2}$ are never both high at the same time, the switches controlled by one clock phase are never closed at the same time as the switches controlled by the other clock phase. Due to this property, the clock signals in Fig. 6.8b are known as nonoverlapping. For instance, the left side of $C_{1}$ is connected to the input $V_{s}$ through switch $S_{1}$ when $\\phi_{1}$ is high and to ground through switch $S_{2}$ when $\\phi_{2}$ is high, but this node is never simultaneously connected to both the input and ground.\n\nTo simplify the description of the operation of switched-capacitor circuits, they are often redrawn twice, once for each nonoverlapping clock phase. Figures $6.8 c$ and $6.8 d$ show the connections when $\\phi_{1}$ is high (during $\\phi_{1}$) and when $\\phi_{2}$ is high (during $\\phi_{2}$), respectively. Switches that are closed are assumed to be short circuits, and switches that are open are assumed to be open circuits.\n\nTo determine the output for a given input, an analysis based on charge conservation is used. After switch $S_{3}$ opens, the charge on the plates of the capacitors that connect to the op-amp input node is conserved until this switch closes again. This property stems partly from the fact that the passive elements connected to the op-amp input node are capacitors, which conduct zero DC current. Also, if the op amp is constructed with an MOS differential input pair, the op-amp input is connected to the gate of one transistor in the differential pair, and the gate conducts zero DC current. Finally, if we assume that switch $S_{3}$ conducts zero current when it is open, the charge stored cannot leak away while $S_{3}$ is open.\n\nSince both sides of $C_{2}$ are grounded in Fig. 6.8c, the charge stored on the plates of the capacitors that connect to the op-amp input node during $\\phi_{1}$ is\n\n$$\n\\begin{equation*}\nQ_{1}=\\left(0-V_{s}\\right) C_{1}+(0) C_{2}=\\left(0-V_{s}\\right) C_{1} \\tag{6.26}\n\\end{equation*}\n$$\n\nBecause the input voltage is sampled or stored onto capacitor $C_{1}$ during $\\phi_{1}$, this phase is known as the input sample phase. If the op amp is ideal, the voltage $V_{i}$ from the inverting op-amp input to ground is driven to zero by negative feedback during $\\phi_{2}$. Therefore, the charge stored during $\\phi_{2}$ is\n\n$$\n\\begin{equation*}\nQ_{2}=(0) C_{1}+\\left(0-V_{o}\\right) C_{2}=\\left(0-V_{o}\\right) C_{2} \\tag{6.27}\n\\end{equation*}\n$$\n\nBecause the sampled charge appears on $C_{1}$ during $\\phi_{1}$ and on $C_{2}$ during $\\phi_{2}$, $\\phi_{2}$ is known as the charge-transfer phase. By charge conservation, $Q_{2}=Q_{1}$; therefore,\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}} \\tag{6.28}\n\\end{equation*}\n$$\n\nIn (6.28), $V_{s}$ represents the input voltage at the end of $\\phi_{1}$, and $V_{o}$ represents the output voltage at the end of $\\phi_{2}$. The shape of the output voltage waveform is not predicted by (6.28) and depends on the rates at which the capacitors are charged and discharged. In practice, these rates depend on the bandwidth of the op amp and the resistances of the closed switches. The result in (6.28) is valid as long as the op amp is ideal, the input $V_{s}$ is DC, and the intervals over which $\\phi_{1}$ and $\\phi_{2}$ are high are long enough to completely charge and discharge the associated capacitors. The ratio of $V_{o} / V_{s}$ in (6.28) is positive because if $V_{s}>0$ during $\\phi_{1}$, the voltage applied between the left side of $C_{1}$ and ground decreases from a positive value to zero during $\\phi_{2}$. Therefore, this negative change in the applied voltage during $\\phi_{2}$ is multiplied by a negative closed-loop amplifier gain, giving a positive ratio in (6.28).\n\nMOS technologies are well suited to building switched-capacitor circuits for two key reasons. First, the DC current that flows into the input terminals of MOS op amps is zero as long as the inputs are connected only to the gates of MOS transistors. In contrast, bipolar op amps have nonzero DC input currents that stem from finite $\\beta_{F}$ in bipolar transistors. Second, the switches in Fig. 6.8 can be implemented without offset by using MOS transistors, as shown in Fig. 6.9a. The arrows indicating the source terminals of $M_{1}-M_{5}$ are arbitrarily chosen in the sense that the source and drain terminals are interchangeable. (Since the source is the source of electrons in $n$-channel transistors, the source-to-ground voltage is lower than the drain-to-ground voltage.) Assume that the clock voltages alternate between $-V_{S S}$ and $V_{D D}$ as shown in Fig. 6.9b. Also assume that all node voltages are no lower than $-V_{S S}$ and no higher than $V_{D D}$. Finally, assume that the transistor threshold voltages are positive. Under these conditions, each transistor turns off when its gate is low. Furthermore, each transistor turns on when its gate is high as long as its source operates at least a threshold below $V_{D D}$. If $V_{s}$ is a DC signal, all drain currents approach zero as the capacitors become charged. As the drain currents approach zero, the MOS transistors that are on operate in the triode region, where the drain-source voltage is zero when the drain current is zero. Therefore, the input voltage $V_{s}$ is sampled onto $C_{1}$ with zero offset inserted by the MOS transistors operating as switches. This property of MOS transistors is important in the implementation of switched-capacitor circuits. In contrast, bipolar transistors operating as switches do not give zero collector-emitter voltage with zero collector current.\n\nThe switched-capacitor amplifier shown in Fig. $6.9 a$ is important in practice mainly because the gain of this circuit has little dependence on the various parasitic capacitances that are present on all the nodes in the circuit. These undesired capacitances stem in part from the drain-body and source-body junction capacitances of each transistor. Also, the op-amp input capacitance contributes to the parasitic capacitance on the op-amp input node. Furthermore, as described in Section 2.10.2, the bottom plates of capacitors $C_{1}$ and $C_{2}$ exhibit at least some capacitance to the underlying layer, which is the substrate or a well diffusion. Since the gain of the circuit is determined by charge conservation at the op-amp input node, the presence of parasitic capacitance from any node except the op-amp input to any node with a constant voltage to ground makes no difference to the accuracy of the circuit. (Such parasitics do reduce the maximum clock rate, however.) On the other hand, parasitic capacitance on the op-amp input node does affect the accuracy of the circuit gain, but the error is inversely proportional to the op-amp gain, as we will now show.\n\nLet $C_{P}$ represent the total parasitic capacitance from the op-amp input to all nodes with constant voltage to ground. If the op-amp gain is $a$, the voltage from the inverting op-amp input to ground during $\\phi_{2}$ is given by (6.10). Therefore, with finite op-amp gain, $C_{1}$ and $C_{P}$ are not completely discharged during $\\phi_{2}$. Under these conditions, the charge stored on the op-amp input node during $\\phi_{2}$ becomes\n\n$$\n\\begin{equation*}\nQ_{2}=\\left(-\\frac{V_{o}}{a}\\right) C_{1}+\\left(-\\frac{V_{o}}{a}\\right) C_{P}+\\left(-\\frac{V_{o}}{a}-V_{o}\\right) C_{2} \\tag{6.29}\n\\end{equation*}\n$$\n\nWhen the op-amp gain becomes infinite, (6.29) collapses to (6.27), as expected. Setting $Q_{2}$ in (6.29) equal to $Q_{1}$ in (6.26) by charge conservation gives\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}}\\left[\\frac{1}{1+\\frac{1}{a}\\left(\\frac{C_{1}+C_{2}+C_{P}}{C_{2}}\\right)}\\right] \\tag{6.30}\n\\end{equation*}\n$$\n\nThis closed-loop gain can be written as\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}}(1-\\epsilon) \\tag{6.31}\n\\end{equation*}\n$$\n\nwhere $\\epsilon$ is a gain error given by\n\n$$\n\\begin{equation*}\n\\epsilon=\\frac{1}{1+a\\left(\\frac{C_{2}}{C_{1}+C_{2}+C_{P}}\\right)} \\tag{6.32}\n\\end{equation*}\n$$\n\nAs $a \\rightarrow \\infty, \\epsilon \\rightarrow 0$, and the gain of the switched-capacitor amplifier approaches $C_{1} / C_{2}$ as predicted in (6.28). As a result, the circuit gain is said to be parasitic insensitive to an extent that depends on the op-amp gain.\n\nOne important parameter of the switched-capacitor amplifier shown in Fig. $6.9 a$ is the minimum clock period. This period is divided into two main parts, one for each clock phase. The duration of $\\phi_{2}$ must be long enough for the op-amp output to reach and stay within a given level of accuracy. This time is defined as the op-amp settling time and depends on the switch resistances, the circuit capacitances, and the op-amp properties. The settling time is usually determined by SPICE simulations. Such simulations should be run for both clock phases because the op-amp output voltage during $\\phi_{1}$ is not well controlled in practice. If the op amp is ideal, this output voltage is zero. With nonzero offset voltage, however, the output voltage will be driven to a nonzero value during $\\phi_{1}$ that depends on both the offset voltage and the op-amp gain. If the op-amp gain is large, the offset can easily be large enough to force the output voltage to clip near one of the supplies. The output voltage at the end of $\\phi_{1}$ can be thought of as an initial condition for the circuit during $\\phi_{2}$. If the initial condition and the desired final output at the end of $\\phi_{2}$ happen to have far different values, the time required for the output to reach a given level of accuracy during $\\phi_{2}$ can be increased. Furthermore, nonzero offset can increase the time required for the op-amp output voltage to reach a constant level during $\\phi_{1}$. Although the circuit output voltage defined in (6.30) only appears during $\\phi_{2}$, failure to reach a constant output voltage during $\\phi_{1}$ causes the initial condition defined above to vary, depending on the value of $V_{o}$ at the end of the preceding $\\phi_{2}$. As a result of this memory effect, the circuit can behave as a filter (which is possibly nonlinear), weighting together the results of more than one previous input sample to determine any given output. The key point is that an increase in the minimum duration of either phase requires an increase in the minimum clock period. This effect should be included in simulation by intentionally simulating with nonzero offset voltages.\n\nOne way to reduce the effect of nonzero offset voltage on the minimum clock period is to include a reset switch at the op-amp output. If the op amp has a single-ended output as shown in Fig. 6.9a, such a switch can be connected between the op-amp output and a bias point between the two supplies. On the other hand, if the op amp has differential outputs as described in Chapter 12, such a switch can be connected between the two op-amp outputs. In either case, the reset switch would be turned on during $\\phi_{1}$ and off during $\\phi_{2}$. The main value of such a reset switch is that it can reduce both the maximum output voltage produced by a nonzero offset voltage during $\\phi_{1}$ and the time required to reach this value, in turn reducing the effect of nonzero offset on the minimum durations of both phases.\n\nThe accuracy of the switched-capacitor amplifier shown in Fig. $6.9 a$ is limited by several other factors that we will now consider briefly. First, even with an ideal op amp, the gain depends on the ratio of capacitors $C_{1} / C_{2}$, which is not controlled perfectly in practice because of random-mismatch effects. Second, op-amp offset limits the minimum signal that can be distinguished from the offset in the switched-capacitor amplifier. As shown in Section 3.5.6, the input-referred offset of CMOS differential pairs is usually worse than for bipolar differential pairs. This property extends to op amps and stems partly from the reduced transconductance-to-current ratio of MOS transistors compared to their bipolar counterparts and partly from the threshold mismatch term, which appears only in the MOS case. Third, the charge-conservation equation and accuracy of the switched-capacitor amplifier are affected by the charge stored under the gates of some of the MOS transistors acting as switches in Fig. 6.9a. For example, some of the charge stored under the gate of transistor $M_{3}$ in Fig. $6.9 a$ is injected onto the op-amp input node after $M_{3}$ is turned off. Techniques to overcome these limitations are often used in practice but are not considered here.\n\n#### 6.1.7.2 Switched-Capacitor Integrator\n\nAnother application of an internal op amp, a switched-capacitor integrator, is illustrated in its simplest form in Fig. 6.10a. This circuit is widely utilized as the fundamental element of monolithic switched-capacitor filters for two main reasons. First, the frequency response of the integrator is insensitive to the various parasitic capacitances that are present on all nodes in the circuit. ${ }^{4,5}$ Second, using switched-capacitor integrators as the basic elements, the synthesis of desired filter frequency responses is relatively straightforward. In this section, we will analyze the frequency response of the switched-capacitor integrator.\n\nThe integrator consists of an op amp, a sampling capacitor $C_{S}$, an integrating capacitor $C_{I}$, and four MOS transistor switches. The load capacitance shown represents the sampling capacitor of the following integrator, plus any parasitic capacitances that may be present. Typical values for the sampling, integrating, and load capacitances are labeled in Fig. 6.10a.\n\nFigure $6"
},
{
    "text": "The operational amplifier performance requirements within a monolithic analog subsystem are distinct from those of standard operational amplifiers utilizing external feedback networks. In a monolithic analog subsystem, only a limited number of amplifiers are required to drive signals off-chip, where capacitive and resistive loads are substantial and variable. These amplifiers are referred to as output buffers, while those whose outputs remain on-chip are called internal amplifiers. A critical distinction is that the load driven by an internal amplifier is precisely defined and is often purely capacitive, with a value in the picofarad range. In contrast, standalone general-purpose amplifiers are typically designed to maintain performance levels that are independent of changes in capacitive loads up to several hundred picofarads and resistive loads down to $2 \\mathrm{k} \\Omega$ or less.\n\n#### 6.1.7.1 Switched-Capacitor Amplifier\n\nIn MOS technologies, capacitors are frequently employed as passive elements in feedback amplifiers due to their superior characteristics as available components. Capacitors can store charge proportional to analog signals of interest, and MOS transistors can act as switches to connect to the capacitors without offset and with minimal leakage, enabling the discrete-time signal processing of analog quantities. The subject of MOS switched-capacitor amplifiers is a significant application of internal amplifiers. Here, we introduce this application to elucidate the construction of MOS op amps.\n\nFigure 6.7 depicts the schematic of an inverting amplifier with capacitive feedback, contrasting with the resistive feedback shown in Fig. 6.3a. If the op amp is ideal, the gain from a change in the input $\\Delta V_{s}$ to a change in the output $\\Delta V_{o}$ remains governed by the ratio of the impedance of the feedback element $C_{2}$ to the impedance of the input element $C_{1}$, or\n\n$$\n\\begin{equation*}\n\\frac{\\Delta V_{o}}{\\Delta V_{s}}=-\\frac{\\frac{1}{\\omega C_{2}}}{\\frac{1}{\\omega C_{1}}}=-\\frac{C_{1}}{C_{2}} \\tag{6.25}\n\\end{equation*}\n$$\n\nHowever, unlike when resistors are used as passive elements, this circuit does not provide dc bias for the inverting op-amp input due to the infinite impedances of both capacitors at dc. To address this issue, switches controlled by a two-phase nonoverlapping clock are utilized to govern the operation of the aforementioned circuit. The resulting circuit is known as a switched-capacitor amplifier.\n\nFigure $6.8 a$ illustrates the schematic of a switched-capacitor amplifier. Each switch in the schematic is controlled by one of two clock phases $\\phi_{1}$ and $\\phi_{2}$, and the timing diagram is depicted in Fig. 6.8b. We will assume that each switch is closed when its controlling clock signal is high and open when its clock signal is low. Since $\\phi_{1}$ and $\\phi_{2}$ are never both high simultaneously, the switches controlled by one clock phase are never closed at the same time as the switches controlled by the other clock phase. Consequently, the clock signals in Fig. 6.8b are known as nonoverlapping. For instance, the left side of $C_{1}$ is connected to the input $V_{s}$ through switch $S_{1}$ when $\\phi_{1}$ is high and to ground through switch $S_{2}$ when $\\phi_{2}$ is high, but this node is never simultaneously connected to both the input and ground.\n\nTo simplify the description of switched-capacitor circuit operation, they are often redrawn twice, once for each nonoverlapping clock phase. Figures $6.8 c$ and $6.8 d$ depict the connections when $\\phi_{1}$ is high (during $\\phi_{1}$) and when $\\phi_{2}$ is high (during $\\phi_{2}$), respectively. Switches that are closed are assumed to be short circuits, and switches that are open are assumed to be open circuits.\n\nCharge conservation analysis is employed to determine the output for a given input. After switch $S_{3}$ opens, the charge on the plates of the capacitors connected to the op-amp input node is conserved until this switch closes again. This property arises partly from the fact that the passive elements connected to the op-amp input node are capacitors, which conduct zero dc current. Additionally, if the op amp is constructed with an MOS differential input pair, the op-amp input is connected to the gate of one transistor in the differential pair, and the gate conducts zero dc current. Finally, assuming that switch $S_{3}$ conducts zero current when it is open, the stored charge cannot leak away while $S_{3}$ is open.\n\nIn Fig. 6.8c, with both sides of $C_{2}$ grounded, the charge stored on the plates of the capacitors connected to the op-amp input node during $\\phi_{1}$ is\n\n$$\n\\begin{equation*}\nQ_{1}=\\left(0-V_{s}\\right) C_{1}+(0) C_{2}=\\left(0-V_{s}\\right) C_{1} \\tag{6.26}\n\\end{equation*}\n$$\n\nSince the input voltage is sampled or stored onto capacitor $C_{1}$ during $\\phi_{1}$, this phase is known as the input sample phase. If the op amp is ideal, the voltage $V_{i}$ from the inverting op-amp input to ground is driven to zero by negative feedback during $\\phi_{2}$. Hence, the charge stored during $\\phi_{2}$ is\n\n$$\n\\begin{equation*}\nQ_{2}=(0) C_{1}+\\left(0-V_{o}\\right) C_{2}=\\left(0-V_{o}\\right) C_{2} \\tag{6.27}\n\\end{equation*}\n$$\n\nSince the sampled charge appears on $C_{1}$ during $\\phi_{1}$ and on $C_{2}$ during $\\phi_{2}$, $\\phi_{2}$ is known as the charge-transfer phase. By charge conservation, $Q_{2}=Q_{1}$; therefore,\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}} \\tag{6.28}\n\\end{equation*}\n$$\n\nIn (6.28), $V_{s}$ represents the input voltage at the end of $\\phi_{1}$, and $V_{o}$ represents the output voltage at the end of $\\phi_{2}$. The shape of the output voltage waveform is not predicted by (6.28) and depends on the rates at which the capacitors are charged and discharged. In practice, these rates depend on the bandwidth of the op amp and the resistances of the closed switches. The result in (6.28) is valid as long as the op amp is ideal, the input $V_{s}$ is dc, and the intervals over which $\\phi_{1}$ and $\\phi_{2}$ are high are long enough to completely charge and discharge the associated capacitors. The ratio of $V_{o} / V_{s}$ in (6.28) is positive because if $V_{s}>0$ during $\\phi_{1}$, the voltage applied between the left side of $C_{1}$ and ground decreases from a positive value to zero during $\\phi_{2}$. Consequently, this negative change in the applied voltage during $\\phi_{2}$ is multiplied by a negative closed-loop amplifier gain, yielding a positive ratio in (6.28).\n\nMOS technologies are well suited to building switched-capacitor circuits for two primary reasons. Firstly, the dc current flowing into the input terminals of MOS op amps is zero as long as the inputs are connected only to the gates of MOS transistors. In contrast, bipolar op amps exhibit nonzero dc input currents originating from finite $\\beta_{F}$ in bipolar transistors. Secondly, the switches in Fig. 6.8 can be implemented without offset by using MOS transistors, as shown in Fig. 6.9a. The arrows indicating the source terminals of $M_{1}-M_{5}$ are arbitrarily chosen in the sense that the source and drain terminals are interchangeable. (Since the source is the source of electrons in $n$-channel transistors, the source-to-ground voltage is lower than the drain-to-ground voltage.) Assume that the clock voltages alternate between $-V_{S S}$ and $V_{D D}$ as depicted in Fig. 6.9b. Also assume that all node voltages are no lower than $-V_{S S}$ and no higher than $V_{D D}$. Finally, assume that the transistor threshold voltages are positive. Under these conditions, each transistor turns off when its gate is low. Furthermore, each transistor turns on when its gate is high as long as its source operates at least a threshold below $V_{D D}$. If $V_{s}$ is a dc signal, all drain currents approach zero as the capacitors become charged. As the drain currents approach zero, the MOS transistors that are on operate in the triode region, where the drain-source voltage is zero when the drain current is zero. Therefore, the input voltage $V_{s}$ is sampled onto $C_{1}$ with zero offset inserted by the MOS transistors operating as switches. This property of MOS transistors is crucial in the implementation of switched-capacitor circuits. In contrast, bipolar transistors operating as switches do not yield zero collector-emitter voltage with zero collector current.\n\nThe switched-capacitor amplifier depicted in Fig. $6.9 a$ holds practical significance mainly because the gain of this circuit exhibits minimal dependence on the various parasitic capacitances present on all nodes in the circuit. These undesired capacitances arise in part from the drain-body and source-body junction capacitances of each transistor. Additionally, the op-amp input capacitance contributes to the parasitic capacitance on the op-amp input node. Furthermore, as described in Section 2.10.2, the bottom plates of capacitors $C_{1}$ and $C_{2}$ exhibit at least some capacitance to the underlying layer, which is the substrate or a well diffusion. Since the gain of the circuit is determined by charge conservation at the op-amp input node, the presence of parasitic capacitance from any node except the op-amp input to any node with a constant voltage to ground makes no difference to the accuracy of the circuit. (Such parasitics do reduce the maximum clock rate, however.) On the other hand, parasitic capacitance on the op-amp input node does affect the accuracy of the circuit gain, but the error is inversely proportional to the op-amp gain, as we will now demonstrate.\n\nLet $C_{P}$ denote the total parasitic capacitance from the op-amp input to all nodes with constant voltage to ground. If the op-amp gain is $a$, the voltage from the inverting op-amp input to ground during $\\phi_{2}$ is given by (6.10). Hence, with finite op-amp gain, $C_{1}$ and $C_{P}$ are not completely discharged during $\\phi_{2}$. Under these conditions, the charge stored on the op-amp input node during $\\phi_{2}$ becomes\n\n$$\n\\begin{equation*}\nQ_{2}=\\left(-\\frac{V_{o}}{a}\\right) C_{1}+\\left(-\\frac{V_{o}}{a}\\right) C_{P}+\\left(-\\frac{V_{o}}{a}-V_{o}\\right) C_{2} \\tag{6.29}\n\\end{equation*}\n$$\n\nWhen the op-amp gain approaches infinity, (6.29) simplifies to (6.27), as expected. Setting $Q_{2}$ in (6.29) equal to $Q_{1}$ in (6.26) by charge conservation yields\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}}\\left[\\frac{1}{1+\\frac{1}{a}\\left(\\frac{C_{1}+C_{2}+C_{P}}{C_{2}}\\right)}\\right] \\tag{6.30}\n\\end{equation*}\n$$\n\nThis closed-loop gain can be expressed as\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}}(1-\\epsilon) \\tag{6.31}\n\\end{equation*}\n$$\n\nwhere $\\epsilon$ is a gain error given by\n\n$$\n\\begin{equation*}\n\\epsilon=\\frac{1}{1+a\\left(\\frac{C_{2}}{C_{1}+C_{2}+C_{P}}\\right)} \\tag{6.32}\n\\end{equation*}\n$$\n\nAs $a \\rightarrow \\infty, \\epsilon \\rightarrow 0$, and the gain of the switched-capacitor amplifier approaches $C_{1} / C_{2}$ as predicted in (6.28). As a result, the circuit gain is considered parasitic insensitive to an extent that depends on the op-amp gain.\n\nA crucial parameter of the switched-capacitor amplifier depicted in Fig. $6.9 a$ is the minimum clock period. This period is divided into two main parts, one for each clock phase. The duration of $\\phi_{2}$ must be sufficient for the op-amp output to reach and remain within a specified level of accuracy. This time is defined as the op-amp settling time and depends on the switch resistances, the circuit capacitances, and the op-amp properties. The settling time is typically determined by SPICE simulations. Such simulations should be conducted for both clock phases because the op-amp output voltage during $\\phi_{1}$ is not well controlled in practice. If the op amp is ideal, this output voltage is zero. With nonzero offset voltage, however, the output voltage will be driven to a nonzero value during $\\phi_{1}$ that depends on both the offset voltage and the op-amp gain. If the op-amp gain is large, the offset can easily be large enough to force the output voltage to clip near one of the supplies. The output voltage at the end of $\\phi_{1}$ can be regarded as an initial condition for the circuit during $\\phi_{2}$. If the initial condition and the desired final output at the end of $\\phi_{2}$ happen to have far different values, the time required for the output to reach a given level of accuracy during $\\phi_{2}$ can be increased. Furthermore, nonzero offset can increase the time required for the op-amp output voltage to reach a constant level during $\\phi_{1}$. Although the circuit output voltage defined in (6.30) only appears during $\\phi_{2}$, failure to reach a constant output voltage during $\\phi_{1}$ causes the initial condition defined above to vary, depending on the value of $V_{o}$ at the end of the preceding $\\phi_{2}$. As a result of this memory effect, the circuit can behave as a filter (which is possibly nonlinear), combining the results of more than one previous input sample to determine any given output. The key point is that an increase in the minimum duration of either phase necessitates an increase in the minimum clock period. This effect should be included in simulation by intentionally simulating with nonzero offset voltages.\n\nOne method to mitigate the impact of nonzero offset voltage on the minimum clock period is to incorporate a reset switch at the op-amp output. If the op amp has a single-ended output as shown in Fig. 6.9a, such a switch can be connected between the op-amp output and a bias point between the two supplies. On the other hand, if the op amp has differential outputs as described in Chapter 12, such a reset switch can be connected between the two op-amp outputs. In either case, the reset switch would be activated during $\\phi_{1}$ and deactivated during $\\phi_{2}$. The primary advantage of such a reset switch is that it can reduce both the maximum output voltage generated by a nonzero offset voltage during $\\phi_{1}$ and the time required to reach this value, in turn reducing the effect of nonzero offset on the minimum durations of both phases.\n\nThe accuracy of the switched-capacitor amplifier depicted in Fig. $6.9 a$ is constrained by several other factors that we will now briefly examine. Firstly, even with an ideal op amp, the gain depends on the ratio of capacitors $C_{1} / C_{2}$, which is not precisely controlled in practice due to random-mismatch effects. Secondly, op-amp offset limits the minimum signal that can be distinguished from the offset in the switched-capacitor amplifier. As shown in Section 3.5.6, the input-referred offset of CMOS differential pairs is usually worse than for bipolar differential pairs. This property extends to op amps and stems partly from the reduced transconductance-to-current ratio of MOS transistors compared to their bipolar counterparts and partly from the threshold mismatch term, which appears only in the MOS case. Thirdly, the charge-conservation equation and accuracy of the switched-capacitor amplifier are affected by the charge stored under the gates of some of the MOS transistors acting as switches in Fig. 6.9a. For example, some of the charge stored under the gate of transistor $M_{3}$ in Fig. $6.9 a$ is injected onto the op-amp input node after $M_{3}$ is turned off. Techniques to overcome these limitations are often employed in practice but are not discussed here.\n\n#### 6.1.7.2 Switched-Capacitor Integrator\n\nAnother application of an internal op amp, a switched-capacitor integrator, is presented in its simplest form in Fig. 6.10a. This circuit is extensively utilized as the fundamental building block of monolithic switched-capacitor filters for two primary reasons. Firstly, the frequency response of the integrator is insensitive to the various parasitic capacitances present on all nodes in the circuit. Secondly, using switched-capacitor integrators as the basic elements, the synthesis of desired filter frequency responses is relatively straightforward. In this section, we will analyze the frequency response of the switched-capacitor integrator.\n\nThe integrator comprises an op amp, a sampling capacitor $C_{S}$, an integrating capacitor $C_{I}$, and four MOS transistor switches. The load capacitance depicted represents the sampling capacitor of the subsequent integrator, along with any parasitic capacitances that may be present. Typical values for the sampling, integrating, and load capacitances are labeled in Fig. 6.10a.\n\nFigure $6.10 b$ illustrates the timing diagram of two nonoverlapping clock signals, $\\phi_{1}$ and $\\phi_{2}$, that control the operation of the circuit, as well as typical input and output waveforms. During the interval when clock phase $\\phi_{1}$ is high,"
},
{
    "text": "The performance goals for operational amplifiers (op amps) utilized within a monolithic analog subsystem are typically distinct from those of general-purpose op amps that employ external feedback components. In a monolithic analog subsystem, only a select few amplifiers need to drive a signal off-chip where the capacitive and resistive loads are notable and variable. These amplifiers are referred to as output buffers, while the amplifiers whose outputs remain on-chip are called internal amplifiers. A crucial distinction is that the load an internal amplifier must drive is clearly defined and often purely capacitive, with a value of a few picofarads. In contrast, standalone general-purpose amplifiers usually need to be designed to achieve a certain level of performance that is unaffected by changes in capacitive loads up to several hundred picofarads and resistive loads down to $2 \\mathrm{k} \\Omega$ or less.\n\n#### 6.1.7.1 Switched-Capacitor Amplifier\n\nIn MOS technologies, capacitors are frequently used as passive elements in feedback amplifiers instead of resistors, partly because capacitors are often the most suitable passive components available. Capacitors can store charge proportional to analog signals of interest, and MOS transistors can act as switches to connect to the capacitors without offset and with minimal leakage, enabling the discrete-time signal processing of analog quantities. The topic of MOS switched-capacitor amplifiers is an important application of internal amplifiers. Here, we introduce this application to help explain the construction of MOS op amps.\n\nFigure 6.7 shows the schematic of an inverting amplifier with capacitive feedback, in contrast to the resistive feedback shown in Fig. 6.3a. If the op amp is ideal, the gain from a change in the input $\\Delta V_{s}$ to a change in the output $\\Delta V_{o}$ is still given by the ratio of the impedance of the feedback element $C_{2}$ to the impedance of the input element $C_{1}$, or\n\n$$\n\\begin{equation*}\n\\frac{\\Delta V_{o}}{\\Delta V_{s}}=-\\frac{\\frac{1}{\\omega C_{2}}}{\\frac{1}{\\omega C_{1}}}=-\\frac{C_{1}}{C_{2}} \\tag{6.25}\n\\end{equation*}\n$$\n\nUnlike the case when resistors are used as passive elements, however, this circuit does not provide dc bias for the inverting op-amp input because the impedances of both capacitors are infinite at dc. To overcome this problem, switches controlled by a two-phase nonoverlapping clock are used to control the operation of the above circuit. The resulting circuit is known as a switched-capacitor amplifier.\n\nFigure $6.8 a$ shows the schematic of a switched-capacitor amplifier. Each switch in the schematic is controlled by one of two clock phases $\\phi_{1}$ and $\\phi_{2}$, and the timing diagram is shown in Fig. 6.8b. We will assume that each switch is closed when its controlling clock signal is high, and open when its clock signal is low. Since $\\phi_{1}$ and $\\phi_{2}$ are never both high at the same time, the switches controlled by one clock phase are never closed at the same time as the switches controlled by the other clock phase. Because of this property, the clock signals in Fig. 6.8b are known as nonoverlapping. For example, the left side of $C_{1}$ is connected to the input $V_{s}$ through switch $S_{1}$ when $\\phi_{1}$ is high and to ground through switch $S_{2}$ when $\\phi_{2}$ is high, but this node is never simultaneously connected to both the input and ground.\n\nTo simplify the description of the operation of switched-capacitor circuits, they are often redrawn twice, once for each nonoverlapping clock phase. Figures $6.8 c$ and $6.8 d$ show the connections when $\\phi_{1}$ is high (during $\\phi_{1}$) and when $\\phi_{2}$ is high (during $\\phi_{2}$), respectively. Switches that are closed are assumed to be short circuits, and switches that are open are assumed to be open circuits.\n\nTo find the output for a given input, an analysis based on charge conservation is used. After switch $S_{3}$ opens, the charge on the plates of the capacitors that connect to the op-amp input node is conserved until this switch closes again. This property stems partly from the fact that the passive elements connected to the op-amp input node are capacitors, which conduct zero dc current. Also, if the op amp is constructed with an MOS differential input pair, the op-amp input is connected to the gate of one transistor in the differential pair, and the gate conducts zero dc current. Finally, if we assume that switch $S_{3}$ conducts zero current when it is open, the charge stored cannot leak away while $S_{3}$ is open.\n\nSince both sides of $C_{2}$ are grounded in Fig. 6.8c, the charge stored on the plates of the capacitors that connect to the op-amp input node during $\\phi_{1}$ is\n\n$$\n\\begin{equation*}\nQ_{1}=\\left(0-V_{s}\\right) C_{1}+(0) C_{2}=\\left(0-V_{s}\\right) C_{1} \\tag{6.26}\n\\end{equation*}\n$$\n\nBecause the input voltage is sampled or stored onto capacitor $C_{1}$ during $\\phi_{1}$, this phase is known as the input sample phase. If the op amp is ideal, the voltage $V_{i}$ from the inverting op-amp input to ground is driven to zero by negative feedback during $\\phi_{2}$. Therefore, the charge stored during $\\phi_{2}$ is\n\n$$\n\\begin{equation*}\nQ_{2}=(0) C_{1}+\\left(0-V_{o}\\right) C_{2}=\\left(0-V_{o}\\right) C_{2} \\tag{6.27}\n\\end{equation*}\n$$\n\nBecause the sampled charge appears on $C_{1}$ during $\\phi_{1}$ and on $C_{2}$ during $\\phi_{2}$, $\\phi_{2}$ is known as the charge-transfer phase. By charge conservation, $Q_{2}=Q_{1}$; therefore,\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}} \\tag{6.28}\n\\end{equation*}\n$$\n\nIn (6.28), $V_{s}$ represents the input voltage at the end of $\\phi_{1}$, and $V_{o}$ represents the output voltage at the end of $\\phi_{2}$. The shape of the output voltage waveform is not predicted by (6.28) and depends on the rates at which the capacitors are charged and discharged. In practice, these rates depend on the bandwidth of the op amp and the resistances of the closed switches. The result in (6.28) is valid as long as the op amp is ideal, the input $V_{s}$ is dc, and the intervals over which $\\phi_{1}$ and $\\phi_{2}$ are high are long enough to completely charge and discharge the associated capacitors. The ratio of $V_{o} / V_{s}$ in (6.28) is positive because if $V_{s}>0$ during $\\phi_{1}$, the voltage applied between the left side of $C_{1}$ and ground decreases from a positive value to zero during $\\phi_{2}$. Therefore, this negative change in the applied voltage during $\\phi_{2}$ is multiplied by a negative closed-loop amplifier gain, giving a positive ratio in (6.28).\n\nMOS technologies are well suited to building switched-capacitor circuits for two key reasons. First, the dc current that flows into the input terminals of MOS op amps is zero as long as the inputs are connected only to the gates of MOS transistors. In contrast, bipolar op amps have nonzero dc input currents that stem from finite $\\beta_{F}$ in bipolar transistors. Second, the switches in Fig. 6.8 can be implemented without offset by using MOS transistors, as shown in Fig. 6.9a. The arrows indicating the source terminals of $M_{1}-M_{5}$ are arbitrarily chosen in the sense that the source and drain terminals are interchangeable. (Since the source is the source of electrons in $n$-channel transistors, the source-to-ground voltage is lower than the drain-to-ground voltage.) Assume that the clock voltages alternate between $-V_{S S}$ and $V_{D D}$ as shown in Fig. 6.9b. Also assume that all node voltages are no lower than $-V_{S S}$ and no higher than $V_{D D}$. Finally, assume that the transistor threshold voltages are positive. Under these conditions, each transistor turns off when its gate is low. Furthermore, each transistor turns on when its gate is high as long as its source operates at least a threshold below $V_{D D}$. If $V_{s}$ is a dc signal, all drain currents approach zero as the capacitors become charged. As the drain currents approach zero, the MOS transistors that are on operate in the triode region, where the drain-source voltage is zero when the drain current is zero. Therefore, the input voltage $V_{s}$ is sampled onto $C_{1}$ with zero offset inserted by the MOS transistors operating as switches. This property of MOS transistors is important in the implementation of switched-capacitor circuits. In contrast, bipolar transistors operating as switches do not give zero collector-emitter voltage with zero collector current.\n\nThe switched-capacitor amplifier shown in Fig. $6.9 a$ is important in practice mainly because the gain of this circuit has little dependence on the various parasitic capacitances that are present on all the nodes in the circuit. These undesired capacitances stem in part from the drain-body and source-body junction capacitances of each transistor. Also, the op-amp input capacitance contributes to the parasitic capacitance on the op-amp input node. Furthermore, as described in Section 2.10.2, the bottom plates of capacitors $C_{1}$ and $C_{2}$ exhibit at least some capacitance to the underlying layer, which is the substrate or a well diffusion. Since the gain of the circuit is determined by charge conservation at the op-amp input node, the presence of parasitic capacitance from any node except the op-amp input to any node with a constant voltage to ground makes no difference to the accuracy of the circuit. (Such parasitics do reduce the maximum clock rate, however.) On the other hand, parasitic capacitance on the op-amp input node does affect the accuracy of the circuit gain, but the error is inversely proportional to the op-amp gain, as we will now show.\n\nLet $C_{P}$ represent the total parasitic capacitance from the op-amp input to all nodes with constant voltage to ground. If the op-amp gain is $a$, the voltage from the inverting op-amp input to ground during $\\phi_{2}$ is given by (6.10). Therefore, with finite op-amp gain, $C_{1}$ and $C_{P}$ are not completely discharged during $\\phi_{2}$. Under these conditions, the charge stored on the op-amp input node during $\\phi_{2}$ becomes\n\n$$\n\\begin{equation*}\nQ_{2}=\\left(-\\frac{V_{o}}{a}\\right) C_{1}+\\left(-\\frac{V_{o}}{a}\\right) C_{P}+\\left(-\\frac{V_{o}}{a}-V_{o}\\right) C_{2} \\tag{6.29}\n\\end{equation*}\n$$\n\nWhen the op-amp gain becomes infinite, (6.29) collapses to (6.27), as expected. Setting $Q_{2}$ in (6.29) equal to $Q_{1}$ in (6.26) by charge conservation gives\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}}\\left[\\frac{1}{1+\\frac{1}{a}\\left(\\frac{C_{1}+C_{2}+C_{P}}{C_{2}}\\right)}\\right] \\tag{6.30}\n\\end{equation*}\n$$\n\nThis closed-loop gain can be written as\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}}(1-\\epsilon) \\tag{6.31}\n\\end{equation*}\n$$\n\nwhere $\\epsilon$ is a gain error given by\n\n$$\n\\begin{equation*}\n\\epsilon=\\frac{1}{1+a\\left(\\frac{C_{2}}{C_{1}+C_{2}+C_{P}}\\right)} \\tag{6.32}\n\\end{equation*}\n$$\n\nAs $a \\rightarrow \\infty, \\epsilon \\rightarrow 0$, and the gain of the switched-capacitor amplifier approaches $C_{1} / C_{2}$ as predicted in (6.28). As a result, the circuit gain is said to be parasitic insensitive to an extent that depends on the op-amp gain.\n\nOne important parameter of the switched-capacitor amplifier shown in Fig. $6.9 a$ is the minimum clock period. This period is divided into two main parts, one for each clock phase. The duration of $\\phi_{2}$ must be long enough for the op-amp output to reach and stay within a given level of accuracy. This time is defined as the op-amp settling time and depends on the switch resistances, the circuit capacitances, and the op-amp properties. The settling time is usually determined by SPICE simulations. Such simulations should be run for both clock phases because the op-amp output voltage during $\\phi_{1}$ is not well controlled in practice. If the op amp is ideal, this output voltage is zero. With nonzero offset voltage, however, the output voltage will be driven to a nonzero value during $\\phi_{1}$ that depends on both the offset voltage and the op-amp gain. If the op-amp gain is large, the offset can easily be large enough to force the output voltage to clip near one of the supplies. The output voltage at the end of $\\phi_{1}$ can be thought of as an initial condition for the circuit during $\\phi_{2}$. If the initial condition and the desired final output at the end of $\\phi_{2}$ happen to have far different values, the time required for the output to reach a given level of accuracy during $\\phi_{2}$ can be increased. Furthermore, nonzero offset can increase the time required for the op-amp output voltage to reach a constant level during $\\phi_{1}$. Although the circuit output voltage defined in (6.30) only appears during $\\phi_{2}$, failure\nto reach a constant output voltage during $\\phi_{1}$ causes the initial condition defined above to vary, depending on the value of $V_{o}$ at the end of the preceding $\\phi_{2}$. As a result of this memory effect, the circuit can behave as a filter (which is possibly nonlinear), weighting together the results of more than one previous input sample to determine any given output. The key point is that an increase in the minimum duration of either phase requires an increase in the minimum clock period. This effect should be included in simulation by intentionally simulating with nonzero offset voltages.\n\nOne way to reduce the effect of nonzero offset voltage on the minimum clock period is to include a reset switch at the op-amp output. If the op amp has a single-ended output as shown in Fig. 6.9a, such a switch can be connected between the op-amp output and a bias point between the two supplies. On the other hand, if the op amp has differential outputs as described in Chapter 12, such a reset switch can be connected between the two op-amp outputs. In either case, the reset switch would be turned on during $\\phi_{1}$ and off during $\\phi_{2}$. The main value of such a reset switch is that it can reduce both the maximum output voltage produced by a nonzero offset voltage during $\\phi_{1}$ and the time required to reach this value, in turn reducing the effect of nonzero offset on the minimum durations of both phases.\n\nThe accuracy of the switched-capacitor amplifier shown in Fig. $6.9 a$ is limited by several other factors that we will now consider briefly. First, even with an ideal op amp, the gain depends on the ratio of capacitors $C_{1} / C_{2}$, which is not controlled perfectly in practice because of random-mismatch effects. Second, op-amp offset limits the minimum signal that can be distinguished from the offset in the switched-capacitor amplifier. As shown in Section 3.5.6, the input-referred offset of CMOS differential pairs is usually worse than for bipolar differential pairs. This property extends to op amps and stems partly from the reduced transconductance-to-current ratio of MOS transistors compared to their bipolar counterparts and partly from the threshold mismatch term, which appears only in the MOS case. Third, the charge-conservation equation and accuracy of the switched-capacitor amplifier are affected by the charge stored under the gates of some of the MOS transistors acting as switches in Fig. 6.9a. For example, some of the charge stored under the gate of transistor $M_{3}$ in Fig. $6.9 a$ is injected onto the op-amp input node after $M_{3}$ is turned off. Techniques to overcome these limitations are often used in practice but are not considered here.\n\n#### 6.1.7.2 Switched-Capacitor Integrator\n\nAnother application of an internal op amp, a switched-capacitor integrator, is illustrated in its simplest form in Fig. 6.10a. This circuit is widely utilized as the basic element of monolithic switched-capacitor filters for two main reasons. First, the frequency response of the integrator is insensitive to the various parasitic capacitances that are present on all nodes in the circuit. Second, using switched-capacitor integrators as the basic elements, the synthesis of desired filter frequency responses is relatively straightforward. In this section, we will analyze the frequency response of the switched-capacitor integrator.\n\nThe integrator consists of an op amp, a sampling capacitor $C_{S}$, an integrating capacitor $C_{I}$, and four MOS transistor switches. The load capacitance shown represents the sampling capacitor of the following integrator, plus any parasitic capacitances that may be present. Typical values for the sampling, integrating, and load capacitances are labeled in Fig. 6.10a.\n\nFigure $6.10 b$ shows"
},
{
    "text": "Operational amplifiers (op amps) utilized within a monolithic analog subsystem have distinct performance objectives compared to those used for general-purpose applications with external feedback elements. In a monolithic setup, only a select few amplifiers are tasked with driving signals off-chip, where they encounter significant and variable capacitive and resistive loads. These specific amplifiers are designated as output buffers, while those with outputs confined within the chip are termed internal amplifiers. A pivotal difference is that internal amplifiers have a well-defined load to drive, often purely capacitive, with a value of a few picofarads. This contrasts with standalone general-purpose amplifiers, which are designed to maintain performance levels regardless of capacitive load changes up to several hundred picofarads and resistive loads down to $2 \\mathrm{k} \\Omega$ or less.\n\nIn MOS technologies, capacitors are frequently employed as the passive elements in feedback amplifiers because they are the most suitable available components. Capacitors can store charge proportional to the analog signals of interest, and MOS transistors can function as switches to connect to these capacitors with minimal offset and leakage, facilitating the discrete-time signal processing of analog quantities. MOS switched-capacitor amplifiers are a significant application of internal amplifiers and are discussed here to elucidate the construction of MOS op amps.\n\nAn inverting amplifier configuration with capacitive feedback, as depicted in Figure 6.7, differs from the resistive feedback shown in Figure 6.3a. The gain from a change in the input $\\Delta V_{s}$ to a change in the output $\\Delta V_{o}$ in an ideal op amp is still determined by the ratio of the impedances of the feedback element $C_{2}$ to the input element $C_{1}$, expressed as:\n\n$$\n\\frac{\\Delta V_{o}}{\\Delta V_{s}}=-\\frac{\\frac{1}{\\omega C_{2}}}{\\frac{1}{\\omega C_{1}}}=-\\frac{C_{1}}{C_{2}}\n$$\n\nHowever, unlike when resist\nThe performance requirements for operational\nOperational amplifiers (op amps) used within a monolithic analog subsystem differ significantly from those of general-purpose op amps that utilize external feedback elements. In a monolithic analog subsystem, only a few amplifiers need to drive signals off-chip, where they face significant and variable capacitive and resistive loads. These amplifiers are referred to as output buffers, while amplifiers with outputs remaining on-chip are termed internal amplifiers. A key distinction is that internal amplifiers drive a well-defined load, typically purely capacitive with a value of a few picofarads. In contrast, standalone general-purpose amplifiers are designed to maintain performance regardless of capacitive load changes up to several hundred picofarads and resistive loads down to $2 \\mathrm{k} \\Omega$ or less.\n\nIn MOS technologies, capacitors are often employed as passive elements in feedback amplifiers due to their availability and effectiveness. Capacitors can store charge proportional to analog signals, and MOS transistors can act as switches to connect to these capacitors with minimal offset and leakage, enabling discrete-time signal processing of analog quantities. MOS switched-capacitor amplifiers are an important application of internal amplifiers and are discussed here to explain the construction of MOS op amps.\n\nAn inverting amplifier configuration with capacitive feedback, as shown in Figure 6.7, differs from the resistive feedback configuration in Figure 6.3a. The gain from a change in the input $\\Delta V_{s}$ to a change in the output $\\Delta V_{o}$ in an ideal op amp is still determined by the ratio of the impedances of the feedback element $C_{2}$ to the input element $C_{1}$, expressed as:\n\n$$\n\\frac{\\Delta V_{o}}{\\Delta V_{s}}=-\\frac{\\frac{1}{\\omega C_{2}}}{\\frac{1}{\\omega C_{1}}}=-\\frac{C_{1}}{C_{2}}\n$$\n\nHowever, unlike when resistors are used as passive elements, this circuit does not provide dc bias for the inverting op-amp input because the impedances of both capacitors are infinite at dc. To address this issue, switches controlled by a two-phase nonoverlapping clock are used to control the operation of the circuit, resulting in a switched-capacitor amplifier.\n\nFigure 6.8a shows the schematic of a switched-capacitor amplifier. Each switch in the schematic is controlled by one of two clock phases, $\\phi_{1}$ and $\\phi_{2}$, and the timing diagram is shown in Figure 6.8b. We assume that each switch is closed when its controlling clock signal is high and open when its clock signal is low. Since $\\phi_{1}$ and $\\phi_{2}$ are never both high at the same time, the switches controlled by one clock phase are never closed at the same time as the switches controlled by the other clock phase. This property ensures that the clock signals are nonoverlapping.\n\nTo simplify the description of the operation of switched-capacitor circuits, they are often redrawn twice, once for each nonoverlapping clock phase. Figures 6.8c and 6.8d show the connections when $\\phi_{1}$ is high (during $\\phi_{1}$) and when $\\phi_{2}$ is high (during $\\phi_{2}$), respectively. Switches that are closed are assumed to be short circuits, and switches that are open are assumed to be open circuits.\n\nTo find the output for a given input, an analysis based on charge conservation is used. After switch $S_{3}$ opens, the charge on the plates of the capacitors that connect to the op-amp input node is conserved until this switch closes again. This property stems partly from the fact that the passive elements connected to the op-amp input node are capacitors, which conduct zero dc current. Also, if the op amp is constructed with an MOS differential input pair, the op-amp input is connected to the gate of one transistor in the differential pair, and the gate conducts zero dc current. Finally, if we assume that switch $S_{3}$ conducts zero current when it is open, the charge stored cannot leak away while $S_{3}$ is open.\n\nSince both sides of $C_{2}$ are grounded in Figure 6.8c, the charge stored on the plates of the capacitors that connect to the op-amp input node during $\\phi_{1}$ is:\n\n$$\nQ_{1}=\\left(0-V_{s}\\right) C_{1}+(0) C_{2}=\\left(0-V_{s}\\right) C_{1}\n$$\n\nBecause the input voltage is sampled or stored onto capacitor $C_{1}$ during $\\phi_{1}$, this phase is known as the input sample phase. If the op amp is ideal, the voltage $V_{i}$ from the inverting op-amp input to ground is driven to zero by negative feedback during $\\phi_{2}$. Therefore, the charge stored during $\\phi_{2}$ is:\n\n$$\nQ_{2}=(0) C_{1}+\\left(0-V_{o}\\right) C_{2}=\\left(0-V_{o}\\right) C_{2}\n$$\n\nBecause the sampled charge appears on $C_{1}$ during $\\phi_{1}$ and on $C_{2}$ during $\\phi_{2}$, $\\phi_{2}$ is known as the charge-transfer phase. By charge conservation, $Q_{2}=Q_{1}$; therefore:\n\n$$\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}}\n$$\n\nIn (6.28), $V_{s}$ represents the input voltage at the end of $\\phi_{1}$, and $V_{o}$ represents the output voltage at the end of $\\phi_{2}$. The shape of the output voltage waveform is not predicted by (6.28) and depends on the rates at which the capacitors are charged and discharged. In practice, these rates depend on the bandwidth of the op amp and the resistances of the closed switches. The result in (6.28) is valid as long as the op amp is ideal, the input $V_{s}$ is dc, and the intervals over which $\\phi_{1}$ and $\\phi_{2}$ are high are long enough to completely charge and discharge the associated capacitors. The ratio of $V_{o} / V_{s}$ in (6.28) is positive because if $V_{s}>0$ during $\\phi_{1}$, the voltage applied between the left side of $C_{1}$ and ground decreases from a positive value to zero during $\\phi_{2}$. Therefore, this negative change in the applied voltage during $\\phi_{2}$ is multiplied by a negative closed-loop amplifier gain, giving a positive ratio in (6.28).\n\nMOS technologies are well suited to building switched-capacitor circuits for two key reasons. First, the dc current that flows into the input terminals of MOS op amps is zero as long as the inputs are connected only to the gates of MOS transistors. In contrast, bipolar op amps have nonzero dc input currents that stem from finite $\\beta_{F}$ in bipolar transistors. Second, the switches in Figure 6.8 can be implemented without offset by using MOS transistors, as shown in Figure 6.9a. The arrows indicating the source terminals of $M_{1}-M_{5}$ are arbitrarily chosen in the sense that the source and drain terminals are interchangeable. (Since the source is the source of electrons in $n$-channel transistors, the source-to-ground voltage is lower than the drain-to-ground voltage.) Assume that the clock voltages alternate between $-V_{S S}$ and $V_{D D}$ as shown in Figure 6.9b. Also assume that all node voltages are no lower than $-V_{S S}$ and no higher than $V_{D D}$. Finally, assume that the transistor threshold voltages are positive. Under these conditions, each transistor turns off when its gate is low. Furthermore, each transistor turns on when its gate is high as long as its source operates at least a threshold below $V_{D D}$. If $V_{s}$ is a dc signal, all drain currents approach zero as the capacitors become charged. As the drain currents approach zero, the MOS transistors that are on operate in the triode region, where the drain-source voltage is zero when the drain current is zero. Therefore, the input voltage $V_{s}$ is sampled onto $C_{1}$ with zero offset inserted by the MOS transistors operating as switches. This property of MOS transistors is important in the implementation of switched-capacitor circuits. In contrast, bipolar transistors operating as switches do not give zero collector-emitter voltage with zero collector current.\n\nThe switched-capacitor amplifier shown in Figure 6.9a is important in practice mainly because the gain of this circuit has little dependence on the various parasitic capacitances that are present on all the nodes in the circuit. These undesired capacitances stem in part from the drain-body and source-body junction capacitances of each transistor. Also, the op-amp input capacitance contributes to the parasitic capacitance on the op-amp input node. Furthermore, as described in Section 2.10.2, the bottom plates of capacitors $C_{1}$ and $C_{2}$ exhibit at least some capacitance to the underlying layer, which is the substrate or a well diffusion. Since the gain of the circuit is determined by charge conservation at the op-amp input node, the presence of parasitic capacitance from any node except the op-amp input to any node with a constant voltage to ground makes no difference to the accuracy of the circuit. (Such parasitics do reduce the maximum clock rate, however.) On the other hand, parasitic capacitance on the op-amp input node does affect the accuracy of the circuit gain, but the error is inversely proportional to the op-amp gain, as we will now show.\n\nLet $C_{P}$ represent the total parasitic capacitance from the op-amp input to all nodes with constant voltage to ground. If the op-amp gain is $a$, the voltage from the inverting op-amp input to ground during $\\phi_{2}$ is given by (6.10). Therefore, with finite op-amp gain, $C_{1}$ and $C_{P}$ are not completely discharged during $\\phi_{2}$. Under these conditions, the charge stored on the op-amp input node during $\\phi_{2}$ becomes:\n\n$$\nQ_{2}=\\left(-\\frac{V_{o}}{a}\\right) C_{1}+\\left(-\\frac{V_{o}}{a}\\right) C_{P}+\\left(-\\frac{V_{o}}{a}-V_{o}\\right) C_{2}\n$$\n\nWhen the op-amp gain becomes infinite, (6.29) collapses to (6.27), as expected. Setting $Q_{2}$ in (6.29) equal to $Q_{1}$ in (6.26) by charge conservation gives:\n\n$$\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}}\\left[\\frac{1}{1+\\frac{1}{a}\\left(\\frac{C_{1}+C_{2}+C_{P}}{C_{2}}\\right)}\\right]\n$$\n\nThis closed-loop gain can be written as:\n\n$$\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}}(1-\\epsilon)\n$$\n\nwhere $\\epsilon$ is a gain error given by:\n\n$$\n\\epsilon=\\frac{1}{1+a\\left(\\frac{C_{2}}{C_{1}+C_{2}+C_{P}}\\right)}\n$$\n\nAs $a \\rightarrow \\infty, \\epsilon \\rightarrow 0$, and the gain of the switched-capacitor amplifier approaches $C_{1} / C_{2}$ as predicted in (6.28). As a result, the circuit gain is said to be parasitic insensitive to an extent that depends on the op-amp gain.\n\nOne important parameter of the switched-capacitor amplifier shown in Figure 6.9a is the minimum clock period. This period is divided into two main parts, one for each clock phase. The duration of $\\phi_{2}$ must be long enough for the op-amp output to reach and stay within a given level of accuracy. This time is defined as the op-amp settling time and depends on the switch resistances, the circuit capacitances, and the op-amp properties. The settling time is usually determined by SPICE simulations. Such simulations should be run for both clock phases because the op-amp output voltage during $\\phi_{1}$ is not well controlled in practice. If the op amp is ideal, this output voltage is zero. With nonzero offset voltage, however, the output voltage will be driven to a nonzero value during $\\phi_{1}$ that depends on both the offset voltage and the op-amp gain. If the op-amp gain is large, the offset can easily be large enough to force the output voltage to clip near one of the supplies. The output voltage at the end of $\\phi_{1}$ can be thought of as an initial condition for the circuit during $\\phi_{2}$. If the initial condition and the desired final output at the end of $\\phi_{2}$ happen to have far different values, the time required for the output to reach a given level of accuracy during $\\phi_{2}$ can be increased. Furthermore, nonzero offset can increase the time required for the op-amp output voltage to reach a constant level during $\\phi_{1}$. Although the circuit output voltage defined in (6.30) only appears during $\\phi_{2}$, failure to reach a constant output voltage during $\\phi_{1}$ causes the initial condition defined above to vary, depending on the value of $V_{o}$ at the end of the preceding $\\phi_{2}$. As a result of this memory effect, the circuit can behave as a filter (which is possibly nonlinear), weighting together the results of more than one previous input sample to determine any given output. The key point is that an increase in the minimum duration of either phase requires an increase in the minimum clock period. This effect should be included in simulation by intentionally simulating with nonzero offset voltages.\n\nOne way to reduce the effect of nonzero offset voltage on the minimum clock period is to include a reset switch at the op-amp output. If the op amp has a single-ended output as shown in Figure 6.9a, such a switch can be connected between the op-amp output and a bias point between the two supplies. On the other hand, if the op amp has differential outputs as described in Chapter 12, such a switch can be connected between the two op-amp outputs. In either case, the reset switch would be turned on during $\\phi_{1}$ and off during $\\phi_{2}$. The main value of such a reset switch is that it can reduce both the maximum output voltage produced by a nonzero offset voltage during $\\phi_{1}$ and the time required to reach this value, in turn reducing the effect of nonzero offset on the minimum durations of both phases.\n\nThe accuracy of the switched-capacitor amplifier shown in Figure 6.9a is limited by several other factors that we will now consider briefly. First, even with an ideal op amp, the gain depends on the ratio of capacitors $C_{1} / C_{2}$, which is not controlled perfectly in practice because of random-mismatch effects. Second, op-amp offset limits the minimum signal that can be distinguished from the offset in the switched-capacitor amplifier. As shown in Section 3.5.6, the input-referred offset of CMOS differential pairs is usually worse than for bipolar differential pairs. This property extends to op amps and stems partly from the reduced transconductance-to-current ratio of MOS transistors compared to their bipolar counterparts and partly from the threshold mismatch term, which appears only in the MOS case. Third, the charge-conservation equation and accuracy of the switched-capacitor amplifier are affected by the charge stored under the gates of some of the MOS transistors acting as switches in Figure 6.9a. For example, some of the charge stored under the gate of transistor $M_{3}$ in Figure 6.9a is injected onto the op-amp input node after $M_{3}$ is turned off. Techniques to overcome these limitations are often used in practice but are not considered here.\n\n#### 6.1.7.2 Switched-Capacitor Integrator\n\nAnother application of an internal op amp, a switched-capacitor integrator, is illustrated in its simplest form in Figure 6.10a. This circuit is widely utilized as the basic element of monolithic switched-capacitor filters for two main reasons. First, the frequency response of the integrator is insensitive to the various parasitic capacitances that are present on all nodes in the circuit. Second, using switched-capacitor integrators as the basic elements, the synthesis of desired filter frequency responses is relatively straightforward. In this section, we will analyze the frequency response of the switched-capac"
},
{
    "text": "The operational amplifier (op amp) performance requirements in monolithic analog subsystems differ significantly from those in general-purpose op amps that utilize external feedback components. In monolithic systems, only a few amplifiers need to drive signals off-chip, where the capacitive and resistive loads can be substantial and variable. These amplifiers are referred to as output buffers, while those whose outputs remain on-chip are called internal amplifiers. A key distinction is that the load driven by an internal amplifier is well-defined and is often purely capacitive, typically a few picofarads in value. In contrast, stand-alone general-purpose amplifiers are usually designed to maintain a certain level of performance regardless of capacitive load variations up to several hundred picofarads and resistive loads down to $2 \\mathrm{k} \\Omega$ or less.\n\n#### 6.1.7.1 Switched-Capacitor Amplifier\n\nIn MOS technologies, capacitors are frequently employed as passive elements in feedback amplifiers due to their availability and ability to store charge proportional to analog signals of interest. MOS transistors can act as switches to connect to these capacitors without offset and with minimal leakage, enabling discrete-time signal processing of analog quantities. The subject of MOS switched-capacitor amplifiers is a significant application of internal amplifiers and is introduced here to elucidate the construction of MOS op amps.\n\nFigure 6.7 depicts an inverting amplifier with capacitive feedback, in contrast to the resistive feedback shown in Fig. 6.3a. If the op amp is ideal, the gain from an input change $\\Delta V_{s}$ to an output change $\\Delta V_{o}$ is still determined by the ratio of the impedance of the feedback element $C_{2}$ to the impedance of the input element $C_{1}$, or\n\n$$\n\\begin{equation*}\n\\frac{\\Delta V_{o}}{\\Delta V_{s}}=-\\frac{\\frac{1}{\\omega C_{2}}}{\\frac{1}{\\omega C_{1}}}=-\\frac{C_{1}}{C_{2}} \\tag{6.25}\n\\end{equation*}\n$$\n\nHowever, unlike when resistors are used as passive elements, this circuit does not provide dc bias for the inverting op-amp input because the impedances of both capacitors are infinite at dc. To address this issue, switches controlled by a two-phase nonoverlapping clock are used to control the operation of the circuit. The resulting circuit is known as a switched-capacitor amplifier.\n\nFigure $6.8 a$ illustrates the schematic of a switched-capacitor amplifier. Each switch in the schematic is controlled by one of two clock phases $\\phi_{1}$ and $\\phi_{2}$, and the timing diagram is shown in Fig. $6.8 b$. We will assume that each switch is closed when its controlling clock signal is high and open when its clock signal is low. Since $\\phi_{1}$ and $\\phi_{2}$ are never both high at the same time, the switches controlled by one clock phase are never closed at the same time as the switches controlled by the other clock phase. Because of this property, the clock signals in Fig. $6.8 b$ are known as nonoverlapping. For example, the left side of $C_{1}$ is connected to the input $V_{s}$ through switch $S_{1}$ when $\\phi_{1}$ is high and to ground through switch $S_{2}$ when $\\phi_{2}$ is high, but this node is never simultaneously connected to both the input and ground.\n\nTo simplify the description of the operation of switched-capacitor circuits, they are often redrawn twice, once for each nonoverlapping clock phase. Figures $6.8 c$ and $6.8 d$ show the connections when $\\phi_{1}$ is high (during $\\phi_{1}$ ) and when $\\phi_{2}$ is high (during $\\phi_{2}$ ), respectively. Switches that are closed are assumed to be short circuits, and switches that are open are assumed to be open circuits.\n\nTo find the output for a given input, an analysis based on charge conservation is used. After switch $S_{3}$ opens, the charge on the plates of the capacitors that connect to the op-amp input node is conserved until this switch closes again. This property stems partly from the fact that the passive elements connected to the op-amp input node are capacitors, which conduct zero dc current. Also, if the op amp is constructed with an MOS differential input pair, the op-amp input is connected to the gate of one transistor in the differential pair, and the gate conducts zero dc current. Finally, if we assume that switch $S_{3}$ conducts zero current when it is open, the charge stored cannot leak away while $S_{3}$ is open.\n\nSince both sides of $C_{2}$ are grounded in Fig. $6.8c$, the charge stored on the plates of the capacitors that connect to the the op-amp input node during $\\phi_{1}$ is\n\n$$\n\\begin{equation*}\nQ_{1}=\\left(0-V_{s}\\right) C_{1}+(0) C_{2}=\\left(0-V_{s}\\right) C_{1} \\tag{6.26}\n\\end{equation*}\n$$\n\nBecause the input voltage is sampled or stored onto capacitor $C_{1}$ during $\\phi_{1}$, this phase is known as the input sample phase. If the op amp is ideal, the voltage $V_{i}$ from the inverting op-amp input to ground is driven to zero by negative feedback during $\\phi_{2}$. Therefore, the charge stored during $\\phi_{2}$ is\n\n$$\n\\begin{equation*}\nQ_{2}=(0) C_{1}+\\left(0-V_{o}\\right) C_{2}=\\left(0-V_{o}\\right) C_{2} \\tag{6.27}\n\\end{equation*}\n$$\n\nBecause the sampled charge appears on $C_{1}$ during $\\phi_{1}$ and on $C_{2}$ during $\\phi_{2}, \\phi_{2}$ is known as the charge-transfer phase. By charge conservation, $Q_{2}=Q_{1}$; therefore,\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}} \\tag{6.28}\n\\end{equation*}\n$$\n\nIn (6.28), $V_{s}$ represents the input voltage at the end of $\\phi_{1}$, and $V_{o}$ represents the output voltage at the end of $\\phi_{2}$. The shape of the output voltage waveform is not predicted by (6.28) and depends on the rates at which the capacitors are charged and discharged. In practice, these rates depend on the bandwidth of the op amp and the resistances of the closed switches. The result in (6.28) is valid as long as the op amp is ideal, the input $V_{s}$ is dc, and the intervals over which $\\phi_{1}$ and $\\phi_{2}$ are high are long enough to completely charge and discharge the associated capacitors. The ratio of $V_{o} / V_{s}$ in (6.28) is positive because if $V_{s}>0$ during $\\phi_{1}$, the voltage applied between the left side of $C_{1}$ and ground decreases from a positive value to zero during $\\phi_{2}$. Therefore, this negative change in the applied voltage during $\\phi_{2}$ is multiplied by a negative closed-loop amplifier gain, giving a positive ratio in (6.28).\n\nMOS technologies are well suited to building switched-capacitor circuits for two key reasons. First, the dc current that flows into the input terminals of MOS op amps is zero as long as the inputs are connected only to the gates of MOS transistors. In contrast, bipolar op amps have nonzero dc input currents that stem from finite $\\beta_{F}$ in bipolar transistors. Second, the switches in Fig. $6.8$ can be implemented without offset by using MOS transistors, as shown in Fig. $6.9a$. The arrows indicating the source terminals of $M_{1}-M_{5}$ are arbitrarily chosen in the sense that the source and drain terminals are interchangeable. (Since the source is the source of electrons in $n$-channel transistors, the source-to-ground voltage is lower than the drain-to-ground voltage.) Assume that the clock voltages alternate between $-V_{S S}$ and $V_{D D}$ as shown in Fig. $6.9b$. Also assume that all node voltages are no lower than $-V_{S S}$ and no higher than $V_{D D}$. Finally, assume that the transistor threshold voltages are positive. Under these conditions, each transistor turns off when its gate is low. Furthermore, each transistor turns on when its gate is high as long as its source operates at least a threshold below $V_{D D}$. If $V_{s}$ is a dc signal, all drain currents approach zero as the capacitors become charged. As the drain currents approach zero, the MOS transistors that are on operate in the triode region, where the drain-source voltage is zero when the drain current is zero. Therefore, the input voltage $V_{s}$ is sampled onto $C_{1}$ with zero offset inserted by the MOS transistors operating as switches. This property of MOS transistors is important in the implementation of switched-capacitor circuits. In contrast, bipolar transistors operating as switches do not give zero collector-emitter voltage with zero collector current.\n\nThe switched-capacitor amplifier shown in Fig. $6.9 a$ is important in practice mainly because the gain of this circuit has little dependence on the various parasitic capacitances that are present on all the nodes in the circuit. These undesired capacitances stem in part from the drain-body and source-body junction capacitances of each transistor. Also, the op-amp input capacitance contributes to the parasitic capacitance on the op-amp input node. Furthermore,\nas described in Section 2.10.2, the bottom plates of capacitors $C_{1}$ and $C_{2}$ exhibit at least some capacitance to the underlying layer, which is the substrate or a well diffusion. Since the gain of the circuit is determined by charge conservation at the op-amp input node, the presence of parasitic capacitance from any node except the op-amp input to any node with a constant voltage to ground makes no difference to the accuracy of the circuit. (Such parasitics do reduce the maximum clock rate, however.) On the other hand, parasitic capacitance on the op-amp input node does affect the accuracy of the circuit gain, but the error is inversely proportional to the op-amp gain, as we will now show.\n\nLet $C_{P}$ represent the total parasitic capacitance from the op-amp input to all nodes with constant voltage to ground. If the op-amp gain is $a$, the voltage from the inverting op-amp input to ground during $\\phi_{2}$ is given by (6.10). Therefore, with finite op-amp gain, $C_{1}$ and $C_{P}$ are not completely discharged during $\\phi_{2}$. Under these conditions, the charge stored on the op-amp input node during $\\phi_{2}$ becomes\n\n$$\n\\begin{equation*}\nQ_{2}=\\left(-\\frac{V_{o}}{a}\\right) C_{1}+\\left(-\\frac{V_{o}}{a}\\right) C_{P}+\\left(-\\frac{V_{o}}{a}-V_{o}\\right) C_{2} \\tag{6.29}\n\\end{equation*}\n$$\n\nWhen the op-amp gain becomes infinite, (6.29) collapses to (6.27), as expected. Setting $Q_{2}$ in (6.29) equal to $Q_{1}$ in (6.26) by charge conservation gives\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}}\\left[\\frac{1}{1+\\frac{1}{a}\\left(\\frac{C_{1}+C_{2}+C_{P}}{C_{2}}\\right)}\\right] \\tag{6.30}\n\\end{equation*}\n$$\n\nThis closed-loop gain can be written as\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}}(1-\\epsilon) \\tag{6.31}\n\\end{equation*}\n$$\n\nwhere $\\epsilon$ is a gain error given by\n\n$$\n\\begin{equation*}\n\\epsilon=\\frac{1}{1+a\\left(\\frac{C_{2}}{C_{1}+C_{2}+C_{P}}\\right)} \\tag{6.32}\n\\end{equation*}\n$$\n\nAs $a \\rightarrow \\infty, \\epsilon \\rightarrow 0$, and the gain of the switched-capacitor amplifier approaches $C_{1} / C_{2}$ as predicted in (6.28). As a result, the circuit gain is said to be parasitic insensitive to an extent that depends on the op-amp gain.\n\nOne important parameter of the switched-capacitor amplifier shown in Fig. $6.9 a$ is the minimum clock period. This period is divided into two main parts, one for each clock phase. The duration of $\\phi_{2}$ must be long enough for the op-amp output to reach and stay within a given level of accuracy. This time is defined as the op-amp settling time and depends on the switch resistances, the circuit capacitances, and the op-amp properties. The settling time is usually determined by SPICE simulations. Such simulations should be run for both clock phases because the op-amp output voltage during $\\phi_{1}$ is not well controlled in practice. If the op amp is ideal, this output voltage is zero. With nonzero offset voltage, however, the output voltage will be driven to a nonzero value during $\\phi_{1}$ that depends on both the offset voltage and the op-amp gain. If the op-amp gain is large, the offset can easily be large enough to force the output voltage to clip near one of the supplies. The output voltage at the end of $\\phi_{1}$ can be thought of as an initial condition for the circuit during $\\phi_{2}$. If the initial condition and the desired final output at the end of $\\phi_{2}$ happen to have far different values, the time required for the output to reach a given level of accuracy during $\\phi_{2}$ can be increased. Furthermore, nonzero offset can increase the time required for the op-amp output voltage to reach a constant level during $\\phi_{1}$. Although the circuit output voltage defined in (6.30) only appears during $\\phi_{2}$, failure\nto reach a constant output voltage during $\\phi_{1}$ causes the initial condition defined above to vary, depending on the value of $V_{o}$ at the end of the preceding $\\phi_{2}$. As a result of this memory effect, the circuit can behave as a filter (which is possibly nonlinear), weighting together the results of more than one previous input sample to determine any given output. The key point is that an increase in the minimum duration of either phase requires an increase in the minimum clock period. This effect should be included in simulation by intentionally simulating with nonzero offset voltages.\n\nOne way to reduce the effect of nonzero offset voltage on the minimum clock period is to include a reset switch at the op-amp output. If the op amp has a single-ended output as shown in Fig. 6.9a, such a switch can be connected between the op-amp output and a bias point between the two supplies. On the other hand, if the op amp has differential outputs as described in Chapter 12, such a switch can be connected between the two op-amp outputs. In either case, the reset switch would be turned on during $\\phi_{1}$ and off during $\\phi_{2}$. The main value of such a reset switch is that it can reduce both the maximum output voltage produced by a nonzero offset voltage during $\\phi_{1}$ and the time required to reach this value, in turn reducing the effect of nonzero offset on the minimum durations of both phases.\n\nThe accuracy of the switched-capacitor amplifier shown in Fig. $6.9 a$ is limited by several other factors that we will now consider briefly. First, even with an ideal op amp, the gain depends on the ratio of capacitors $C_{1} / C_{2}$, which is not controlled perfectly in practice because of random-mismatch effects. Second, op-amp offset limits the minimum signal that can be distinguished from the offset in the switched-capacitor amplifier. As shown in Section 3.5.6, the input-referred offset of CMOS differential pairs is usually worse than for bipolar differential pairs. This property extends to op amps and stems partly from the reduced transconductance-to-current ratio of MOS transistors compared to their bipolar counterparts and partly from the threshold mismatch term, which appears only in the MOS case. Third, the charge-conservation equation and accuracy of the switched-capacitor amplifier are affected by the charge stored under the gates of some of the MOS transistors acting as switches in Fig. 6.9a. For example, some of the charge stored under the gate of transistor $M_{3}$ in Fig. $6.9 a$ is injected onto the op-amp input node after $M_{3}$ is turned off. Techniques to overcome these limitations are often used in practice but are not considered here.\n\n#### 6.1.7.2 Switched-Capacitor Integrator\n\nAnother application of an internal op amp, a switched-capacitor integrator, is illustrated in its simplest form in Fig. 6.10a. This circuit is widely utilized as the basic element of monolithic switched-capacitor filters for two main reasons. First, the frequency response of the integrator is insensitive to the various parasitic capacitances that are present on all nodes in the circuit. ${ }^{4,5}$ Second, using switched-capacitor integrators as the basic elements, the synthesis of desired filter frequency responses is relatively straightforward. In this section, we will analyze the frequency response of the switched-capacitor integrator.\n\nThe integrator consists of an op amp, a sampling capacitor $C_{S}$, an integrating capacitor $C_{I}$, and four MOS transistor switches. The load capacitance shown represents the sampling capacitor of the following integrator, plus any parasitic capacitances that may be present. Typical values for the sampling, integrating, and load capacitances are labeled in Fig. 6.10a.\n\nFigure $6.10 b$ shows the timing diagram of two nonoverlapping clock signals, $\\phi_{1}$ and $\\phi_{2}$, that control the operation of the circuit as well as typical"
},
{
    "text": "differential-pair-based amplifiers, utilized within monolithic analog subsystems, tend to have distinct performance requirements compared to those of general-purpose op amps that rely on external feedback components. Typically, only a select few amplifiers within the subsystem need to drive signals off-chip, where the capacitive and resistive loads are appreciable and can vary. These particular amplifiers are referred to as output buffers, whereas those whose outputs remain on-chip are designated as internal amplifiers. A critical distinction is that the load driven by an internal amplifier is well defined and usually purely capacitive, with a value of a few picofarads. This contrasts with standalone general-purpose amplifiers, which are typically designed to maintain a consistent level of performance regardless of capacitive load variations up to several hundred picofarads and resistive loads down to $2 \\mathrm{k} \\Omega$ or less.\n\n#### 6.1.7.1 Switched-Capacitor Amplifier\n\nIn MOS technologies, capacitors are frequently employed as the passive elements in feedback amplifiers, partly due to their prevalence as high-quality passive components. Capacitors have the ability to store charge proportional to analog signals of interest, and MOS transistors can serve as switches to connect to these capacitors with minimal offset and leakage, enabling discrete-time signal processing of analog quantities. The subject of MOS switched-capacitor amplifiers represents an important application of internal amplifiers and is introduced here to elucidate the construction of MOS op amps.\n\nThe schematic in Figure 6.7 illustrates an inverting amplifier with capacitive feedback, contrasting with the resistive feedback depicted in Figure 6.3a. If the op amp is ideal, the gain from a change in the input $\\Delta V_{s}$ to a change in the output $\\Delta V_{o}$ remains governed by the ratio of the impedance of the feedback element $C_{2}$ to the impedance of the input element $C_{1}$, or\n\n$$\n\\begin{equation*}\n\\frac{\\Delta V_{o}}{\\Delta V_{s}}=-\\frac{\\frac{1}{\\omega C_{2}}}{\\frac{1}{\\omega C_{1}}}=-\\frac{C_{1}}{C_{2}} \\tag{6.25}\n\\end{equation*}\n$$\n\nIn contrast to circuits using resistors as passive elements, this configuration lacks dc bias for the inverting op-amp input because the impedances of both capacitors approach infinity at dc. To address this issue, switches governed by a two-phase nonoverlapping clock are employed to control the operation of the circuit. The resulting configuration is known as a switched-capacitor amplifier.\n\nFigure $6.8 a$ presents the schematic of a switched-capacitor amplifier. Each switch in the diagram is controlled by one of two clock phases $\\phi_{1}$ and $\\phi_{2}$, with the timing diagram depicted in Figure 6.8b. We assume that each switch is closed when its controlling clock signal is high and open when it is low. Since $\\phi_{1}$ and $\\phi_{2}$ never peak simultaneously, switches controlled by one clock phase do not close concurrently with those controlled by the other. This property characterizes the clock signals in Figure 6.8b as nonoverlapping. For instance, the left side of $C_{1}$ connects to the input $V_{s}$ through switch $S_{1}$ when $\\phi_{1}$ is high and to ground through switch $S_{2}$ when $\\phi_{2}$ is high, but this node is never simultaneously linked to both the input and ground.\n\nFor clarity, switched-capacitor circuits are often depicted twice, once for each nonoverlapping clock phase. Figures $6.8 c$ and $6.8 d$ illustrate the connections during $\\phi_{1}$ and $\\phi_{2}$, respectively. Closed switches are assumed to be short circuits, and open switches are considered open circuits.\n\nCharge conservation analysis is employed to determine the output for a given input. After switch $S_{3}$ opens, the charge on the capacitors connected to the op-amp input node is preserved until this switch closes again. This property is partly due to the capacitive nature of the passive elements connected to the op-amp input node, which conduct zero dc current. Additionally, if the op amp employs an MOS differential input pair, the input is connected to the gate of one transistor in the pair, which also conducts zero dc current. Assuming switch $S_{3}$ conducts zero current when open, the stored charge cannot leak away while $S_{3}$ remains open.\n\nSince both sides of $C_{2}$ are grounded in Figure 6.8c, the charge stored on the capacitors connected to the op-amp input node during $\\phi_{1}$ is\n\n$$\n\\begin{equation*}\nQ_{1}=\\left(0-V_{s}\\right) C_{1}+(0) C_{2}=\\left(0-V_{s}\\right) C_{1} \\tag{6.26}\n\\end{equation*}\n$$\n\nThis phase, where the input voltage is sampled onto capacitor $C_{1}$, is referred to as the input sample phase. If the op amp is ideal, the voltage $V_{i}$ from the inverting op-amp input to ground is driven to zero by negative feedback during $\\phi_{2}$. Consequently, the charge stored during $\\phi_{2}$ is\n\n$$\n\\begin{equation*}\nQ_{2}=(0) C_{1}+\\left(0-V_{o}\\right) C_{2}=\\left(0-V_{o}\\right) C_{2} \\tag{6.27}\n\\end{equation*}\n$$\n\nThe charge sampled during $\\phi_{1}$ appears on $C_{1}$, and during $\\phi_{2}$, it appears on $C_{2}$. Therefore, $\\phi_{2}$ is known as the charge-transfer phase. By charge conservation, $Q_{2}=Q_{1}$; hence,\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}} \\tag{6.28}\n\\end{equation*}\n$$\n\nIn (6.28), $V_{s}$ denotes the input voltage at the end of $\\phi_{1}$, and $V_{o}$ represents the output voltage at the end of $\\phi_{2}$. The waveform\n of the output voltage waveform is not predicted by (6.28) and depends on the rates at which the capacitors are charged and discharged. In practice, these rates are influenced by the bandwidth of the op amp and the resistances of the closed switches. The result in (6.28) holds as long as the op amp is ideal, the input $V_{s}$ is dc, and the intervals over which $\\phi_{1}$ and $\\phi_{2}$ are high are sufficient to completely charge and discharge the associated capacitors. The ratio of $V_{o} / V_{s}$ in (6.28) is positive because if $V_{s}>0$ during $\\phi_{1}$, the voltage applied between the left side of $C_{1}$ and ground decreases from a positive value to zero during $\\phi_{2}$. Thus, this negative change in the applied voltage during $\\phi_{2}$ is multiplied by a negative closed-loop amplifier gain, resulting in a positive ratio in (6.28).\n\nMOS technologies are particularly well-suited for constructing switched-capacitor circuits due to two primary reasons reasons. Firstly, the dc current flowing into the input terminals of MOS op amps is zero as long as the inputs are connected only to the gates of MOS transistors. In contrasts with bipolar op amps, which have nonzero dc input currents stemming from finite finite $\\beta_{F}$ of bipolar transistors. Second, the switches in in Figure 6.8 can be implemented without offset by using MOS transistors, as shown in Figure 6.9a. The arrows indicating the source terminals of $M_{1}-M_{5}$ are arbitrarily chosen, as the source and drain terminals are interchangeable. Assuming the clock voltages alternate between $-V_{S S}$ and $V_{D D}$ as depicted in Figure 6.9b, and that all node voltages remain within $-V_{S S}$ and $V_{D D}$, each transistor turns off when its gate is low. Furthermore, each transistor turns on when its gate is high, provided its source operates at least a threshold below $V_{D D}$. If $V_{s}$ is a dc signal, all drain currents diminish zero as the capacitors become charged. As the drain currents diminish, the MOS transistors that are on operate in the triode region, where the drain-source voltage is zero when the drain current is zero. Consequently, the input voltage $V_{s}$ is sampled onto $C_{1}$ with zero offset introduced by the MOS transistors acting acting as switches. This property of MOS transistors is crucial in the implementation of switched-capacitor circuits. In contrast, bipolar transistors operating as switches do not provide zero collector-emitter voltage with zero collector current.\n\nThe switched-capacitor amplifier depicted in Figure $6.9 a$ is significant in practice mainly because its gain is largely unaffected by the various parasitic capacitances present on all nodes nodes nodes in the circuit. These undesired capacitances arise partly from the drain-body and source-body junction capacitances of each transistor. Additionally, the op-amp input capacitance contributes to the parasitic capacitance on the op-amp input node. Furthermore, as discussed in Section 2.10.2, the bottom plates of capacitors $C_{1}$ and $C_{2}$ exhibit at least some capacitance to the underlying layer, which is the substrate or a well diffusion. Since the gain of the circuit is determined by charge conservation at the op-amp input node, the presence of parasitic capacitance from any node except the op-amp input to any node with a constant voltage to ground does not affect the circuit's accuracy. (However, these parasitics do reduce the maximum clock rate.) On On the other hand, parasitic capacitance on the op-amp input node does impact the accuracy accuracy of the circuit gain, but the error is inversely proportional to the op-amp gain, as we will now demonstrate.\n\nLet $C_{P}$ denote the total parasitic capacitance from the op-amp input to all nodes with constant voltage to ground. If the op-amp gain is $a$, the voltage from the inverting op-amp input to ground during $\\phi_{2}$ is given by (6.10). Therefore, with finite op-amp gain, $C_{1}$ and $C_{P}$ are not completely discharged during $\\phi_{2}$. Under these conditions, the charge stored on the op-amp input node during $\\phi_{2}$ becomes\n\n$$\n\\begin{equation*}\nQ_{2}=\\left(-\\frac{V_{o}}{a}\\right) C_{1}+\\left(-\\frac{V_{o}}{a}\\right) C_{P}+\\left(-\\frac{V_{o}}{a}-V_{o}\\right) C_{2} \\tag{6.29}\n\\end{equation*}\n$$\n\nWhen the op-amp gain approaches infinity, (6.29) simplifies to (6.27), as expected. Settingating $Q_{2}$ in (6.29) to $Q_{1}$ in (6.26) by charge conservation yields\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}}\\left[\\frac{1}{1+\\frac{1}{a}\\left(\\frac{C_{1}+C_{2}+C_{P}}{C_{2}}\\right)}\\right] \\tag{6.30}\n\\end{equation*}\n$$\n\nThis closed-loop gain can be expressed as\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}}(1-\\epsilon) \\tag{6.31}\n\\end{equation*}\n$$\n\nwhere $\\epsilon$ is a gain error defined by\n\n$$\n\\begin{equation*}\n\\epsilon=\\frac{1}{1+a\\left(\\frac{C_{2}}{C_{1}+C_{2}+C_{P}}\\right)} \\tag{6.32}\n\\end{equation*}\n$$\n\nAs $a \\rightarrow \\infty, \\epsilon \\rightarrow 0$, and the gain of the switched-capacitor amplifier converges towards $C_{1} / C_{2}$ as predicted in (6.28). Consequently, the circuit gain is considered parasitic insensitive to with the degree of this insensitivity depending on the op-amp gain.\n\nA critical crucial parameter of the switched-capacitor amplifier shown in Figure $6.9 a$ is the minimum clock period. This period is divided into two main parts, corresponding to each clock phase. The duration of $\\phi_{2}$ must be sufficient for the op-amp output to reach and maintain a specified level of accuracy. This time is defined as the op-amp settling time and depends on the switch resistances, the circuit capacitances, and the op-amp properties. The settling time is typically determined through SPICE simulations. These simulations should account for both clock phases, as the op-amp output voltage during $\\phi_{1}$ is not well controlled in practice. If the op amp is ideal, this output voltage is zero. However, with nonzero offset voltage, the output voltage will be driven to a nonzero value during $\\phi_{1}$ that depends on both the offset voltage and the op-amp gain. If the op-amp gain is large, the offset can easily be substantial enough to force the output voltage to clip near one of the supplies. The output voltage at the end of $\\phi_{1}$ can be regarded as an initial condition for the circuit during $\\phi_{2}$. If the initial condition and the desired final output at the end of $\\phi_{2}$ differ significantly, the time required for the output to reach a given level of accuracy during $\\phi_{2}$ can increase. Moreover, nonzero offset can prolong the time needed for the op-amp output voltage to stabilize during $\\phi_{1}$. Although the circuit output voltage defined in (6.30) only appears during $\\phi_{2}$, failure to achieve the output voltage during $\\phi_{1}$ causes to variations in the initial condition, depending on the value of $V_{o}$ at the end of the preceding $\\phi_{2}$. As a result of this memory effect, the circuit can behave as a filter (potentially nonlinear), combining the effects of multiple previous input samples to determine any given output. The key point is that an increase in the minimum duration of either phase necessitates an increase in the minimum clock period. This effect should be incorporated in simulations by intentionally incorporating nonzero offset voltages.\n\nOne method to mitigate the impact of nonzero offset voltage on the minimum clock period is to incorporate a reset switch at the op-amp output. If the op amp has a single-ended output as shown in Figure 6.9a, such a switch can be connected between the op-amp output and a bias point between the two supplies. Alternatively, if the op amp has differential outputs as described in Chapter 12, a reset switch can be connected between the two op-amp outputs. In either case, the reset switch would be activated during $\\phi_{1}$ and deactivated during $\\phi_{2}$. The primary benefit of such reset switch is that it can reduce both the maximum output voltage generated by a nonzero offset voltage during $\\phi_{1}$ and the time required to reach this value, thereby diminishing the effect of nonzero offset on the minimum durations of both phases.\n\nThe accuracy of the switched-capacitor amplifier depicted in Figure $6.9 a$ is受限 constrained by several other factors, which we will briefly examine. First, even with an ideal op amp, the gain depends on the ratio of capacitors $C_{1} / C_{2}$, which is not perfectly controlled in practice due to random-mismatch effects. Second, op-amp offset limits the smallest signal that can be distinguished from the offset in the switched-capacitor amplifier. As discussed in Section 3.5.6, the input-referred offset of CMOS differential pairs is typically inferior to that of bipolar differential pairs. This characteristic extends to op amps and is partly attributed to the reduced transconductance-to-current ratio of MOS transistors compared to their bipolar counterparts and as well as the threshold mismatch term, to the MOS case. Third, the charge-conservation equation and accuracy of the switched-capacitor amplifier are affected by the charge stored under the gates of some of the MOS transistors acting as switches in Figure 6.9a. For instance, some of the charge stored under the gate of transistor $M_{3}$ in Figure $6.9 a$ is injected onto the op-amp input node after $M_{3}$ is turned off. Techniques to address overcome these limitations are commonly employed in practice but are not addressed here.\n\n#### 6.1.7.2 Switched-Capacitor Integrator\n\nAnother application of an internal op amp is the switched-capacitor integrator, illustrated is illustrated in its simplest form in Figure 6.10a. This circuit is serves extensively used as the fundamental building block of monolithic switched-capacitor filters for two primary reasons. First, the frequency response of the integrator is largely unaffected to the various parasitic capacitances present on all nodes in the circuit. Second, using switched-capacitor integrators as the basic elements, the synthesis of desired filter frequency responses is relatively straightforward. In this section, we will analyze the frequency response of the switched-capacitor integrator.\n\nThe integrator comprises an op amp, a sampling capacitor $C_{S}$, an integrating capacitor $C_{I}$, and four MOS transistor switches. The load capacitance depicted represents the sampling capacitor of the subsequent integrator, along with any parasitic capacitances that may be present. Typical values for the sampling, integrating, and load capacitances are indicated in Figure 6.10a.\n\nFigure $6.10 b$ displays the timing diagram of two nonoverlapping clock signals, $\\phi_{1}$ and $\\phi_{2}$, that govern the circuit's operation, as well as typical input and output waveforms. During the interval when clock phase $\\phi_{1}$ is high, transistors $M_{1}$ and $M_{3}$ operate in the triode region and charge responsible for charging the sampling capacitor to a voltage equal to the input voltage. Subsequently, clock signal $\\phi_{1}$ falls, and by the rise of clock signal $\\phi_{2}$, causing transistors $M_{2}$ and $M_{4}$ to turn on and connecting sampling capacitor to be connected between the inverting op-amp input (sometimes called to as the summing node) and ground. If the op amp is ideal, the resulting change in the summing-node voltage prompts the op-amp output to adjust so that the summing"
},
{
    "text": "The performance objectives for operational amplifiers (op amps) utilized within monolithic analog subsystems significantly differ from those of general-purpose op amps that employ external feedback elements. In monolithic analog subsystems, only a select few amplifiers need to drive signals off-chip, where the capacitive and resistive loads are substantial and variable. These amplifiers are referred to as output buffers, while the amplifiers whose outputs remain on-chip are called internal amplifiers. A crucial distinction is that the load driven by an internal amplifier is well defined and usually purely capacitive, with a value of a few picofarads. In contrast, stand-alone general-purpose amplifiers typically must be designed to maintain a certain level of performance that is unaffected by changes in capacitive loads up to several hundred picofarads and resistive loads down to $2 \\mathrm{k} \\Omega$ or less.\n\n#### 6.1.7.1 Switched-Capacitor Amplifier\n\nIn metal-oxide-semiconductor (MOS) technologies, capacitors are frequently employed as passive elements in feedback amplifiers due to their availability and ability to store charge proportional to analog signals of interest. MOS transistors can act as switches to connect to these capacitors without offset and with minimal leakage, enabling the discrete-time signal processing of analog quantities. MOS switched-capacitor amplifiers represent an important application of internal amplifiers. Here, we explore this application to elucidate the construction of MOS op amps.\n\nFigure 6.7 depicts the schematic of an inverting amplifier with capacitive feedback, contrasting with the resistive feedback shown in Fig. 6.3a. If the op amp is ideal, the gain from a change in the input $\\Delta V_{s}$ to a change in the output $\\Delta V_{o}$ remains governed by the ratio of the impedance of the feedback element $C_{2}$ to the impedance of the input element $C_{1}$, as expressed in Equation (6.25).\n\nHowever, unlike when resistors are used as passive elements, this circuit does not provide dc bias for the inverting op-amp input due to the capacitors' infinite impedance at dc. To address this issue, switches controlled by a two-phase nonoverlapping clock are employed to govern the circuit's operation, resulting in a switched-capacitor amplifier.\n\nFigure 6.8a illustrates the schematic of a switched-capacitor amplifier, where each switch is controlled by one of two clock phases $\\phi_{1}$ and $\\phi_{2}$, with the timing diagram depicted in Fig. 6.8b. We assume that each switch closes when its controlling clock signal is high and opens when it is low. Since $\\phi_{1}$ and $\\phi_{2}$ are never high simultaneously, the switches controlled by one clock phase do not close at the same time as those controlled by the other phase. This characteristic ensures that the clock signals in Fig. 6.8b are known as nonoverlapping. For instance, the left side of $C_{1}$ connects to the input $V_{s}$ through switch $S_{1}$ when $\\phi_{1}$ is high and to ground through switch $S_{2}$ when $\\phi_{2}$ is high, but this node is never simultaneously connected to both the input and ground.\n\nTo simplify the description of switched-capacitor circuits' operation, they are often redrawn for each nonoverlapping clock phase. Figures 6.8c and 6.8d show the connections during $\\phi_{1}$ and $\\phi_{2}$, respectively. Closed switches are assumed to be short circuits, and open switches are assumed to be open circuits.\n\nCharge conservation analysis is employed to determine the output for a given input. After switch $S_{3}$ opens, the charge on the capacitors connected to the op-amp input node is conserved until this switch closes again. This property stems from the capacitive nature of the passive elements connected to the op-amp input node, which conduct zero dc current. Additionally, if the op amp is constructed with an MOS differential input pair, the op-amp input is connected to the gate of one transistor in the differential pair, and the gate conducts zero dc current. Assuming that switch $S_{3}$ conducts zero current when open, the stored charge cannot leak away while $S_{3}$ is open.\n\nDuring $\\phi_{1}$, when both sides of $C_{2}$ are grounded, the charge stored on the capacitors connected to the op-amp input node is given by Equation (6.26). This phase is known as the input sample phase. If the op amp is ideal, the voltage $V_{i}$ from the inverting op-amp input to ground is driven to zero by negative feedback during $\\phi_{2}$. Hence, the charge stored during $\\phi_{2}$ is represented by Equation (6.27), and this phase is known as the charge-transfer phase. By charge conservation, $Q_{2}=Q_{1}$, leading to Equation (6.28).\n\nMOS technologies are particularly well-su for constructing switched-capacitor circuits due to two key reasons. First, the dc current flowing into the input terminals of MOS op amps is zero as long as the inputs are connected only to the gates of MOS transistors. In contrast, bipolar op amps have nonzero dc input currents stemming from finite $\\beta_{F}$ in bipolar transistors. Second, the switches in Fig. 6.8 can be implemented without offset using MOS transistors, as shown in Fig. 6.9a.\n\nThe switched-capacitor amplifier depicted\nThe performance specifications for op amps within monolithic analog subsystems are distinct from those of general-purpose op amps with external feedback. In a monolithic setup, only a handful\nThe performance specifications for op amps within monolithic analog subsystems are distinct from those of general-purpose op amps with external feedback. In a monolithic setup, only a few amplifiers need to drive signals off-chip, where the capacitive and resistive loads are significant and variable. These amplifiers are termed output buffers, while those with outputs remaining on-chip are called internal amplifiers. A crucial difference is that the load driven by an internal amplifier is well defined and usually purely capacitive, with a value of a few picofarads. In contrast, stand-alone general-purpose amplifiers typically must be designed to maintain a certain level of performance that is unaffected by changes in capacitive loads up to several hundred picofarads and resistive loads down to $2 \\mathrm{k} \\Omega$ or less.\n\n#### 6.1.7.1 Switched-Capacitor Amplifier\n\nIn metal-oxide-semiconductor (MOS) technologies, capacitors are frequently employed as passive elements in feedback amplifiers due to their availability and ability to store charge proportional to analog signals of interest. MOS transistors can act as switches to connect to these capacitors without offset and with minimal leakage, enabling the discrete-time signal processing of analog quantities. MOS switched-capacitor amplifiers represent an important application of internal amplifiers. Here, we explore this application to elucidate the construction of MOS op amps.\n\nFigure 6.7 depicts the schematic of an inverting amplifier with capacitive feedback, contrasting with the resistive feedback shown in Fig. 6.3a. If the op amp is ideal, the gain from a change in the input $\\Delta V_{s}$ to a change in the output $\\Delta V_{o}$ remains governed by the ratio of the impedance of the feedback element $C_{2}$ to the impedance of the input element $C_{1}$, as expressed in Equation (6.25).\n\nHowever, unlike when resistors are used as passive elements, this circuit does not provide dc bias for the inverting op-amp input due to the capacitors' infinite impedance at dc. To address this issue, switches controlled by a two-phase nonoverlapping clock are employed to govern the circuit's operation, resulting in a switched-capacitor amplifier.\n\nFigure 6.8a illustrates the schematic of a switched-capacitor amplifier, where each switch is controlled by one of two clock phases $\\phi_{1}$ and $\\phi_{2}$, with the timing diagram depicted in Fig. 6.8b. We assume that each switch closes when its controlling clock signal is high and opens when it is low. Since $\\phi_{1}$ and $\\phi_{2}$ are never high simultaneously, the switches controlled by one clock phase do not close at the same time as those controlled by the other phase. This characteristic ensures that the clock signals in Fig. 6.8b are known as nonoverlapping. For instance, the left side of $C_{1}$ connects to the input $V_{s}$ through switch $S_{1}$ when $\\phi_{1}$ is high and to ground through switch $S_{2}$ when $\\phi_{2}$ is high, but this node is never simultaneously connected to both the input and ground.\n\nTo simplify the description of switched-capacitor circuits' operation, they are often redrawn for each nonoverlapping clock phase. Figures 6.8c and 6.8d show the connections during $\\phi_{1}$ and $\\phi_{2}$, respectively. Closed switches are assumed to be short circuits, and open switches are assumed to be open circuits.\n\nCharge conservation analysis is employed to determine the output for a given input. After switch $S_{3}$ opens, the charge on the capacitors connected to the op-amp input node is conserved until this switch closes again. This property stems from the capacitive nature of the passive elements connected to the op-amp input node, which conduct zero dc current. Additionally, if the op amp is constructed with an MOS differential input pair, the op-amp input is connected to the gate of one transistor in the differential pair, and the gate conducts zero dc current. Assuming that switch $S_{3}$ conducts zero current when open, the stored charge cannot leak away while $S_{3}$ is open.\n\nDuring $\\phi_{1}$, when both sides of $C_{2}$ are grounded, the charge stored on the capacitors connected to the op-amp input node is given by Equation (6.26). This phase is known as the input sample phase. If the op amp is ideal, the voltage $V_{i}$ from the inverting op-amp input to ground is driven to zero by negative feedback during $\\phi_{2}$. Consequently, the charge stored during $\\phi_{2}$ is represented by Equation (6.27), and this phase is known as the charge-transfer phase. By charge conservation, $Q_{2}=Q_{1}$, leading to Equation (6.28).\n\nMOS technologies are particularly well suited for constructing switched-capacitor circuits due to two key reasons. First, the dc current flowing into the input terminals of MOS op amps is zero as long as the inputs are connected only to the gates of MOS transistors. In contrast, bipolar op amps have nonzero dc input currents stemming from finite $\\beta_{F}$ in bipolar transistors. Second, the switches in Fig. 6.8 can be implemented without offset using MOS transistors, as shown in Fig. 6.9a.\n\nThe switched-capacitor amplifier"
},
{
    "text": "The specifications for operational amplifiers (op amps) in monolithic analog subsystems differ significantly from those in general-purpose op amps that utilize external feedback elements. In monolithic systems, only a limited number of amplifiers need to drive signals off-chip, where the capacitive and resistive loads are substantial and variable. These amplifiers are referred to as output buffers, while those with outputs that remain on-chip are called internal amplifiers. A critical distinction is that the load driven by an internal amplifier is well-defined and often purely capacitive, typically a few picofarads. In comparison, standalone general-purpose amplifiers must be designed to maintain performance levels that are unaffected by capacitive loads up to several hundred picofarads and resistive loads down to $2 \\mathrm{k} \\Omega$ or less.\n\n#### 6.1.7.1 Switched-Capacitor Amplifier\n\nIn MOS technologies, capacitors are commonly used as passive elements in feedback amplifiers due to their prevalence and ability to store charge proportional to analog signals of interest. MOS transistors act as switches to connect to these capacitors without offset and with minimal leakage, enabling the processing of analog quantities in discrete time. An important application of internal amplifiers is in MOS switched-capacitor amplifiers, which we will explore to elucidate the construction of MOS op amps.\n\nFigure 6.7 illustrates an inverting amplifier with capacitive feedback, contrasting with the resistive feedback shown in Fig. 6.3a. If the op amp is ideal, the gain from a change in the input $\\Delta V_{s}$ to a change in the output $\\Delta V_{o}$ remains the ratio of the impedance of the feedback element $C_{2}$ to the impedance of the input element $C_{1}$, or\n\n$$\n\\begin{equation*}\n\\frac{\\Delta V_{o}}{\\Delta V_{s}}=-\\frac{\\frac{1}{\\omega C_{2}}}{\\frac{1}{\\omega C_{1}}}=-\\frac{C_{1}}{C_{2}} \\tag{6.25}\n\\end{equation*}\n$$\n\nHowever, unlike when resistors are used, this circuit does not provide DC bias for the inverting op-amp input due to the infinite impedance of the capacitors at DC. To address this, switches controlled by a two-phase nonoverlapping clock are used to manage the circuit's operation, resulting in a switched-capacitor amplifier.\n\nFigure $6.8 a$ depicts the schematic of a switched-capacitor amplifier, with each switch governed by one of two clock phases $\\phi_{1}$ and $\\phi_{2}$, and the timing diagram shown in Fig. $6.8 b$. We assume that each switch closes when its controlling clock signal is high and opens when it is low. Since $\\phi_{1}$ and $\\phi_{2}$ are never high simultaneously, the switches controlled by one phase are never closed at the same time as those controlled by the other. This property characterizes the clock signals as nonoverlapping. For instance, the left side of $C_{1}$ is connected to the input $V_{s}$ through switch $S_{1}$ when $\\phi_{1}$ is high and to ground through switch $S_{2}$ when $\\phi_{2}$ is high, but this node is never simultaneously connected to both the input and ground.\n\nTo simplify the description of switched-capacitor circuits, they are often redrawn for each nonoverlapping clock phase. Figures $6.8 c$ and $6.8 d$ show the connections when $\\phi_{1}$ is high (during $\\phi_{1}$) and when $\\phi_{2}$ is high (during $\\phi_{2}$), respectively. Closed switches are considered short circuits, and open switches are considered open circuits.\n\nThe output for a given input is determined through an analysis based on charge conservation. After switch $S_{3}$ opens, the charge on the capacitors connected to the op-amp input node is conserved until this switch closes again. This property is partly due to the capacitive nature of the passive elements connected to the op-amp input node, which conduct zero DC current. Additionally, if the op amp is built with an MOS differential input pair, the op-amp input is connected to the gate of one transistor in the pair, and the gate conducts zero DC current. Finally, assuming switch $S_{3}$ conducts zero current when open, the stored charge cannot leak away while $S_{3}$ is open.\n\nSince both sides of $C_{2}$ are grounded in Fig. $6.8 c$, the charge stored on the capacitors connected to the op-amp input node during $\\phi_{1}$ is\n\n$$\n\\begin{equation*}\nQ_{1}=\\left(0-V_{s}\\right) C_{1}+(0) C_{2}=\\left(0-V_{s}\\right) C_{1} \\tag{6.26}\n\\end{equation*}\n$$\n\nThis phase, where the input voltage is sampled onto capacitor $C_{1}$, is known as the input sample phase. If the op amp is ideal, the voltage $V_{i}$ from the inverting op-amp input to ground is driven to zero by negative feedback during $\\phi_{2}$. Therefore, the charge stored during $\\phi_{2}$ is\n\n$$\n\\begin{equation*}\nQ_{2}=(0) C_{1}+\\left(0-V_{o}\\right) C_{2}=\\left(0-V_{o}\\right) C_{2} \\tag{6.27}\n\\end{equation*}\n$$\n\nSince the sampled charge appears on $C_{1}$ during $\\phi_{1}$ and on $C_{2}$ during $\\phi_{2}$, $\\phi_{2}$ is known as the charge-transfer phase. By charge conservation, $Q_{2}=Q_{1}$; thus,\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}} \\tag{6.28}\n\\end{equation*}\n$$\n\nIn (6.28), $V_{s}$ represents the input voltage at the end of $\\phi_{1}$, and $V_{o}$ represents the output voltage at the end of $\\phi_{2}$. The shape of the output voltage waveform depends on the rates at which the capacitors are charged and discharged, which in turn depend on the bandwidth of the op amp and the resistances of the closed switches. The result in (6.28) holds as long as the op amp is ideal, the input $V_{s}$ is DC, and the intervals over which $\\phi_{1}$ and $\\phi_{2}$ are high are sufficient to completely charge and discharge the associated capacitors. The positive ratio of $V_{o} / V_{s}$ in (6.28) is due to the negative change in the applied voltage during $\\phi_{2}$ being multiplied by a negative closed-loop amplifier gain.\n\nMOS technologies are well-suited for switched-capacitor circuits for two primary reasons. First, the DC current flowing into the input terminals of MOS op amps is zero as long as the inputs are connected only to the gates of MOS transistors. In contrast, bipolar op amps have nonzero DC input currents due to finite $\\beta_{F}$ in bipolar transistors. Second, the switches in Fig. $6.8$ can be implemented without offset using MOS transistors, as shown in Fig. $6.9 a$. The arrows indicating the source terminals of $M_{1}-M_{5}$ are arbitrarily chosen, as the source and drain terminals are interchangeable. Assuming the clock voltages alternate between $-V_{S S}$ and $V_{D D}$ as shown in Fig. $6.9 b$, and that all node voltages are no lower than $-V_{S S}$ and no higher than $V_{D D}$, each transistor turns off when its gate is low and turns on when its gate is high as long as its source operates at least a threshold below $V_{D D}$. If $V_{s}$ is a DC signal, all drain currents approach zero as the capacitors become charged. As the drain currents approach zero, the MOS transistors that are on operate in the triode region, where the drain-source voltage is zero when the drain current is zero. Therefore, the input voltage $V_{s}$ is sampled onto $C_{1}$ with zero offset inserted by the MOS transistors operating as switches. This property of MOS transistors is crucial in the implementation of switched-capacitor circuits. In contrast, bipolar transistors operating as switches do not provide zero collector-emitter voltage with zero collector current.\n\nThe switched-capacitor amplifier shown in Fig. $6.9 a$ is significant in practice mainly because its gain is largely unaffected by the various parasitic capacitances present on all nodes in the circuit. These undesired capacitances arise partly from the drain-body and source-body junction capacitances of each transistor and the op-amp input capacitance. Additionally, as described in Section 2.10.2, the bottom plates of capacitors $C_{1}$ and $C_{2}$ exhibit at least some capacitance to the underlying layer, which is the substrate or a well diffusion. Since the gain of the circuit is determined by charge conservation at the op-amp input node, the presence of parasitic capacitance from any node except the op-amp input to any node with a constant voltage to ground does not affect the accuracy of the circuit. (However, these parasitics do reduce the maximum clock rate.) On the other hand, parasitic capacitance on the op-amp input node does affect the accuracy of the circuit gain, but the error is inversely proportional to the op-amp gain, as we will now demonstrate.\n\nLet $C_{P}$ represent the total parasitic capacitance from the op-amp input to all nodes with constant voltage to ground. If the op-amp gain is $a$, the voltage from the inverting op-amp input to ground during $\\phi_{2}$ is given by (6.10). Therefore, with finite op-amp gain, $C_{1}$ and $C_{P}$ are not completely discharged during $\\phi_{2}$. Under these conditions, the charge stored on the op-amp input node during $\\phi_{2}$ becomes\n\n$$\n\\begin{equation*}\nQ_{2}=\\left(-\\frac{V_{o}}{a}\\right) C_{1}+\\left(-\\frac{V_{o}}{a}\\right) C_{P}+\\left(-\\frac{V_{o}}{a}-V_{o}\\right) C_{2} \\tag{6.29}\n\\end{equation*}\n$$\n\nWhen the op-amp gain becomes infinite, (6.29) simplifies to (6.27), as expected. Setting $Q_{2}$ in (6.29) equal to $Q_{1}$ in (6.26) by charge conservation gives\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}}\\left[\\frac{1}{1+\\frac{1}{a}\\left(\\frac{C_{1}+C_{2}+C_{P}}{C_{2}}\\right)}\\right] \\tag{6.30}\n\\end{equation*}\n$$\n\nThis closed-loop gain can be expressed as\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}}(1-\\epsilon) \\tag{6.31}\n\\end{equation*}\n$$\n\nwhere $\\epsilon$ is a gain error given by\n\n$$\n\\begin{equation*}\n\\epsilon=\\frac{1}{1+a\\left(\\frac{C_{2}}{C_{1}+C_{2}+C_{P}}\\right)} \\tag{6.32}\n\\end{equation*}\n$$\n\nAs $a \\rightarrow \\infty, \\epsilon \\rightarrow 0$, and the gain of the switched-capacitor amplifier approaches $C_{1} / C_{2}$ as predicted in (6.28). Consequently, the circuit gain is considered parasitic insensitive to an extent that depends on the op-amp gain.\n\nOne essential parameter of the switched-capacitor amplifier shown in Fig. $6.9 a$ is the minimum clock period, divided into two main parts for each clock phase. The duration of $\\phi_{2}$ must be sufficient for the op-amp output to reach and remain within a given level of accuracy, defined as the op-amp settling time and dependent on the switch resistances, circuit capacitances, and op-amp properties. The settling time is typically determined by SPICE simulations, which should be run for both clock phases since the op-amp output voltage during $\\phi_{1}$ is not well controlled in practice. If the op amp is ideal, this output voltage is zero. With nonzero offset voltage, however, the output voltage will be driven to a nonzero value during $\\phi_{1}$ that depends on both the offset voltage and the op-amp gain. If the op-amp gain is large, the offset can easily be large enough to force the output voltage to clip near one of the supplies. The output voltage at the end of $\\phi_{1}$ can be considered an initial condition for the circuit during $\\phi_{2}$. If the initial condition and the desired final output at the end of $\\phi_{2}$ have significantly different values, the time required for the output to reach a given level of accuracy during $\\phi_{2}$ can be increased. Furthermore, nonzero offset can increase the time required for the op-amp output voltage to reach a constant level during $\\phi_{1}$. Although the circuit output voltage defined in (6.30) only appears during $\\phi_{2}$, failure to reach a constant output voltage during $\\phi_{1}$ causes the initial condition defined above to vary, depending on the value of $V_{o}$ at the end of the preceding $\\phi_{2}$. As a result of this memory effect, the circuit can behave as a filter (which is possibly nonlinear), combining the results of more than one previous input sample to determine any given output. The key point is that an increase in the minimum duration of either phase necessitates an increase in the minimum clock period, an effect that should be included in simulation by intentionally simulating with nonzero offset voltages.\n\nOne way to mitigate the impact of nonzero offset voltage on the minimum clock period is to include a reset switch at the op-amp output. If the op amp has a single-ended output as shown in Fig. $6.9 a$, such a switch can be connected between the op-amp output and a bias point between the two supplies. On the other hand, if the op amp has differential outputs as described in Chapter 12, such a reset switch can be connected between the two op-amp outputs. In either case, the reset switch would be activated during $\\phi_{1}$ and deactivated during $\\phi_{2}$. The primary value of such a reset switch is that it can reduce both the maximum output voltage produced by a nonzero offset voltage during $\\phi_{1}$ and the time required to reach this value, thereby reducing the effect of nonzero offset on the minimum durations of both phases.\n\nThe accuracy of the switched-capacitor amplifier shown in Fig. $6.9 a$ is limited by several other factors, which we will briefly discuss. First, even with an ideal op amp, the gain depends on the ratio of capacitors $C_{1} / C_{2}$, which is not controlled perfectly in practice due to random-mismatch effects. Second, op-amp offset limits the minimum signal that can be distinguished from the offset in the switched-capacitor amplifier. As shown in Section 3.5.6, the input-referred offset of CMOS differential pairs is usually worse than for bipolar differential pairs. This property extends to op amps and is partly due to the reduced transconductance-to-current ratio of MOS transistors compared to their bipolar counterparts and partly from the threshold mismatch term, which appears only in the MOS case. Third, the charge-conservation equation and accuracy of the switched-capacitor amplifier are affected by the charge stored under the gates of some of the MOS transistors acting as switches in Fig. $6.9 a$. For example, some of the charge stored under the gate of transistor $M_{3}$ in Fig. $6.9 a$ is injected onto the op-amp input node after $M_{3}$ is turned off. Techniques to overcome these limitations are often employed in practice but are not discussed here.\n\n#### 6.1.7.2 Switched-Capacitor Integrator\n\nAnother application of an internal op amp is the switched-capacitor integrator, illustrated in its simplest form in Fig. $6.10 a$. This circuit is widely utilized as the fundamental element of monolithic switched-capacitor filters for two primary reasons. First, the frequency response of the integrator is insensitive to the various parasitic capacitances present on all nodes in the circuit. Second, using switched-capacitor integrators as the basic elements, the synthesis of desired filter frequency responses is relatively straightforward. In this section, we will analyze the frequency response of the switched-capacitor integrator.\n\nThe integrator comprises an op amp, a sampling capacitor $C_{S}$, an integrating capacitor $C_{I}$, and four MOS transistor switches. The load capacitance depicted represents the sampling capacitor of the following integrator, plus any parasitic capacitances that may be present. Typical values for the sampling, integrating, and load capacitances are labeled in Fig. $6.10 a$.\n\nFigure $6.10 b$ shows the timing diagram of two nonoverlapping clock signals, $\\phi_{1}$ and $\\phi_{2}$, that control the circuit's operation, as well as typical input and output waveforms. During the interval when clock phase $\\phi_{1}$ is high, transistors $M_{1}$ and $M_{3}$ operate in the triode region and charge the sampling capacitor to a voltage equal to the input voltage. Subsequently, clock signal $\\phi_{1}$ falls, and then clock signal $\\phi_{2}$ rises, causing transistors $M_{2}$ and $M_{4}$ to turn on and the sampling capacitor to be connected between the inverting op-amp input (sometimes called the summing node) and ground. If the op amp is ideal, the resulting change in the summing-node voltage causes the op-amp output to adjust so that the summing-node voltage is driven back to ground. After the transient has settled, the voltage across $C_{S}$ is driven to zero.\n\nTo determine the relationship between the input and output, a charge-conservation analysis is employed. After transistor $M_{1}$ opens in Fig. $6.10 a$, the charge on the capacitors connected to node Top and the inverting op-amp input is conserved until $M_{1}$ closes again. Define time points $[n]$ and $[n+1 / 2]$ as the time"
},
{
    "text": "The specifications for operational amplifiers employed within integrated analog circuits differ significantly from those of general-purpose op amps that utilize external feedback networks. In integrated analog circuits, only a limited number of amplifiers need to drive signals off-chip, where the capacitive and resistive loads are substantial and variable. These amplifiers are referred to as output buffers, whereas amplifiers whose outputs remain on-chip are called internal amplifiers. A crucial distinction is that the load driven by an internal amplifier is well-defined and is often purely capacitive, typically in the range of a few picofarads. In contrast, standalone general-purpose amplifiers usually need to be designed to maintain a certain level of performance regardless of changes in capacitive loads up to several hundred picofarads and resistive loads down to $2 \\mathrm{k} \\Omega$ or less.\n\n#### 6.1.7.1 Switched-Capacitor Amplifier\n\nIn MOS technologies, capacitors are frequently employed as passive elements in feedback amplifiers because partly because they are often the most suitable passive elements available. Capacitors can store charge in to analog signals of interest, and MOS transistors can act as switches to connect to the capacitors without offset and with minimal leakage, enabling the discrete-time signal processing of analog quantities. The subject of MOS switched-capacitor amplifiers is an important application of internal amplifiers. Here, we introduce the application to aid explain the construction of MOS op amps.\n\nFigure 6.7 illustrates the schematic of an inverting amplifier with capacitive feedback, in contrast to the resistive feedback shown in Fig. 6.3a. If the op amp is ideal, the gain from a change in the input $\\Delta V_{s}$ to a change in the output $\\Delta V_{o}$ is still given by the ratio of the impedance of the feedback element $C_{2}$ to the impedance of the input element $C_{1}$, or\n\n$$\n\\begin{equation*}\n\\frac{\\Delta V_{o}}{\\Delta V_{s}}=-\\frac{\\frac{1}{\\omega C_{2}}}{\\frac{1}{\\omega C_{1}}}=-\\frac{C_{1}}{C_{2}} \\tag{6.25}\n\\end{equation*}\n$$\n\nHowever, unlike the case when resistors are used as passive elements, this circuit does not provide dc bias for the inverting op-amp input because the impedances of both capacitors are infinite at dc. To address this issue, switches controlled by a two-phase nonoverlapping clock are used to control the operation of the above circuit. The resulting circuit is known as a switched-capacitor amplifier.\n\nFigure $6.8 a$ shows the schematic of a switched-capacitor amplifier. Each switch in the schematic is controlled by one of two clock phases $\\phi_{1}$ and $\\phi_{2}$, and the timing diagram is shown in Fig. 6.8b. We will assume that each switch is closed when its controlling clock signal is high, and open when its clock signal is low. Since $\\phi_{1}$ and $\\phi_{2}$ are never both high at the same time, the switches controlled by one clock phase are never closed at the same time as the switches controlled by the other clock phase. Because of this property, the clock signals in Fig. 6.8b are known as nonoverlapping. For example, the left side of $C_{1}$ is connected to the input $V_{s}$ through switch $S_{1}$ when $\\phi_{1}$ is high and to ground through switch $S_{2}$ when $\\phi_{2}$ is high, but this node is never simultaneously connected to both the input and ground.\n\nTo simplify the description of the operation of switched-capacitor circuits, they are often redrawn twice, once for each nonoverlapping clock phase. Figures $6.8 c$ and $6.8 d$ show the connections when $\\phi_{1}$ is high (during $\\phi_{1}$ ) and when $\\phi_{2}$ is high (during $\\phi_{2}$ ), respectively. Switches that are closed are assumed to be short circuits, and switches that are open are assumed to be open circuits.\n\nTo find the output for a given input, an analysis based on charge conservation is used. After switch $S_{3}$ opens, the charge on the plates of the capacitors that connect to the op-amp input node is conserved until this switch closes again. This property stems partly from the fact that the passive elements connected to the op-amp input node are capacitors, which conduct zero dc current. Also, if the op amp is constructed with an MOS differential input pair, the op-amp input is connected to the gate of one transistor in the differential pair, and the gate conducts zero dc current. Finally, if we assume that switch $S_{3}$ conducts zero current when it is open, the charge stored cannot leak away while $S_{3}$ is open.\n\nSince both sides of $C_{2}$ are grounded in Fig. 6.8c, the charge stored on the plates of the capacitors that connect to the the op-amp input node during $\\phi_{1}$ is\n\n$$\n\\begin{equation*}\nQ_{1}=\\left(0-V_{s}\\right) C_{1}+(0) C_{2}=\\left(0-V_{s}\\right) C_{1} \\tag{6.26}\n\\end{equation*}\n$$\n\nBecause the input voltage is sampled or stored onto capacitor $C_{1}$ during $\\phi_{1}$, this phase is known as the input sample phase. If the op amp is ideal, the voltage $V_{i}$ from the inverting op-amp input to ground is driven to zero by negative feedback during $\\phi_{2}$. Therefore, the charge stored during $\\phi_{2}$ is\n\n$$\n\\begin{equation*}\nQ_{2}=(0) C_{1}+\\left(0-V_{o}\\right) C_{2}=\\left(0-V_{o}\\right) C_{2} \\tag{6.27}\n\\end{equation*}\n$$\n\nBecause the sampled charge appears on $C_{1}$ during $\\phi_{1}$ and on $C_{2}$ during $\\phi_{2}, \\phi_{2}$ is known as the charge-transfer phase. By charge conservation, $Q_{2}=Q_{1}$; therefore,\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}} \\tag{6.28}\n\\end{equation*}\n$$\n\nIn (6.28), $V_{s}$ represents the input voltage at the end of $\\phi_{1}$, and $V_{o}$ represents the output voltage at the end of $\\phi_{2}$. The shape of the output voltage waveform is not predicted by (6.28) and depends on the rates at which the capacitors are charged and discharged. In practice, these rates depend on the bandwidth of the op amp and the resistances of the closed switches. The result in (6.28) is valid as long as the op amp is ideal, the input $V_{s}$ is dc, and the intervals over which $\\phi_{1}$ and $\\phi_{2}$ are high are long enough to completely charge and discharge the associated capacitors. The ratio of $V_{o} / V_{s}$ in (6.28) is positive because if $V_{s}>0$ during $\\phi_{1}$, the voltage applied between the left side of $C_{1}$ and ground decreases from a positive value to zero during $\\phi_{2}$. Therefore, this negative change in the applied voltage during $\\phi_{2}$ is multiplied by a negative closed-loop amplifier gain, giving a positive ratio in (6.28).\n\nMOS technologies are well suited to building switched-capacitor circuits for two key reasons. First, the dc current that flows into the input terminals of MOS op amps is zero as long as the inputs are connected only to the gates of MOS transistors. In contrast, bipolar op amps have nonzero dc input currents that stem from finite $\\beta_{F}$ in bipolar transistors. Second, the switches in Fig. 6.8 can be implemented without offset by using MOS transistors, as shown in Fig. 6.9a. The arrows indicating the source terminals of $M_{1}-M_{5}$ are arbitrarily chosen in the sense that the source and drain terminals are interchangeable. (Since the source is the source of electrons in $n$-channel transistors, the source-to-ground voltage is lower than the drain-to-ground voltage.) Assume that the clock voltages alternate between $-V_{S S}$ and $V_{D D}$ as shown in Fig. 6.9b. Also assume that all node voltages are no lower than $-V_{S S}$ and no higher than $V_{D D}$. Finally, assume that the transistor threshold voltages are positive. Under these conditions, each transistor turns off when its gate is low. Furthermore, each transistor turns on when its gate is high as long as its source operates at least a threshold below $V_{D D}$. If $V_{s}$ is a dc signal, all drain currents approach zero as the capacitors become charged. As the drain currents approach zero, the MOS transistors that are on operate in the triode region, where the drain-source voltage is zero when the drain current is zero. Therefore, the input voltage $V_{s}$ is sampled onto $C_{1}$ with zero offset inserted by the MOS transistors operating as switches. This property of MOS transistors is important in the implementation of switched-capacitor circuits. In contrast, bipolar transistors operating as switches do not give zero collector-emitter voltage with zero collector current.\n\nThe switched-capacitor amplifier shown in Fig. $6.9 a$ is important in practice mainly because the gain of this circuit has little dependence on the various parasitic capacitances that are present on all the nodes in the circuit. These undesired capacitances stem in part from the drain-body and source-body junction capacitances of each transistor. Also, the op-amp input capacitance contributes to the parasitic capacitance on the op-amp input node. Furthermore, as described in Section 2.10.2, the bottom plates of capacitors $C_{1}$ and $C_{2}$ exhibit at least some capacitance to the underlying layer, which is the substrate or a well diffusion. Since the gain of the circuit is determined by charge conservation at the op-amp input node, the presence of parasitic capacitance from any node except the op-amp input to any node with a constant voltage to ground makes no difference to the accuracy of the circuit. (Such parasitics do reduce the maximum clock rate, however.) On the other hand, parasitic capacitance on the op-amp input node does affect the accuracy of the circuit gain, but the error is inversely proportional to the op-amp gain, as we will now show.\n\nLet $C_{P}$ represent the total parasitic capacitance from the op-amp input to all nodes with constant voltage to ground. If the op-amp gain is $a$, the voltage from the inverting op-amp input to ground during $\\phi_{2}$ is given by (6.10). Therefore, with finite op-amp gain, $C_{1}$ and $C_{P}$ are not completely discharged during $\\phi_{2}$. Under these conditions, the charge stored on the op-amp input node during $\\phi_{2}$ becomes\n\n$$\n\\begin{equation*}\nQ_{2}=\\left(-\\frac{V_{o}}{a}\\right) C_{1}+\\left(-\\frac{V_{o}}{a}\\right) C_{P}+\\left(-\\frac{V_{o}}{a}-V_{o}\\right) C_{2} \\tag{6.29}\n\\end{equation*}\n$$\n\nWhen the op-amp gain becomes infinite, (6.29) collapses to (6.27), as expected. Setting $Q_{2}$ in (6.29) equal to $Q_{1}$ in (6.26) by charge conservation gives\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}}\\left[\\frac{1}{1+\\frac{1}{a}\\left(\\frac{C_{1}+C_{2}+C_{P}}{C_{2}}\\right)}\\right] \\tag{6.30}\n\\end{equation*}\n$$\n\nThis closed-loop gain can be written as\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}}(1-\\epsilon) \\tag{6.31}\n\\end{equation*}\n$$\n\nwhere $\\epsilon$ is a gain error given by\n\n$$\n\\begin{equation*}\n\\epsilon=\\frac{1}{1+a\\left(\\frac{C_{2}}{C_{1}+C_{2}+C_{P}}\\right)} \\tag{6.32}\n\\end{equation*}\n$$\n\nAs $a \\rightarrow \\infty, \\epsilon \\rightarrow 0$, and the gain of the switched-capacitor amplifier approaches $C_{1} / C_{2}$ as predicted in (6.28). As a result, the circuit gain is said to be parasitic insensitive to an extent that depends on the op-amp gain.\n\nOne important parameter of the switched-capacitor amplifier shown in Fig. $6.9 a$ is the minimum clock period. This period is divided into two main parts, one for each clock phase. The duration of $\\phi_{2}$ must be long enough for the op-amp output to reach and stay within a given level of accuracy. This time is defined as the op-amp settling time and depends on the switch resistances, the circuit capacitances, and the op-amp properties. The settling time is usually determined by SPICE simulations. Such simulations should be run for both clock phases because the op-amp output voltage during $\\phi_{1}$ is not well controlled in practice. If the op amp is ideal, this output voltage is zero. With nonzero offset voltage, however, the output voltage will be driven to a nonzero value during $\\phi_{1}$ that depends on both the offset voltage and the op-amp gain. If the op-amp gain is large, the offset can easily be large enough to force the output voltage to clip near one of the supplies. The output voltage at the end of $\\phi_{1}$ can be thought of as an initial condition for the circuit during $\\phi_{2}$. If the initial condition and the desired final output at the end of $\\phi_{2}$ happen to have far different values, the time required for the output to reach a given level of accuracy during $\\phi_{2}$ can be increased. Furthermore, nonzero offset can increase the time required for the op-amp output voltage to reach a constant level during $\\phi_{1}$. Although the circuit output voltage defined in (6.30) only appears during $\\phi_{2}$, failure to reach a constant output voltage during $\\phi_{1}$ causes the initial condition defined above to vary, depending on the value of $V_{o}$ at the end of the preceding $\\phi_{2}$. As a result of this memory effect, the circuit can behave as a filter (which is possibly nonlinear), weighting together the results of more than one previous input sample to determine any given output. The key point is that an increase in the minimum duration of either phase requires an increase in the minimum clock period. This effect should be included in simulation by intentionally simulating with nonzero offset voltages.\n\nOne way to reduce the effect of nonzero offset voltage on the minimum clock period is to include a reset switch at the op-amp output. If the op amp has a single-ended output as shown in Fig. 6.9a, such a switch can be connected between the op-amp output and a bias point between the two supplies. On the other hand, if the op amp has differential outputs as described in Chapter 12, such a switch can be connected between the two op-amp outputs. In either case, the reset switch would be turned on during $\\phi_{1}$ and off during $\\phi_{2}$. The main value of such a reset switch is that it can reduce both the maximum output voltage produced by a nonzero offset voltage during $\\phi_{1}$ and the time required to reach this value, in turn reducing the effect of nonzero offset on the minimum durations of both phases.\n\nThe accuracy of the switched-capacitor amplifier shown in Fig. $6.9 a$ is limited by several other factors that we will now consider briefly. First, even with an ideal op amp, the gain depends on the ratio of capacitors $C_{1} / C_{2}$, which is not controlled perfectly in practice because of random-mismatch effects. Second, op-amp offset limits the minimum signal that can be distinguished from the offset in the switched-capacitor amplifier. As shown in Section 3.5.6, the input-referred offset of CMOS differential pairs is usually worse than for bipolar differential pairs. This property extends to op amps and stems partly from the reduced transconductance-to-current ratio of MOS transistors compared to their bipolar counterparts and partly from the threshold mismatch term, which appears only in the MOS case. Third, the charge-conservation equation and accuracy of the switched-capacitor amplifier are affected by the charge stored under the gates of some of the MOS transistors acting as switches in Fig. 6.9a. For example, some of the charge stored under the gate of transistor $M_{3}$ in Fig. $6.9 a$ is injected onto the op-amp input node after $M_{3}$ is turned off. Techniques to overcome these limitations are often used in practice but are not considered here.\n\n#### 6.1.7.2 Switched-Capacitor Integrator\n\nAnother application of an internal op amp, a switched-capacitor integrator, is illustrated in its simplest form in Fig. 6.10a. This circuit is widely utilized as the basic element of monolithic switched-capacitor filters for two main reasons. First, the frequency response of the integrator is insensitive to the various parasitic capacitances that are present on all nodes in the circuit. ${ }^{4,5}$ Second, using switched-capacitor integrators as the basic elements, the synthesis of desired filter frequency responses is relatively straightforward. In this section, we will analyze the frequency response of the switched-capacitor integrator.\n\nThe integrator consists of an op amp, a sampling capacitor $C_{S}$, an integrating capacitor $C_{I}$, and four MOS transistor switches. The load capacitance shown represents the sampling capacitor of the following integrator, plus any parasitic capacitances that may be present. Typical values for the sampling, integrating, and load capacitances are labeled in Fig. 6.10a.\n\nFigure $6.10 b$ shows the timing diagram of two nonoverlapping clock signals"
},
{
    "text": "Operational amplifiers (op amps) utilized within a monolithic analog subsystem are generally required to meet different performance criteria than those used for general-purpose applications with external feedback. In a monolithic analog subsystem, a limited number of amplifiers need to drive signals off-chip where the loads are capacitive and resistive, and they can vary significantly. These amplifiers are referred to as output buffers, while those with outputs not leaving the chip are called internal amplifiers. A key distinction is that internal amplifiers have a well-defined load, often purely capacitive, with values typically in the picofarad range. This is in contrast to general-purpose amplifiers, which are usually designed to deliver a certain performance level that is not affected by capacitive loads up to several hundred picofarads and resistive loads down to $2 \\mathrm{k} \\Omega$ or less.\n\n### Switched-Capacitor Amplifier\n\nIn metal-oxide-semiconductor (MOS) technologies, capacitors are frequently employed as the passive elements in feedback amplifiers, as they are often the best available option. Capacitors can store charge that is proportional to the analog signals of interest, and MOS transistors can serve as switches to connect to these capacitors with minimal offset and leakage, enabling the processing of analog quantities in discrete time. The subject of MOS switched-capacitor amplifiers is a significant application of internal amplifiers, and this section introduces it to help elucidate the construction of MOS op amps.\n\nAn inverting amplifier with capacitive feedback is depicted in Figure 6.7, which is a departure from the resistive feedback shown in Figure 6.3a. The gain of this circuit from a change in the input $\\Delta V_{s}$ to a change in the output $\\Delta V_{o}$, assuming an ideal op amp, is given by the ratio of the impedances of the feedback element $C_{2}$ to the input element $C_{1}$:\n\n$$\n\\frac{\\Delta V_{o}}{\\Delta V_{s}}=-\\frac{C_{1}}{C_{2}}\n$$\n\nHowever, unlike circuits with resistive elements, this configuration lacks dc bias for the inverting op-amp input because the capacitors' impedances are infinite at direct current (dc). To address this issue, a two-phase nonoverlapping clock is used to control the operation of the circuit, resulting in a switched-capacitor amplifier.\n\nThe schematic of a switched-capacitor amplifier is shown in Figure 6.8a, with each switch governed by one of two clock phases $\\phi_{1}$ and $\\phi_{2}$, and the timing diagram is presented in Figure 6.8b. The switches are closed when their respective clock signal is high and open when it is low, with $\\phi_{1}$ and $\\phi_{2}$ never being high simultaneously, ensuring nonoverlapping operation.\n\nFigures 6.8c and 6.8d illustrate the circuit connections during $\\ $\\phi_{1}$ and $\\phi_{2}$, respectively. The operation of switched-capacitor circuits is analyzed\n```\nOperational amplifiers (op amps) within monolithic analog subsystems are typically required to meet different performance criteria compared to general-purpose op amps that use external feedback elements. In a monolithic analog subsystem, a small number of amplifiers need to drive signals off-chip, where the loads are capacitive and resistive and can vary significantly. These amplifiers are referred to as output buffers, while amplifiers whose outputs do not leave the chip are called internal amplifiers. A key distinction is that internal amplifiers have a well-defined load, often purely capacitive, with values typically in the picofarad range. This is in contrast to general-purpose amplifiers, which are usually designed to deliver a certain performance level that is not affected by capacitive loads up to several hundred picofarads and resistive loads down to $2 \\mathrm{k} \\Omega$ or less.\n\n### Switched-Capacitor Amplifier\n\nIn metal-oxide-semiconductor (MOS) technologies, capacitors are frequently used as passive elements in feedback amplifiers, as they are often the best available option. Capacitors can store charge that is proportional to the analog signals of interest, and MOS transistors can serve as switches to connect to these capacitors with minimal offset and leakage, enabling the processing of analog quantities in discrete time. The subject of MOS switched-capacitor amplifiers is a significant application of internal amplifiers, and this section introduces it to help elucidate the construction of MOS op amps.\n\nAn inverting amplifier with capacitive feedback is depicted in Figure 6.7, which is a departure from the resistive feedback shown in Figure 6.3a. The gain of this circuit from a change in the input $\\Delta V_{s}$ to a change in the output $\\Delta V_{o}$, assuming an ideal op amp, is given by the ratio of the impedances of the feedback element $C_{2}$ to the input element $C_{1}$:\n\n$$\n\\frac{\\Delta V_{o}}{\\Delta V_{s}}=-\\frac{C_{1}}{C_{2}}\n$$\n\nHowever, unlike circuits with resistive elements, this configuration lacks dc bias for the inverting op-amp input because the capacitors' impedances are infinite at direct current (dc). To address this issue, a two-phase nonoverlapping clock is used to control the operation of the circuit, resulting in a switched-capacitor amplifier.\n\nThe schematic of a switched-capacitor amplifier is shown in Figure 6.8a, with each switch governed by one of two clock phases $\\phi_{1}$ and $\\phi_{2}$, and the timing diagram is presented in Figure 6.8b. The switches are closed when their respective clock signal is high and open when it is low, with $\\phi_{1}$ and $\\phi_{2}$ never being high simultaneously, ensuring nonoverlapping operation.\n\nFigures 6.8c and 6.8d illustrate the circuit connections during phases $\\phi_{1}$ and $\\phi_{2}$, respectively. The operation of switched-capacitor circuits is"
},
{
    "text": "The operational requirements for op amps within monolithic analog subsystems differ substantially from those of general-purpose op amps that utilize external feedback networks. In a monolithic subsystem, a select few amplifiers are required to drive signals off-chip where there are considerable and variable capacitive and resistive loads. These specific amplifiers are referred to as output buffers, while those whose outputs remain on-chip are called internal amplifiers. A crucial distinction is that internal amplifiers drive a well-defined load, which is usually purely capacitive, valued at a few picofarads. This contrasts with standalone general-purpose amplifiers, which must be designed to maintain performance levels regardless of capacitive load variations up to several hundred picofarads and resistive loads down to $2 \\mathrm{k} \\Omega$ or less.\n\n#### 6.1.7.1 Switched-Capacitor Amplifier\n\nIn MOS technologies, capacitors are frequently employed as the passive elements in feedback amplifiers due to their prevalence and ability to store charge proportional to the analog signals of interest. MOS transistors can act as switches to connect to these capacitors with minimal offset and leakage, facilitating the discrete-time processing of analog signals. An important application of internal amplifiers is in MOS switched-capacitor amplifiers, which we will explore to elucidate the construction of MOS op amps.\n\nFigure 6.7 depicts an inverting amplifier with capacitive feedback, contrasting with the resistive feedback shown in Fig. 6.3a. For an ideal op amp, the gain from input change $\\Delta V_{s}$ to output change $\\Delta V_{o}$ remains the ratio of the impedances of the feedback element $C_{2}$ to the input element $C_{1}$:\n\n$$\n\\begin{equation*}\n\\frac{\\Delta V_{o}}{\\Delta V_{s}}=-\\frac{\\frac{1}{\\omega C_{2}}}{\\frac{1}{\\omega C_{1}}}=-\\frac{C_{1}}{C_{2}} \\tag{6.25}\n\\end{equation*}\n$$\n\nHowever, unlike circuits with resistive elements, this configuration lacks dc bias for the inverting op-amp input due to the capacitors' infinite impedance at dc. This issue is addressed by employing switches controlled by a two-phase nonoverlapping clock to manage the circuit's operation, resulting in a switched-capacitor amplifier.\n\nFigure $6.8 a$ presents the schematic of a switched-capacitor amplifier, where each switch is governed by one of two clock phases $\\phi_{1}$ and $\\phi_{2}$, with the timing diagram depicted in Fig. $6.8 b$. The switches are assumed to close when their respective clock signal is high and open when it is low, ensuring that switches controlled by different clock phases do not close simultaneously. This property characterizes the clock signals as nonoverlapping.\n\nFigures $6.8 c$ and $6.8 d$ illustrate the circuit connections during $\\phi_{1}$ and $\\phi_{2}$, respectively. The operation of switched-capacitor circuits is analyzed using charge conservation principles. After switch $S_{3}$ opens, the charge on the capacitors connected to the op-amp input node is conserved until $S_{3}$ closes again. This is due to the capacitors' zero dc current conduction and the assumption that switch $S_{3}$ conducts zero current when open.\n\nDuring $\\phi_{1}$, the charge stored on the capacitors connected to the op-amp input node is\n\n$$\n\\begin{equation*}\nQ_{1}=\\left(0-V_{s}\\right) C_{1}+(0) C_{2}=\\left(0-V_{s}\\right) C_{1} \\tag{6.26}\n\\end{equation*}\n$$\n\nThis phase is known as the input sample phase. During $\\phi_{2}$, the charge stored is\n\n$$\n\\begin{equation*}\nQ_{2}=(0) C_{1}+\\left(0-V_{o}\\right) C_{2}=\\left(0-V_{o}\\right) C_{2} \\tag{6.27}\n\\end{equation*}\n$$\n\nThis phase is referred as the charge-transfer phase. By charge conservation, $Q_{2}=Q_{1}$, leading to\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}} \\tag{6.28}\n\\end{equation*}\n$$\n\nMOS technologies are particularly adept at constructing switched-capacitor circuits due to the zero dc input current of MOS op amps and the ability to implement switch"
},
{
    "text": "Op amps utilized within monolithic analog subsystems have distinct performance objectives compared to general-purpose op amps that employ external feedback elements. In monolithic analog subsystems, only a limited number of amplifiers need to drive signals off-chip, where the capacitive and resistive loads are substantial and variable. These amplifiers are referred to as output buffers, while those whose outputs remain on-chip are called internal amplifiers. A crucial distinction is that the load driven by an internal amplifier is well defined and often purely capacitive, with a value of a few picofarads. In contrast, standalone general-purpose amplifiers typically need to be designed to achieve a specific performance level that is independent of changes in capacitive loads up to several hundred picofarads and resistive loads down to $2 \\mathrm{k} \\Omega$ or less.\n\nIn MOS technologies, capacitors are frequently used as passive elements in feedback amplifiers due to their availability and ability to store charge proportional to analog signals of interest. MOS transistors can act as switches to connect to the capacitors without offset and with minimal leakage, enabling discrete-time signal processing of analog quantities. MOS switched-capacitor amplifiers are an important application of internal amplifiers, and we introduce this application to help explain the construction of MOS op amps.\n\nThe gain from a change in the input $\\Delta V_{s}$ to a change in the output $\\Delta V_{o}$ in an inverting amplifier with capacitive feedback is given by the ratio of the impedance of the feedback element $C_{2}$ to the impedance of the input element $C_{1}$:\n\n$$\n\\frac{\\Delta V_{o}}{\\Delta V_{s}}=-\\frac{C_{1}}{C_{2}}\n$$\n\nHowever, unlike when resistors are used as passive elements, this circuit does not provide dc bias for the inverting op-amp input due to the infinite impedance of the capacitors at dc. To address this issue, switches controlled by a two-phase nonoverlapping clock are employed to control the operation of the circuit, resulting in a switched-capacitor amplifier.\n\nA switched-capacitor amplifier utilizes capacitors instead of resistors as passive elements in feedback amplifiers, leveraging the ability of capacitors to store charge proportional to analog signals and the capability of MOS transistors to act as switches with minimal offset and leakage. The gain of a switched-capacitor amplifier is determined by charge conservation at the op-amp input node, making it insensitive to parasitic capacitance on nodes with constant voltage to ground. However, parasitic capacitance on the op-amp input node does affect the accuracy of the circuit gain, but the error is inversely proportional to the op-amp gain.\n\nSwitched-capacitor amplifiers and integrators are ideally suited for op amps with MOS transistors in the input stage due to their extremely small dc currents at the input terminals, minimizing charge loss and ensuring accurate operation."
},
{
    "text": "The specified performance goals for operational amplifiers intended for use in a monolithic analog subsystem frequently contrast with those for general-purpose amplifiers that incorporate external feedback components. Within a monolithic analog subsystem, merely a select number of amplifiers are required to propagate a signal off the integrated circuit, where the load is capacitively and resistively loaded, and subject to change. These amplifiers are referred to as output buffers, while the amplifiers whose signals remain within the chip are designated as internal amplifiers. The most significant distinction lies in the definition of the load that an internal amplifier must manage. This load is distinctly specified and is typically capacitively loaded with a value ranging from a few picofarads. In contrast, standalone general-purpose amplifiers typically necessitate a design that attains a certain performance level, which is independent of variations in capacitance up to several hundred picofarads and resistive loads as low as 2 kiloohms.\n\n#### 6.1.7.1 Switched-Capacitor Amplifier\n\nIn MOS technologies, capacitors, rather than resistors, are frequently chosen as passive elements in feedback amplifiers, in part because capacitors are often the most suitable available passive components. Furthermore, capacitors can hold a charge that is proportional to the analog signals of interest, and MOS transistors can serve as switches to interface with the capacitors without offset and with minimal leakage, thereby enabling the discrete-time processing of analog signals. The application of MOS switched-capacitor amplifiers is a notable instance of the use of internal amplifiers. This application is introduced to elucidate the construction of MOS operational amplifiers.\n\nFigure 6.7 illustrates the circuit diagram of an inverting amplifier equipped with capacitive feedback, as opposed to the resistive feedback presented in Figure 6.3a. In the event that the operational amplifier is ideal, the gain ratio between the input voltage change (ΔVs) and the output voltage change (ΔVo) is still expressed as the ratio of the feedback capacitor's impedance (C2) to the input capacitor's impedance (C1), or\n\n$$\n\\begin{equation*}\n\\frac{\\Delta V_{o}}{\\Delta V_{s}}=-\\frac{\\frac{1}{\\omega C_{2}}}{\\frac{1}{\\omega C_{1}}}=-\\frac{C_{1}}{C_{2}} \\tag{6.25}\n\\end{equation*}\n$$\n\nNonetheless, unlike the case where resistors are utilized as passive elements, this circuit does not supply a DC bias for the inverting operational amplifier's input due to the capacitors' infinite impedance at DC. To address this issue, switches controlled by a two-phase nonoverlapping clock are used to regulate the operation of the circuit. The resulting circuit is known as a switched-capacitor amplifier.\n\nFigure 6.8a depicts the circuit diagram of a switched-capacitor amplifier. Each switch within the diagram is actuated by one of the two clock phases, φ1 and φ2, and the timing diagram is depicted in Figure 6.8b. It is assumed that a switch closes when its respective clock signal is high and opens when the clock signal is low. As φ1 and φ2 are never simultaneously high, the switches controlled by one clock phase never close concurrently with the switches controlled by the other clock phase. Due to this characteristic, the clock signals in Figure 6.8b are termed nonoverlapping. For example, the left side of C1 is connected to the input voltage, Vs, through switch S1 when φ1 is high and to ground through switch S2 when φ2 is high, but this node is never simultaneously connected to both the input and ground.\n\nTo streamline the explanation of the operation of switched-capacitor circuits, they are often redrawn twice, once for each nonoverlapping clock phase. Figures 6.8c and 6.8d show the connections during φ1 and φ2, respectively. Switches that are closed are considered to be short circuits, and switches that are open are considered to be open circuits.\n\nTo determine the output for a given input, an analysis based on charge conservation is employed. Following the opening of switch S3, the charge on the capacitors linked to the operational amplifier's input node is conserved until this switch closes again. This principle is partly due to the fact that the passive components connected to the operational amplifier's input node are capacitors, which conduct no DC current. Furthermore, if the operational amplifier is constructed using an MOS differential input pair, the operational amplifier's input is connected to the gate of one transistor within the differential pair, and the gate conducts no DC current. Finally, assuming that switch S3 conducts no current when it is open, the charge stored cannot leak away while S3 is open.\n\nSince both sides of C2 are grounded in Figure 6.8c, the charge stored on the capacitors linked to the operational amplifier's input node during φ1 is\n\n$$\n\\begin{equation*}\nQ_{1}=\\left(0-V_{s}\\right) C_{1}+(0) C_{2}=\\left(0-V_{s}\\right) C_{1} \\tag{6.26}\n\\end{equation*}\n$$\n\nBecause the input voltage is sampled or stored onto capacitor C1 during φ1, this phase is referred to as the input sample phase. If the operational amplifier is ideal, the voltage Vi from the inverting operational amplifier input to ground is driven to zero by negative feedback during φ2. Consequently, the charge stored during φ2 is\n\n$$\n\\begin{equation*}\nQ_{2}=(0) C_{1}+\\left(0-V_{o}\\right) C_{2}=\\left(0-V_{o}\\right) C_{2} \\tag{6.27}\n\\end{equation*}\n$$\n\nSince the sampled charge is present on C1 during φ1 and on C2 during φ2, φ2 is known as the charge-transfer phase. By the principle of charge conservation, Q2 = Q1; therefore,\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}} \\tag{6.28}\n\\end{equation*}\n$$\n\nIn (6.28), Vs represents the input voltage at the end of φ1, and Vo represents the output voltage at the end of φ2. The waveform shape of the output voltage is not predicted by (6.28) and depends on the rates at which the capacitors are charged and discharged. In practice, these rates depend on the bandwidth of the operational amplifier and the resistances of the closed switches. The result in (6.28) is valid as long as the operational amplifier is ideal, the input Vs is DC, and the intervals over which φ1 and φ2 are high are sufficient to completely charge and discharge the associated capacitors. The ratio of Vo/Vs in (6.28) is positive because if Vs > 0 during φ1, the voltage applied between the left side of C1 and ground decreases from a positive value to zero during φ2. Therefore, this negative change in the applied voltage during φ2 is multiplied by a negative closed-loop amplifier gain, resulting in a positive ratio in (6.28).\n\nMOS technologies are well-suited for constructing switched-capacitor circuits for two primary reasons. First, the DC current that flows into the input terminals of MOS operational amplifiers is zero as long as the inputs are connected solely to the gates of MOS transistors. In contrast, bipolar operational amplifiers have nonzero DC input currents due to the finite βF of bipolar transistors. Second, the switches in Figure 6.8 can be implemented without offset by utilizing MOS transistors, as shown in Figure 6.9a. The arrows indicating the source terminals of M1-M5 are arbitrarily chosen in the sense that the source and drain terminals are interchangeable. (Since the source is the source of electrons in n-channel transistors, the source-to-ground voltage is lower than the drain-to-ground voltage.) Assume that the clock voltages alternate between -VSS and VDD as depicted in Figure 6.9b. Also, assume that all node voltages are no lower than -VSS and no higher than VDD. Furthermore, assume that the transistor threshold voltages are positive. Under these conditions, each transistor turns off when its gate is low. Additionally, each transistor turns on when its gate is high as long as its source operates at least a threshold below VDD. If Vs is a DC signal, all drain currents approach zero as the capacitors become charged. As the drain currents approach zero, the MOS transistors that are on operate in the triode region, where the drain-source voltage is zero when the drain current is zero. Therefore, the input voltage Vs is sampled onto C1 with zero offset inserted by the MOS transistors operating as switches. This property of MOS transistors is crucial in the implementation of switched-capacitor circuits. Conversely, bipolar transistors acting as switches do not provide zero collector-emitter voltage with zero collector current.\n\nThe switched-capacitor amplifier depicted in Figure 6.9a is significant in practice mainly because the gain of this circuit is minimally influenced by the various parasitic capacitances that are present at all nodes in the circuit. These unwanted capacitances originate partly from the drain-body and source-body junction capacitances of each transistor. Additionally, the operational amplifier's input capacitance contributes to the parasitic capacitance on the operational amplifier's input node. Moreover, as described in Section 2.10.2, the bottom plates of capacitors C1 and C2 exhibit at least some capacitance to the underlying layer, which is the substrate or a well diffusion. Since the gain of the circuit is determined by charge conservation at the operational amplifier's input node, the presence of parasitic capacitance from any node except the operational amplifier's input to any node with a constant voltage to ground makes no difference to the accuracy of the circuit. (Such parasitics do reduce the maximum clock rate, however.) On the other hand, parasitic capacitance on the operational amplifier's input node does affect the accuracy of the circuit gain, but the error is inversely proportional to the operational amplifier gain, as we will demonstrate.\n\nLet CP represent the total parasitic capacitance from the operational amplifier's input to all nodes with a constant voltage to ground. If the operational amplifier's gain is a, the voltage from the inverting operational amplifier input to ground during φ2 is given by (6.10). Consequently, with a finite operational amplifier gain, C1 and CP are not completely discharged during φ2. Under these conditions, the charge stored on the operational amplifier's input node during φ2 becomes\n\n$$\n\\begin{equation*}\nQ_{2}=\\left(-\\frac{V_{o}}{a}\\right) C_{1}+\\left(-\\frac{V_{o}}{a}\\right) CP+\\left(-\\frac{V_{o}}{a}-V_{o}\\right) C_{2} \\tag{6.29}\n\\end{equation*}\n$$\n\nWhen the operational amplifier's gain becomes infinite, (6.29) collapses to (6.27), as expected. Setting Q2 in (6.29) equal to Q1 in (6.26) by the principle of charge conservation yields\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}}\\left[\\frac{1}{1+\\frac{1}{a}\\left(\\frac{C_{1}+C_{2}+CP}{C_{2}}\\right)}\\right] \\tag{6.30}\n\\end{equation*}\n$$\n\nThis closed-loop gain can be expressed as\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}}(1-\\epsilon) \\tag{6.31}\n\\end{equation*}\n$$\n\nwhere ε is a gain error given by\n\n$$\n\\begin{equation*}\n\\epsilon=\\frac{1}{1+a\\left(\\frac{C_{2}}{C_{1}+C_{2}+CP}\\right)} \\tag{6.32}\n\\end{equation*}\n$$\n\nAs a → ∞, ε → 0, and the gain of the switched-capacitor amplifier approaches C1/C2 as predicted in (6.28). As a result, the circuit gain is considered to be parasitic insensitive to an extent that depends on the operational amplifier gain.\n\nA crucial parameter of the switched-capacitor amplifier depicted in Figure 6.9a is the minimum clock period. This period is divided into two primary parts, corresponding to each clock phase. The duration of φ2 must be sufficient to enable the operational amplifier's output to reach and remain at a specific level of accuracy. This time is defined as the operational amplifier's settling time and depends on the switch resistances, the circuit capacitances, and the operational amplifier's properties. The settling time is typically determined by SPICE simulations. These simulations should be conducted for both clock phases because the operational amplifier's output voltage during φ1 is not well-controlled in practice. If the operational amplifier is ideal, this output voltage is zero. With nonzero offset voltage, however, the output voltage will be driven to a nonzero value during φ1 that depends on both the offset voltage and the operational amplifier gain. If the operational amplifier gain is high, the offset can easily become large enough to cause the output voltage to clip near one of the supplies. The output voltage at the end of φ1 can be thought of as an initial condition for the circuit during φ2. If the initial condition and the desired final output at the end of φ2 differ significantly, the time required for the output to reach a specified level of accuracy during φ2 can be increased. Furthermore, nonzero offset can increase the time required for the operational amplifier's output voltage to reach a constant level during φ1. Although the circuit's output voltage defined in (6.30) only appears during φ2, the inability to reach a constant output voltage during φ1 results in an initial condition defined above that varies, depending on the value of Vo at the end of the preceding φ2. As a result of this memory effect, the circuit can behave as a filter (which may be nonlinear), weighting the results of more than one previous input sample to determine any given output. The key point is that an increase in the minimum duration of either phase necessitates an increase in the minimum clock period. This effect should be accounted for in simulations by intentionally simulating with nonzero offset voltages.\n\nOne approach to reducing the impact of nonzero offset voltage on the minimum clock period is to include a reset switch at the operational amplifier's output. If the operational amplifier has a single-ended output as shown in Figure 6.9a, such a switch can be connected between the operational amplifier's output and a bias point between the two supplies. Alternatively, if the operational amplifier has differential outputs as described in Chapter 12, such a reset switch can be connected between the two operational amplifier outputs. In either case, the reset switch would be activated during φ1 and deactivated during φ2. The primary benefit of such a reset switch is that it can reduce both the maximum output voltage produced by a nonzero offset voltage during φ1 and the time required to reach this value, thereby reducing the effect of nonzero offset on the minimum durations of both phases.\n\nThe accuracy of the switched-capacitor amplifier depicted in Figure 6.9a is limited by several other factors, which we will briefly consider. First, even with an ideal operational amplifier, the gain depends on the ratio of capacitors C1/C2, which is not perfectly controlled in practice due to random-mismatch effects. Second, operational amplifier offset limits the smallest signal that can be distinguished from the offset in the switched-capacitor amplifier. As shown in Section 3.5.6, the input-referred offset of CMOS differential pairs is typically worse than for bipolar differential pairs. This property extends to operational amplifiers and partly stems from the reduced transconductance-to-current ratio of MOS transistors compared to their bipolar counterparts and partly from the threshold mismatch term, which appears only in the MOS case. Third, the charge-conservation equation and accuracy of the switched-capacitor amplifier are affected by the charge stored under the gates of some of the MOS transistors acting as switches in Figure 6.9a. For example, some of the charge stored under the gate of transistor M3 in Figure 6.9a is injected onto the operational amplifier's input node after M3 is turned off. Techniques to overcome these limitations are often utilized in practice but are not discussed here.\n\n#### 6.1.7.2 Switched-Capacitor Integrator\n\nAnother application of an internal operational amplifier, the switched-capacitor integrator, is illustrated in its simplest form in Figure 6.10a. This circuit is extensively employed as the fundamental component of monolithic switched-capacitor filters for two primary reasons. First, the integrator's frequency response is insensitive to the various parasitic capacitances that are present at all nodes in the circuit. Second, utilizing switched-capacitor integrators as fundamental elements simplifies the synthesis of desired filter frequency responses. In this section, we will analyze the frequency response of the switched-capacitor integrator.\n\nThe integrator comprises an operational amplifier, a sampling capacitor CS, an integrating capacitor CI, and four MOS transistor switches. The load capacitance shown represents the sampling capacitor of the subsequent integrator, plus any parasitic capacitances that may be present. Typical values for the sampling, integrating, and load capacitances are labeled in Figure 6.10a.\n\nFigure 6.10b shows the timing diagram of two nonoverlapping clock signals, φ1 and φ2, that control the circuit's operation as well as typical input and output waveforms. During the period when clock phase φ1 is high, transistors M1 and M3 operate in the triode region and are responsible for charging the sampling capacitor to a voltage equal to the input voltage. Subsequently, clock signal φ1 falls. Then clock signal φ2 rises, causing transistors M2 and M4 to turn on and connect the sampling capacitor between the inverting operational amplifier input, also known as the summing node, and ground. If the operational amplifier is ideal, the resulting\n\nimage_name:(a)\ndescription:\n[\nname: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\nname: R, type: Resistor, value: 1/fCs, ports: {N1: Vs, N2: InN(A0)}\nname: CI, type: Capacitor, value: CI, ports: {Np: InN(A0), Nn: Vo}\nname: Ao, type: OpAmp, value: Ao, ports: {InP: GND, InN: InN(A0), Out: Vo}\n]\nextrainfo:This is a switched-capacitor integrator circuit. The circuit integrates the input voltage Vs over time and produces an output voltage Vo. The timing diagram illustrates the integration process, showing how Vo accumulates the effect of Vs. The operational amplifier Ao stabilizes the summing-node voltage to ground after transients. The resistor R is defined by the equation"
},
{
    "text": "The objectives for operational amplifiers (op-amps) intended for use within integrated analog circuits can significantly vary from those of general-purpose op-amps that rely on external feedback components. Within an integrated analog circuit, a select number of amplifiers are responsible for driving signals outside the chip, where the capacitive and resistive loads are substantial and subject to change. These amplifiers are designated as output buffers, while those whose outputs remain within the chip are referred to as internal amplifiers. A crucial distinction lies in the nature of the load that internal amplifiers must manage, which is clearly defined and typically consists of a small, purely capacitive value in the picofarad range. Conversely, standalone, general-purpose op-amps are generally designed to achieve a level of performance that remains consistent regardless of variations in capacitive loads ranging up to several hundred picofarads and resistive loads as low as 2 kiloohms.\n\n#### 6.1.7.1 Switched-Capacitor Amplifier\n\nWithin MOS fabrication technologies, capacitors often replace resistors as passive components in feedback amplifiers, in part because capacitors are often the finest available passive elements. Additionally, capacitors can store an amount of charge directly proportional to the magnitude of the analog signals of interest, and MOS transistors can act as switches to connect to the capacitors without introducing offset and with minimal leakage, facilitating the discrete-time processing of analog signals. The application of internal amplifiers within the domain of MOS switched-capacitor amplifiers is a significant illustration. Here, we introduce the application to elucidate the structure of MOS operational amplifiers.\n\nFigure 6.7 illustrates the circuit diagram of an inverting amplifier with capacitive feedback, as opposed to the resistive feedback depicted in Figure 6.3a. Assuming an ideal operational amplifier, the gain resulting from a change in input voltage (\\(\\Delta V_s\\)) to a change in output voltage (\\(\\Delta V_o\\)) is still determined by the ratio of the impedance of the feedback capacitor \\(C_2\\) to the impedance of the input capacitor \\(C_1\\), or\n\n$$\n\\begin{equation*}\n\\frac{\\Delta V_{o}}{\\Delta V_{s}}=-\\frac{\\frac{1}{\\omega C_{2}}}{\\frac{1}{\\omega C_{1}}}=-\\frac{C_{1}}{C_{2}} \\tag{6.25}\n\\end{equation*}\n$$\n\nHowever, unlike when resistors are used as passive elements, this circuit does not provide a direct current bias for the inverting operational amplifier input since both capacitors exhibit infinite impedance at dc. To address this issue, switches controlled by a two-phase non-overlapping clock are utilized to regulate the operation of the circuit. The resulting circuit is known as a switched-capacitor amplifier.\n\nFigure 6.8a presents the circuit diagram of a switched-capacitor amplifier. Each switch within the diagram is controlled by one of two clock phases \\(\\phi_{1}\\) and \\(\\phi_{2}\\), and the timing diagram is shown in Figure 6.8b. We will assume that each switch closes when its corresponding clock signal is high and opens when the clock signal is low. Since \\(\\phi_{1}\\) and \\(\\phi_{2}\\) are never simultaneously high, the switches controlled by one clock phase are never closed simultaneously with those controlled by the other clock phase. Due to this characteristic, the clock signals in Figure 6.8b are called non-overlapping. For instance, the left side of \\(C_{1}\\) is connected to the input \\(V_{s}\\) through switch \\(S_{1}\\) when \\(\\phi_{1}\\) is high and to ground through switch \\(S_{2}\\) when \\(\\phi_{2}\\) is high, but this node is never simultaneously connected to both the input and ground.\n\nTo simplify the description of the operation of switched-capacitor circuits, they are commonly redrawn twice, once for each non-overlapping clock phase. Figures 6.8c and 6.8d illustrate the connections when \\(\\phi_{1}\\) is high (during \\(\\phi_{1}\\)) and when \\(\\phi_{2}\\) is high (during \\(\\phi_{2}\\)), respectively. Switches that are closed are assumed to be short circuits, and switches that are open are assumed to be open circuits.\n\nTo determine the output voltage for a given input voltage, an analysis based on charge conservation is employed. After switch \\(S_{3}\\) opens, the charge on the plates of the capacitors connected to the operational amplifier input node is conserved until this switch closes again. This principle is partly due to the fact that the passive elements connected to the operational amplifier input node are capacitors, which conduct no direct current at dc. Additionally, if the operational amplifier is constructed with an MOS differential input pair, the operational amplifier input is connected to the gate of one transistor in the differential pair, and the gate conducts no direct current. Lastly, if we assume that switch \\(S_{3}\\) conducts no current when it is open, the charge stored cannot leak away while \\(S_{3}\\) is open.\n\nSince both sides of \\(C_{2}\\) are grounded in Figure 6.8c, the charge stored on the plates of the capacitors connected to the operational amplifier input node during \\(\\phi_{1}\\) is\n\n$$\n\\begin{equation*}\nQ_{1}=\\left(0-V_{s}\\right) C_{1}+(0) C_{2}=\\left(0-V_{s}\\right) C_{1} \\tag{6.26}\n\\end{equation*}\n$$\n\nBecause the input voltage is sampled or stored onto capacitor \\(C_{1}\\) during \\(\\phi_{1}\\), this phase is known as the input sample phase. If the operational amplifier is ideal, the voltage \\(V_{i}\\) from the inverting operational amplifier input to ground is driven to zero by negative feedback during \\(\\phi_{2}\\). Therefore, the charge stored during \\(\\phi_{2}\\) is\n\n$$\n\\begin{equation*}\nQ_{2}=(0) C_{1}+\\left(0-V_{o}\\right) C_{2}=\\left(0-V_{o}\\right) C_{2} \\tag{6.27}\n\\end{equation*}\n$$\n\nBecause the sampled charge appears on \\(C_{1}\\) during \\(\\phi_{1}\\) and on \\(C_{2}\\) during \\(\\phi_{2}, \\phi_{2}\\) is referred to as the charge-transfer phase. By charge conservation, \\(Q_{2}=Q_{1}\\); hence,\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}} \\tag{6.28}\n\\end{equation*}\n$$\n\nIn (6.28), \\(V_{s}\\) represents the input voltage at the conclusion of \\(\\phi_{1}\\), and \\(V_{o}\\) represents the output voltage at the conclusion of \\(\\phi_{2}\\). The shape of the output voltage waveform is not predicted by (6.28) and depends on the rates at which the capacitors are charged and discharged. In practice, these rates are influenced by the bandwidth of the operational amplifier and the resistances of the closed switches. The result in (6.28) is valid as long as the operational amplifier is ideal, the input \\(V_{s}\\) is dc, and the intervals over which \\(\\phi_{1}\\) and \\(\\phi_{2}\\) are high are sufficiently long to completely charge and discharge the associated capacitors. The ratio of \\(V_{o} / V_{s}\\) in (6.28) is positive because if \\(V_{s}>0\\) during \\(\\phi_{1}\\), the voltage applied between the left side of \\(C_{1}\\) and ground decreases from a positive value to zero during \\(\\phi_{2}\\). Thus, this negative change in the applied voltage during \\(\\phi_{2}\\) is multiplied by a negative closed-loop amplifier gain, yielding a positive ratio in (6.28).\n\nMOS technologies are particularly suitable for constructing switched-capacitor circuits for two primary reasons. First, the direct current that flows into the input terminals of MOS operational amplifiers is zero as long as the inputs are connected only to the gates of MOS transistors. In contrast, bipolar operational amplifiers have non-zero direct current input currents that arise from the finite \\(\\beta_{F}\\) of bipolar transistors. Second, the switches in Figure 6.8 can be implemented without offset by utilizing MOS transistors, as depicted in Figure 6.9a. The arrows indicating the source terminals of \\(M_{1}-M_{5}\\) are arbitrarily chosen in the sense that the source and drain terminals are interchangeable. (Since the source is the source of electrons in \\(n\\)-channel transistors, the source-to-ground voltage is lower than the drain-to-ground voltage.) Assume that the clock voltages alternate between \\(-V_{S S}\\) and \\(V_{D D}\\) as shown in Figure 6.9b. Also assume that all node voltages are no lower than \\(-V_{S S}\\) and no higher than \\(V_{D D}\\). Furthermore, assume that the transistor threshold voltages are positive. Under these conditions, each transistor turns off when its gate is low. Furthermore, each transistor turns on when its gate is high as long as its source operates at least a threshold below \\(V_{D D}\\). If \\(V_{s}\\) is a dc signal, all drain currents approach zero as the capacitors become charged. As the drain currents approach zero, the MOS transistors that are on operate in the triode region, where the drain-source voltage is zero when the drain current is zero. Therefore, the input voltage \\(V_{s}\\) is sampled onto \\(C_{1}\\) with zero offset inserted by the MOS transistors operating as switches. This property of MOS transistors is important in the implementation of switched-capacitor circuits. In contrast, bipolar transistors operating as switches do not yield zero collector-emitter voltage with zero collector current.\n\nThe switched-capacitor amplifier illustrated in Figure 6.9a is important in practice mainly because the gain of this circuit has minimal dependence on the various parasitic capacitances that are present at all nodes within the circuit. These unwanted capacitances originate in part from the drain-body and source-body junction capacitances of each transistor. Additionally, the operational amplifier input capacitance contributes to the parasitic capacitance at the operational amplifier input node. Furthermore, as described in Section 2.10.2, the bottom plates of capacitors \\(C_{1}\\) and \\(C_{2}\\) exhibit at least some capacitance to the underlying layer, which is the substrate or a well diffusion. Since the gain of the circuit is determined by charge conservation at the operational amplifier input node, the presence of parasitic capacitance from any node except the operational amplifier input to any node with a constant voltage to ground makes no difference to the accuracy of the circuit. (Such parasitics do reduce the maximum clock rate, however.) On the other hand, parasitic capacitance at the operational amplifier input node does affect the accuracy of the circuit gain, but the error is inversely proportional to the operational amplifier gain, as we will demonstrate.\n\nLet \\(C_{P}\\) represent the total parasitic capacitance from the operational amplifier input to all nodes with a constant voltage to ground. If the operational amplifier gain is \\(a\\), the voltage from the inverting operational amplifier input to ground during \\(\\phi_{2}\\) is given by (6.10). Therefore, with finite operational amplifier gain, \\(C_{1}\\) and \\(C_{P}\\) are not completely discharged during \\(\\phi_{2}\\). Under these conditions, the charge stored on the operational amplifier input node during \\(\\phi_{2}\\) becomes\n\n$$\n\\begin{equation*}\nQ_{2}=\\left(-\\frac{V_{o}}{a}\\right) C_{1}+\\left(-\\frac{V_{o}}{a}\\right) C_{P}+\\left(-\\frac{V_{o}}{a}-V_{o}\\right) C_{2} \\tag{6.29}\n\\end{equation*}\n$$\n\nWhen the operational amplifier gain becomes infinite, (6.29) collapses to (6.27), as expected. Setting \\(Q_{2}\\) in (6.29) equal to \\(Q_{1}\\) in (6.26) by charge conservation gives\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}}\\left[\\frac{1}{1+\\frac{1}{a}\\left(\\frac{C_{1}+C_{2}+C_{P}}{C_{2}}\\right)}\\right] \\tag{6.30}\n\\end{equation*}\n$$\n\nThis closed-loop gain can be expressed as\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}}(1-\\epsilon) \\tag{6.31}\n\\end{equation*}\n$$\n\nwhere \\(\\epsilon\\) is a gain error given by\n\n$$\n\\begin{equation*}\n\\epsilon=\\frac{1}{1+a\\left(\\frac{C_{2}}{C_{1}+C_{2}+C_{P}}\\right)} \\tag{6.32}\n\\end{equation*}\n$$\n\nAs \\(a \\rightarrow \\infty, \\epsilon \\rightarrow 0\\), and the gain of the switched-capacitor amplifier approaches \\(C_{1} / C_{2}\\) as predicted in (6.28). Consequently, the circuit gain is said to be parasitic insensitive to an extent that depends on the operational amplifier gain.\n\nOne important parameter of the switched-capacitor amplifier depicted in Figure 6.9a is the minimum clock period. This period is divided into two main parts, one for each clock phase. The duration of \\(\\phi_{2}\\) must be long enough for the operational amplifier output to reach and maintain a specified level of accuracy. This time is defined as the operational amplifier settling time and depends on the switch resistances, the circuit capacitances, and the operational amplifier properties. The settling time is typically determined by SPICE simulations. Such simulations should be conducted for both clock phases because the operational amplifier output voltage during \\(\\phi_{1}\\) is not well controlled in practice. If the operational amplifier is ideal, this output voltage is zero. With a non-zero offset voltage, however, the output voltage will be driven to a non-zero value during \\(\\phi_{1}\\) that depends on both the offset voltage and the operational amplifier gain. If the operational amplifier gain is large, the offset can be large enough to force the output voltage to clip near one of the supplies. The output voltage at the end of \\(\\phi_{1}\\) can be considered as an initial condition for the circuit during \\(\\phi_{2}\\). If the initial condition and the desired final output at the end of \\(\\phi_{2}\\) differ significantly, the time required for the output to reach a given level of accuracy during \\(\\phi_{2}\\) can be prolonged. Furthermore, a non-zero offset can increase the time required for the operational amplifier output voltage to reach a constant level during \\(\\phi_{1}\\). Although the circuit output voltage defined in (6.30) only appears during \\(\\phi_{2}\\), failure\nto reach a constant output voltage during \\(\\phi_{1}\\) causes the initial condition defined above to vary, depending on the value of \\(V_{o}\\) at the end of the preceding \\(\\phi_{2}\\). As a result of this memory effect, the circuit can behave as a filter (which may be nonlinear), combining the results of more than one previous input sample to determine any given output. The key point is that an increase in the minimum duration of either phase necessitates an increase in the minimum clock period. This effect should be included in simulation by intentionally simulating with non-zero offset voltages.\n\nOne method to reduce the impact of non-zero offset voltage on the minimum clock period is to incorporate a reset switch at the operational amplifier output. If the operational amplifier has a single-ended output as shown in Figure 6.9a, such a switch can be connected between the operational amplifier output and a bias point between the two supplies. On the other hand, if the operational amplifier has differential outputs as described in Chapter 12, such a reset switch can be connected between the two operational amplifier outputs. In either case, the reset switch would be turned on during \\(\\phi_{1}\\) and off during \\(\\phi_{2}\\). The primary advantage of such a reset switch is that it can decrease both the maximum output voltage produced by a non-zero offset voltage during \\(\\phi_{1}\\) and the time required to reach this value, thereby reducing the effect of non-zero offset on the minimum durations of both phases.\n\nThe accuracy of the switched-capacitor amplifier depicted in Figure 6.9a is limited by several other factors that we will briefly discuss now. First, even with an ideal operational amplifier, the gain depends on the ratio of capacitors \\(C_{1} / C_{2}\\), which is not perfectly controlled in practice due to random mismatch effects. Second, operational amplifier offset limits the smallest signal that can be distinguished from the offset in the switched-capacitor amplifier. As shown in Section 3.5.6, the input-referred offset of CMOS differential pairs is typically worse than for bipolar differential pairs. This characteristic extends to operational amplifiers and stems partly from the reduced transconductance-to-current ratio of MOS transistors compared to their bipolar counterparts and partly from the threshold mismatch term, which appears only in the MOS case. Third, the charge-conservation equation and accuracy of the switched-capacitor amplifier are affected by the charge stored under the gates of some of the MOS transistors acting as switches in Figure 6.9a. For example, some of the charge stored under the gate of transistor \\(M_{3}\\) in Figure 6.9a is injected onto the operational amplifier input node after \\(M_{3}\\) is turned off. Techniques to overcome these limitations are often used in practice but are not detailed here.\n\n#### 6.1.7.2 Switched-Capacitor Integrator\n\nAnother application of internal operational amplifiers, the switched-capacitor integrator, is depicted in its simplest form in Figure 6.10a. This circuit is extensively used as the fundamental element of monolithic switched-capacitor filters for two main reasons. First, the frequency response of the integrator is unaffected by the various parasitic capacitances that are present on all nodes within the circuit. Second, utilizing switched-capacitor integrators as basic elements makes the synthesis of desired filter frequency responses relatively straightforward. In this section, we will analyze the frequency response of the switched-capacitor integrator.\n\nThe integrator includes an operational amplifier, a sampling capacitor \\(C_{S}\\), an integrating capacitor \\(C_{I}\\"
},
{
    "text": "The specified objectives for operational amplifiers intended for use within integrated analog systems are typically distinct from those of general-purpose amplifiers that rely on external feedback mechanisms. Within an integrated analog system, a limited number of amplifiers are required to deliver signals off the chip, where capacitive and resistive loads are substantial and variable. These amplifiers are referred to as output buffers, while those whose outputs remain on-chip are designated as internal amplifiers. A pivotal distinction is that the load an internal amplifier must address is distinctly defined and is frequently purely capacitive, with a value in the order of a few picofarads. Conversely, standalone general-purpose amplifiers typically need to be designed to achieve a specific performance level that remains consistent despite changes in capacitive loads up to several hundred picofarads and resistive loads down to 2 kilohms or less.\n\n#### 6.1.7.1 Switched-Capacitor Amplifier\n\nIn MOS-based technologies, capacitors, rather than resistors, are commonly used as passive components in feedback amplifiers. This is due in part to the fact that capacitors are often the most suitable available passive components. Moreover, capacitors can hold charge proportional to the amplitude of the analog signals of interest, and MOS transistors can function as switches to connect to these capacitors without introducing offset and with minimal leakage, enabling discrete-time processing of analog signals. The topic of MOS switched-capacitor amplifiers is a significant application of internal amplifiers. This section introduces the application to elucidate the structure of MOS operational amplifiers.\n\nFigure 6.7 illustrates the circuit diagram of an inverting amplifier featuring capacitive feedback, as opposed to the resistive feedback depicted in Figure 6.3a. Should the operational amplifier be ideal, the gain from a change in the input voltage ΔVs to a change in the output voltage ΔVo is still determined by the ratio of the impedance of the feedback capacitor C2 to the impedance of the input capacitor C1, or\n\n$$\n\\begin{equation*}\n\\frac{\\Delta V_{o}}{\\Delta V_{s}}=-\\frac{\\frac{1}{\\omega C_{2}}}{\\frac{1}{\\omega C_{1}}}=-\\frac{C_{1}}{C_{2}} \\tag{6.25}\n\\end{equation*}\n$$\n\nIn contrast to scenarios where resistors serve as passive elements, this circuit does not provide DC bias for the inverting operational amplifier input because the impedances of both capacitors are infinite at DC. To address this issue, switches controlled by a two-phase nonoverlapping clock are employed to manage the operation of the aforementioned circuit. The resulting circuit is termed a switched-capacitor amplifier.\n\nFigure 6.8a presents the circuit diagram of a switched-capacitor amplifier. Each switch within the diagram is controlled by one of two clock phases φ1 and φ2, and the timing diagram is depicted in Figure 6.8b. It is assumed that each switch closes when its controlling clock signal is high and opens when its clock signal is low. Since φ1 and φ2 are never both high at the same time, the switches regulated by one clock phase are never closed simultaneously as those controlled by the other clock phase. Due to this characteristic, the clock signals in Figure 6.8b are referred to as nonoverlapping. For instance, the left side of C1 is connected to the input Vs through switch S1 when φ1 is high and to ground through switch S2 when φ2 is high, yet this node is never simultaneously linked to both the input and ground.\n\nTo simplify the description of the operation of switched-capacitor circuits, they are often redrawn twice, once for each nonoverlapping clock phase. Figures 6.8c and 6.8d illustrate the connections when φ1 is high (during φ1) and when φ2 is high (during φ2), respectively. Switches that are closed are assumed to be short circuits, and switches that are open are assumed to be open circuits.\n\nTo determine the output for a given input, an analysis based on charge conservation is conducted. After switch S3 opens, the charge on the plates of the capacitors connected to the operational amplifier input node is conserved until this switch closes again. This property is partly due to the fact that the passive elements connected to the operational amplifier input node are capacitors, which conduct zero DC current. Additionally, if the operational amplifier is constructed using an MOS differential input pair, the operational amplifier input is connected to the gate of one transistor in the differential pair, and the gate conducts zero DC current. Finally, if it is assumed that switch S3 conducts zero current when it is open, the charge stored cannot leak away while S3 is open.\n\nSince both sides of C2 are grounded in Figure 6.8c, the charge stored on the plates of the capacitors connected to the operational amplifier input node during φ1 is\n\n$$\n\\begin{equation*}\nQ_{1}=\\left(0-V_{s}\\right) C_{1}+(0) C_{2}=\\left(0-V_{s}\\right) C_{1} \\tag{6.26}\n\\end{equation*}\n$$\n\nBecause the input voltage is sampled or stored onto capacitor C1 during φ1, this phase is known as the input sample phase. If the operational amplifier is ideal, the voltage Vi from the inverting operational amplifier input to ground is driven to zero by negative feedback during φ2. Therefore, the charge stored during φ2 is\n\n$$\n\\begin{equation*}\nQ_{2}=(0) C_{1}+\\left(0-V_{o}\\right) C_{2}=\\left(0-V_{o}\\right) C_{2} \\tag{6.27}\n\\end{equation*}\n$$\n\nBecause the sampled charge appears on C1 during φ1 and on C2 during φ2, φ2 is known as the charge-transfer phase. By charge conservation, Q2=Q1; therefore,\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}} \\tag{6.28}\n\\end{equation*}\n$$\n\nIn (6.28), Vs represents the input voltage at the end of φ1, and Vo represents the output voltage at the end of φ2. The shape of the output voltage waveform is not predicted by (6.28) and depends on the rates at which the capacitors are charged and discharged. In practice, these rates depend on the bandwidth of the operational amplifier and the resistances of the closed switches. The result in (6.28) is valid as long as the operational amplifier is ideal, the input Vs is DC, and the durations over which φ1 and φ2 are high are sufficient to fully charge and discharge the associated capacitors. The ratio of Vo/Vs in (6.28) is positive because if Vs>0 during φ1, the voltage applied between the left side of C1 and ground decreases from a positive value to zero during φ2. Therefore, this negative change in the applied voltage during φ2 is multiplied by a negative closed-loop amplifier gain, yielding a positive ratio in (6.28).\n\nMOS technologies are well-suited for constructing switched-capacitor circuits for two principal reasons. First, the DC current that flows into the input terminals of MOS operational amplifiers is zero as long as the inputs are connected exclusively to the gates of MOS transistors. Conversely, bipolar operational amplifiers have nonzero DC input currents stemming from the finite βF in bipolar transistors. Second, the switches in Figure 6.8 can be implemented without offset by utilizing MOS transistors, as demonstrated in Figure 6.9a."
},
{
    "text": "---\n\n[Note]\nFor visuals linked within the [Content Area], they have been converted into textual descriptions. \n\n---\n\n[Task]\nPlease rephrase the text found in the [Content Area]. The rephrased version should preserve the original meaning and length.\n\n---[Content Area]---\n\nThe performance objectives for operational amplifiers (op amps) used within a monolithic analog subsystem are typically distinct from those of general-purpose op amps that rely on external feedback components. Within a monolithic analog subsystem, only a select few amplifiers are required to drive signals off-chip, where the capacitive and resistive loads are considerable and variable. These amplifiers will be referred to as output buffers, while those whose outputs remain on-chip will be designated as internal amplifiers. The most significant distinction lies in the fact that the load an internal amplifier must drive is well-defined and is often predominantly capacitive, with a value ranging from a few picofarads.\n\nOn the other hand, standalone general-purpose amplifiers are generally designed to meet a certain level of performance that remains consistent regardless of changes in capacitive loads up to several hundred picofarads and resistive loads down to 2 kΩ or less.\n\n#### 6.1.7.1 Switched-Capacitor Amplifier\n\nIn MOS technologies, capacitors, rather than resistors, are commonly employed as passive elements in feedback amplifiers, in part because capacitors are often the best available passive components. Additionally, capacitors can store charge proportional to the analog signals of interest, and MOS transistors can act as switches to connect to capacitors without offset and with minimal leakage, facilitating discrete-time signal processing of analog quantities. The subject of MOS switched-capacitor amplifiers is an important application of internal amplifiers. This section introduces this application to elucidate the structure of MOS operational amplifiers.\n\nFigure 6.7 illustrates the schematic of an inverting amplifier utilizing capacitive feedback as opposed to the resistive feedback depicted in Fig. 6.3a. For an ideal op amp, the gain resulting from a change in input voltage (\\(\\Delta V_s\\)) to a change in output voltage (\\(\\Delta V_o\\)) is still determined by the ratio of the impedance of the feedback capacitor (\\(C_2\\)) to the input capacitor (\\(C_1\\)), or\n\n$$\n\\begin{equation*}\n\\frac{\\Delta V_o}{\\Delta V_s}=-\\frac{\\frac{1}{\\omega C_2}}{\\frac{1}{\\omega C_1}}=-\\frac{C_1}{C_2} \\tag{6.25}\n\\end{equation*}\n$$\n\nHowever, unlike the scenario where resistors are used as passive elements, this circuit does not provide DC bias for the inverting op-amp input since the impedances of both capacitors are infinite at DC. To address this issue, switches controlled by a two-phase nonoverlapping clock are used to manage the operation of the aforementioned circuit. The resulting circuit is known as a switched-capacitor amplifier.\n\nFigure 6.8a presents the schematic of a switched-capacitor amplifier. Each switch in the diagram is governed by one of the two clock phases \\(\\phi_1\\) and \\(\\phi_2\\), and the timing diagram is depicted in Fig. 6.8b. We assume that each switch closes when its controlling clock signal is high and opens when its clock signal is low. Since \\(\\phi_1\\) and \\(\\phi_2\\) are never both high simultaneously, switches controlled by one clock phase are never closed concurrently with switches controlled by the other clock phase. Due to this characteristic, the clock signals in Fig. 6.8b are termed nonoverlapping. For instance, the left side of \\(C_1\\) is connected to the input \\(V_s\\) through switch \\(S_1\\) when \\(\\phi_1\\) is high and to ground through switch \\(S_2\\) when \\(\\phi_2\\) is high, but this node is never simultaneously connected to both the input and ground.\n\nTo simplify the explanation of the operation of switched-capacitor circuits, they are frequently redrawn twice, once for each nonoverlapping clock phase. Figures 6.8c and 6.8d illustrate the connections when \\(\\phi_1\\) is high (during \\(\\phi_1\\)) and when \\(\\phi_2\\) is high (during \\(\\phi_2\\)), respectively. Switches that are closed are assumed to be short circuits, and switches that are open are assumed to be open circuits.\n\nTo determine the output for a given input, an analysis based on charge conservation is employed. After switch \\(S_3\\) opens, the charge on the plates of the capacitors that connect to the op-amp input node is preserved until this switch closes again. This property is partly due to the fact that the passive elements connected to the op-amp input node are capacitors, which conduct zero DC current. Also, if the op amp is constructed with an MOS differential input pair, the op-amp input is connected to the gate of one transistor in the differential pair, and the gate conducts zero DC current. Finally, if we assume that switch \\(S_3\\) conducts zero current when it is open, the charge stored cannot leak away while \\(S_3\\) is open.\n\nSince both sides of \\(C_2\\) are grounded in Fig. 6.8c, the charge stored on the plates of the capacitors that connect to the the op-amp input node during \\(\\phi_1\\) is\n\n$$\n\\begin{equation*}\nQ_1=\\left(0-V_s\\right) C_1+(0) C_2=\\left(0-V_s\\right) C_1 \\tag{6.26}\n\\end{equation*}\n$$\n\nBecause the input voltage is sampled or stored onto capacitor \\(C_1\\) during \\(\\phi_1\\), this phase is referred to as the input sample phase. If the op amp is ideal, the voltage \\(V_i\\) from the inverting op-amp input to ground is driven to zero by negative feedback during \\(\\phi_2\\). Therefore, the charge stored during \\(\\phi_2\\) is\n\n$$\n\\begin{equation*}\nQ_2=(0) C_1+\\left(0-V_o\\right) C_2=\\left(0-V_o\\right) C_2 \\tag{6.27}\n\\end{equation*}\n$$\n\nBecause the sampled charge appears on \\(C_1\\) during \\(\\phi_1\\) and on \\(C_2\\) during \\(\\phi_2\\), \\(\\phi_2\\) is known as the charge-transfer phase. By charge conservation, \\(Q_2=Q_1\\); therefore,\n\n$$\n\\begin{equation*}\n\\frac{V_o}{V_s}=\\frac{C_1}{C_2} \\tag{6.28}\n\\end{equation*}\n$$\n\nIn (6.28), \\(V_s\\) represents the input voltage at the end of \\(\\phi_1\\), and \\(V_o\\) represents the output voltage at the end of \\(\\phi_2\\). The shape of the output voltage waveform is not predicted by (6.28) and depends on the rates at which the capacitors are charged and discharged. In practice, these rates depend on the bandwidth of the op amp and the resistances of the closed switches. The result in (6.28) is valid as long as the op amp is ideal, the input \\(V_s\\) is DC, and the intervals over which \\(\\phi_1\\) and \\(\\phi_2\\) are high are sufficiently long to fully charge and discharge the associated capacitors. The ratio of \\(V_o/V_s\\) in (6.28) is positive because if \\(V_s>0\\) during \\(\\phi_1\\), the voltage applied between the left side of \\(C_1\\) and ground decreases from a positive value to zero during \\(\\phi_2\\). Therefore, this negative change in the applied voltage during \\(\\phi_2\\) is multiplied by a negative closed-loop amplifier gain, yielding a positive ratio in (6.28).\n\nMOS technologies are particularly well-suited for constructing switched-capacitor circuits for two primary reasons. First, the DC current that flows into the input terminals of MOS op amps is zero as long as the inputs are connected solely to the gates of MOS transistors. In contrast, bipolar op amps exhibit nonzero DC input currents stemming from the finite \\(\\beta_F\\) of bipolar transistors. Second, the switches in Fig. 6.8 can be implemented without offset by using MOS transistors, as shown in Fig. 6.9a. The arrows indicating the source terminals of \\(M_1-M_5\\) are arbitrarily chosen in the sense that the source and drain terminals are interchangeable. (Since the source is the source of electrons in \\(n\\)-channel transistors, the source-to-ground voltage is lower than the drain-to-ground voltage.) Assume that the clock voltages alternate between \\(-V_{SS}\\) and \\(V_{DD}\\) as depicted in Fig. 6.9b. Also assume that all node voltages are no lower than \\(-V_{SS}\\) and no higher than \\(V_{DD}\\). Finally, assume that the transistor threshold voltages are positive. Under these conditions, each transistor turns off when its gate is low. Furthermore, each transistor turns on when its gate is high as long as its source operates at least a threshold below \\(V_{DD}\\). If \\(V_s\\) is a DC signal, all drain currents approach zero as the capacitors become charged. As the drain currents approach zero, the MOS transistors that are on operate in the triode region, where the drain-source voltage is zero when the drain current is zero. Therefore, the input voltage \\(V_s\\) is sampled onto \\(C_1\\) with zero offset inserted by the MOS transistors operating as switches. This property of MOS transistors is crucial in the implementation of switched-capacitor circuits. In contrast, bipolar transistors operating as switches do not provide zero collector-emitter voltage with zero collector current.\n\nThe switched-capacitor amplifier depicted in Fig. 6.9a is significant in practice mainly because the gain of this circuit is relatively insensitive to the various parasitic capacitances that are present on all nodes in the circuit. These unwanted capacitances arise in part from the drain-body and source-body junction capacitances of each transistor. Also, the op-amp input capacitance contributes to the parasitic capacitance on the op-amp input node. Furthermore, as described in Section 2.10.2, the bottom plates of capacitors \\(C_1\\) and \\(C_2\\) exhibit at least some capacitance to the underlying layer, which is the substrate or a well diffusion. Since the gain of the circuit is determined by charge conservation at the op-amp input node, the presence of parasitic capacitance from any node except the op-amp input to any node with a constant voltage to ground makes no difference to the accuracy of the circuit. (Such parasitics do reduce the maximum clock rate, however.) On the other hand, parasitic capacitance on the op-amp input node does affect the accuracy of the circuit gain, but the error is inversely proportional to the op-amp gain, as we will demonstrate.\n\nLet \\(C_P\\) represent the total parasitic capacitance from the op-amp input to all nodes with constant voltage to ground. If the op-amp gain is \\(a\\), the voltage from the inverting op-amp input to ground during \\(\\phi_2\\) is given by (6.10). Therefore, with finite op-amp gain, \\(C_1\\) and \\(C_P\\) are not completely discharged during \\(\\phi_2\\). Under these conditions, the charge stored on the op-amp input node during \\(\\phi_2\\) becomes\n\n$$\n\\begin{equation*}\nQ_2=\\left(-\\frac{V_o}{a}\\right) C_1+\\left(-\\frac{V_o}{a}\\right) C_P+\\left(-\\frac{V_o}{a}-V_o\\right) C_2 \\tag{6.29}\n\\end{equation*}\n$$\n\nWhen the op-amp gain becomes infinite, (6.29) reverts to (6.27), as expected. Setting \\(Q_2\\) in (6.29) equal to \\(Q_1\\) in (6.26) by charge conservation yields\n\n$$\n\\begin{equation*}\n\\frac{V_o}{V_s}=\\frac{C_1}{C_2}\\left[\\frac{1}{1+\\frac{1}{a}\\left(\\frac{C_1+C_2+C_P}{C_2}\\right)}\\right] \\tag{6.30}\n\\end{equation*}\n$$\n\nThis closed-loop gain can be expressed as\n\n$$\n\\begin{equation*}\n\\frac{V_o}{V_s}=\\frac{C_1}{C_2}(1-\\epsilon) \\tag{6.31}\n\\end{equation*}\n$$\n\nwhere \\(\\epsilon\\) is a gain error given by\n\n$$\n\\begin{equation*}\n\\epsilon=\\frac{1}{1+a\\left(\\frac{C_2}{C_1+C_2+C_P}\\right)} \\tag{6.32}\n\\end{equation*}\n$$\n\nAs \\(a \\rightarrow \\infty, \\epsilon \\rightarrow 0\\), and the gain of the switched-capacitor amplifier approaches \\(C_1/C_2\\) as predicted in (6.28). Consequently, the circuit gain is considered parasitic insensitive to a degree that depends on the op-amp gain.\n\nOne significant parameter of the switched-capacitor amplifier depicted in Fig. 6.9a is the minimum clock period. This period is divided into two primary sections, one for each clock phase. The duration of \\(\\phi_2\\) must be long enough for the op-amp output to reach and maintain a given level of accuracy. This time is defined as the op-amp settling time and is influenced by the switch resistances, the circuit capacitances, and the op-amp characteristics. The settling time is typically determined by SPICE simulations. Such simulations should be conducted for both clock phases because the op-amp output voltage during \\(\\phi_1\\) is not well controlled in practice. If the op amp is ideal, this output voltage is zero. With nonzero offset voltage, however, the output voltage will be driven to a nonzero value during \\(\\phi_1\\) that depends on both the offset voltage and the op-amp gain. If the op-amp gain is large, the offset can easily become large enough to force the output voltage to clip near one of the supplies. The output voltage at the end of \\(\\phi_1\\) can be considered as an initial condition for the circuit during \\(\\phi_2\\). If the initial condition and the desired final output at the end of \\(\\phi_2\\) differ significantly, the time required for the output to reach a given level of accuracy during \\(\\phi_2\\) can increase. Furthermore, nonzero offset can increase the time required for the op-amp output voltage to reach a constant level during \\(\\phi_1\\). Although the circuit output voltage defined in (6.30) only appears during \\(\\phi_2\\), failure\nto reach a constant output voltage during \\(\\phi_1\\) causes the initial condition defined above to vary depending on the value of \\(V_o\\) at the end of the preceding \\(\\phi_2\\). As a result of this memory effect, the circuit can behave as a filter (which is possibly nonlinear), weighing together the results of more than one previous input sample to determine any given output. The key point is that an increase in the minimum duration of either phase requires an increase in the minimum clock period. This effect should be included in simulation by intentionally simulating with nonzero offset voltages.\n\nOne method to reduce the impact of nonzero offset voltage on the minimum clock period is to incorporate a reset switch at the op-amp output. If the op amp has a single-ended output as shown in Fig. 6.9a, such a switch can be connected between the op-amp output and a bias point between the two supplies. On the other hand, if the op amp has differential outputs as described in Chapter 12, such a reset switch can be connected between the two op-amp outputs. In either case, the reset switch would be turned on during \\(\\phi_1\\) and off during \\(\\phi_2\\). The main advantage of such a reset switch is that it can reduce both the maximum output voltage produced by a nonzero offset voltage during \\(\\phi_1\\) and the time required to reach this value, in turn reducing the effect of nonzero offset on the minimum durations of both phases.\n\nThe accuracy of the switched-capacitor amplifier depicted in Fig. 6.9a is limited by several other factors that we will briefly consider now. First, even with an ideal op amp, the gain depends on the ratio of capacitors \\(C_1/C_2\\), which is not perfectly controlled in practice due to random-mismatch effects. Second, op-amp offset limits the smallest signal that can be distinguished from the offset in the switched-capacitor amplifier. As shown in Section 3.5.6, the input-referred offset of CMOS differential pairs is usually worse than for bipolar differential pairs. This characteristic extends to op amps and is partly due to the reduced transconductance-to-current ratio of MOS transistors compared to their bipolar counterparts and partly from the threshold mismatch term, which appears only in the MOS case. Third, the charge-conservation equation and accuracy of the switched-capacitor amplifier are affected by the charge stored under the gates of some of the MOS transistors acting as switches in Fig. 6.9a. For example, some of the charge stored under the gate of transistor \\(M_3\\) in Fig. 6.9a is injected onto the op-amp input node after \\(M_3\\) is turned off. Techniques to overcome these limitations are often used in practice but are not detailed here.\n\n#### 6.1.7.2 Switched-Capacitor Integrator\n\nAnother application of an internal op amp is the switched-capacitor integrator, which is demonstrated in its simplest form in Fig. 6.10a. This circuit is widely used as the fundamental element of monolithic switched-capacitor filters for two primary reasons. First, the frequency response of the integrator is insensitive to the various parasitic capacitances that exist at all nodes in the circuit. Second, the synthesis of desired filter frequency responses is relatively straightforward when using switched-capacitor integrators as basic elements. In this section, we will analyze the frequency response of the switched-capacitor integrator.\n\nThe integrator consists of an op amp, a sampling capacitor \\(C_S\\), an integrating capacitor \\(C_I\\), and four MOS transistor switches. The load capacitance shown represents the sampling capacitor of the following integrator, plus any parasitic capacitances that may be present. Typical values for the sampling, integrating, and load capacitances are labeled in Fig. 6.10a.\n\nFigure 6."
},
{
    "text": "---\n\nThe specified performance goals for operational amplifiers (op amps) designed for use within a single-chip analog system often diverge significantly from those intended for general-purpose op amps that incorporate external feedback elements. Within a monolithic analog system, just a handful of amplifiers are required to propagate signals outside the chip, where they encounter substantial and fluctuating capacitive and resistive loads. These amplifiers will be referred to as output buffers, while those whose signals remain on-chip will be called internal amplifiers. The most critical distinction is that the load an internal amplifier must manage is clearly defined and is typically purely capacitive, with a value in the range of several picofarads. In comparison, standalone general-purpose amplifiers typically need to be engineered to achieve a specific performance standard that is unaffected by changes in capacitive loads up to a few hundred picofarads and resistive loads as low as 2 kΩ or below.\n\n### 6.1.7.1 Switched-Capacitor Amplifier\n\nIn metal-oxide semiconductor (MOS) technologies, capacitors are often used in place of resistors as passive elements in feedback amplifiers, in part because capacitors are frequently the optimal available passive components. Additionally, capacitors can hold charge proportional to the analog signals of interest, and MOS transistors can function as switches to interface with the capacitors without introducing offsets and with minimal leakage, facilitating discrete-time signal processing of analog values. The MOS switched-capacitor amplifiers represent a notable application of internal amplifiers, and we introduce this application to elucidate the structure of MOS operational amplifiers.\n\nFigure 6.7 illustrates the circuit diagram of an inverting amplifier equipped with capacitive feedback, in contrast to the resistive feedback depicted in Figure 6.3a. For an ideal operational amplifier, the gain ratio from a change in the input voltage (\\(\\Delta V_s\\)) to a change in the output voltage (\\(\\Delta V_o\\)) remains proportional to the impedance ratio of the feedback capacitor (\\(C_2\\)) to the input capacitor (\\(C_1\\)), or\n\n$$\n\\begin{equation*}\n\\frac{\\Delta V_{o}}{\\Delta V_{s}}=-\\frac{\\frac{1}{\\omega C_{2}}}{\\frac{1}{\\omega C_{1}}}=-\\frac{C_{1}}{C_{2}} \\tag{6.25}\n\\end{equation*}\n$$\n\nHowever, unlike when resistors are utilized as passive elements, this circuit does not supply direct current bias to the inverting operational amplifier input, due to the capacitive elements being of infinite impedance at direct current (dc).\n\nFigure 6.7 presents the inverting amplifier configuration featuring capacitive feedback, contrasting with the resistive feedback seen in Fig. 6.3a. If the operational amplifier is ideal, the gain resulting from a variation in the input (\\(\\Delta V_s\\)) to a change in the output (\\(\\Delta V_o\\)) is still determined by the ratio of the impedance of the feedback element \\(C_2\\) to the impedance of the input element \\(C_1\\), which can be expressed as:\n\n$$\n\\begin{equation*}\n\\frac{\\Delta V_{o}}{\\Delta V_{s}}=-\\frac{\\frac{1}{\\omega C_{2}}}{\\frac{1}{\\omega C_{1}}}=-\\frac{C_{1}}{C_{2}} \\tag{6.25}\n\\end{equation*}\n$$\n\nOn the contrary, this circuit lacks DC bias for the inverting operational amplifier input because both capacitors have infinite impedance at DC. To address this issue, switches regulated by a two-phase nonoverlapping clock are implemented to control the operation of the aforementioned circuit. The resulting circuit is recognized as a switched-capacitor amplifier.\n\nFigure $6.8 a$ displays the circuit diagram of a switched-capacitor amplifier. Each switch in the diagram is controlled by one of two clock phases (\\(\\phi_1\\)) and (\\(\\phi_2\\)), and the timing diagram is shown in Fig. 6.8b. We will assume that each switch closes when its respective clock signal is high and opens when the clock signal is low. Since \\(\\phi_1\\) and \\(\\phi_2\\) are never both high simultaneously, the switches controlled by one clock phase are never closed at the same time as the switches controlled by the other clock phase. Due to this characteristic, the clock signals in Fig. 6.8b are referred to as nonoverlapping. For instance, the left side of \\(C_1\\) is connected to the input voltage (\\(V_s\\)) through switch \\(S_1\\) when \\(\\phi_1\\) is high and to ground through switch \\(S_2\\) when \\(\\phi_2\\) is high, but this node is never concurrently connected to both the input and ground.\n\nTo streamline the description of the operation of switched-capacitor circuits, they are often redrawn twice, once for each nonoverlapping clock phase. Figures $6.8 c$ and $6.8 d$ illustrate the connections when \\(\\phi_1\\) is high (during \\(\\phi_1\\)) and when \\(\\phi_2\\) is high (during \\(\\phi_2\\)), respectively. Switches that are closed are assumed to be short circuits, and switches that are open are assumed to be open circuits.\n\nTo determine the output for a specified input, an analysis based on charge conservation is applied. After switch \\(S_3\\) opens, the charge on the plates of the capacitors that connect to the operational amplifier input node is conserved until this switch closes again. This principle is partly due to the fact that the passive elements connected to the operational amplifier input node are capacitors, which conduct zero DC current. Also, if the operational amplifier is constructed with an MOS differential input pair, the operational amplifier input is connected to the gate of one transistor in the differential pair, and the gate conducts zero DC current. Finally, if we assume that switch \\(S_3\\) conducts zero current when it is open, the charge stored cannot leak away while \\(S_3\\) is open.\n\nSince both sides of \\(C_2\\) are grounded in Fig. 6.8c, the charge stored on the plates of the capacitors that connect to the operational amplifier input node during \\(\\phi_1\\) is\n\n$$\n\\begin{equation*}\nQ_{1}=\\left(0-V_{s}\\right) C_{1}+(0) C_{2}=\\left(0-V_{s}\\right) C_{1} \\tag{6.26}\n\\end{equation*}\n$$\n\nBecause the input voltage is sampled or stored onto capacitor \\(C_1\\) during \\(\\phi_1\\), this phase is known as the input sample phase. If the operational amplifier is ideal, the voltage \\(V_i\\) from the inverting operational amplifier input to ground is driven to zero by negative feedback during \\(\\phi_2\\). Consequently, the charge stored during \\(\\phi_2\\) is\n\n$$\n\\begin{equation*}\nQ_{2}=(0) C_{1}+\\left(0-V_{o}\\right) C_{2}=\\left(0-V_{o}\\right) C_{2} \\tag{6.27}\n\\end{equation*}\n$$\n\nBecause the sampled charge appears on \\(C_1\\) during \\(\\phi_1\\) and on \\(C_2\\) during \\(\\phi_2\\), \\(\\phi_2\\) is known as the charge-transfer phase. By charge conservation, \\(Q_2=Q_1\\); therefore,\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}} \\tag{6.28}\n\\end{equation*}\n$$\n\nIn equation (6.28), \\(V_s\\) represents the input voltage at the conclusion of \\(\\phi_1\\), and \\(V_o\\) represents the output voltage at the conclusion of \\(\\phi_2\\). The form of the output voltage waveform is not predicted by (6.28) and is dependent on the rates at which the capacitors are charged and discharged. In practice, these rates depend on the bandwidth of the operational amplifier and the resistances of the closed switches. The result in (6.28) holds true as long as the operational amplifier is ideal, the input \\(V_s\\) is DC, and the periods over which \\(\\phi_1\\) and \\(\\phi_2\\) are high are sufficiently long to fully charge and discharge the associated capacitors. The ratio of \\(V_o / V_s\\) in (6.28) is positive because if \\(V_s>0\\) during \\(\\phi_1\\), the voltage applied between the left side of \\(C_1\\) and ground falls from a positive value to zero during \\(\\phi_2\\). Thus, this negative change in the applied voltage during \\(\\phi_2\\) is multiplied by a negative closed-loop amplifier gain, yielding a positive ratio in (6.28).\n\nMOS technologies are well-suited for constructing switched-capacitor circuits for two primary reasons. First, the DC current that flows into the input terminals of MOS operational amplifiers is zero as long as the inputs are connected only to the gates of MOS transistors. In contrast, bipolar operational amplifiers have nonzero DC input currents originating from finite \\(\\beta_F\\) in bipolar transistors. Second, the switches in Fig. 6.8 can be implemented without offset by using MOS transistors, as shown\nimage_name:(a)\ndescription:\n[\nname: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\nname: M1, type: NMOS, ports: {S: X1, D: Vs, G: phi1}\nname: M2, type: NMOS, ports: {S: X1, D: GND, G: phi2}\nname: C1, type: Capacitor, value: C1, ports: {Np: X1, Nn: InN(A0)}\nname: M3, type: NMOS, ports: {S: GND, D: InN(A0), G: phi1}\nname: A0, type: OpAmp, value: A0, ports: {InP: GND, InN: InN(A0), OutP: Vo, OutN: GND}\nname: C2, type: Capacitor, value: C2, ports: {Np: InN(A0), Nn: d4d5}\nname: M4, type: NMOS, ports: {S: GND, D: d4d5, G: phi1}\nname: M5, type: NMOS, ports: {S: Vo, D: d4d5, G: phi2}\nname: Cp, type: Capacitor, value: Cp, ports: {Np: InN(A0), Nn: GND}\n]\nextrainfo:This represents a switched-capacitor amplifier circuit that utilizes n-channel MOS transistors as switches. The clock waveforms \\(\\phi_1\\) and \\(\\phi_2\\) control the switching of the MOS transistors. The circuit is designed to sample and amplify the input voltage Vs.\nimage_name:(b)\ndescription:The graph labeled \"(b)\" depicts two time-domain waveforms representing clock signals \\( \\phi_1 \\) and \\( \\phi_2 \\). The x-axis is labeled as time \\( t \\), while the y-axis represents the voltage levels of the clock signals. The voltage levels are indicated by \\( V_{DD} \\) and \\( -V_{SS} \\), suggesting that the signals alternate between these two values.\n\n1. **Type of Graph and Function**:\n- The graph is a time-domain waveform plot, depicting the behavior of clock signals over time.\n\n2. **Axes Labels and Units**:\n- The x-axis is time \\( t \\), though specific units are not provided; it typically represents time in seconds or milliseconds.\n- The y-axis represents voltage levels, with specific reference levels \\( V_{DD} \\) and \\( -V_{SS} \\).\n\n3. **Overall Behavior and Trends**:\n- Both \\( \\phi_1 \\) and \\( \\phi_2 \\) waveforms are square waves, alternating between \\( V_{DD} \\) and \\( -V_{SS} \\).\n- The waveforms appear periodic, suggesting a regular switching pattern typical for clock signals.\n\n4. **Key Features and Technical Details**:\n- The waveforms exhibit a consistent duty cycle, implying equal time spent at each voltage level.\n- There are no visible annotations or markers indicating specific timings or frequency values.\n\n5. **Annotations and Specific Data Points**:\n- The graph does not provide specific numerical values for \\( V_{DD} \\) or \\( -V_{SS} \\), nor does it specify the period of the waveforms.\n- The signals are depicted in separate plots but are likely synchronized in some manner, as is typical in switched-capacitor circuits.\n\nOverall, the graph illustrates the typical square waveforms used to control switches in a switched-capacitor circuit, as part of the clock signal generation necessary for the operation of the circuit shown in the schematic above (Fig. 6.9a).\n\nFigure 6.9 (a) Schematic of a switched-capacitor amplifier with $n$-channel MOS transistors used as switches. (b) Clock waveforms with labeled voltages.\nin Fig. 6.9a. The arrows indicating the source terminals of \\(M_{1}-M_{5}\\) are arbitrarily chosen in the sense that the source and drain terminals are interchangeable. (Since the source is the source of electrons in \\(n\\)-channel transistors, the source-to-ground voltage is lower than the drain-to-ground voltage.) Assume that the clock voltages alternate between \\( -V_{SS} \\) and \\( V_{DD} \\) as shown in Fig. 6.9b. Also assume that all node voltages are no lower than \\( -V_{SS} \\) and no higher than \\( V_{DD} \\). Finally, assume that the transistor threshold voltages are positive. Under these conditions, each transistor turns off when its gate is low. Furthermore, each transistor turns on when its gate is high as long as its source operates at least a threshold below \\( V_{DD} \\). If \\(V_s\\) is a DC signal, all drain currents approach zero as the capacitors become charged. As the drain currents approach zero, the MOS transistors that are on operate in the triode region, where the drain-source voltage is zero when the drain current is zero. Therefore, the input voltage \\(V_s\\) is sampled onto \\(C_1\\) with zero offset inserted by the MOS transistors operating as switches. This property of MOS transistors is significant in the implementation of switched-capacitor circuits. In contrast, bipolar transistors operating as switches do not yield zero collector-emitter voltage with zero collector current.\n\nThe switched-capacitor amplifier depicted in Fig. $6.9 a$ is significant in practice primarily because the gain of this circuit is minimally influenced by the numerous parasitic capacitances that are present on all nodes in the circuit. These undesirable capacitances originate partly from the drain-body and source-body junction capacitances of each transistor. Also, the operational amplifier input capacitance contributes to the parasitic capacitance on the operational amplifier input node. Furthermore, as described in Section 2.10.2, the bottom plates of capacitors \\(C_1\\) and \\(C_2\\) exhibit some capacitance to the underlying layer, which is the substrate or a well diffusion. Since the gain of the circuit is determined by charge conservation at the operational amplifier input node, the presence of parasitic capacitance from any node except the operational amplifier input to any node with a constant voltage to ground makes no difference to the accuracy of the circuit. (Such parasitics do reduce the maximum clock rate, however.) On the other hand, parasitic capacitance on the operational amplifier input node does affect the accuracy of the circuit gain, but the error is inversely proportional to the operational amplifier gain, as we will demonstrate.\n\nLet \\(C_{P}\\) represent the total parasitic capacitance from the operational amplifier input to all nodes with a constant voltage to ground. If the operational amplifier gain is \\(a\\), the voltage from the inverting operational amplifier input to ground during \\(\\phi_2\\) is given by (6.10). Therefore, with a finite operational amplifier gain, \\(C_1\\) and \\(C_{P}\\) are not completely discharged during \\(\\phi_2\\). Under these conditions, the charge stored on the operational amplifier input node during \\(\\phi_2\\) becomes\n\n$$\n\\begin{equation*}\nQ_{2}=\\left(-\\frac{V_{o}}{a}\\right) C_{1}+\\left(-\\frac{V_{o}}{a}\\right) C_{P}+\\left(-\\frac{V_{o}}{a}-V_{o}\\right) C_{2} \\tag{6.29}\n\\end{equation*}\n$$\n\nWhen the operational amplifier gain becomes infinite, (6.29) collapses to (6.27), as expected. Setting \\(Q_2\\) in (6.29) equal to \\(Q_1\\) in (6.26) by charge conservation gives\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}}\\left[\\frac{1}{1+\\frac{1}{a}\\left(\\frac{C_{1}+C_{2}+C_{P}}{C_{2}}\\right)}\\right] \\tag{6.30}\n\\end{equation*}\n$$\n\nThis closed-loop gain can be written as\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}}(1-\\epsilon) \\tag{6.31}\n\\end{equation*}\n$$\n\nwhere \\(\\epsilon\\) is a gain error given by\n\n$$\n\\begin{equation*}\n\\epsilon=\\frac{1}{1+a\\left(\\frac{C_{2}}{C_{1}+C_{2}+C_{P}}\\right)} \\tag{6.32}\n\\end{equation*}\n$$\n\nAs \\(a \\rightarrow \\infty, \\epsilon \\rightarrow 0\\), and the gain of the switched-capacitor amplifier approaches \\(C_{1} / C_{2}\\) as predicted in (6.28). As a result, the circuit gain is considered parasitic insensitive to an extent that depends on the operational amplifier gain.\n\nOne essential parameter of the switched-capacitor amplifier shown in Fig. $6.9 a$ is the minimum clock period. This period is divided into two principal parts, one for each clock phase. The duration of \\(\\phi_2\\) must be long enough for the operational amplifier output to reach and maintain a certain level of accuracy. This time is defined as the operational amplifier settling time and is influenced by"
},
{
    "text": "---[Attention]---\nImage Descriptions: Descriptions of images linked within the [Context Provided] have been transformed into written text. Additional text has been reshaped to preserve the original intent and length.\n---[Task]---\nRefine the text found in the [Context Provided] Section to reflect the intended meaning without altering its original length or essence.\n---[Context Provided]---\nThe refined text:\n```\nPerformance objectives for operational amplifiers intended for use within a monolithic analog subsystem typically differ significantly from those of general-purpose operational amplifiers that rely on external feedback components. Within a monolithic analog subsystem, only a select few amplifiers are required to drive signals off-chip, where the capacitive and resistive loads are substantial and variable. These amplifiers will be referred to as output buffers, whereas amplifiers with outputs that remain on-chip will be called internal amplifiers. Perhaps the most notable distinction is that the load that an internal amplifier must handle is well-defined and often purely capacitive, with a value of a few picofarads. In contrast, stand-alone general-purpose amplifiers generally need to be designed to meet a specific performance standard that is unaffected by variations in capacitive loads up to several hundred picofarads and resistive loads down to $2 \\mathrm{k} \\Omega$ or lower.\n\n#### 6.1.7.1 Switched-Capacitor Amplifier\n\nIn MOS technologies, capacitors are frequently employed in place of resistors as passive elements in feedback amplifiers, in part due to capacitors often being the most suitable passive components available. Moreover, capacitors can hold charge in proportion to the analog signals of interest, and MOS transistors can serve as switches to interface with the capacitors without offsets and with minimal leakage, facilitating the discrete-time processing of analog signals. The application of MOS switched-capacitor amplifiers is a prime example of a use case for internal amplifiers. We introduce this application to elucidate the construction of MOS operational amplifiers.\n\nFigure 6.7 presents the circuit diagram of an inverting amplifier with capacitive feedback in contrast to the resistive feedback depicted in Fig. 6.3a. If the operational amplifier is ideal, the gain resulting from a change in the input $\\Delta V_{s}$ to a change in the output $\\Delta V_{o}$ is still determined by the ratio of the impedance of the feedback element $C_{2}$ to the impedance of the input element $C_{1}$, or\n\n$$\n\\begin{equation*}\n\\frac{\\Delta V_{o}}{\\Delta V_{s}}=-\\frac{\\frac{1}{\\omega C_{2}}}{\\frac{1}{\\omega C_{1}}}=-\\frac{C_{1}}{C_{2}} \\tag{6.25}\n\\end{equation*}\n$$\n\nNonetheless, unlike scenarios where resistors are used as passive elements, this circuit does not provide DC bias for the inverting operational amplifier input, as both capacitors have infinite impedance at DC. To address this issue, switches activated by a two-phase nonoverlapping clock are utilized to control the operation of the aforementioned circuit. The resulting circuit is referred to as a switched-capacitor amplifier.\n\nFigure $6.8 a$ exhibits the circuit diagram of a switched-capacitor amplifier. Each switch in the diagram is governed by one of two clock phases $\\phi_{1}$ and $\\phi_{2}$, and the timing diagram is illustrated in Fig. 6.8b. We assume that each switch closes when its respective clock signal is high and opens when its clock signal is low. Given that $\\phi_{1}$ and $\\phi_{2}$ are never both high simultaneously, switches controlled by one clock phase are never closed concurrently with switches controlled by the other clock phase. Consequently, the clock signals in Fig. 6.8b are termed nonoverlapping. For example, the left side of $C_{1}$ is connected to the input $V_{s}$ via switch $S_{1}$ when $\\phi_{1}$ is high and to ground through switch $S_{2}$ when $\\phi_{2}$ is high, but this node is never concurrently connected to both the input and ground.\n\nTo simplify the explanation of the operation of switched-capacitor circuits, they are commonly redrawn twice, once for each nonoverlapping clock phase. Figures $6.8 c$ and $6.8 d$ show the connections when $\\phi_{1}$ is high (during $\\phi_{1}$) and when $\\phi_{2}$ is high (during $\\phi_{2}$), respectively. Switches that are closed are assumed to act as short circuits, and switches that are open are assumed to act as open circuits.\n\nTo determine the output for a given input, an analysis based on charge conservation is employed. After switch $S_{3}$ opens, the charge on the plates of the capacitors connected to the operational amplifier input node is preserved until this switch closes again. This is partly due to the fact that the passive elements connected to the operational amplifier input node are capacitors, which conduct zero DC current. Furthermore, if the operational amplifier features an MOS differential input pair, the input is connected to the gate of one transistor in the differential pair, and the gate conducts zero DC current. Lastly, if we assume that switch $S_{3}$ conducts zero current when it is open, the charge stored cannot dissipate while $S_{3}$ is open.\n\nSince both sides of $C_{2}$ are grounded in Fig. 6.8c, the charge stored on the plates of the capacitors connected to the operational amplifier input node during $\\phi_{1}$ is\n\n$$\n\\begin{equation*}\nQ_{1}=\\left(0-V_{s}\\right) C_{1}+(0) C_{2}=\\left(0-V_{s}\\right) C_{1} \\tag{6.26}\n\\end{equation*}\n$$\n\nBecause the input voltage is sampled or stored onto capacitor $C_{1}$ during $\\phi_{1}$, this phase is known as the input sample phase. If the operational amplifier is ideal, the voltage $V_{i}$ from the inverting operational amplifier input to ground is driven to zero by negative feedback during $\\phi_{2}$. Consequently, the charge stored during $\\phi_{2}$ is\n\n$$\n\\begin{equation*}\nQ_{2}=(0) C_{1}+\\left(0-V_{o}\\right) C_{2}=\\left(0-V_{o}\\right) C_{2} \\tag{6.27}\n\\end{equation*}\n$$\n\nBecause the sampled charge appears on $C_{1}$ during $\\phi_{1}$ and on $C_{2}$ during $\\phi_{2}, \\phi_{2}$ is designated as the charge-transfer phase. By charge conservation, $Q_{2}=Q_{1}$; therefore,\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}} \\tag{6.28}\n\\end{equation*}\n$$\n\nIn (6.28), $V_{s}$ represents the input voltage at the end of $\\phi_{1}$, and $V_{o}$ represents the output voltage at the end of $\\phi_{2}$. The waveform shape of the output voltage is not predicted by (6.28) and depends on the rates at which the capacitors are charged and discharged. In practice, these rates depend on the bandwidth of the operational amplifier and the resistances of the closed switches. The result in (6.28) is valid as long as the operational amplifier is ideal, the input $V_{s}$ is DC, and the intervals over which $\\phi_{1}$ and $\\phi_{2}$ are high are sufficient to fully charge and discharge the associated capacitors. The ratio of $V_{o} / V_{s}$ in (6.28) is positive because if $V_{s}>0$ during $\\phi_{1}$, the voltage applied between the left side of $C_{1}$ and ground decreases from a positive value to zero during $\\phi_{2}$. Therefore, this negative change in the applied voltage during $\\phi_{2}$ is multiplied by a negative closed-loop amplifier gain, resulting in a positive ratio in (6.28).\n\nMOS technologies are particularly well-suited for constructing switched-capacitor circuits due to two main reasons. First, the DC current flowing into the input terminals of MOS operational amplifiers is zero as long as the inputs are connected only to the gates of MOS transistors. In contrast, bipolar operational amplifiers have nonzero DC input currents stemming from finite $\\beta_{F}$ in bipolar transistors. Second, the switches in Fig. 6.8 can be implemented without offset using MOS transistors, as shown\nimage_name:(a)\ndescription:\n[\nname: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\nname: M1, type: NMOS, ports: {S: X1, D: Vs, G: phi1}\nname: M2, type: NMOS, ports: {S: X1, D: GND, G: phi2}\nname: C1, type: Capacitor, value: C1, ports: {Np: X1, Nn: InN(A0)}\nname: M3, type: NMOS, ports: {S: GND, D: InN(A0), G: phi1}\nname: A0, type: OpAmp, value: A0, ports: {InP: GND, InN: InN(A0), OutP: Vo, OutN: GND}\nname: C2, type: Capacitor, value: C2, ports: {Np: InN(A0), Nn: d4d5}\nname: M4, type: NMOS, ports: {S: GND, D: d4d5, G: phi1}\nname: M5, type: NMOS, ports: {S: Vo, D: d4d5, G: phi2}\nname: Cp, type: Capacitor, value: Cp, ports: {Np: InN(A0), Nn: GND}\n]\nextrainfo:This is a switched-capacitor amplifier circuit using n-channel MOS transistors as switches. The clock waveforms phi1 and phi2 control the switching of the MOS transistors. The circuit is designed to sample and amplify the input voltage Vs.\nimage_name:(b)\ndescription:The graph labeled \"(b)\" depicts two time-domain waveforms representing clock signals \\( \\phi_1 \\) and \\( \\phi_2 \\). The x-axis is labeled as time \\( t \\), while the y-axis represents the voltage levels of the clock signals. The voltage levels are indicated by \\( V_{DD} \\) and \\( -V_{SS} \\), suggesting that the signals alternate between these two values.\n\n1. **Type of Graph and Function**:\n- The graph is a time-domain waveform plot, depicting the behavior of clock signals over time.\n\n2. **Axes Labels and Units**:\n- The x-axis is time \\( t \\), though specific units are not provided, it typically represents time in seconds or milliseconds.\n- The y-axis represents voltage levels, with specific reference levels \\( V_{DD} \\) and \\( -V_{SS} \\).\n\n3. **Overall Behavior and Trends**:\n- Both \\( \\phi_1 \\) and \\( \\phi_2 \\) waveforms are square waves, alternating between \\( V_{DD} \\) and \\( -V_{SS} \\).\n- The waveforms appear periodic, suggesting a regular switching pattern typical for clock signals.\n\n4. **Key Features and Technical Details**:\n- The waveforms exhibit a consistent duty cycle, implying equal time spent at each voltage level.\n- There are no visible annotations or markers indicating specific timings or frequency values.\n\n5. **Annotations and Specific Data Points**:\n- The graph does not provide specific numerical values for \\( V_{DD} \\) or \\( -V_{SS} \\), nor does it specify the period of the waveforms.\n- The signals are depicted in separate plots but are likely synchronized in some manner, as is typical in switched-capacitor circuits.\n\nOverall, the graph illustrates the typical square waveforms used to control switches in a switched-capacitor circuit, as part of the clock signal generation necessary for the operation of the circuit shown in the schematic above (Fig. 6.9a).\n\nFigure 6.9 (a) Schematic of a switched-capacitor amplifier with $n$-channel MOS transistors used as switches. (b) Clock waveforms with labeled voltages.\nin Fig. 6.9a. The arrows indicating the source terminals of $M_{1}-M_{5}$ are arbitrarily chosen in the sense that the source and drain terminals are interchangeable. (Since the source is the source of electrons in $n$-channel transistors, the source-to-ground voltage is lower than the drain-to-ground voltage.) Assume that the clock voltages alternate between $-V_{S S}$ and $V_{D D}$ as shown in Fig. 6.9b. Also assume that all node voltages are no lower than $-V_{S S}$ and no higher than $V_{D D}$. Finally, assume that the transistor threshold voltages are positive. Under these conditions, each transistor turns off when its gate is low. Furthermore, each transistor turns on when its gate is high as long as its source operates at least a threshold below $V_{D D}$. If $V_{s}$ is a DC signal, all drain currents approach zero as the capacitors become charged. As the drain currents approach zero, the MOS transistors that are on operate in the triode region, where the drain-source voltage is zero when the drain current is zero. Therefore, the input voltage $V_{s}$ is sampled onto $C_{1}$ with zero offset inserted by the MOS transistors operating as switches. This property of MOS transistors is important in the implementation of switched-capacitor circuits. In contrast, bipolar transistors operating as switches do not yield zero collector-emitter voltage with zero collector current.\n\nThe switched-capacitor amplifier shown in Fig. $6.9 a$ is significant in practice mainly because the gain of this circuit is little affected by the various parasitic capacitances that are present on all nodes in the circuit. These unwanted capacitances arise in part from the drain-body and source-body junction capacitances of each transistor. Also, the operational amplifier input capacitance contributes to the parasitic capacitance on the operational amplifier input node. Furthermore, as described in Section 2.10.2, the bottom plates of capacitors $C_{1}$ and $C_{2}$ exhibit at least some capacitance to the underlying layer, which is the substrate or a well diffusion. Since the gain of the circuit is determined by charge conservation at the operational amplifier input node, the presence of parasitic capacitance from any node except the operational amplifier input to any node with a constant voltage to ground makes no difference to the accuracy of the circuit. (Such parasitics do reduce the maximum clock rate, however.) On the other hand, parasitic capacitance on the operational amplifier input node does affect the accuracy of the circuit gain, but the error is inversely proportional to the operational amplifier gain, as we will now demonstrate.\n\nLet $C_{P}$ represent the total parasitic capacitance from the operational amplifier input to all nodes with constant voltage to ground. If the operational amplifier gain is $a$, the voltage from the inverting operational amplifier input to ground during $\\phi_{2}$ is given by (6.10). Therefore, with finite operational amplifier gain, $C_{1}$ and $C_{P}$ are not completely discharged during $\\phi_{2}$. Under these conditions, the charge stored on the operational amplifier input node during $\\phi_{2}$ becomes\n\n$$\n\\begin{equation*}\nQ_{2}=\\left(-\\frac{V_{o}}{a}\\right) C_{1}+\\left(-\\frac{V_{o}}{a}\\right) C_{P}+\\left(-\\frac{V_{o}}{a}-V_{o}\\right) C_{2} \\tag{6.29}\n\\end{equation*}\n$$\n\nWhen the operational amplifier gain becomes infinite, (6.29) collapses to (6.27), as expected. Setting $Q_{2}$ in (6.29) equal to $Q_{1}$ in (6.26) by charge conservation yields\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}}\\left[\\frac{1}{1+\\frac{1}{a}\\left(\\frac{C_{1}+C_{2}+C_{P}}{C_{2}}\\right)}\\right] \\tag{6.30}\n\\end{equation*}\n$$\n\nThis closed-loop gain can be expressed as\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}}(1-\\epsilon) \\tag{6.31}\n\\end{equation*}\n$$\n\nwhere $\\epsilon$ is a gain error given by\n\n$$\n\\begin{equation*}\n\\epsilon=\\frac{1}{1+a\\left(\\frac{C_{2}}{C_{1}+C_{2}+C_{P}}\\right)} \\tag{6.32}\n\\end{equation*}\n$$\n\nAs $a \\rightarrow \\infty, \\epsilon \\rightarrow 0$, and the gain of the switched-capacitor amplifier approaches $C_{1} / C_{2}$ as predicted in (6.28). Consequently, the circuit gain is said to be parasitic insensitive to an extent that depends on the operational amplifier gain.\n\nOne important parameter of the switched-capacitor amplifier shown in Fig. $6.9 a$ is the minimum clock period. This period is divided into two main parts, one for each clock phase. The duration of $\\phi_{2}$ must be ample for the operational amplifier output to reach and maintain a specified level of accuracy. This time is defined as the operational amplifier settling time and depends on the switch resistances, the circuit capacitances, and the operational amplifier characteristics. The settling time is typically determined by SPICE simulations. Such simulations should be conducted for both clock phases because the operational amplifier output voltage during $\\phi_{1}$ is not well controlled in practice. If the operational amplifier is ideal, this output voltage is zero. With nonzero offset voltage, however, the output voltage will be driven to a nonzero value during $\\phi_{1}$ that depends on both the offset voltage and the operational amplifier gain. If the operational amplifier gain is high, the offset can easily be large enough to force the output voltage to clip near one of the supplies. The output voltage at the end of $\\phi_{1}$ can be thought of as an initial condition for the circuit during $\\phi_{2}$. If the initial condition and the desired final output at the end of $\\phi_{2}$ differ significantly, the time required for the output to reach a given level of"
},
{
    "text": "---\n\nImage Descriptions: Textual descriptions have been created for images referenced in the [Context Provided]. You are required to rephrase the content within the [Context Provided] Section, ensuring that the rephrased version retains the original meaning and length.\n\n---[Task]---\nPlease rephrase the text in the [Context Provided] Section. Make sure that the revised text retains the original meaning and overall length.\n---[Context Provided]---\nIn a monolithic analog subsystem, the performance goals for operational amplifiers (op amps) are generally distinct from those for general-purpose op amps which incorporate external feedback components. Within the monolithic system, only a select few amplifiers need to drive signals off the integrated circuit (IC), where the capacitive and resistive loads are considerable and variable. These amplifiers are designated as output buffers, while the amplifiers whose outputs remain within the chip are referred to as internal amplifiers. The most notable difference lies in the well-defined load that an internal amplifier must drive, which is typically purely capacitive and ranges from a few picofarads.\n\nIn contrast, general-purpose standalone amplifiers are typically designed to achieve a specific performance level irrespective of changes in capacitive loads up to several hundred picofarads or resistive loads down to 2 kΩ or less.\n\n#### 6.1.7.1 Switched-Capacitor Amplifier\n\nIn MOS technology, capacitors, rather than resistors, are often employed as passive elements in feedback amplifiers, primarily due to capacitors being the superior available passive components. Moreover, capacitors can store charge proportionate to the analog signals of interest, while MOS transistors can function as switches to interface with capacitors without introducing offset and with minimal leakage, enabling the discrete-time processing of analog signals. The use of MOS switched-capacitor amplifiers represents a critical application of internal amplifiers, and this section introduces this application to elucidate the construction of MOS operational amplifiers.\n\nFigure 6.7 illustrates an inverting amplifier with capacitive feedback, as opposed to the resistive feedback depicted in Fig. 6.3a. If the op amp is ideal, the gain from a change in input voltage ΔVs to a change in output voltage ΔVo is still expressed as the ratio of the impedance of the feedback element C2 to the impedance of the input element C1, or\n\n$$\n\\begin{equation*}\n\\frac{\\Delta V_{o}}{\\Delta V_{s}}=-\\frac{\\frac{1}{\\omega C_{2}}}{\\frac{1}{\\omega C_{1}}}=-\\frac{C_{1}}{C_{2}} \\tag{6.25}\n\\end{equation*}\n$$\n\nHowever, unlike the scenario where resistors are used as passive elements, this circuit does not supply DC bias to the inverting op-amp input because the impedances of both capacitors are infinite at DC. To address this issue, switches controlled by a two-phase nonoverlapping clock are employed to govern the operation of the circuit, and the resulting circuit is termed a switched-capacitor amplifier.\n\nFigure 6.8a displays the schematic of a switched-capacitor amplifier. Each switch in the diagram is activated by one of the two clock phases φ1 and φ2, and the timing diagram is depicted in Fig. 6.8b. We assume that each switch is closed when its corresponding clock signal is high and open when the clock signal is low. Since φ1 and φ2 never both rise simultaneously, the switches controlled by one clock phase are never closed at the same time as the switches controlled by the other clock phase. Because of this attribute, the clock signals in Fig. 6.8b are referred to as nonoverlapping. For instance, the left side of C1 is connected to the input Vs through switch S1 when φ1 is high and to ground through switch S2 when φ2 is high, but this node is never simultaneously connected to both the input and ground.\n\nTo facilitate the description of the operation of switched-capacitor circuits, they are frequently redrawn twice, once for each nonoverlapping clock phase. Figures 6.8c and 6.8d show the connections when φ1 is high (during φ1) and when φ2 is high (during φ2), respectively. Switches that are closed are assumed to be short circuits, and switches that are open are assumed to be open circuits.\n\nTo determine the output for a given input, an analysis based on charge conservation is employed. After switch S3 opens, the charge on the plates of the capacitors that are connected to the op-amp input node is preserved until this switch closes again. This principle is partly due to the fact that the passive elements connected to the op-amp input node are capacitors, which have zero DC current conduction. Additionally, if the op amp is constructed with an MOS differential input pair, the op-amp input is connected to the gate of one transistor in the differential pair, and the gate conducts zero DC current. Furthermore, if we assume that switch S3 conducts zero current when it is open, the charge stored cannot leak away while S3 is open.\n\nSince both sides of C2 are grounded in Fig. 6.8c, the charge stored on the plates of the capacitors that are connected to the op-amp input node during φ1 is\n\n$$\n\\begin{equation*}\nQ_{1}=\\left(0-V_{s}\\right) C_{1}+(0) C_{2}=\\left(0-V_{s}\\right) C_{1} \\tag{6.26}\n\\end{equation*}\n$$\n\nBecause the input voltage is sampled or stored onto capacitor C1 during φ1, this phase is known as the input sample phase. If the op amp is ideal, the voltage Vi from the inverting op-amp input to ground is driven to zero by negative feedback during φ2. Consequently, the charge stored during φ2 is\n\n$$\n\\begin{equation*}\nQ_{2}=(0) C_{1}+\\left(0-V_{o}\\right) C_{2}=\\left(0-V_{o}\\right) C_{2} \\tag{6.27}\n\\end{equation*}\n$$\n\nBecause the sampled charge appears on C1 during φ1 and on C2 during φ2, φ2 is known as the charge-transfer phase. By charge conservation, Q2 = Q1; thus,\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}} \\tag{6.28}\n\\end{equation*}\n$$\n\nIn (6.28), Vs represents the input voltage at the end of φ1, and Vo represents the output voltage at the end of φ2. The shape of the output voltage waveform is not predicted by (6.28) and depends on the rates at which the capacitors are charged and discharged. In practice, these rates depend on the bandwidth of the op amp and the resistances of the closed switches. The result in (6.28) is valid as long as the op amp is ideal, the input Vs is DC, and the durations over which φ1 and φ2 are high are sufficient to completely charge and discharge the associated capacitors. The ratio of Vo/Vs in (6.28) is positive because if Vs > 0 during φ1, the voltage applied between the left side of C1 and ground decreases from a positive value to zero during φ2. Therefore, this negative change in the applied voltage during φ2 is multiplied by a negative closed-loop amplifier gain, resulting in a positive ratio in (6.28).\n\nMOS technologies are particularly well-suited for constructing switched-capacitor circuits for two main reasons. Firstly, the DC current that flows into the input terminals of MOS op amps is zero as long as the inputs are connected exclusively to the gates of MOS transistors. In contrast, bipolar op amps have nonzero DC input currents that originate from finite βF in bipolar transistors. Secondly, the switches in Fig. 6.8 can be implemented without offset by utilizing MOS transistors, as demonstrated in Fig. 6.9a. The arrows indicating the source terminals of M1-M5 are arbitrarily chosen in the sense that the source and drain terminals are interchangeable. (Since the source is the source of electrons in n-channel transistors, the source-to-ground voltage is lower than the drain-to-ground voltage.) Assume that the clock voltages alternate between -VSS and VDD as shown in Fig. 6.9b. Also assume that all node voltages are no lower than -VSS and no higher than VDD. Furthermore, assume that the transistor threshold voltages are positive. Under these conditions, each transistor turns off when its gate is low. Additionally, each transistor turns on when its gate is high as long as its source operates at least a threshold below VDD. If Vs is a DC signal, all drain currents approach zero as the capacitors become charged. As the drain currents approach zero, the MOS transistors that are on operate in the triode region, where the drain-source voltage is zero when the drain current is zero. Therefore, the input voltage Vs is sampled onto C1 with zero offset inserted by the MOS transistors operating as switches. This property of MOS transistors is crucial in the implementation of switched-capacitor circuits. In contrast, bipolar transistors operating as switches do not yield zero collector-emitter voltage with zero collector current.\n\nThe switched-capacitor amplifier shown in Fig. $6.9 a$ is significant in practice primarily because the gain of this circuit is minimally affected by the various parasitic capacitances present at all nodes in the circuit. These unwanted capacitances are partly due to the drain-body and source-body junction capacitances of each transistor. Additionally, the op-amp input capacitance contributes to the parasitic capacitance at the op-amp input node. Furthermore, as described in Section 2.10.2, the bottom plates of capacitors C1 and C2 exhibit some capacitance to the underlying layer, which is the substrate or a well diffusion. Since the gain of the circuit is determined by charge conservation at the op-amp input node, the presence of parasitic capacitance from any node except the op-amp input to any node with a constant voltage to ground makes no difference to the accuracy of the circuit. (Such parasitics do reduce the maximum clock rate, however.) On the other hand, parasitic capacitance on the op-amp input node does affect the accuracy of the circuit gain, but the error is inversely proportional to the op-amp gain, as we will now demonstrate.\n\nLet $C_{P}$ denote the total parasitic capacitance from the op-amp input to all nodes with constant voltage to ground. If the op-amp gain is a, the voltage from the inverting op-amp input to ground during φ2 is given by (6.10). Therefore, with finite op-amp gain, C1 and CP are not fully discharged during φ2. Under these conditions, the charge stored on the op-amp input node during φ2 becomes\n\n$$\n\\begin{equation*}\nQ_{2}=\\left(-\\frac{V_{o}}{a}\\right) C_{1}+\\left(-\\frac{V_{o}}{a}\\right) CP+\\left(-\\frac{V_{o}}{a}-V_{o}\\right) C_{2} \\tag{6.29}\n\\end{equation*}\n$$\n\nWhen the op-amp gain becomes infinite, (6.29) reduces to (6.27), as expected. Setting Q2 in (6.29) equal to Q1 in (6.26) by charge conservation yields\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}}\\left[\\frac{1}{1+\\frac{1}{a}\\left(\\frac{C_{1}+C_{2}+CP}{C_{2}}\\right)}\\right] \\tag{6.30}\n\\end{equation*}\n$$\n\nThis closed-loop gain can be expressed as\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}}(1-\\epsilon) \\tag{6.31}\n\\end{equation*}\n$$\n\nwhere ε is a gain error defined by\n\n$$\n\\begin{equation*}\n\\epsilon=\\frac{1}{1+a\\left(\\frac{C_{2}}{C_{1}+C_{2}+CP}\\right)} \\tag{6.32}\n\\end{equation*}\n$$\n\nAs a approaches infinity, ε approaches 0, and the gain of the switched-capacitor amplifier approximates C1/C2 as predicted in (6.28). Hence, the circuit gain is said to be parasitic insensitive to an extent that depends on the op-amp gain.\n\nOne critical parameter of the switched-capacitor amplifier depicted in Fig. $6.9 a$ is the minimum clock period. This period is divided into two main segments, one for each clock phase. The duration of φ2 must be ample to allow the op-amp output to reach and maintain a specified level of accuracy. This time is defined as the op-amp settling time and depends on the switch resistances, the circuit capacitances, and the op-amp characteristics. The settling time is generally determined by SPICE simulations. Such simulations should be conducted for both clock phases since the op-amp output voltage during φ1 is not well-controlled in practice. If the op amp is ideal, this output voltage is zero. However, with a nonzero offset voltage, the output voltage will be driven to a nonzero value during φ1, which depends on both the offset voltage and the op-amp gain. If the op-amp gain is high, the offset can be large enough to force the output voltage to clip near one of the supplies. The output voltage at the end of φ1 can be regarded as an initial condition for the circuit during φ2. If the initial condition and the desired final output at the end of φ2 differ significantly, the time required for the output to reach a given level of accuracy during φ2 can be increased. Furthermore, a nonzero offset can increase the time required for the op-amp output voltage to reach a constant level during φ1. Although the circuit output voltage defined in (6.30) only appears during φ2, the inability to reach a constant output voltage during φ1 causes the initial condition defined above to vary, depending on the value of Vo at the end of the preceding φ2. As a result of this memory effect, the circuit can behave as a filter (which may be nonlinear), combining the results of more than one previous input sample to determine any given output. The key point is that an increase in the minimum duration of either phase necessitates an increase in the minimum clock period. This effect should be included in simulations by deliberately simulating with nonzero offset voltages.\n\nOne method to mitigate the effect of a nonzero offset voltage on the minimum clock period is to incorporate a reset switch at the op-amp output. If the op amp has a single-ended output as depicted in Fig. 6.9a, such a switch can be connected between the op-amp output and a bias point between the two supplies. Alternatively, if the op amp has differential outputs as described in Chapter 12, such a reset switch can be connected between the two op-amp outputs. In either case, the reset switch would be activated during φ1 and deactivated during φ2. The primary value of such a reset switch is that it can reduce both the maximum output voltage produced by a nonzero offset voltage during φ1 and the time required to reach this value, in turn reducing the impact of nonzero offset on the minimum durations of both phases.\n\nThe accuracy of the switched-capacitor amplifier depicted in Fig. $6.9 a$ is limited by several other factors that we will briefly discuss. Firstly, even with an ideal op amp, the gain depends on the ratio of capacitors C1/C2, which is not precisely controlled in practice due to random-mismatch effects. Secondly, op-amp offset restricts the minimum signal that can be distinguished from the offset in the switched-capacitor amplifier. As demonstrated in Section 3.5.6, the input-referred offset of CMOS differential pairs is typically worse than that for bipolar differential pairs. This property extends to op amps and stems partly from the reduced transconductance-to-current ratio of MOS transistors compared to their bipolar counterparts and partly from the threshold mismatch term, which appears only in the MOS case. Thirdly, the charge-conservation equation and accuracy of the switched-capacitor amplifier are influenced by the charge stored under the gates of some of the MOS transistors acting as switches in Fig. 6.9a. For example, some of the charge stored under the gate of transistor M3 in Fig. $6.9 a$ is injected onto the op-amp input node after M3 is turned off. Techniques to overcome these limitations are often used in practice but are not considered here.\n\n#### 6.1.7.2 Switched-Capacitor Integrator\n\nAnother application of internal op amps is the switched-capacitor integrator, which is depicted in its simplest form in Fig. 6.10a. This circuit is extensively used as the fundamental element of monolithic switched-capacitor filters for two primary reasons. Firstly, the frequency response of the integrator is insensitive to the various parasitic capacitances present at all nodes in the circuit. Secondly, employing switched-capacitor integrators as the basic elements makes the synthesis of desired filter frequency responses relatively straightforward. In this section, we will analyze the frequency response of the switched-capacitor integrator.\n\nThe integrator comprises an op amp, a sampling capacitor CS, an integrating capacitor CI, and four MOS transistor switches. The load capacitance depicted represents the sampling capacitor of the subsequent integrator, plus any parasitic capacitances that may be present. Typical values for the sampling, integrating, and load capacitances are indicated in Fig. 6.10a.\n\nFigure $6.10 b$ shows the timing diagram of two nonoverlapping clock signals, φ1 and φ2, that govern the operation of the circuit and typical input and output waveforms. During the period when clock phase φ1 is high, transistors M1 and M3 operate in the triode region and serve to charge the sampling capacitor to a voltage equal to the input voltage. Subsequently, clock signal φ1 falls. Then clock signal φ2 rises, prompting transistors M2 and M4 to turn on and connect the sampling capacitor between the inverting op-amp input, also known as the summing node, and ground. If the op amp is ideal, the resulting change in the summing-node voltage prompts the op-amp output to move such that the summing-node voltage is driven back to ground. After the transient has dissipated, the voltage across CS is driven to zero.\n\nTo determine the relationship between the input and output, a charge-conservation analysis is used. After transistor M1 opens in Fig. 6.10a, the charge on the plates of the capacitors connected to node Top and the inverting op-amp input is preserved until M1 closes again. Define time points [n"
},
{
    "text": "The specified objectives for operational amplifiers in a monolithic analog system often diverge significantly from the expectations for general-purpose op-amps that rely on external feedback components. Within a monolithic analog system, only a select number of amplifiers are required to convey a signal off-chip, where the capacitive and resistive loads are substantial and subject to change. These amplifiers will be referred to as output buffers, while those whose outputs remain on-chip will be known as internal amplifiers. Perhaps the most crucial distinction is the well-defined load that an internal amplifier must manage, which is typically purely capacitive and measures in the order of a few picofarads. In contrast, standalone general-purpose amplifiers are usually designed to meet a certain performance level that is unaffected by variations in capacitive loads of several hundred picofarads and resistive loads as low as $2 \\mathrm{k} \\Omega$.\n\n#### 6.1.7.1 Switched-Capacitor Amplifier\n\nIn MOS technologies, capacitors, rather than resistors, are frequently employed as passive components in feedback amplifiers due in part to their superiority as the best available passive elements. Furthermore, capacitors can store charge proportional to the amplitude of the analog signals of interest, and MOS transistors can serve as switches to interface with capacitors without offset and with minimal leakage, enabling discrete-time signal processing of analog quantities. MOS switched-capacitor amplifiers represent a critical application of internal amplifiers. Here, we introduce this application to elucidate the construction of MOS operational amplifiers.\n\nFigure 6.7 presents a block diagram of an inverting amplifier featuring capacitive feedback, in contrast to the resistive feedback depicted in Fig. 6.3a. For an ideal op amp, the amplification ratio from a change in the input voltage ΔVs to a change in the output voltage ΔVo is still expressed as the ratio of the impedance of the feedback element C2 to the impedance of the input element C1, or\n\n$$\n\\begin{equation*}\n\\frac{\\Delta V_{o}}{\\Delta V_{s}}=-\\frac{\\frac{1}{\\omega C_{2}}}{\\frac{1}{\\omega C_{1}}}=-\\frac{C_{1}}{C_{2}} \\tag{6.25}\n\\end{equation*}\n$$\n\nHowever, unlike scenarios where resistors are used as passive elements, this circuit does not supply DC bias for the inverting op-amp input because both capacitors exhibit infinite impedance at DC. To address this issue, switches controlled by a two-phase nonoverlapping clock are utilized to manage the operation of the aforementioned circuit. This circuit is recognized as a switched-capacitor amplifier.\n\nFigure $6.8 a$ exhibits a block diagram of a switched-capacitor amplifier. Each switch within the diagram is governed by one of the two clock phases φ1 and φ2, with the timing diagram presented in Fig. 6.8b. We will assume that a switch closes when its respective clock signal is high and opens when it is low. Given that φ1 and φ2 are never both high concurrently, the switches regulated by one clock phase are never closed simultaneously with the switches controlled by the other clock phase. Due to this characteristic, the clock signals in Fig. 6.8b are designated as nonoverlapping. For example, the upper terminal of C1 is linked to the input V_{s} through switch S1 when φ1 is elevated and to ground through switch S2 when φ2 is elevated, yet this node is never simultaneously connected to both the input and ground.\n\nTo streamline the explanation of the operation of switched-capacitor circuits, they are often redrawn twice, once for each nonoverlapping clock phase. Figures $6.8 c$ and $6.8 d$ illustrate the connections when φ1 is active (during φ1) and when φ2 is active (during φ2), respectively. Switches assumed to be closed are considered to be short circuits, and switches assumed to be open are considered to be open circuits.\n\nTo determine the output for a given input, a charge-conservation analysis is applied. Upon the opening of switch S3, the charge on the plates of capacitors connecting to the op-amp input node is conserved until this switch closes once more. This characteristic is partially due to the fact that the passive elements attached to the op-amp input node are capacitors, which conduct zero DC current. Additionally, if the op amp is constructed with an MOS differential input pair, the op-amp input is tied to the gate of one transistor in the differential pair, and the gate conducts zero DC current. Lastly, assuming switch S3 conducts zero current when it is open, the stored charge cannot leak away while S3 is open.\n\nSince both sides of C2 are grounded in Fig. 6.8c, the charge stored on the plates of the capacitors connected to the op-amp input node during φ1 is\n\n$$\n\\begin{equation*}\nQ_{1}=\\left(0-V_{s}\\right) C_{1}+(0) C_{2}=\\left(0-V_{s}\\right) C_{1} \\tag{6.26}\n\\end{equation*}\n$$\n\nAs the input voltage is sampled onto capacitor C1 during φ1, this phase is referred to as the input sample phase. If the op amp is ideal, the voltage V_{i} from the inverting op-amp input to ground is driven to zero by negative feedback during φ2. Consequently, the charge stored during φ2 is\n\n$$\n\\begin{equation*}\nQ_{2}=(0) C_{1}+\\left(0-V_{o}\\right) C_{2}=\\left(0-V_{o}\\right) C_{2} \\tag{6.27}\n\\end{equation*}\n$$\n\nBecause the sampled charge appears on C1 during φ1 and on C2 during φ2, φ2 is known as the charge-transfer phase. By charge conservation, Q2=Q1; thus,\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}} \\tag{6.28}\n\\end{equation*}\n$$\n\nIn (6.28), V_{s} represents the input voltage at the end of φ1, and V_{o} represents the output voltage at the end of φ2. The waveform shape of the output voltage is not predicted by (6.28) and depends on the rates at which capacitors are charged and discharged. In practice, these rates are determined by the bandwidth of the op amp and the resistances of the closed switches. The result in (6.28) is valid as long as the op amp is ideal, the input V_{s} is DC, and the durations over which φ1 and φ2 are high are long enough to fully charge and discharge the associated capacitors. The ratio of V_{o} / V_{s} in (6.28) is positive because if V_{s}>0 during φ1, the voltage applied between the left side of C1 and ground declines from a positive value to zero during φ2. Therefore, this negative change in the applied voltage during φ2 is multiplied by a negative closed-loop amplifier gain, yielding a positive ratio in (6.28).\n\nMOS technologies are well-suited for constructing switched-capacitor circuits for two principal reasons. Firstly, the DC current that flows into the input terminals of MOS op amps is zero as long as the inputs are linked solely to the gates of MOS transistors. In contrast, bipolar op amps have nonzero DC input currents derived from the finite β_{F} of bipolar transistors. Secondly, the switches in Fig. 6.8 can be implemented without offset by utilizing MOS transistors, as demonstrated in Fig. 6.9a. The arrows indicating the source terminals of M1-M5 are arbitrarily chosen in the sense that the source and drain terminals are interchangeable. (Since the source is the source of electrons in n-channel transistors, the source-to-ground voltage is lower than the drain-to-ground voltage.) Assume that the clock voltages alternate between $-V_{S S}$ and $V_{D D}$ as shown in Fig. 6.9b. Also assume that all node voltages are no lower than $-V_{S S}$ and no higher than $V_{D D}$. Finally, assume that the transistor threshold voltages are positive. Under these conditions, each transistor turns off when its gate is low. Furthermore, each transistor turns on when its gate is high as long as its source operates at least a threshold below $V_{D D}$. If $V_{s}$ is a DC signal, all drain currents approach zero as the capacitors become charged. As the drain currents approach zero, the MOS transistors that are on operate in the triode region, where the drain-source voltage is zero when the drain current is zero. Therefore, the input voltage $V_{s}$ is sampled onto $C_{1}$ with zero offset inserted by the MOS transistors operating as switches. This property of MOS transistors is significant in the implementation of switched-capacitor circuits. In contrast, bipolar transistors operating as switches do not yield zero collector-emitter voltage with zero collector current.\n\nThe switched-capacitor amplifier depicted in Fig. $6.9 a$ is significant in practice primarily because the gain of this circuit is minimally affected by the diverse parasitic capacitances present at all nodes in the circuit. These unintended capacitances arise partly from the drain-body and source-body junction capacitances of each transistor. Furthermore, the op-amp input capacitance contributes to the parasitic capacitance at the op-amp input node. Moreover, as described in Section 2.10.2, the lower plates of capacitors C1 and C2 exhibit some capacitance to the underlying layer, which is the substrate or a well diffusion. Since the gain of the circuit is determined by charge conservation at the op-amp input node, the presence of parasitic capacitance from any node except the op-amp input to any node with a constant voltage to ground is of no consequence to the accuracy of the circuit. (Such parasitics do decrease the maximum clock rate, however.) On the other hand, parasitic capacitance on the op-amp input node does impact the accuracy of the circuit gain, but the error is inversely proportional to the op-amp gain, as we will demonstrate now.\n\nLet $C_{P}$ denote the total parasitic capacitance from the op-amp input to all nodes with constant voltage to ground. If the op-amp gain is $a$, the voltage from the inverting op-amp input to ground during φ2 is given by (6.10). Therefore, with finite op-amp gain, C1 and $C_{P}$ are not entirely discharged during φ2. Under these circumstances, the charge stored on the op-amp input node during φ2 becomes\n\n$$\n\\begin{equation*}\nQ_{2}=\\left(-\\frac{V_{o}}{a}\\right) C_{1}+\\left(-\\frac{V_{o}}{a}\\right) C_{P}+\\left(-\\frac{V_{o}}{a}-V_{o}\\right) C_{2} \\tag{6.29}\n\\end{equation*}\n$$\n\nWhen the op-amp gain approaches infinity, (6.29) reverts to (6.27), as anticipated. Setting $Q_{2}$ in (6.29) equal to $Q_{1}$ in (6.26) by charge conservation yields\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}}\\left[\\frac{1}{1+\\frac{1}{a}\\left(\\frac{C_{1}+C_{2}+C_{P}}{C_{2}}\\right)}\\right] \\tag{6.30}\n\\end{equation*}\n$$\n\nThis closed-loop gain can be expressed as\n\n$$\n\\begin{equation*}\n\\frac{V_{o}}{V_{s}}=\\frac{C_{1}}{C_{2}}(1-\\epsilon) \\tag{6.31}\n\\end{equation*}\n$$\n\nwhere $\\epsilon$ is a gain error given by\n\n$$\n\\begin{equation*}\n\\epsilon=\\frac{1}{1+a\\left(\\frac{C_{2}}{C_{1}+C_{2}+C_{P}}\\right)} \\tag{6.32}\n\\end{equation*}\n$$\n\nAs $a \\rightarrow \\infty, \\epsilon \\rightarrow 0$, and the gain of the switched-capacitor amplifier approaches $C_{1} / C_{2}$ as predicted in (6.28). As a result, the circuit gain is said to be parasitic insensitive to an extent that depends on the op-amp gain.\n\nAn essential parameter of the switched-capacitor amplifier illustrated in Fig. $6.9 a$ is the minimum clock period. This period is divided into two primary segments, one for each clock phase. The duration of φ2 must be adequate for the op-amp output to reach and maintain a specified level of accuracy. This time is defined as the op-amp settling time and is contingent on the switch resistances, the circuit capacitances, and the op-amp attributes. The settling time is generally determined by SPICE simulations. Such simulations should be conducted for both clock phases because the op-amp output voltage during φ1 is not well-controlled in practice. If the op amp is ideal, this output voltage is zero. With nonzero offset voltage, however, the output voltage will be driven to a nonzero value during φ1, which depends on both the offset voltage and the op-amp gain. If the op-amp gain is substantial, the offset can easily be large enough to force the output voltage to clip near one of the supplies. The output voltage at the end of φ1 can be regarded as an initial condition for the circuit during φ2. If the initial condition and the desired final output at the end of φ2 are significantly different, the time required for the output to achieve a given level of accuracy during φ2 can increase. Moreover, nonzero offset can augment the time required for the op-amp output voltage to reach a steady level during φ1. Although the circuit output voltage defined in (6.30) only appears during φ2, failure to reach a constant output voltage during φ1 causes the initial condition defined above to fluctuate, depending on the value of V_{o} at the end of the preceding φ2. Due to this memory effect, the circuit can act as a filter (which may be nonlinear), combining the outcomes of more than one prior input sample to determine any given output. The critical point is that an increase in the minimum duration of either phase necessitates an increase in the minimum clock period. This effect should be integrated into simulations by intentionally simulating with nonzero offset voltages.\n\nOne method to mitigate the impact of nonzero offset voltage on the minimum clock period is to incorporate a reset switch at the op-amp output. If the op amp has a single-ended output as shown in Fig. 6.9a, such a switch can be connected between the op-amp output and a bias point between the two supplies. Alternatively, if the op amp has differential outputs as described in Chapter 12, such a reset switch can be connected between the two op-amp outputs. In either case, the reset switch would be activated during φ1 and deactivated during φ2. The primary benefit of such a reset switch is that it can decrease both the maximum output voltage generated by a nonzero offset voltage during φ1 and the time required to reach this value, in turn reducing the effect of nonzero offset on the minimum durations of both phases.\n\nThe accuracy of the switched-capacitor amplifier depicted in Fig. $6.9 a$ is limited by several other factors that we will briefly discuss now. First, even with an ideal op amp, the gain depends on the ratio of capacitors $C_{1} / C_{2}$, which is not perfectly controlled in practice due to random-mismatch effects. Second, op-amp offset imposes a limit on the minimum signal that can be distinguished from the offset in the switched-capacitor amplifier. As shown in Section 3.5.6, the input-referred offset of CMOS differential pairs is typically poorer than that of bipolar differential pairs. This characteristic extends to op amps and is partly due to the lower transconductance-to-current ratio of MOS transistors compared to their bipolar counterparts and partly due to the threshold mismatch term, which is unique to the MOS case. Third, the charge-conservation equation and accuracy of the switched-capacitor amplifier are affected by the charge stored under the gates of some of the MOS transistors serving as switches in Fig. 6.9a. For instance, some of the charge stored under the gate of transistor M3 in Fig. $6.9 a$ is injected into the op-amp input node after M3 is turned off. Techniques to overcome these limitations are commonly employed in practice but are not explored here.\n\n#### 6.1.7.2 Switched-Capacitor Integrator\n\nAn additional application of an internal op amp is the switched-capacitor integrator, exemplified in its most basic form in Fig. 6.10a. This circuit is extensively employed as the fundamental building block of monolithic switched-capacitor filters for two primary reasons. First, the frequency response of the integrator is insensitive to the various parasitic capacitances present at all nodes in the circuit. Second, employing switched-capacitor integrators as the basic elements simplifies the synthesis of desired filter frequency responses. In this section, we will analyze the frequency response of the switched-capacitor integrator.\n\nThe integrator is composed of an op amp, a sampling capacitor $C_{S}$, an integrating capacitor $C_{I}$, and four MOS transistor switches. The load capacitance depicted represents the sampling capacitor of the subsequent integrator, plus any parasitic capacitances that may be present. Typical values for the sampling, integrating, and load capacitances are labeled in Fig. 6.10a.\n\nFigure $6.10 b$ illustrates the timing diagram of two nonoverlapping clock signals, $\\phi_{1}$ and $\\phi_{2}$, that govern the operation of the circuit and display typical input and output waveforms. During the interval when clock phase $\\phi_{1}$ is high, transistors M1 and M3 operate in the triode region and serve to charge the sampling capacitor to a voltage equal to the input voltage. Subsequently, clock signal $\\phi_{1}$ falls. Then, clock signal $\\phi_{2}$ rises, triggering transistors M2 and M4 to activate and the sampling capacitor to be connected between the inverting op-amp input, referred to as the summing node, and ground. If the op amp is ideal, the resulting\n```"
},
{
    "text": "An input stage for a bipolar transistor operational amplifier is depicted in Fig. 6.11. Here, $Q_{1}$ and $Q_{2}$ serve as the input transistors of the amplifier. The base currents of $Q_{1}$ and $Q_{2}$ enter the amplifier's input terminals, and the input bias current is defined as the average of these two currents:\n\n$$\n\\begin{equation*}\nI_{\\mathrm{BIAS}}=\\frac{I_{B 1}+I_{B 2}}{2} \\tag{6.41}\n\\end{equation*}\n$$\n\nA nonzero bias current contradicts the assumption in summing-point analysis that no current flows into the input terminals. Typical values for the bias current range from 10 to 100 nA\nimage_name:Figure 6.11 Typical op-amp input stage\ndescription:\n[\nname: Q1, type: NPN, ports: {C: InP(A0), B: Vin, E: e1e2}\nname: Q2, type: NPN, ports: {C: InN(A0), B: Vip, E: e1e2}\nname: RC1, type: Resistor, value: RC1, ports: {N1: InP(A0), N2: VCC}\nname: RC2, type: Resistor, value: RC2, ports: {N1: InN(A0), N2: VCC}\nname: IEE, type: CurrentSource, value: IEE, ports: {Np: e1e2, Nn: GND}\nname: A0, type: OpAmp, value: A0, ports: {InP: InP(A0), InN: InN(A0), OutP: Vout}\n]\nextrainfo:The circuit represents a standard op-amp input stage featuring bipolar NPN transistors as the input devices. It incorporates biasing resistors RC1 and RC2, along with a current source IEE. The circuit is powered by VCC and VEE.\n\nFigure 6.11 Typical op-amp input stage.\nfor bipolar input devices and less than 0.001 pA for MOS input devices. In DC inverting and noninverting amplifiers, this bias current can lead to unwanted voltage drops across the resistors in the feedback network, resulting in a residual DC voltage at the output even when the amplifier is ideal in all other aspects and the external input voltage is zero. In integrator circuits, the input bias current is indistinguishable from the current being integrated, causing the output voltage to change at a steady rate even when $V_{s}$ is zero. If the currents in the two input leads are equal, their effects can be neutralized in some applications by adding a balancing resistor in series with one of the input leads, ensuring the same resistance is seen from each op-amp input. For instance, the differential amplifier in Fig. 6.4 yields zero output when $V_{1}=V_{2}=0$ if identical currents flow through both op-amp input leads. However, in practice, the two input currents are not perfectly equal due to random mismatches, leading to a nonzero output in Fig. 6.4 when $V_{1}=V_{2}=0$."
},
{
    "text": "An input stage for a bipolar transistor operational amplifier is depicted in Fig. 6.11. Here, $Q_{1}$ and $Q_{2}$ serve as the input transistors of the amplifier. The base currents of $Q_{1}$ and $Q_{2}$ flow into the amplifier's input terminals, and the input bias current is defined as the average of these two currents:\n\n$$\n\\begin{equation*}\nI_{\\mathrm{BIAS}}=\\frac{I_{B 1}+I_{B 2}}{2} \\tag{6.41}\n\\end{equation*}\n$$\n\nA nonzero bias current contradicts the assumption in summing-point analysis that the current into the input terminals is zero. Typical values for the bias current range from 10 to 100 nA\nimage_name:Figure 6.11 Typical op-amp input stage\ndescription:\n[\nname: Q1, type: NPN, ports: {C: InP(A0), B: Vin, E: e1e2}\nname: Q2, type: NPN, ports: {C: InN(A0), B: Vip, E: e1e2}\nname: RC1, type: Resistor, value: RC1, ports: {N1: InP(A0), N2: VCC}\nname: RC2, type: Resistor, value: RC2, ports: {N1: InN(A0), N2: VCC}\nname: IEE, type: CurrentSource, value: IEE, ports: {Np: e1e2, Nn: GND}\nname: A0, type: OpAmp, value: A0, ports: {InP: InP(A0), InN: InN(A0), OutP: Vout}\n]\nextrainfo:The circuit represents a typical op-amp input stage using bipolar NPN transistors as input devices. It incorporates biasing resistors RC1 and RC2, along with a current source IEE. The circuit is powered by VCC and VEE.\n\nFigure 6.11 Typical op-amp input stage.\nfor bipolar input devices and less than 0.001 pA for MOS input devices. In DC inverting and noninverting amplifiers, this bias current can lead to unwanted voltage drops across the resistors in the feedback network, resulting in a residual DC voltage at the output even when the amplifier is otherwise ideal and the external input voltage is zero. In integrator circuits, the input bias current is indistinguishable from the current being integrated, causing the output voltage to change at a constant rate even when $V_{s}$ is zero. However, if the currents in the two input leads are equal, their effects can be neutralized in some applications by adding a balancing resistor in series with one of the input leads, ensuring the same resistance is seen from each op-amp input. For instance, the differential amplifier in Fig. 6.4 yields zero output with $V_{1}=V_{2}=0$ if identical currents flow in both op-amp input leads. In practice, though, the two input currents are not exactly equal due to random mismatches, leading to a nonzero output in Fig. 6.4 when $V_{1}=V_{2}=0$."
},
{
    "text": "An input stage for a bipolar transistor operational amplifier is depicted in Fig. 6.11. Here, $Q_{1}$ and $Q_{2}$ serve as the input transistors of the amplifier. The base currents of $Q_{1}$ and $Q_{2}$ flow into the amplifier's input terminals, and the input bias current is defined as the average of these two currents:\n\n$$\n\\begin{equation*}\nI_{\\mathrm{BIAS}}=\\frac{I_{B 1}+I_{B 2}}{2} \\tag{6.41}\n\\end{equation*}\n$$\n\nA nonzero bias current contradicts the assumption in summing-point analysis that the current into the input terminals is zero. Typical values for the bias current range from 10 to 100 nA\nimage_name: Figure 6.11 Typical op-amp input stage\ndescription:\n[\nname: Q1, type: NPN, ports: {C: InP(A0), B: Vin, E: e1e2}\nname: Q2, type: NPN, ports: {C: InN(A0), B: Vip, E: e1e2}\nname: RC1, type: Resistor, value: RC1, ports: {N1: InP(A0), N2: VCC}\nname: RC2, type: Resistor, value: RC2, ports: {N1: InN(A0), N2: VCC}\nname: IEE, type: CurrentSource, value: IEE, ports: {Np: e1e2, Nn: GND}\nname: A0, type: OpAmp, value: A0, ports: {InP: InP(A0), InN: InN(A0), OutP: Vout}\n]\nextrainfo: This circuit represents a typical op-amp input stage using bipolar NPN transistors as input devices. It incorporates biasing resistors RC1 and RC2, along with a current source IEE. The circuit is powered by VCC and VEE.\n\nFigure 6.11 Typical op-amp input stage.\nfor bipolar input devices and less than 0.001 pA for MOS input devices. In DC inverting and noninverting amplifiers, this bias current can lead to unwanted voltage drops across the resistors in the feedback network, resulting in a residual DC voltage at the output even when the amplifier is ideal in all other aspects and the external input voltage is zero. In integrator circuits, the input bias current is indistinguishable from the current being integrated, causing the output voltage to change at a constant rate even when $V_{s}$ is zero. However, if the currents in the two input leads are equal, their effects can be neutralized in some applications by adding a balancing resistor in series with one of the input leads, ensuring the same resistance is seen from each op-amp input. For instance, the differential amplifier in Fig. 6.4 yields zero output when $V_{1}=V_{2}=0$ if identical currents flow in both op-amp input leads. In practice, though, the two input currents are not exactly equal due to random mismatches, leading to a nonzero output in Fig. 6.4 when $V_{1}=V_{2}=0$."
},
{
    "text": "An input stage for a bipolar transistor operational amplifier is depicted in Fig. 6.11. In this configuration, $Q_{1}$ and $Q_{2}$ serve as the input transistors of the amplifier. The base currents of $Q_{1}$ and $Q_{2}$ enter the amplifier's input terminals, and the input bias current is calculated as the average of these two currents:\n\n$$\n\\begin{equation*}\nI_{\\mathrm{BIAS}}=\\frac{I_{B 1}+I_{B 2}}{2} \\tag{6.41}\n\\end{equation*}\n$$\n\nA nonzero bias current contradicts the assumption in summing-point analysis that the current entering the input terminals is zero. Typically, the bias current ranges from 10 to 100 nA\nimage_name:Figure 6.11 Typical op-amp input stage\ndescription:\n[\nname: Q1, type: NPN, ports: {C: InP(A0), B: Vin, E: e1e2}\nname: Q2, type: NPN, ports: {C: InN(A0), B: Vip, E: e1e2}\nname: RC1, type: Resistor, value: RC1, ports: {N1: InP(A0), N2: VCC}\nname: RC2, type: Resistor, value: RC2, ports: {N1: InN(A0), N2: VCC}\nname: IEE, type: CurrentSource, value: IEE, ports: {Np: e1e2, Nn: GND}\nname: A0, type: OpAmp, value: A0, ports: {InP: InP(A0), InN: InN(A0), OutP: Vout}\n]\nextrainfo:The circuit represents a standard op-amp input stage featuring bipolar NPN transistors as the input devices. It incorporates biasing resistors RC1 and RC2, along with a current source IEE. The circuit operates with power supplies VCC and VEE.\n\nFigure 6.11 Typical op-amp input stage.\nfor bipolar input devices, whereas for MOS input devices, it is less than 0.001 pA. In both dc inverting and noninverting amplifiers, this bias current can lead to unwanted voltage drops across the resistors in the feedback network, resulting in a residual dc voltage at the output even when the amplifier is otherwise ideal and the external input voltage is zero. In integrator circuits, the input bias current cannot be distinguished from the current being integrated, causing the output voltage to change at a steady rate even when $V_{s}$ is zero. However, if the currents in the two input leads are equal, their effects can be neutralized in certain applications by adding a balancing resistor in series with one of the input leads, ensuring equal resistance is seen from each op-amp input. For instance, the differential amplifier in Fig. 6.4 yields zero output when $V_{1}=V_{2}=0$ if identical currents flow through both op-amp input leads. In practice, though, the two input currents are not perfectly matched due to random mismatches, leading to a nonzero output in Fig. 6.4 when $V_{1}=V_{2}=0$."
},
{
    "text": "An input stage for a bipolar transistor operational amplifier is depicted in Fig. 6.11. Here, $Q_{1}$ and $Q_{2}$ serve as the input transistors of the amplifier. The base currents of $Q_{1}$ and $Q_{2}$ enter the amplifier's input terminals, and the input bias current is defined as the average of these two currents:\n\n$$\n\\begin{equation*}\nI_{\\mathrm{BIAS}}=\\frac{I_{B 1}+I_{B 2}}{2} \\tag{6.41}\n\\end{equation*}\n$$\n\nA nonzero bias current contradicts the assumption in summing-point analysis that the current into the input terminals is zero. Typical values for the bias current range from 10 to 100 nA\nimage_name: Figure 6.11 Typical op-amp input stage\ndescription:\n[\nname: Q1, type: NPN, ports: {C: InP(A0), B: Vin, E: e1e2}\nname: Q2, type: NPN, ports: {C: InN(A0), B: Vip, E: e1e2}\nname: RC1, type: Resistor, value: RC1, ports: {N1: InP(A0), N2: VCC}\nname: RC2, type: Resistor, value: RC2, ports: {N1: InN(A0), N2: VCC}\nname: IEE, type: CurrentSource, value: IEE, ports: {Np: e1e2, Nn: GND}\nname: A0, type: OpAmp, value: A0, ports: {InP: InP(A0), InN: InN(A0), OutP: Vout}\n]\nextrainfo: This circuit represents a typical op-amp input stage featuring bipolar NPN transistors as input devices. It incorporates biasing resistors RC1 and RC2, along with a current source IEE. The circuit is powered by VCC and VEE.\n\nFigure 6.11 Typical op-amp input stage.\nfor bipolar input devices and less than 0.001 pA for MOS input devices. In dc inverting and noninverting amplifiers, this bias current can lead to unwanted voltage drops across the resistors in the feedback network, resulting in a residual dc voltage at the output even when the amplifier is otherwise ideal and the external input voltage is zero. In integrator circuits, the input bias current cannot be distinguished from the current being integrated, causing the output voltage to change at a constant rate even when $V_{s}$ is zero. If the currents in the two input leads are equal, their effects can be neutralized in some applications by adding a balancing resistor in series with one input lead, ensuring identical resistance is seen from each op-amp input. For instance, the differential amplifier in Fig. 6.4 yields zero output with $V_{1}=V_{2}=0$ if identical currents flow in both op-amp input leads. In practice, however, the two input currents are not perfectly equal due to random mismatches, leading to a nonzero output in Fig. 6.4 when $V_{1}=V_{2}=0$."
},
{
    "text": "An input stage for a bipolar transistor operational amplifier is depicted in Fig. 6.11. Here, $Q_{1}$ and $Q_{2}$ serve as the input transistors for the amplifier. The base currents of $Q_{1}$ and $Q_{2}$ enter the amplifier's input terminals, and the input bias current is calculated as the average of these two currents:\n\n$$\n\\begin{equation*}\nI_{\\mathrm{BIAS}}=\\frac{I_{B 1}+I_{B 2}}{2} \\tag{6.41}\n\\end{equation*}\n$$\n\nA nonzero bias current contradicts the assumption in summing-point analysis that the current into the input terminals is zero. Typical values for the bias current range from 10 to 100 nA\nimage_name:Figure 6.11 Typical op-amp input stage\ndescription:\n[\nname: Q1, type: NPN, ports: {C: InP(A0), B: Vin, E: e1e2}\nname: Q2, type: NPN, ports: {C: InN(A0), B: Vip, E: e1e2}\nname: RC1, type: Resistor, value: RC1, ports: {N1: InP(A0), N2: VCC}\nname: RC2, type: Resistor, value: RC2, ports: {N1: InN(A0), N2: VCC}\nname: IEE, type: CurrentSource, value: IEE, ports: {Np: e1e2, Nn: GND}\nname: A0, type: OpAmp, value: A0, ports: {InP: InP(A0), InN: InN(A0), OutP: Vout}\n]\nextrainfo:The circuit represents a standard op-amp input stage featuring bipolar NPN transistors as the input devices. It incorporates biasing resistors RC1 and RC2, along with a current source IEE. The circuit is powered by VCC and VEE.\n\nFigure 6.11 Typical op-amp input stage.\nfor bipolar input devices and less than 0.001 pA for MOS input devices. In DC inverting and noninverting amplifiers, this bias current can lead to unwanted voltage drops across the resistors in the feedback network, resulting in a residual DC voltage at the output even when the amplifier is otherwise ideal and the external input voltage is zero. In integrator circuits, the input bias current cannot be distinguished from the current being integrated, causing the output voltage to change at a steady rate even when $V_{s}$ is zero. However, if the currents in the two input leads are equal, their effects can be neutralized in some applications by adding a balancing resistor in series with one of the input leads, ensuring equal resistance is seen from each op-amp input. For instance, the differential amplifier in Fig. 6.4 yields zero output when $V_{1}=V_{2}=0$ if identical currents flow through both op-amp input leads. In practice, though, the two input currents are not perfectly equal due to random mismatches, leading to a nonzero output in Fig. 6.4 when $V_{1}=V_{2}=0$."
},
{
    "text": "An input stage for a bipolar transistor operational amplifier is depicted in Fig. 6.11. Here, $Q_{1}$ and $Q_{2}$ serve as the input transistors of the amplifier. The base currents of $Q_{1}$ and $Q_{2}$ enter the amplifier's input terminals, and the input bias current is defined as the average of these two currents:\n\n$$\n\\begin{equation*}\nI_{\\mathrm{BIAS}}=\\frac{I_{B 1}+I_{B 2}}{2} \\tag{6.41}\n\\end{equation*}\n$$\n\nA nonzero bias current contradicts the assumption in summing-point analysis that the current into the input terminals is zero. Typical values for the bias current range from 10 to 100 nA for bipolar input devices and less than 0.001 pA for MOS input devices. In DC inverting and noninverting amplifiers, this bias current can induce unwanted voltage drops across the resistors in the feedback network, resulting in a residual DC voltage at the output even when the amplifier is otherwise ideal and the external input voltage is zero. In integrator circuits, the input bias current is indistinguishable from the current being integrated, causing the output voltage to change at a constant rate even when $V_{s}$ is zero. However, if the currents in the two input leads are equal, their effects can be neutralized in some applications by incorporating a balancing resistor in series with one of the input leads, ensuring identical resistance is seen from each op-amp input. For instance, the differential amplifier in Fig. 6.4 yields zero output when $V_{1}=V_{2}=0$ if identical currents flow in both op-amp input leads. In practice, though, the two input currents are not precisely equal due to random mismatches, leading to a nonzero output in Fig. 6.4 when $V_{1}=V_{2}=0$."
},
{
    "text": "An input stage for a bipolar transistor operational amplifier is depicted in Fig. 6.11. Here, $Q_{1}$ and $Q_{2}$ serve as the input transistors for the amplifier. The base currents of $Q_{1}$ and $Q_{2}$ enter the amplifier's input terminals, and the input bias current is defined as the average of these two currents:\n\n$$\n\\begin{equation*}\nI_{\\mathrm{BIAS}}=\\frac{I_{B 1}+I_{B 2}}{2} \\tag{6.41}\n\\end{equation*}\n$$\n\nA nonzero bias current contradicts the assumption in summing-point analysis that the current into the input terminals is zero. Typically, the bias current ranges from 10 to 100 nA\nimage_name:Figure 6.11 Typical op-amp input stage\ndescription:\n[\nname: Q1, type: NPN, ports: {C: InP(A0), B: Vin, E: e1e2}\nname: Q2, type: NPN, ports: {C: InN(A0), B: Vip, E: e1e2}\nname: RC1, type: Resistor, value: RC1, ports: {N1: InP(A0), N2: VCC}\nname: RC2, type: Resistor, value: RC2, ports: {N1: InN(A0), N2: VCC}\nname: IEE, type: CurrentSource, value: IEE, ports: {Np: e1e2, Nn: GND}\nname: A0, type: OpAmp, value: A0, ports: {InP: InP(A0), InN: InN(A0), OutP: Vout}\n]\nextrainfo:The circuit represents a typical op-amp input stage featuring bipolar NPN transistors as input devices. It incorporates biasing resistors RC1 and RC2, along with a current source IEE. The circuit is powered by VCC and VEE.\n\nFigure 6.11 Typical op-amp input stage.\nfor bipolar input devices and less than 0.001 pA for MOS input devices. In DC inverting and noninverting amplifiers, this bias current can lead to unwanted voltage drops across the resistors in the feedback network, resulting in a residual DC voltage at the output even when the amplifier is otherwise ideal and the external input voltage is zero. In integrator circuits, the input bias current cannot be distinguished from the current being integrated, causing the output voltage to change at a steady rate even when $V_{s}$ is zero. However, if the currents in the two input leads are equal, their effects can be neutralized in some applications by adding a balancing resistor in series with one of the input leads, ensuring the same resistance is seen from each op-amp input. For instance, the differential amplifier in Fig. 6.4 yields zero output with $V_{1}=V_{2}=0$ if identical currents flow through both op-amp input leads. In practice, though, the two input currents are not perfectly equal due to random mismatches, leading to a nonzero output in Fig. 6.4 when $V_{1}=V_{2}=0$."
},
{
    "text": "For the emitter-coupled pair depicted in Fig. 6.11, the two input bias currents will be equal solely if the two transistors possess identical betas. Devices that are geometrically identical on the same IC die generally exhibit beta mismatches, which are characterized by a normal distribution with a standard deviation of a few percent of the mean value. Due to this random variation in the mismatch between the two currents from one circuit to another, it cannot be corrected by a fixed resistor. This facet of op-amp performance is quantified by the input offset current, defined as\n\n$$\n\\begin{equation*}\nI_{O S}=I_{B 1}-I_{B 2} \\tag{6.42}\n\\end{equation*}\n$$\n\nExamining the differential amplifier in Fig. 6.4, repeating the analysis from Section 6.1.4 for this circuit with a nonzero $I_{O S}$ and $V_{1}=V_{2}=0$ results in a dc output voltage of\n\n$$\n\\begin{equation*}\nV_{O}=\\left(I_{B 2}-I_{B 1}\\right) R_{2}=-I_{O S} R_{2} \\tag{6.43}\n\\end{equation*}\n$$\n\nIf $I_{O S}=0$, then $V_{O}=0$ in this scenario. This equation illustrates that the error in the dc output voltage is directly proportional to both the input offset current and the feedback resistance under these circumstances. The crucial takeaway is that the magnitude of the feedback resistance is constrained by the maximum possible offset current and the permissible error in the dc output voltage in practical applications. Refer to Problem 6.6 for further details."
},
{
    "text": "For the emitter-coupled pair depicted in Fig. 6.11, the two input bias currents will be equal solely if the two transistors possess identical betas. Geometrically similar devices on the same IC die generally exhibit beta mismatches, which are typically characterized by a normal distribution with a standard deviation of a few percent of the mean value. Given that this mismatch in the two currents varies randomly from one circuit to another, it cannot be corrected by a fixed resistor. This facet of op-amp performance is quantified by the input offset current, defined as\n\n$$\n\\begin{equation*}\nI_{O S}=I_{B 1}-I_{B 2} \\tag{6.42}\n\\end{equation*}\n$$\n\nExamining the differential amplifier shown in Fig. 6.4, reiterating the analysis from Section 6.1.4 for that circuit with a nonzero $I_{O S}$ and $V_{1}=V_{2}=0$ results in a dc output voltage of\n\n$$\n\\begin{equation*}\nV_{O}=\\left(I_{B 2}-I_{B 1}\\right) R_{2}=-I_{O S} R_{2} \\tag{6.43}\n\\end{equation*}\n$$\n\nIf $I_{O S}=0$, then $V_{O}=0$ in this scenario. This equation illustrates that the error in the dc output voltage is directly proportional to both the input offset current and the feedback resistance under these conditions. The crucial takeaway is that the magnitude of the feedback resistance is constrained by the maximum possible offset current and the permissible error in the dc output voltage in practical applications. Refer to Problem 6.6 for further details."
},
{
    "text": "In the emitter-coupled pair depicted in Fig. 6.11, the two input bias currents will be equal solely if the transistors possess identical betas. Devices that are geometrically identical on the same IC die generally exhibit beta mismatches, which follow a normal distribution with a standard deviation of a few percent of the mean. Due to this random variation in the current mismatch from one circuit to another, it cannot be corrected using a fixed resistor. This characteristic of op-amp performance is quantified by the input offset current, defined as:\n\n$$\n\\begin{equation*}\nI_{O S}=I_{B 1}-I_{B 2} \\tag{6.42}\n\\end{equation*}\n$$\n\nExamining the differential amplifier in Fig. 6.4, reapplying the analysis from Section 6.1.4 for the circuit with a nonzero $I_{O S}$ and $V_{1}=V_{2}=0$ results in a dc output voltage of:\n\n$$\n\\begin{equation*}\nV_{O}=\\left(I_{B 2}-I_{B 1}\\right) R_{2}=-I_{O S} R_{2} \\tag{6.43}\n\\end{equation*}\n$$\n\nWhen $I_{O S}=0$, $V_{O}$ also equals zero. This equation indicates that the error in the dc output voltage is directly proportional to both the input offset current and the feedback resistance under these circumstances. The critical takeaway is that the magnitude of the feedback resistance is constrained by the maximum possible offset current and the permissible error in the dc output voltage in practical applications. Refer to Problem 6.6 for further details."
},
{
    "text": "For the emitter-coupled pair depicted in Fig. 6.11, the two input bias currents will only be equal if the two transistors possess identical betas. Devices that are geometrically identical on the same IC die usually exhibit beta mismatches, which are characterized by a normal distribution with a standard deviation of a few percent of the mean value. Due to this random variation in the mismatch between the two currents from one circuit to another, it cannot be corrected using a fixed resistor. This aspect of op-amp performance is quantified by the input offset current, defined as\n\n$$\n\\begin{equation*}\nI_{O S}=I_{B 1}-I_{B 2} \\tag{6.42}\n\\end{equation*}\n$$\n\nNow, consider the differential amplifier shown in Fig. 6.4. Repeating the analysis from Section 6.1.4 for this circuit with a nonzero $I_{O S}$ and $V_{1}=V_{2}=0$ results in a dc output voltage of\n\n$$\n\\begin{equation*}\nV_{O}=\\left(I_{B 2}-I_{B 1}\\right) R_{2}=-I_{O S} R_{2} \\tag{6.43}\n\\end{equation*}\n$$\n\nIf $I_{O S}=0$, then $V_{O}=0$ in this scenario. This equation indicates that the error in the dc output voltage is directly proportional to both the input offset current and the feedback resistance under these conditions. The crucial point is that the magnitude of the feedback resistance is constrained by the maximum possible offset current and the permissible error in the dc output voltage in practical applications. Refer to Problem 6.6 for further details."
},
{
    "text": "For the emitter-coupled pair depicted in Fig. 6.11, the two input bias currents will be identical only if the two transistors possess equal betas. Devices that are geometrically identical on the same IC die generally exhibit beta mismatches, which are characterized by a normal distribution with a standard deviation of a few percent of the mean value. Due to the random variation of this mismatch in the two currents from one circuit to another, it cannot be corrected by a fixed resistor. This aspect of op-amp performance is quantified by the input offset current, defined as\n\n$$\n\\begin{equation*}\nI_{O S}=I_{B 1}-I_{B 2} \\tag{6.42}\n\\end{equation*}\n$$\n\nExamine the differential amplifier in Fig. 6.4. Repeating the analysis from Section 6.1.4 for this circuit with a nonzero $I_{O S}$ and $V_{1}=V_{2}=0$ results in a dc output voltage of\n\n$$\n\\begin{equation*}\nV_{O}=\\left(I_{B 2}-I_{B 1}\\right) R_{2}=-I_{O S} R_{2} \\tag{6.43}\n\\end{equation*}\n$$\n\nIf $I_{O S}=0$, then $V_{O}=0$ in this scenario. This equation indicates that the error in the dc output voltage is directly proportional to both the input offset current and the feedback resistance under these conditions. The crucial takeaway is that the magnitude of the feedback resistance is constrained by the maximum possible offset current and the permissible error in the dc output voltage in practical applications. Refer to Problem 6.6 for further details."
},
{
    "text": "For the emitter-coupled pair depicted in Fig. 6.11, the two input bias currents will be equal solely if the two transistors possess identical betas. Devices that are geometrically identical on the same IC die generally exhibit beta mismatches, which are characterized by a normal distribution with a standard deviation of a few percent of the mean value. As this mismatch in the two currents varies randomly from one circuit to another, it cannot be corrected by a fixed resistor. This aspect of op-amp performance is quantified by the input offset current, defined as\n\n$$\n\\begin{equation*}\nI_{O S}=I_{B 1}-I_{B 2} \\tag{6.42}\n\\end{equation*}\n$$\n\nConsider the differential amplifier illustrated in Fig. 6.4. Repeating the analysis from Section 6.1.4 for this circuit with a nonzero $I_{O S}$ and $V_{1}=V_{2}=0$ results in a dc output voltage of\n\n$$\n\\begin{equation*}\nV_{O}=\\left(I_{B 2}-I_{B 1}\\right) R_{2}=-I_{O S} R_{2} \\tag{6.43}\n\\end{equation*}\n$$\n\nIf $I_{O S}=0$, then $V_{O}=0$ in this scenario. This equation indicates that the error in the dc output voltage is directly proportional to both the input offset current and the feedback resistance under these conditions. The crucial point is that the magnitude of the feedback resistance is constrained by the maximum possible offset current and the permissible error in the dc output voltage in practical applications. Refer to Problem 6.6 for further details."
},
{
    "text": "For the emitter-coupled pair depicted in Fig. 6.11, the two input bias currents will be identical only if the transistors possess equal betas. Geometrically similar devices on the same IC die generally exhibit beta mismatches, which follow a normal distribution with a standard deviation of a few percent of the mean value. Because this discrepancy in the two currents varies randomly from one circuit to another, it cannot be corrected using a fixed resistor. This facet of op-amp performance is quantified by the input offset current, defined as\n\n$$\n\\begin{equation*}\nI_{O S}=I_{B 1}-I_{B 2} \\tag{6.42}\n\\end{equation*}\n$$\n\nExamine the differential amplifier in Fig. 6.4. Repeating the analysis from Section 6.1.4 for this circuit with a nonzero $I_{O S}$ and $V_{1}=V_{2}=0$ results in a dc output voltage of\n\n$$\n\\begin{equation*}\nV_{O}=\\left(I_{B 2}-I_{B 1}\\right) R_{2}=-I_{O S} R_{2} \\tag{6.43}\n\\end{equation*}\n$$\n\nIf $I_{O S}=0$, then $V_{O}=0$ in this scenario. This equation indicates that the error in the dc output voltage is directly proportional to both the input offset current and the feedback resistance under these conditions. The crucial takeaway is that the magnitude of the feedback resistance is constrained by the maximum possible offset current and the permissible error in the dc output voltage in practical applications. Refer to Problem 6.6 for further details."
},
{
    "text": "For the emitter-coupled pair depicted in Fig. 6.11, the two input bias currents will be equivalent solely if the two transistors possess identical betas. Devices that are geometrically identical on the same IC die generally exhibit beta mismatches, which are characterized by a normal distribution with a standard deviation of a few percent of the mean value. Given that this mismatch in the two currents varies randomly from one circuit to another, it cannot be corrected by a fixed resistor. This facet of op-amp performance is quantified by the input offset current, defined as\n\n$$\n\\begin{equation*}\nI_{O S}=I_{B 1}-I_{B 2} \\tag{6.42}\n\\end{equation*}\n$$\n\nExamine the differential amplifier in Fig. 6.4. Repeating the analysis from Section 6.1.4 for this circuit with a nonzero $I_{O S}$ and $V_{1}=V_{2}=0$ results in a dc output voltage of\n\n$$\n\\begin{equation*}\nV_{O}=\\left(I_{B 2}-I_{B 1}\\right) R_{2}=-I_{O S} R_{2} \\tag{6.43}\n\\end{equation*}\n$$\n\nIf $I_{O S}=0$, then $V_{O}=0$ in this scenario. This equation indicates that the error in the dc output voltage is directly proportional to both the input offset current and the feedback resistance under these conditions. The crucial point is that the magnitude of the feedback resistance is constrained by the maximum possible offset current and the permissible error in the dc output voltage in practical applications. Refer to Problem 6.6 for further details."
},
{
    "text": "As detailed in Chapter 3, mismatches lead to a nonzero input offset voltage in amplifiers. This input offset voltage is the differential input voltage required to bring the output to zero. For untrimmed monolithic operational amplifiers, this offset generally ranges from 0.1 to 2 millivolts for bipolar input devices and from 1 to 20 millivolts for MOS input devices. This offset can be neutralized using an external potentiometer in standalone op amps; however, the temperature-induced variation of the offset (referred to as drift) does not necessarily消失 when the input offset is adjusted to zero. In direct current (dc) amplifier applications, both the offset and drift impose a minimum limit on the dc voltage that can be precisely amplified. In certain sampled-data applications, such as switched-capacitor filters, the op amp's input offset voltage is sampled and retained on the capacitors with each clock cycle. Consequently, the input offset is effectively neutralized and becomes a non-critical factor. This identical principle is applied in chopper-stabilized operational amplifiers."
},
{
    "text": "As outlined in Chapter 3, mismatches lead to a nonzero input offset voltage in amplifiers. This input offset voltage is the differential input voltage required to bring the output to zero. For untrimmed monolithic operational amplifiers, the offset usually ranges from 0.1 to 2 mV for bipolar input devices and from 1 to 20 mV for MOS input devices. While this offset can be neutralized using an external potentiometer in standalone op amps, the temperature-induced variation of the offset (referred to as drift) does not necessarily消失 even when the input offset is zeroed. In direct current (dc) amplifier applications, both the offset and drift impose a minimum limit on the dc voltage that can be precisely amplified. In certain sampled-data applications, such as switched-capacitor filters, the op amp's input offset voltage is sampled and stored on capacitors with each clock cycle. Consequently, the input offset is effectively neutralized and becomes a non-critical factor. This same principle is applied in chopper-stabilized operational amplifiers."
},
{
    "text": "As detailed in Chapter 3, mismatches lead to a nonzero input offset voltage in amplifiers. This input offset voltage is the differential input voltage required to bring the output to zero. For untrimmed monolithic operational amplifiers, the offset generally ranges from 0.1 to 2 mV for bipolar input devices and from 1 to 20 mV for MOS input devices. An external potentiometer can be used to nullify this offset in standalone op amps; however, the temperature-induced variation of the offset (referred to as drift) does not necessarily消失 when the input offset is zeroed. In direct current (dc) amplifier applications, both the offset and drift impose a minimum limit on the dc voltage that can be precisely amplified. In certain sampled-data applications, such as switched-capacitor filters, the op amp's input offset voltage is sampled and retained on the capacitors with each clock cycle, effectively canceling the input offset and rendering it a non-critical factor. This principle is also applied in chopper-stabilized op amps."
},
{
    "text": "As outlined in Chapter 3, mismatches lead to a nonzero input offset voltage in amplifiers. This input offset voltage is the differential input voltage required to bring the output to zero. For untrimmed monolithic operational amplifiers, the typical offset ranges from 0.1 to 2 mV for bipolar input devices and from 1 to 20 mV for MOS input devices. This offset can be neutralized using an external potentiometer in standalone op amps; however, the temperature-induced variation of the offset (referred to as drift) does not always消失 when the input offset is zeroed. In direct current (dc) amplifier applications, the offset and drift impose a minimum limit on the dc voltage that can be precisely amplified. In certain sampled-data applications, such as switched-capacitor filters, the op amp's input offset voltage is sampled and stored on capacitors with each clock cycle. Consequently, the input offset is effectively neutralized and becomes a non-critical parameter. This principle is also applied in chopper-stabilized operational amplifiers."
},
{
    "text": "As detailed in Chapter 3, mismatches lead to a nonzero input offset voltage in amplifiers. This input offset voltage is the differential input voltage required to bring the output to zero. For untrimmed monolithic operational amplifiers, the offset generally ranges from 0.1 to 2 mV for bipolar input devices and from 1 to 20 mV for MOS input devices. This offset can be neutralized using an external potentiometer in standalone op amps; however, the temperature-induced variation of the offset (referred to as drift) does not always消失 to zero even when the input offset is neutralized. In direct current (dc) amplifier applications, the offset and drift impose a minimum limit on the dc voltage magnitude that can be precisely amplified. In certain sampled-data applications, such as switched-capacitor filters, the op amp's input offset voltage is sampled and stored on the capacitors with each clock cycle. Consequently, the input offset is effectively negated and becomes a non-critical parameter. This identical principle is employed in chopper-stabilized operational amplifiers."
},
{
    "text": "As detailed in Chapter 3, mismatches lead to a nonzero input offset voltage in amplifiers. This input offset voltage is the differential input voltage required to bring the output to zero. For untrimmed monolithic operational amplifiers, the typical offset ranges from 0.1 to 2 mV for bipolar input devices and from 1 to 20 mV for MOS input devices. While this offset can be neutralized using an external potentiometer in standalone op amps, the temperature-induced variation of the offset (referred to as drift) does not necessarily消失even when the input offset is adjusted to zero. In direct current (dc) amplifier applications, the offset and drift impose a minimum limit on the dc voltage magnitude that can be precisely amplified. In certain sampled-data applications, such as switched-capacitor filters, the op amp's input offset voltage is sampled and retained on the capacitors with each clock cycle, effectively canceling out the input offset and rendering it a non-critical parameter. This principle is also applied in chopper-stabilized operational amplifiers."
},
{
    "text": "As detailed in Chapter 3, mismatches lead to a nonzero input offset voltage in amplifiers. This input offset voltage is the differential input voltage required to bring the output to zero. For untrimmed monolithic operational amplifiers, this offset generally ranges from 0.1 to 2 mV for bipolar input devices and from 1 to 20 mV for MOS input devices. An external potentiometer can be used to null this offset in standalone op amps; however, the temperature-induced variation of the offset (known as drift) does not necessarily消失 even when the input offset is nulled. In direct current (dc) amplifier applications, both the offset and drift impose a lower boundary on the dc voltage magnitude that can be precisely amplified. In certain sampled-data applications, such as switched-capacitor filters, the op amp's input offset voltage is sampled and stored on capacitors with each clock cycle. Consequently, the input offset is effectively neutralized and becomes a non-critical parameter. This principle is also applied in chopper-stabilized operational amplifiers."
},
{
    "text": "As detailed in Chapter 3, mismatches lead to a nonzero input offset voltage in amplifiers. This input offset voltage is the differential input voltage required to bring the output to zero. For untrimmed monolithic operational amplifiers, the typical offset ranges from 0.1 to 2 mV for bipolar input devices and from 1 to 20 mV for MOS input devices. An external potentiometer can nullify this offset in stand-alone op amps; however, the temperature-induced variation of the offset (known as drift) does not necessarily消失even when the input offset is zeroed. In direct current (dc) amplifier applications, both the offset and drift impose a minimum limit on the dc voltage that can be precisely amplified. In certain sampled-data applications, such as switched-capacitor filters, the op amp's input offset voltage is sampled and stored on capacitors during each clock cycle. Consequently, the input offset is effectively neutralized and becomes a non-critical parameter. This principle is also applied in chopper-stabilized operational amplifiers."
},
{
    "text": "The common-mode input range refers to the span of dc common-mode input voltages within which an op amp functions normally, maintaining its critical parameters like offset voltage and input bias current within specified limits. In the past, op amps were typically designed to operate with substantial equal-and-opposite power-supply voltages. For instance, the 741 op amp, detailed in earlier versions of this book, frequently used supply voltages of $\\pm 15 \\mathrm{~V}$, corresponding to a common-mode input range of around $\\pm 13 \\mathrm{~V}$. Conversely, contemporary op amps often function between ground and a single positive power-supply voltage of 3 V or lower. If the common-mode input range were restricted to 2 V above ground and 2 V below the positive supply, the input stage of such op amps would malfunction for any common-mode input voltage. While narrowing the gap between the common-mode input range and the supplies resolves this issue, the inverting amplifier setup depicted in Fig. $6.3 a$ cannot be employed without alterations when the op amp operates from a single nonzero supply voltage unless the common-mode input range is broadened to encompass ground. In practical applications, it is often crucial to include both power-supply voltages within the common-mode input range. For example, in the noninverting amplifier and voltage follower illustrated in Fig. 6.3b and Fig. 6.3c, respectively, the op-amp common-mode input voltage is roughly equivalent to $V_{s}$. Expanding the common-mode input range to cover both supplies eliminates an unnecessary constraint on op-amp performance in these configurations. Section 6.8 discusses an example op amp with this attribute, known as a rail-to-rail common-mode input range."
},
{
    "text": "The common-mode input range refers to the range of dc common-mode input voltages within which an op amp functions normally, keeping its key parameters like offset voltage and input bias current within specified limits. In the past, op amps were typically designed to operate with substantial equal-and-opposite power-supply voltages. For instance, the 741 op amp, covered in earlier versions of this book, frequently used supply voltages of $\\pm 15 \\mathrm{~V}$, resulting in a common-mode input range of around $\\pm 13 \\mathrm{~V}$. Conversely, contemporary op amps often run between ground and a single positive power-supply voltage of 3 V or lower. If the common-mode input range were confined to 2 V above ground and 2 V below the positive supply, the input stage of such op amps would malfunction for any common-mode input voltage. While narrowing the gap between the common-mode input range and the supplies addresses this issue, the inverting amplifier setup depicted in Fig. $6.3 a$ cannot be employed without adjustments when the op amp operates from a single nonzero supply voltage unless the common-mode input range is broadened to include ground. In practice, it is often crucial to incorporate both power-supply voltages within the common-mode input range. For example, in the noninverting amplifier and voltage follower illustrated in Fig. 6.3b and Fig. 6.3c, respectively, the op-amp common-mode input voltage roughly equals $V_{s}$. Expanding the common-mode input range to encompass both supplies prevents an unwarranted constraint on op-amp performance in these configurations. Section 6.8 discusses an example op amp with this capability, known as a rail-to-rail common-mode input range."
},
{
    "text": "The common-mode input range represents the span of dc common-mode input voltages within which an operational amplifier (op amp) functions normally, maintaining its critical parameters like offset voltage and input bias current within specified limits. In the past, op amps were typically designed to operate with substantial equal-and-opposite power-supply voltages. For instance, the 741 op amp, discussed in earlier versions of this book, frequently used supply voltages of $\\pm 15 \\mathrm{~V}$, corresponding to a common-mode input range of roughly $\\pm 13 \\mathrm{~V}$. Conversely, contemporary op amps often function between ground and a single positive power-supply voltage of 3 V or lower. If the common-mode input range were restricted to 2 V above ground and 2 V below the positive supply in such cases, the input stage of these op amps would malfunction for any common-mode input voltage. While narrowing the gap between the common-mode input range and the supply voltages addresses this issue, the inverting amplifier setup depicted in Fig. $6.3 a$ cannot be employed without adjustments when the op amp operates from a single nonzero supply voltage unless the common-mode input range encompasses ground. In practical scenarios, including both power-supply voltages within the common-mode input range is often crucial. For example, in the noninverting amplifier and voltage follower illustrated in Fig. 6.3b and Fig. 6.3c, respectively, the op-amp common-mode input voltage is nearly equivalent to $V_{s}$. Expanding the common-mode input range to cover both supplies eliminates an unwarranted constraint on op-amp performance in these configurations. Section 6.8 details an example of an op amp with this characteristic, known as a rail-to-rail common-mode input range."
},
{
    "text": "The common-mode input range represents the span of direct current common-mode input voltages within which an operational amplifier (op amp) functions correctly, maintaining its critical parameters like offset voltage and input bias current within specified limits. Historically, op amps were designed to operate with substantial equal-and-opposite power-supply voltages. For instance, the 741 op amp, discussed in earlier versions of this book, typically ran on supply voltages of $\\pm 15 \\mathrm{~V}$, corresponding to a common-mode input range of roughly $\\pm 13 \\mathrm{~V}$. However, contemporary op amps frequently operate between ground and a single positive power-supply voltage of 3 V or lower. If the common-mode input range were restricted to just 2 V above ground and 2 V below the positive supply, the input stage of such op amps would malfunction for any common-mode input voltage. While narrowing the gap between the common-mode input range and the supply voltages addresses this issue, the inverting amplifier setup depicted in Fig. $6.3a$ cannot be employed without adjustments when the op amp operates from a single nonzero supply voltage, unless the common-mode input range is broadened to encompass ground. In practical applications, it is often crucial to include both power-supply voltages within the common-mode input range. For example, in the noninverting amplifier and voltage follower illustrated in Fig. 6.3b and Fig. 6.3c, respectively, the op-amp common-mode input voltage closely matches $V_{s}$. Expanding the common-mode input range to cover both supplies eliminates an unwarranted constraint on op-amp performance in these configurations. Section 6.8 outlines an example of an op amp featuring this attribute, known as a rail-to-rail common-mode input range."
},
{
    "text": "The common-mode input range represents the span of dc common-mode input voltages within which an operational amplifier (op amp) functions normally, maintaining its critical parameters—such as offset voltage and input bias current—within specified limits. In the past, op amps were typically designed to operate with substantial equal-and-opposite power-supply voltages. For instance, the 741 op amp, detailed in earlier versions of this text, commonly used supply voltages of $\\pm 15 \\mathrm{~V}$, corresponding to a common-mode input range of roughly $\\pm 13 \\mathrm{~V}$. Conversely, contemporary op amps frequently operate between ground and a single positive power-supply voltage of 3 V or lower. If the common-mode input range were confined to just 2 V above ground and 2 V below the positive supply, the input stage of such op amps would malfunction for any common-mode input voltage. While narrowing the gap between the common-mode input range and the power supplies addresses this issue, the inverting amplifier setup depicted in Fig. $6.3 a$ cannot be employed without adjustments when the op amp runs on a single nonzero supply voltage, unless the common-mode input range is broadened to encompass ground. In practical applications, it is often crucial for the common-mode input range to include both power-supply voltages. For example, in the noninverting amplifier and voltage follower illustrated in Fig. 6.3b and Fig. 6.3c, respectively, the op-amp common-mode input voltage is roughly equivalent to $V_{s}$. Expanding the common-mode input range to cover both supplies eliminates an unwarranted constraint on op-amp performance in these configurations. Section 6.8 discusses an example of an op amp with this capability, known as a rail-to-rail common-mode input range."
},
{
    "text": "The common-mode input range defines the span of dc common-mode input voltages within which an op amp functions normally, maintaining its critical parameters like offset voltage and input bias current within specified limits. In the past, op amps were typically designed to operate with substantial equal-and-opposite power-supply voltages. For instance, the 741 op amp, detailed in earlier versions of this book, frequently used supply voltages of $\\pm 15 \\mathrm{~V}$, corresponding to a common-mode input range of roughly $\\pm 13 \\mathrm{~V}$. Conversely, contemporary op amps often function between ground and a single positive power-supply voltage of 3 V or lower. If the common-mode input range were restricted to 2 V above ground and 2 V below the positive supply, the input stage of such op amps would malfunction for any common-mode input voltage. While narrowing the gap between the common-mode input range and the supplies resolves this issue, the inverting amplifier setup depicted in Fig. $6.3 a$ cannot be employed without alterations when the op amp runs on a single nonzero supply voltage unless the common-mode input range is broadened to encompass ground. In practical scenarios, it is often crucial for the common-mode input range to include both power-supply voltages. For example, in the noninverting amplifier and voltage follower illustrated in Fig. 6.3b and Fig. 6.3c, respectively, the op-amp common-mode input voltage is nearly equivalent to $V_{s}$. Expanding the common-mode input range to cover both supplies prevents an unwarranted restriction on op-amp performance in these configurations. Section 6.8 discusses an exemplary op amp with this characteristic, known as a rail-to-rail common-mode input range."
},
{
    "text": "The common-mode input range is the span of dc common-mode input voltages within which an op amp functions normally, maintaining its key parameters like offset voltage and input bias current within specified limits. In the past, op amps were typically designed to operate with substantial equal-and-opposite power-supply voltages. For instance, the 741 op amp, discussed in earlier versions of this book, commonly ran on supply voltages of $\\pm 15 \\mathrm{~V}$, resulting in a common-mode input range around $\\pm 13 \\mathrm{~V}$. Conversely, contemporary op amps frequently operate between ground and a single positive power-supply voltage of 3 V or lower. If the common-mode input range were confined to 2 V above ground and 2 V below the positive supply, the input stage of such op amps would malfunction for any common-mode input voltage. While narrowing the gap between the common-mode input range and the supplies resolves this issue, the inverting amplifier setup depicted in Fig. $6.3 a$ cannot be employed without adjustments when the op amp operates from a single nonzero supply voltage unless the common-mode input range is broadened to encompass ground. In practice, incorporating both power-supply voltages within the common-mode input range is often crucial. For example, in the noninverting amplifier and voltage follower illustrated in Fig. 6.3b and Fig. 6.3c, respectively, the op-amp common-mode input voltage roughly equals $V_{s}$. Expanding the common-mode input range to include both supplies eliminates an unwarranted restriction on op-amp performance in these configurations. Section 6.8 details an example op amp with this characteristic, known as a rail-to-rail common-mode input range."
},
{
    "text": "The common-mode input range encompasses the span of direct current common-mode input voltages within which an operational amplifier (op amp) functions normally, keeping its critical parameters like offset voltage and input bias current within specified limits. In the past, op amps were typically designed to operate with substantial equal-and-opposite power-supply voltages. For instance, the 741 op amp, discussed in earlier versions of this book, frequently ran on supply voltages of $\\pm 15 \\mathrm{~V}$, corresponding to a common-mode input range of roughly $\\pm 13 \\mathrm{~V}$. Conversely, contemporary op amps often function between ground and a single positive power-supply voltage of 3 V or lower. If the common-mode input range were confined to 2 V above ground and 2 V below the positive supply in such cases, the input stage of these op amps would malfunction for any common-mode input voltage. While narrowing the gap between the common-mode input range and the power supplies addresses this issue, the inverting amplifier setup depicted in Fig. $6.3 a$ cannot be employed without adjustments when the op amp operates from a single nonzero supply voltage unless the common-mode input range is broadened to include ground. In practical applications, incorporating both power-supply voltages within the common-mode input range is often crucial. For example, in the noninverting amplifier and voltage follower illustrated in Fig. 6.3b and Fig. 6.3c, respectively, the op-amp common-mode input voltage is roughly equivalent to $V_{s}$. Expanding the common-mode input range to encompass both supplies eliminates an unwarranted constraint on op-amp performance in these configurations. Section 6.8 details an example op amp with this capability, known as a rail-to-rail common-mode input range."
},
{
    "text": "When an operational amplifier features a differential input and a single-ended output, its small-signal output voltage can be characterized by its differential and common-mode input voltages ($v_{i d}$ and $v_{i c}$) using the following equation:\n\n$$\n\\begin{equation*}\nv_{o}=A_{d m} v_{i d}+A_{c m} v_{i c} \\tag{6.44}\n\\end{equation*}\n$$\n\nHere, $A_{d m}$ represents the differential-mode gain, while $A_{c m}$ denotes the common-mode gain. As outlined in (3.187), the common-mode rejection ratio (CMRR) of the op amp is given by:\n\n$$\n\\begin{equation*}\n\\mathrm{CMRR}=\\left|\\frac{A_{d m}}{A_{c m}}\\right| \\tag{6.45}\n\\end{equation*}\n$$\n\nFrom an application perspective, the CMRR can be seen as the variation in input offset voltage resulting from a unit change in common-mode input voltage. For instance, suppose we apply zero common-mode input voltage to the amplifier and then introduce sufficient differential voltage to bring the output voltage to zero. The dc voltage applied in this scenario is the input offset voltage, $V_{O S}$. If we maintain the applied differential voltage and increase the common-mode input voltage by $\\Delta V_{i c}$, the output voltage will alter by:\n\n$$\n\\begin{equation*}\nv_{o}=\\Delta V_{o}=A_{c m} \\Delta V_{i c}=A_{c m} v_{i c} \\tag{6.46}\n\\end{equation*}\n$$\n\nTo restore the output voltage to zero, the differential input voltage must be adjusted by:\n\n$$\n\\begin{equation*}\nv_{i d}=\\Delta V_{i d}=\\frac{\\Delta V_{o}}{A_{d m}}=\\frac{A_{c m} \\Delta V_{i c}}{A_{d m}} \\tag{6.47}\n\\end{equation*}\n$$\n\nTherefore, the impact of a finite CMRR can be viewed as causing a shift in the input offset voltage whenever the common-mode input voltage varies. By utilizing (6.45) and (6.47), we derive:\n\n$$\n\\begin{equation*}\n\\mathrm{CMRR}=\\left|\\frac{A_{d m}}{A_{c m}}\\right|=\\left(\\left.\\frac{\\Delta V_{i d}}{\\Delta V_{i c}}\\right|_{V_{o}=0}\\right)^{-1}=\\left(\\frac{\\Delta V_{O S}}{\\Delta V_{i c}}\\right)^{-1} \\simeq\\left(\\left.\\frac{\\partial V_{O S}}{\\partial V_{i c}}\\right|_{V_{o}=0}\\right)^{-1} \\tag{6.48}\n\\end{equation*}\n$$\n\nIn configurations like the differential amplifier depicted in Fig. 6.11, an offset voltage arises that depends on the common-mode signal input, resulting in an output voltage that is indistinguishable from the intended signal. For a common-mode rejection ratio of $10^{4}$ (or $80 \\mathrm{~dB}$), equation (6.48) indicates that a $10-\\mathrm{V}$ common-mode signal leads to a $1-\\mathrm{mV}$ change in the input offset voltage."
},
{
    "text": "When an operational amplifier features a differential input and a single-ended output, its small-signal output voltage can be expressed in relation to its differential and common-mode input voltages ($v_{i d}$ and $v_{i c}$) using the following formula:\n\n$$\n\\begin{equation*}\nv_{o}=A_{d m} v_{i d}+A_{c m} v_{i c} \\tag{6.44}\n\\end{equation*}\n$$\n\nHere, $A_{d m}$ represents the differential-mode gain, while $A_{c m}$ denotes the common-mode gain. As outlined in (3.187), the common-mode rejection ratio (CMRR) of the op amp is defined as:\n\n$$\n\\begin{equation*}\n\\mathrm{CMRR}=\\left|\\frac{A_{d m}}{A_{c m}}\\right| \\tag{6.45}\n\\end{equation*}\n$$\n\nFrom an application perspective, the CMRR can be viewed as the variation in input offset voltage resulting from a unit change in common-mode input voltage. For instance, suppose we apply zero common-mode input voltage to the amplifier and then introduce sufficient differential voltage to bring the output voltage to zero. The dc voltage applied in this scenario is the input offset voltage $V_{O S}$. If we maintain the applied differential voltage and increase the common-mode input voltage by $\\Delta V_{i c}$, the output voltage will alter by:\n\n$$\n\\begin{equation*}\nv_{o}=\\Delta V_{o}=A_{c m} \\Delta V_{i c}=A_{c m} v_{i c} \\tag{6.46}\n\\end{equation*}\n$$\n\nTo revert the output voltage to zero, the differential input voltage must be adjusted by:\n\n$$\n\\begin{equation*}\nv_{i d}=\\Delta V_{i d}=\\frac{\\Delta V_{o}}{A_{d m}}=\\frac{A_{c m} \\Delta V_{i c}}{A_{d m}} \\tag{6.47}\n\\end{equation*}\n$$\n\nTherefore, the presence of finite CMRR can be seen as causing a shift in the input offset voltage whenever the common-mode input voltage varies. By utilizing (6.45) and (6.47), we derive:\n\n$$\n\\begin{equation*}\n\\mathrm{CMRR}=\\left|\\frac{A_{d m}}{A_{c m}}\\right|=\\left(\\left.\\frac{\\Delta V_{i d}}{\\Delta V_{i c}}\\right|_{V_{o}=0}\\right)^{-1}=\\left(\\frac{\\Delta V_{O S}}{\\Delta V_{i c}}\\right)^{-1} \\simeq\\left(\\left.\\frac{\\partial V_{O S}}{\\partial V_{i c}}\\right|_{V_{o}=0}\\right)^{-1} \\tag{6.48}\n\\end{equation*}\n$$\n\nIn configurations like the differential amplifier depicted in Fig. 6.11, an offset voltage arises that depends on the common-mode signal input, generating an output voltage that is indistinguishable from the intended signal. For a common-mode rejection ratio of $10^{4}$ (or $80 \\mathrm{~dB}$), equation (6.48) indicates that a $10-\\mathrm{V}$ common-mode signal results in a $1-\\mathrm{mV}$ alteration in the input offset voltage."
},
{
    "text": "When an operational amplifier features a differential input and a single-ended output, its small-signal output voltage can be characterized by its differential and common-mode input voltages ($v_{i d}$ and $v_{i c}$) using the following equation:\n\n$$\n\\begin{equation*}\nv_{o}=A_{d m} v_{i d}+A_{c m} v_{i c} \\tag{6.44}\n\\end{equation*}\n$$\n\nHere, $A_{d m}$ represents the differential-mode gain, while $A_{c m}$ denotes the common-mode gain. As outlined in (3.187), the common-mode rejection ratio (CMRR) of the op amp is given by:\n\n$$\n\\begin{equation*}\n\\mathrm{CMRR}=\\left|\\frac{A_{d m}}{A_{c m}}\\right| \\tag{6.45}\n\\end{equation*}\n$$\n\nFrom an application perspective, the CMRR can be seen as the variation in input offset voltage resulting from a unit change in common-mode input voltage. For instance, suppose we apply zero common-mode input voltage to the amplifier and then introduce sufficient differential voltage to bring the output voltage to zero. The dc voltage applied in this scenario is the input offset voltage $V_{O S}$. If we maintain the applied differential voltage and increase the common-mode input voltage by $\\Delta V_{i c}$, the output voltage will alter by:\n\n$$\n\\begin{equation*}\nv_{o}=\\Delta V_{o}=A_{c m} \\Delta V_{i c}=A_{c m} v_{i c} \\tag{6.46}\n\\end{equation*}\n$$\n\nTo revert the output voltage to zero, the differential input voltage must be adjusted by:\n\n$$\n\\begin{equation*}\nv_{i d}=\\Delta V_{i d}=\\frac{\\Delta V_{o}}{A_{d m}}=\\frac{A_{c m} \\Delta V_{i c}}{A_{d m}} \\tag{6.47}\n\\end{equation*}\n$$\n\nTherefore, the impact of a finite CMRR can be viewed as causing a shift in the input offset voltage whenever the common-mode input voltage varies. By utilizing (6.45) and (6.47), we derive:\n\n$$\n\\begin{equation*}\n\\mathrm{CMRR}=\\left|\\frac{A_{d m}}{A_{c m}}\\right|=\\left(\\left.\\frac{\\Delta V_{i d}}{\\Delta V_{i c}}\\right|_{V_{o}=0}\\right)^{-1}=\\left(\\frac{\\Delta V_{O S}}{\\Delta V_{i c}}\\right)^{-1} \\simeq\\left(\\left.\\frac{\\partial V_{O S}}{\\partial V_{i c}}\\right|_{V_{o}=0}\\right)^{-1} \\tag{6.48}\n\\end{equation*}\n$$\n\nIn configurations like the differential amplifier depicted in Fig. 6.11, an offset voltage arises that depends on the common-mode signal input, leading to an output voltage that is indistinguishable from the intended signal. For a common-mode rejection ratio of $10^{4}$ (or $80 \\mathrm{~dB}$), equation (6.48) indicates that a $10-\\mathrm{V}$ common-mode signal results in a $1-\\mathrm{mV}$ alteration in the input offset voltage."
},
{
    "text": "When an operational amplifier features a differential input alongside a single-ended output, the small-signal output voltage can be characterized by its differential and common-mode input voltages ($v_{i d}$ and $v_{i c}$) through the following expression:\n\n$$\n\\begin{equation*}\nv_{o}=A_{d m} v_{i d}+A_{c m} v_{i c} \\tag{6.44}\n\\end{equation*}\n$$\n\nHere, $A_{d m}$ represents the differential-mode gain, while $A_{c m}$ denotes the common-mode gain. As outlined in (3.187), the common-mode rejection ratio (CMRR) of the op amp is given by:\n\n$$\n\\begin{equation*}\n\\mathrm{CMRR}=\\left|\\frac{A_{d m}}{A_{c m}}\\right| \\tag{6.45}\n\\end{equation*}\n$$\n\nFrom an application perspective, the CMRR can be seen as the variation in input offset voltage stemming from a unit change in common-mode input voltage. For instance, suppose we apply zero common-mode input voltage to the amplifier and then introduce sufficient differential voltage to bring the output voltage to zero. The resulting dc voltage is the input offset voltage, $V_{O S}$. If we maintain the applied differential voltage and increase the common-mode input voltage by $\\Delta V_{i c}$, the output voltage will alter by:\n\n$$\n\\begin{equation*}\nv_{o}=\\Delta V_{o}=A_{c m} \\Delta V_{i c}=A_{c m} v_{i c} \\tag{6.46}\n\\end{equation*}\n$$\n\nTo restore the output voltage to zero, the differential input voltage must be adjusted by:\n\n$$\n\\begin{equation*}\nv_{i d}=\\Delta V_{i d}=\\frac{\\Delta V_{o}}{A_{d m}}=\\frac{A_{c m} \\Delta V_{i c}}{A_{d m}} \\tag{6.47}\n\\end{equation*}\n$$\n\nThus, the influence of a finite CMRR can be viewed as causing fluctuations in the input offset voltage whenever the common-mode input voltage varies. Utilizing (6.45) and (6.47), we derive:\n\n$$\n\\begin{equation*}\n\\mathrm{CMRR}=\\left|\\frac{A_{d m}}{A_{c m}}\\right|=\\left(\\left.\\frac{\\Delta V_{i d}}{\\Delta V_{i c}}\\right|_{V_{o}=0}\\right)^{-1}=\\left(\\frac{\\Delta V_{O S}}{\\Delta V_{i c}}\\right)^{-1} \\simeq\\left(\\left.\\frac{\\partial V_{O S}}{\\partial V_{i c}}\\right|_{V_{o}=0}\\right)^{-1} \\tag{6.48}\n\\end{equation*}\n$$\n\nIn configurations like the differential amplifier depicted in Fig. 6.11, an offset voltage arises that depends on the common-mode signal input, generating an output voltage that is indistinguishable from the intended signal. For a common-mode rejection ratio of $10^{4}$ (or $80 \\mathrm{~dB}$), equation (6.48) indicates that a $10-\\mathrm{V}$ common-mode signal results in a $1-\\mathrm{mV}$ shift in the input offset voltage."
},
{
    "text": "When an operational amplifier features a differential input and a single-ended output, its small-signal output voltage can be characterized by its differential and common-mode input voltages ($v_{i d}$ and $v_{i c}$) using the following equation:\n\n$$\n\\begin{equation*}\nv_{o} = A_{d m} v_{i d} + A_{c m} v_{i c} \\tag{6.44}\n\\end{equation*}\n$$\n\nHere, $A_{d m}$ represents the differential-mode gain, while $A_{c m}$ denotes the common-mode gain. As outlined in (3.187), the common-mode rejection ratio (CMRR) of the op amp is given by:\n\n$$\n\\begin{equation*}\n\\mathrm{CMRR} = \\left| \\frac{A_{d m}}{A_{c m}} \\right| \\tag{6.45}\n\\end{equation*}\n$$\n\nFrom an application perspective, the CMRR can be seen as the variation in input offset voltage resulting from a unit change in common-mode input voltage. For instance, suppose we apply zero common-mode input voltage to the amplifier and then introduce sufficient differential voltage to bring the output voltage to zero. The dc voltage applied in this scenario is the input offset voltage $V_{O S}$. If we maintain the applied differential voltage and increase the common-mode input voltage by $\\Delta V_{i c}$, the output voltage will alter by:\n\n$$\n\\begin{equation*}\nv_{o} = \\Delta V_{o} = A_{c m} \\Delta V_{i c} = A_{c m} v_{i c} \\tag{6.46}\n\\end{equation*}\n$$\n\nTo return the output voltage to zero, the differential input voltage must be adjusted by:\n\n$$\n\\begin{equation*}\nv_{i d} = \\Delta V_{i d} = \\frac{\\Delta V_{o}}{A_{d m}} = \\frac{A_{c m} \\Delta V_{i c}}{A_{d m}} \\tag{6.47}\n\\end{equation*}\n$$\n\nThus, the presence of a finite CMRR can be viewed as causing a shift in the input offset voltage whenever the common-mode input voltage varies. Utilizing (6.45) and (6.47), we derive:\n\n$$\n\\begin{equation*}\n\\mathrm{CMRR} = \\left| \\frac{A_{d m}}{A_{c m}} \\right| = \\left( \\left. \\frac{\\Delta V_{i d}}{\\Delta V_{i c}} \\right|_{V_{o} = 0} \\right)^{-1} = \\left( \\frac{\\Delta V_{O S}}{\\Delta V_{i c}} \\right)^{-1} \\simeq \\left( \\left. \\frac{\\partial V_{O S}}{\\partial V_{i c}} \\right|_{V_{o} = 0} \\right)^{-1} \\tag{6.48}\n\\end{equation*}\n$$\n\nIn circuits like the differential amplifier depicted in Fig. 6.11, an offset voltage arises that depends on the common-mode signal input, leading to an output voltage that is indistinguishable from the intended signal. For a common-mode rejection ratio of $10^{4}$ (or $80 \\mathrm{~dB}$), equation (6.48) indicates that a $10-\\mathrm{V}$ common-mode signal results in a $1-\\mathrm{mV}$ change in the input offset voltage."
},
{
    "text": "When an operational amplifier features a differential input and a single-ended output, its small-signal output voltage can be characterized by its differential and common-mode input voltages ($v_{i d}$ and $v_{i c}$) using the following equation:\n\n$$\n\\begin{equation*}\nv_{o} = A_{d m} v_{i d} + A_{c m} v_{i c} \\tag{6.44}\n\\end{equation*}\n$$\n\nHere, $A_{d m}$ represents the differential-mode gain, while $A_{c m}$ denotes the common-mode gain. As per the definition in (3.187), the common-mode rejection ratio (CMRR) of the op amp is given by:\n\n$$\n\\begin{equation*}\n\\mathrm{CMRR} = \\left| \\frac{A_{d m}}{A_{c m}} \\right| \\tag{6.45}\n\\end{equation*}\n$$\n\nFrom an application perspective, the CMRR can be viewed as the variation in input offset voltage resulting from a unit change in the common-mode input voltage. For instance, suppose we apply zero common-mode input voltage to the amplifier and then introduce sufficient differential voltage to bring the output voltage to zero. The DC voltage applied in this scenario is the input offset voltage, $V_{O S}$. If we maintain the applied differential voltage and increase the common-mode input voltage by $\\Delta V_{i c}$, the output voltage will alter by:\n\n$$\n\\begin{equation*}\nv_{o} = \\Delta V_{o} = A_{c m} \\Delta V_{i c} = A_{c m} v_{i c} \\tag{6.46}\n\\end{equation*}\n$$\n\nTo return the output voltage to zero, the differential input voltage must be adjusted by:\n\n$$\n\\begin{equation*}\nv_{i d} = \\Delta V_{i d} = \\frac{\\Delta V_{o}}{A_{d m}} = \\frac{A_{c m} \\Delta V_{i c}}{A_{d m}} \\tag{6.47}\n\\end{equation*}\n$$\n\nTherefore, the impact of a finite CMRR can be seen as causing a shift in the input offset voltage whenever the common-mode input voltage varies. Utilizing (6.45) and (6.47), we derive:\n\n$$\n\\begin{equation*}\n\\mathrm{CMRR} = \\left| \\frac{A_{d m}}{A_{c m}} \\right| = \\left( \\left. \\frac{\\Delta V_{i d}}{\\Delta V_{i c}} \\right|_{V_{o} = 0} \\right)^{-1} = \\left( \\frac{\\Delta V_{O S}}{\\Delta V_{i c}} \\right)^{-1} \\simeq \\left( \\left. \\frac{\\partial V_{O S}}{\\partial V_{i c}} \\right|_{V_{o} = 0} \\right)^{-1} \\tag{6.48}\n\\end{equation*}\n$$\n\nIn circuits like the differential amplifier depicted in Fig. 6.11, an offset voltage arises that depends on the common-mode signal input, leading to an output voltage that is indistinguishable from the intended signal. For a common-mode rejection ratio of $10^{4}$ (or $80 \\mathrm{~dB}$), equation (6.48) indicates that a $10-\\mathrm{V}$ common-mode signal results in a $1-\\mathrm{mV}$ change in the input offset voltage."
},
{
    "text": "When an operational amplifier features a differential input and a single-ended output, its small-signal output voltage can be characterized using its differential and common-mode input voltages ($v_{i d}$ and $v_{i c}$) through the following equation:\n\n$$\n\\begin{equation*}\nv_{o} = A_{d m} v_{i d} + A_{c m} v_{i c} \\tag{6.44}\n\\end{equation*}\n$$\n\nHere, $A_{d m}$ represents the differential-mode gain, while $A_{c m}$ denotes the common-mode gain. As outlined in (3.187), the common-mode rejection ratio (CMRR) of the op amp is defined as:\n\n$$\n\\begin{equation*}\n\\mathrm{CMRR} = \\left|\\frac{A_{d m}}{A_{c m}}\\right| \\tag{6.45}\n\\end{equation*}\n$$\n\nFrom an application perspective, the CMRR can be seen as the variation in input offset voltage resulting from a unit change in the common-mode input voltage. For instance, suppose we apply a zero common-mode input voltage to the amplifier and then introduce sufficient differential voltage to bring the output voltage to zero. The dc voltage applied in this scenario is the input offset voltage $V_{O S}$. If we maintain the applied differential voltage and increase the common-mode input voltage by $\\Delta V_{i c}$, the output voltage will alter by:\n\n$$\n\\begin{equation*}\nv_{o} = \\Delta V_{o} = A_{c m} \\Delta V_{i c} = A_{c m} v_{i c} \\tag{6.46}\n\\end{equation*}\n$$\n\nTo return the output voltage to zero, the differential input voltage must be adjusted by:\n\n$$\n\\begin{equation*}\nv_{i d} = \\Delta V_{i d} = \\frac{\\Delta V_{o}}{A_{d m}} = \\frac{A_{c m} \\Delta V_{i c}}{A_{d m}} \\tag{6.47}\n\\end{equation*}\n$$\n\nTherefore, the impact of a finite CMRR can be viewed as causing a shift in the input offset voltage whenever the common-mode input voltage varies. By utilizing (6.45) and (6.47), we derive:\n\n$$\n\\begin{equation*}\n\\mathrm{CMRR} = \\left|\\frac{A_{d m}}{A_{c m}}\\right| = \\left(\\left.\\frac{\\Delta V_{i d}}{\\Delta V_{i c}}\\right|_{V_{o}=0}\\right)^{-1} = \\left(\\frac{\\Delta V_{O S}}{\\Delta V_{i c}}\\right)^{-1} \\simeq \\left(\\left.\\frac{\\partial V_{O S}}{\\partial V_{i c}}\\right|_{V_{o}=0}\\right)^{-1} \\tag{6.48}\n\\end{equation*}\n$$\n\nIn configurations like the differential amplifier depicted in Fig. 6.11, an offset voltage arises that depends on the common-mode signal input, generating an output voltage that is indistinguishable from the intended signal. For a CMRR of $10^{4}$ (or $80 \\mathrm{~dB}$), equation (6.48) indicates that a $10-\\mathrm{V}$ common-mode signal results in a $1-\\mathrm{mV}$ alteration in the input offset voltage."
},
{
    "text": "When an operational amplifier features a differential input and a single-ended output, its small-signal output voltage can be characterized by its differential and common-mode input voltages ($v_{i d}$ and $v_{i c}$) using the following formula:\n\n$$\n\\begin{equation*}\nv_{o}=A_{d m} v_{i d}+A_{c m} v_{i c} \\tag{6.44}\n\\end{equation*}\n$$\n\nHere, $A_{d m}$ represents the differential-mode gain, while $A_{c m}$ denotes the common-mode gain. As per the definition in (3.187), the common-mode rejection ratio (CMRR) of the op amp is given by:\n\n$$\n\\begin{equation*}\n\\mathrm{CMRR}=\\left|\\frac{A_{d m}}{A_{c m}}\\right| \\tag{6.45}\n\\end{equation*}\n$$\n\nFrom an application perspective, the CMRR can be seen as the variation in input offset voltage resulting from a unit change in common-mode input voltage. For instance, suppose we apply zero common-mode input voltage to the amplifier and then introduce sufficient differential voltage to bring the output voltage to zero. The dc voltage applied in this scenario is the input offset voltage, $V_{O S}$. If we maintain the applied differential voltage and increase the common-mode input voltage by $\\Delta V_{i c}$, the output voltage will alter by:\n\n$$\n\\begin{equation*}\nv_{o}=\\Delta V_{o}=A_{c m} \\Delta V_{i c}=A_{c m} v_{i c} \\tag{6.46}\n\\end{equation*}\n$$\n\nTo return the output voltage to zero, the differential input voltage must be adjusted by:\n\n$$\n\\begin{equation*}\nv_{i d}=\\Delta V_{i d}=\\frac{\\Delta V_{o}}{A_{d m}}=\\frac{A_{c m} \\Delta V_{i c}}{A_{d m}} \\tag{6.47}\n\\end{equation*}\n$$\n\nTherefore, the impact of a finite CMRR can be viewed as causing a shift in the input offset voltage whenever the common-mode input voltage varies. Utilizing (6.45) and (6.47), we derive:\n\n$$\n\\begin{equation*}\n\\mathrm{CMRR}=\\left|\\frac{A_{d m}}{A_{c m}}\\right|=\\left(\\left.\\frac{\\Delta V_{i d}}{\\Delta V_{i c}}\\right|_{V_{o}=0}\\right)^{-1}=\\left(\\frac{\\Delta V_{O S}}{\\Delta V_{i c}}\\right)^{-1} \\simeq\\left(\\left.\\frac{\\partial V_{O S}}{\\partial V_{i c}}\\right|_{V_{o}=0}\\right)^{-1} \\tag{6.48}\n\\end{equation*}\n$$\n\nIn configurations like the differential amplifier depicted in Fig. 6.11, an offset voltage arises that depends on the common-mode signal input, resulting in an output voltage that cannot be differentiated from the intended signal. For a CMRR of $10^{4}$ (or $80 \\mathrm{~dB}$), equation (6.48) indicates that a $10-\\mathrm{V}$ common-mode signal leads to a $1-\\mathrm{mV}$ change in the input offset voltage."
},
{
    "text": "In (6.44), we assumed that the power-supply voltages remain constant, meaning the op-amp output voltage solely depends on the differential and common-mode input voltages fed to the op amp. However, in reality, the power-supply voltages are not entirely stable, and their fluctuations contribute to the op-amp's output. Figure 6.12 illustrates a block diagram of an op amp with fluctuating power-supply voltages. The small-signal variations in the positive and negative power supplies are denoted as $v_{d d}$ and $v_{s s}$, respectively. Assuming $v_{i c}=0$ for simplicity, the resulting small-signal op-amp output voltage is given by\n\n$$\n\\begin{equation*}\nv_{o}=A_{d m} v_{i d}+A^{+} v_{d d}+A^{-} v_{s s} \\tag{6.49}\n\\end{equation*}\n$$\n\nwhere $A^{+}$ and $A^{-}$ represent the small-signal gains from the positive and negative power supplies to the output, respectively. Since op amps should be responsive to changes in their differential-mode input voltage but insensitive to supply voltage changes, the equation is reformulated below to facilitate comparison of these gains:\n\n$$\n\\begin{align*}\nv_{o} & =A_{d m}\\left(v_{i d}+\\frac{A^{+}}{A_{d m}} v_{d d}+\\frac{A^{-}}{A_{d m}} v_{s s}\\right)  \\tag{6.50}\\\\\n& =A_{d m}\\left(v_{i d}+\\frac{v_{d d}}{\\mathrm{PSRR}^{+}}+\\frac{v_{s s}}{\\mathrm{PSRR}^{-}}\\right)\n\\end{align*}\n$$\n\nwhere\n\n$$\n\\begin{equation*}\n\\mathrm{PSRR}^{+}=\\frac{A_{d m}}{A^{+}} \\quad \\text { and } \\quad \\mathrm{PSRR}^{-}=\\frac{A_{d m}}{A^{-}} \\tag{6.51}\n\\end{equation*}\n$$\n\nFigure 6.13 presents one interpretation of (6.50), where the diagram in Fig. 6.12 is reconfigured using an op amp with constant power supplies. To equate the output in Fig. 6.13 to that in Fig. 6.12, the power-supply variations from Fig. 6.12 are incorporated as equivalent differential inputs.\n\nThe block diagram in Figure 6.13 depicts an operational amplifier (op-amp) with power supply variations represented as differential inputs. The key components and system flow are as follows:\n\n1. **Main Components:**\n- **Operational Amplifier (Op-Amp):** Identified as \\( A_0 \\), it is the central element responsible for signal amplification.\n- **Input Voltage Sources:** Two input voltage sources, \\( v_{ic} \\) and \\( v_{id} \\), with the common-mode voltage \\( v_{ic} \\) connected to both op-amp inputs and the differential input voltage \\( v_{id} \\) split equally (\\( \\frac{v_{id}}{2} \\)) between the inputs.\n- **Power Supplies:** The op-amp is powered by \\( V_{DD} \\) and \\( V_{SS} \\), with variations \\( v_{dd} \\) and \\( v_{ss} \\).\n\n2. **Flow of Information or Control:**\n- Input signals \\( v_{ic} \\) and \\( v_{id} \\) are applied to the op-amp inputs, with \\( v_{ic} \\) applied directly and \\( v_{id} \\) split.\n- The op-amp amplifies the differential input, generating the output voltage \\( v_o \\).\n- Power supply variations \\( v_{dd} \\) and \\( v_{ss} \\) are modeled as differential inputs affecting the op-amp's operation.\n\n3. **Labels, Annotations, and Key Indicators:**\n- Inputs labeled \"InP(A_0)\" for the non-inverting input and \"InN(A_0)\" for the inverting input.\n- Output voltage labeled \\( v_o \\), referenced to ground (GND).\n- Power supply voltages labeled \\( V_{DD} \\) and \\( V_{SS} \\) with variations \\( v_{dd} \\) and \\( v_{ss} \\).\n\n4. **Overall System Function:**\n- The diagram demonstrates how power supply variations can be modeled as differential inputs in an op-amp circuit, aiding in the analysis and maximization of the Power Supply Rejection Ratio (PSRR) to minimize their impact on the op-amp's output.\n\nFigure 6.12 shows a block diagram of an op amp with varying power-supply voltages.\n\nThe block diagram in Figure 6.13 represents an operational amplifier (op-amp) circuit designed to model the influence of power supply variations as differential inputs. This setup is used to analyze and optimize the Power Supply Rejection Ratio (PSRR), thereby minimizing the impact of these variations on the op-amp's output.\n\n1. **Main Components:**\n- **Differential Input Voltage Source (V_id):** The input voltage is represented as a differential signal, \\( V_{id} \\), split into two equal parts \\( \\frac{V_{id}}{2} \\) at the positive and negative input terminals.\n- **Power Supply Rejection Blocks (PSRR+ and PSRR-):** These blocks model the rejection of power supply variations from the positive \\( V_{dd} \\) and negative \\( V_{ss} \\) supply voltages.\n- **Summing Nodes (x1):** These nodes combine the input differential voltage and the effects of power supply variations.\n- **Operational Amplifier (A_0):** The core amplifier block with gain \\( A_0 \\), amplifying the differential input signal while ideally rejecting power supply noise.\n\n2. **Flow of Information or Control:**\n- The differential input voltage \\( V_{id} \\) is divided and fed into the summing nodes.\n- Power supply variations \\( \\frac{V_{dd}}{\\text{PSRR+}} \\) and \\( \\frac{V_{ss}}{\\text{PSRR-}} \\) are also fed into the summing nodes, combining with the differential input voltage.\n- The summed input is then fed into the operational amplifier \\( A_0 \\), which amplifies the signal and ideally rejects power supply noise.\n- The output voltage \\( V_o \\) reflects the amplified input signal with minimized power supply noise effects.\n\n3. **Labels, Annotations, and Key Indicators:**\n- \\( V_{id} \\), \\( V_{dd} \\), and \\( V_{ss} \\) are labeled to indicate input and supply voltages.\n- PSRR+ and PSRR- are annotated to show the power supply rejection ratios.\n- \\( A_0 \\) denotes the gain of the op-amp.\n- Ground (GND) is indicated for reference.\n\n4. **Overall System Function:**\n- The system amplifies the differential input signal \\( V_{id} \\) while minimizing the impact of power supply voltage variations \\( V_{dd} \\) and \\( V_{ss} \\). By modeling these variations as differential inputs, the system aims to maximize the PSRR, ensuring stable and accurate op-amp performance.\n\nFigure 6.13 illustrates an op amp with supply variations modeled in the input differential loop, assuming $v_{i c}=0$. Equation 6.50 and Fig. 6.13 indicate that maximizing the power-supply rejection ratios is crucial to minimize unwanted contributions to the op-amp output voltage. In practice, these rejection ratios are frequency-dependent and often decrease with increasing frequency.\n\nThe Power Supply Rejection Ratio (PSRR) has become a critical parameter in MOS amplifier design due to increased integration levels. With small-scale integration, only a few transistors could be placed on a single integrated circuit, allowing analog and digital functions to be isolated on separate chips, thus reducing coupling from digital circuits to analog supplies. This separation also enabled filtering of digital interference at the printed-circuit-board level using external capacitors. However, with large-scale integration, many transistors can be integrated onto one chip, integrating analog and digital functions and increasing coupling to the analog supplies. While monolithic filter capacitors can theoretically reduce supply variations, their required area is large. For instance, with an oxide thickness of $100 \\AA$, the capacitance per unit area is $3.45 \\mathrm{fF} / \\mu \\mathrm{m}^{2}$. A $0.01 \\mu \\mathrm{~F}$ capacitor, commonly used for supply filtering, would require $1.7 \\mathrm{~mm}^{2}$, a significant fraction of the area for many integrated circuits occupying less than $100 \\mathrm{~mm}^{2}$.\n\nTo lower costs, rather than focusing solely on filtering supply variations, an alternative is to design circuits with low sensitivity to these variations. Fully differential circuit techniques have emerged as a vital tool in this approach. These circuits represent all signals as differences between corresponding quantities, such as voltages or currents. If identical signal paths are used and the coupling from supply variations is the same for both quantities, the difference can theoretically be independent of the supply variations. In practice, mismatches in signal paths and non-identical coupling can lead to imperfect cancellation. Additionally, significant power supply noise can cause nonlinearity, limiting cancellation effectiveness. Although the op amps discussed in this chapter have differential inputs, they are not fully differential since their outputs are single-ended. Fully differential op amps are covered in Chapter 12."
},
{
    "text": "In (6.44), it was assumed that the power-supply voltages remain constant, meaning the op-amp output voltage depends solely on the differential and common-mode input voltages. However, in reality, power-supply voltages are not perfectly stable, and their fluctuations contribute to the op-amp's output. Figure 6.12 illustrates a block diagram of an op amp with fluctuating power-supply voltages. The small-signal variations in the positive and negative power supplies are denoted as $v_{d d}$ and $v_{s s}$, respectively. Assuming $v_{i c}=0$ for simplicity, the resulting small-signal op-amp output voltage is given by\n\n$$\n\\begin{equation*}\nv_{o}=A_{d m} v_{i d}+A^{+} v_{d d}+A^{-} v_{s s} \\tag{6.49}\n\\end{equation*}\n$$\n\nHere, $A^{+}$ and $A^{-}$ represent the small-signal gains from the positive and negative power supplies to the output, respectively. Since op amps should be responsive to changes in their differential-mode input voltage but insensitive to supply voltage changes, the equation is restructured below for easier comparison of these gains:\n\n$$\n\\begin{align*}\nv_{o} & =A_{d m}\\left(v_{i d}+\\frac{A^{+}}{A_{d m}} v_{d d}+\\frac{A^{-}}{A_{d m}} v_{s s}\\right)  \\tag{6.50}\\\\\n& =A_{d m}\\left(v_{i d}+\\frac{v_{d d}}{\\mathrm{PSRR}^{+}}+\\frac{v_{s s}}{\\mathrm{PSRR}^{-}}\\right)\n\\end{align*}\n$$\n\nwhere\n\n$$\n\\begin{equation*}\n\\mathrm{PSRR}^{+}=\\frac{A_{d m}}{A^{+}} \\quad \\text { and } \\quad \\mathrm{PSRR}^{-}=\\frac{A_{d m}}{A^{-}} \\tag{6.51}\n\\end{equation*}\n$$\n\nFigure 6.13 provides an interpretation of (6.50), where the diagram in Fig. 6.12 is reconfigured using an op amp with constant power supplies. To equate the output in Fig. 6.13 to that in Fig. 6.12, the power-supply variations from Fig. 6.12 are incorporated as equivalent differential inputs.\n\n**Figure 6.13 Description:**\nThe block diagram in Figure 6.13 depicts an operational amplifier (op-amp) with power supply variations represented as differential inputs. The key components and system flow are as follows:\n\n1. **Main Components:**\n   - **Operational Amplifier (Op-Amp):** Identified as \\( A_0 \\), it is the central element responsible for signal amplification.\n   - **Input Voltage Sources:** Two sources, \\( v_{ic} \\) and \\( v_{id} \\), where \\( v_{ic} \\) is the common-mode voltage connected to both op-amp inputs, and \\( v_{id} \\) is split equally (\\( \\frac{v_{id}}{2} \\)) between the inputs.\n   - **Power Supplies:** The op-amp is powered by \\( V_{DD} \\) and \\( V_{SS} \\), with variations \\( v_{dd} \\) and \\( v_{ss} \\).\n\n2. **Flow of Information or Control:**\n   - Input signals \\( v_{ic} \\) and \\( v_{id} \\) are applied to the op-amp inputs, with \\( v_{ic} \\) directly applied and \\( v_{id} \\) split.\n   - The op-amp amplifies the differential input, producing output voltage \\( v_o \\).\n   - Power supply variations \\( v_{dd} \\) and \\( v_{ss} \\) are modeled as differential inputs affecting the op-amp.\n\n3. **Labels, Annotations, and Key Indicators:**\n   - Inputs labeled \"InP(A_0)\" for non-inverting and \"InN(A_0)\" for inverting.\n   - Output voltage labeled \\( v_o \\) with reference to ground (GND).\n   - Power supply voltages labeled \\( V_{DD} \\) and \\( V_{SS} \\) with variations \\( v_{dd} \\) and \\( v_{ss} \\).\n\n4. **Overall System Function:**\n   - The diagram demonstrates how power supply variations can be modeled as differential inputs, aiding in the analysis and maximization of Power Supply Rejection Ratio (PSRR) to minimize their impact on the op-amp's output.\n\n**Figure 6.13 Description (Alternative):**\nThe block diagram in Figure 6.13 models an operational amplifier (op-amp) circuit, illustrating the impact of power supply variations as differential inputs. This setup is crucial for analyzing and optimizing the Power Supply Rejection Ratio (PSRR), thereby reducing the influence of these variations on the op-amp's output.\n\n1. **Main Components:**\n   - **Differential Input Voltage Source (V_id):** Represented as \\( V_{id} \\), split into \\( \\frac{V_{id}}{2} \\) at the positive and negative input terminals.\n   - **Power Supply Rejection Blocks (PSRR+ and PSRR-):** These blocks model the rejection of variations from \\( V_{dd} \\) and \\( V_{ss} \\).\n   - **Summing Nodes (x1):** Combine the input differential voltage and power supply variation effects.\n   - **Operational Amplifier (A_0):** The core amplifier with gain \\( A_0 \\), amplifying the input signal while ideally rejecting power supply noise.\n\n2. **Flow of Information or Control:**\n   - The differential input voltage \\( V_{id} \\) is divided and fed into the summing nodes.\n   - Power supply variations \\( \\frac{V_{dd}}{\\text{PSRR+}} \\) and \\( \\frac{V_{ss}}{\\text{PSRR-}} \\) are also fed into the summing nodes.\n   - The summed input is amplified by \\( A_0 \\), ideally rejecting power supply noise.\n   - The output voltage \\( V_o \\) reflects the amplified input with minimized noise effects.\n\n3. **Labels, Annotations, and Key Indicators:**\n   - \\( V_{id} \\), \\( V_{dd} \\), and \\( V_{ss} \\) are labeled for clarity.\n   - PSRR+ and PSRR- indicate the power supply rejection ratios.\n   - \\( A_0 \\) denotes the op-amp gain.\n   - Ground (GND) is referenced.\n\n4. **Overall System Function:**\n   - The system aims to amplify the differential input signal \\( V_{id} \\) while minimizing the impact of power supply variations \\( V_{dd} \\) and \\( V_{ss} \\). By modeling these variations as differential inputs, the system maximizes PSRR, ensuring stable op-amp performance despite power supply fluctuations.\n\n**Figure 6.13 Block Diagram:**\nThe block diagram in Figure 6.13 shows an op amp with supply variations modeled in the input differential loop, assuming $v_{i c}=0$.\n\nEquation 6.50 and Figure 6.13 highlight the importance of maximizing power-supply rejection ratios to minimize unwanted contributions to the op-amp output voltage. In practice, these rejection ratios are frequency-dependent and often decrease with increasing frequency.\n\nThe Power Supply Rejection Ratio (PSRR) has become a critical parameter in MOS amplifier design due to increased integration levels. With small-scale integration, only a few transistors could be placed on a single integrated circuit, allowing analog and digital functions to be isolated on separate chips, thus avoiding coupling from digital circuits to analog supplies. This separation also enabled filtering of digital interference at the printed-circuit-board level using external capacitors. However, with large-scale integration, many transistors can be integrated onto one chip, integrating analog and digital functions and increasing coupling to analog supplies. While monolithic filter capacitors can theoretically reduce supply variations, their required area is often impractically large. For instance, with an oxide thickness of $100 \\AA$, the capacitance per unit area is $3.45 \\mathrm{fF} / \\mu \\mathrm{m}^{2}$. A capacitor of $0.01 \\mu \\mathrm{~F}$, commonly used for filtering on printed-circuit boards, would require $1.7 \\mathrm{~mm}^{2}$, a significant fraction of the area of many integrated circuits, which often occupy less than $100 \\mathrm{~mm}^{2}$.\n\nTo lower costs, instead of solely focusing on filtering supply variations, an alternative is to design circuits with low sensitivity to these variations. Fully differential circuit techniques have emerged as a key strategy in this regard. These circuits represent all signals as differences between two corresponding quantities, such as voltages or currents. If two identical signal paths are used and the coupling from supply variations is the same for both, the difference can theoretically be independent of the supply variations. In practice, mismatches in signal paths and non-identical coupling can lead to imperfect cancellation. Additionally, significant power supply noise can cause nonlinearity, limiting the extent of cancellation. While the op amps discussed in this chapter have differential inputs, they are not fully differential since their outputs are single-ended. Fully differential op amps are covered in Chapter 12."
},
{
    "text": "In (6.44), we presumed that the power-supply voltages remain constant, ensuring that the op-amp output voltage is solely influenced by the differential and common-mode input voltages. However, in reality, the power-supply voltages are not entirely stable, and their fluctuations contribute to the op-amp's output. Figure 6.12 illustrates a block diagram of an op amp with fluctuating power-supply voltages. The small-signal variations in the positive and negative power supplies are denoted as $v_{d d}$ and $v_{s s}$, respectively. Assuming $v_{i c}=0$ for simplicity, the resulting small-signal op-amp output voltage is expressed as\n\n$$\n\\begin{equation*}\nv_{o}=A_{d m} v_{i d}+A^{+} v_{d d}+A^{-} v_{s s} \\tag{6.49}\n\\end{equation*}\n$$\n\nwhere $A^{+}$ and $A^{-}$ represent the small-signal gains from the positive and negative power supplies to the output, respectively. Since op amps should respond primarily to changes in their differential-mode input voltage and be less sensitive to supply voltage changes, the equation is rephrased for easier comparison of these gains:\n\n$$\n\\begin{align*}\nv_{o} & =A_{d m}\\left(v_{i d}+\\frac{A^{+}}{A_{d m}} v_{d d}+\\frac{A^{-}}{A_{d m}} v_{s s}\\right)  \\tag{6.50}\\\\\n& =A_{d m}\\left(v_{i d}+\\frac{v_{d d}}{\\mathrm{PSRR}^{+}}+\\frac{v_{s s}}{\\mathrm{PSRR}^{-}}\\right)\n\\end{align*}\n$$\n\nwhere\n\n$$\n\\begin{equation*}\n\\mathrm{PSRR}^{+}=\\frac{A_{d m}}{A^{+}} \\quad \\text { and } \\quad \\mathrm{PSRR}^{-}=\\frac{A_{d m}}{A^{-}} \\tag{6.51}\n\\end{equation*}\n$$\n\nFigure 6.13 offers an interpretation of (6.50), depicting the diagram from Fig. 6.12 with an op amp having constant power supplies. To equate the output in Fig. 6.13 to that in Fig. 6.12, the power-supply variations from Fig. 6.12 are incorporated as equivalent differential inputs.\n\nimage_name:Figure 6.13\ndescription:The block diagram in Figure 6.13 depicts an operational amplifier (op-amp) with power supply variations represented as differential inputs. The key components and system flow are as follows:\n\n1. **Main Components:**\n- **Operational Amplifier (Op-Amp):** Identified as \\( A_0 \\), it is the central element responsible for signal amplification.\n- **Input Voltage Sources:** Two sources, \\( v_{ic} \\) and \\( v_{id} \\), where \\( v_{ic} \\) is the common-mode voltage connected to both op-amp inputs, and \\( v_{id} \\) is split equally (\\( \\frac{v_{id}}{2} \\)) between the inputs.\n- **Power Supplies:** The op-amp is powered by \\( V_{DD} \\) and \\( V_{SS} \\), with variations \\( v_{dd} \\) and \\( v_{ss} \\).\n\n2. **Flow of Information or Control:**\n- Input signals \\( v_{ic} \\) and \\( v_{id} \\) are applied to the op-amp. \\( v_{ic} \\) is direct, while \\( v_{id} \\) is divided.\n- The op-amp amplifies the differential input, producing output voltage \\( v_o \\).\n- Power supply variations \\( v_{dd} \\) and \\( v_{ss} \\) are modeled as differential inputs affecting the op-amp.\n\n3. **Labels, Annotations, and Key Indicators:**\n- Inputs labeled \"InP(A_0)\" and \"InN(A_0)\" for non-inverting and inverting, respectively.\n- Output voltage \\( v_o \\) referenced to ground (GND).\n- Power supplies labeled \\( V_{DD} \\) and \\( V_{SS} \\) with variations \\( v_{dd} \\) and \\( v_{ss} \\).\n\n4. **Overall System Function:**\n- The diagram shows how power supply variations can be modeled as differential inputs, aiding in PSRR analysis to minimize their impact on the op-amp's output.\n\nFigure 6.12 Block diagram of an op amp with varying power-supply voltages.\nimage_name:Figure 6.13\ndescription:Figure 6.13 illustrates an op-amp circuit where power supply variations are modeled as differential inputs, aiding in PSRR analysis.\n\n1. **Main Components:**\n- **Differential Input Voltage Source (V_id):** Represented as \\( V_{id} \\), split into \\( \\frac{V_{id}}{2} \\) at the inputs.\n- **Power Supply Rejection Blocks (PSRR+ and PSRR-):** Model the rejection of variations from \\( V_{dd} \\) and \\( V_{ss} \\).\n- **Summing Nodes (x1):** Combine input differential voltage and power supply effects.\n- **Operational Amplifier (A_0):** Core amplifier with gain \\( A_0 \\), ideally rejecting power supply noise.\n\n2. **Flow of Information or Control:**\n- \\( V_{id} \\) is divided and fed into summing nodes.\n- Power supply variations \\( \\frac{V_{dd}}{\\text{PSRR+}} \\) and \\( \\frac{V_{ss}}{\\text{PSRR-}} \\) are combined with the differential input.\n- The summed input is amplified by \\( A_0 \\), producing \\( V_o \\) with minimized noise effects.\n\n3. **Labels, Annotations, and Key Indicators:**\n- \\( V_{id} \\), \\( V_{dd} \\), and \\( V_{ss} \\) indicate voltages.\n- PSRR+ and PSRR- show power supply rejection ratios.\n- \\( A_0 \\) denotes op-amp gain.\n- Ground (GND) is referenced.\n\n4. **Overall System Function:**\n- The system amplifies \\( V_{id} \\) while minimizing the impact of \\( V_{dd} \\) and \\( V_{ss} \\) variations, maximizing PSRR for stable performance.\n\nFigure 6.13 Block diagram of an op amp with supply variations modeled in the input differential loop and with $v_{i c}=0$.\nin Fig. 6.13. Equations 6.50 and Fig. 6.13 demonstrate that maximizing the power-supply rejection ratios is crucial to minimize unwanted contributions to the op-amp output voltage. Practically, these rejection ratios are frequency-dependent and often decrease with increasing frequency.\n\nThe power-supply rejection ratio has gained significance in MOS amplifier design due to higher integration levels. With small-scale integration, only a few transistors could be placed on a single chip, allowing analog and digital functions to be separated on different chips, thus reducing coupling from digital circuits to analog supplies. This separation also enabled filtering of digital interference at the PCB level using external capacitors. However, with large-scale integration, many transistors are placed on a single chip, integrating analog and digital functions and increasing coupling. While monolithic filter capacitors can theoretically reduce supply variations, their required area is substantial. For instance, with a $100 \\AA$ oxide thickness, the capacitance per unit area is $3.45 \\mathrm{fF} / \\mu \\mathrm{m}^{2}$. A $0.01 \\mu \\mathrm{~F}$ capacitor, common for PCB filtering, requires $1.7 \\mathrm{~mm}^{2}$, which is a significant fraction of many ICs with areas under $100 \\mathrm{~mm}^{2}$.\n\nTo lower costs, rather than focusing solely on filtering supply variations, designing circuits with low sensitivity to these variations is an alternative. Fully differential circuit techniques have become vital in this approach. These circuits represent signals as differences between corresponding quantities, like voltages or currents. If identical signal paths are used and supply variation coupling is equal, the difference can theoretically be independent of these variations. However, mismatches and non-identical coupling can lead to imperfect cancellation. Additionally, significant power supply noise can cause nonlinearity, limiting cancellation effectiveness. While the op amps discussed here have differential inputs, they are not fully differential due to their single-ended outputs. Fully differential op amps are covered in Chapter 12."
},
{
    "text": "In equation (6.44), we presumed that the power-supply voltages remain constant, ensuring that the op-amp output voltage is solely influenced by the differential and common-mode input voltages. However, in reality, these power-supply voltages are not perfectly stable, and their fluctuations contribute to the op-amp's output. Figure 6.12 illustrates a block diagram of an op amp subject to varying power-supply voltages. The small-signal variations in the positive and negative power supplies are denoted as $v_{d d}$ and $v_{s s}$, respectively. Assuming $v_{i c}=0$ for simplicity, the resulting small-signal op-amp output voltage is expressed as\n\n$$\n\\begin{equation*}\nv_{o}=A_{d m} v_{i d}+A^{+} v_{d d}+A^{-} v_{s s} \\tag{6.49}\n\\end{equation*}\n$$\n\nwhere $A^{+}$ and $A^{-}$ represent the small-signal gains from the positive and negative power supplies to the output, respectively. Since op amps should be responsive to changes in their differential-mode input voltage but insensitive to supply voltage changes, the equation is reformulated below for easier comparison of these gains:\n\n$$\n\\begin{align*}\nv_{o} & =A_{d m}\\left(v_{i d}+\\frac{A^{+}}{A_{d m}} v_{d d}+\\frac{A^{-}}{A_{d m}} v_{s s}\\right)  \\tag{6.50}\\\\\n& =A_{d m}\\left(v_{i d}+\\frac{v_{d d}}{\\mathrm{PSRR}^{+}}+\\frac{v_{s s}}{\\mathrm{PSRR}^{-}}\\right)\n\\end{align*}\n$$\n\nwhere\n\n$$\n\\begin{equation*}\n\\mathrm{PSRR}^{+}=\\frac{A_{d m}}{A^{+}} \\quad \\text { and } \\quad \\mathrm{PSRR}^{-}=\\frac{A_{d m}}{A^{-}} \\tag{6.51}\n\\end{equation*}\n$$\n\nFigure 6.13 presents an interpretation of equation (6.50), where the diagram from Fig. 6.12 is revised to depict an op amp with constant power supplies. To equate the output in Fig. 6.13 with that in Fig. 6.12, the power-supply variations from Fig. 6.12 are incorporated as equivalent differential inputs.\n\n**Figure 6.13 Description:**\nThe block diagram in Figure 6.13 illustrates an operational amplifier (op-amp) with power supply variations represented as differential inputs. The key components and system flow are as follows:\n\n1. **Main Components:**\n- **Operational Amplifier (Op-Amp):** Identified as \\( A_0 \\), it is the central element responsible for signal amplification.\n- **Input Voltage Sources:** Two input voltage sources, \\( v_{ic} \\) and \\( v_{id} \\), where \\( v_{ic} \\) is the common-mode voltage applied to both op-amp inputs, and \\( v_{id} \\) is split equally (\\( \\frac{v_{id}}{2} \\)) between the inputs.\n- **Power Supplies:** The op-amp is powered by \\( V_{DD} \\) and \\( V_{SS} \\), with variations \\( v_{dd} \\) and \\( v_{ss} \\).\n\n2. **Flow of Information or Control:**\n- Input signals \\( v_{ic} \\) and \\( v_{id} \\) are applied to the op-amp. \\( v_{ic} \\) is direct, while \\( v_{id} \\) is divided.\n- The op-amp amplifies the differential input, producing output voltage \\( v_o \\).\n- Power supply variations \\( v_{dd} \\) and \\( v_{ss} \\) are modeled as differential inputs affecting the op-amp.\n\n3. **Labels, Annotations, and Key Indicators:**\n- Inputs labeled \"InP(A_0)\" and \"InN(A_0)\" for non-inverting and inverting, respectively.\n- Output voltage \\( v_o \\) referenced to ground (GND).\n- Power supply voltages \\( V_{DD} \\) and \\( V_{SS} \\) with variations \\( v_{dd} \\) and \\( v_{ss} \\).\n\n4. **Overall System Function:**\n- The diagram demonstrates how power supply variations can be modeled as differential inputs, aiding in PSRR analysis to minimize their impact on the op-amp's output.\n\n**Figure 6.13 Description (Revised):**\nFigure 6.13's block diagram models an op-amp circuit with power supply variations as differential inputs, aiding in PSRR analysis to minimize output impact.\n\n1. **Main Components:**\n- **Differential Input Voltage Source (V_id):** Represented as \\( V_{id} \\), split into \\( \\frac{V_{id}}{2} \\) at the inputs.\n- **Power Supply Rejection Blocks (PSRR+ and PSRR-):** Model the rejection of variations from \\( V_{dd} \\) and \\( V_{ss} \\).\n- **Summing Nodes (x1):** Combine input differential voltage and power supply effects.\n- **Operational Amplifier (A_0):** Core amplifier with gain \\( A_0 \\), ideally rejecting power supply noise.\n\n2. **Flow of Information or Control:**\n- \\( V_{id} \\) is divided and fed into summing nodes.\n- Power supply variations \\( \\frac{V_{dd}}{\\text{PSRR+}} \\) and \\( \\frac{V_{ss}}{\\text{PSRR-}} \\) are combined with the differential input.\n- The summed input is amplified by \\( A_0 \\), ideally rejecting noise.\n- Output voltage \\( V_o \\) reflects the amplified signal with minimized noise effects.\n\n3. **Labels, Annotations, and Key Indicators:**\n- \\( V_{id} \\), \\( V_{dd} \\), and \\( V_{ss} \\) indicate voltages.\n- PSRR+ and PSRR- show power supply rejection ratios.\n- \\( A_0 \\) denotes op-amp gain.\n- Ground (GND) is referenced.\n\n4. **Overall System Function:**\n- The system amplifies \\( V_{id} \\) while minimizing the impact of \\( V_{dd} \\) and \\( V_{ss} \\) variations, maximizing PSRR for stable performance.\n\n**Figure 6.13 Block Diagram:**\nFigure 6.13 depicts an op amp with supply variations modeled in the input differential loop, assuming $v_{i c}=0$.\n\nEquation 6.50 and Figure 6.13 highlight the need to maximize power-supply rejection ratios to minimize unwanted contributions to the op-amp output voltage. Practically, these ratios are frequency-dependent and often decrease with increasing frequency.\n\nThe power-supply rejection ratio has gained significance in MOS amplifier design due to rising integration levels. With small-scale integration, few transistors were placed on a single chip, allowing analog and digital functions to be separated on different chips, thus reducing coupling from digital circuits to analog supplies. This separation also enabled filtering interference at the PCB level using external capacitors parallel to the supplies. However, with large-scale integration, many transistors are integrated on one chip, combining analog and digital functions and increasing coupling. While monolithic filter capacitors can理论上 reduce supply variations, their required area is impractically large. For instance, with a $100 \\AA$ oxide thickness, the capacitance per unit area is $3.45 \\mathrm{fF} / \\mu \\mathrm{m}^{2}$. A $0.01 \\mu \\mathrm{~F}$ capacitor (common for PCB filtering) requires $1.7 \\mathrm{~mm}^{2}$, a significant fraction of many ICs' area, which is often less than $100 \\mathrm{~mm}^{2}$.\n\nTo lower costs, instead of solely focusing on filtering supply variations, designing circuits with low sensitivity to these variations is an alternative. Fully differential circuit techniques have become vital in this approach, representing signals as differences between corresponding quantities like voltages or currents. If identical signal paths are used and supply variation coupling is equal, the difference can theoretically be independent of these variations. However, mismatches and non-identical coupling in practice lead to imperfect cancellation. Additionally, significant power supply noise can cause nonlinearity, limiting cancellation. While the op amps discussed here have differential inputs, they are not fully differential due to their single-ended outputs. Fully differential op amps are covered in Chapter 12."
},
{
    "text": "In (6.44), it was assumed that the power-supply voltages remain constant, meaning the op-amp output voltage solely depends on the differential and common-mode input voltages. However, in reality, power-supply voltages are not perfectly stable, and their fluctuations contribute to the op-amp's output. Figure 6.12 illustrates a block diagram of an op amp with fluctuating power-supply voltages. The small-signal variations in the positive and negative power supplies are denoted as $v_{d d}$ and $v_{s s}$, respectively. Assuming $v_{i c}=0$ for simplicity, the resulting small-signal op-amp output voltage is given by\n\n$$\n\\begin{equation*}\nv_{o}=A_{d m} v_{i d}+A^{+} v_{d d}+A^{-} v_{s s} \\tag{6.49}\n\\end{equation*}\n$$\n\nwhere $A^{+}$ and $A^{-}$ represent the small-signal gains from the positive and negative power supplies to the output, respectively. Since op amps should respond to changes in their differential-mode input voltage but remain unaffected by supply voltage changes, the equation is rephrased for easier comparison of these gains:\n\n$$\n\\begin{align*}\nv_{o} & =A_{d m}\\left(v_{i d}+\\frac{A^{+}}{A_{d m}} v_{d d}+\\frac{A^{-}}{A_{d m}} v_{s s}\\right)  \\tag{6.50}\\\\\n& =A_{d m}\\left(v_{i d}+\\frac{v_{d d}}{\\mathrm{PSRR}^{+}}+\\frac{v_{s s}}{\\mathrm{PSRR}^{-}}\\right)\n\\end{align*}\n$$\n\nwhere\n\n$$\n\\begin{equation*}\n\\mathrm{PSRR}^{+}=\\frac{A_{d m}}{A^{+}} \\quad \\text { and } \\quad \\mathrm{PSRR}^{-}=\\frac{A_{d m}}{A^{-}} \\tag{6.51}\n\\end{equation*}\n$$\n\nFigure 6.13 provides an interpretation of (6.50), where the diagram in Fig. 6.12 is reconfigured using an op amp with constant power supplies. To equate the output in Fig. 6.13 to that in Fig. 6.12, the power-supply variations from Fig. 6.12 are incorporated as equivalent differential inputs.\n\nFigure 6.13 depicts a block diagram of an operational amplifier (op-amp) with power supply variations represented as differential inputs. The key components and system flow are as follows:\n\n1. **Main Components:**\n- **Operational Amplifier (Op-Amp):** Identified as \\( A_0 \\), it is the central element responsible for signal amplification.\n- **Input Voltage Sources:** Two sources, \\( v_{ic} \\) and \\( v_{id} \\), where \\( v_{ic} \\) is the common-mode voltage applied to both op-amp inputs, and \\( v_{id} \\) is split equally (\\( \\frac{v_{id}}{2} \\)) between the inputs.\n- **Power Supplies:** The op-amp is powered by \\( V_{DD} \\) and \\( V_{SS} \\), with variations \\( v_{dd} \\) and \\( v_{ss} \\).\n\n2. **Flow of Information or Control:**\n- Input signals \\( v_{ic} \\) and \\( v_{id} \\) are applied to the op-amp. \\( v_{ic} \\) is direct, while \\( v_{id} \\) is divided.\n- The op-amp amplifies the differential input, producing output voltage \\( v_o \\).\n- Power supply variations \\( v_{dd} \\) and \\( v_{ss} \\) are modeled as differential inputs affecting the op-amp.\n\n3. **Labels, Annotations, and Key Indicators:**\n- Inputs labeled \"InP(A_0)\" and \"InN(A_0)\" for non-inverting and inverting, respectively.\n- Output voltage \\( v_o \\) referenced to ground (GND).\n- Power supplies labeled \\( V_{DD} \\) and \\( V_{SS} \\) with variations \\( v_{dd} \\) and \\( v_{ss} \\).\n\n4. **Overall System Function:**\n- The diagram demonstrates how power supply variations can be modeled as differential inputs, aiding in PSRR analysis to minimize their impact on the op-amp's output.\n\nFigure 6.13 also represents an op-amp circuit modeling power supply variations as differential inputs to analyze and optimize PSRR, reducing their effect on the output.\n\n1. **Main Components:**\n- **Differential Input Voltage Source (V_id):** Split into \\( \\frac{V_{id}}{2} \\) at the inputs.\n- **Power Supply Rejection Blocks (PSRR+ and PSRR-):** Model rejection of supply variations.\n- **Summing Nodes (x1):** Combine input voltage and supply variations.\n- **Operational Amplifier (A_0):** Amplifies input while ideally rejecting supply noise.\n\n2. **Flow of Information or Control:**\n- Differential input \\( V_{id} \\) and supply variations \\( \\frac{V_{dd}}{\\text{PSRR+}} \\) and \\( \\frac{V_{ss}}{\\text{PSRR-}} \\) are summed.\n- The summed input is amplified by \\( A_0 \\), ideally rejecting supply noise.\n- Output voltage \\( V_o \\) reflects the amplified signal with minimized noise.\n\n3. **Labels, Annotations, and Key Indicators:**\n- Voltages \\( V_{id} \\), \\( V_{dd} \\), and \\( V_{ss} \\) labeled.\n- PSRR+ and PSRR- annotated.\n- Gain \\( A_0 \\) and ground (GND) indicated.\n\n4. **Overall System Function:**\n- Amplifies \\( V_{id} \\) while minimizing supply voltage impact, maximizing PSRR for stable performance.\n\nEquation 6.50 and Fig. 6.13 highlight the need to maximize power-supply rejection ratios to minimize unwanted contributions to the op-amp output. Practically, these ratios are frequency-dependent and often decrease with increasing frequency.\n\nPower-supply rejection ratio is increasingly crucial in MOS amplifier design due to higher integration levels. With small-scale integration, few transistors were placed on a single chip, isolating analog and digital functions on separate chips and allowing external filtering of digital interference. However, large-scale integration allows many transistors on one chip, integrating analog and digital functions, increasing coupling to analog supplies. Monolithic filter capacitors could mitigate this, but their required area is impractically large. For instance, a $0.01 \\mu \\mathrm{~F}$ capacitor with a $100 \\AA$ oxide thickness requires $1.7 \\mathrm{~mm}^{2}$, significant for many ICs under $100 \\mathrm{~mm}^{2}$.\n\nTo reduce costs, instead of solely focusing on filtering supply variations, designing circuits with low sensitivity to these variations is an alternative. Fully differential circuit techniques are vital in this approach, representing signals as differences between corresponding quantities. If two identical signal paths are used, and supply variation coupling is equal, the difference can be independent of these variations. However, mismatches and nonlinearity can limit this cancellation. While this chapter's op amps have differential inputs, they are not fully differential as their outputs are single-ended. Fully differential op amps are discussed in Chapter 12."
},
{
    "text": "In (6.44), we presumed that the power-supply voltages remain constant, ensuring the op-amp output voltage is solely influenced by the differential and common-mode input voltages. However, in reality, these voltages are not entirely stable, and their fluctuations contribute to the op-amp's output. Figure 6.12 illustrates a block diagram of an op amp with fluctuating power-supply voltages. The small-signal variations in the positive and negative power supplies are denoted as $v_{d d}$ and $v_{s s}$, respectively. Assuming $v_{i c}=0$ for simplicity, the resulting small-signal op-amp output voltage is expressed as\n\n$$\n\\begin{equation*}\nv_{o}=A_{d m} v_{i d}+A^{+} v_{d d}+A^{-} v_{s s} \\tag{6.49}\n\\end{equation*}\n$$\n\nwhere $A^{+}$ and $A^{-}$ represent the small-signal gains from the positive and negative power supplies to the output, respectively. Since op amps should be responsive to changes in their differential-mode input voltage but insensitive to supply voltage changes, the equation is restructured below for easier comparison of these gains:\n\n$$\n\\begin{align*}\nv_{o} & =A_{d m}\\left(v_{i d}+\\frac{A^{+}}{A_{d m}} v_{d d}+\\frac{A^{-}}{A_{d m}} v_{s s}\\right)  \\tag{6.50}\\\\\n& =A_{d m}\\left(v_{i d}+\\frac{v_{d d}}{\\mathrm{PSRR}^{+}}+\\frac{v_{s s}}{\\mathrm{PSRR}^{-}}\\right)\n\\end{align*}\n$$\n\nwhere\n\n$$\n\\begin{equation*}\n\\mathrm{PSRR}^{+}=\\frac{A_{d m}}{A^{+}} \\quad \\text { and } \\quad \\mathrm{PSRR}^{-}=\\frac{A_{d m}}{A^{-}} \\tag{6.51}\n\\end{equation*}\n$$\n\nFigure 6.13 offers one interpretation of (6.50), where the diagram in Fig. 6.12 is reconfigured using an op amp with constant power supplies. To equate the output in Fig. 6.13 with that in Fig. 6.12, the power-supply variations from Fig. 6.12 are incorporated as equivalent differential inputs.\n\nimage_name:Figure 6.13\ndescription:Figure 6.13 depicts a block diagram of an operational amplifier (op-amp) with power supply variations represented as differential inputs. The key components and system flow are as follows:\n\n1. **Main Components:**\n- **Operational Amplifier (Op-Amp):** Identified as \\( A_0 \\), it is the central element responsible for signal amplification.\n- **Input Voltage Sources:** Two sources, \\( v_{ic} \\) and \\( v_{id} \\), where \\( v_{ic} \\) is the common-mode voltage connected to both op-amp inputs, and \\( v_{id} \\) is split equally (\\( \\frac{v_{id}}{2} \\)) between the inputs.\n- **Power Supplies:** The op-amp is powered by \\( V_{DD} \\) and \\( V_{SS} \\), with variations \\( v_{dd} \\) and \\( v_{ss} \\).\n\n2. **Flow of Information or Control:**\n- Input signals \\( v_{ic} \\) and \\( v_{id} \\) are applied to the op-amp. \\( v_{ic} \\) is direct, while \\( v_{id} \\) is divided.\n- The op-amp amplifies the differential input, producing output voltage \\( v_o \\).\n- Power supply variations \\( v_{dd} \\) and \\( v_{ss} \\) are modeled as differential inputs affecting the op-amp.\n\n3. **Labels, Annotations, and Key Indicators:**\n- Inputs labeled \"InP(A_0)\" and \"InN(A_0)\" for non-inverting and inverting, respectively.\n- Output voltage \\( v_o \\) referenced to ground (GND).\n- Power supplies labeled \\( V_{DD} \\) and \\( V_{SS} \\) with variations \\( v_{dd} \\) and \\( v_{ss} \\).\n\n4. **Overall System Function:**\n- The diagram shows how power supply variations can be modeled as differential inputs, aiding in PSRR analysis to minimize their impact on the op-amp's output, ensuring stable operation.\n\nFigure 6.12 Block diagram of an op amp with varying power-supply voltages.\nimage_name:Figure 6.13\ndescription:Figure 6.13 illustrates an op-amp circuit modeling power supply variations as differential inputs to analyze and optimize PSRR, reducing their impact on the output.\n\n1. **Main Components:**\n- **Differential Input Voltage Source (V_id):** Represented as \\( V_{id} \\), split into \\( \\frac{V_{id}}{2} \\) at the inputs.\n- **Power Supply Rejection Blocks (PSRR+ and PSRR-):** Model the rejection of variations from \\( V_{dd} \\) and \\( V_{ss} \\).\n- **Summing Nodes (x1):** Combine input differential voltage and power supply effects.\n- **Operational Amplifier (A_0):** Core amplifier with gain \\( A_0 \\), ideally rejecting power supply noise.\n\n2. **Flow of Information or Control:**\n- \\( V_{id} \\) is divided and fed into summing nodes.\n- Power supply variations \\( \\frac{V_{dd}}{\\text{PSRR+}} \\) and \\( \\frac{V_{ss}}{\\text{PSRR-}} \\) are combined with \\( V_{id} \\).\n- The summed input is amplified by \\( A_0 \\), ideally minimizing power supply noise.\n- Output voltage \\( V_o \\) reflects the amplified signal with reduced noise.\n\n3. **Labels, Annotations, and Key Indicators:**\n- \\( V_{id} \\), \\( V_{dd} \\), and \\( V_{ss} \\) indicate voltages.\n- PSRR+ and PSRR- show power supply rejection ratios.\n- \\( A_0 \\) denotes op-amp gain.\n- Ground (GND) is referenced.\n\n4. **Overall System Function:**\n- The system amplifies \\( V_{id} \\) while minimizing the impact of \\( V_{dd} \\) and \\( V_{ss} \\) variations, maximizing PSRR for stable performance.\n\nFigure 6.13 Block diagram of an op amp with supply variations modeled in the input differential loop and with $v_{i c}=0$.\nin Fig. 6.13. Equations 6.50 and Fig. 6.13 highlight the need to maximize power-supply rejection ratios to minimize unwanted contributions to the op-amp output voltage. Practically, these ratios are frequency-dependent and often decrease with increasing frequency.\n\nThe power-supply rejection ratio has gained significance in MOS amplifier design due to rising integration levels. With small-scale integration, only a few transistors were placed on a single integrated circuit, allowing analog and digital functions to be separated on different chips, thus reducing coupling from digital circuits to analog supplies. This separation also facilitated interference filtering at the printed-circuit-board level using external capacitors. However, with large-scale integration, many transistors are integrated on one chip, combining analog and digital functions and increasing coupling. While monolithic filter capacitors can theoretically reduce supply variations, their required areas are impractically large. For instance, with a $100 \\AA$ oxide thickness, the capacitance per unit area is $3.45 \\mathrm{fF} / \\mu \\mathrm{m}^{2}$. A $0.01 \\mu \\mathrm{~F}$ capacitor (common for filtering on printed-circuit boards) would need $1.7 \\mathrm{~mm}^{2}$, a significant fraction of many integrated circuits' area, which often occupy less than $100 \\mathrm{~mm}^{2}$.\n\nTo lower costs, focusing solely on filtering supply variations is not the only solution; designing circuits with low sensitivity to these variations is another approach. Fully differential circuit techniques have become crucial in this regard. These circuits represent signals as differences between corresponding quantities, like voltages or currents. If identical signal paths are used and supply variation coupling is consistent, the difference can theoretically be independent of these variations. In practice, mismatches and non-identical coupling limit cancellation effectiveness. Additionally, significant power supply noise can induce nonlinearity, further restricting cancellation. While the op amps discussed here have differential inputs, they are not fully differential due to their single-ended outputs. Fully differential op amps are covered in Chapter 12."
},
{
    "text": "In equation (6.44), we presumed that the power-supply voltages remain constant, ensuring that the op-amp output voltage is solely influenced by the differential and common-mode input voltages fed to the op amp. However, in reality, the power-supply voltages are not perfectly stable, and their fluctuations contribute to the op-amp's output. Figure 6.12 illustrates a block diagram of an op amp subject to variable power-supply voltages. The small-signal variations in the positive and negative power supplies are denoted as $v_{d d}$ and $v_{s s}$, respectively. Assuming $v_{i c}=0$ for simplicity, the resulting small-signal op-amp output voltage is expressed as\n\n$$\n\\begin{equation*}\nv_{o}=A_{d m} v_{i d}+A^{+} v_{d d}+A^{-} v_{s s} \\tag{6.49}\n\\end{equation*}\n$$\n\nwhere $A^{+}$ and $A^{-}$ represent the small-signal gains from the positive and negative power supplies to the output, respectively. Since op amps should be responsive to changes in their differential-mode input voltage but insensitive to variations in their supply voltages, the equation is restructured below for easier comparison of these gains:\n\n$$\n\\begin{align*}\nv_{o} & =A_{d m}\\left(v_{i d}+\\frac{A^{+}}{A_{d m}} v_{d d}+\\frac{A^{-}}{A_{d m}} v_{s s}\\right)  \\tag{6.50}\\\\\n& =A_{d m}\\left(v_{i d}+\\frac{v_{d d}}{\\mathrm{PSRR}^{+}}+\\frac{v_{s s}}{\\mathrm{PSRR}^{-}}\\right)\n\\end{align*}\n$$\n\nwhere\n\n$$\n\\begin{equation*}\n\\mathrm{PSRR}^{+}=\\frac{A_{d m}}{A^{+}} \\quad \\text { and } \\quad \\mathrm{PSRR}^{-}=\\frac{A_{d m}}{A^{-}} \\tag{6.51}\n\\end{equation*}\n$$\n\nFigure 6.13 provides an interpretation of (6.50), where the diagram in Fig. 6.12 is reconfigured using an op amp with constant power supplies. To equate the output in Fig. 6.13 to that in Fig. 6.12, the power-supply variations from Fig. 6.12 are incorporated as equivalent differential inputs.\n\n**Figure 6.13 Description:**\nThe block diagram in Figure 6.13 depicts an operational amplifier (op-amp) with power supply variations represented as differential inputs. The key components and system flow are as follows:\n\n1. **Main Components:**\n- **Operational Amplifier (Op-Amp):** Identified as \\( A_0 \\), it is the central element responsible for signal amplification.\n- **Input Voltage Sources:** Two input voltage sources, \\( v_{ic} \\) and \\( v_{id} \\), where \\( v_{ic} \\) is the common-mode voltage connected to both op-amp inputs, and \\( v_{id} \\) is split equally (\\( \\frac{v_{id}}{2} \\)) between the inputs.\n- **Power Supplies:** The op-amp is powered by \\( V_{DD} \\) and \\( V_{SS} \\), with variations \\( v_{dd} \\) and \\( v_{ss} \\).\n\n2. **Flow of Information or Control:**\n- Input signals \\( v_{ic} \\) and \\( v_{id} \\) are applied to the op-amp inputs. \\( v_{ic} \\) is direct, while \\( v_{id} \\) is divided.\n- The op-amp amplifies the differential input, generating output voltage \\( v_o \\).\n- Power supply variations \\( v_{dd} \\) and \\( v_{ss} \\) are modeled as differential inputs affecting the op-amp.\n\n3. **Labels, Annotations, and Key Indicators:**\n- Inputs labeled \"InP(A_0)\" for non-inverting and \"InN(A_0)\" for inverting.\n- Output voltage \\( v_o \\) referenced to ground (GND).\n- Power supply voltages \\( V_{DD} \\) and \\( V_{SS} \\) with variations \\( v_{dd} \\) and \\( v_{ss} \\).\n\n4. **Overall System Function:**\n- The diagram shows how power supply variations are modeled as differential inputs, aiding in PSRR analysis to minimize their impact on the op-amp's output, ensuring stable operation.\n\n**Figure 6.13 Description:**\nThe block diagram in Figure 6.13 models an operational amplifier (op-amp) circuit, illustrating the impact of power supply variations as differential inputs. This setup aids in analyzing and enhancing the Power Supply Rejection Ratio (PSRR), thereby reducing the influence of these variations on the op-amp's output.\n\n1. **Main Components:**\n- **Differential Input Voltage Source (V_id):** Represented as \\( V_{id} \\), split into \\( \\frac{V_{id}}{2} \\) at the positive and negative input terminals.\n- **Power Supply Rejection Blocks (PSRR+ and PSRR-):** Model the rejection of power supply variations from \\( V_{dd} \\) and \\( V_{ss} \\).\n- **Summing Nodes (x1):** Combine input differential voltage and power supply variation effects.\n- **Operational Amplifier (A_0):** Core amplifier with gain \\( A_0 \\), amplifying the differential input while ideally rejecting power supply noise.\n\n2. **Flow of Information or Control:**\n- Differential input \\( V_{id} \\) is divided and fed into summing nodes.\n- Power supply variations \\( \\frac{V_{dd}}{\\text{PSRR+}} \\) and \\( \\frac{V_{ss}}{\\text{PSRR-}} \\) are combined with the differential input.\n- The summed input is amplified by \\( A_0 \\), ideally rejecting power supply noise.\n- Output voltage \\( V_o \\) reflects the amplified signal with minimized noise effects.\n\n3. **Labels, Annotations, and Key Indicators:**\n- \\( V_{id} \\), \\( V_{dd} \\), and \\( V_{ss} \\) indicate input and supply voltages.\n- PSRR+ and PSRR- show power supply rejection ratios.\n- \\( A_0 \\) denotes op-amp gain.\n- Ground (GND) is referenced.\n\n4. **Overall System Function:**\n- The system amplifies \\( V_{id} \\) while minimizing the impact of \\( V_{dd} \\) and \\( V_{ss} \\) variations. By modeling these variations as differential inputs, it maximizes PSRR for stable op-amp performance despite power supply fluctuations.\n\n**Figure 6.13 Block diagram of an op amp with supply variations modeled in the input differential loop and with $v_{i c}=0$.**\n\nEquation 6.50 and Fig. 6.13 demonstrate that maximizing the power-supply rejection ratios is crucial to minimize unwanted contributions to the op-amp output voltage. Practically, these rejection ratios are frequency-dependent and often decrease with increasing frequency.\n\nThe Power Supply Rejection Ratio (PSRR) has gained significance in MOS amplifier design due to higher integration levels. With small-scale integration, only a few transistors were integrated per chip, allowing analog and digital functions to be separated on different chips, thus reducing coupling from digital circuits to analog supplies. This separation also enabled filtering interference at the PCB level using external capacitors parallel to the supplies. However, with large-scale integration, numerous transistors are integrated on a single chip, integrating analog and digital functions and increasing coupling to analog supplies. While monolithic filter capacitors can theoretically mitigate supply variations, their required area is substantial. For instance, with a $100 \\AA$ oxide thickness, the capacitance per unit area is $3.45 \\mathrm{fF} / \\mu \\mathrm{m}^{2}$. A $0.01 \\mu \\mathrm{~F}$ capacitor (commonly used for PCB supply filtering) requires $1.7 \\mathrm{~mm}^{2}$, a significant fraction of many integrated circuits' area, which is often less than $100 \\mathrm{~mm}^{2}$.\n\nTo lower costs, instead of solely focusing on filtering supply variations, an alternative is to design circuits with low sensitivity to these variations. Fully differential circuit techniques have emerged as a vital tool in this approach. These circuits represent all signals as differences between corresponding quantities, like voltages or currents. If identical signal paths are used and coupling from supply variations is equal, the difference can theoretically be independent of these variations. Practically, mismatches cause differences in signal paths, and coupling may not be identical, leading to imperfect cancellation. Additionally, significant power supply noise can cause nonlinearity, limiting cancellation. While the op amps discussed in this chapter have differential inputs, they are not fully differential as their outputs are single-ended. Fully differential op amps are covered in Chapter 12."
},
{
    "text": "In (6.44), it was assumed that the power-supply voltages remain constant, leading to the op-amp output voltage being solely dependent on the differential and common-mode input voltages. However, in reality, the power-supply voltages are not perfectly stable, and their fluctuations contribute to the op-amp's output. Figure 6.12 illustrates a block diagram of an op amp with fluctuating power-supply voltages. The small-signal variations in the positive and negative power supplies are denoted as $v_{d d}$ and $v_{s s}$, respectively. Assuming $v_{i c}=0$ for simplicity, the resulting small-signal op-amp output voltage is given by\n\n$$\n\\begin{equation*}\nv_{o}=A_{d m} v_{i d}+A^{+} v_{d d}+A^{-} v_{s s} \\tag{6.49}\n\\end{equation*}\n$$\n\nwhere $A^{+}$ and $A^{-}$ represent the small-signal gains from the positive and negative power supplies to the output, respectively. Since op amps should be responsive to changes in their differential-mode input voltage but insensitive to supply voltage changes, the equation is rephrased for easier comparison of these gains:\n\n$$\n\\begin{align*}\nv_{o} & =A_{d m}\\left(v_{i d}+\\frac{A^{+}}{A_{d m}} v_{d d}+\\frac{A^{-}}{A_{d m}} v_{s s}\\right)  \\tag{6.50}\\\\\n& =A_{d m}\\left(v_{i d}+\\frac{v_{d d}}{\\mathrm{PSRR}^{+}}+\\frac{v_{s s}}{\\mathrm{PSRR}^{-}}\\right)\n\\end{align*}\n$$\n\nwhere\n\n$$\n\\begin{equation*}\n\\mathrm{PSRR}^{+}=\\frac{A_{d m}}{A^{+}} \\quad \\text { and } \\quad \\mathrm{PSRR}^{-}=\\frac{A_{d m}}{A^{-}} \\tag{6.51}\n\\end{equation*}\n$$\n\nFigure 6.13 presents an interpretation of (6.50), where the diagram from Fig. 6.12 is modified to use an op amp with constant power supplies. To equate the output in Fig. 6.13 to that in Fig. 6.12, the power-supply variations from Fig. 6.12 are incorporated as equivalent differential inputs.\n\nThe block diagram in Figure 6.13 depicts an operational amplifier (op-amp) with power supply variations represented as differential inputs. The key components and system flow are as follows:\n\n1. **Main Components:**\n- **Operational Amplifier (Op-Amp):** Identified as \\( A_0 \\), it is the central element responsible for signal amplification.\n- **Input Voltage Sources:** Two sources, \\( v_{ic} \\) and \\( v_{id} \\), where \\( v_{ic} \\) is the common-mode voltage connected to both op-amp inputs, and \\( v_{id} \\) is split equally (\\( \\frac{v_{id}}{2} \\)) between the inputs.\n- **Power Supplies:** The op-amp is powered by \\( V_{DD} \\) and \\( V_{SS} \\), with variations \\( v_{dd} \\) and \\( v_{ss} \\).\n\n2. **Flow of Information or Control:**\n- Input signals \\( v_{ic} \\) and \\( v_{id} \\) are applied to the op-amp, with \\( v_{ic} \\) directly applied and \\( v_{id} \\) split.\n- The op-amp amplifies the differential input, producing output voltage \\( v_o \\).\n- Power supply variations \\( v_{dd} \\) and \\( v_{ss} \\) are modeled as differential inputs affecting the op-amp.\n\n3. **Labels, Annotations, and Key Indicators:**\n- Inputs labeled \"InP(A_0)\" and \"InN(A_0)\" for non-inverting and inverting inputs, respectively.\n- Output voltage \\( v_o \\) referenced to ground (GND).\n- Power supply voltages \\( V_{DD} \\) and \\( V_{SS} \\) with variations \\( v_{dd} \\) and \\( v_{ss} \\).\n\n4. **Overall System Function:**\n- The diagram demonstrates how power supply variations can be modeled as differential inputs, aiding in PSRR analysis to minimize their impact on the op-amp's output.\n\nFigure 6.12 shows a block diagram of an op amp with varying power-supply voltages.\n\nThe block diagram in Figure 6.13 represents an operational amplifier (op-amp) circuit designed to model the influence of power supply variations as differential inputs, analyzing and optimizing the Power Supply Rejection Ratio (PSRR) to minimize their impact on the op-amp's output.\n\n1. **Main Components:**\n- **Differential Input Voltage Source (V_id):** Represented as \\( V_{id} \\), split into \\( \\frac{V_{id}}{2} \\) at the positive and negative input terminals.\n- **Power Supply Rejection Blocks (PSRR+ and PSRR-):** Model the rejection of variations from \\( V_{dd} \\) and \\( V_{ss} \\).\n- **Summing Nodes (x1):** Combine input differential voltage and power supply variation effects.\n- **Operational Amplifier (A_0):** The core amplifier with gain \\( A_0 \\), amplifying the input signal while ideally rejecting power supply noise.\n\n2. **Flow of Information or Control:**\n- Differential input \\( V_{id} \\) is divided and fed into summing nodes.\n- Power supply variations \\( \\frac{V_{dd}}{\\text{PSRR+}} \\) and \\( \\frac{V_{ss}}{\\text{PSRR-}} \\) are combined with the differential input.\n- The summed input is amplified by \\( A_0 \\), ideally rejecting power supply noise.\n- Output voltage \\( V_o \\) reflects the amplified signal with minimized noise effects.\n\n3. **Labels, Annotations, and Key Indicators:**\n- \\( V_{id} \\), \\( V_{dd} \\), and \\( V_{ss} \\) indicate input and supply voltages.\n- PSRR+ and PSRR- denote power supply rejection ratios.\n- \\( A_0 \\) represents the op-amp gain.\n- Ground (GND) is indicated for reference.\n\n4. **Overall System Function:**\n- The system amplifies the differential input \\( V_{id} \\) while minimizing the impact of power supply variations \\( V_{dd} \\) and \\( V_{ss} \\), maximizing PSRR for stable performance.\n\nFigure 6.13 shows a block diagram of an op amp with supply variations modeled in the input differential loop and with $v_{i c}=0$.\n\nEquation 6.50 and Fig. 6.13 indicate that maximizing the power-supply rejection ratios is crucial to minimize undesired contributions to the op-amp output voltage. In practice, these rejection ratios are frequency-dependent and often decrease with increasing frequency.\n\nThe Power Supply Rejection Ratio (PSRR) has become a critical parameter in MOS amplifier design due to higher integration levels. With small-scale integration, few transistors were placed on a single integrated circuit, allowing analog and digital functions to be isolated on separate chips, reducing coupling from digital circuits to analog supplies. This separation also enabled filtering of digital interference at the printed-circuit-board level using external capacitors. However, with large-scale integration, many transistors are integrated on one chip, integrating analog and digital functions and increasing coupling to analog supplies. While monolithic filter capacitors can理论上 be used to mitigate supply variations, their required area is substantial. For instance, with an oxide thickness of $100 \\AA$, the capacitance per unit area is $3.45 \\mathrm{fF} / \\mu \\mathrm{m}^{2}$. A $0.01 \\mu \\mathrm{~F}$ capacitor, common for filtering on printed-circuit boards, would require $1.7 \\mathrm{~mm}^{2}$, a significant fraction of the area for many integrated circuits occupying less than $100 \\mathrm{~mm}^{2}$.\n\nTo lower costs, instead of solely focusing on filtering supply variations, an alternative is to design circuits with low sensitivity to these variations. Fully differential circuit techniques have emerged as a key tool in this approach. These circuits represent all signals as differences between two corresponding quantities, such as voltages or currents. If two identical signal paths are used and the coupling from supply variations is the same for both quantities, the difference can theoretically be independent of the supply variations. In practice, mismatches in signal paths and non-identical coupling can lead to imperfect cancellation. Additionally, significant power supply noise can cause nonlinearity, limiting cancellation effectiveness. While the op amps discussed in this chapter have differential inputs, they are not fully differential due to their single-ended outputs. Fully differential op amps are covered in Chapter 12."
},
{
    "text": "In bipolar transistor input stages, the input resistance generally falls within the range of $100 \\mathrm{k} \\Omega$ to $1 \\mathrm{M} \\Omega$. Nevertheless, the voltage gain is typically so substantial that this input resistance scarcely impacts circuit performance in closed-loop feedback setups.\n\nOperational amplifiers with inputs linked to MOS transistor gates theoretically exhibit infinite input resistance. Practically, however, MOS transistor gates that are connected via package pins to external circuits need protection against static electricity damage. This protection is commonly provided by attaching back-biased clamping diodes from $V_{D D}$ and $V_{S S}$ to the gate, resulting in effective input leakage currents that are governed by junction leakage and measure in the picoamp range. Such protection is necessary only at the input and output points of integrated circuits. For internal applications where op-amp inputs are not linked to the external pins of an integrated circuit, protection is unnecessary, allowing op amps with MOS transistor gates to achieve exceptionally high input resistance."
},
{
    "text": "In the input stages of bipolar transistors, the input resistance usually falls within the range of $100 \\mathrm{k} \\Omega$ to $1 \\mathrm{M} \\Omega$. Nonetheless, the voltage gain is generally substantial enough that this input resistance scarcely impacts the circuit's performance in closed-loop feedback setups.\n\nOperational amplifiers with inputs linked to MOS transistor gates theoretically possess an almost infinite input resistance. In practical applications, however, the gates of MOS transistors, which are connected to external pins, necessitate protection against static electricity damage. This safeguard is commonly implemented by attaching back-biased clamping diodes from $V_{D D}$ and $V_{S S}$ to the gate, resulting in effective input leakage currents that are governed by junction leakage and typically measure in the picoamp range. Protection is exclusively needed at the inputs and outputs of integrated circuits. For internal applications where the op-amp inputs are not linked to the external pins of an integrated circuit, such protection is unnecessary, allowing op amps with MOS transistor gates to achieve exceptionally high input resistance."
},
{
    "text": "In bipolar transistor input stages, the input resistance generally falls within the range of $100 \\mathrm{k} \\Omega$ to $1 \\mathrm{M} \\Omega$. Nevertheless, the voltage gain is often sufficiently high that this input resistance scarcely impacts circuit performance in closed-loop feedback setups.\n\nOperational amplifiers with inputs linked to MOS transistor gates theoretically possess nearly infinite input resistance. Practically, however, MOS transistor gates that are connected via package pins to external circuits need protection against static electricity damage. This safeguard is usually implemented by attaching back-biased clamping diodes from $V_{D D}$ and $V_{S S}$ to the gate, resulting in effective input leakage currents that are governed by junction leakage and measure in the picampere range. Protection is necessary only at the input and output points of integrated circuits. For internal applications where op-amp inputs are not linked to the external pins of an integrated circuit, such protection is unnecessary, allowing op amps with MOS transistor gates to achieve exceptionally high input resistance."
},
{
    "text": "In bipolar transistor input stages, the input resistance usually falls within the range of $100 \\mathrm{k} \\Omega$ to $1 \\mathrm{M} \\Omega$. Nonetheless, the voltage gain is often substantial enough that this input resistance scarcely impacts circuit performance in closed-loop feedback setups.\n\nOperational amplifiers with inputs linked to MOS transistor gates theoretically exhibit infinite input resistance. In practical applications, however, MOS transistor gates that are connected via package pins to external circuits need protection against static electricity damage. This protection is commonly provided by attaching back-biased clamping diodes from $V_{D D}$ and $V_{S S}$ to the gate, resulting in effective input leakage currents that are governed by junction leakage and measure in the picoamp range. Such protection is necessary only at the input and output points of integrated circuits. For internal applications where the op-amp inputs are not linked to the external pins of an integrated circuit, this protection is unnecessary, allowing op amps with MOS transistor gates to achieve exceptionally high input resistance."
},
{
    "text": "In bipolar transistor input stages, the input resistance usually falls within the range of $100 \\mathrm{k} \\Omega$ to $1 \\mathrm{M} \\Omega$. Nonetheless, the voltage gain is generally substantial enough that this input resistance scarcely impacts circuit performance in closed-loop feedback setups.\n\nOperational amplifiers with inputs linked to MOS transistor gates theoretically possess an almost infinite input resistance. In practical terms, however, MOS transistor gates that are connected via package pins to external circuits need protection against static electricity damage. This protection is commonly implemented by attaching back-biased clamping diodes from $V_{D D}$ and $V_{S S}$ to the gate, resulting in effective input leakage currents that are governed by junction leakage and typically measure in the picoamp range. Protection is necessary only for the inputs and outputs of integrated circuits. In internal applications where op-amp inputs are not exposed to the external pins of an integrated circuit, such protection is unnecessary, allowing op amps with MOS transistor gates to achieve exceptionally high input resistance."
},
{
    "text": "In bipolar transistor input stages, the input resistance generally falls within the range of $100 \\mathrm{k} \\Omega$ to $1 \\mathrm{M} \\Omega$. Nevertheless, the voltage gain is usually substantial enough that this input resistance scarcely impacts circuit performance in closed-loop feedback setups.\n\nOperational amplifiers with inputs linked to MOS transistor gates theoretically possess an almost infinite input resistance. In practical applications, however, MOS transistor gates that are connected via package pins to external circuits need protection against static electricity damage. This safeguard is commonly implemented by attaching back-biased clamping diodes from $V_{D D}$ and $V_{S S}$ to the gate, resulting in effective input leakage currents that are governed by junction leakage and measure in the picoamp range. Protection is necessary only for the inputs and outputs of integrated circuits. In internal applications where op-amp inputs are not exposed to external pins of an integrated circuit, such protection is unnecessary, allowing op amps with MOS transistor gates to achieve exceptionally high input resistance."
},
{
    "text": "In bipolar transistor input stages, the input resistance generally falls within the range of $100 \\mathrm{k} \\Omega$ to $1 \\mathrm{M} \\Omega$. Nevertheless, the voltage gain is usually substantial enough that this input resistance scarcely impacts circuit performance in closed-loop feedback setups.\n\nOperational amplifiers with inputs linked to MOS transistor gates theoretically possess infinite input resistance. In practical applications, however, MOS transistor gates that are connected via package pins to external circuits need protection against static electricity damage. This protection is commonly implemented by attaching back-biased clamping diodes from $V_{D D}$ and $V_{S S}$ to the gate, resulting in effective input leakage currents that are governed by junction leakage and typically measure in the picoamp range. Such protection is necessary only for the inputs and outputs of integrated circuits. In internal applications where op-amp inputs are not exposed to external pins of an integrated circuit, protection is unnecessary, and op amps with MOS transistor gates as inputs can achieve exceptionally high input resistance."
},
{
    "text": "In bipolar transistor input stages, the input resistance generally falls within the range of $100 \\mathrm{k} \\Omega$ to $1 \\mathrm{M} \\Omega$. Nonetheless, the voltage gain is typically substantial enough that this input resistance scarcely impacts circuit performance in closed-loop feedback setups.\n\nOperational amplifiers with inputs linked to MOS transistor gates theoretically possess an infinitely high input resistance. Practically, however, MOS transistor gates that are connected via package pins to external circuits need protection against static electricity damage. This protection is commonly implemented by attaching back-biased clamping diodes from $V_{D D}$ and $V_{S S}$ to the gate, resulting in effective input leakage currents that are governed by junction leakage and measure in the picoamp range. Nevertheless, such protection is necessary only at the input and output points of integrated circuits. In internal applications where the op-amp inputs are not connected to the external pins of an integrated circuit, protection is unnecessary, allowing op amps with MOS transistor gates to achieve exceptionally high input resistance."
},
{
    "text": "The impact of certain deviations from ideality on the low-frequency behavior of an operational amplifier in a specific application can be determined using the equivalent circuit depicted in Fig. 6.14. (This model excludes the influences of finite Power Supply Rejection Ratio (PSRR) or Common-Mode Rejection Ratio (CMRR).) In this diagram, the two current sources designated $I_{\\text{BIAS}}$ symbolize the average direct current (dc) flowing into the input terminals. The polarity of these current sources, as illustrated in Fig. 6.14, is applicable for an $n p n$ transistor input stage. The current source marked $I_{O S}$ denotes the discrepancy between the currents entering the amplifier's terminals. For instance, if a given circuit exhibited a current of $1.5 \\mu \\mathrm{A}$ entering the noninverting input terminal and a current of $1 \\mu \\mathrm{A}$ entering the inverting input terminal, then the value of $I_{\\text{BIAS}}$ in Fig. 6.14 would be $1.25 \\mu \\mathrm{A}$, and the value of $I_{O S}$ would be $0.5 \\mu \\mathrm{A}$.\n\nimage_name: Figure 6.14\ndescription:\n[\nname: IBIAS, type: CurrentSource, ports: {Np: Vip, Nn: GND}\nname: IBIAS, type: CurrentSource, ports: {Np: Vin, Nn: GND}\nname: IOS/2, type: CurrentSource, ports: {Np: Vip, Nn: Vin}\nname: VOS, type: VoltageSource, ports: {Np: Vip, Nn: Vip}\nname: Ri, type: Resistor, value: Ri, ports: {N1: Vip, N2: Vin}\nname: a(jω)vi, type: VoltageControlledVoltageSource, ports: {Np: x3, Nn: GND}\nname: Ro, type: Resistor, value: Ro, ports: {N1: x3, N2: Vout}\n]\nextrainfo: The circuit represents an equivalent model of an operational amplifier, incorporating input offset voltage and current, input and output resistance, and voltage gain.\n\nFigure 6.14 Equivalent circuit for the operational amplifier, including input offset voltage and current, input and output resistance, and voltage gain."
},
{
    "text": "The impact of certain deviations from ideal behavior on the low-frequency performance of an operational amplifier in a specific application can be determined using the equivalent circuit depicted in Fig. 6.14. (This model excludes the influences of finite Power Supply Rejection Ratio (PSRR) or Common-Mode Rejection Ratio (CMRR).) In this circuit, the two current sources designated as $I_{\\text{BIAS}}$ symbolize the average direct current (dc) flowing into the input terminals. The polarity of these current sources, as illustrated in Fig. 6.14, is applicable for an $n p n$ transistor input stage. The current source labeled $I_{O S}$ denotes the disparity between the currents entering the amplifier terminals. For instance, if a circuit exhibits a current of $1.5 \\mu \\mathrm{A}$ flowing into the noninverting input terminal and a current of $1 \\mu \\mathrm{A}$ flowing into the inverting input terminal, then the value of $I_{\\text{BIAS}}$ in Fig. 6.14 would be $1.25 \\mu \\mathrm{A}$, and the value of $I_{O S}$ would be $0.5 \\mu \\mathrm{A}$.\nimage_name:Figure 6.14\ndescription:\n[\nname: IBIAS, type: CurrentSource, ports: {Np: Vip, Nn: GND}\nname: IBIAS, type: CurrentSource, ports: {Np: Vin, Nn: GND}\nname: IOS/2, type: CurrentSource, ports: {Np: Vip, Nn: Vin}\nname: VOS, type: VoltageSource, ports: {Np: Vip, Nn: Vip}\nname: Ri, type: Resistor, value: Ri, ports: {N1: Vip, N2: Vin}\nname: a(jω)vi, type: VoltageControlledVoltageSource, ports: {Np: x3, Nn: GND}\nname: Ro, type: Resistor, value: Ro, ports: {N1: x3, N2: Vout}\n]\nextrainfo:The circuit represents an equivalent model of an operational amplifier, incorporating input offset voltage and current, input and output resistance, and voltage gain.\n\nFigure 6.14 Equivalent circuit for the operational amplifier, including input offset voltage and current, input and output resistance, and voltage gain."
},
{
    "text": "The impact of certain non-idealities on the low-frequency behavior of an operational amplifier in a specific application can be determined using the equivalent circuit depicted in Fig. 6.14. (Note that this model excludes the influences of finite Power Supply Rejection Ratio (PSRR) and Common-Mode Rejection Ratio (CMRR).) In this diagram, the two current sources designated as $I_{\\text {BIAS }}$ denote the mean value of the direct current (dc) entering the input terminals. The polarity of these current sources, as illustrated in Fig. 6.14, is applicable for an $n p n$ transistor input stage. The current source marked $I_{O S}$ signifies the disparity between the currents entering the amplifier's terminals. For instance, if a circuit exhibits a current of $1.5 \\mu \\mathrm{~A}$ entering the noninverting input terminal and a current of $1 \\mu \\mathrm{~A}$ entering the inverting input terminal, then $I_{\\text {BIAS }}$ in Fig. 6.14 would be $1.25 \\mu \\mathrm{~A}$, and $I_{O S}$ would be $0.5 \\mu \\mathrm{~A}$.\nimage_name:Figure 6.14\ndescription:\n[\nname: IBIAS, type: CurrentSource, ports: {Np: Vip, Nn: GND}\nname: IBIAS, type: CurrentSource, ports: {Np: Vin, Nn: GND}\nname: IOS/2, type: CurrentSource, ports: {Np: Vip, Nn: Vin}\nname: VOS, type: VoltageSource, ports: {Np: Vip, Nn: Vip}\nname: Ri, type: Resistor, value: Ri, ports: {N1: Vip, N2: Vin}\nname: a(jω)vi, type: VoltageControlledVoltageSource, ports: {Np: x3, Nn: GND}\nname: Ro, type: Resistor, value: Ro, ports: {N1: x3, N2: Vout}\n]\nextrainfo:This circuit serves as an equivalent representation of an operational amplifier, incorporating elements such as input offset voltage and current, input and output resistance, and voltage gain.\n\nFigure 6.14 presents an equivalent circuit for the operational amplifier, encompassing input offset voltage and current, input and output resistance, and voltage gain."
},
{
    "text": "The impact of certain deviations from ideality on the low-frequency behavior of an operational amplifier in a specific application can be determined using the equivalent circuit depicted in Fig. 6.14. (This model excludes the effects of finite Power Supply Rejection Ratio (PSRR) and Common-Mode Rejection Ratio (CMRR).) In this circuit, the two current sources designated as $I_{\\text{BIAS}}$ denote the average direct current (dc) flowing into the input terminals. The polarity of these current sources, as illustrated in Fig. 6.14, is applicable for an $n p n$ transistor input stage. The current source labeled $I_{O S}$ signifies the disparity between the currents entering the amplifier terminals. For instance, if a circuit exhibits a current of $1.5 \\mu \\mathrm{~A}$ flowing into the noninverting input terminal and a current of $1 \\mu \\mathrm{~A}$ flowing into the inverting input terminal, then the value of $I_{\\text{BIAS}}$ in Fig. 6.14 would be $1.25 \\mu \\mathrm{~A}$, and the value of $I_{O S}$ would be $0.5 \\mu \\mathrm{~A}$.\n\n**Figure 6.14** Equivalent circuit for the operational amplifier, incorporating input offset voltage and current, input and output resistance, and voltage gain.\n\n*Description:*\n- **IBIAS**: CurrentSource, connected from Vip to GND and from Vin to GND.\n- **IOS/2**: CurrentSource, connected from Vip to Vin.\n- **VOS**: VoltageSource, connected between Vip and Vip.\n- **Ri**: Resistor with value Ri, connected from Vip to Vin.\n- **a(jω)vi**: VoltageControlledVoltageSource, connected from x3 to GND.\n- **Ro**: Resistor with value Ro, connected from x3 to Vout.\n\n*Additional Information:* The circuit serves as an equivalent model of an operational amplifier, encompassing input offset voltage and current, input and output resistance, and voltage gain."
},
{
    "text": "The impact of certain deviations from ideality on the low-frequency behavior of an operational amplifier in a specific application can be determined using the equivalent circuit depicted in Fig. 6.14. (This model excludes the influences of finite Power Supply Rejection Ratio (PSRR) or Common-Mode Rejection Ratio (CMRR).) In this circuit, the two current sources designated $I_{\\text{BIAS}}$ denote the average value of the direct current (dc) flowing into the input terminals. The polarity of these current sources as illustrated in Fig. 6.14 is applicable for an $n p n$ transistor input stage. The current source labeled $I_{O S}$ signifies the discrepancy between the currents entering the amplifier terminals. For instance, if a given circuit exhibited a current of $1.5 \\mu \\mathrm{~A}$ entering the noninverting input terminal and a current of $1 \\mu \\mathrm{~A}$ entering the inverting input terminal, then the value of $I_{\\text{BIAS}}$ in Fig. 6.14 would be $1.25 \\mu \\mathrm{~A}$, and the value of $I_{O S}$ would be $0.5 \\mu \\mathrm{~A}$.\n\nimage_name: Figure 6.14\ndescription:\n[\nname: IBIAS, type: CurrentSource, ports: {Np: Vip, Nn: GND}\nname: IBIAS, type: CurrentSource, ports: {Np: Vin, Nn: GND}\nname: IOS/2, type: CurrentSource, ports: {Np: Vip, Nn: Vin}\nname: VOS, type: VoltageSource, ports: {Np: Vip, Nn: Vip}\nname: Ri, type: Resistor, value: Ri, ports: {N1: Vip, N2: Vin}\nname: a(jω)vi, type: VoltageControlledVoltageSource, ports: {Np: x3, Nn: GND}\nname: Ro, type: Resistor, value: Ro, ports: {N1: x3, N2: Vout}\n]\nextrainfo: This circuit serves as an equivalent model of an operational amplifier, incorporating input offset voltage and current, input and output resistance, and voltage gain.\n\nFigure 6.14 Equivalent circuit for the operational amplifier, encompassing input offset voltage and current, input and output resistance, and voltage gain."
},
{
    "text": "The impact of certain deviations from ideal behavior on the low-frequency performance of an operational amplifier in a specific application can be determined using the equivalent circuit depicted in Fig. 6.14. (Note that this model excludes the effects of finite Power Supply Rejection Ratio (PSRR) and Common-Mode Rejection Ratio (CMRR).) In this diagram, the two current sources designated $I_{\\text {BIAS }}$ symbolize the average direct current (dc) flowing into the input terminals. The polarity of these current sources, as illustrated in Fig. 6.14, is applicable for an $n p n$ transistor input stage. The current source labeled $I_{O S}$ denotes the disparity between the currents entering the amplifier's terminals. For instance, if a circuit exhibits a current of $1.5 \\mu \\mathrm{~A}$ entering the noninverting input terminal and a current of $1 \\mu \\mathrm{~A}$ entering the inverting input terminal, then $I_{\\text {BIAS }}$ in Fig. 6.14 would be $1.25 \\mu \\mathrm{~A}$, and $I_{O S}$ would be $0.5 \\mu \\mathrm{~A}$.\n\n**Figure 6.14**  \nEquivalent circuit for the operational amplifier, incorporating input offset voltage and current, input and output resistance, and voltage gain.\n\n**Description:**  \n- **IBIAS**: CurrentSource, connected from Vip to GND  \n- **IBIAS**: CurrentSource, connected from Vin to GND  \n- **IOS/2**: CurrentSource, connected from Vip to Vin  \n- **VOS**: VoltageSource, connected from Vip to Vip  \n- **Ri**: Resistor, value Ri, connected from Vip to Vin  \n- **a(jω)vi**: VoltageControlledVoltageSource, connected from x3 to GND  \n- **Ro**: Resistor, value Ro, connected from x3 to Vout  \n\n**Additional Information:**  \nThe circuit serves as an equivalent model of an operational amplifier, accounting for input offset voltage and current, input and output resistance, and voltage gain."
},
{
    "text": "The impact of certain deviations from ideality on the low-frequency behavior of an operational amplifier in a specific application can be determined using the equivalent circuit depicted in Fig. 6.14. (This model excludes the influences of finite Power Supply Rejection Ratio (PSRR) and Common-Mode Rejection Ratio (CMRR).) In this circuit, the two current sources designated $I_{\\text{BIAS}}$ symbolize the average direct current (dc) flowing into the input terminals. The polarity of these current sources, as illustrated in Fig. 6.14, is applicable for an $n p n$ transistor input stage. The current source labeled $I_{O S}$ denotes the disparity between the currents entering the amplifier terminals. For instance, if a circuit exhibited a current of $1.5 \\mu \\mathrm{~A}$ flowing into the noninverting input terminal and a current of $1 \\mu \\mathrm{~A}$ flowing into the inverting input terminal, then the value of $I_{\\text{BIAS}}$ in Fig. 6.14 would be $1.25 \\mu \\mathrm{~A}$, and the value of $I_{O S}$ would be $0.5 \\mu \\mathrm{~A}$.\n\n**Figure 6.14** Equivalent circuit for the operational amplifier, incorporating input offset voltage and current, input and output resistance, and voltage gain.\n\n*Image Description:*\n- **IBIAS**: CurrentSource, connected from Vip to GND\n- **IBIAS**: CurrentSource, connected from Vin to GND\n- **IOS/2**: CurrentSource, connected from Vip to Vin\n- **VOS**: VoltageSource, connected from Vip to Vip\n- **Ri**: Resistor, value Ri, connected from Vip to Vin\n- **a(jω)vi**: VoltageControlledVoltageSource, connected from x3 to GND\n- **Ro**: Resistor, value Ro, connected from x3 to Vout\n\n*Additional Information:* The circuit represents an equivalent model of an operational amplifier, including input offset voltage and current, input and output resistance, and voltage gain."
},
{
    "text": "The impact of certain deviations from ideality on the low-frequency behavior of an operational amplifier in a specific application can be determined using the equivalent circuit depicted in Fig. 6.14. (This model excludes the influences of finite Power Supply Rejection Ratio (PSRR) and Common-Mode Rejection Ratio (CMRR).) In this circuit, the two current sources designated $I_{\\text {BIAS }}$ symbolize the average direct current (dc) flowing into the input terminals. The polarity of these current sources as illustrated in Fig. 6.14 is applicable for an $n p n$ transistor input stage. The current source labeled $I_{O S}$ denotes the discrepancy between the currents entering the amplifier terminals. For instance, if a given circuit exhibited a current of $1.5 \\mu \\mathrm{~A}$ entering the noninverting input terminal and a current of $1 \\mu \\mathrm{~A}$ entering the inverting input terminal, then the value of $I_{\\text {BIAS }}$ in Fig. 6.14 would be $1.25 \\mu \\mathrm{~A}$, and the value of $I_{O S}$ would be $0.5 \\mu \\mathrm{~A}$.\n\nimage_name: Figure 6.14\ndescription:\n[\nname: IBIAS, type: CurrentSource, ports: {Np: Vip, Nn: GND}\nname: IBIAS, type: CurrentSource, ports: {Np: Vin, Nn: GND}\nname: IOS/2, type: CurrentSource, ports: {Np: Vip, Nn: Vin}\nname: VOS, type: VoltageSource, ports: {Np: Vip, Nn: Vip}\nname: Ri, type: Resistor, value: Ri, ports: {N1: Vip, N2: Vin}\nname: a(jω)vi, type: VoltageControlledVoltageSource, ports: {Np: x3, Nn: GND}\nname: Ro, type: Resistor, value: Ro, ports: {N1: x3, N2: Vout}\n]\nextrainfo: This circuit serves as an equivalent representation of an operational amplifier, incorporating input offset voltage and current, input and output resistance, and voltage gain.\n\nFigure 6.14 Equivalent circuit for the operational amplifier, encompassing input offset voltage and current, input and output resistance, and voltage gain."
},
{
    "text": "Figure 6.15 illustrates a schematic of a fundamental two-stage CMOS operational amplifier. ${ }^{6,7,8}$ The design features a differential input stage driving an active load, succeeded by a second gain stage. Typically, an output stage is omitted but can be included for driving substantial off-chip loads. This configuration offers excellent common-mode range, output swing, voltage gain, and CMRR within a straightforward circuit that can be stabilized using a single capacitor. The circuit is re-presented in Fig. 6.16, where ideal current sources are substituted with transistor-based current mirrors. In this section, we will delve into the analysis of various performance metrics of this CMOS op-amp circuit.\n\nimage_name:Figure 6.15\ndescription:The depicted circuit is a two-stage CMOS operational amplifier comprising a differential input stage (M1, M2), a current mirror load (M3, M4), and an output stage (M5). It operates on power supplies VDD and -VSS, with a compensation capacitor CC linking the intermediate node to the output node.\nFigure 6.15 Basic two-stage CMOS operational amplifier.\n\nimage_name:Figure 6.16\ndescription:\n[\nname: M8, type: PMOS, ports: {S: VDD, D: x1, G: x1}\nname: M5, type: PMOS, ports: {S: VDD, D: s1s2d5, G: x1}\nname: M7, type: PMOS, ports: {S: VDD, D: Vo, G: x1}\nname: M1, type: PMOS, ports: {S: s1s2d5, D: x2, G: Vip}\nname: M2, type: PMOS, ports: {S: s1s2d5, D: d2d4g6, G: Vin}\nname: M3, type: NMOS, ports: {S: -VSS, D: x2, G: x2}\nname: M4, type: NMOS, ports: {S: -VSS, D: x2, G: d2d4g6}\nname: M6, type: NMOS, ports: {S: -VSS, D: Vo, G: d2d4g6}\nname: IBIAS, type: CurrentSource, ports: {Np: VDD, Nn: -VSS}\nname: Cc, type: Capacitor, value: Cc, ports: {Np: d2d4g6, Nn: Vo}\n]\nextrainfo:The circuit is a two-stage CMOS operational amplifier with a differential input stage (M1, M2), a current mirror load (M3, M4), and an output stage (M5). It is powered by VDD and -VSS, with a compensation capacitor CC connected between the intermediate node and the output node.\n\nFigure 6.16 Detailed schematic representation of a standard two-stage CMOS operational amplifier."
},
{
    "text": "Figure 6.15 illustrates a basic two-stage CMOS operational amplifier schematic. ${ }^{6,7,8}$ It features a differential input stage driving an active load, followed by a second gain stage. Typically, an output stage is omitted but can be included for driving heavy off-chip loads. This configuration offers excellent common-mode range, output swing, voltage gain, and CMRR in a straightforward design that can be stabilized with a single capacitor. The circuit is re-presented in Fig. 6.16, where ideal current sources are substituted with transistor current mirrors. In this section, we will examine the various performance metrics of this CMOS op-amp circuit.\n\nimage_name:Figure 6.15\ndescription:This circuit is a two-stage CMOS operational amplifier comprising a differential input stage (M1, M2), a current mirror load (M3, M4), and an output stage (M5). It operates with power supplies VDD and -VSS, and includes a compensation capacitor CC connected between the intermediate and output nodes.\nFigure 6.15 Basic two-stage CMOS operational amplifier.\nimage_name:Figure 6.16\ndescription:\n[\nname: M8, type: PMOS, ports: {S: VDD, D: x1, G: x1}\nname: M5, type: PMOS, ports: {S: VDD, D: s1s2d5, G: x1}\nname: M7, type: PMOS, ports: {S: VDD, D: Vo, G: x1}\nname: M1, type: PMOS, ports: {S: s1s2d5, D: x2, G: Vip}\nname: M2, type: PMOS, ports: {S: s1s2d5, D: d2d4g6, G: Vin}\nname: M3, type: NMOS, ports: {S: -VSS, D: x2, G: x2}\nname: M4, type: NMOS, ports: {S: -VSS, D: x2, G: d2d4g6}\nname: M6, type: NMOS, ports: {S: -VSS, D: Vo, G: d2d4g6}\nname: IBIAS, type: CurrentSource, ports: {Np: VDD, Nn: -VSS}\nname: Cc, type: Capacitor, value: Cc, ports: {Np: d2d4g6, Nn: Vo}\n]\nextrainfo:This circuit is a two-stage CMOS operational amplifier featuring a differential input stage (M1, M2), a current mirror load (M3, M4), and an output stage (M5). It is powered by VDD and -VSS, with a compensation capacitor CC linking the intermediate and output nodes.\n\nFigure 6.16 Detailed schematic of a typical two-stage CMOS operational amplifier."
},
{
    "text": "Figure 6.15 illustrates a schematic of a fundamental two-stage CMOS operational amplifier. ${ }^{6,7,8}$ The design features a differential input stage driving an active load, succeeded by a second gain stage. Typically, an output stage is omitted but can be incorporated for driving substantial off-chip loads. This configuration offers excellent common-mode range, output swing, voltage gain, and CMRR within a straightforward circuit that can be stabilized using a single capacitor. The circuit is re-presented in Fig. 6.16, where ideal current sources are substituted with transistor-based current mirrors. In this section, we will examine the various performance metrics of this CMOS op-amp circuit.\n\n**Image Description for Figure 6.15:**\nThe depicted circuit is a two-stage CMOS operational amplifier comprising a differential input stage (M1, M2), a current mirror load (M3, M4), and an output stage (M5). It is powered by VDD and -VSS, with a compensation capacitor CC linking the intermediate node to the output node.\n\n**Figure 6.15: Basic Two-Stage CMOS Operational Amplifier.**\n\n**Image Description for Figure 6.16:**\n[\nname: M8, type: PMOS, ports: {S: VDD, D: x1, G: x1}\nname: M5, type: PMOS, ports: {S: VDD, D: s1s2d5, G: x1}\nname: M7, type: PMOS, ports: {S: VDD, D: Vo, G: x1}\nname: M1, type: PMOS, ports: {S: s1s2d5, D: x2, G: Vip}\nname: M2, type: PMOS, ports: {S: s1s2d5, D: d2d4g6, G: Vin}\nname: M3, type: NMOS, ports: {S: -VSS, D: x2, G: x2}\nname: M4, type: NMOS, ports: {S: -VSS, D: x2, G: d2d4g6}\nname: M6, type: NMOS, ports: {S: -VSS, D: Vo, G: d2d4g6}\nname: IBIAS, type: CurrentSource, ports: {Np: VDD, Nn: -VSS}\nname: Cc, type: Capacitor, value: Cc, ports: {Np: d2d4g6, Nn: Vo}\n]\n**Additional Information:**\nThe circuit is a two-stage CMOS operational amplifier with a differential input stage (M1, M2), a current mirror load (M3, M4), and an output stage (M5). It is powered by VDD and -VSS, with a compensation capacitor CC connected between the intermediate node and the output node.\n\n**Figure 6.16: More Detailed Schematic Diagram of a Typical Two-Stage CMOS Operational Amplifier.**"
},
{
    "text": "Figure 6.15 illustrates a schematic of a fundamental two-stage CMOS operational amplifier. ${ }^{6,7,8}$ The circuit features a differential input stage that drives an active load, followed by a second gain stage. Typically, an output stage is omitted but can be included for driving substantial off-chip loads. This configuration offers excellent common-mode range, output swing, voltage gain, and CMRR in a straightforward design that can be stabilized with a single capacitor. The circuit is re-presented in Fig. 6.16, where ideal current sources are substituted with transistor-based current mirrors. In this section, we will delve into the analysis of various performance metrics of this CMOS op-amp circuit.\n\nimage_name:Figure 6.15\ndescription:The circuit comprises a two-stage CMOS operational amplifier with a differential input stage (M1, M2), a current mirror load (M3, M4), and an output stage (M5). It operates with power supplies VDD and -VSS, and includes a compensation capacitor CC linking the intermediate node to the output node.\nFigure 6.15 Basic two-stage CMOS operational amplifier.\n\nimage_name:Figure 6.16\ndescription:\n[\nname: M8, type: PMOS, ports: {S: VDD, D: x1, G: x1}\nname: M5, type: PMOS, ports: {S: VDD, D: s1s2d5, G: x1}\nname: M7, type: PMOS, ports: {S: VDD, D: Vo, G: x1}\nname: M1, type: PMOS, ports: {S: s1s2d5, D: x2, G: Vip}\nname: M2, type: PMOS, ports: {S: s1s2d5, D: d2d4g6, G: Vin}\nname: M3, type: NMOS, ports: {S: -VSS, D: x2, G: x2}\nname: M4, type: NMOS, ports: {S: -VSS, D: x2, G: d2d4g6}\nname: M6, type: NMOS, ports: {S: -VSS, D: Vo, G: d2d4g6}\nname: IBIAS, type: CurrentSource, ports: {Np: VDD, Nn: -VSS}\nname: Cc, type: Capacitor, value: Cc, ports: {Np: d2d4g6, Nn: Vo}\n]\nextrainfo:The circuit is a two-stage CMOS operational amplifier with a differential input stage (M1, M2), a current mirror load (M3, M4), and an output stage (M5). It is powered by VDD and -VSS, with a compensation capacitor CC connected between the intermediate node and the output node.\n\nFigure 6.16 Detailed schematic diagram of a standard two-stage CMOS operational amplifier."
},
{
    "text": "Figure 6.15 illustrates a schematic of a fundamental two-stage CMOS operational amplifier. ${ }^{6,7,8}$ This configuration includes a differential input stage driving an active load, followed by a secondary gain stage. Typically, an output stage is omitted but can be incorporated for driving substantial off-chip loads. This setup offers excellent common-mode range, output swing, voltage gain, and CMRR within a straightforward design that can be stabilized using a single capacitor. The circuit is re-presented in Fig. 6.16, where ideal current sources are substituted with transistor-based current mirrors. In this section, we will delve into the analysis of various performance metrics of this CMOS op-amp circuit.\n\nimage_name:Figure 6.15\ndescription:The depicted circuit is a two-stage CMOS operational amplifier featuring a differential input stage (M1, M2), a current mirror load (M3, M4), and an output stage (M5). It operates with power supplies VDD and -VSS, and includes a compensation capacitor CC linking the intermediate node to the output node.\nFigure 6.15 Basic two-stage CMOS operational amplifier.\nimage_name:Figure 6.16\ndescription:\n[\nname: M8, type: PMOS, ports: {S: VDD, D: x1, G: x1}\nname: M5, type: PMOS, ports: {S: VDD, D: s1s2d5, G: x1}\nname: M7, type: PMOS, ports: {S: VDD, D: Vo, G: x1}\nname: M1, type: PMOS, ports: {S: s1s2d5, D: x2, G: Vip}\nname: M2, type: PMOS, ports: {S: s1s2d5, D: d2d4g6, G: Vin}\nname: M3, type: NMOS, ports: {S: -VSS, D: x2, G: x2}\nname: M4, type: NMOS, ports: {S: -VSS, D: x2, G: d2d4g6}\nname: M6, type: NMOS, ports: {S: -VSS, D: Vo, G: d2d4g6}\nname: IBIAS, type: CurrentSource, ports: {Np: VDD, Nn: -VSS}\nname: Cc, type: Capacitor, value: Cc, ports: {Np: d2d4g6, Nn: Vo}\n]\nextrainfo:The displayed circuit is a two-stage CMOS operational amplifier with a differential input stage (M1, M2), a current mirror load (M3, M4), and an output stage (M5). It is powered by VDD and -VSS, with a compensation capacitor CC connected between the intermediate node and the output node.\n\nFigure 6.16 More detailed schematic diagram of a typical two-stage CMOS operational amplifier."
},
{
    "text": "Figure 6.15 illustrates a schematic of a fundamental two-stage CMOS operational amplifier. ${ }^{6,7,8}$ This configuration features a differential input stage driving an active load, succeeded by a second gain stage. Typically, an output stage is omitted but can be incorporated for driving substantial off-chip loads. This setup offers excellent common-mode range, output swing, voltage gain, and CMRR within a straightforward circuit that can be stabilized using a single capacitor. The circuit is redepicted in Fig. 6.16, where ideal current sources are substituted with transistor-based current mirrors. In this section, we will delve into the analysis of various performance metrics of this CMOS op-amp circuit.\n\nimage_name:Figure 6.15\ndescription:The depicted circuit is a two-stage CMOS operational amplifier comprising a differential input stage (M1, M2), a current mirror load (M3, M4), and an output stage (M5). It operates with power supplies VDD and -VSS, and includes a compensation capacitor CC linking the intermediate node to the output node.\nFigure 6.15 Basic two-stage CMOS operational amplifier.\n\nimage_name:Figure 6.16\ndescription:\n[\nname: M8, type: PMOS, ports: {S: VDD, D: x1, G: x1}\nname: M5, type: PMOS, ports: {S: VDD, D: s1s2d5, G: x1}\nname: M7, type: PMOS, ports: {S: VDD, D: Vo, G: x1}\nname: M1, type: PMOS, ports: {S: s1s2d5, D: x2, G: Vip}\nname: M2, type: PMOS, ports: {S: s1s2d5, D: d2d4g6, G: Vin}\nname: M3, type: NMOS, ports: {S: -VSS, D: x2, G: x2}\nname: M4, type: NMOS, ports: {S: -VSS, D: x2, G: d2d4g6}\nname: M6, type: NMOS, ports: {S: -VSS, D: Vo, G: d2d4g6}\nname: IBIAS, type: CurrentSource, ports: {Np: VDD, Nn: -VSS}\nname: Cc, type: Capacitor, value: Cc, ports: {Np: d2d4g6, Nn: Vo}\n]\nextrainfo:The circuit depicted is a two-stage CMOS operational amplifier featuring a differential input stage (M1, M2), a current mirror load (M3, M4), and an output stage (M5). It is powered by VDD and -VSS, with a compensation capacitor CC connected between the intermediate node and the output node.\n\nFigure 6.16 Detailed schematic diagram of a standard two-stage CMOS operational amplifier."
},
{
    "text": "Figure 6.15 illustrates a basic two-stage CMOS operational amplifier. ${ }^{6,7,8}$ It features a differential input stage driving an active load, followed by a second gain stage. While an output stage is typically omitted, it can be included for driving heavy off-chip loads. This configuration offers excellent common-mode range, output swing, voltage gain, and CMRR in a straightforward design that can be stabilized with a single capacitor. The circuit is reconfigured in Fig. 6.16, where ideal current sources are substituted with transistor current mirrors. In this section, we will examine the various performance metrics of this CMOS op-amp circuit.\n\nimage_name:Figure 6.15\ndescription:The circuit is a two-stage CMOS operational amplifier with a differential input stage (M1, M2), a current mirror load (M3, M4), and an output stage (M5). It is powered by VDD and -VSS, with a compensation capacitor CC connected between the intermediate node and the output node.\nFigure 6.15 Basic two-stage CMOS operational amplifier.\n\nimage_name:Figure 6.16\ndescription:\n[\nname: M8, type: PMOS, ports: {S: VDD, D: x1, G: x1}\nname: M5, type: PMOS, ports: {S: VDD, D: s1s2d5, G: x1}\nname: M7, type: PMOS, ports: {S: VDD, D: Vo, G: x1}\nname: M1, type: PMOS, ports: {S: s1s2d5, D: x2, G: Vip}\nname: M2, type: PMOS, ports: {S: s1s2d5, D: d2d4g6, G: Vin}\nname: M3, type: NMOS, ports: {S: -VSS, D: x2, G: x2}\nname: M4, type: NMOS, ports: {S: -VSS, D: x2, G: d2d4g6}\nname: M6, type: NMOS, ports: {S: -VSS, D: Vo, G: d2d4g6}\nname: IBIAS, type: CurrentSource, ports: {Np: VDD, Nn: -VSS}\nname: Cc, type: Capacitor, value: Cc, ports: {Np: d2d4g6, Nn: Vo}\n]\nextrainfo:The circuit is a two-stage CMOS operational amplifier with a differential input stage (M1, M2), a current mirror load (M3, M4), and an output stage (M5). It is powered by VDD and -VSS, with a compensation capacitor CC connected between the intermediate node and the output node.\n\nFigure 6.16 More detailed schematic diagram of a typical two-stage CMOS operational amplifier."
},
{
    "text": "Figure 6.15 illustrates a basic two-stage CMOS operational amplifier. ${ }^{6,7,8}$ The design includes a differential input stage driving an active load, followed by a second gain stage. Typically, an output stage is omitted but can be included for driving heavy off-chip loads. This configuration offers excellent common-mode range, output swing, voltage gain, and CMRR within a simple circuit that can be compensated using a single capacitor. The circuit is reconfigured in Fig. 6.16, where ideal current sources are substituted with transistor current mirrors. In this section, we will delve into the analysis of various performance parameters of this CMOS op-amp circuit.\n\nimage_name:Figure 6.15\ndescription:The depicted circuit is a two-stage CMOS operational amplifier featuring a differential input stage (M1, M2), a current mirror load (M3, M4), and an output stage (M5). It operates with power supplies VDD and -VSS, and includes a compensation capacitor CC linking the intermediate node to the output node.\nFigure 6.15 Basic two-stage CMOS operational amplifier.\nimage_name:Figure 6.16\ndescription:\n[\nname: M8, type: PMOS, ports: {S: VDD, D: x1, G: x1}\nname: M5, type: PMOS, ports: {S: VDD, D: s1s2d5, G: x1}\nname: M7, type: PMOS, ports: {S: VDD, D: Vo, G: x1}\nname: M1, type: PMOS, ports: {S: s1s2d5, D: x2, G: Vip}\nname: M2, type: PMOS, ports: {S: s1s2d5, D: d2d4g6, G: Vin}\nname: M3, type: NMOS, ports: {S: -VSS, D: x2, G: x2}\nname: M4, type: NMOS, ports: {S: -VSS, D: x2, G: d2d4g6}\nname: M6, type: NMOS, ports: {S: -VSS, D: Vo, G: d2d4g6}\nname: IBIAS, type: CurrentSource, ports: {Np: VDD, Nn: -VSS}\nname: Cc, type: Capacitor, value: Cc, ports: {Np: d2d4g6, Nn: Vo}\n]\nextrainfo:The circuit represents a two-stage CMOS operational amplifier with a differential input stage (M1, M2), a current mirror load (M3, M4), and an output stage (M5). It is powered by VDD and -VSS, and incorporates a compensation capacitor CC connected between the intermediate node and the output node.\n\nFigure 6.16 Detailed schematic of a typical two-stage CMOS operational amplifier."
},
{
    "text": "The initial stage in Fig. 6.16 comprises a $p$-channel differential pair $M_{1}-M_{2}$, paired with an $n$-channel current mirror load $M_{3}-M_{4}$ and a $p$-channel tail current source $M_{5}$. The subsequent stage features an $n$-channel common-source amplifier $M_{6}$, equipped with a $p$-channel current-source load $M_{7}$. Given that the op-amp inputs are linked to the gates of MOS transistors, the input resistance is virtually infinite for internal applications, obviating the need for the protection diodes detailed in Section 6.2.7. This infinite input resistance characteristic also applies to the second stage of the op amp.\n\nThe output resistance is determined by looking back into the second stage with the op-amp inputs connected to small-signal ground:\n\n$$\n\\begin{equation*}\nR_{o}=r_{o 6} \\| r_{o 7} \\tag{6.52}\n\\end{equation*}\n$$\n\nDespite this output resistance typically being much higher than that of general-purpose bipolar op amps, a low output resistance is generally unnecessary when driving purely capacitive loads.\n\nGiven the essentially infinite input resistance of the second stage, the voltage gain of the amplifier in Fig. 6.16 can be computed by analyzing the two stages independently. The first stage mirrors the configuration discussed in Section 4.3.5, with a small-signal voltage gain of\n\n$$\n\\begin{equation*}\nA_{v 1}=\\frac{v_{o 1}}{v_{i}}=G_{m 1} R_{o 1} \\tag{6.53}\n\\end{equation*}\n$$\n\nwhere $G_{m 1}$ and $R_{o 1}$ denote the transconductance and output resistance of the first stage, respectively. From equations (4.143) and (4.149),\n\n$$\n\\begin{equation*}\nA_{\\nu 1}=g_{m 1}\\left(r_{o 2} \\| r_{o 4}\\right) \\tag{6.54}\n\\end{equation*}\n$$\n\nSimilarly, the voltage gain of the second stage is\n\n$$\n\\begin{equation*}\nA_{\\nu 2}=-g_{m 6} R_{o} \\tag{6.55}\n\\end{equation*}\n$$\n\nwith $R_{o}$ as defined in (6.52). Consequently, the overall gain of the amplifier is\n\n$$\n\\begin{equation*}\nA_{v}=A_{v 1} A_{v 2}=-g_{m 1}\\left(r_{o 2} \\| r_{o 4}\\right) g_{m 6}\\left(r_{o 6} \\| r_{o 7}\\right) \\tag{6.56}\n\\end{equation*}\n$$\n\nThis equation illustrates that the overall gain is linked to the quantity $\\left(g_{m} r_{o}\\right)^{2}$. Referring to (3.27),\n\n$$\n\\begin{equation*}\ng_{m} r_{o}=\\frac{2 V_{A}}{V_{o v}} \\tag{6.57}\n\\end{equation*}\n$$\n\nThus, the overall voltage gain is significantly influenced by the Early voltage (proportional to the effective channel length) and the overdrive (determined by the bias conditions).\n\n#### EXAMPLE\n\nDetermine the gain of the op amp in Fig. 6.16, assuming it utilizes the $0.8-\\mu \\mathrm{m}$ process technology outlined in Table 2.3. Also, assume $L_{\\text {eff }}=0.8 \\mu \\mathrm{~m}$ and $\\left|V_{o v}\\right|=\\left|V_{G S}-V_{t}\\right|=0.2 \\mathrm{~V}$ for all devices.\n\nLet $I_{D 2}, I_{D 4}, I_{D 6}$, and $I_{D 7}$ denote the bias currents flowing into the drains of $M_{2}, M_{4}$, $M_{6}$, and $M_{7}$, respectively. Since $I_{D 4}=-I_{D 2}$ and $I_{D 7}=-I_{D 6}$, (6.56) yields\n\n$$\n\\begin{align*}\nA_{v} & =-g_{m 1}\\left(\\frac{\\frac{\\left|V_{A 2}\\right|}{\\left|I_{D 2}\\right|} \\frac{V_{A 4}}{\\left|I_{D 2}\\right|}}{\\frac{\\left|V_{A 2}\\right|}{\\left|I_{D 2}\\right|}+\\frac{V_{A 4}}{\\left|I_{D 2}\\right|}}\\right) g_{m 6}\\left(\\frac{\\frac{V_{A 6}}{I_{D 6}} \\frac{\\left|V_{A 7}\\right|}{I_{D 6}}}{\\frac{V_{A 6}}{I_{D 6}}+\\frac{\\left|V_{A 7}\\right|}{I_{D 6}}}\\right)  \\tag{6.58}\\\\\n& =-\\frac{g_{m 1}}{\\left|I_{D 2}\\right|} \\frac{g_{m 6}}{I_{D 6}}\\left(\\frac{\\left|V_{A 2}\\right| V_{A 4}}{\\left|V_{A 2}\\right|+V_{A 4}}\\right)\\left(\\frac{V_{A 6}\\left|V_{A 7}\\right|}{V_{A 6}+\\left|V_{A 7}\\right|}\\right)\n\\end{align*}\n$$\n\nwhere the absolute-value function ensures all quantities in (6.58) are positive. From (1.181),\n\n$$\n\\begin{equation*}\nA_{v}=-\\frac{2}{\\left|V_{o v 1}\\right|} \\frac{2}{V_{o v 6}}\\left(\\frac{\\left|V_{A 2}\\right| V_{A 4}}{\\left|V_{A 2}\\right|+V_{A 4}}\\right)\\left(\\frac{V_{A 6}\\left|V_{A 7}\\right|}{V_{A 6}+\\left|V_{A 7}\\right|}\\right) \\tag{6.59}\n\\end{equation*}\n$$\n\nowing to $I_{D 1}=I_{D 2}$ with zero differential input. According to (1.163),\n\n$$\n\\begin{equation*}\nV_{A}=L_{\\mathrm{eff}}\\left(\\frac{d X_{d}}{d V_{D S}}\\right)^{-1} \\tag{6.60}\n\\end{equation*}\n$$\n\nSubstituting (6.60) into (6.59) with the provided data and $d X_{d} / d V_{D S}$ from Table 2.3 results in\n\n$$\nA_{v}=-\\frac{2}{0.2} \\frac{2}{0.2}\\left(\\frac{\\frac{0.8}{0.04} \\times \\frac{0.8}{0.08}}{\\frac{0.8}{0.04}+\\frac{0.8}{0.08}}\\right)^{2} \\simeq-4400\n$$\n\nThe overall gain can be enhanced either by increasing the channel lengths of the devices to elevate the Early voltages or by decreasing the bias current to lower the overdrives."
},
{
    "text": "The initial stage in Fig. 6.16 comprises a $p$-channel differential pair $M_{1}-M_{2}$ paired with an $n$-channel current mirror load $M_{3}-M_{4}$ and a $p$-channel tail current source $M_{5}$. The subsequent stage features an $n$-channel common-source amplifier $M_{6}$ equipped with a $p$-channel current-source load $M_{7}$. Given that the op-amp inputs are linked to the gates of MOS transistors, the input resistance is virtually infinite for internal applications, obviating the need for the protective diodes detailed in Section 6.2.7. This infinite input resistance also applies to the second stage of the op amp.\n\nThe output resistance is determined by looking back into the second stage with the op-amp inputs connected to small-signal ground:\n\n$$\n\\begin{equation*}\nR_{o}=r_{o 6} \\| r_{o 7} \\tag{6.52}\n\\end{equation*}\n$$\n\nDespite this output resistance typically being much higher than in general-purpose bipolar op amps, a low output resistance is generally unnecessary when driving purely capacitive loads.\n\nGiven the essentially infinite input resistance of the second stage, the voltage gain of the amplifier in Fig. 6.16 can be calculated by analyzing the two stages independently. The first stage mirrors the configuration discussed in Section 4.3.5, with a small-signal voltage gain of\n\n$$\n\\begin{equation*}\nA_{v 1}=\\frac{v_{o 1}}{v_{i}}=G_{m 1} R_{o 1} \\tag{6.53}\n\\end{equation*}\n$$\n\nwhere $G_{m 1}$ and $R_{o 1}$ represent the transconductance and output resistance of the first stage, respectively. From equations (4.143) and (4.149),\n\n$$\n\\begin{equation*}\nA_{\\nu 1}=g_{m 1}\\left(r_{o 2} \\| r_{o 4}\\right) \\tag{6.54}\n\\end{equation*}\n$$\n\nSimilarly, the voltage gain of the second stage is\n\n$$\n\\begin{equation*}\nA_{\\nu 2}=-g_{m 6} R_{o} \\tag{6.55}\n\\end{equation*}\n$$\n\nwith $R_{o}$ as defined in (6.52). Consequently, the overall gain of the amplifier is\n\n$$\n\\begin{equation*}\nA_{v}=A_{v 1} A_{v 2}=-g_{m 1}\\left(r_{o 2} \\| r_{o 4}\\right) g_{m 6}\\left(r_{o 6} \\| r_{o 7}\\right) \\tag{6.56}\n\\end{equation*}\n$$\n\nThis equation indicates that the overall gain is related to the quantity $\\left(g_{m} r_{o}\\right)^{2}$. Referring to (3.27),\n\n$$\n\\begin{equation*}\ng_{m} r_{o}=\\frac{2 V_{A}}{V_{o v}} \\tag{6.57}\n\\end{equation*}\n$$\n\nThus, the overall voltage gain is significantly influenced by the Early voltage (proportional to the effective channel length) and the overdrive (determined by the bias conditions).\n\n#### EXAMPLE\n\nDetermine the gain of the op amp in Fig. 6.16, assuming it utilizes the $0.8-\\mu \\mathrm{m}$ process technology outlined in Table 2.3. Also, assume $L_{\\text {eff }}=0.8 \\mu \\mathrm{~m}$ and $\\left|V_{o v}\\right|=\\left|V_{G S}-V_{t}\\right|=0.2 \\mathrm{~V}$ for all devices.\n\nLet $I_{D 2}, I_{D 4}, I_{D 6}$, and $I_{D 7}$ denote the bias currents flowing into the drains of $M_{2}, M_{4}$, $M_{6}$, and $M_{7}$, respectively. Since $I_{D 4}=-I_{D 2}$ and $I_{D 7}=-I_{D 6}$, (6.56) yields\n\n$$\n\\begin{align*}\nA_{v} & =-g_{m 1}\\left(\\frac{\\frac{\\left|V_{A 2}\\right|}{\\left|I_{D 2}\\right|} \\frac{V_{A 4}}{\\left|I_{D 2}\\right|}}{\\frac{\\left|V_{A 2}\\right|}{\\left|I_{D 2}\\right|}+\\frac{V_{A 4}}{\\left|I_{D 2}\\right|}}\\right) g_{m 6}\\left(\\frac{\\frac{V_{A 6}}{I_{D 6}} \\frac{\\left|V_{A 7}\\right|}{I_{D 6}}}{\\frac{V_{A 6}}{I_{D 6}}+\\frac{\\left|V_{A 7}\\right|}{I_{D 6}}}\\right)  \\tag{6.58}\\\\\n& =-\\frac{g_{m 1}}{\\left|I_{D 2}\\right|} \\frac{g_{m 6}}{I_{D 6}}\\left(\\frac{\\left|V_{A 2}\\right| V_{A 4}}{\\left|V_{A 2}\\right|+V_{A 4}}\\right)\\left(\\frac{V_{A 6}\\left|V_{A 7}\\right|}{V_{A 6}+\\left|V_{A 7}\\right|}\\right)\n\\end{align*}\n$$\n\nwhere the absolute-value function ensures all quantities in (6.58) are positive. From (1.181),\n\n$$\n\\begin{equation*}\nA_{v}=-\\frac{2}{\\left|V_{o v 1}\\right|} \\frac{2}{V_{o v 6}}\\left(\\frac{\\left|V_{A 2}\\right| V_{A 4}}{\\left|V_{A 2}\\right|+V_{A 4}}\\right)\\left(\\frac{V_{A 6}\\left|V_{A 7}\\right|}{V_{A 6}+\\left|V_{A 7}\\right|}\\right) \\tag{6.59}\n\\end{equation*}\n$$\n\nbecause $I_{D 1}=I_{D 2}$ with zero differential input. According to (1.163),\n\n$$\n\\begin{equation*}\nV_{A}=L_{\\mathrm{eff}}\\left(\\frac{d X_{d}}{d V_{D S}}\\right)^{-1} \\tag{6.60}\n\\end{equation*}\n$$\n\nSubstituting (6.60) into (6.59) with the provided data and $d X_{d} / d V_{D S}$ from Table 2.3 results in\n\n$$\nA_{v}=-\\frac{2}{0.2} \\frac{2}{0.2}\\left(\\frac{\\frac{0.8}{0.04} \\times \\frac{0.8}{0.08}}{\\frac{0.8}{0.04}+\\frac{0.8}{0.08}}\\right)^{2} \\simeq-4400\n$$\n\nThe overall gain can be enhanced either by increasing the channel lengths of the devices to elevate the Early voltages or by decreasing the bias current to lower the overdrives."
},
{
    "text": "The initial stage in Fig. 6.16 comprises a $p$-channel differential pair $M_{1}-M_{2}$, an $n$-channel current mirror load $M_{3}-M_{4}$, and a $p$-channel tail current source $M_{5}$. The subsequent stage features an $n$-channel common-source amplifier $M_{6}$ paired with a $p$-channel current-source load $M_{7}$. Due to the op-amp inputs being linked to the gates of MOS transistors, the input resistance is virtually infinite for internal applications, obviating the need for protection diodes as discussed in Section 6.2.7. Similarly, the second stage's input resistance is also practically infinite.\n\nThe output resistance is determined by looking back into the second stage with the op-amp inputs connected to small-signal ground:\n\n$$\n\\begin{equation*}\nR_{o}=r_{o 6} \\| r_{o 7} \\tag{6.52}\n\\end{equation*}\n$$\n\nDespite this output resistance typically being much higher than in general-purpose bipolar op amps, a low output resistance is generally unnecessary when driving purely capacitive loads.\n\nGiven the near-infinite input resistance of the second stage, the amplifier's voltage gain in Fig. 6.16 can be calculated by analyzing the two stages independently. The first stage mirrors the configuration discussed in Section 4.3.5, with a small-signal voltage gain of\n\n$$\n\\begin{equation*}\nA_{v 1}=\\frac{v_{o 1}}{v_{i}}=G_{m 1} R_{o 1} \\tag{6.53}\n\\end{equation*}\n$$\n\nwhere $G_{m 1}$ and $R_{o 1}$ denote the first stage's transconductance and output resistance, respectively. From equations (4.143) and (4.149),\n\n$$\n\\begin{equation*}\nA_{\\nu 1}=g_{m 1}\\left(r_{o 2} \\| r_{o 4}\\right) \\tag{6.54}\n\\end{equation*}\n$$\n\nLikewise, the second-stage voltage gain is\n\n$$\n\\begin{equation*}\nA_{\\nu 2}=-g_{m 6} R_{o} \\tag{6.55}\n\\end{equation*}\n$$\n\nwith $R_{o}$ as defined in (6.52). Consequently, the amplifier's overall gain is\n\n$$\n\\begin{equation*}\nA_{v}=A_{v 1} A_{v 2}=-g_{m 1}\\left(r_{o 2} \\| r_{o 4}\\right) g_{m 6}\\left(r_{o 6} \\| r_{o 7}\\right) \\tag{6.56}\n\\end{equation*}\n$$\n\nThis equation indicates that the overall gain is related to $\\left(g_{m} r_{o}\\right)^{2}$. As per (3.27),\n\n$$\n\\begin{equation*}\ng_{m} r_{o}=\\frac{2 V_{A}}{V_{o v}} \\tag{6.57}\n\\end{equation*}\n$$\n\nThus, the overall voltage gain heavily depends on the Early voltage (proportional to the effective channel length) and the overdrive (determined by the bias conditions).\n\n#### EXAMPLE\n\nDetermine the gain of the op amp in Fig. 6.16, assuming it employs the $0.8-\\mu \\mathrm{m}$ process technology detailed in Table 2.3, with $L_{\\text {eff }}=0.8 \\mu \\mathrm{~m}$ and $\\left|V_{o v}\\right|=\\left|V_{G S}-V_{t}\\right|=0.2 \\mathrm{~V}$ for all devices.\n\nLet $I_{D 2}, I_{D 4}, I_{D 6}$, and $I_{D 7}$ denote the bias currents into the drains of $M_{2}, M_{4}$, $M_{6}$, and $M_{7}$, respectively. Given $I_{D 4}=-I_{D 2}$ and $I_{D 7}=-I_{D 6}$, (6.56) yields\n\n$$\n\\begin{align*}\nA_{v} & =-g_{m 1}\\left(\\frac{\\frac{\\left|V_{A 2}\\right|}{\\left|I_{D 2}\\right|} \\frac{V_{A 4}}{\\left|I_{D 2}\\right|}}{\\frac{\\left|V_{A 2}\\right|}{\\left|I_{D 2}\\right|}+\\frac{V_{A 4}}{\\left|I_{D 2}\\right|}}\\right) g_{m 6}\\left(\\frac{\\frac{V_{A 6}}{I_{D 6}} \\frac{\\left|V_{A 7}\\right|}{I_{D 6}}}{\\frac{V_{A 6}}{I_{D 6}}+\\frac{\\left|V_{A 7}\\right|}{I_{D 6}}}\\right)  \\tag{6.58}\\\\\n& =-\\frac{g_{m 1}}{\\left|I_{D 2}\\right|} \\frac{g_{m 6}}{I_{D 6}}\\left(\\frac{\\left|V_{A 2}\\right| V_{A 4}}{\\left|V_{A 2}\\right|+V_{A 4}}\\right)\\left(\\frac{V_{A 6}\\left|V_{A 7}\\right|}{V_{A 6}+\\left|V_{A 7}\\right|}\\right)\n\\end{align*}\n$$\n\nHere, the absolute-value function ensures all quantities in (6.58) are positive. From (1.181),\n\n$$\n\\begin{equation*}\nA_{v}=-\\frac{2}{\\left|V_{o v 1}\\right|} \\frac{2}{V_{o v 6}}\\left(\\frac{\\left|V_{A 2}\\right| V_{A 4}}{\\left|V_{A 2}\\right|+V_{A 4}}\\right)\\left(\\frac{V_{A 6}\\left|V_{A 7}\\right|}{V_{A 6}+\\left|V_{A 7}\\right|}\\right) \\tag{6.59}\n\\end{equation*}\n$$\n\nsince $I_{D 1}=I_{D 2}$ with zero differential input. According to (1.163),\n\n$$\n\\begin{equation*}\nV_{A}=L_{\\mathrm{eff}}\\left(\\frac{d X_{d}}{d V_{D S}}\\right)^{-1} \\tag{6.60}\n\\end{equation*}\n$$\n\nSubstituting (6.60) into (6.59) with the provided data and $d X_{d} / d V_{D S}$ from Table 2.3 results in\n\n$$\nA_{v}=-\\frac{2}{0.2} \\frac{2}{0.2}\\left(\\frac{\\frac{0.8}{0.04} \\times \\frac{0.8}{0.08}}{\\frac{0.8}{0.04}+\\frac{0.8}{0.08}}\\right)^{2} \\simeq-4400\n$$\n\nThe overall gain can be enhanced by either increasing the channel lengths to elevate the Early voltages or by decreasing the bias current to reduce the overdrives."
},
{
    "text": "The initial stage depicted in Fig. 6.16 comprises a $p$-channel differential pair $M_{1}-M_{2}$, accompanied by an $n$-channel current mirror load $M_{3}-M_{4}$ and a $p$-channel tail current source $M_{5}$. The subsequent stage features an $n$-channel common-source amplifier $M_{6}$, paired with a $p$-channel current-source load $M_{7}$. Given that the op-amp inputs are linked to the gates of MOS transistors, the input resistance is virtually infinite for internal applications, obviating the need for the protection diodes detailed in Section 6.2.7. This infinite input resistance also applies to the second stage of the op amp.\n\nThe output resistance is determined by looking back into the second stage with the op-amp inputs connected to small-signal ground:\n\n$$\n\\begin{equation*}\nR_{o}=r_{o 6} \\| r_{o 7} \\tag{6.52}\n\\end{equation*}\n$$\n\nDespite this output resistance typically being much higher than that of general-purpose bipolar op amps, a low output resistance is generally unnecessary when driving purely capacitive loads.\n\nGiven the essentially infinite input resistance of the second stage, the voltage gain of the amplifier in Fig. 6.16 can be computed by analyzing the two stages independently. The first stage mirrors the configuration discussed in Section 4.3.5, with a small-signal voltage gain of\n\n$$\n\\begin{equation*}\nA_{v 1}=\\frac{v_{o 1}}{v_{i}}=G_{m 1} R_{o 1} \\tag{6.53}\n\\end{equation*}\n$$\n\nwhere $G_{m 1}$ and $R_{o 1}$ denote the transconductance and output resistance of the first stage, respectively. From equations (4.143) and (4.149),\n\n$$\n\\begin{equation*}\nA_{\\nu 1}=g_{m 1}\\left(r_{o 2} \\| r_{o 4}\\right) \\tag{6.54}\n\\end{equation*}\n$$\n\nLikewise, the voltage gain of the second stage is\n\n$$\n\\begin{equation*}\nA_{\\nu 2}=-g_{m 6} R_{o} \\tag{6.55}\n\\end{equation*}\n$$\n\nwith $R_{o}$ as defined in (6.52). Consequently, the overall gain of the amplifier is\n\n$$\n\\begin{equation*}\nA_{v}=A_{v 1} A_{v 2}=-g_{m 1}\\left(r_{o 2} \\| r_{o 4}\\right) g_{m 6}\\left(r_{o 6} \\| r_{o 7}\\right) \\tag{6.56}\n\\end{equation*}\n$$\n\nThis equation illustrates that the overall gain is related to the quantity $\\left(g_{m} r_{o}\\right)^{2}$. Referring to (3.27),\n\n$$\n\\begin{equation*}\ng_{m} r_{o}=\\frac{2 V_{A}}{V_{o v}} \\tag{6.57}\n\\end{equation*}\n$$\n\nThus, the overall voltage gain is significantly influenced by the Early voltage (proportional to the effective channel length) and the overdrive (determined by the bias conditions).\n\n#### EXAMPLE\n\nDetermine the gain of the op amp in Fig. 6.16, assuming it employs the $0.8-\\mu \\mathrm{m}$ process technology outlined in Table 2.3. Also, assume $L_{\\text {eff }}=0.8 \\mu \\mathrm{~m}$ and $\\left|V_{o v}\\right|=\\left|V_{G S}-V_{t}\\right|=0.2 \\mathrm{~V}$ for all devices.\n\nLet $I_{D 2}, I_{D 4}, I_{D 6}$, and $I_{D 7}$ represent the bias currents at the drains of $M_{2}, M_{4}$, $M_{6}$, and $M_{7}$, respectively. Given $I_{D 4}=-I_{D 2}$ and $I_{D 7}=-I_{D 6}$, (6.56) yields\n\n$$\n\\begin{align*}\nA_{v} & =-g_{m 1}\\left(\\frac{\\frac{\\left|V_{A 2}\\right|}{\\left|I_{D 2}\\right|} \\frac{V_{A 4}}{\\left|I_{D 2}\\right|}}{\\frac{\\left|V_{A 2}\\right|}{\\left|I_{D 2}\\right|}+\\frac{V_{A 4}}{\\left|I_{D 2}\\right|}}\\right) g_{m 6}\\left(\\frac{\\frac{V_{A 6}}{I_{D 6}} \\frac{\\left|V_{A 7}\\right|}{I_{D 6}}}{\\frac{V_{A 6}}{I_{D 6}}+\\frac{\\left|V_{A 7}\\right|}{I_{D 6}}}\\right)  \\tag{6.58}\\\\\n& =-\\frac{g_{m 1}}{\\left|I_{D 2}\\right|} \\frac{g_{m 6}}{I_{D 6}}\\left(\\frac{\\left|V_{A 2}\\right| V_{A 4}}{\\left|V_{A 2}\\right|+V_{A 4}}\\right)\\left(\\frac{V_{A 6}\\left|V_{A 7}\\right|}{V_{A 6}+\\left|V_{A 7}\\right|}\\right)\n\\end{align*}\n$$\n\nwhere the absolute-value function ensures all quantities in (6.58) are positive. From (1.181),\n\n$$\n\\begin{equation*}\nA_{v}=-\\frac{2}{\\left|V_{o v 1}\\right|} \\frac{2}{V_{o v 6}}\\left(\\frac{\\left|V_{A 2}\\right| V_{A 4}}{\\left|V_{A 2}\\right|+V_{A 4}}\\right)\\left(\\frac{V_{A 6}\\left|V_{A 7}\\right|}{V_{A 6}+\\left|V_{A 7}\\right|}\\right) \\tag{6.59}\n\\end{equation*}\n$$\n\nsince $I_{D 1}=I_{D 2}$ with zero differential input. According to (1.163),\n\n$$\n\\begin{equation*}\nV_{A}=L_{\\mathrm{eff}}\\left(\\frac{d X_{d}}{d V_{D S}}\\right)^{-1} \\tag{6.60}\n\\end{equation*}\n$$\n\nSubstituting (6.60) into (6.59) with the provided data and $d X_{d} / d V_{D S}$ from Table 2.3 results in\n\n$$\nA_{v}=-\\frac{2}{0.2} \\frac{2}{0.2}\\left(\\frac{\\frac{0.8}{0.04} \\times \\frac{0.8}{0.08}}{\\frac{0.8}{0.04}+\\frac{0.8}{0.08}}\\right)^{2} \\simeq-4400\n$$\n\nThe overall gain can be enhanced by either increasing the channel lengths to elevate the Early voltages or by decreasing the bias current to lower the overdrives."
},
{
    "text": "The initial stage in Fig. 6.16 comprises a $p$-channel differential pair $M_{1}-M_{2}$, an $n$-channel current mirror load $M_{3}-M_{4}$, and a $p$-channel tail current source $M_{5}$. The subsequent stage features an $n$-channel common-source amplifier $M_{6}$ paired with a $p$-channel current-source load $M_{7}$. Given that the op-amp inputs are linked to the gates of MOS transistors, the input resistance is virtually infinite for internal applications, negating the need for the protective diodes detailed in Section 6.2.7. This infinite input resistance also applies to the second stage of the op amp.\n\nThe output resistance is determined by looking back into the second stage with the op-amp inputs connected to small-signal ground:\n\n$$\n\\begin{equation*}\nR_{o}=r_{o 6} \\| r_{o 7} \\tag{6.52}\n\\end{equation*}\n$$\n\nDespite typically being much higher than in general-purpose bipolar op amps, a low output resistance is seldom necessary when driving purely capacitive loads.\n\nGiven the essentially infinite input resistance of the second stage, the voltage gain of the amplifier in Fig. 6.16 can be computed by analyzing the two stages independently. The first stage mirrors the configuration discussed in Section 4.3.5, with a small-signal voltage gain of\n\n$$\n\\begin{equation*}\nA_{v 1}=\\frac{v_{o 1}}{v_{i}}=G_{m 1} R_{o 1} \\tag{6.53}\n\\end{equation*}\n$$\n\nwhere $G_{m 1}$ and $R_{o 1}$ denote the transconductance and output resistance of the first stage, respectively. From equations (4.143) and (4.149),\n\n$$\n\\begin{equation*}\nA_{\\nu 1}=g_{m 1}\\left(r_{o 2} \\| r_{o 4}\\right) \\tag{6.54}\n\\end{equation*}\n$$\n\nSimilarly, the voltage gain of the second stage is\n\n$$\n\\begin{equation*}\nA_{\\nu 2}=-g_{m 6} R_{o} \\tag{6.55}\n\\end{equation*}\n$$\n\nwhere $R_{o}$ is defined in (6.52). Consequently, the total gain of the amplifier is\n\n$$\n\\begin{equation*}\nA_{v}=A_{v 1} A_{v 2}=-g_{m 1}\\left(r_{o 2} \\| r_{o 4}\\right) g_{m 6}\\left(r_{o 6} \\| r_{o 7}\\right) \\tag{6.56}\n\\end{equation*}\n$$\n\nThis equation illustrates that the total gain is linked to the quantity $\\left(g_{m} r_{o}\\right)^{2}$. Referring to (3.27),\n\n$$\n\\begin{equation*}\ng_{m} r_{o}=\\frac{2 V_{A}}{V_{o v}} \\tag{6.57}\n\\end{equation*}\n$$\n\nThus, the overall voltage gain is significantly influenced by the Early voltage (proportional to the effective channel length) and the overdrive (determined by the bias conditions).\n\n#### EXAMPLE\n\nDetermine the gain of the op amp in Fig. 6.16, assuming it utilizes the $0.8-\\mu \\mathrm{m}$ process technology detailed in Table 2.3, with $L_{\\text {eff }}=0.8 \\mu \\mathrm{~m}$ and $\\left|V_{o v}\\right|=\\left|V_{G S}-V_{t}\\right|=0.2 \\mathrm{~V}$ for all devices.\n\nLet $I_{D 2}, I_{D 4}, I_{D 6}$, and $I_{D 7}$ denote the bias currents at the drains of $M_{2}, M_{4}$, $M_{6}$, and $M_{7}$, respectively. Since $I_{D 4}=-I_{D 2}$ and $I_{D 7}=-I_{D 6}$, equation (6.56) yields\n\n$$\n\\begin{align*}\nA_{v} & =-g_{m 1}\\left(\\frac{\\frac{\\left|V_{A 2}\\right|}{\\left|I_{D 2}\\right|} \\frac{V_{A 4}}{\\left|I_{D 2}\\right|}}{\\frac{\\left|V_{A 2}\\right|}{\\left|I_{D 2}\\right|}+\\frac{V_{A 4}}{\\left|I_{D 2}\\right|}}\\right) g_{m 6}\\left(\\frac{\\frac{V_{A 6}}{I_{D 6}} \\frac{\\left|V_{A 7}\\right|}{I_{D 6}}}{\\frac{V_{A 6}}{I_{D 6}}+\\frac{\\left|V_{A 7}\\right|}{I_{D 6}}}\\right)  \\tag{6.58}\\\\\n& =-\\frac{g_{m 1}}{\\left|I_{D 2}\\right|} \\frac{g_{m 6}}{I_{D 6}}\\left(\\frac{\\left|V_{A 2}\\right| V_{A 4}}{\\left|V_{A 2}\\right|+V_{A 4}}\\right)\\left(\\frac{V_{A 6}\\left|V_{A 7}\\right|}{V_{A 6}+\\left|V_{A 7}\\right|}\\right)\n\\end{align*}\n$$\n\nwhere the absolute-value function ensures all quantities in (6.58) are positive. From (1.181),\n\n$$\n\\begin{equation*}\nA_{v}=-\\frac{2}{\\left|V_{o v 1}\\right|} \\frac{2}{V_{o v 6}}\\left(\\frac{\\left|V_{A 2}\\right| V_{A 4}}{\\left|V_{A 2}\\right|+V_{A 4}}\\right)\\left(\\frac{V_{A 6}\\left|V_{A 7}\\right|}{V_{A 6}+\\left|V_{A 7}\\right|}\\right) \\tag{6.59}\n\\end{equation*}\n$$\n\nowing to $I_{D 1}=I_{D 2}$ with zero differential input. According to (1.163),\n\n$$\n\\begin{equation*}\nV_{A}=L_{\\mathrm{eff}}\\left(\\frac{d X_{d}}{d V_{D S}}\\right)^{-1} \\tag{6.60}\n\\end{equation*}\n$$\n\nSubstituting (6.60) into (6.59) with the provided data and $d X_{d} / d V_{D S}$ from Table 2.3 results in\n\n$$\nA_{v}=-\\frac{2}{0.2} \\frac{2}{0.2}\\left(\\frac{\\frac{0.8}{0.04} \\times \\frac{0.8}{0.08}}{\\frac{0.8}{0.04}+\\frac{0.8}{0.08}}\\right)^{2} \\simeq-4400\n$$\n\nThe overall gain can be enhanced by either increasing the channel lengths to boost the Early voltages or by decreasing the bias current to lower the overdrives."
},
{
    "text": "The initial stage in Fig. 6.16 comprises a $p$-channel differential pair $M_{1}-M_{2}$, an $n$-channel current mirror load $M_{3}-M_{4}$, and a $p$-channel tail current source $M_{5}$. The subsequent stage features an $n$-channel common-source amplifier $M_{6}$ with a $p$-channel current-source load $M_{7}$. Given that the op-amp inputs are linked to the gates of MOS transistors, the input resistance is virtually infinite for internal applications, negating the need for the protection diodes detailed in Section 6.2.7. This infinite input resistance also applies to the second stage of the op amp.\n\nThe output resistance is determined by looking back into the second stage with the op-amp inputs connected to small-signal ground:\n\n$$\n\\begin{equation*}\nR_{o}=r_{o 6} \\| r_{o 7} \\tag{6.52}\n\\end{equation*}\n$$\n\nAlthough this output resistance typically exceeds that of general-purpose bipolar op amps, a low output resistance is generally unnecessary when driving purely capacitive loads.\n\nDue to the essentially infinite input resistance of the second stage, the voltage gain of the amplifier in Fig. 6.16 can be calculated by analyzing the two stages independently. The first stage mirrors the configuration discussed in Section 4.3.5, with a small-signal voltage gain of\n\n$$\n\\begin{equation*}\nA_{v 1}=\\frac{v_{o 1}}{v_{i}}=G_{m 1} R_{o 1} \\tag{6.53}\n\\end{equation*}\n$$\n\nwhere $G_{m 1}$ and $R_{o 1}$ denote the transconductance and output resistance of the first stage, respectively. From equations (4.143) and (4.149),\n\n$$\n\\begin{equation*}\nA_{\\nu 1}=g_{m 1}\\left(r_{o 2} \\| r_{o 4}\\right) \\tag{6.54}\n\\end{equation*}\n$$\n\nSimilarly, the voltage gain of the second stage is\n\n$$\n\\begin{equation*}\nA_{\\nu 2}=-g_{m 6} R_{o} \\tag{6.55}\n\\end{equation*}\n$$\n\nwhere $R_{o}$ is as defined in (6.52). Consequently, the overall gain of the amplifier is\n\n$$\n\\begin{equation*}\nA_{v}=A_{v 1} A_{v 2}=-g_{m 1}\\left(r_{o 2} \\| r_{o 4}\\right) g_{m 6}\\left(r_{o 6} \\| r_{o 7}\\right) \\tag{6.56}\n\\end{equation*}\n$$\n\nThis equation indicates that the overall gain is related to the quantity $\\left(g_{m} r_{o}\\right)^{2}$. Referring to (3.27),\n\n$$\n\\begin{equation*}\ng_{m} r_{o}=\\frac{2 V_{A}}{V_{o v}} \\tag{6.57}\n\\end{equation*}\n$$\n\nThus, the overall voltage gain strongly depends on the Early voltage (proportional to the effective channel length) and the overdrive (determined by the bias conditions).\n\n#### EXAMPLE\n\nDetermine the gain of the op amp in Fig. 6.16, assuming it utilizes the $0.8-\\mu \\mathrm{m}$ process technology detailed in Table 2.3, with $L_{\\text {eff }}=0.8 \\mu \\mathrm{~m}$ and $\\left|V_{o v}\\right|=\\left|V_{G S}-V_{t}\\right|=0.2 \\mathrm{~V}$ for all devices.\n\nLet $I_{D 2}, I_{D 4}, I_{D 6}$, and $I_{D 7}$ represent the bias currents at the drains of $M_{2}, M_{4}$, $M_{6}$, and $M_{7}$, respectively. Given $I_{D 4}=-I_{D 2}$ and $I_{D 7}=-I_{D 6}$, (6.56) yields\n\n$$\n\\begin{align*}\nA_{v} & =-g_{m 1}\\left(\\frac{\\frac{\\left|V_{A 2}\\right|}{\\left|I_{D 2}\\right|} \\frac{V_{A 4}}{\\left|I_{D 2}\\right|}}{\\frac{\\left|V_{A 2}\\right|}{\\left|I_{D 2}\\right|}+\\frac{V_{A 4}}{\\left|I_{D 2}\\right|}}\\right) g_{m 6}\\left(\\frac{\\frac{V_{A 6}}{I_{D 6}} \\frac{\\left|V_{A 7}\\right|}{I_{D 6}}}{\\frac{V_{A 6}}{I_{D 6}}+\\frac{\\left|V_{A 7}\\right|}{I_{D 6}}}\\right)  \\tag{6.58}\\\\\n& =-\\frac{g_{m 1}}{\\left|I_{D 2}\\right|} \\frac{g_{m 6}}{I_{D 6}}\\left(\\frac{\\left|V_{A 2}\\right| V_{A 4}}{\\left|V_{A 2}\\right|+V_{A 4}}\\right)\\left(\\frac{V_{A 6}\\left|V_{A 7}\\right|}{V_{A 6}+\\left|V_{A 7}\\right|}\\right)\n\\end{align*}\n$$\n\nwhere the absolute-value function ensures all quantities in (6.58) are positive. From (1.181),\n\n$$\n\\begin{equation*}\nA_{v}=-\\frac{2}{\\left|V_{o v 1}\\right|} \\frac{2}{V_{o v 6}}\\left(\\frac{\\left|V_{A 2}\\right| V_{A 4}}{\\left|V_{A 2}\\right|+V_{A 4}}\\right)\\left(\\frac{V_{A 6}\\left|V_{A 7}\\right|}{V_{A 6}+\\left|V_{A 7}\\right|}\\right) \\tag{6.59}\n\\end{equation*}\n$$\n\nsince $I_{D 1}=I_{D 2}$ with zero differential input. According to (1.163),\n\n$$\n\\begin{equation*}\nV_{A}=L_{\\mathrm{eff}}\\left(\\frac{d X_{d}}{d V_{D S}}\\right)^{-1} \\tag{6.60}\n\\end{equation*}\n$$\n\nSubstituting (6.60) into (6.59) with the provided data and $d X_{d} / d V_{D S}$ from Table 2.3 results in\n\n$$\nA_{v}=-\\frac{2}{0.2} \\frac{2}{0.2}\\left(\\frac{\\frac{0.8}{0.04} \\times \\frac{0.8}{0.08}}{\\frac{0.8}{0.04}+\\frac{0.8}{0.08}}\\right)^{2} \\simeq-4400\n$$\n\nThe overall gain can be enhanced by either increasing the channel lengths to elevate the Early voltages or by decreasing the bias current to reduce the overdrives."
},
{
    "text": "The initial phase in Fig. 6.16 features a $p$-channel differential pair $M_{1}-M_{2}$ paired with an $n$-channel current mirror load $M_{3}-M_{4}$ and a $p$-channel tail current source $M_{5}$. The subsequent stage comprises an $n$-channel common-source amplifier $M_{6}$ equipped with a $p$-channel current-source load $M_{7}$. Given that the op-amp inputs are linked to the gates of MOS transistors, the input resistance is virtually infinite for internal applications, obviating the need for the protective diodes detailed in Section 6.2.7. This infinite input resistance characteristic also applies to the second stage of the op amp.\n\nThe output resistance is determined by looking back into the second stage with the op-amp inputs connected to small-signal ground:\n\n$$\n\\begin{equation*}\nR_{o}=r_{o 6} \\| r_{o 7} \\tag{6.52}\n\\end{equation*}\n$$\n\nAlthough this output resistance typically exceeds that of general-purpose bipolar op amps, a low output resistance is seldom necessary when driving purely capacitive loads.\n\nDue to the essentially infinite input resistance of the second stage, the voltage gain of the amplifier in Fig. 6.16 can be computed by analyzing the two stages independently. The first stage mirrors the configuration discussed in Section 4.3.5, with a small-signal voltage gain of\n\n$$\n\\begin{equation*}\nA_{v 1}=\\frac{v_{o 1}}{v_{i}}=G_{m 1} R_{o 1} \\tag{6.53}\n\\end{equation*}\n$$\n\nwhere $G_{m 1}$ and $R_{o 1}$ denote the transconductance and output resistance of the first stage, respectively. From equations (4.143) and (4.149),\n\n$$\n\\begin{equation*}\nA_{\\nu 1}=g_{m 1}\\left(r_{o 2} \\| r_{o 4}\\right) \\tag{6.54}\n\\end{equation*}\n$$\n\nSimilarly, the voltage gain of the second stage is\n\n$$\n\\begin{equation*}\nA_{\\nu 2}=-g_{m 6} R_{o} \\tag{6.55}\n\\end{equation*}\n$$\n\nwith $R_{o}$ as defined in (6.52). Consequently, the total gain of the amplifier is\n\n$$\n\\begin{equation*}\nA_{v}=A_{v 1} A_{v 2}=-g_{m 1}\\left(r_{o 2} \\| r_{o 4}\\right) g_{m 6}\\left(r_{o 6} \\| r_{o 7}\\right) \\tag{6.56}\n\\end{equation*}\n$$\n\nThis equation indicates that the total gain is proportional to $\\left(g_{m} r_{o}\\right)^{2}$. Referring to (3.27),\n\n$$\n\\begin{equation*}\ng_{m} r_{o}=\\frac{2 V_{A}}{V_{o v}} \\tag{6.57}\n\\end{equation*}\n$$\n\nThus, the overall voltage gain is significantly influenced by the Early voltage (correlated with the effective channel length) and the overdrive (dictated by the bias conditions).\n\n#### EXAMPLE\n\nDetermine the gain of the op amp in Fig. 6.16, assuming it utilizes the $0.8-\\mu \\mathrm{m}$ process technology outlined in Table 2.3. Also, assume $L_{\\text {eff }}=0.8 \\mu \\mathrm{~m}$ and $\\left|V_{o v}\\right|=\\left|V_{G S}-V_{t}\\right|=0.2 \\mathrm{~V}$ for all devices.\n\nLet $I_{D 2}, I_{D 4}, I_{D 6}$, and $I_{D 7}$ denote the bias currents flowing into the drains of $M_{2}, M_{4}$, $M_{6}$, and $M_{7}$, respectively. Given that $I_{D 4}=-I_{D 2}$ and $I_{D 7}=-I_{D 6}$, equation (6.56) yields\n\n$$\n\\begin{align*}\nA_{v} & =-g_{m 1}\\left(\\frac{\\frac{\\left|V_{A 2}\\right|}{\\left|I_{D 2}\\right|} \\frac{V_{A 4}}{\\left|I_{D 2}\\right|}}{\\frac{\\left|V_{A 2}\\right|}{\\left|I_{D 2}\\right|}+\\frac{V_{A 4}}{\\left|I_{D 2}\\right|}}\\right) g_{m 6}\\left(\\frac{\\frac{V_{A 6}}{I_{D 6}} \\frac{\\left|V_{A 7}\\right|}{I_{D 6}}}{\\frac{V_{A 6}}{I_{D 6}}+\\frac{\\left|V_{A 7}\\right|}{I_{D 6}}}\\right)  \\tag{6.58}\\\\\n& =-\\frac{g_{m 1}}{\\left|I_{D 2}\\right|} \\frac{g_{m 6}}{I_{D 6}}\\left(\\frac{\\left|V_{A 2}\\right| V_{A 4}}{\\left|V_{A 2}\\right|+V_{A 4}}\\right)\\left(\\frac{V_{A 6}\\left|V_{A 7}\\right|}{V_{A 6}+\\left|V_{A 7}\\right|}\\right)\n\\end{align*}\n$$\n\nwhere the absolute-value function ensures all quantities in (6.58) are positive. From (1.181),\n\n$$\n\\begin{equation*}\nA_{v}=-\\frac{2}{\\left|V_{o v 1}\\right|} \\frac{2}{V_{o v 6}}\\left(\\frac{\\left|V_{A 2}\\right| V_{A 4}}{\\left|V_{A 2}\\right|+V_{A 4}}\\right)\\left(\\frac{V_{A 6}\\left|V_{A 7}\\right|}{V_{A 6}+\\left|V_{A 7}\\right|}\\right) \\tag{6.59}\n\\end{equation*}\n$$\n\nsince $I_{D 1}=I_{D 2}$ with zero differential input. According to (1.163),\n\n$$\n\\begin{equation*}\nV_{A}=L_{\\mathrm{eff}}\\left(\\frac{d X_{d}}{d V_{D S}}\\right)^{-1} \\tag{6.60}\n\\end{equation*}\n$$\n\nSubstituting (6.60) into (6.59) with the provided data and $d X_{d} / d V_{D S}$ from Table 2.3 results in\n\n$$\nA_{v}=-\\frac{2}{0.2} \\frac{2}{0.2}\\left(\\frac{\\frac{0.8}{0.04} \\times \\frac{0.8}{0.08}}{\\frac{0.8}{0.04}+\\frac{0.8}{0.08}}\\right)^{2} \\simeq-4400\n$$\n\nThe overall gain can be enhanced by either increasing the channel lengths of the devices to elevate the Early voltages or by decreasing the bias current to lower the overdrives."
},
{
    "text": "The initial stage in Fig. 6.16 comprises a $p$-channel differential pair $M_{1}-M_{2}$, an $n$-channel current mirror load $M_{3}-M_{4}$, and a $p$-channel tail current source $M_{5}$. The subsequent stage features an $n$-channel common-source amplifier $M_{6}$ with a $p$-channel current-source load $M_{7}$. Given that the op-amp inputs are linked to the gates of MOS transistors, the input resistance is virtually infinite for internal applications, obviating the need for the protection diodes detailed in Section 6.2.7. This infinite input resistance also applies to the second stage of the op amp.\n\nThe output resistance is determined by looking back into the second stage with the op-amp inputs connected to small-signal ground:\n\n$$\n\\begin{equation*}\nR_{o}=r_{o 6} \\| r_{o 7} \\tag{6.52}\n\\end{equation*}\n$$\n\nAlthough this output resistance typically exceeds that of general-purpose bipolar op amps, a low output resistance is generally unnecessary when driving purely capacitive loads.\n\nDue to the essentially infinite input resistance of the second stage, the voltage gain of the amplifier in Fig. 6.16 can be calculated by analyzing the two stages independently. The first stage mirrors the configuration discussed in Section 4.3.5, with a small-signal voltage gain of\n\n$$\n\\begin{equation*}\nA_{v 1}=\\frac{v_{o 1}}{v_{i}}=G_{m 1} R_{o 1} \\tag{6.53}\n\\end{equation*}\n$$\n\nwhere $G_{m 1}$ and $R_{o 1}$ represent the transconductance and output resistance of the first stage, respectively. From equations (4.143) and (4.149),\n\n$$\n\\begin{equation*}\nA_{\\nu 1}=g_{m 1}\\left(r_{o 2} \\| r_{o 4}\\right) \\tag{6.54}\n\\end{equation*}\n$$\n\nSimilarly, the voltage gain of the second stage is\n\n$$\n\\begin{equation*}\nA_{\\nu 2}=-g_{m 6} R_{o} \\tag{6.55}\n\\end{equation*}\n$$\n\nwhere $R_{o}$ is defined in (6.52). Consequently, the overall gain of the amplifier is\n\n$$\n\\begin{equation*}\nA_{v}=A_{v 1} A_{v 2}=-g_{m 1}\\left(r_{o 2} \\| r_{o 4}\\right) g_{m 6}\\left(r_{o 6} \\| r_{o 7}\\right) \\tag{6.56}\n\\end{equation*}\n$$\n\nThis equation indicates that the overall gain is related to the quantity $\\left(g_{m} r_{o}\\right)^{2}$. Referring to (3.27),\n\n$$\n\\begin{equation*}\ng_{m} r_{o}=\\frac{2 V_{A}}{V_{o v}} \\tag{6.57}\n\\end{equation*}\n$$\n\nThus, the overall voltage gain strongly depends on the Early voltage (proportional to the effective channel length) and the overdrive (determined by the bias conditions).\n\n#### EXAMPLE\n\nDetermine the gain of the op amp in Fig. 6.16, assuming it utilizes the $0.8-\\mu \\mathrm{m}$ process technology outlined in Table 2.3. Also, assume $L_{\\text {eff }}=0.8 \\mu \\mathrm{~m}$ and $\\left|V_{o v}\\right|=\\left|V_{G S}-V_{t}\\right|=0.2 \\mathrm{~V}$ for all devices.\n\nLet $I_{D 2}, I_{D 4}, I_{D 6}$, and $I_{D 7}$ denote the bias currents flowing into the drains of $M_{2}, M_{4}$, $M_{6}$, and $M_{7}$, respectively. Since $I_{D 4}=-I_{D 2}$ and $I_{D 7}=-I_{D 6}$, (6.56) yields\n\n$$\n\\begin{align*}\nA_{v} & =-g_{m 1}\\left(\\frac{\\frac{\\left|V_{A 2}\\right|}{\\left|I_{D 2}\\right|} \\frac{V_{A 4}}{\\left|I_{D 2}\\right|}}{\\frac{\\left|V_{A 2}\\right|}{\\left|I_{D 2}\\right|}+\\frac{V_{A 4}}{\\left|I_{D 2}\\right|}}\\right) g_{m 6}\\left(\\frac{\\frac{V_{A 6}}{I_{D 6}} \\frac{\\left|V_{A 7}\\right|}{I_{D 6}}}{\\frac{V_{A 6}}{I_{D 6}}+\\frac{\\left|V_{A 7}\\right|}{I_{D 6}}}\\right)  \\tag{6.58}\\\\\n& =-\\frac{g_{m 1}}{\\left|I_{D 2}\\right|} \\frac{g_{m 6}}{I_{D 6}}\\left(\\frac{\\left|V_{A 2}\\right| V_{A 4}}{\\left|V_{A 2}\\right|+V_{A 4}}\\right)\\left(\\frac{V_{A 6}\\left|V_{A 7}\\right|}{V_{A 6}+\\left|V_{A 7}\\right|}\\right)\n\\end{align*}\n$$\n\nwhere the absolute-value function ensures all quantities in (6.58) are positive. From (1.181),\n\n$$\n\\begin{equation*}\nA_{v}=-\\frac{2}{\\left|V_{o v 1}\\right|} \\frac{2}{V_{o v 6}}\\left(\\frac{\\left|V_{A 2}\\right| V_{A 4}}{\\left|V_{A 2}\\right|+V_{A 4}}\\right)\\left(\\frac{V_{A 6}\\left|V_{A 7}\\right|}{V_{A 6}+\\left|V_{A 7}\\right|}\\right) \\tag{6.59}\n\\end{equation*}\n$$\n\nbecause $I_{D 1}=I_{D 2}$ with zero differential input. From (1.163),\n\n$$\n\\begin{equation*}\nV_{A}=L_{\\mathrm{eff}}\\left(\\frac{d X_{d}}{d V_{D S}}\\right)^{-1} \\tag{6.60}\n\\end{equation*}\n$$\n\nSubstituting (6.60) into (6.59) with the provided data and $d X_{d} / d V_{D S}$ from Table 2.3 results in\n\n$$\nA_{v}=-\\frac{2}{0.2} \\frac{2}{0.2}\\left(\\frac{\\frac{0.8}{0.04} \\times \\frac{0.8}{0.08}}{\\frac{0.8}{0.04}+\\frac{0.8}{0.08}}\\right)^{2} \\simeq-4400\n$$\n\nThe overall gain can be enhanced by either increasing the channel lengths to elevate the Early voltages or by decreasing the bias current to lower the overdrives."
},
{
    "text": "In Sections 3.5.6 and 6.2.3, the input offset voltage of a differential amplifier is defined as the differential input voltage that results in a zero differential output voltage. However, since the op amp in Fig. 6.16 features a single-ended output, this definition requires modification. By considering the voltage between the output node and ground as the output voltage, the simplest adjustment is to define the input offset voltage of the op amp as the differential input voltage that yields a zero op-amp output voltage. This definition is appropriate if $V_{D D}=V_{S S}$, as setting the output voltage to zero maximizes the allowable output voltage variation before a transistor enters the triode region, provided $V_{o v 6}=\\left|V_{o v 7}\\right|$. If $V_{D D} \\neq V_{S S}$, the output voltage should be set halfway between the supply voltages to maximize the output swing. Thus, we define the input offset voltage for op amps with differential inputs and single-ended outputs as the differential input voltage that positions the dc output voltage midway between the supplies.\n\nThe offset voltage of an op amp consists of two components: systematic offset and random offset. The systematic offset arises from the circuit design and is present even when all matched devices in the circuit are identical. The random offset results from mismatches in supposedly identical pairs of devices.\n\n**Systematic Offset Voltage:** In bipolar technologies, the high gain of each op amp stage (around 500) is due to the $g_{m} r_{o}$ product typically exceeding 1000. Consequently, the input-referred offset voltage of a bipolar op amp mainly depends on the first stage's design. In MOS technologies, however, the $g_{m} r_{o}$ product usually ranges from 20 to 100, reducing per-stage gain and sometimes making the second stage's offset significant in determining the op-amp offset voltage.\n\nTo analyze systematic offset, Fig. 6.17 depicts the op amp from Fig. 6.16 divided into two stages. If the first stage's inputs are grounded and matching is perfect, the dc drain-source voltage of $M_{4}$ must equal that of $M_{3}$. This follows from the observation that if $V_{D S 3}=V_{D S 4}$, then $V_{D S 1}=V_{D S 2}$ and $I_{D 1}=I_{D 2}=I_{D 5} / 2$. Hence, with $V_{D S 3}=V_{D S 4}$, $I_{D 3}=I_{D 4}=-I_{D 5} / 2$. Consequently, $V_{D S 3}$ must equal $V_{D S 4}$ because this is the only operating point where the current exiting $M_{2}$'s drain equals the current entering $M_{4}$'s drain. For instance, increasing $M_{4}$'s drain-source voltage would raise the current into $M_{4}$'s drain but decrease the current out of $M_{2}$'s drain due to channel-length modulation effects. Therefore, under these conditions, $M_{3}$ and $M_{4}$'s dc drain-source voltages must be equal.\n\nConversely, the gate-source voltage of $M_{6}$ needed to set the amplifier output voltage midway between the supplies may differ from the first stage's dc output voltage. If the first stage has a gain of 50, for example, each $50-\\mathrm{mV}$ difference in these voltages results in a 1 mV input-referred systematic offset. Ignoring channel-length modulation in $M_{5}$ and $M_{7}$, the current in these transistors is independent of their drain-source voltages if they operate in the active region. To set the output voltage midway between the supplies, $M_{6}$'s gate-source voltage should be chosen so that $M_{6}$'s drain current equals $M_{7}$'s while both are in the active region. When the second stage's input connects to the first stage's output, $V_{G S 6}=V_{D S 4}$. With perfect matching and zero input voltages, $V_{D S 4}=V_{D S 3}=V_{G S 3}$ and $V_{t 3}=V_{t 4}=V_{t 6}$. Thus,\n\n$$\n\\begin{equation*}\nV_{o v 3}=V_{o v 4}=V_{o v 6} \\tag{6.62}\n\\end{equation*}\n$$\n\nSubstituting (1.166) into (6.62) yields\n\n$$\n\\begin{equation*}\n\\frac{I_{D 3}}{(W / L)_{3}}=\\frac{I_{D 4}}{(W / L)_{4}}=\\frac{I_{D 6}}{(W / L)_{6}} \\tag{6.63}\n\\end{equation*}\n$$\n\nIn other words, requiring equal overdrives is equivalent to requiring equal drain-current-to-W/L ratios (or current densities). Since $I_{D 3}=I_{D 4}=\\left|I_{D 5}\\right| / 2$ and $I_{D 6}=\\left|I_{D 7}\\right|$,\n\n$$\n\\begin{equation*}\n\\frac{\\left|I_{D 5}\\right|}{2(W / L)_{3}}=\\frac{\\left|I_{D 5}\\right|}{2(W / L)_{4}}=\\frac{\\left|I_{D 7}\\right|}{(W / L)_{6}} \\tag{6.64}\n\\end{equation*}\n$$\n\nSince $M_{5}$ and $M_{7}$ have equal gate-source voltages,\n\n$$\n\\begin{equation*}\n\\frac{I_{D 5}}{I_{D 7}}=\\frac{(W / L)_{5}}{(W / L)_{7}} \\tag{6.65}\n\\end{equation*}\n$$\n\nSubstituting (6.65) into (6.64) gives\n\n$$\n\\begin{equation*}\n\\frac{(W / L)_{3}}{(W / L)_{6}}=\\frac{(W / L)_{4}}{(W / L)_{6}}=\\frac{1}{2} \\frac{(W / L)_{5}}{(W / L)_{7}} \\tag{6.66}\n\\end{equation*}\n$$\n\nWith aspect ratios chosen to satisfy (6.66), $M_{3}, M_{4}$, and $M_{6}$ operate with equal current densities. In the active region, a device's current density depends not only on its gate-source voltage but also somewhat on its drain-source voltage. Since $M_{3}, M_{4}$, and $M_{6}$ have equal gate-source voltages and current densities, their drain-source voltages must also be equal. Therefore, the dc output voltage under these conditions is\n\n$$\n\\begin{equation*}\nV_{O}=V_{D S 6}-V_{S S}=V_{D S 3}-V_{S S}=V_{G S 3}-V_{S S}=V_{t 3}+V_{o v 3}-V_{S S} \\tag{6.67}\n\\end{equation*}\n$$\n\nTo determine the systematic offset voltage at the op-amp output, the output voltage in (6.67) should be subtracted from a voltage midway between the supplies. To refer this systematic offset voltage to the op-amp input, this difference should be divided by the op-amp gain, resulting in\n\n$$\n\\begin{equation*}\nV_{O S(s y s)}=\\frac{\\frac{V_{D D}-V_{S S}}{2}-\\left(V_{t 3}+V_{o v 3}-V_{S S}\\right)}{A_{v}} \\tag{6.68}\n\\end{equation*}\n$$\n\nwhere $A_{v}$ is the op-amp gain given in (6.56). Generally, the dc output voltage will not be midway between the supplies because $V_{G S 3}=V_{t 3}+V_{o v 3} \\neq\\left(V_{D D}+V_{S S}\\right) / 2$. Thus, the systematic offset is usually nonzero. Although the systematic offset voltage is typically nonzero, selecting aspect ratios as per (6.66) can yield an operating point insensitive to process variations, as explained next.\n\nEquation 2.35 indicates that a MOS transistor's effective channel length differs from its drawn length due to offset terms from side diffusion of the source and drain ($L_{d}$) and the depletion region width around the drain ($X_{d}$). Similarly, the effective width differs from the drawn width by an offset term $d W$ due to the bird's-beak effect in the oxide, as described in Section 2.9.1. To maintain the ratio in (6.66) despite process-induced variations in $L_{d}, X_{d}$, and $d W$, the drawn channel lengths and widths of the ratioed transistors can be made identical. In this case, the ratio in (6.66) can be set to any rational number $J / K$ by connecting $J$ identical $n$-channel units in parallel to form $M_{3}$ and $M_{4}$, while $K n$-channel units in parallel form $M_{6}$. Then, if $M_{5}$ comprises $2 J$ identical $p$-channel units, $M_{7}$ should consist of $K p$-channel units. In practice, matched devices rarely have their channel lengths directly ratioed because using small channel lengths for high-speed operation would heighten sensitivity to process variations. Conversely, the channel widths of matched devices are sometimes directly ratioed when the width is large enough to minimize sensitivity to process variations.\n\nA crucial point in this analysis is the conflict between using identical channel lengths for $M_{3}, M_{4}$, and $M_{6}$ and other requirements. First, for stability reasons discussed in Chapter 9, $M_{6}$ should have a high transconductance, necessitating a short channel length. Second, for low noise and random input offset voltage, $M_{3}$ and $M_{4}$ should have a low transconductance, requiring a long channel length. Noise is addressed in Chapter 11, and random input offset voltage is discussed next.\n\n**Random Input Offset Voltage:** As detailed in Section 3.5.6, source-coupled pairs generally exhibit higher random offset than their bipolar counterparts. Ignoring the second stage's contribution to the input-referred random offset, a straightforward analysis of the circuit in Fig. 6.16, analogous to the analysis leading to (3.248), yields\n\n$$\n\\begin{align*}\nV_{O S} \\simeq & \\Delta V_{t(1-2)}+\\Delta V_{t(3-4)}\\left(\\frac{g_{m 3}}{g_{m 1}}\\right) \\\\\n& +\\frac{V_{o v(1-2)}}{2}\\left[\\frac{\\Delta\\left(\\frac{W}{L}\\right)_{(3-4)}}{\\left(\\frac{W}{L}\\right)_{(3-4)}}-\\frac{\\Delta\\left(\\frac{W}{L}\\right)_{(1-2)}}{\\left(\\frac{W}{L}\\right)_{(1-2)}}\\right] \\tag{6.69}\n\\end{align*}\n$$\n\nThe first term represents the threshold mismatch of the input transistors. The second term, due to the threshold mismatch of the current-mirror-load devices, is minimized by choosing a $W / L$ ratio for the load devices that results in a small transconductance relative to that of the input transistors. Hence, using a longer channel length for $M_{3}$ and $M_{4}$ than for $M_{1}$ and $M_{2}$ reduces the random input offset voltage. The third term accounts for $W / L$ mismatches in the input transistors and loads, minimized by operating the input transistors at low overdrive voltages, typically between 50 and 200 mV."
},
{
    "text": "In Sections 3.5.6 and 6.2.3, the input offset voltage of a differential amplifier was defined as the differential input voltage that results in a zero differential output voltage. Since the op amp in Fig. 6.16 features a single-ended output, this definition requires modification. By considering the voltage between the output node and ground as the output voltage, the most direct modification is to define the input offset voltage of the op amp as the differential input voltage that yields a zero op-amp output voltage. This definition is appropriate if $V_{D D}=V_{S S}$, as setting the output voltage to zero maximizes the allowable output voltage variation before one transistor enters the triode region, provided $V_{o v 6}=\\left|V_{o v 7}\\right|$. However, if $V_{D D} \\neq V_{S S}$, the output voltage should be set midway between the supply voltages to maximize the output swing. Thus, we define the input offset voltage of op amps with differential inputs and single-ended outputs as the differential input voltage that positions the dc output voltage midway between the supplies.\n\nThe offset voltage of an op amp consists of two components: systematic offset and random offset. The systematic offset arises from the circuit design and is present even when all matched devices in the circuit are identical. The random offset results from mismatches in supposedly identical pairs of devices.\n\n**Systematic Offset Voltage:** In bipolar technologies, the gain of each stage in an op amp can be quite high (around 500) due to the $g_{m} r_{o}$ product typically exceeding 1000. Consequently, the input-referred offset voltage of a bipolar op amp mainly depends on the design of the first stage. In MOS technologies, however, the $g_{m} r_{o}$ product usually ranges from 20 to 100, reducing the gain per stage and sometimes making the second stage's offset significant in determining the op-amp offset voltage.\n\nTo analyze the systematic offset, Fig. 6.17 depicts the op amp from Fig. 6.16 divided into two separate stages. If the inputs of the first stage are grounded and matching is perfect, the dc drain-source voltage of $M_{4}$ must equal that of $M_{3}$. This follows from the observation that if $V_{D S 3}=V_{D S 4}$, then $V_{D S 1}=V_{D S 2}$ and $I_{D 1}=I_{D 2}=I_{D 5} / 2$. Hence, with $V_{D S 3}=V_{D S 4}$, $I_{D 3}=I_{D 4}=-I_{D 5} / 2$. Therefore, $V_{D S 3}$ must equal $V_{D S 4}$ because this is the only operating point where the current exiting the drain of $M_{2}$ equals the current entering the drain of $M_{4}$. For instance, increasing $M_{4}$'s drain-source voltage would raise the current into $M_{4}$'s drain but decrease the current out of $M_{2}$'s drain due to channel-length modulation effects. Thus, under these conditions, the dc drain-source voltages of $M_{3}$ and $M_{4}$ must be equal.\n\nConversely, the gate-source voltage of $M_{6}$ needed to set the amplifier output voltage midway between the supplies may differ from the first stage's dc output voltage. If the first stage gain is 50, for example, each $50-\\mathrm{mV}$ difference in these voltages results in 1 mV of input-referred systematic offset. Ignoring channel-length modulation in $M_{5}$ and $M_{7}$, the current in these transistors is independent of their drain-source voltages if they operate in the active region. To set the output voltage midway between the supplies, the gate-source voltage of $M_{6}$ should be chosen so that the drain current of $M_{6}$ equals the drain current of $M_{7}$ while both transistors are in the active region. When the second stage's input connects to the first stage's output, $V_{G S 6}=V_{D S 4}$. With perfect matching and zero input voltages, $V_{D S 4}=V_{D S 3}=V_{G S 3}$ and $V_{t 3}=V_{t 4}=V_{t 6}$. Therefore,\n\n$$\n\\begin{equation*}\nV_{o v 3}=V_{o v 4}=V_{o v 6} \\tag{6.62}\n\\end{equation*}\n$$\n\nSubstituting (1.166) into (6.62) yields\n\n$$\n\\begin{equation*}\n\\frac{I_{D 3}}{(W / L)_{3}}=\\frac{I_{D 4}}{(W / L)_{4}}=\\frac{I_{D 6}}{(W / L)_{6}} \\tag{6.63}\n\\end{equation*}\n$$\n\nIn other words, requiring equal overdrives for the transistors is equivalent to requiring equal drain-current-to-W/L ratios (or current densities). Since $I_{D 3}=I_{D 4}=\\left|I_{D 5}\\right| / 2$ and $I_{D 6}=\\left|I_{D 7}\\right|$,\n\n$$\n\\begin{equation*}\n\\frac{\\left|I_{D 5}\\right|}{2(W / L)_{3}}=\\frac{\\left|I_{D 5}\\right|}{2(W / L)_{4}}=\\frac{\\left|I_{D 7}\\right|}{(W / L)_{6}} \\tag{6.64}\n\\end{equation*}\n$$\n\nSince $M_{5}$ and $M_{7}$ have equal gate-source voltages,\n\n$$\n\\begin{equation*}\n\\frac{I_{D 5}}{I_{D 7}}=\\frac{(W / L)_{5}}{(W / L)_{7}} \\tag{6.65}\n\\end{equation*}\n$$\n\nSubstituting (6.65) into (6.64) gives\n\n$$\n\\begin{equation*}\n\\frac{(W / L)_{3}}{(W / L)_{6}}=\\frac{(W / L)_{4}}{(W / L)_{6}}=\\frac{1}{2} \\frac{(W / L)_{5}}{(W / L)_{7}} \\tag{6.66}\n\\end{equation*}\n$$\n\nWith aspect ratios chosen to satisfy (6.66), $M_{3}$, $M_{4}$, and $M_{6}$ operate with equal current densities. In the active region, a device's current density depends not only on its gate-source voltage but also somewhat on its drain-source voltage. Since the gate-source voltages and current densities of $M_{3}$, $M_{4}$, and $M_{6}$ are equal, their drain-source voltages must also be equal. Therefore, the dc output voltage under these conditions is\n\n$$\n\\begin{equation*}\nV_{O}=V_{D S 6}-V_{S S}=V_{D S 3}-V_{S S}=V_{G S 3}-V_{S S}=V_{t 3}+V_{o v 3}-V_{S S} \\tag{6.67}\n\\end{equation*}\n$$\n\nTo determine the systematic offset voltage at the op-amp output, the output voltage in (6.67) should be subtracted from a voltage midway between the supplies. To refer this systematic offset voltage to the op-amp input, this difference should be divided by the op-amp gain. The result is\n\n$$\n\\begin{equation*}\nV_{O S(s y s)}=\\frac{\\frac{V_{D D}-V_{S S}}{2}-\\left(V_{t 3}+V_{o v 3}-V_{S S}\\right)}{A_{v}} \\tag{6.68}\n\\end{equation*}\n$$\n\nwhere $A_{v}$ is the op-amp gain given in (6.56). In most cases, the dc output voltage will not be midway between the supplies because $V_{G S 3}=V_{t 3}+V_{o v 3} \\neq\\left(V_{D D}+V_{S S}\\right) / 2$. Thus, the systematic offset is usually nonzero. Although the systematic offset voltage is generally nonzero, choosing aspect ratios as in (6.66) can result in an operating point insensitive to process variations, as explained next.\n\nEquation 2.35 indicates that the effective channel length of a MOS transistor differs from its drawn length due to offset terms caused by side diffusion of the source and drain ($L_{d}$) and the depletion region width around the drain ($X_{d}$). Similarly, the effective width of a MOS transistor differs from the drawn width by an offset term $d W$ due to the bird's-beak effect in the oxide, described in Section 2.9.1. To maintain the ratio in (6.66) constant despite process-induced variations in $L_{d}$, $X_{d}$, and $d W$, the drawn channel lengths and widths of the ratioed transistors can be made identical. In this case, the ratio in (6.66) can be set to any rational number $J / K$ by connecting $J$ identical $n$-channel units in parallel to form $M_{3}$ and $M_{4}$, while $K n$-channel units in parallel form $M_{6}$. Then, if $M_{5}$ consists of $2 J$ identical $p$-channel units, $M_{7}$ should be constructed from $K p$-channel units. In practice, for matched devices, channel lengths are rarely ratioed directly because using small channel lengths for high-speed operation would result in significant sensitivity to process variations. Conversely, channel widths of matched devices are sometimes ratioed directly when the width is large enough to render the sensitivity to process variations negligible.\n\nA key point of this analysis is that using identical channel lengths for $M_{3}$, $M_{4}$, and $M_{6}$ conflicts with other requirements. First, for stability reasons discussed in Chapter 9, $M_{6}$ should have a high transconductance and thus a short channel length. Second, for low noise and random input offset voltage, $M_{3}$ and $M_{4}$ should have a low transconductance and hence a long channel length. Noise is covered in Chapter 11, and random input offset voltage is addressed next.\n\n**Random Input Offset Voltage:** As detailed in Section 3.5.6, source-coupled pairs generally exhibit a higher random offset than their bipolar counterparts. Ignoring the second stage's contribution to the input-referred random offset, a straightforward analysis of the circuit in Fig. 6.16, analogous to the analysis leading to (3.248), yields\n\n$$\n\\begin{align*}\nV_{O S} \\simeq & \\Delta V_{t(1-2)}+\\Delta V_{t(3-4)}\\left(\\frac{g_{m 3}}{g_{m 1}}\\right) \\\\\n& +\\frac{V_{o v(1-2)}}{2}\\left[\\frac{\\Delta\\left(\\frac{W}{L}\\right)_{(3-4)}}{\\left(\\frac{W}{L}\\right)_{(3-4)}}-\\frac{\\Delta\\left(\\frac{W}{L}\\right)_{(1-2)}}{\\left(\\frac{W}{L}\\right)_{(1-2)}}\\right] \\tag{6.69}\n\\end{align*}\n$$\n\nThe first term represents the threshold mismatch of the input transistors. The second term is the threshold mismatch of the current-mirror-load devices, minimized by choosing the $W / L$ ratio of the load devices so their transconductance is small compared to that of the input transistors. For this reason, selecting a longer channel length for $M_{3}$ and $M_{4}$ than for $M_{1}$ and $M_{2}$ reduces the random input offset voltage. The third term reflects the effects of $W / L$ mismatches in the input transistors and loads, minimized by operating the input transistors at low overdrive voltages, typically 50 to 200 mV."
},
{
    "text": "In Sections 3.5.6 and 6.2.3, the input offset voltage of a differential amplifier was defined as the differential input voltage that results in a zero differential output voltage. Since the op amp in Fig. 6.16 features a single-ended output, this definition requires modification. By considering the voltage between the output node and ground as the output voltage, the most direct adjustment is to define the input offset voltage of the op amp as the differential input voltage that yields a zero op-amp output voltage. This definition is appropriate if $V_{D D}=V_{S S}$, as setting the output voltage to zero maximizes the allowable output voltage variation before one transistor enters the triode region, assuming $V_{o v 6}=\\left|V_{o v 7}\\right|$. If $V_{D D} \\neq V_{S S}$, however, the output voltage should be set halfway between the supply voltages to maximize the output swing. Consequently, we define the input offset voltage for op amps with differential inputs and single-ended outputs as the differential input voltage that positions the dc output voltage midway between the supply voltages.\n\nThe offset voltage of an op amp consists of two components: the systematic offset and the random offset. The systematic offset arises from the circuit design and is present even when all matched devices in the circuit are identical. The random offset, on the other hand, stems from mismatches in supposedly identical pairs of devices.\n\nSystematic Offset Voltage. In bipolar technologies, each stage of an op amp can exhibit a high gain (around 500) due to the $g_{m} r_{o}$ product typically exceeding 1000. Consequently, the input-referred offset voltage of a bipolar op amp largely depends on the design of the first stage. In MOS technologies, however, the $g_{m} r_{o}$ product usually ranges from 20 to 100, leading to lower gain per stage and sometimes making the second stage's offset significant in determining the op-amp offset voltage.\n\nTo analyze the systematic offset, Fig. 6.17 illustrates the op amp from Fig. 6.16 divided into two separate stages. If the inputs of the first stage are grounded and perfect matching is assumed, the dc drain-source voltage of $M_{4}$ must equal that of $M_{3}$. This conclusion follows from the observation that if $V_{D S 3}=V_{D S 4}$, then $V_{D S 1}=V_{D S 2}$ and $I_{D 1}=I_{D 2}=I_{D 5} / 2$. Thus, with $V_{D S 3}=V_{D S 4}, I_{D 3}=I_{D 4}=-I_{D 5} / 2$. Consequently, $V_{D S 3}$ must equal $V_{D S 4}$ because this operating point is the only one where the current exiting the drain of $M_{2}$ equals the current entering the drain of $M_{4}$. For instance, increasing the drain-source voltage of $M_{4}$ would raise the current entering its drain but decrease the current exiting the drain of $M_{2}$ due to channel-length modulation effects. Therefore, the dc drain-source voltages of $M_{3}$ and $M_{4}$ must be equal under these conditions.\n\nConversely, the gate-source voltage of $M_{6}$ needed to set the amplifier output voltage midway between the supplies may differ from the dc output voltage of the first stage. If the first stage has a gain of 50, for example, each $50-\\mathrm{mV}$ difference in these voltages results in a 1 mV input-referred systematic offset. Ignoring channel-length modulation in $M_{5}$ and $M_{7}$, the current in these transistors is independent of their drain-source voltages if they operate in the active region. To set the output voltage midway between the supplies, the gate-source voltage of $M_{6}$ should be chosen so that the drain current of $M_{6}$ equals the drain current of $M_{7}$ while both transistors operate in the active region. When the second stage's input is connected to the first stage's output, $V_{G S 6}=V_{D S 4}$. With perfect matching and zero input voltages, $V_{D S 4}=V_{D S 3}=V_{G S 3}$ and $V_{t 3}=V_{t 4}=V_{t 6}$. Therefore,\n\n$$\n\\begin{equation*}\nV_{o v 3}=V_{o v 4}=V_{o v 6} \\tag{6.62}\n\\end{equation*}\n$$\n\nSubstituting (1.166) into (6.62) yields\n\n$$\n\\begin{equation*}\n\\frac{I_{D 3}}{(W / L)_{3}}=\\frac{I_{D 4}}{(W / L)_{4}}=\\frac{I_{D 6}}{(W / L)_{6}} \\tag{6.63}\n\\end{equation*}\n$$\n\nIn other words, requiring equal overdrives for the transistors is equivalent to requiring equal drain-current-to-W/L ratios (or current densities). Since $I_{D 3}=I_{D 4}=\\left|I_{D 5}\\right| / 2$ and $I_{D 6}=\\left|I_{D 7}\\right|$,\n\n$$\n\\begin{equation*}\n\\frac{\\left|I_{D 5}\\right|}{2(W / L)_{3}}=\\frac{\\left|I_{D 5}\\right|}{2(W / L)_{4}}=\\frac{\\left|I_{D 7}\\right|}{(W / L)_{6}} \\tag{6.64}\n\\end{equation*}\n$$\n\nSince $M_{5}$ and $M_{7}$ have equal gate-source voltages,\n\n$$\n\\begin{equation*}\n\\frac{I_{D 5}}{I_{D 7}}=\\frac{(W / L)_{5}}{(W / L)_{7}} \\tag{6.65}\n\\end{equation*}\n$$\n\nSubstituting (6.65) into (6.64) gives\n\n$$\n\\begin{equation*}\n\\frac{(W / L)_{3}}{(W / L)_{6}}=\\frac{(W / L)_{4}}{(W / L)_{6}}=\\frac{1}{2} \\frac{(W / L)_{5}}{(W / L)_{7}} \\tag{6.66}\n\\end{equation*}\n$$\n\nWith aspect ratios chosen to satisfy (6.66), $M_{3}, M_{4}$, and $M_{6}$ operate with equal current densities. In the active region, a device's current density depends not only on its gate-source voltage but also somewhat on its drain-source voltage. Since the gate-source voltages and current densities of $M_{3}, M_{4}$, and $M_{6}$ are equal, their drain-source voltages must also be equal. Therefore, the dc output voltage under these conditions is\n\n$$\n\\begin{equation*}\nV_{O}=V_{D S 6}-V_{S S}=V_{D S 3}-V_{S S}=V_{G S 3}-V_{S S}=V_{t 3}+V_{o v 3}-V_{S S} \\tag{6.67}\n\\end{equation*}\n$$\n\nTo determine the systematic offset voltage at the op-amp output, the output voltage in (6.67) should be subtracted from a voltage midway between the supplies. To refer this systematic offset voltage to the op-amp input, this difference should be divided by the op-amp gain. The result is\n\n$$\n\\begin{equation*}\nV_{O S(s y s)}=\\frac{\\frac{V_{D D}-V_{S S}}{2}-\\left(V_{t 3}+V_{o v 3}-V_{S S}\\right)}{A_{v}} \\tag{6.68}\n\\end{equation*}\n$$\n\nwhere $A_{v}$ is the op-amp gain given in (6.56). In most cases, the dc output voltage will not be midway between the supplies because $V_{G S 3}=V_{t 3}+V_{o v 3} \\neq\\left(V_{D D}+V_{S S}\\right) / 2$. Thus, the systematic offset is usually nonzero. Although the systematic offset voltage is generally nonzero, choosing aspect ratios as in (6.66) can lead to an operating point insensitive to process variations, as explained next.\n\nEquation 2.35 indicates that the effective channel length of a MOS transistor differs from its drawn length due to offset terms caused by side diffusion of the source and drain ($L_{d}$) and the depletion region width around the drain ($X_{d}$). Similarly, the effective width of a MOS transistor differs from the drawn width by an offset term $d W$ due to the bird's-beak effect in the oxide, described in Section 2.9.1. To maintain the ratio in (6.66) constant despite process-induced variations in $L_{d}, X_{d}$, and $d W$, the drawn channel lengths and widths of the ratioed transistors can be made identical. In this scenario, the ratio in (6.66) can be set to any rational number $J / K$ by connecting $J$ identical devices called $n$-channel units in parallel to form $M_{3}$ and $M_{4}$, while $K n$-channel units in parallel form $M_{6}$. Then, if $M_{5}$ is constructed from $2 J$ identical devices called $p$-channel units, $M_{7}$ should be constructed from $K p$-channel units. In practice, for matched devices, channel lengths are rarely ratioed directly because using small channel lengths for high-speed operation would result in significant sensitivity to process variations. Conversely, channel widths of matched devices are sometimes ratioed directly when the width is large enough to render the resulting sensitivity to process variations negligible.\n\nA key point of this analysis is that using identical channel lengths for $M_{3}, M_{4}$, and $M_{6}$ conflicts with other requirements. First, for stability reasons discussed in Chapter 9, $M_{6}$ should have a high transconductance and thus a short channel length. Second, for low noise and random input offset voltage, $M_{3}$ and $M_{4}$ should have a low transconductance and hence a long channel length. Noise is addressed in Chapter 11, and random input offset voltage is discussed next.\n\nRandom Input Offset Voltage. As explained in Section 3.5.6, source-coupled pairs typically exhibit a higher random offset than their bipolar counterparts. Ignoring the second stage's contribution to the input-referred random offset, a straightforward analysis of the circuit in Fig. 6.16, analogous to the analysis leading to (3.248), yields\n\n$$\n\\begin{align*}\nV_{O S} \\simeq & \\Delta V_{t(1-2)}+\\Delta V_{t(3-4)}\\left(\\frac{g_{m 3}}{g_{m 1}}\\right) \\\\\n& +\\frac{V_{o v(1-2)}}{2}\\left[\\frac{\\Delta\\left(\\frac{W}{L}\\right)_{(3-4)}}{\\left(\\frac{W}{L}\\right)_{(3-4)}}-\\frac{\\Delta\\left(\\frac{W}{L}\\right)_{(1-2)}}{\\left(\\frac{W}{L}\\right)_{(1-2)}}\\right] \\tag{6.69}\n\\end{align*}\n$$\n\nThe first term represents the threshold mismatch of the input transistors. The second term is the threshold mismatch of the current-mirror-load devices, minimized by selecting the $W / L$ ratio of the load devices so their transconductance is small compared to that of the input transistors. Hence, choosing a longer channel length for $M_{3}$ and $M_{4}$ than for $M_{1}$ and $M_{2}$ reduces the random input offset voltage. The third term accounts for $W / L$ mismatches in the input transistors and loads, minimized by operating the input transistors at low overdrive voltages, typically around 50 to 200 mV."
},
{
    "text": "In Sections 3.5.6 and 6.2.3, the input offset voltage of a differential amplifier is defined as the differential input voltage that results in a zero differential output voltage. Since the op amp in Fig. 6.16 features a single-ended output, this definition requires modification. By considering the voltage between the output node and ground as the output voltage, the simplest adjustment is to define the input offset voltage of the op amp as the differential input voltage that yields a zero op-amp output voltage. This definition is appropriate if $V_{D D}=V_{S S}$, as setting the output voltage to zero maximizes the allowable output voltage variation before a transistor enters the triode region, provided $V_{o v 6}=\\left|V_{o v 7}\\right|$. However, if $V_{D D} \\neq V_{S S}$, the output voltage should be set halfway between the supply voltages to maximize the output swing. Thus, for op amps with differential inputs and single-ended outputs, the input offset voltage is defined as the differential input voltage that positions the dc output voltage midway between the supplies.\n\nThe offset voltage of an op amp comprises two components: systematic offset and random offset. The systematic offset arises from the circuit design and is present even when all matched devices in the circuit are identical. The random offset results from mismatches in supposedly identical pairs of devices.\n\n**Systematic Offset Voltage.** In bipolar technologies, the gain of each stage in an op amp can be quite high (around 500) due to the $g_{m} r_{o}$ product typically exceeding 1000. Consequently, the input-referred offset voltage of a bipolar op amp mainly depends on the design of the first stage. In MOS technologies, however, the $g_{m} r_{o}$ product usually ranges from 20 to 100, reducing the gain per stage and sometimes making the second stage's offset significant in determining the op-amp offset voltage.\n\nTo analyze the systematic offset, Fig. 6.17 depicts the op amp from Fig. 6.16 divided into two separate stages. If the inputs of the first stage are grounded and matching is perfect, the dc drain-source voltage of $M_{4}$ must equal that of $M_{3}$. This conclusion follows from the observation that if $V_{D S 3}=V_{D S 4}$, then $V_{D S 1}=V_{D S 2}$ and $I_{D 1}=I_{D 2}=I_{D 5} / 2$. Thus, with $V_{D S 3}=V_{D S 4}$, $I_{D 3}=I_{D 4}=-I_{D 5} / 2$. Consequently, $V_{D S 3}$ must equal $V_{D S 4}$ because this is the only operating point where the current exiting the drain of $M_{2}$ equals the current entering the drain of $M_{4}$. For instance, increasing $M_{4}$'s drain-source voltage would raise the current into $M_{4}$'s drain but decrease the current out of $M_{2}$'s drain due to channel-length modulation. Therefore, under these conditions, the dc drain-source voltages of $M_{3}$ and $M_{4}$ must be equal.\n\nConversely, the gate-source voltage of $M_{6}$ needed to set the amplifier output voltage midway between the supplies may differ from the first stage's dc output voltage. If the first stage has a gain of 50, for example, each $50-\\mathrm{mV}$ difference in these voltages results in a 1 mV input-referred systematic offset. Ignoring channel-length modulation in $M_{5}$ and $M_{7}$, the current in these transistors is independent of their drain-source voltages if they operate in the active region. To set the output voltage midway between the supplies, the gate-source voltage of $M_{6}$ should be chosen so that the drain current of $M_{6}$ equals the drain current of $M_{7}$ while both transistors are in the active region. When the second stage's input is connected to the first stage's output, $V_{G S 6}=V_{D S 4}$. With perfect matching and zero input voltages, $V_{D S 4}=V_{D S 3}=V_{G S 3}$ and $V_{t 3}=V_{t 4}=V_{t 6}$. Therefore,\n\n$$\n\\begin{equation*}\nV_{o v 3}=V_{o v 4}=V_{o v 6} \\tag{6.62}\n\\end{equation*}\n$$\n\nSubstituting (1.166) into (6.62) yields\n\n$$\n\\begin{equation*}\n\\frac{I_{D 3}}{(W / L)_{3}}=\\frac{I_{D 4}}{(W / L)_{4}}=\\frac{I_{D 6}}{(W / L)_{6}} \\tag{6.63}\n\\end{equation*}\n$$\n\nIn other words, requiring equal overdrives for the transistors is equivalent to requiring equal drain-current-to-W/L ratios (or current densities). Since $I_{D 3}=I_{D 4}=\\left|I_{D 5}\\right| / 2$ and $I_{D 6}=\\left|I_{D 7}\\right|$,\n\n$$\n\\begin{equation*}\n\\frac{\\left|I_{D 5}\\right|}{2(W / L)_{3}}=\\frac{\\left|I_{D 5}\\right|}{2(W / L)_{4}}=\\frac{\\left|I_{D 7}\\right|}{(W / L)_{6}} \\tag{6.64}\n\\end{equation*}\n$$\n\nSince $M_{5}$ and $M_{7}$ have equal gate-source voltages,\n\n$$\n\\begin{equation*}\n\\frac{I_{D 5}}{I_{D 7}}=\\frac{(W / L)_{5}}{(W / L)_{7}} \\tag{6.65}\n\\end{equation*}\n$$\n\nSubstituting (6.65) into (6.64) gives\n\n$$\n\\begin{equation*}\n\\frac{(W / L)_{3}}{(W / L)_{6}}=\\frac{(W / L)_{4}}{(W / L)_{6}}=\\frac{1}{2} \\frac{(W / L)_{5}}{(W / L)_{7}} \\tag{6.66}\n\\end{equation*}\n$$\n\nWith aspect ratios chosen to satisfy (6.66), $M_{3}, M_{4}$, and $M_{6}$ operate with equal current densities. In the active region, a device's current density depends not only on its gate-source voltage but also on its drain-source voltage to some extent. Since the gate-source voltages and current densities of $M_{3}, M_{4}$, and $M_{6}$ are equal, their drain-source voltages must also be equal. Therefore, the dc output voltage under these conditions is\n\n$$\n\\begin{equation*}\nV_{O}=V_{D S 6}-V_{S S}=V_{D S 3}-V_{S S}=V_{G S 3}-V_{S S}=V_{t 3}+V_{o v 3}-V_{S S} \\tag{6.67}\n\\end{equation*}\n$$\n\nTo determine the systematic offset voltage at the op-amp output, the output voltage in (6.67) should be subtracted from a voltage midway between the supplies. To refer this systematic offset voltage to the op-amp input, this difference should be divided by the op-amp gain. The result is\n\n$$\n\\begin{equation*}\nV_{O S(s y s)}=\\frac{\\frac{V_{D D}-V_{S S}}{2}-\\left(V_{t 3}+V_{o v 3}-V_{S S}\\right)}{A_{v}} \\tag{6.68}\n\\end{equation*}\n$$\n\nwhere $A_{v}$ is the op-amp gain given in (6.56). In most cases, the dc output voltage will not be midway between the supplies because $V_{G S 3}=V_{t 3}+V_{o v 3} \\neq\\left(V_{D D}+V_{S S}\\right) / 2$. Thus, the systematic offset is usually nonzero. Although the systematic offset voltage is generally nonzero, choosing aspect ratios as per (6.66) can lead to an operating point insensitive to process variations, as explained next.\n\nEquation 2.35 indicates that the effective channel length of a MOS transistor differs from its drawn length due to offset terms caused by side diffusion of the source and drain ($L_{d}$) and the depletion region width around the drain ($X_{d}$). Similarly, the effective width of a MOS transistor differs from the drawn width by an offset term $d W$ due to the bird's-beak effect in the oxide, described in Section 2.9.1. To maintain the ratio in (6.66) constant despite process-induced variations in $L_{d}, X_{d}$, and $d W$, the drawn channel lengths and widths of the ratioed transistors can each be made identical. In this scenario, the ratio in (6.66) can be set to any rational number $J / K$ by connecting $J$ identical devices called $n$-channel units in parallel to form $M_{3}$ and $M_{4}$, while $K n$-channel units in parallel form $M_{6}$. Then, if $M_{5}$ is constructed from $2 J$ identical devices called $p$-channel units, $M_{7}$ should be constructed from $K p$-channel units. In practice, for matched devices, channel lengths are rarely ratioed directly because using small channel lengths for high-speed operation would result in significant sensitivity to process variations. Conversely, channel widths of matched devices are sometimes ratioed directly when the width is large enough to render the sensitivity to process variations insignificant.\n\nA crucial point of this analysis is that using identical channel lengths for $M_{3}, M_{4}$, and $M_{6}$ conflicts with other requirements. First, for stability reasons detailed in Chapter 9, $M_{6}$ should have a high transconductance and thus a short channel length. Second, for low noise and random input offset voltage, $M_{3}$ and $M_{4}$ should have a low transconductance and therefore a long channel length. Noise is discussed in Chapter 11, and random input offset voltage is addressed next.\n\n**Random Input Offset Voltage.** As explained in Section 3.5.6, source-coupled pairs typically exhibit a higher random offset than their bipolar counterparts. Ignoring the second stage's contribution to the input-referred random offset, a straightforward analysis of the offset voltage for the circuit in Fig. 6.16, analogous to the analysis leading to (3.248), yields\n\n$$\n\\begin{align*}\nV_{O S} \\simeq & \\Delta V_{t(1-2)}+\\Delta V_{t(3-4)}\\left(\\frac{g_{m 3}}{g_{m 1}}\\right) \\\\\n& +\\frac{V_{o v(1-2)}}{2}\\left[\\frac{\\Delta\\left(\\frac{W}{L}\\right)_{(3-4)}}{\\left(\\frac{W}{L}\\right)_{(3-4)}}-\\frac{\\Delta\\left(\\frac{W}{L}\\right)_{(1-2)}}{\\left(\\frac{W}{L}\\right)_{(1-2)}}\\right] \\tag{6.69}\n\\end{align*}\n$$\n\nThe first term represents the threshold mismatch of the input transistors. The second term is the threshold mismatch of the current-mirror-load devices, minimized by choosing the $W / L$ ratio of the load devices so their transconductance is small compared to that of the input transistors. Thus, selecting a longer channel length for $M_{3}$ and $M_{4}$ than for $M_{1}$ and $M_{2}$ reduces the random input offset voltage. The third term accounts for $W / L$ mismatches in the input transistors and loads, minimized by operating the input transistors at low overdrive voltages, typically between 50 to 200 mV."
}
]