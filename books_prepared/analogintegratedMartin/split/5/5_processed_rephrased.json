[

{
    "text": "The depicted linear time-invariant negative feedback system in Fig. 5.1 comprises an amplifier, denoted as $A$, and associated feedback circuitry with a gain of $\\beta$. Fig. 5.1 also identifies the input signal, $u$, the output signal, $y$, the feedback signal, $v$, and the difference signal,\n\n$$\n\\begin{equation*}\n\\mathrm{x}=\\mathrm{u}-\\mathrm{v} \\tag{5.1}\n\\end{equation*}\n$$\n\nIn a physical context, these signals can represent small-signal node voltages or branch currents. ${ }^{1}$\nimage_name:Fig. 5.1\ndescription:Fig. 5.1 illustrates an idealized model of a linear time-invariant negative feedback system, featuring the following key components:\n\n1. **Amplifier (A):** This element amplifies the input signal. It receives the difference signal, \\( x \\), and generates an amplified output.\n\n2. **Feedback Circuitry (β):** This component constitutes the feedback pathway. It takes a part of the output signal, \\( y \\), and returns it to the input to form the feedback signal, \\( v \\), with a gain denoted as \\( \\beta \\).\n\n3. **Summing Junction:** This junction merges the input signal, \\( u \\), and the feedback signal, \\( v \\), to compute their difference, resulting in the difference signal, \\( x = u - v \\).\n\nThe information flow within the system is as follows:\n- The input signal, \\( u \\), enters and combines with the feedback signal, \\( v \\), at the summing junction, producing the difference signal, \\( x \\).\n- The difference signal, \\( x \\), is then amplified by the amplifier (A) to yield the output signal, \\( y \\).\n- A segment of the output signal, \\( y \\), is fed back through the feedback circuitry (β) to create the feedback signal, \\( v \\).\n\nThe diagram includes labels \\( u \\), \\( x \\), \\( y \\), and \\( v \\), signifying the input, difference, output, and feedback signals, respectively. The system's loop gain is defined as \\( L = A \\beta \\).\n\nThe fundamental role of this system is to ensure stability and control by adjusting the output based on feedback. The negative feedback loop aids in error reduction and enhances amplifier performance by comparing the output to the input and minimizing the discrepancy.\n\n1. Identifying the precise circuit variables corresponding to the signals in Fig. 5.1 can be challenging. Section 5.4 applies this model to several practical examples.\n\nClearly,\n\n$$\n\\begin{equation*}\nv=A \\beta x \\equiv L x \\tag{5.2}\n\\end{equation*}\n$$\n\nwhere we define the open-loop gain, or simply \"loop gain,\"\n\n$$\n\\begin{equation*}\nL \\equiv A \\beta \\tag{5.3}\n\\end{equation*}\n$$\n\nGiven that $x=u-v$ in Fig. 5.1, all these quantities must share the same units, making the loop gain $L$ dimensionless.\nViewing the entire feedback system as a single-input single-output block, its input-output relationship is derived as:\n\n$$\n\\begin{gather*}\nx=u-L x \\Rightarrow x=\\frac{u}{1+L}  \\tag{5.4}\\\\\ny=A x=\\frac{A}{1+L} u=\\frac{A}{1+A \\beta} u \\tag{5.5}\n\\end{gather*}\n$$\n\nThe \"closed-loop\" gain is derived from (5.5),\n\n$$\n\\begin{equation*}\nA_{C L} \\equiv \\frac{y}{u}=\\frac{A}{1+A \\beta}=\\frac{A}{1+L} \\tag{5.6}\n\\end{equation*}\n$$\n\nand should not be confused with the loop gain in (5.3)."
},
{
    "text": "The linear time-invariant negative feedback system depicted in Fig. 5.1 comprises an amplifier, $A$, and feedback circuitry with a gain of $\\beta$. Also indicated in Fig. 5.1 are the input signal, $u$, the output signal, $y$, the feedback signal, $v$, and the difference signal,\n\n$$\n\\begin{equation*}\n\\mathrm{x}=\\mathrm{u}-\\mathrm{v} \\tag{5.1}\n\\end{equation*}\n$$\n\nIn physical terms, these signals can represent small-signal node voltages or branch currents. ${ }^{1}$\nimage_name:Fig. 5.1\ndescription:Fig. 5.1 illustrates an ideal model of a linear time-invariant negative feedback system, consisting of the following key components:\n\n1. **Amplifier (A):** This block amplifies the input signal, taking the difference signal, \\( x \\), as its input and producing an amplified output.\n\n2. **Feedback Circuitry (β):** This block constitutes the feedback path, taking a portion of the output signal, \\( y \\), and feeding it back to the input to form the feedback signal, \\( v \\). The gain of this path is represented by \\( \\beta \\).\n\n3. **Summing Junction:** This component combines the input signal, \\( u \\), and the feedback signal, \\( v \\), to calculate the difference signal, \\( x = u - v \\).\n\nThe information flow within the system is as follows:\n- The input signal, \\( u \\), enters the system and is merged with the feedback signal, \\( v \\), at the summing junction to generate the difference signal, \\( x \\).\n- The difference signal, \\( x \\), is then amplified by the amplifier (A) to yield the output signal, \\( y \\).\n- A part of the output signal, \\( y \\), is routed back through the feedback circuitry (β) to create the feedback signal, \\( v \\).\n\nThe diagram includes labels \\( u \\), \\( x \\), \\( y \\), and \\( v \\), representing the input, difference, output, and feedback signals, respectively. The system's loop gain is defined as \\( L = A \\beta \\).\n\nThe main function of this system is to ensure stability and control by adjusting the output based on feedback. The negative feedback loop aids in reducing errors and enhancing amplifier performance by comparing the output to the input and minimizing the difference.\n\n1. Identifying the precise circuit variables corresponding to the signals in Fig. 5.1 can be challenging. Section 5.4 applies this model to several practical examples.\n\nClearly,\n\n$$\n\\begin{equation*}\nv=A \\beta x \\equiv L x \\tag{5.2}\n\\end{equation*}\n$$\n\nwhere the open-loop gain, or \"loop gain,\" is defined as\n\n$$\n\\begin{equation*}\nL \\equiv A \\beta \\tag{5.3}\n\\end{equation*}\n$$\n\nSince $x=u-v$ in Fig. 5.1, all these quantities must share the same units, making the loop gain $L$ dimensionless.\nViewing the entire feedback system as a single-input single-output block, its input-output relationship is derived as follows:\n\n$$\n\\begin{gather*}\nx=u-L x \\Rightarrow x=\\frac{u}{1+L}  \\tag{5.4}\\\\\ny=A x=\\frac{A}{1+L} u=\\frac{A}{1+A \\beta} u \\tag{5.5}\n\\end{gather*}\n$$\n\nThe \"closed-loop\" gain, derived from (5.5), is\n\n$$\n\\begin{equation*}\nA_{C L} \\equiv \\frac{y}{u}=\\frac{A}{1+A \\beta}=\\frac{A}{1+L} \\tag{5.6}\n\\end{equation*}\n$$\n\nThis should not be confused with the loop gain in (5.3)."
},
{
    "text": "The linear time-invariant negative feedback system depicted in Fig. 5.1 comprises an amplifier, denoted as $A$, and feedback circuitry with a gain of $\\beta$. Fig. 5.1 also identifies the input signal, $u$, the output signal, $y$, the feedback signal, $v$, and the difference signal,\n\n$$\n\\begin{equation*}\n\\mathrm{x}=\\mathrm{u}-\\mathrm{v} \\tag{5.1}\n\\end{equation*}\n$$\n\nThese signals can represent small-signal node voltages or branch currents in a physical context. ${ }^{1}$\nimage_name:Fig. 5.1\ndescription:Fig. 5.1 illustrates an idealized model of a linear time-invariant negative feedback system, consisting of:\n\n1. **Amplifier (A):** This component amplifies the input signal. It receives the difference signal, \\( x \\), and generates an amplified output.\n\n2. **Feedback Circuitry (β):** This part of the system provides feedback. It takes a fraction of the output signal, \\( y \\), and returns it as the feedback signal, \\( v \\), with a gain of \\( \\beta \\).\n\n3. **Summing Junction:** This junction merges the input signal, \\( u \\), and the feedback signal, \\( v \\), to compute the difference signal, \\( x = u - v \\).\n\nThe information flow within the system is as follows:\n- The input signal, \\( u \\), combines with the feedback signal, \\( v \\), at the summing junction to form the difference signal, \\( x \\).\n- The difference signal, \\( x \\), is then amplified by the amplifier (A) to produce the output signal, \\( y \\).\n- Part of the output signal, \\( y \\), is fed back through the feedback circuitry (β) to create the feedback signal, \\( v \\).\n\nThe diagram includes labels \\( u \\), \\( x \\), \\( y \\), and \\( v \\) for the input, difference, output, and feedback signals, respectively. The system's loop gain is defined as \\( L = A \\beta \\).\n\nThe main purpose of this system is to ensure stability and control by adjusting the output based on feedback. The negative feedback loop reduces errors and enhances amplifier performance by comparing the output to the input and minimizing the difference.\n\n1. Identifying the exact circuit variables corresponding to the signals in Fig. 5.1 can be challenging. Section 5.4 applies this model to several practical examples.\n\nClearly,\n\n$$\n\\begin{equation*}\nv=A \\beta x \\equiv L x \\tag{5.2}\n\\end{equation*}\n$$\n\nwhere the open-loop gain, or \"loop gain,\" is defined as,\n\n$$\n\\begin{equation*}\nL \\equiv A \\beta \\tag{5.3}\n\\end{equation*}\n$$\n\nSince $x=u-v$ in Fig. 5.1, all signals must share the same units, making the loop gain $L$ dimensionless.\nConsidering the entire feedback system as a single-input single-output block, its input-output relationship is derived as:\n\n$$\n\\begin{gather*}\nx=u-L x \\Rightarrow x=\\frac{u}{1+L}  \\tag{5.4}\\\\\ny=A x=\\frac{A}{1+L} u=\\frac{A}{1+A \\beta} u \\tag{5.5}\n\\end{gather*}\n$$\n\nThe \"closed-loop\" gain, derived from (5.5), is:\n\n$$\n\\begin{equation*}\nA_{C L} \\equiv \\frac{y}{u}=\\frac{A}{1+A \\beta}=\\frac{A}{1+L} \\tag{5.6}\n\\end{equation*}\n$$\n\nThis should not be confused with the loop gain in (5.3)."
},
{
    "text": "The depicted linear time-invariant negative feedback system in Fig. 5.1 comprises an amplifier, denoted as $A$, and associated feedback circuitry with a gain of $\\beta$. Fig. 5.1 also marks the input signal, $u$, the output signal, $y$, the feedback signal, $v$, and the difference signal,\n\n$$\n\\begin{equation*}\n\\mathrm{x}=\\mathrm{u}-\\mathrm{v} \\tag{5.1}\n\\end{equation*}\n$$\n\nIn physical terms, these signals can represent small-signal node voltages or branch currents. ${ }^{1}$\nimage_name:Fig. 5.1\ndescription:Fig. 5.1 illustrates an idealized model of a linear time-invariant negative feedback system, featuring the following key components:\n\n1. **Amplifier (A):** This component amplifies the input signal. It accepts the difference signal, \\( x \\), as input and generates an amplified output.\n\n2. **Feedback Circuitry (β):** This segment handles the feedback within the system. It takes a part of the output signal, \\( y \\), and returns it to the input, forming the feedback signal, \\( v \\). The gain of this path is represented by \\( \\beta \\).\n\n3. **Summing Junction:** This point merges the input signal, \\( u \\), and the feedback signal, \\( v \\). The junction computes the difference between these signals, resulting in the difference signal, \\( x = u - v \\).\n\nThe information flow within the system is as follows:\n- The input signal, \\( u \\), enters and is combined with the feedback signal, \\( v \\), at the summing junction to form the difference signal, \\( x \\).\n- The difference signal, \\( x \\), is then amplified by the amplifier (A) to produce the output signal, \\( y \\).\n- A fraction of the output signal, \\( y \\), is directed back through the feedback circuitry (β) to create the feedback signal, \\( v \\).\n\nThe diagram includes labels \\( u \\), \\( x \\), \\( y \\), and \\( v \\) to denote the input, difference, output, and feedback signals, respectively. The system's loop gain is defined as \\( L = A \\beta \\).\n\nThe primary role of this system is to ensure stability and control by adjusting the output based on feedback. The negative feedback loop aids in error reduction and enhances amplifier performance by comparing the output to the input and minimizing any discrepancies.\n\n1. Identifying the exact circuit variables corresponding to the signals in Fig. 5.1 can sometimes be challenging. Section 5.4 applies this model to several practical examples.\n\nClearly,\n\n$$\n\\begin{equation*}\nv=A \\beta x \\equiv L x \\tag{5.2}\n\\end{equation*}\n$$\n\nwhere the open-loop gain, or simply \"loop gain,\" is defined as\n\n$$\n\\begin{equation*}\nL \\equiv A \\beta \\tag{5.3}\n\\end{equation*}\n$$\n\nGiven that $x=u-v$ in Fig. 5.1, all these quantities must share the same units, making the loop gain $L$ dimensionless.\nWhen viewing the entire feedback system as a single-input single-output block, its input-output relationship is derived as follows:\n\n$$\n\\begin{gather*}\nx=u-L x \\Rightarrow x=\\frac{u}{1+L}  \\tag{5.4}\\\\\ny=A x=\\frac{A}{1+L} u=\\frac{A}{1+A \\beta} u \\tag{5.5}\n\\end{gather*}\n$$\n\nThe \"closed-loop\" gain is derived from (5.5),\n\n$$\n\\begin{equation*}\nA_{C L} \\equiv \\frac{y}{u}=\\frac{A}{1+A \\beta}=\\frac{A}{1+L} \\tag{5.6}\n\\end{equation*}\n$$\n\nThis should not be confused with the loop gain defined in (5.3)."
},
{
    "text": "The linear time-invariant negative feedback system depicted in Fig. 5.1 comprises an amplifier, denoted as $A$, and feedback circuitry with a gain of $\\beta$. Fig. 5.1 also identifies the input signal, $u$, the output signal, $y$, the feedback signal, $v$, and the difference signal,\n\n$$\n\\begin{equation*}\n\\mathrm{x}=\\mathrm{u}-\\mathrm{v} \\tag{5.1}\n\\end{equation*}\n$$\n\nIn a physical context, these signals can represent small-signal node voltages or branch currents. ${ }^{1}$\nimage_name:Fig. 5.1\ndescription:Fig. 5.1 illustrates an ideal model of a linear time-invariant negative feedback system, consisting of the following key components:\n\n1. **Amplifier (A):** This component amplifies the input signal. It receives the difference signal, \\( x \\), and generates an amplified output.\n\n2. **Feedback Circuitry (β):** This part of the system handles the feedback loop. It takes a fraction of the output signal, \\( y \\), and returns it as the feedback signal, \\( v \\), with a gain of \\( \\beta \\).\n\n3. **Summing Junction:** This junction combines the input signal, \\( u \\), and the feedback signal, \\( v \\), to compute the difference signal, \\( x = u - v \\).\n\nThe information flow within the system is as follows:\n- The input signal, \\( u \\), is merged with the feedback signal, \\( v \\), at the summing junction, resulting in the difference signal, \\( x \\).\n- The difference signal, \\( x \\), is then amplified by the amplifier (A) to produce the output signal, \\( y \\).\n- A section of the output signal, \\( y \\), is directed back through the feedback circuitry (β) to create the feedback signal, \\( v \\).\n\nThe diagram includes labels \\( u \\), \\( x \\), \\( y \\), and \\( v \\), representing the input, difference, output, and feedback signals, respectively. The system's loop gain is defined as \\( L = A \\beta \\).\n\nThe main function of this system is to ensure stability and control by adjusting the output based on feedback. The negative feedback loop aids in minimizing errors and enhancing the amplifier's performance by comparing the output to the input and reducing the difference.\n\n1. Identifying the exact circuit variables corresponding to the signals in Fig. 5.1 can sometimes be challenging. Section 5.4 applies this model to several practical examples.\n\nClearly,\n\n$$\n\\begin{equation*}\nv=A \\beta x \\equiv L x \\tag{5.2}\n\\end{equation*}\n$$\n\nwhere we define the open-loop gain, or \"loop gain,\" as\n\n$$\n\\begin{equation*}\nL \\equiv A \\beta \\tag{5.3}\n\\end{equation*}\n$$\n\nSince $x=u-v$ in Fig. 5.1, all these quantities must share the same units, making the loop gain $L$ dimensionless.\nWhen viewing the entire feedback system as a single-input single-output block, its input-output relationship is derived as follows:\n\n$$\n\\begin{gather*}\nx=u-L x \\Rightarrow x=\\frac{u}{1+L}  \\tag{5.4}\\\\\ny=A x=\\frac{A}{1+L} u=\\frac{A}{1+A \\beta} u \\tag{5.5}\n\\end{gather*}\n$$\n\nThe \"closed-loop\" gain, derived from (5.5), is\n\n$$\n\\begin{equation*}\nA_{C L} \\equiv \\frac{y}{u}=\\frac{A}{1+A \\beta}=\\frac{A}{1+L} \\tag{5.6}\n\\end{equation*}\n$$\n\nThis should not be confused with the loop gain defined in (5.3)."
},
{
    "text": "The rephrased text:\n\n```\nThe linear time-invariant negative feedback system depicted in Fig. 5.1 comprises an amplifier, denoted as $A$, and feedback circuitry with a gain of $\\beta$. Also identified in Fig. 5.1 are the input signal, $u$, the output signal, $y$, the feedback signal, $v$, and the difference signal,\n\n$$\n\\begin{equation*}\n\\mathrm{x}=\\mathrm{u}-\\mathrm{v} \\tag{5.1}\n\\end{equation*}\n$$\n\nIn physical terms, these signals can represent small-signal node voltages or branch currents. ${ }^{1}$\nimage_name:Fig. 5.1\ndescription:Fig. 5.1 illustrates an idealized model of a linear time-invariant negative feedback system, consisting of the following key components:\n\n1. **Amplifier (A):** This component amplifies the input signal. It receives the difference signal, \\( x \\), and outputs an amplified version.\n\n2. **Feedback Circuitry (β):** This part handles the feedback loop, taking a fraction of the output signal, \\( y \\), and returning it as the feedback signal, \\( v \\), with a gain of \\( \\beta \\).\n\n3. **Summing Junction:** This junction merges the input signal, \\( u \\), and the feedback signal, \\( v \\), to compute the difference signal, \\( x = u - v \\).\n\nThe information flow within the system is as follows:\n- The input signal, \\( u \\), enters and is combined with the feedback signal, \\( v \\), at the summing junction, producing the difference signal, \\( x \\).\n- The difference signal, \\( x \\), is then amplified by the amplifier (A) to generate the output signal, \\( y \\).\n- Part of the output signal, \\( y \\), is routed back through the feedback circuitry (β) to create the feedback signal, \\( v \\).\n\nThe diagram includes labels \\( u \\), \\( x \\), \\( y \\), and \\( v \\) for the input, difference, output, and feedback signals, respectively. The system's loop gain is defined as \\( L = A \\beta \\).\n\nThe main purpose of this system is to ensure stability and control by adjusting the output based on feedback. The negative feedback loop aids in minimizing errors and enhancing amplifier performance by comparing and reducing the difference between the output and input.\n\n1. Identifying the exact circuit variables corresponding to the signals in Fig. 5.1 can sometimes be challenging. Section 5.4 applies this model to several practical examples.\n\nClearly,\n\n$$\n\\begin{equation*}\nv=A \\beta x \\equiv L x \\tag{5.2}\n\\end{equation*}\n$$\n\nwhere we define the open-loop gain, or \"loop gain,\" as\n\n$$\n\\begin{equation*}\nL \\equiv A \\beta \\tag{5.3}\n\\end{equation*}\n$$\n\nGiven that $x=u-v$ in Fig. 5.1, all these quantities must share the same units, making the loop gain $L$ dimensionless.\nWhen viewing the entire feedback system as a single-input single-output block, its input-output relationship is derived as follows:\n\n$$\n\\begin{gather*}\nx=u-L x \\Rightarrow x=\\frac{u}{1+L}  \\tag{5.4}\\\\\ny=A x=\\frac{A}{1+L} u=\\frac{A}{1+A \\beta} u \\tag{5.5}\n\\end{gather*}\n$$\n\nThe \"closed-loop\" gain, derived from (5.5), is\n\n$$\n\\begin{equation*}\nA_{C L} \\equiv \\frac{y}{u}=\\frac{A}{1+A \\beta}=\\frac{A}{1+L} \\tag{5.6}\n\\end{equation*}\n$$\n\nThis should not be confused with the loop gain defined in (5.3).\n```"
},
{
    "text": "The rephrased text:\n\n```\nThe linear time-invariant negative feedback system depicted in Fig. 5.1 comprises an amplifier, denoted as $A$, and feedback circuitry with a gain of $\\beta$. Also indicated in Fig. 5.1 are the input signal, $u$, the output signal, $y$, the feedback signal, $v$, and the difference signal,\n\n$$\n\\begin{equation*}\n\\mathrm{x}=\\mathrm{u}-\\mathrm{v} \\tag{5.1}\n\\end{equation*}\n$$\n\nIn physical terms, these signals can represent small-signal node voltages or branch currents. ${ }^{1}$\nimage_name:Fig. 5.1\ndescription:Fig. 5.1 illustrates an idealized model of a linear time-invariant negative feedback system, featuring the following key components:\n\n1. **Amplifier (A):** This component amplifies the input signal. It receives the difference signal, \\( x \\), and generates an amplified output.\n\n2. **Feedback Circuitry (β):** This part of the system handles the feedback loop. It takes a fraction of the output signal, \\( y \\), and returns it as the feedback signal, \\( v \\), with a gain of \\( \\beta \\).\n\n3. **Summing Junction:** This junction merges the input signal, \\( u \\), and the feedback signal, \\( v \\), to compute the difference signal, \\( x = u - v \\).\n\nThe information flow within the system is as follows:\n- The input signal, \\( u \\), enters and is combined with the feedback signal, \\( v \\), at the summing junction, producing the difference signal, \\( x \\).\n- The difference signal, \\( x \\), is then amplified by the amplifier (A) to yield the output signal, \\( y \\).\n- A section of the output signal, \\( y \\), is routed back through the feedback circuitry (β) to form the feedback signal, \\( v \\).\n\nThe diagram includes labels for \\( u \\), \\( x \\), \\( y \\), and \\( v \\), signifying the input, difference, output, and feedback signals, respectively. The system's loop gain is expressed as \\( L = A \\beta \\).\n\nThe main role of this system is to ensure stability and control by adjusting the output based on feedback. The negative feedback loop aids in error reduction and enhances amplifier performance by comparing and minimizing the difference between the output and input.\n\n1. Identifying the exact circuit variables corresponding to the signals in Fig. 5.1 can sometimes be challenging. Section 5.4 applies this model to several practical examples.\n\nEvidently,\n\n$$\n\\begin{equation*}\nv=A \\beta x \\equiv L x \\tag{5.2}\n\\end{equation*}\n$$\n\nwhere the open-loop gain, or simply \"loop gain,\" is defined as\n\n$$\n\\begin{equation*}\nL \\equiv A \\beta \\tag{5.3}\n\\end{equation*}\n$$\n\nGiven that $x=u-v$ in Fig. 5.1, all these quantities must share the same units, rendering the loop gain $L$ dimensionless.\nWhen viewing the entire feedback system as a single-input single-output block, its input-output relationship is derived as:\n\n$$\n\\begin{gather*}\nx=u-L x \\Rightarrow x=\\frac{u}{1+L}  \\tag{5.4}\\\\\ny=A x=\\frac{A}{1+L} u=\\frac{A}{1+A \\beta} u \\tag{5.5}\n\\end{gather*}\n$$\n\nThe \"closed-loop\" gain, derived from (5.5), is\n\n$$\n\\begin{equation*}\nA_{C L} \\equiv \\frac{y}{u}=\\frac{A}{1+A \\beta}=\\frac{A}{1+L} \\tag{5.6}\n\\end{equation*}\n$$\n\nThis should not be confused with the loop gain defined in (5.3).\n```"
},
{
    "text": "The linear time-invariant negative feedback system depicted in Fig. 5.1 comprises an amplifier, $A$, and associated feedback circuitry with a gain of $\\beta$. Also identified in Fig. 5.1 are the input signal, $u$, the output signal, $y$, the feedback signal, $v$, and the difference signal,\n\n$$\n\\begin{equation*}\n\\mathrm{x}=\\mathrm{u}-\\mathrm{v} \\tag{5.1}\n\\end{equation*}\n$$\n\nIn physical terms, these signals can represent small-signal node voltages or branch currents. ${ }^{1}$\nimage_name:Fig. 5.1\ndescription:Fig. 5.1 illustrates an ideal model of a linear time-invariant negative feedback system, consisting of the following key components:\n\n1. **Amplifier (A):** This component amplifies the input signal. It receives the difference signal, \\( x \\), and generates an amplified output.\n\n2. **Feedback Circuitry (β):** This part of the system handles the feedback loop. It takes a fraction of the output signal, \\( y \\), and returns it as the feedback signal, \\( v \\), with a gain denoted as \\( \\beta \\).\n\n3. **Summing Junction:** This is where the input signal, \\( u \\), and the feedback signal, \\( v \\), are merged. The summing junction computes the difference, resulting in the difference signal, \\( x = u - v \\).\n\nThe information flow in the system is as follows:\n- The input signal, \\( u \\), enters and is combined with the feedback signal, \\( v \\), at the summing junction to form the difference signal, \\( x \\).\n- The difference signal, \\( x \\), is then amplified by the amplifier (A) to produce the output signal, \\( y \\).\n- Part of the output signal, \\( y \\), is fed back through the feedback circuitry (β) to create the feedback signal, \\( v \\).\n\nThe diagram includes labels \\( u \\), \\( x \\), \\( y \\), and \\( v \\) for the input, difference, output, and feedback signals, respectively. The system's loop gain is defined as \\( L = A \\beta \\).\n\nThe main function of this system is to ensure stability and control by adjusting the output based on feedback. The negative feedback loop aids in reducing errors and enhancing amplifier performance by comparing output to input and minimizing the difference.\n\n1. Identifying specific circuit variables corresponding to the signals in Fig. 5.1 can sometimes be challenging. Section 5.4 applies this model to several practical examples.\n\nClearly,\n\n$$\n\\begin{equation*}\nv=A \\beta x \\equiv L x \\tag{5.2}\n\\end{equation*}\n$$\n\nwhere we define the open-loop gain, or simply \"loop gain,\" as\n\n$$\n\\begin{equation*}\nL \\equiv A \\beta \\tag{5.3}\n\\end{equation*}\n$$\n\nSince $x=u-v$ in Fig. 5.1, all these signals must share the same units. Thus, the loop gain $L$ is always dimensionless.\nViewing the entire feedback system as a single-input single-output block, its input-output relationship is derived as follows:\n\n$$\n\\begin{gather*}\nx=u-L x \\Rightarrow x=\\frac{u}{1+L}  \\tag{5.4}\\\\\ny=A x=\\frac{A}{1+L} u=\\frac{A}{1+A \\beta} u \\tag{5.5}\n\\end{gather*}\n$$\n\nThe \"closed-loop\" gain, derived from (5.5), is\n\n$$\n\\begin{equation*}\nA_{C L} \\equiv \\frac{y}{u}=\\frac{A}{1+A \\beta}=\\frac{A}{1+L} \\tag{5.6}\n\\end{equation*}\n$$\n\nand should not be confused with the loop gain in (5.3)."
},
{
    "text": "The amplifier A's gain is influenced by the small-signal parameters of its constituent transistors, specifically their transconductances ($g_{m}$) and output resistances ($r_{d s}$). These parameters can vary significantly with temperature and between different circuit samples. However, the closed-loop gain, $\\mathrm{A}_{\\mathrm{CL}}$, remains largely unaffected by these variations as long as the loop-gain, L, is substantially greater than unity.\n\nTo illustrate this, consider a scenario where the amplifier gain changes from $A$ to $A+\\Delta A$ while keeping $\\beta$ constant. The resulting change in closed-loop gain is given by:\n\n$$\n\\begin{align*}\n\\Delta A_{C L} & =\\frac{A+\\Delta A}{1+(A+\\Delta A) \\beta}-\\frac{A}{1+A \\beta} \\\\\n& =\\frac{(A+\\Delta A)(1+A \\beta)-A[1+(A+\\Delta A) \\beta]}{[1+(A+\\Delta A) \\beta](1+A \\beta)}  \\tag{5.7}\\\\\n& =\\frac{\\Delta A}{(1+L)^{2}+\\Delta A \\beta}\n\\end{align*}\n$$\n\nThus, when $L » 1$, significant changes in the amplifier gain, $\\Delta A$, cause minimal changes in $A_{C L}$. Essentially, negative feedback ensures high accuracy in the overall amplifier gain, despite substantial variations in the transistor parameters.\n\n#### EXAMPLE 5.1\n\nConsider the negative feedback system depicted in Fig. 5.1, where both the amplifier inputs and outputs are voltages, making $A$ and $\\beta$ dimensionless. If the amplifier gain is 80 dB and $\\beta=0.2$, what is the resulting closed-loop gain, $A_{C L}$? If $A$ decreases by an order of magnitude, what is the resulting change in $A_{C L}$?\n\n#### Solution\n\nAn 80 dB gain corresponds to $\\mathrm{A}=10^{4}$. Using this in (5.6), the closed-loop gain is:\n\n$$\n\\mathrm{A}_{\\mathrm{CL}}=\\frac{10^{4}}{1+0.2 \\cdot 10^{4}}=4.9975\n$$\n\nIf the gain drops to 60 dB ($\\mathrm{~A}=10^{3}$), the closed-loop gain becomes:\n\n$$\n\\mathrm{A}_{\\mathrm{CL}}=\\frac{10^{3}}{1+0.2 \\cdot 10^{3}}=4.9751\n$$\n\nThis represents a change of less than $0.5 \\%$.\n\nKey Point: When L>>1, the closed-loop system's overall gain is inversely proportional to the feedback circuit's gain and is highly insensitive to the amplifier's gain, A.\n\nThe insensitivity of $A_{C L}$ to changes in $A$ is further highlighted by rewriting (5.6) with $\\mathrm{A}=\\mathrm{L} / \\beta$:\n\n$$\n\\begin{equation*}\nA_{C L}=\\frac{1}{\\beta} \\cdot \\frac{L}{(1+\\mathrm{L})} \\tag{5.8}\n\\end{equation*}\n$$\n\nThe closed-loop gain equals a constant, the \"desired gain\" $1 / \\beta$, multiplied by an error term near unity when $L$ » 1. For very large loop gains, the closed-loop gain approaches the desired gain:\n\n$$\n\\begin{equation*}\nA_{C L} \\cong \\frac{A}{L}=\\frac{1}{\\beta} \\tag{5.9}\n\\end{equation*}\n$$\n\nTherefore, achieving high accuracy in the closed-loop gain requires high accuracy in the feedback circuit's gain.\n\n#### EXAMPLE 5.2\n\nRepeat Example 5.1, but with $\\beta$ changing from 0.2 to 0.21 while A remains at 80 dB.\n\n#### Solution\n\nWith $\\beta=0.21$, the closed-loop gain is:\n\n$$\n\\mathrm{A}_{\\mathrm{CL}}=\\frac{10^{4}}{1+0.21 \\cdot 10^{4}}=4.7596\n$$\n\nThis is about $5 \\%$ lower than the result for $\\beta=0.2$ in Example 5.1, reflecting a change proportional to the variation in $\\beta$."
},
{
    "text": "The amplification of amplifier A is contingent on the small-signal characteristics of its constituent transistors, specifically their transconductances, $g_{m}$, and output resistances, $r_{d s}$. These parameters are prone to significant fluctuations due to temperature changes and variations between different circuit samples. Fortunately, the closed-loop gain, $\\mathrm{A}_{\\mathrm{CL}}$, remains largely unaffected by these variations as long as the loop-gain, L, is substantially greater than unity.\n\nTo illustrate this, examine the impact of a change in amplifier gain from $A$ to $A+\\Delta A$, while maintaining a constant $\\beta$. The resultant change in closed-loop gain is given by\n\n$$\n\\begin{align*}\n\\Delta A_{C L} & =\\frac{A+\\Delta A}{1+(A+\\Delta A) \\beta}-\\frac{A}{1+A \\beta} \\\\\n& =\\frac{(A+\\Delta A)(1+A \\beta)-A[1+(A+\\Delta A) \\beta]}{[1+(A+\\Delta A) \\beta](1+A \\beta)}  \\tag{5.7}\\\\\n& =\\frac{\\Delta A}{(1+L)^{2}+\\Delta A \\beta}\n\\end{align*}\n$$\n\nThus, when $L » 1$, substantial changes in the amplifier gain, $\\Delta A$, lead to minimal changes in $A_{C L}$. In essence, negative feedback ensures high precision in the overall amplifier gain, even amidst considerable variations in the transistor parameters that contribute to the gain.\n\n#### EXAMPLE 5.1\n\nConsider the negative feedback system depicted in Fig. 5.1, where the amplifier inputs and outputs are voltages, rendering both $A$ and $\\beta$ dimensionless. If the amplifier gain is 80 dB and $\\beta=0.2$, what is the resulting closed-loop gain, $A_{C L}$? If $A$ decreases by an order of magnitude, what is the resultant change in $A_{C L}$?\n\n#### Solution\n\nAn 80 dB gain corresponds to $\\mathrm{A}=10^{4}$. Substituting this into (5.6) yields a closed-loop gain of\n\n$$\n\\mathrm{A}_{\\mathrm{CL}}=\\frac{10^{4}}{1+0.2 \\cdot 10^{4}}=4.9975\n$$\n\nIf the gain decreases to 60 dB ($\\mathrm{~A}=10^{3}$), the closed-loop gain becomes\n\n$$\n\\mathrm{A}_{\\mathrm{CL}}=\\frac{10^{3}}{1+0.2 \\cdot 10^{3}}=4.9751\n$$\n\nThis represents a change of less than $0.5 \\%$.\n\nKey Point: When L>>1, the closed-loop system's overall gain is inversely proportional to the feedback circuit's gain and is highly insensitive to the amplifier's gain, A.\n\nThe resilience of $A_{C L}$ to changes in $A$ is further highlighted by rewriting (5.6) with $\\mathrm{A}=\\mathrm{L} / \\beta$.\n\n$$\n\\begin{equation*}\nA_{C L}=\\frac{1}{\\beta} \\cdot \\frac{L}{(1+\\mathrm{L})} \\tag{5.8}\n\\end{equation*}\n$$\n\nThe closed-loop gain equals a constant, the \"desired gain\" $1 / \\beta$, multiplied by an error term that approximates unity as long as $L$ » 1. In the case of extremely high loop gain, the closed-loop gain approaches the desired gain.\n\n$$\n\\begin{equation*}\nA_{C L} \\cong \\frac{A}{L}=\\frac{1}{\\beta} \\tag{5.9}\n\\end{equation*}\n$$\n\nTherefore, achieving high precision in the closed-loop gain necessitates high accuracy in the feedback circuit's gain.\n\n#### EXAMPLE 5.2\n\nRevisit Example 5.1, but now consider a change in $\\beta$ from 0.2 to 0.21 while keeping A constant at 80 dB.\n\n#### Solution\n\nWith $\\beta=0.21$, the closed-loop gain is\n\n$$\n\\mathrm{A}_{\\mathrm{CL}}=\\frac{10^{4}}{1+0.21 \\cdot 10^{4}}=4.7596\n$$\n\nThis is roughly $5 \\%$ lower than the result in Example 5.1 for $\\beta=0.2$, a change proportional to the variation in $\\beta$."
},
{
    "text": "The amplifier A's gain is influenced by the small-signal parameters of its constituent transistors, specifically their transconductances ($g_{m}$) and output resistances ($r_{d s}$). These parameters can vary significantly with temperature and between different circuit samples.幸运的是, as long as the loop-gain, L, is substantially greater than unity, the closed-loop gain, $\\mathrm{A}_{\\mathrm{CL}}$, remains largely unaffected by these variations.\n\nTo illustrate this, consider a scenario where the amplifier gain shifts from $A$ to $A+\\Delta A$, with $\\beta$ remaining constant. The corresponding change in closed-loop gain is given by:\n\n$$\n\\begin{align*}\n\\Delta A_{C L} & =\\frac{A+\\Delta A}{1+(A+\\Delta A) \\beta}-\\frac{A}{1+A \\beta} \\\\\n& =\\frac{(A+\\Delta A)(1+A \\beta)-A[1+(A+\\Delta A) \\beta]}{[1+(A+\\Delta A) \\beta](1+A \\beta)}  \\tag{5.7}\\\\\n& =\\frac{\\Delta A}{(1+L)^{2}+\\Delta A \\beta}\n\\end{align*}\n$$\n\nThus, when $L » 1$, significant changes in the amplifier gain, $\\Delta A$, lead to minimal changes in $A_{C L}$. In essence, negative feedback ensures high gain accuracy for the overall amplifier, even amidst substantial variations in the transistor parameters.\n\n#### EXAMPLE 5.1\n\nExamine the negative feedback system depicted in Fig. 5.1, where both the amplifier inputs and outputs are voltages, rendering $A$ and $\\beta$ dimensionless. If the amplifier gain is 80 dB and $\\beta=0.2$, what is the resulting closed-loop gain, $A_{C L}$? If $A$ decreases by an order of magnitude, what is the impact on $A_{C L}$?\n\n#### Solution\n\nAn 80 dB gain equates to $\\mathrm{A}=10^{4}$. Using this in (5.6), the closed-loop gain is:\n\n$$\n\\mathrm{A}_{\\mathrm{CL}}=\\frac{10^{4}}{1+0.2 \\cdot 10^{4}}=4.9975\n$$\n\nIf the gain drops to 60 dB ($\\mathrm{~A}=10^{3}$), the closed-loop gain becomes:\n\n$$\n\\mathrm{A}_{\\mathrm{CL}}=\\frac{10^{3}}{1+0.2 \\cdot 10^{3}}=4.9751\n$$\n\nThis reflects a change of less than $0.5 \\%$.\n\nKey Point: When L>>1, the closed-loop system's overall gain is inversely proportional to the feedback circuit's gain and is highly insensitive to the amplifier's gain, A.\n\nThe resilience of $A_{C L}$ to changes in $A$ is further highlighted by rewriting (5.6) with $\\mathrm{A}=\\mathrm{L} / \\beta$:\n\n$$\n\\begin{equation*}\nA_{C L}=\\frac{1}{\\beta} \\cdot \\frac{L}{(1+\\mathrm{L})} \\tag{5.8}\n\\end{equation*}\n$$\n\nThe closed-loop gain equals a constant, the \"desired gain\" $1 / \\beta$, multiplied by an error term that approaches unity as long as $L$ » 1. In the limit of very high loop gain, the closed-loop gain approximates the desired gain:\n\n$$\n\\begin{equation*}\nA_{C L} \\cong \\frac{A}{L}=\\frac{1}{\\beta} \\tag{5.9}\n\\end{equation*}\n$$\n\nTherefore, achieving high accuracy in the closed-loop gain necessitates high accuracy in the feedback circuit's gain.\n\n#### EXAMPLE 5.2\n\nRevisit Example 5.1, but now consider a change in $\\beta$ from 0.2 to 0.21 while A remains at 80 dB.\n\n#### Solution\n\nWith $\\beta=0.21$, the closed-loop gain is:\n\n$$\n\\mathrm{A}_{\\mathrm{CL}}=\\frac{10^{4}}{1+0.21 \\cdot 10^{4}}=4.7596\n$$\n\nThis is about $5 \\%$ lower than the result for $\\beta=0.2$ in Example 5.1, a change proportionate to the variation in $\\beta$."
},
{
    "text": "The amplifier A's gain is influenced by the small-signal characteristics of its constituent transistors, specifically their transconductances ($g_{m}$) and output resistances ($r_{d s}$). These parameters can vary significantly with temperature and between different circuit samples. However, the closed-loop gain, $\\mathrm{A}_{\\mathrm{CL}}$, remains largely unaffected by these variations as long as the loop-gain, L, is substantially greater than unity.\n\nTo illustrate this, examine the impact of a change in amplifier gain from $A$ to $A+\\Delta A$, while keeping $\\beta$ constant. The resulting change in closed-loop gain is calculated as follows:\n\n$$\n\\begin{align*}\n\\Delta A_{C L} & =\\frac{A+\\Delta A}{1+(A+\\Delta A) \\beta}-\\frac{A}{1+A \\beta} \\\\\n& =\\frac{(A+\\Delta A)(1+A \\beta)-A[1+(A+\\Delta A) \\beta]}{[1+(A+\\Delta A) \\beta](1+A \\beta)}  \\tag{5.7}\\\\\n& =\\frac{\\Delta A}{(1+L)^{2}+\\Delta A \\beta}\n\\end{align*}\n$$\n\nThus, if $L » 1$, significant changes in the amplifier gain, $\\Delta A$, cause minimal changes in $A_{C L}$. Essentially, negative feedback ensures high gain accuracy in the overall amplifier, even with substantial variations in the transistor parameters.\n\n#### EXAMPLE 5.1\n\nConsider the negative feedback system depicted in Fig. 5.1, where both the amplifier inputs and outputs are voltages, making $A$ and $\\beta$ dimensionless. If the amplifier gain is 80 dB and $\\beta=0.2$, what is the resulting closed-loop gain, $A_{C L}$? If $A$ decreases by an order of magnitude, what is the resulting change in $A_{C L}$?\n\n#### Solution\n\nAn 80 dB gain corresponds to $\\mathrm{A}=10^{4}$. Using this in (5.6) yields a closed-loop gain of\n\n$$\n\\mathrm{A}_{\\mathrm{CL}}=\\frac{10^{4}}{1+0.2 \\cdot 10^{4}}=4.9975\n$$\n\nIf the gain drops to 60 dB ($\\mathrm{~A}=10^{3}$), the closed-loop gain becomes\n\n$$\n\\mathrm{A}_{\\mathrm{CL}}=\\frac{10^{3}}{1+0.2 \\cdot 10^{3}}=4.9751\n$$\n\nThis indicates a change of less than $0.5 \\%$.\n\nKey Point: When L>>1, the closed-loop system's overall gain is inversely proportional to the feedback circuit's gain and is highly insensitive to the amplifier's gain, A.\n\nThe resilience of $A_{C L}$ to changes in $A$ is further highlighted by rewriting (5.6) with $\\mathrm{A}=\\mathrm{L} / \\beta$:\n\n$$\n\\begin{equation*}\nA_{C L}=\\frac{1}{\\beta} \\cdot \\frac{L}{(1+\\mathrm{L})} \\tag{5.8}\n\\end{equation*}\n$$\n\nThe closed-loop gain equals a constant, the \"desired gain\" $1 / \\beta$, multiplied by an error term near unity, provided $L$ » 1. With very high loop gain, the closed-loop gain approximates the desired gain:\n\n$$\n\\begin{equation*}\nA_{C L} \\cong \\frac{A}{L}=\\frac{1}{\\beta} \\tag{5.9}\n\\end{equation*}\n$$\n\nThus, achieving high accuracy in the closed-loop gain necessitates high accuracy in the feedback circuit's gain.\n\n#### EXAMPLE 5.2\n\nRepeat Example 5.1, but now consider a change in $\\beta$ from 0.2 to 0.21, with A remaining constant at 80 dB.\n\n#### Solution\n\nWith $\\beta=0.21$, the closed-loop gain is\n\n$$\n\\mathrm{A}_{\\mathrm{CL}}=\\frac{10^{4}}{1+0.21 \\cdot 10^{4}}=4.7596\n$$\n\nThis is about $5 \\%$ lower than the result for $\\beta=0.2$ in Example 5.1, reflecting a change proportional to the variation in $\\beta$."
},
{
    "text": "The amplifier A's gain is influenced by the small-signal parameters of its constituent transistors, specifically their transconductances ($g_{m}$) and output resistances ($r_{d s}$). These parameters can vary significantly with temperature and between different circuit samples. Fortunately, the closed-loop gain, $\\mathrm{A}_{\\mathrm{CL}}$, remains largely unaffected by these variations as long as the loop-gain, L, is substantially greater than unity.\n\nTo illustrate this, consider the impact of a change in the amplifier gain from $A$ to $A+\\Delta A$, while keeping $\\beta$ constant. The resulting change in closed-loop gain is given by:\n\n$$\n\\begin{align*}\n\\Delta A_{C L} & =\\frac{A+\\Delta A}{1+(A+\\Delta A) \\beta}-\\frac{A}{1+A \\beta} \\\\\n& =\\frac{(A+\\Delta A)(1+A \\beta)-A[1+(A+\\Delta A) \\beta]}{[1+(A+\\Delta A) \\beta](1+A \\beta)}  \\tag{5.7}\\\\\n& =\\frac{\\Delta A}{(1+L)^{2}+\\Delta A \\beta}\n\\end{align*}\n$$\n\nThus, when $L » 1$, significant changes in the amplifier gain, $\\Delta A$, cause minimal changes in $A_{C L}$. In essence, negative feedback ensures high accuracy in the overall amplifier gain, despite substantial variations in the transistor parameters.\n\n#### EXAMPLE 5.1\n\nConsider the negative feedback system depicted in Fig. 5.1, where both the amplifier inputs and outputs are voltages, making $A$ and $\\beta$ dimensionless. If the amplifier gain is 80 dB and $\\beta=0.2$, what is the resulting closed-loop gain, $A_{C L}$? If $A$ decreases by an order of magnitude, what is the resulting change in $A_{C L}$?\n\n#### Solution\n\nAn 80 dB gain corresponds to $\\mathrm{A}=10^{4}$. Using this in (5.6), the closed-loop gain is:\n\n$$\n\\mathrm{A}_{\\mathrm{CL}}=\\frac{10^{4}}{1+0.2 \\cdot 10^{4}}=4.9975\n$$\n\nIf the gain drops to 60 dB ($\\mathrm{~A}=10^{3}$), the closed-loop gain becomes:\n\n$$\n\\mathrm{A}_{\\mathrm{CL}}=\\frac{10^{3}}{1+0.2 \\cdot 10^{3}}=4.9751\n$$\n\nThis represents a change of less than $0.5 \\%$.\n\nKey Point: When L>>1, the closed-loop system's overall gain is inversely proportional to the feedback circuit's gain and is highly insensitive to the amplifier's gain, A.\n\nThe insensitivity of $A_{C L}$ to changes in $A$ is further highlighted by rewriting (5.6) with $\\mathrm{A}=\\mathrm{L} / \\beta$:\n\n$$\n\\begin{equation*}\nA_{C L}=\\frac{1}{\\beta} \\cdot \\frac{L}{(1+\\mathrm{L})} \\tag{5.8}\n\\end{equation*}\n$$\n\nThe closed-loop gain equals a constant, the \"desired gain\" $1 / \\beta$, multiplied by an error term near unity, provided $L$ » 1. For very large loop gains, the closed-loop gain approaches the desired gain:\n\n$$\n\\begin{equation*}\nA_{C L} \\cong \\frac{A}{L}=\\frac{1}{\\beta} \\tag{5.9}\n\\end{equation*}\n$$\n\nThus, achieving high accuracy in the closed-loop gain necessitates high accuracy in the feedback circuit's gain.\n\n#### EXAMPLE 5.2\n\nRepeat Example 5.1, but with $\\beta$ changing from 0.2 to 0.21 while A remains at 80 dB.\n\n#### Solution\n\nWith $\\beta=0.21$, the closed-loop gain is:\n\n$$\n\\mathrm{A}_{\\mathrm{CL}}=\\frac{10^{4}}{1+0.21 \\cdot 10^{4}}=4.7596\n$$\n\nThis is about $5 \\%$ lower than the result for $\\beta=0.2$, matching the percentage change in $\\beta$."
},
{
    "text": "The amplifier A's gain is influenced by the small-signal parameters of its constituent transistors, specifically their transconductances ($g_{m}$) and output resistances ($r_{d s}$). These parameters can vary significantly with temperature and between different circuit samples. Fortunately, the closed-loop gain, $\\mathrm{A}_{\\mathrm{CL}}$, remains largely unaffected by these variations as long as the loop-gain, L, is substantially greater than unity.\n\nTo illustrate this, consider the impact of a change in the amplifier gain from $A$ to $A+\\Delta A$, while keeping $\\beta$ constant. The resulting change in closed-loop gain is calculated as follows:\n\n$$\n\\begin{align*}\n\\Delta A_{C L} & =\\frac{A+\\Delta A}{1+(A+\\Delta A) \\beta}-\\frac{A}{1+A \\beta} \\\\\n& =\\frac{(A+\\Delta A)(1+A \\beta)-A[1+(A+\\Delta A) \\beta]}{[1+(A+\\Delta A) \\beta](1+A \\beta)}  \\tag{5.7}\\\\\n& =\\frac{\\Delta A}{(1+L)^{2}+\\Delta A \\beta}\n\\end{align*}\n$$\n\nThus, if $L » 1$, significant changes in the amplifier gain, $\\Delta A$, cause minimal changes in $A_{C L}$. In essence, negative feedback ensures high accuracy in the overall amplifier gain, despite substantial variations in the transistor parameters.\n\n#### EXAMPLE 5.1\n\nExamine the negative feedback system depicted in Fig. 5.1, where both the amplifier inputs and outputs are voltages, making $A$ and $\\beta$ dimensionless. Given an amplifier gain of 80 dB and $\\beta=0.2$, determine the closed-loop gain, $A_{C L}$. Also, find the change in $A_{C L}$ if $A$ decreases by an order of magnitude.\n\n#### Solution\n\nAn 80 dB gain equates to $\\mathrm{A}=10^{4}$. Using this in (5.6), the closed-loop gain is:\n\n$$\n\\mathrm{A}_{\\mathrm{CL}}=\\frac{10^{4}}{1+0.2 \\cdot 10^{4}}=4.9975\n$$\n\nIf the gain drops to 60 dB ($\\mathrm{~A}=10^{3}$), the closed-loop gain becomes:\n\n$$\n\\mathrm{A}_{\\mathrm{CL}}=\\frac{10^{3}}{1+0.2 \\cdot 10^{3}}=4.9751\n$$\n\nThis represents a change of less than $0.5 \\%$.\n\nKey Point: When L>>1, the closed-loop system's overall gain is inversely proportional to the feedback circuit's gain and is highly insensitive to the amplifier's gain, A.\n\nThe stability of $A_{C L}$ against changes in $A$ is further highlighted by rewriting (5.6) with $\\mathrm{A}=\\mathrm{L} / \\beta$:\n\n$$\n\\begin{equation*}\nA_{C L}=\\frac{1}{\\beta} \\cdot \\frac{L}{(1+\\mathrm{L})} \\tag{5.8}\n\\end{equation*}\n$$\n\nThe closed-loop gain equals a constant, the \"desired gain\" $1 / \\beta$, multiplied by an error term near unity, provided L is much greater than 1. As L approaches infinity, the closed-loop gain approximates the desired gain:\n\n$$\n\\begin{equation*}\nA_{C L} \\cong \\frac{A}{L}=\\frac{1}{\\beta} \\tag{5.9}\n\\end{equation*}\n$$\n\nTherefore, achieving high accuracy in the closed-loop gain necessitates high accuracy in the feedback circuit's gain.\n\n#### EXAMPLE 5.2\n\nRevisit Example 5.1, but now with a change in $\\beta$ from 0.2 to 0.21, while A remains at 80 dB.\n\n#### Solution\n\nWith $\\beta=0.21$, the closed-loop gain is:\n\n$$\n\\mathrm{A}_{\\mathrm{CL}}=\\frac{10^{4}}{1+0.21 \\cdot 10^{4}}=4.7596\n$$\n\nThis is about $5 \\%$ lower than the result for $\\beta=0.2$ in Example 5.1, reflecting a change proportional to the variation in $\\beta$."
},
{
    "text": "The amplification of amplifier A is contingent on the small-signal characteristics of its constituent transistors (namely, their transconductances, $g_{m}$, and output resistances, $r_{d s}$). These parameters are prone to significant fluctuations due to temperature changes and variations between different circuit samples.幸运的是，只要环路增益 L 远大于1，闭环增益 $\\mathrm{A}_{\\mathrm{CL}}$ 就基本上不受这些变化的影响。\n\n为了量化这一点，假设放大器增益从 $A$ 变化为 $A+\\Delta A$，同时保持 $\\beta$ 的值不变。闭环增益的变化为\n\n$$\n\\begin{align*}\n\\Delta A_{C L} & =\\frac{A+\\Delta A}{1+(A+\\Delta A) \\beta}-\\frac{A}{1+A \\beta} \\\\\n& =\\frac{(A+\\Delta A)(1+A \\beta)-A[1+(A+\\Delta A) \\beta]}{[1+(A+\\Delta A) \\beta](1+A \\beta)}  \\tag{5.7}\\\\\n& =\\frac{\\Delta A}{(1+L)^{2}+\\Delta A \\beta}\n\\end{align*}\n$$\n\n因此，如果 $L » 1$，放大器增益 $\\Delta A$ 的巨大变化只会引起 $A_{C L}$ 的微小变化。换句话说，负反馈使得整体放大器的增益具有高精度，即使构成增益的晶体管参数存在大幅波动。\n\n#### 示例 5.1\n\n考虑图 5.1 中所示的负反馈系统，其中放大器的输入和输出均为电压，因此 $A$ 和 $\\beta$ 均为无量纲。如果放大器增益为 80 dB 且 $\\beta=0.2$，求闭环增益 $A_{C L}$？如果 $A$ 降低一个数量级，$A_{C L}$ 的变化是多少？\n\n#### 解答\n\n80 dB 的增益对应于 $\\mathrm{A}=10^{4}$。将此值代入 (5.6) 式，得到闭环增益为\n\n$$\n\\mathrm{A}_{\\mathrm{CL}}=\\frac{10^{4}}{1+0.2 \\cdot 10^{4}}=4.9975\n$$\n\n如果增益降低一个数量级至 60 dB（即 $\\mathrm{A}=10^{3}$），闭环增益变为\n\n$$\n\\mathrm{A}_{\\mathrm{CL}}=\\frac{10^{3}}{1+0.2 \\cdot 10^{3}}=4.9751\n$$\n\n这表示变化不到 $0.5 \\%$。\n\n关键点：当 L>>1 时，闭环系统的整体增益与反馈电路的增益成反比，且对放大器增益 A 的变化高度不敏感。\n\n如果将 (5.6) 式中的 $\\mathrm{A}$ 替换为 $\\mathrm{L} / \\beta$，$A_{C L}$ 对 A 变化的不敏感性也显而易见。\n\n$$\n\\begin{equation*}\nA_{C L}=\\frac{1}{\\beta} \\cdot \\frac{L}{(1+\\mathrm{L})} \\tag{5.8}\n\\end{equation*}\n$$\n\n闭环增益等于一个常数（“期望增益” $1 / \\beta$）乘以一个误差项，只要 L » 1，该误差项接近于 1。在环路增益非常大的极限情况下，闭环增益趋近于期望增益。\n\n$$\n\\begin{equation*}\nA_{C L} \\cong \\frac{A}{L}=\\frac{1}{\\beta} \\tag{5.9}\n\\end{equation*}\n$$\n\n因此，要获得高精度的闭环增益，必须确保反馈电路增益的高精度。\n\n#### 示例 5.2\n\n重复示例 5.1，但这次考虑 $\\beta$ 从 0.2 变为 0.21，而 A 保持 80 dB 不变。\n\n#### 解答\n\n当 $\\beta=0.21$ 时，闭环增益变为\n\n$$\n\\mathrm{A}_{\\mathrm{CL}}=\\frac{10^{4}}{1+0.21 \\cdot 10^{4}}=4.7596\n$$\n\n这与示例 5.1 中 $\\beta=0.2$ 的结果相比大约降低了 $5 \\%$，这一变化百分比与 $\\beta$ 的变化相一致。"
},
{
    "text": "The amplifier A's gain is influenced by the small-signal parameters of its constituent transistors, specifically their transconductances ($g_{m}$) and output resistances ($r_{d s}$). These parameters can vary significantly with temperature and between different circuit samples. However, the closed-loop gain, $\\mathrm{A}_{\\mathrm{CL}}$, remains largely unaffected by these variations as long as the loop-gain, L, is substantially greater than unity.\n\nTo illustrate this, consider a scenario where the amplifier gain changes from $A$ to $A+\\Delta A$, while $\\beta$ remains constant. The resulting change in closed-loop gain is given by:\n\n$$\n\\begin{align*}\n\\Delta A_{C L} & =\\frac{A+\\Delta A}{1+(A+\\Delta A) \\beta}-\\frac{A}{1+A \\beta} \\\\\n& =\\frac{(A+\\Delta A)(1+A \\beta)-A[1+(A+\\Delta A) \\beta]}{[1+(A+\\Delta A) \\beta](1+A \\beta)}  \\tag{5.7}\\\\\n& =\\frac{\\Delta A}{(1+L)^{2}+\\Delta A \\beta}\n\\end{align*}\n$$\n\nThus, when $L » 1$, substantial changes in the amplifier gain, $\\Delta A$, cause minimal changes in $A_{C L}$. Essentially, negative feedback ensures high gain accuracy for the overall amplifier, even amidst significant variations in the transistor parameters.\n\n#### EXAMPLE 5.1\n\nConsider the negative feedback system depicted in Fig. 5.1, where both $A$ and $\\beta$ are dimensionless as they represent voltage inputs and outputs. If the amplifier gain is 80 dB and $\\beta=0.2$, what is the resulting closed-loop gain, $A_{C L}$? If $A$ decreases by an order of magnitude, what is the impact on $A_{C L}$?\n\n#### Solution\n\nAn 80 dB gain equates to $\\mathrm{A}=10^{4}$. Using this in (5.6) yields a closed-loop gain of:\n\n$$\n\\mathrm{A}_{\\mathrm{CL}}=\\frac{10^{4}}{1+0.2 \\cdot 10^{4}}=4.9975\n$$\n\nIf the gain drops to 60 dB ($\\mathrm{A}=10^{3}$), the closed-loop gain becomes:\n\n$$\n\\mathrm{A}_{\\mathrm{CL}}=\\frac{10^{3}}{1+0.2 \\cdot 10^{3}}=4.9751\n$$\n\nThis reflects a change of less than $0.5 \\%$.\n\nKey Point: When L>>1, the closed-loop gain is inversely proportional to the feedback circuit's gain and is highly insensitive to the amplifier's gain, A.\n\nThe stability of $A_{C L}$ against changes in $A$ is further highlighted by rewriting (5.6) with $\\mathrm{A}=\\mathrm{L} / \\beta$:\n\n$$\n\\begin{equation*}\nA_{C L}=\\frac{1}{\\beta} \\cdot \\frac{L}{(1+\\mathrm{L})} \\tag{5.8}\n\\end{equation*}\n$$\n\nThe closed-loop gain equals a constant, the \"desired gain\" $1 / \\beta$, multiplied by an error term nearing unity as long as $L$ » 1. With very high loop gain, the closed-loop gain approximates the desired gain:\n\n$$\n\\begin{equation*}\nA_{C L} \\cong \\frac{A}{L}=\\frac{1}{\\beta} \\tag{5.9}\n\\end{equation*}\n$$\n\nThus, achieving high accuracy in closed-loop gain necessitates high accuracy in the feedback circuit's gain.\n\n#### EXAMPLE 5.2\n\nRepeat Example 5.1, but now consider a change in $\\beta$ from 0.2 to 0.21 while A remains at 80 dB.\n\n#### Solution\n\nWith $\\beta=0.21$, the closed-loop gain is:\n\n$$\n\\mathrm{A}_{\\mathrm{CL}}=\\frac{10^{4}}{1+0.21 \\cdot 10^{4}}=4.7596\n$$\n\nThis is roughly $5 \\%$ lower than the result for $\\beta=0.2$, aligning with the percentage change in $\\beta$."
},
{
    "text": "The gain of the amplifier, A, varies with frequency, typically diminishing at higher frequencies, as illustrated in Fig. 5.2. Nonetheless, if the loop gain stays significantly above unity (i.e., $A(\\omega)$ » $1 / \\beta$), the closed-loop gain will stay roughly $\\quad \\mathrm{A}_{\\mathrm{CL}} \\cong 1 / \\beta$. At extremely high frequencies, $A(\\omega) \\ll(1 / \\beta) \\Rightarrow L$ « 1, and equation (5.6) reduces to $A_{C L} \\cong A(\\omega)$. Thus, a crude approximation of the closed-loop amplifier's bandwidth is indicated by the shift between these regions; specifically, the frequency where $|A(\\omega)|=(1 / \\beta)$, or\n\nKey Point: An approximate bandwidth for a feedback amplifier is determined by the frequency at which $|L(\\omega)|=1$, which is substantially higher than the bandwidth of $\\mathrm{A}(\\omega)$.\nequivalently where $|L(\\omega)|=1$. Fig. 5.2 clearly shows that this closed-loop bandwidth is generally much greater than the bandwidth of $A(\\omega)$.\n\nThe diagram in Fig. 6.2 is based on the premise that $\\beta$ remains unchanged across the entire frequency spectrum being examined. Therefore, to achieve a closed-loop amplifier with a high bandwidth, it is essential for the feedback network to possess high bandwidth, but this is not required for the amplifier, A."
},
{
    "text": "The gain of the amplifier, A, varies with frequency, typically diminishing at higher frequencies, as illustrated in Fig. 5.2. Nevertheless, as long as the loop gain significantly exceeds unity (i.e., $A(\\omega)$ » $1 / \\beta$), the closed-loop gain will stay roughly $\\quad \\mathrm{A}_{\\mathrm{CL}} \\cong 1 / \\beta$. At extremely high frequencies, $A(\\omega) \\ll(1 / \\beta) \\Rightarrow L$ « 1, and equation (5.6) reduces to $A_{C L} \\cong A(\\omega)$. Thus, a crude approximation of the closed-loop amplifier's bandwidth is identified by the transition between these regions; specifically, the frequency where $|A(\\omega)|=(1 / \\beta)$, or\n\nKey Point: An approximate bandwidth for a feedback amplifier is determined by the frequency at which $|L(\\omega)|=1$, which is substantially higher than the bandwidth of $\\mathrm{A}(\\omega)$.\nequivalently where $|L(\\omega)|=1$. Fig. 5.2 clearly indicates that this closed-loop bandwidth is generally much greater than the bandwidth of $A(\\omega)$.\n\nThe diagram in Fig. 6.2 is based on the premise that $\\beta$ remains unchanged across the entire frequency range being examined. Therefore, to achieve a closed-loop amplifier with a high bandwidth, it is essential for the feedback network to possess high bandwidth, but this is not a requirement for the amplifier, A."
},
{
    "text": "The amplifier gain A varies with frequency, typically diminishing at higher frequencies, as illustrated in Fig. 5.2. Nonetheless, if the loop gain stays significantly above unity (i.e., $A(\\omega)$ » $1 / \\beta$), the closed-loop gain will stay roughly $\\quad \\mathrm{A}_{\\mathrm{CL}} \\cong 1 / \\beta$. At extremely high frequencies, $A(\\omega) \\ll(1 / \\beta) \\Rightarrow L$ « 1, leading to (5.6) simplifying to $A_{C L} \\cong A(\\omega)$. Thus, a crude approximation of the closed-loop amplifier's bandwidth is the frequency at which $|A(\\omega)|=(1 / \\beta)$, or\n\nKey Point: An approximate bandwidth of a feedback amplifier is determined by the frequency where $|L(\\omega)|=1$, which exceeds the bandwidth of $\\mathrm{A}(\\omega)$ significantly.\nequivalently where $|L(\\omega)|=1$. Fig. 5.2 clearly shows that this closed-loop bandwidth is generally much greater than the bandwidth of $A(\\omega)$.\n\nThe diagram in Fig. 6.2 is based on the premise that $\\beta$ remains constant across the entire frequency range being examined. Therefore, to achieve a closed-loop amplifier with a high bandwidth, it is essential for the feedback network to possess high bandwidth, but not necessarily the amplifier, A."
},
{
    "text": "The amplifier gain A varies with frequency, typically diminishing at higher frequencies, as illustrated in Fig. 5.2. Nonetheless, if the loop gain stays significantly above unity (i.e., $A(\\omega)$ » $1 / \\beta$), the closed-loop gain will be roughly $\\quad \\mathrm{A}_{\\mathrm{CL}} \\cong 1 / \\beta$. At extremely high frequencies, when $A(\\omega) \\ll(1 / \\beta) \\Rightarrow L$ « 1, equation (5.6) reduces to $A_{C L} \\cong A(\\omega)$. Consequently, a crude approximation of the closed-loop amplifier's bandwidth is identified by the shift between these regions; specifically, the frequency at which $|A(\\omega)|=(1 / \\beta)$, or\n\nKey Point: An approximate bandwidth for a feedback amplifier is determined by the frequency where $|L(\\omega)|=1$, which exceeds the bandwidth of $\\mathrm{A}(\\omega)$.\nalternatively where $|L(\\omega)|=1$. Fig. 5.2 clearly shows that this closed-loop bandwidth is usually much broader than the bandwidth of $A(\\omega)$.\n\nThe diagram in Fig. 6.2 is based on the premise that $\\beta$ remains stable across the entire frequency range being examined. Therefore, to achieve a closed-loop amplifier with a high bandwidth, it is essential for the feedback network to possess high bandwidth, but this is not a requirement for the amplifier, A."
},
{
    "text": "The gain of the amplifier, A, varies with frequency, typically diminishing at higher frequencies, as illustrated in Fig. 5.2. Nevertheless, as long as the loop gain significantly exceeds unity (i.e., $A(\\omega)$ » $1 / \\beta$), the closed-loop gain will stay roughly $\\quad \\mathrm{A}_{\\mathrm{CL}} \\cong 1 / \\beta$. At extremely high frequencies, when $A(\\omega) \\ll (1 / \\beta) \\Rightarrow L$ « 1, equation (5.6) reduces to $A_{C L} \\cong A(\\omega)$. Consequently, a crude approximation of the closed-loop amplifier's bandwidth is indicated by the shift between these regions; specifically, the frequency at which $|A(\\omega)| = (1 / \\beta)$, or\n\nKey Point: An approximate bandwidth for a feedback amplifier is determined by the frequency where $|L(\\omega)| = 1$, which is notably higher than the bandwidth of $\\mathrm{A}(\\omega)$.\nequivalently where $|L(\\omega)| = 1$. Fig. 5.2 clearly shows that this closed-loop bandwidth is generally much greater than the bandwidth of $A(\\omega)$.\n\nThe diagram in Fig. 6.2 is based on the premise that $\\beta$ remains stable across the entire frequency spectrum being examined. Therefore, to achieve a closed-loop amplifier with a high bandwidth, it is essential for the feedback network to possess a high bandwidth, but this is not a requirement for the amplifier, A."
},
{
    "text": "The amplifier gain A varies with frequency, typically diminishing at higher frequencies, as illustrated in Fig. 5.2. Nonetheless, if the loop gain stays significantly above unity (i.e., $A(\\omega)$ » $1 / \\beta$), the closed-loop gain will stay roughly $\\quad \\mathrm{A}_{\\mathrm{CL}} \\cong 1 / \\beta$. At extremely high frequencies, $A(\\omega) \\ll(1 / \\beta) \\Rightarrow L$ « 1, and equation (5.6) reduces to $A_{C L} \\cong A(\\omega)$. Thus, a crude approximation of the closed-loop amplifier's bandwidth is indicated by the shift between these regions; specifically, the frequency where $|A(\\omega)|=(1 / \\beta)$, or\n\nKey Point: An approximate bandwidth for a feedback amplifier is identified by the frequency at which $|L(\\omega)|=1$, a value notably higher than the bandwidth of $\\mathrm{A}(\\omega)$.\nequivalently where $|L(\\omega)|=1$. Fig. 5.2 clearly shows that this closed-loop bandwidth is generally much greater than the bandwidth of $A(\\omega)$.\n\nThe diagram in Fig. 6.2 is based on the premise that $\\beta$ remains stable across the entire frequency range being examined. Therefore, to achieve a closed-loop amplifier with a high bandwidth, it is essential for the feedback network to possess high bandwidth, but not necessarily the amplifier, A."
},
{
    "text": "The gain of the amplifier, denoted as A, varies with frequency, typically diminishing at higher frequencies, as illustrated in Fig. 5.2. Nonetheless, if the loop gain stays significantly above unity (i.e., $A(\\omega)$ » $1 / \\beta$), the closed-loop gain will stay roughly $\\mathrm{A}_{\\mathrm{CL}} \\cong 1 / \\beta$. At extremely high frequencies, when $A(\\omega) \\ll (1 / \\beta)$, leading to $L$ « 1, equation (5.6) simplifies to $A_{C L} \\cong A(\\omega)$. Consequently, a crude approximation of the closed-loop amplifier's bandwidth can be determined by the transition between these regions; specifically, the frequency at which $|A(\\omega)| = (1 / \\beta)$, or\n\nKey Point: An approximate bandwidth for a feedback amplifier is indicated by the frequency where $|L(\\omega)|=1$, which is notably higher than the bandwidth of $\\mathrm{A}(\\omega)$.\nequivalently where $|L(\\omega)|=1$. Fig. 5.2 clearly shows that this closed-loop bandwidth is generally much greater than the bandwidth of $A(\\omega)$.\n\nThe diagram in Fig. 6.2 is based on the premise that $\\beta$ remains constant across the entire frequency range being considered. Therefore, to achieve a closed-loop amplifier with a high bandwidth, it is essential for the feedback network to possess high bandwidth, but not necessarily the amplifier, A."
},
{
    "text": "The amplifier gain A varies with frequency, typically diminishing at higher frequencies, as illustrated in Fig. 5.2. Nonetheless, as long as the loop gain stays significantly above unity (i.e., $A(\\omega)$ » $1 / \\beta$), the closed-loop gain will remain roughly $\\quad \\mathrm{A}_{\\mathrm{CL}} \\cong 1 / \\beta$. At extremely high frequencies, eventually $A(\\omega) \\ll (1 / \\beta) \\Rightarrow L$ « 1, and equation (5.6) simplifies to $A_{C L} \\cong A(\\omega)$. Thus, a crude approximation of the closed-loop amplifier's bandwidth is derived from the transition between these regions; specifically, the frequency at which $|A(\\omega)|=(1 / \\beta)$, or\n\nKey Point: An approximate bandwidth for a feedback amplifier is determined by the frequency where $|L(\\omega)|=1$, which is substantially higher than the bandwidth of $\\mathrm{A}(\\omega)$.\nequivalently where $|L(\\omega)|=1$. Fig. 5.2 clearly shows that this closed-loop bandwidth is generally much greater than the bandwidth of $A(\\omega)$.\n\nThe diagram in Fig. 6.2 is based on the premise that $\\beta$ remains constant across the entire frequency range being considered. Therefore, to achieve a closed-loop amplifier with a high bandwidth, it is essential for the feedback network to possess high bandwidth, but this is not a requirement for the amplifier, A."
},
{
    "text": "The model depicted in Fig. 5.1 is entirely linear and, as such, remains valid only when the transistors within the amplifier, A, encounter small voltage and current signals. Fortunately, by implementing negative feedback with substantial loop gain, the signal present at the amplifier's input, $x$, becomes a significantly attenuated version of the overall system's input, $u$. When $\\mathrm{L} » 1$, equation (5.4) transforms into\n\n$$\n\\begin{equation*}\nx \\cong \\frac{u}{L} \\tag{5.10}\n\\end{equation*}\n$$\n\nThis implies that even with large signals at $u$, the amplifier $A$ only experiences very minor voltage and current signals at its input, enabling it to function linearly. Conversely, the feedback circuit must maintain linearity even when subjected to large signals. Its input is the amplifier's output, $y$, which is $A$ times larger than $x$.\n\nKey Point: With feedback, the amplifier encounters signals that are roughly $L$ times smaller than they would be without feedback, significantly enhancing its linearity.\n\n---\n\nThe graph in Figure 5.2 presents a Bode plot illustrating the bandwidth of a closed-loop amplifier. The x-axis is designated with the symbol \\( \\omega \\), indicating angular frequency, while the y-axis measures gain. The gain is plotted on a logarithmic scale, marked by significant points denoting key gain levels.\n\nThe graph features two primary curves: \\( A(\\omega) \\) and \\( A_{CL}(\\omega) \\). \\( A(\\omega) \\) signifies the open-loop gain, which begins at a high level and diminishes as frequency rises. It exhibits a negative slope, reflecting a decrease in gain with increasing frequency.\n\n\\( A_{CL}(\\omega) \\), representing the closed-loop gain, appears as a horizontal line at the level \\( 1/\\beta \\). This demonstrates that the closed-loop gain remains consistent across a broad spectrum of frequencies, highlighting the impact of feedback in stabilizing the gain.\n\nNotable aspects of the graph include:\n- At low frequencies, \\( A(\\omega) \\) far exceeds \\( 1/\\beta \\), resulting in \\( A_{CL} \\approx 1/\\beta \\).\n- At high frequencies, \\( A(\\omega) \\) is considerably less than \\( 1/\\beta \\), leading to \\( A_{CL} \\approx A(\\omega) \\).\n- A pivotal frequency is identified where \\( A(\\omega) = 1/\\beta \\), marking the point where the loop gain \\( L(\\omega) = 1 \\).\n\nThe plot effectively demonstrates how negative feedback sustains a stable and precise gain \\( A_{CL} = 1/\\beta \\) over an extensive frequency range, contingent on the fulfillment of feedback conditions as previously discussed. The annotations emphasize the transitions and circumstances under which the amplifier operates linearly and efficiently.\n\nFig. 5.2 Bandwidth of a closed-loop amplifier."
},
{
    "text": "The model depicted in Fig. 5.1 is entirely linear and thus holds true only when the transistors within the amplifier, A, encounter small voltage and current signals. Fortunately, by incorporating negative feedback with substantial loop gain, the signal present at the amplifier's input, $x$, becomes a significantly weakened version of the system's overall input, $u$. When $\\mathrm{L} » 1$, equation (5.4) transforms into\n\n$$\n\\begin{equation*}\nx \\cong \\frac{u}{L} \\tag{5.10}\n\\end{equation*}\n$$\n\nThis implies that even with large signals at $u$, the amplifier $A$ only faces minimal voltage and current signals at its input, allowing it to function linearly. However, the feedback circuit must maintain linearity even when subjected to large signals. Its input is the amplifier's output, $y$, which is $A$ times larger than $x$.\n\nKey Point: With feedback, an amplifier encounters signals roughly $L$ times smaller than those it would face without feedback, thereby enhancing its linearity.\n\nImage Description: The graph in Figure 5.2 is a Bode plot depicting the bandwidth of a closed-loop amplifier. The x-axis is marked with \\( \\omega \\), symbolizing angular frequency, while the y-axis denotes gain, plotted on a logarithmic scale with key gain levels indicated by significant markers.\n\nThe graph features two primary curves: \\( A(\\omega) \\) and \\( A_{CL}(\\omega) \\). \\( A(\\omega) \\), representing the open-loop gain, begins at a high level and diminishes as frequency increases, following a negative slope that signifies decreasing gain with rising frequency.\n\n\\( A_{CL}(\\omega) \\), the closed-loop gain, appears as a horizontal line at the level \\( 1/\\beta \\), demonstrating that the closed-loop gain remains consistent across a broad frequency range, highlighting the stabilizing effect of feedback.\n\nKey graph points include:\n- At low frequencies, \\( A(\\omega) \\) exceeds \\( 1/\\beta \\), resulting in \\( A_{CL} \\approx 1/\\beta \\).\n- At high frequencies, \\( A(\\omega) \\) falls below \\( 1/\\beta \\), leading to \\( A_{CL} \\approx A(\\omega) \\).\n- A pivotal frequency is identified where \\( A(\\omega) = 1/\\beta \\), marking the point where the loop gain \\( L(\\omega) = 1 \\).\n\nThe plot effectively demonstrates how negative feedback sustains a stable and precise gain \\( A_{CL} = 1/\\beta \\) over a wide frequency range, contingent on the fulfillment of feedback conditions as previously discussed. Annotations underscore the transitions and circumstances under which the amplifier operates linearly and efficiently.\n\nFig. 5.2 Bandwidth of a closed-loop amplifier."
},
{
    "text": "The model depicted in Fig. 5.1 is entirely linear, and thus, it remains valid only when the transistors within the amplifier, A, encounter small voltage and current signals. Fortunately, by implementing negative feedback with substantial loop gain, the signal that emerges at the amplifier's input, $x$, becomes a significantly attenuated version of the overall system's input, $u$. When $\\mathrm{L} » 1$, equation (5.4) transforms into\n\n$$\n\\begin{equation*}\nx \\cong \\frac{u}{L} \\tag{5.10}\n\\end{equation*}\n$$\n\nThis implies that even with large signals present at $u$, the amplifier $A$ only experiences very minor voltage and current signals at its input, allowing it to function linearly. However, the feedback circuit must maintain linearity even when subjected to large signals. Its input is the amplifier's output, $y$, which is $A$ times larger than $x$.\n\nKey Point: With feedback, an amplifier encounters signals that are roughly $L$ times smaller than they would be without feedback, significantly enhancing its linearity.\n\n---\n\n**Image Description: Fig. 5.2 Bandwidth of a Closed-Loop Amplifier**\n\nThe graph in Figure 5.2 presents a Bode plot illustrating the bandwidth of a closed-loop amplifier. The x-axis, labeled with the symbol \\( \\omega \\), denotes angular frequency, while the y-axis measures gain, plotted on a logarithmic scale with notable markers indicating key gain levels.\n\nThe graph features two primary curves: \\( A(\\omega) \\) and \\( A_{CL}(\\omega) \\). \\( A(\\omega) \\) represents the open-loop gain, which begins at a high level and decreases as frequency increases, following a negative slope that signifies a decline in gain with rising frequency.\n\n\\( A_{CL}(\\omega) \\), the closed-loop gain, is shown as a horizontal line at the level \\( 1/\\beta \\), indicating that the closed-loop gain remains consistent across a broad frequency range, demonstrating the stabilizing effect of feedback.\n\nKey aspects of the graph include:\n- At low frequencies, \\( A(\\omega) \\) exceeds \\( 1/\\beta \\), resulting in \\( A_{CL} \\approx 1/\\beta \\).\n- At high frequencies, \\( A(\\omega) \\) falls below \\( 1/\\beta \\), leading to \\( A_{CL} \\approx A(\\omega) \\).\n- A critical frequency is identified where \\( A(\\omega) = 1/\\beta \\), marking the point where the loop gain \\( L(\\omega) = 1 \\).\n\nThe plot effectively demonstrates how negative feedback sustains a stable and precise gain \\( A_{CL} = 1/\\beta \\) over an extensive frequency range, contingent on the fulfillment of feedback conditions as discussed. The annotations emphasize the transitions and conditions under which the amplifier operates linearly and efficiently.\n\nFig. 5.2 Bandwidth of a closed-loop amplifier."
},
{
    "text": "The model depicted in Fig. 5.1 is entirely linear, thus its validity extends only when the transistors within the amplifier, A, encounter small voltage and current signals.幸运ly, by implementing negative feedback with substantial loop gain, the signal observed at the amplifier's input, $x$, is significantly reduced compared to the overall system's input, $u$. When $\\mathrm{L} » 1$, equation (5.4) transforms into\n\n$$\n\\begin{equation*}\nx \\approx \\frac{u}{L} \\tag{5.10}\n\\end{equation*}\n$$\n\nThis implies that even with large signals present at $u$, the amplifier $A$ only experiences minimal voltage and current signals at its input, allowing it to function linearly. However, the feedback circuit must maintain linearity even under large signal conditions. Its input is the amplifier's output, y, which is A times larger than x.\n\nKey Point: With feedback, the amplifier encounters signals roughly L times smaller than without feedback, significantly enhancing its linearity.\n\nimage_name:Fig. 5.2 Bandwidth of a closed-loop amplifier\ndescription:Figure 5.2 presents a Bode plot illustrating the bandwidth of a closed-loop amplifier. The x-axis is marked with \\( \\omega \\), symbolizing angular frequency, while the y-axis denotes gain, plotted on a logarithmic scale with key gain levels indicated.\n\nThe graph features two primary curves: \\( A(\\omega) \\) and \\( A_{CL}(\\omega) \\). \\( A(\\omega) \\) signifies the open-loop gain, which begins high and decreases as frequency rises, following a negative slope, reflecting gain reduction with increasing frequency.\n\n\\( A_{CL}(\\omega) \\), the closed-loop gain, appears as a horizontal line at \\( 1/\\beta \\), indicating consistent gain across a broad frequency range due to feedback stabilization.\n\nKey graph highlights include:\n- At low frequencies, \\( A(\\omega) \\) far exceeds \\( 1/\\beta \\), resulting in \\( A_{CL} \\approx 1/\\beta \\).\n- At high frequencies, \\( A(\\omega) \\) is much lower than \\( 1/\\beta \\), leading to \\( A_{CL} \\approx A(\\omega) \\).\n- A pivotal frequency is noted where \\( A(\\omega) = 1/\\beta \\), marking where loop gain \\( L(\\omega) = 1 \\).\n\nThe plot effectively demonstrates how negative feedback ensures a stable and precise gain \\( A_{CL} = 1/\\beta \\) over a wide frequency span, contingent on the fulfillment of feedback conditions as discussed. Annotations emphasize the transitions and operational conditions for the amplifier's linear and effective performance.\n\nFig. 5.2 Bandwidth of a closed-loop amplifier."
},
{
    "text": "The model depicted in Fig. 5.1 is entirely linear, thus it is only effective when the transistors within the amplifier, A, encounter small voltage and current signals.幸运地, by implementing negative feedback with substantial loop gain, the signal present at the amplifier's input, $x$, becomes a significantly weakened version of the system's overall input, $u$. When $\\mathrm{L} » 1$, equation (5.4) transforms into\n\n$$\n\\begin{equation*}\nx \\cong \\frac{u}{L} \\tag{5.10}\n\\end{equation*}\n$$\n\nThis implies that even with large signals at $u$, the amplifier $A$ only faces very minor voltage and current signals at its input, enabling it to function linearly. However, the feedback circuit must maintain linearity even when subjected to large signals. Its input is the amplifier's output, y, which is A times larger than x.\n\nKey Point: With feedback, an amplifier encounters signals roughly L times smaller than those it would without feedback, significantly enhancing its linearity.\n\nImage Description: The graph in Fig. 5.2 is a Bode plot illustrating the bandwidth of a closed-loop amplifier. The x-axis is marked with \\( \\omega \\), denoting angular frequency, while the y-axis indicates gain, plotted on a logarithmic scale with notable markers for key gain levels.\n\nThe graph features two primary curves: \\( A(\\omega) \\) and \\( A_{CL}(\\omega) \\). \\( A(\\omega) \\) represents the open-loop gain, which begins high and diminishes with increasing frequency, following a negative slope that signifies gain reduction as frequency rises.\n\n\\( A_{CL}(\\omega) \\), the closed-loop gain, appears as a horizontal line at the level \\( 1/\\beta \\), demonstrating that the closed-loop gain remains consistent across a broad frequency range, highlighting the impact of feedback in stabilizing the gain.\n\nKey graph elements include:\n- At low frequencies, \\( A(\\omega) \\) far exceeds \\( 1/\\beta \\), resulting in \\( A_{CL} \\approx 1/\\beta \\).\n- At high frequencies, \\( A(\\omega) \\) is much lower than \\( 1/\\beta \\), leading to \\( A_{CL} \\approx A(\\omega) \\).\n- A critical frequency is identified where \\( A(\\omega) = 1/\\beta \\), marking the point where the loop gain \\( L(\\omega) = 1 \\).\n\nThe plot effectively demonstrates how negative feedback sustains a stable and precise gain \\( A_{CL} = 1/\\beta \\) over a wide frequency span, contingent on the fulfillment of feedback conditions as previously discussed. The annotations emphasize the transitions and conditions under which the amplifier operates linearly and efficiently.\n\nFig. 5.2 Bandwidth of a closed-loop amplifier."
},
{
    "text": "The model depicted in Fig. 5.1 is entirely linear and, as such, remains valid only when the transistors within the amplifier, A, encounter small voltage and current signals.幸运的是，通过施加具有大环增益的负反馈，出现在放大器输入端的信号$x$是系统整体输入$u$的强烈衰减版本。在$\\mathrm{L} » 1$的情况下，(5.4)式变为\n\n$$\n\\begin{equation*}\nx \\cong \\frac{u}{L} \\tag{5.10}\n\\end{equation*}\n$$\n\n这表明，即使在大信号出现在$u$时，放大器$A$在其输入端仅接触到非常小的电压和电流信号，因此可以线性工作。然而，反馈电路即使在面对大信号时也必须线性运行。其输入是放大器输出$y$，该输出是$x$的A倍。\n\n关键点：有了反馈，放大器所接触的信号大约是无反馈情况下的L倍小，使其更加线性。\n\n图像名称：Fig. 5.2 闭环放大器的带宽\n描述：图5.2中的图表是一个表示闭环放大器带宽的Bode图。x轴标有符号\\( \\omega \\)，代表角频率，而y轴表示增益。增益在以对数尺度绘制，显著的标记指示关键的增益水平。\n\n图表展示了两条主要曲线：\\( A(\\omega) \\)和\\( A_{CL}(\\omega) \\)。\\( A(\\omega) \\)代表开环增益，起始于高水平并随频率增加而减少。它遵循负斜率，表明增益随频率增加而降低。\n\n\\( A_{CL}(\\omega) \\)，即闭环增益，被描绘为在水平\\( 1/\\beta \\)上的水平线。这表明闭环增益在广泛的频率范围内保持恒定，展示了反馈在稳定增益中的作用。\n\n图表上的关键点包括：\n- 在低频时，\\( A(\\omega) \\)远大于\\( 1/\\beta \\)，导致\\( A_{CL} \\approx 1/\\beta \\)。\n- 在高频时，\\( A(\\omega) \\)远小于\\( 1/\\beta \\)，使得\\( A_{CL} \\approx A(\\omega) \\)。\n- 标记了一个临界频率，此时\\( A(\\omega) = 1/\\beta \\)，表明环增益\\( L(\\omega) = 1 \\)。\n\n该图有效地说明了负反馈如何在满足反馈条件的广泛频率范围内保持稳定和准确的增益\\( A_{CL} = 1/\\beta \\)。注释突出了放大器在线性有效运行的条件和过渡情况。\n\nFig. 5.2 闭环放大器的带宽。"
},
{
    "text": "The model depicted in Fig. 5.1 is entirely linear and, as such, holds true only when the transistors within the amplifier, A, encounter minor voltage and current signals.幸运ly, by introducing negative feedback with substantial loop gain, the signal present at the amplifier's input, $x$, becomes a significantly weakened version of the overall system's input, $u$. When $\\mathrm{L} » 1$, equation (5.4) transforms into\n\n$$\n\\begin{equation*}\nx \\cong \\frac{u}{L} \\tag{5.10}\n\\end{equation*}\n$$\n\nThis implies that even with large signals at $u$, the amplifier $A$ only faces minimal voltage and current signals at its input, allowing it to function linearly. However, the feedback circuit must maintain linearity even under large signal conditions. Its input is the amplifier's output, y, which is A times larger than x.\n\nKey Point: With feedback, an amplifier encounters signals roughly L times smaller than those it would face without feedback, enhancing its linearity.\n\nImage Description: The graph in Figure 5.2, a Bode plot, illustrates the bandwidth of a closed-loop amplifier. The x-axis, labeled with \\( \\omega \\), denotes angular frequency, while the y-axis measures gain, plotted on a logarithmic scale with notable markers indicating key gain levels.\n\nThe plot features two primary curves: \\( A(\\omega) \\) and \\( A_{CL}(\\omega) \\). \\( A(\\omega) \\), representing the open-loop gain, begins at a high level and declines with rising frequency, following a negative slope that signifies decreasing gain with increased frequency.\n\n\\( A_{CL}(\\omega) \\), the closed-loop gain, appears as a horizontal line at the level \\( 1/\\beta \\), indicating consistent gain across a broad frequency range due to feedback stabilization.\n\nKey graph highlights include:\n- At low frequencies, \\( A(\\omega) \\) exceeds \\( 1/\\beta \\), resulting in \\( A_{CL} \\approx 1/\\beta \\).\n- At high frequencies, \\( A(\\omega) \\) falls below \\( 1/\\beta \\), leading to \\( A_{CL} \\approx A(\\omega) \\).\n- A pivotal frequency is marked where \\( A(\\omega) = 1/\\beta \\), signifying where the loop gain \\( L(\\omega) = 1 \\).\n\nThe plot effectively demonstrates how negative feedback sustains a stable and precise gain \\( A_{CL} = 1/\\beta \\) over a wide frequency spectrum, contingent on the fulfillment of feedback conditions as discussed. Annotations emphasize the transitions and operational conditions under which the amplifier maintains linearity and effectiveness.\n\nFig. 5.2 Bandwidth of a closed-loop amplifier."
},
{
    "text": "The model depicted in Fig. 5.1 is entirely linear, and thus, its validity is contingent upon the transistors within amplifier A experiencing only minor voltage and current signals.幸运地,通过引入具有高环路增益的负反馈，放大器输入端出现的信号$x$，成为系统总输入$u$的强烈衰减版本。在$\\mathrm{L} » 1$的情况下，（5.4）式可转化为\n\n$$\n\\begin{equation*}\nx \\cong \\frac{u}{L} \\tag{5.10}\n\\end{equation*}\n$$\n\n这表明，即使$u$处存在大信号，放大器$A$在其输入端仅遭遇极小的电压和电流信号，因而能保持线性运作。然而，反馈电路即便在大信号作用下也必须保持线性工作。其输入为放大器输出$y$，该值是$x$的$A$倍。\n\n要点：借助反馈，放大器所承受的信号大约为无反馈时的$1/L$，从而显著提升其线性度。\n\n图像名称：Fig. 5.2闭环放大器的带宽\n描述：图5.2中的图表是一个表示闭环放大器带宽的波特图。x轴标有符号$\\omega$，代表角频率，而y轴代表增益。增益在 logarithmic scale上绘制，显著标记指示关键增益水平。\n\n图表展示了两条主要曲线：$A(\\omega)$和$A_{CL}(\\omega)$。$A(\\omega)$代表开环增益，起始于高水平并随频率增加而下降。其沿负斜率下降，表明增益随频率增加而减少。\n\n$A_{CL}(\\omega)$，即闭环增益，表现为在$1/\\beta$水平上的水平线。这表明闭环增益在宽频率范围内保持恒定，凸显了反馈在稳定增益中的作用。\n\n图表的关键点包括：\n- 在低频段，$A(\\omega)$远大于$1/\\beta$，使得$A_{CL} \\approx 1/\\beta$。\n- 在高频段，$A(\\omega)$远小于$1/\\beta$，导致$A_{CL} \\approx A(\\omega)$。\n- 一个临界频率被标记为$A(\\omega) = 1/\\beta$，指示环路增益$L(\\omega) = 1$的位置。\n\n该图有效展示了在满足反馈条件的前提下，负反馈如何在整个宽频范围内维持稳定且精确的增益$A_{CL} = 1/\\beta$。注释突出了放大器线性有效运作的转换条件和状况。\n\nFig. 5.2闭环放大器的带宽。"
},
{
    "text": "The preceding sections demonstrate that amplifiers with precise gain of $\\mathrm{A}_{\\mathrm{CL}}=1 / \\beta$, extensive bandwidth, and high linearity can be achieved through the application of negative feedback, provided that:\n\n1) the feedback circuit possesses precisely controlled gain, $\\beta$, wide bandwidth, and high linearity\n2) the loop gain $L=A \\beta$ is substantial\n3) the feedback loop remains stable\n\nThe requirements for the feedback circuit (\\#1) are most readily met by using passive components and/or transistors functioning as basic switches, thereby circumventing the variability, parasitic poles, and intrinsic nonlinearity associated with circuits employing transistors in active mode. Frequently, the gain relies solely on the ratios of passive component values, which, in integrated circuits, tend to be more precise than their absolute values. Fulfilling condition $\\# 2$ involves designing an amplifier with a high gain, $A » 1 / \\beta$. Nonetheless, this is essentially the sole specification for the amplifier, as feedback significantly eases the demands on its accuracy, bandwidth, and linearity.\n\nCondition \\#3, related to the stability of the loop, will be addressed in the subsequent subsection."
},
{
    "text": "The preceding sections demonstrate that amplifiers with precise gain of $\\mathrm{A}_{\\mathrm{CL}}=1 / \\beta$, extensive bandwidth, and superior linearity can be achieved through the application of negative feedback, provided that:\n\n1) the feedback circuit exhibits precise control over its gain, $\\beta$, along with high bandwidth and linearity\n2) the loop gain, $L=A \\beta$, is substantial\n3) the feedback loop maintains stability\n\nThe requirements for the feedback circuit (point 1) are most readily met by using passive components and/or transistors functioning as basic switches, thereby circumventing the issues of variability, parasitic poles, and intrinsic nonlinearity associated with circuits employing active-mode transistors. Frequently, the gain relies solely on the ratios of passive component values, which, in integrated circuits, tend to be more precise than their absolute measurements. Meeting condition $\\# 2$ involves designing an amplifier with a high gain, $A » 1 / \\beta$. Nonetheless, this is essentially the sole specification for the amplifier, as feedback significantly alleviates the demands on its accuracy, bandwidth, and linearity.\n\nThe third condition, pertaining to the stability of the loop, will be addressed in the subsequent subsection."
},
{
    "text": "The preceding subsections demonstrate that amplifiers with precise gain of $\\mathrm{A}_{\\mathrm{CL}}=1 / \\beta$, extensive bandwidth, and high linearity can be achieved through the application of negative feedback, provided that:\n\n1) the feedback circuit possesses a precisely controlled gain, $\\beta$, broad bandwidth, and high linearity\n2) the loop gain $L=A \\beta$ is substantial\n3) the feedback loop remains stable\n\nThe requirements for the feedback circuit (\\#1) are most readily met by constructing it from passive components and/or transistors functioning as basic switches, thereby circumventing the variability, parasitic poles, and inherent nonlinearity associated with circuits employing transistors in active mode. Frequently, the gain relies solely on the ratios of passive component values, which, in integrated circuits, tend to be more precise than their absolute values. Satisfying Condition $\\# 2$ involves designing an amplifier with a high gain, $A » 1 / \\beta$. Nonetheless, this is essentially the sole specification for the amplifier, as feedback significantly alleviates the demands on its accuracy, bandwidth, and linearity.\n\nCondition \\#3, which pertains to the stability of the loop, will be addressed in the subsequent subsection."
},
{
    "text": "The previous sections demonstrate that amplifiers with precise gain of $\\mathrm{A}_{\\mathrm{CL}}=1 / \\beta$, extensive bandwidth, and superior linearity can be achieved through the application of negative feedback, provided that:\n\n1) the feedback circuit exhibits precisely controlled gain, $\\beta$, broad bandwidth, and high linearity\n2) the loop gain $L=A \\beta$ is substantial\n3) the feedback loop remains stable\n\nThe requirements for the feedback circuit (\\#1) are most readily met by using passive components and/or transistors functioning as basic switches, thereby circumventing the variability, parasitic poles, and innate nonlinearity associated with circuits employing transistors in active mode. Frequently, the gain relies solely on the ratios of passive component values, which, in integrated circuits, tend to be more precise than their absolute measurements. Meeting condition $\\# 2$ involves designing an amplifier with a high gain, $A » 1 / \\beta$. Nonetheless, this is essentially the sole specification for the amplifier, as feedback significantly eases the demands on its precision, bandwidth, and linearity.\n\nCondition \\#3, which addresses the stability of the loop, will be discussed in the subsequent subsection."
},
{
    "text": "The preceding sections demonstrate that amplifiers with precise gain of $\\mathrm{A}_{\\mathrm{CL}}=1 / \\beta$, extensive bandwidth, and superior linearity can be achieved through the application of negative feedback, provided that:\n\n1) the feedback circuit possesses precisely controlled gain, $\\beta$, extensive bandwidth, and superior linearity\n2) the loop gain $L=A \\beta$ is substantial\n3) the feedback loop remains stable\n\nThe requirements for the feedback circuit (\\#1) are most readily met by using passive components and/or transistors functioning as basic switches, thereby circumventing the variability, parasitic poles, and intrinsic nonlinearity associated with circuits employing transistors in active mode. Frequently, the gain relies solely on the ratios of passive component values, which, in integrated circuits, are more precise than their absolute values. Meeting condition $\\# 2$ involves designing an amplifier with a high gain, $A » 1 / \\beta$. Nonetheless, this is nearly the sole specification for the amplifier, as feedback significantly eases the demands on its precision, bandwidth, and linearity.\n\nCondition \\#3, which addresses the stability of the loop, will be discussed in the subsequent subsection."
},
{
    "text": "The preceding sections demonstrate that amplifiers with precise gain of $\\mathrm{A}_{\\mathrm{CL}}=1 / \\beta$, extensive bandwidth, and superior linearity can be achieved through the application of negative feedback, provided that:\n\n1) the feedback circuit possesses precisely controlled gain, $\\beta$, wide bandwidth, and high linearity\n2) the loop gain $L=A \\beta$ is substantial\n3) the feedback loop remains stable\n\nThe requirements for the feedback circuit (\\#1) are most readily met by using passive components and/or transistors functioning as basic switches, thereby circumventing the variability, parasitic poles, and intrinsic nonlinearity associated with circuits employing transistors in active mode. Frequently, the gain relies solely on the ratios of passive component values, which, in integrated circuits, tend to be more precise than their absolute values. Satisfying Condition $\\# 2$ involves designing an amplifier with a high gain, $A » 1 / \\beta$. Nonetheless, this is nearly the sole specification for the amplifier, as feedback significantly alleviates the demands on its precision, bandwidth, and linearity.\n\nCondition \\#3, which pertains to the stability of the loop, will be addressed in the subsequent subsection."
},
{
    "text": "The earlier sections demonstrate that amplifiers with precise gain of $\\mathrm{A}_{\\mathrm{CL}}=1 / \\beta$, extensive bandwidth, and superior linearity can be achieved through the application of negative feedback, provided that:\n\n1) the feedback circuit possesses a precisely controlled gain, $\\beta$, wide bandwidth, and high linearity\n2) the loop gain $L=A \\beta$ is substantial\n3) the feedback loop remains stable\n\nThe requirements for the feedback circuit (\\#1) are most readily met by using passive components and/or transistors functioning as basic switches, thereby circumventing the variability, parasitic poles, and innate nonlinearity associated with circuits employing transistors in active mode. Frequently, the gain relies solely on the ratios of passive component values, which, in integrated circuits, tend to be more precise than their absolute values. Condition $\\# 2$ is fulfilled by designing an amplifier with a high gain, $A » 1 / \\beta$. Nonetheless, this is essentially the sole specification for the amplifier, as feedback significantly alleviates the demands on its precision, bandwidth, and linearity.\n\nCondition \\#3, which pertains to the stability of the loop, will be addressed in the subsequent subsection."
},
{
    "text": "The earlier sections demonstrate that amplifiers with precise gain of $\\mathrm{A}_{\\mathrm{CL}}=1 / \\beta$, extensive bandwidth, and superior linearity can be achieved through the application of negative feedback, provided that:\n\n1) the feedback circuit possesses a precisely controlled gain, $\\beta$, wide bandwidth, and high linearity\n2) the loop gain $L=A \\beta$ is substantial\n3) the feedback loop remains stable\n\nThe requirements for the feedback circuit (\\#1) are most readily met by using passive components and/or transistors functioning as basic switches, thereby circumventing the variability, parasitic poles, and intrinsic nonlinearity associated with circuits employing transistors in active mode. Frequently, the gain relies solely on the ratios of passive component values, which, in integrated circuits, tend to be more precise than their absolute values. Fulfilling condition $\\# 2$ involves designing an amplifier with a high gain, $A » 1 / \\beta$. Nonetheless, this is essentially the sole specification for the amplifier, as feedback significantly alleviates the demands on its precision, bandwidth, and linearity.\n\nCondition \\#3, which pertains to the stability of the loop, will be addressed in the subsequent subsection."
},
{
    "text": "Readers might have utilized feedback amplifiers without consciously evaluating their stability, yet these approaches can overlook crucial circuit behaviors.\n\n#### EXAMPLE 5.3\n\nTypically, the noninverting amplifier in Fig. 5.3(a) is examined under the assumption that the opamp's differential input is zero. Consequently, the voltage at the negative amplifier terminal is $\\mathrm{v}_{-}=\\mathrm{v}_{\\mathrm{in}}$. By further assuming the amplifier possesses infinite input impedance, the output voltage can be linked to the input through a nodal equation at $\\mathbf{v}_{\\text {_ }}$.\n\n$$\n\\begin{gather*}\nv_{\\text {in }}\\left(\\frac{1}{R_{1}}+\\frac{1}{R_{2}}\\right)-\\frac{v_{\\text {out }}}{R_{2}}=0  \\tag{5.11}\\\\\n\\Rightarrow \\frac{v_{\\text {out }}}{v_{\\text {in }}}=1+\\frac{R_{2}}{R_{1}}\n\\end{gather*}\n$$\n\nThis outcome is verified by practical lab testing of such amplifiers.\nimage_name:(a)\ndescription:\n[\nname: A1, type: OpAmp, value: A1, ports: {InP: Vin, InN: V-, OutP: Vout}\nname: R1, type: Resistor, value: R1, ports: {N1: V-, N2: GND}\nname: R2, type: Resistor, value: R2, ports: {N1: V-, N2: Vout}\n]\nextrainfo:This circuit represents a noninverting amplifier where the gain is governed by resistors R1 and R2.\nimage_name:(b)\ndescription:\n[\nname: A1, type: OpAmp, value: A1, ports: {InP: V+, InN: Vin, vin: Vout}\nname: R1, type: Resistor, value: R1, ports: {N1: V+, N2: GND}\nname: R2, type: Resistor, value: R2, ports: {N1: Vout, N2: V+}\n]\nextrainfo:This configuration is a non-inverting amplifier with reversed op-amp input terminals, resulting in instability due to the positive feedback loop, which causes a significant increase in output voltage.\n\nFig. 5.3 (a) A noninverting amplifier. (b) A noninverting amplifier with reversed opamp input terminals, leading to instability.\n\nOne might consider applying the same analysis to the amplifier in Fig. 5.3(b). This would yield the identical result (5.11) since the sole difference between the circuits is the polarity of the opamp inputs, which was not accounted for in the previous analysis. However, the assumption of a zero differential input for the opamp implies feedback loop stability. In reality, the feedback loop in Fig. $5.3(b)$ is unstable. Practically, the voltage at $\\mathrm{v}_{\\text {_ }}$ will surpass $\\mathrm{v}_{\\mathrm{in}}$, and the opamp's high gain will amplify this difference, resulting in an output voltage $\\mathrm{V}_{\\text {out }}$ near the amplifier's supply voltage.\n\nExample 5.3 illustrates an extreme scenario where the feedback loop is positively instead of negatively oriented. Instability can also emerge more subtly, particularly at high frequencies, when the amplifier introduces a phase shift that transforms negative feedback into positive. This section introduces general techniques for assessing the stability of analog circuits with feedback. For stable circuits, these methods also offer insights into key aspects of the closed-loop amplifier's frequency response."
},
{
    "text": "Readers might have utilized feedback amplifiers without directly assessing their stability, yet these approaches can overlook crucial circuit behaviors.\n\n#### EXAMPLE 5.3\n\nThe noninverting amplifier in Fig. 5.3(a) is typically analyzed by assuming the opamp's differential input is zero, leading to $\\mathrm{v}_{-}=\\mathrm{v}_{\\mathrm{in}}$. By further assuming infinite input impedance, the output voltage can be linked to the input via a nodal equation at $\\mathbf{v}_{\\text {_ }}$.\n\n$$\n\\begin{gather*}\nv_{\\text {in }}\\left(\\frac{1}{R_{1}}+\\frac{1}{R_{2}}\\right)-\\frac{v_{\\text {out }}}{R_{2}}=0  \\tag{5.11}\\\\\n\\Rightarrow \\frac{v_{\\text {out }}}{v_{\\text {in }}}=1+\\frac{R_{2}}{R_{1}}\n\\end{gather*}\n$$\n\nThis outcome is reliable, as lab tests of such amplifiers confirm.\nimage_name:(a)\ndescription:\n[\nname: A1, type: OpAmp, value: A1, ports: {InP: Vin, InN: V-, OutP: Vout}\nname: R1, type: Resistor, value: R1, ports: {N1: V-, N2: GND}\nname: R2, type: Resistor, value: R2, ports: {N1: V-, N2: Vout}\n]\nextrainfo:This circuit is a noninverting amplifier configuration. The gain is determined by the resistors R1 and R2.\nimage_name:(b)\ndescription:\n[\nname: A1, type: OpAmp, value: A1, ports: {InP: V+, InN: Vin, vin: Vout}\nname: R1, type: Resistor, value: R1, ports: {N1: V+, N2: GND}\nname: R2, type: Resistor, value: R2, ports: {N1: Vout, N2: V+}\n]\nextrainfo:The circuit is a non-inverting amplifier with the op-amp input terminals reversed, making it unstable. This configuration leads to a large output voltage due to the positive feedback loop.\n\nFig. 5.3 (a) A noninverting amplifier. (b) A noninverting amplifier with the opamp input terminals reversed is unstable.\n\nOne might consider applying the same analysis to the amplifier in Fig. 5.3(b), which would yield equation (5.11) since the only change is the polarity of the opamp inputs, not accounted for in the prior analysis. However, assuming a zero differential input for the opamp implies feedback loop stability. In Fig. $5.3(b)$, the feedback loop is actually unstable. Practically, $\\mathrm{v}_{\\text {_ }}$ will exceed $\\mathrm{v}_{\\mathrm{in}}$, and the opamp's high gain will amplify this difference, resulting in an output voltage $\\mathrm{V}_{\\text {out }}$ near the supply voltage.\n\nExample 5.3 illustrates an extreme scenario where the feedback is positive rather than negative. Instability can also emerge subtly, particularly at high frequencies, when the amplifier introduces a phase shift converting negative feedback to positive. This section introduces general techniques to evaluate the stability of feedback-containing analog circuits. For stable circuits, these methods also shed light on key aspects of the closed-loop amplifier's frequency response."
},
{
    "text": "Readers might have utilized feedback amplifiers without explicitly assessing their stability, yet such approaches can overlook crucial circuit behaviors.\n\n#### EXAMPLE 5.3\n\nTypically, the noninverting amplifier in Fig. 5.3(a) is analyzed under the assumption that the opamp's differential input is zero. Consequently, the voltage at the negative amplifier terminal is $\\mathrm{v}_{-}=\\mathrm{v}_{\\mathrm{in}}$. By further assuming infinite input impedance for the amplifier, the output voltage can be linked to the input through a nodal equation at $\\mathbf{v}_{\\text {_ }}$.\n\n$$\n\\begin{gather*}\nv_{\\text {in }}\\left(\\frac{1}{R_{1}}+\\frac{1}{R_{2}}\\right)-\\frac{v_{\\text {out }}}{R_{2}}=0  \\tag{5.11}\\\\\n\\Rightarrow \\frac{v_{\\text {out }}}{v_{\\text {in }}}=1+\\frac{R_{2}}{R_{1}}\n\\end{gather*}\n$$\n\nThis outcome is reliable, as any lab-tested instance of such an amplifier can confirm.\nimage_name:(a)\ndescription:\n[\nname: A1, type: OpAmp, value: A1, ports: {InP: Vin, InN: V-, OutP: Vout}\nname: R1, type: Resistor, value: R1, ports: {N1: V-, N2: GND}\nname: R2, type: Resistor, value: R2, ports: {N1: V-, N2: Vout}\n]\nextrainfo:This circuit represents a noninverting amplifier configuration. The gain is dictated by resistors R1 and R2.\nimage_name:(b)\ndescription:\n[\nname: A1, type: OpAmp, value: A1, ports: {InP: V+, InN: Vin, vin: Vout}\nname: R1, type: Resistor, value: R1, ports: {N1: V+, N2: GND}\nname: R2, type: Resistor, value: R2, ports: {N1: Vout, N2: V+}\n]\nextrainfo:The circuit is a non-inverting amplifier with reversed op-amp input terminals, resulting in instability. This setup causes a significant output voltage due to the positive feedback loop.\n\nFig. 5.3 (a) A noninverting amplifier. (b) A noninverting amplifier with reversed opamp input terminals is unstable.\n\nOne might consider applying the same analysis to the amplifier in Fig. 5.3(b). This would produce the same result (5.11) since the only difference between the circuits is the polarity of the opamp inputs, which was not accounted for in the previous analysis. However, assuming a zero differential input for the opamp presupposes the stability of the feedback loop. In reality, the feedback loop in Fig. $5.3(b)$ is unstable. Practically, the voltage at $\\mathrm{v}_{\\text {_ }}$ will surpass $\\mathrm{v}_{\\mathrm{in}}$, and the opamp's substantial gain will amplify this difference, resulting in an output voltage $\\mathrm{V}_{\\text {out }}$ near the amplifier's supply voltage.\n\nExample 5.3 illustrates an extreme scenario where the feedback loop is positive rather than negative. Instability can also emerge more subtly, such as when high frequencies introduce a phase shift that transforms negative feedback into positive. This section introduces general methods for evaluating the stability of analog circuits with feedback. For stable circuits, these methods also provide insights into key aspects of the closed-loop amplifier's frequency response."
},
{
    "text": "The reader may have already utilized feedback amplifiers without explicitly assessing their stability. Nonetheless, these approaches can overlook crucial circuit behaviors.\n\n#### EXAMPLE 5.3\n\nThe noninverting amplifier depicted in Fig. 5.3(a) is commonly analyzed under the assumption that the opamp's differential input is negligible. Thus, the voltage at the negative amplifier terminal is $\\mathrm{v}_{-}=\\mathrm{v}_{\\mathrm{in}}$. By further assuming the amplifier has infinite input impedance, the output voltage can be related to the input through a nodal equation at $\\mathbf{v}_{\\text {_ }}$.\n\n$$\n\\begin{gather*}\nv_{\\text {in }}\\left(\\frac{1}{R_{1}}+\\frac{1}{R_{2}}\\right)-\\frac{v_{\\text {out }}}{R_{2}}=0  \\tag{5.11}\\\\\n\\Rightarrow \\frac{v_{\\text {out }}}{v_{\\text {in }}}=1+\\frac{R_{2}}{R_{1}}\n\\end{gather*}\n$$\n\nThis outcome is reliable, as those who have tested such an amplifier in a lab setting can confirm.\nimage_name:(a)\ndescription:\n[\nname: A1, type: OpAmp, value: A1, ports: {InP: Vin, InN: V-, OutP: Vout}\nname: R1, type: Resistor, value: R1, ports: {N1: V-, N2: GND}\nname: R2, type: Resistor, value: R2, ports: {N1: V-, N2: Vout}\n]\nextrainfo:This circuit is a noninverting amplifier configuration. The gain is determined by the resistors R1 and R2.\nimage_name:(b)\ndescription:\n[\nname: A1, type: OpAmp, value: A1, ports: {InP: V+, InN: Vin, vin: Vout}\nname: R1, type: Resistor, value: R1, ports: {N1: V+, N2: GND}\nname: R2, type: Resistor, value: R2, ports: {N1: Vout, N2: V+}\n]\nextrainfo:The circuit is a non-inverting amplifier with the op-amp input terminals reversed, making it unstable. This configuration leads to a large output voltage due to the positive feedback loop.\n\nFig. 5.3 (a) A noninverting amplifier. (b) A noninverting amplifier with the opamp input terminals reversed is unstable.\n\nOne might consider applying the same analysis to the amplifier in Fig. 5.3(b). This would yield the identical result (5.11) since the sole difference between the circuits is the polarity of the opamp inputs, which was not accounted for in the prior analysis. However, the assumption that the opamp's differential input is zero presupposes the stability of the feedback loop. In reality, the feedback loop in Fig. $5.3(b)$ is unstable. Practically, the voltage at $\\mathrm{v}_{\\text {_ }}$ will surpass $\\mathrm{v}_{\\mathrm{in}}$, and the opamp's substantial gain will amplify the difference, resulting in an output voltage $\\mathrm{V}_{\\text {out }}$ near the amplifier's supply voltage.\n\nExample 5.3 illustrates an extreme scenario where the feedback loop is positive rather than negative. However, instability can also emerge more subtly, particularly at high frequencies where the amplifier introduces a phase shift that converts negative feedback into positive. This section introduces general techniques for evaluating the stability of analog circuits with feedback. For stable circuits, these methods also provide insights into key aspects of the closed-loop amplifier's frequency response."
},
{
    "text": "The reader might have already utilized feedback amplifiers without explicitly addressing their stability, though such approaches can miss critical circuit behaviors.\n\n#### EXAMPLE 5.3\n\nThe noninverting amplifier depicted in Fig. 5.3(a) is typically analyzed under the assumption that the opamp's differential input is zero. Consequently, the voltage at the negative amplifier terminal is $\\mathrm{v}_{-}=\\mathrm{v}_{\\mathrm{in}}$. By further assuming the amplifier has infinite input impedance, the output voltage can be related to the input via a nodal equation at $\\mathbf{v}_{\\text {_ }}$.\n\n$$\n\\begin{gather*}\nv_{\\text {in }}\\left(\\frac{1}{R_{1}}+\\frac{1}{R_{2}}\\right)-\\frac{v_{\\text {out }}}{R_{2}}=0  \\tag{5.11}\\\\\n\\Rightarrow \\frac{v_{\\text {out }}}{v_{\\text {in }}}=1+\\frac{R_{2}}{R_{1}}\n\\end{gather*}\n$$\n\nThis outcome is reliable, as those who have experimented with such an amplifier in a lab can confirm.\nimage_name:(a)\ndescription:\n[\nname: A1, type: OpAmp, value: A1, ports: {InP: Vin, InN: V-, OutP: Vout}\nname: R1, type: Resistor, value: R1, ports: {N1: V-, N2: GND}\nname: R2, type: Resistor, value: R2, ports: {N1: V-, N2: Vout}\n]\nextrainfo:This circuit represents a noninverting amplifier configuration, where the gain is dictated by resistors R1 and R2.\nimage_name:(b)\ndescription:\n[\nname: A1, type: OpAmp, value: A1, ports: {InP: V+, InN: Vin, vin: Vout}\nname: R1, type: Resistor, value: R1, ports: {N1: V+, N2: GND}\nname: R2, type: Resistor, value: R2, ports: {N1: Vout, N2: V+}\n]\nextrainfo:This circuit is a non-inverting amplifier with reversed op-amp input terminals, leading to instability. The positive feedback loop results in a significantly amplified output voltage.\n\nFig. 5.3 (a) A noninverting amplifier. (b) A noninverting amplifier with reversed opamp input terminals, causing instability.\n\nOne might consider applying the same analysis to the amplifier in Fig. 5.3(b). This would produce the same result (5.11) since the sole difference between the circuits is the polarity of the opamp inputs, which was not accounted for in the earlier analysis. However, assuming a zero differential input for the opamp presupposes the stability of the feedback loop. In reality, the feedback loop in Fig. $5.3(b)$ is unstable. Practically, the voltage at $\\mathrm{v}_{\\text {_ }}$ will exceed $\\mathrm{v}_{\\mathrm{in}}$, and the opamp's high gain will amplify this difference, resulting in an output voltage $\\mathrm{V}_{\\text {out }}$ near the amplifier's supply voltage.\n\nExample 5.3 illustrates an extreme scenario where the feedback loop is positive rather than negative. Instability can also arise more subtly, such as when high frequencies introduce a phase shift that transforms negative feedback into positive. This section introduces general methods to assess the stability of analog circuits with feedback. For stable circuits, these methods also offer insights into key aspects of the closed-loop amplifier's frequency response."
},
{
    "text": "Readers might have utilized feedback amplifiers without explicitly evaluating their stability, yet these approaches can overlook crucial circuit behaviors.\n\n#### EXAMPLE 5.3\n\nThe noninverting amplifier in Fig. 5.3(a) is typically analyzed under the assumption that the opamp's differential input is zero, leading to $\\mathrm{v}_{-}=\\mathrm{v}_{\\mathrm{in}}$. Assuming infinite input impedance for the amplifier, the output voltage can be linked to the input via a nodal equation at $\\mathbf{v}_{\\text {_ }}$.\n\n$$\n\\begin{gather*}\nv_{\\text {in }}\\left(\\frac{1}{R_{1}}+\\frac{1}{R_{2}}\\right)-\\frac{v_{\\text {out }}}{R_{2}}=0  \\tag{5.11}\\\\\n\\Rightarrow \\frac{v_{\\text {out }}}{v_{\\text {in }}}=1+\\frac{R_{2}}{R_{1}}\n\\end{gather*}\n$$\n\nThis outcome is reliable, as confirmed by those who have experimented with such amplifiers in a lab setting.\nimage_name:(a)\ndescription:\n[\nname: A1, type: OpAmp, value: A1, ports: {InP: Vin, InN: V-, OutP: Vout}\nname: R1, type: Resistor, value: R1, ports: {N1: V-, N2: GND}\nname: R2, type: Resistor, value: R2, ports: {N1: V-, N2: Vout}\n]\nextrainfo:This circuit is a noninverting amplifier setup. The gain is dictated by resistors R1 and R2.\nimage_name:(b)\ndescription:\n[\nname: A1, type: OpAmp, value: A1, ports: {InP: V+, InN: Vin, vin: Vout}\nname: R1, type: Resistor, value: R1, ports: {N1: V+, N2: GND}\nname: R2, type: Resistor, value: R2, ports: {N1: Vout, N2: V+}\n]\nextrainfo:The circuit is a non-inverting amplifier with reversed op-amp input terminals, resulting in instability. This setup causes a significant output voltage due to the positive feedback loop.\n\nFig. 5.3 (a) A noninverting amplifier. (b) A noninverting amplifier with reversed opamp input terminals, causing instability.\n\nOne might consider applying the same analysis to the amplifier in Fig. 5.3(b), which would produce the same result (5.11) since the only variance is the opamp input polarity, not accounted for in the prior analysis. However, assuming a zero differential input for the opamp implies feedback loop stability. In reality, the feedback loop in Fig. $5.3(b)$ is unstable. Practically, the voltage at $\\mathrm{v}_{\\text {_ }}$ will exceed $\\mathrm{v}_{\\mathrm{in}}$, and the opamp's high gain will amplify this difference, resulting in an output voltage $\\mathrm{V}_{\\text {out }}$ near the amplifier's supply voltage.\n\nExample 5.3 illustrates an extreme scenario where the feedback loop is positively oriented instead of negatively. Instability can also emerge subtly, particularly at high frequencies where the amplifier introduces a phase shift converting negative feedback to positive. This section introduces general techniques to assess the stability of analog circuits with feedback. For stable circuits, these methods also offer insights into key aspects of the closed-loop amplifier's frequency response."
},
{
    "text": "Readers might have utilized feedback amplifiers without directly addressing their stability, yet these approaches can overlook crucial circuit behaviors.\n\n#### EXAMPLE 5.3\n\nThe noninverting amplifier depicted in Fig. 5.3(a) is typically analyzed under the assumption that the opamp's differential input is negligible. Thus, the voltage at the negative amplifier terminal is $\\mathrm{v}_{-}=\\mathrm{v}_{\\mathrm{in}}$. By also assuming infinite input impedance for the amplifier, the output voltage can be linked to the input through a nodal equation at $\\mathbf{v}_{\\text {_ }}$.\n\n$$\n\\begin{gather*}\nv_{\\text {in }}\\left(\\frac{1}{R_{1}}+\\frac{1}{R_{2}}\\right)-\\frac{v_{\\text {out }}}{R_{2}}=0  \\tag{5.11}\\\\\n\\Rightarrow \\frac{v_{\\text {out }}}{v_{\\text {in }}}=1+\\frac{R_{2}}{R_{1}}\n\\end{gather*}\n$$\n\nThis outcome is reliable, as those who have experimented with such an amplifier in a lab can confirm.\nimage_name:(a)\ndescription:\n[\nname: A1, type: OpAmp, value: A1, ports: {InP: Vin, InN: V-, OutP: Vout}\nname: R1, type: Resistor, value: R1, ports: {N1: V-, N2: GND}\nname: R2, type: Resistor, value: R2, ports: {N1: V-, N2: Vout}\n]\nextrainfo:This circuit represents a noninverting amplifier setup. The gain is dictated by resistors R1 and R2.\nimage_name:(b)\ndescription:\n[\nname: A1, type: OpAmp, value: A1, ports: {InP: V+, InN: Vin, vin: Vout}\nname: R1, type: Resistor, value: R1, ports: {N1: V+, N2: GND}\nname: R2, type: Resistor, value: R2, ports: {N1: Vout, N2: V+}\n]\nextrainfo:The configuration is a non-inverting amplifier with reversed op-amp input terminals, leading to instability. This setup results in a high output voltage due to the positive feedback loop.\n\nFig. 5.3 (a) A noninverting amplifier. (b) A noninverting amplifier with reversed opamp input terminals, causing instability.\n\nOne might consider applying the same analysis to the amplifier in Fig. 5.3(b). This would produce the same equation (5.11) since the sole difference between the circuits is the polarity of the opamp inputs, which was not accounted for in the prior analysis. However, assuming a zero differential input for the opamp assumes the feedback loop's stability. The feedback loop in Fig. $5.3(b)$ is actually unstable. Practically, the voltage at $\\mathrm{v}_{\\text {_ }}$ will exceed $\\mathrm{v}_{\\mathrm{in}}$, and the opamp's significant gain will amplify this difference, resulting in an output voltage $\\mathrm{V}_{\\text {out }}$ near the amplifier's supply voltage.\n\nExample 5.3 illustrates an extreme scenario where the feedback loop is positive rather than negative. Instability can also emerge more subtly, such as when high frequencies induce a phase shift in the amplifier, transforming negative feedback into positive. This section introduces general techniques to assess the stability of analog circuits with feedback. For stable circuits, these methods also offer insights into key aspects of the closed-loop amplifier's frequency response."
},
{
    "text": "Readers might have utilized feedback amplifiers without explicitly assessing their stability, yet such approaches can overlook crucial circuit behaviors.\n\n#### EXAMPLE 5.3\n\nThe noninverting amplifier depicted in Fig. 5.3(a) is typically analyzed under the assumption that the opamp's differential input is zero. Consequently, the voltage at the negative amplifier terminal is $\\mathrm{v}_{-}=\\mathrm{v}_{\\mathrm{in}}$. By further assuming the amplifier possesses infinite input impedance, the output voltage can be related to the input through a nodal equation at $\\mathbf{v}_{\\text {_ }}$.\n\n$$\n\\begin{gather*}\nv_{\\text {in }}\\left(\\frac{1}{R_{1}}+\\frac{1}{R_{2}}\\right)-\\frac{v_{\\text {out }}}{R_{2}}=0  \\tag{5.11}\\\\\n\\Rightarrow \\frac{v_{\\text {out }}}{v_{\\text {in }}}=1+\\frac{R_{2}}{R_{1}}\n\\end{gather*}\n$$\n\nThis outcome is reliable, as those who have laboratory-tested such an amplifier can confirm.\nimage_name:(a)\ndescription:\n[\nname: A1, type: OpAmp, value: A1, ports: {InP: Vin, InN: V-, OutP: Vout}\nname: R1, type: Resistor, value: R1, ports: {N1: V-, N2: GND}\nname: R2, type: Resistor, value: R2, ports: {N1: V-, N2: Vout}\n]\nextrainfo:This circuit represents a noninverting amplifier setup. The gain is dictated by resistors R1 and R2.\nimage_name:(b)\ndescription:\n[\nname: A1, type: OpAmp, value: A1, ports: {InP: V+, InN: Vin, vin: Vout}\nname: R1, type: Resistor, value: R1, ports: {N1: V+, N2: GND}\nname: R2, type: Resistor, value: R2, ports: {N1: Vout, N2: V+}\n]\nextrainfo:This circuit is a non-inverting amplifier with reversed op-amp input terminals, leading to instability. The configuration results in a high output voltage due to the positive feedback loop.\n\nFig. 5.3 (a) A noninverting amplifier. (b) A noninverting amplifier with reversed opamp input terminals, causing instability.\n\nOne might consider applying the same analysis to the amplifier in Fig. 5.3(b). This would yield the identical result (5.11) since the sole difference between the circuits is the polarity of the opamp inputs, which was not accounted for in the prior analysis. However, assuming a zero differential input for the opamp presupposes the stability of the feedback loop. The feedback loop in Fig. $5.3(b)$ is actually unstable. Practically, the voltage at $\\mathrm{v}_{\\text {_ }}$ will surpass $\\mathrm{v}_{\\mathrm{in}}$, and the opamp's substantial gain will amplify this difference, producing an output voltage $\\mathrm{V}_{\\text {out }}$ near the amplifier's supply voltage.\n\nExample 5.3 illustrates an extreme scenario where the feedback loop is positive rather than negative. Instability can also emerge more subtly, particularly at high frequencies when the amplifier introduces a phase shift that transforms negative feedback into positive. This section introduces general techniques for evaluating the stability of analog circuits with feedback. For stable circuits, these methods also offer insights into significant aspects of the closed-loop amplifier's frequency response."
},
{
    "text": "The techniques used to analyze the stability of analog circuits with feedback differ somewhat from those taught in introductory control theory courses and textbooks. Control theory often deals with stabilizing an inherently unstable system through the application of feedback. ${ }^{2}$ In contrast, we apply feedback to amplifiers A that are already inherently stable. Our goal is to enhance the amplifier's accuracy, bandwidth, and linearity, as outlined in Section 5.1. However, if not carefully managed, feedback can render a previously stable amplifier unstable, as illustrated in Example 5.3.\n\nStability can be assessed by ensuring that all poles of the closed-loop system,\n\n$$\n\\begin{equation*}\n\\mathrm{A}_{\\mathrm{CL}}(\\mathrm{~s})=\\frac{\\mathrm{A}(\\mathrm{~s})}{1+\\mathrm{A}(\\mathrm{~s}) \\beta} \\tag{5.12}\n\\end{equation*}\n$$\n\nreside in the left-half plane. Nevertheless, this method is seldom used due to the difficulty in accurately obtaining A(s). Fortunately, stability can be evaluated by analyzing the magnitude and phase of the frequency response $L(\\omega)$, which can be easily obtained through circuit simulation.\n\nIn all scenarios of interest, the amplifier's magnitude response is substantial at low frequencies, $|A(\\omega)| \\gg 1 / \\beta$, and diminishes at high frequencies. The same poles that cause the magnitude response to decrease also introduce negative phase shift at higher frequencies. Additionally, in line with the discussion in Section, we assume that the feedback circuit has a consistent and well-controlled gain, $\\beta \\leq 1$. Consequently, the open-loop magnitude response is simply a scaled version of the amplifier's magnitude response,\n\n$$\n\\begin{equation*}\n|L(\\omega)|=|A(\\omega)| \\beta \\tag{5.13}\n\\end{equation*}\n$$\n\nand the open-loop phase response matches that of the amplifier,\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}(\\omega)=\\angle \\mathrm{A}(\\omega)+\\angle \\beta=\\angle \\mathrm{A}(\\omega)+0^{\\circ}=\\angle \\mathrm{A}(\\omega) \\tag{5.14}\n\\end{equation*}\n$$\n\nThe open-loop Bode plot depicted in Fig. 5.4(a) is representative of all the feedback circuits we will examine. Of particular interest is the frequency at which the open-loop magnitude response equals unity,\n\n$$\n\\begin{equation*}\n\\left|\\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)\\right|=1 \\tag{5.15}\n\\end{equation*}\n$$\n\nSolving (5.15) yields the loop's \"unity-gain frequency\", $\\omega_{t}{ }^{3}$\n2. The system to be stabilized is known as \"the plant.\"\n3. Absent any unusual fluctuations in the loop's magnitude response (which should be avoided by design), equation (5.15) has a single (positive) solution, making $\\omega_{\\mathrm{t}}$ unique.\n\nAn alternative graphical representation of the open-loop magnitude and phase response is presented in Fig. $5.4(b)$, which is a polar plot of $L(\\omega)=A(\\omega) \\beta$ across all frequencies, $-\\infty<\\omega<\\infty$. At low frequencies where $\\mathrm{L}(\\omega)$ has a large magnitude and near-zero phase shift, the polar plot lies far from the origin along the positive real axis. As $\\omega$ increases to high positive values, the plot spirals clockwise towards the origin. For negative values of $\\omega$, the spiral mirrors across the real axis, spiraling counterclockwise from the point at $L(0)$. Given a stable amplifier A, the closed-loop feedback system will also be stable if and only if this polar plot does not encircle the point $-1 .{ }^{4}$ This is ensured as long as the polar plot intersects the unit circle below the real axis for positive frequencies, as shown in Fig. 5.4.\n\nBy definition, the polar plot's intersection with the unit circle occurs at the loop's unity-gain frequency, $\\omega_{\\mathrm{t}}$. Thus, an equivalent stability criterion is\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)>-180^{\\circ} \\tag{5.16}\n\\end{equation*}\n$$\n\nKey Point: The stability of a feedback amplifier can be verified by examining a Bode plot of the loop gain, $\\mathrm{L}(\\omega)$; as long as the phase response exceeds -180 degrees at the unity gain frequency, the feedback system is stable.\n\nIn summary, a feedback amplifier remains stable as long as (5.16) is satisfied with $\\omega_{\\mathrm{t}}$ defined by (5.15). This criterion is entirely expressed in terms of the open-loop magnitude and phase response. Therefore, it can be readily checked by inspecting a Bode plot of $L(\\omega)$. There is minimal need for polar plots, which will be avoided henceforth. Additionally, using the method described in Section 5.4.1, the Bode plot can be easily generated through computer simulation.\n\nimage_name:(a)\ndescription:The graph labeled (a) is a Bode plot, comprising two separate plots: one for the magnitude and one for the phase of the loop gain $L(\\omega)$ as a function of frequency $\\omega$. The magnitude plot is at the top, and the phase plot is at the bottom.\n\n1. **Magnitude Plot:**\n- **Axes Labels and Units:**\n- The vertical axis shows the magnitude of the loop gain $|L(\\omega)|$ in decibels (dB).\n- The horizontal axis represents the frequency $\\omega$, usually on a logarithmic scale, though specific units are not indicated.\n- **Overall Behavior and Trends:**\n- The plot starts at a high magnitude at low frequencies and decreases with increasing frequency.\n- The magnitude crosses the 0 dB line at a specific frequency, $\\omega_t$, known as the gain crossover frequency.\n\n2. **Phase Plot:**\n- **Axes Labels and Units:**\n- The vertical axis represents the phase angle $\\angle L(\\omega)$ in degrees.\n- The horizontal axis is the same as the magnitude plot, showing frequency $\\omega$.\n- **Overall Behavior and Trends:**\n- The phase starts at 0 degrees at low frequencies and decreases as frequency rises.\n- As the frequency nears $\\omega_t$, the phase angle approaches -180 degrees.\n- The phase margin (PM) is indicated as the difference between the phase angle at $\\omega_t$ and -180 degrees.\n\n3. **Key Features and Technical Details:**\n- The Bode plot is used to assess the stability of a feedback system by examining the gain and phase margins.\n- The phase margin is a critical stability indicator, showing how close the phase is to -180 degrees when the gain is 0 dB.\n\n4. **Annotations and Specific Data Points:**\n- The plot includes a dashed line at $\\omega_t$, marking the frequency where the magnitude is 0 dB.\n- The phase margin is explicitly shown on the phase plot as the vertical distance between the phase at $\\omega_t$ and the -180-degree line.\n\nimage_name:(b)\ndescription:The graph labeled (b) is a polar plot illustrating the loop gain \\( L(\\omega) \\) for a feedback circuit as a function of frequency. This type of graph is essential for visualizing the stability of feedback systems, particularly in control systems and amplifier design.\n\nAxes and Units:\n- **Axes:** The polar plot lacks traditional Cartesian axes. Instead, it uses a circular coordinate system where the radial distance from the origin represents the magnitude of \\( L(\\omega) \\) and the angle represents the phase.\n- **Units:** The magnitude is typically dimensionless, while the phase is measured in degrees.\n\nOverall Behavior and Trends:\n- The plot shows the trajectory of \\( L(\\omega) \\) as the frequency \\( \\omega \\) varies from negative to positive values.\n- The trajectory starts on the positive real axis at \\( L(0) \\) for \\( \\omega < 0 \\) and loops around the origin.\n- As \\( \\omega \\) increases, the path crosses the negative real axis and continues, indicating changes in phase and magnitude.\n\nKey Features and Technical Details:\n- The plot crosses the negative real axis at the point \\(-1\\), which is vital for stability assessment.\n- The phase margin (PM) is shown as the angle between the negative real axis and the point where the trajectory crosses the unit circle.\n- The loop gain \\( L(\\omega) \\) for \\( \\omega > 0 \\) is depicted with a thicker line, highlighting positive frequencies.\n- The trajectory does not encircle the point \\(-1\\), indicating the stability of the feedback system.\n\nAnnotations and Specific Data Points:\n- The plot is annotated with the point \\( L(0) \\) and the phase margin (PM).\n- The dashed circle represents the unit circle, a reference for evaluating gain and phase margins.\n\nThis polar plot, used alongside the Bode plot in part (a), provides a comprehensive view of the system's stability characteristics. The plot's shape and its relationship to the point \\(-1\\) are crucial for determining the feedback system's stability across different frequencies.\n\nFig. 5.4 The relationship between (a) a Bode plot and (b) a polar plot of $L(\\omega)$ for a stable feedback circuit.\n\n#### EXAMPLE 5.4\n\nSketch a polar plot of the loop gain for the positive-feedback circuit in Fig. 5.3(b).\n\n#### Solution\n\nGiven the positive feedback, when modeled using our negative feedback framework in Fig. 5.1, the loop gain $L=A \\beta$ is negative at low frequencies where the opamp gain is very high. Thus, the plot starts on the negative real axis with a large magnitude. From there, the loop's magnitude response tends to zero at high frequencies, causing the polar plot to spiral into the origin, as shown in Fig. 5.5. Clearly, it must encircle the point -1, indicating that the loop is unstable."
},
{
    "text": "The techniques used to analyze the stability of analog circuits with feedback diverge somewhat from those presented in introductory control theory courses and textbooks. Control theory often addresses the challenge of stabilizing an inherently unstable system through the application of feedback. ${ }^{2}$ In contrast, we will apply feedback to amplifiers A that are already inherently stable. Our goal is to enhance the amplifier's accuracy, bandwidth, and linearity, as outlined in Section 5.1. However, if proper precautions are not taken, feedback can inadvertently destabilize the previously stable amplifier, as illustrated in Example 5.3.\n\nStability can be assessed by ensuring that all poles of the closed-loop system,\n\n$$\n\\begin{equation*}\n\\mathrm{A}_{\\mathrm{CL}}(\\mathrm{~s})=\\frac{\\mathrm{A}(\\mathrm{~s})}{1+\\mathrm{A}(\\mathrm{~s}) \\beta} \\tag{5.12}\n\\end{equation*}\n$$\n\nreside in the left-half plane. Nevertheless, this method is seldom used due to the difficulty in accurately determining A(s). Fortunately, stability can be evaluated by analyzing the magnitude and phase of the frequency response $L(\\omega)$, which can be easily obtained through circuit simulation.\n\nIn all scenarios of interest, the amplifier's magnitude response is substantial at low frequencies, $|A(\\omega)| \\gg 1 / \\beta$, and diminishes at high frequencies. The same poles that cause the magnitude response to decline also introduce negative phase shift at higher frequencies. Additionally, in line with the discussion in Section, we assume that the feedback circuit exhibits a constant and well-controlled gain, $\\beta \\leq 1$. Consequently, the open-loop magnitude response is simply a scaled version of the amplifier's magnitude response,\n\n$$\n\\begin{equation*}\n|L(\\omega)|=|A(\\omega)| \\beta \\tag{5.13}\n\\end{equation*}\n$$\n\nand the open-loop phase response mirrors that of the amplifier,\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}(\\omega)=\\angle \\mathrm{A}(\\omega)+\\angle \\beta=\\angle \\mathrm{A}(\\omega)+0^{\\circ}=\\angle \\mathrm{A}(\\omega) \\tag{5.14}\n\\end{equation*}\n$$\n\nThe open-loop Bode plot depicted in Fig. 5.4(a) is representative of all the feedback circuits we will examine. Of particular significance is the frequency at which the open-loop magnitude response equals unity,\n\n$$\n\\begin{equation*}\n\\left|\\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)\\right|=1 \\tag{5.15}\n\\end{equation*}\n$$\n\nSolving (5.15) yields the loop's \"unity-gain frequency\", $\\omega_{t}{ }^{3}$\n2. The system to be stabilized is known as \"the plant.\"\n3. Absent any unusual fluctuations in the loop's magnitude response (which should be avoided in design), equation (5.15) has a single (positive) solution, making $\\omega_{\\mathrm{t}}$ unique.\n\nAn alternative graphical representation of the open-loop magnitude and phase response is illustrated in Fig. $5.4(b)$, which is a polar plot of $L(\\omega)=A(\\omega) \\beta$ across all frequencies, $-\\infty<\\omega<\\infty$. At low frequencies where $\\mathrm{L}(\\omega)$ exhibits high magnitude and minimal phase shift, the polar plot lies far from the origin along the positive real axis. As $\\omega$ rises to high positive values, the plot spirals clockwise towards the origin. For negative $\\omega$ values, the spiral mirrors across the real axis, spiraling counterclockwise from the point at $L(0)$. Given a stable amplifier A, the closed-loop feedback system will remain stable if and only if this polar plot does not encircle the point $-1 .{ }^{4}$ This condition is met as long as the polar plot intersects the unit circle below the real axis for positive frequencies, as shown in Fig. 5.4.\n\nBy definition, the polar plot's intersection with the unit circle occurs at the loop's unity-gain frequency, $\\omega_{\\mathrm{t}}$. Thus, an equivalent stability criterion is\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)>-180^{\\circ} \\tag{5.16}\n\\end{equation*}\n$$\n\nKey Point: The stability of a feedback amplifier can be verified by examining a Bode plot of the loop gain, $\\mathrm{L}(\\omega)$; if the phase response exceeds -180 degrees at the unity gain frequency, the feedback system is stable.\n\nIn summary, a feedback amplifier remains stable as long as (5.16) is satisfied with $\\omega_{\\mathrm{t}}$ defined by (5.15). This criterion is entirely expressed in terms of the open-loop magnitude and phase response. Therefore, it can be checked by simply inspecting a Bode plot of $L(\\omega)$. There is minimal need for polar plots, and they will be avoided henceforth. Additionally, using the method described in Section 5.4.1, the Bode plot can be easily generated through computer simulation.\n\nimage_name:(a)\ndescription:The graph labeled (a) is a Bode plot, featuring two separate plots: one for the magnitude and one for the phase of the loop gain $L(\\omega)$ as a function of frequency $\\omega$. The magnitude plot is located at the top, while the phase plot is at the bottom.\n\n1. **Magnitude Plot:**\n- **Axes Labels and Units:**\n- The vertical axis represents the magnitude of the loop gain $|L(\\omega)|$ in decibels (dB).\n- The horizontal axis represents the frequency $\\omega$, usually on a logarithmic scale, though specific units are not indicated.\n- **Overall Behavior and Trends:**\n- The plot begins at a high magnitude at low frequencies and decreases as the frequency increases.\n- The magnitude intersects the 0 dB line at a specific frequency, designated as $\\omega_t$, which is the gain crossover frequency.\n\n2. **Phase Plot:**\n- **Axes Labels and Units:**\n- The vertical axis represents the phase angle $\\angle L(\\omega)$ in degrees.\n- The horizontal axis is the same as the magnitude plot, depicting frequency $\\omega$.\n- **Overall Behavior and Trends:**\n- The phase starts at 0 degrees at low frequencies and decreases as the frequency rises.\n- As the frequency nears $\\omega_t$, the phase angle approaches -180 degrees.\n- The phase margin (PM) is indicated as the difference between the phase angle at $\\omega_t$ and -180 degrees.\n\n3. **Key Features and Technical Details:**\n- The Bode plot is used to assess the stability of a feedback system by examining the gain and phase margins.\n- The phase margin is a critical indicator of stability, representing how close the phase is to reaching -180 degrees when the gain is 0 dB.\n\n4. **Annotations and Specific Data Points:**\n- The plot includes a dashed line at $\\omega_t$, indicating the frequency where the magnitude is 0 dB.\n- The phase margin is explicitly marked on the phase plot as the vertical distance between the phase at $\\omega_t$ and the -180-degree line.\n\nimage_name:(b)\ndescription:The graph labeled (b) is a polar plot representing the loop gain \\( L(\\omega) \\) for a feedback circuit as a function of frequency. This type of graph is utilized to visualize the stability of feedback systems, particularly in control systems and amplifier design.\n\nAxes and Units:\n- **Axes:** The polar plot lacks traditional Cartesian axes. Instead, it uses a circular coordinate system where the radial distance from the origin represents the magnitude of \\( L(\\omega) \\) and the angle represents the phase.\n- **Units:** The magnitude is typically dimensionless, while the phase is measured in degrees.\n\nOverall Behavior and Trends:\n- The plot depicts the trajectory of \\( L(\\omega) \\) as the frequency \\( \\omega \\) varies from negative to positive values.\n- The trajectory starts on the positive real axis at \\( L(0) \\) for \\( \\omega < 0 \\) and loops around the origin.\n- As \\( \\omega \\) increases, the path crosses the negative real axis and continues, indicating changes in phase and magnitude.\n\nKey Features and Technical Details:\n- The plot crosses the negative real axis at the point \\(-1\\), which is vital for stability assessment.\n- The phase margin (PM) is indicated as the angle between the negative real axis and the point where the trajectory crosses the unit circle.\n- The loop gain \\( L(\\omega) \\) for \\( \\omega > 0 \\) is shown with a thicker line, suggesting a focus on positive frequencies.\n- The trajectory does not encircle the point \\(-1\\), indicating the stability of the feedback system.\n\nAnnotations and Specific Data Points:\n- The plot is annotated with the point \\( L(0) \\) and the phase margin (PM).\n- The dashed circle represents the unit circle, a reference for assessing gain and phase margins.\n\nThis polar plot complements the Bode plot in part (a) to provide a comprehensive view of the system's stability characteristics. The plot's shape and its relation to the point \\(-1\\) are essential for determining whether the feedback system remains stable across different frequencies.\n\nFig. 5.4 The relationship between (a) a Bode plot and (b) a polar plot of $L(\\omega)$ for a stable feedback circuit.\n\n#### EXAMPLE 5.4\n\nSketch a polar plot of the loop gain for the positive-feedback circuit in Fig. 5.3(b).\n\n#### Solution\n\nGiven that the feedback is positive, when modeled using our negative feedback framework in Fig. 5.1, the loop gain $L=A \\beta$ is negative at low frequencies where the opamp gain is very high. Thus, the plot starts on the negative real axis with a large magnitude. From this point, the loop's magnitude response tends to zero at high frequencies, causing the polar plot to spiral into the origin, as depicted in Fig. 5.5. Clearly, it must encircle the point -1, indicating that the loop is unstable."
},
{
    "text": "The techniques used to analyze the stability of analog circuits incorporating feedback differ somewhat from those taught in introductory control theory courses and textbooks. Control theory often addresses the challenge of stabilizing an inherently unstable system through the application of feedback. ${ }^{2}$ In contrast, our focus is on applying feedback to amplifiers A that are already inherently stable. We utilize feedback to enhance the amplifier's precision, bandwidth, and linearity, as detailed in Section 5.1. However, if not properly managed, feedback can render a previously stable amplifier unstable, as illustrated in Example 5.3.\n\nStability can be assessed by verifying that all poles of the closed-loop system,\n\n$$\n\\begin{equation*}\n\\mathrm{A}_{\\mathrm{CL}}(\\mathrm{~s})=\\frac{\\mathrm{A}(\\mathrm{~s})}{1+\\mathrm{A}(\\mathrm{~s}) \\beta} \\tag{5.12}\n\\end{equation*}\n$$\n\nreside in the left-half plane. Nevertheless, this approach is seldom used due to the difficulty in accurately determining A(s). Fortunately, stability can be evaluated by analyzing the magnitude and phase of the frequency response $L(\\omega)$, which can be easily obtained through circuit simulations.\n\nIn all scenarios of interest, the amplifier's magnitude response is substantial at low frequencies, $|A(\\omega)| \\gg 1 / \\beta$, and diminishes at high frequencies. The same poles that cause the magnitude response to decline also introduce negative phase shift at higher frequencies. Additionally, consistent with the discussion in Section, we assume that the feedback circuit has a constant and well-regulated gain, $\\beta \\leq 1$. Consequently, the open-loop magnitude response is simply a scaled version of the amplifier's magnitude response,\n\n$$\n\\begin{equation*}\n|L(\\omega)|=|A(\\omega)| \\beta \\tag{5.13}\n\\end{equation*}\n$$\n\nand the open-loop phase response matches that of the amplifier,\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}(\\omega)=\\angle \\mathrm{A}(\\omega)+\\angle \\beta=\\angle \\mathrm{A}(\\omega)+0^{\\circ}=\\angle \\mathrm{A}(\\omega) \\tag{5.14}\n\\end{equation*}\n$$\n\nThe open-loop Bode plot depicted in Fig. 5.4(a) is representative of all the feedback circuits we will examine. Of particular significance is the frequency at which the open-loop magnitude response equals unity,\n\n$$\n\\begin{equation*}\n\\left|\\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)\\right|=1 \\tag{5.15}\n\\end{equation*}\n$$\n\nThe solution to (5.15) is the loop's \"unity-gain frequency\", $\\omega_{t}{ }^{3}$\n2. The system to be stabilized is referred to as \"the plant.\"\n3. Absent any unusual fluctuations in the loop's magnitude response (which should be avoided by design), equation (5.15) has a single (positive) solution, making $\\omega_{\\mathrm{t}}$ unique.\n\nAn alternative graphical depiction of the open-loop magnitude and phase response is presented in Fig. $5.4(b)$, which is a polar plot of $L(\\omega)=A(\\omega) \\beta$ across all frequencies, $-\\infty<\\omega<\\infty$. At low frequencies where $\\mathrm{L}(\\omega)$ exhibits large magnitude and near-zero phase shift, the polar plot extends far from the origin along the positive real axis. As $\\omega$ rises to high positive values, the plot spirals clockwise inward toward the origin. For negative values of $\\omega$, the spiral mirrors across the real axis, spiraling counterclockwise from the point at $L(0)$. Given a stable amplifier A, the closed-loop feedback system will also be stable if, and only if, this polar plot does not encircle the point $-1 .{ }^{4}$ This condition is met as long as the polar plot intersects the unit circle below the real axis for positive frequencies, as shown in Fig. 5.4.\n\nBy definition, the polar plot's intersection with the unit circle occurs at the loop's unity-gain frequency, $\\omega_{\\mathrm{t}}$. Therefore, an equivalent stability criterion is\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)>-180^{\\circ} \\tag{5.16}\n\\end{equation*}\n$$\n\nKey Point: The stability of a feedback amplifier can be verified by examining a Bode plot of the loop gain, $\\mathrm{L}(\\omega)$; as long as the phase response exceeds -180 degrees at the unity gain frequency, the feedback system remains stable.\n\nIn summary, a feedback amplifier is stable provided that (5.16) is satisfied with $\\omega_{\\mathrm{t}}$ defined by (5.15). This criterion is entirely expressed in terms of the open-loop magnitude and phase response. Thus, it can be readily checked by inspecting a Bode plot of $L(\\omega)$. There is minimal need for polar plots, and they will be avoided henceforth. Additionally, using the method outlined in Section 5.4.1, the Bode plot can be easily generated through computer simulation.\n\nimage_name:(a)\ndescription:The graph labeled (a) is a Bode plot comprising two separate plots: one for the magnitude and one for the phase of the loop gain $L(\\omega)$ as a function of frequency $\\omega$. The magnitude plot is at the top, and the phase plot is at the bottom.\n\n1. **Magnitude Plot:**\n- **Axes Labels and Units:**\n- The vertical axis shows the magnitude of the loop gain $|L(\\omega)|$ in decibels (dB).\n- The horizontal axis represents the frequency $\\omega$, usually on a logarithmic scale, though specific units are not indicated.\n- **Overall Behavior and Trends:**\n- The plot begins at a high magnitude at low frequencies and decreases as the frequency rises.\n- The magnitude crosses the 0 dB line at a specific frequency, labeled $\\omega_t$, which is the gain crossover frequency.\n\n2. **Phase Plot:**\n- **Axes Labels and Units:**\n- The vertical axis depicts the phase angle $\\angle L(\\omega)$ in degrees.\n- The horizontal axis is the same as for the magnitude plot, representing frequency $\\omega$.\n- **Overall Behavior and Trends:**\n- The phase starts at 0 degrees at low frequencies and decreases with increasing frequency.\n- As the frequency nears $\\omega_t$, the phase angle approaches -180 degrees.\n- The phase margin (PM) is indicated as the difference between the phase angle at $\\omega_t$ and -180 degrees.\n\n3. **Key Features and Technical Details:**\n- The Bode plot is used to assess the stability of a feedback system by examining the gain and phase margins.\n- The phase margin is a critical stability indicator, representing how close the phase is to -180 degrees when the gain is 0 dB.\n\n4. **Annotations and Specific Data Points:**\n- The plot includes a dashed line at $\\omega_t$, marking the frequency where the magnitude is 0 dB.\n- The phase margin is explicitly shown on the phase plot as the vertical distance between the phase at $\\omega_t$ and the -180-degree line.\n\nimage_name:(b)\ndescription:The graph labeled (b) is a polar plot illustrating the loop gain \\( L(\\omega) \\) for a feedback circuit as a function of frequency. This type of graph is used to visualize the stability of feedback systems, particularly in control systems and amplifier design.\n\nAxes and Units:\n- **Axes:** The polar plot lacks traditional Cartesian axes, using a circular coordinate system where the radial distance from the origin represents the magnitude of \\( L(\\omega) \\) and the angle represents the phase.\n- **Units:** The magnitude is typically dimensionless, while the phase is measured in degrees.\n\nOverall Behavior and Trends:\n- The plot shows the trajectory of \\( L(\\omega) \\) as the frequency \\( \\omega \\) varies from negative to positive values.\n- The trajectory starts on the positive real axis at \\( L(0) \\) for \\( \\omega < 0 \\) and loops around the origin.\n- As \\( \\omega \\) increases, the path crosses the negative real axis and continues, indicating changes in phase and magnitude.\n\nKey Features and Technical Details:\n- The plot crosses the negative real axis at the point \\(-1\\), which is crucial for stability assessment.\n- The phase margin (PM) is indicated as the angle between the negative real axis and the point where the trajectory crosses the unit circle.\n- The loop gain \\( L(\\omega) \\) for \\( \\omega > 0 \\) is shown with a thicker line, emphasizing positive frequencies.\n- The trajectory does not encircle the point \\(-1\\), indicating the stability of the feedback system.\n\nAnnotations and Specific Data Points:\n- The plot is annotated with the point \\( L(0) \\) and the phase margin (PM).\n- The dashed circle represents the unit circle, a reference for evaluating gain and phase margins.\n\nThis polar plot, used alongside the Bode plot in part (a), provides a comprehensive view of the system's stability characteristics. The plot's shape and its relation to the point \\(-1\\) are essential for determining the feedback system's stability across different frequencies.\n\nFig. 5.4 The relationship between (a) a Bode plot and (b) a polar plot of $L(\\omega)$ for a stable feedback circuit.\n\n#### EXAMPLE 5.4\n\nSketch a polar plot of the loop gain for the positive-feedback circuit in Fig. 5.3(b).\n\n#### Solution\n\nGiven the positive feedback, when modeled using our negative feedback framework in Fig. 5.1, the loop gain $L=A \\beta$ is negative at low frequencies where the opamp gain is very high. Thus, the plot starts on the negative real axis with a large magnitude. From there, the loop's magnitude response tends to zero at high frequencies, causing the polar plot to spiral into the origin, as depicted in Fig. 5.5. Clearly, it must encircle the point -1, indicating that the loop is unstable."
},
{
    "text": "The techniques used to analyze the stability of analog circuits with feedback differ somewhat from those taught in introductory control theory courses and texts. Control theory often addresses the challenge of stabilizing an inherently unstable system through the application of feedback. ${ }^{2}$ In contrast, we will apply feedback to amplifiers A that are already stable by themselves. Our goal is to enhance the amplifier's accuracy, bandwidth, and linearity, as detailed in Section 5.1. However, if not handled carefully, feedback can destabilize an amplifier that was previously stable, as illustrated in Example 5.3.\n\nStability can be assessed by ensuring that all poles of the closed-loop system,\n\n$$\n\\begin{equation*}\n\\mathrm{A}_{\\mathrm{CL}}(\\mathrm{~s})=\\frac{\\mathrm{A}(\\mathrm{~s})}{1+\\mathrm{A}(\\mathrm{~s}) \\beta} \\tag{5.12}\n\\end{equation*}\n$$\n\nare located in the left-half plane. Nevertheless, this method is seldom used due to the difficulty in accurately obtaining A(s). Fortunately, stability can be evaluated using the magnitude and phase of the frequency response $L(\\omega)$, which can be easily obtained through circuit simulation.\n\nIn all scenarios of interest, the amplifier's magnitude response is substantial at low frequencies, $|A(\\omega)| \\gg 1 / \\beta$, and diminishes at high frequencies. The same poles that cause the magnitude response to decline also introduce negative phase shift at higher frequencies. Additionally, consistent with the discussion in Section, we assume that the feedback circuit has a constant and well-controlled gain, $\\beta \\leq 1$. Consequently, the open-loop magnitude response is simply a scaled version of the amplifier's magnitude response,\n\n$$\n\\begin{equation*}\n|L(\\omega)|=|A(\\omega)| \\beta \\tag{5.13}\n\\end{equation*}\n$$\n\nand the open-loop phase response matches that of the amplifier,\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}(\\omega)=\\angle \\mathrm{A}(\\omega)+\\angle \\beta=\\angle \\mathrm{A}(\\omega)+0^{\\circ}=\\angle \\mathrm{A}(\\omega) \\tag{5.14}\n\\end{equation*}\n$$\n\nThe open-loop Bode plot depicted in Fig. 5.4(a) is representative of all the feedback circuits we will examine. Of particular interest is the frequency at which the open-loop magnitude response equals unity,\n\n$$\n\\begin{equation*}\n\\left|\\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)\\right|=1 \\tag{5.15}\n\\end{equation*}\n$$\n\nThe solution to (5.15) is the loop's \"unity-gain frequency\", $\\omega_{t}{ }^{3}$\n2. The system to be stabilized is known as \"the plant.\"\n3. Absent any unusual fluctuations in the loop's magnitude response (which should be avoided in design), equation (5.15) has a single (positive) solution, making $\\omega_{\\mathrm{t}}$ unique.\n\nAn alternative graphical representation of the open-loop magnitude and phase response is shown in Fig. $5.4(b)$, which is a polar plot of $L(\\omega)=A(\\omega) \\beta$ across all frequencies, $-\\infty<\\omega<\\infty$. At low frequencies where $\\mathrm{L}(\\omega)$ has a large magnitude and near-zero phase shift, the polar plot will be distant from the origin along the positive real axis. As $\\omega$ rises to high positive values, the plot spirals clockwise towards the origin. For negative $\\omega$ values, the spiral mirrors across the real axis, spiraling counterclockwise from the point at $L(0)$. Given a stable amplifier A, the closed-loop feedback system will also be stable if and only if this polar plot does not encircle the point $-1 .{ }^{4}$ This is ensured as long as the polar plot intersects the unit circle below the real axis for positive frequencies, as depicted in Fig. 5.4.\n\nBy definition, the polar plot's intersection with the unit circle occurs at the loop's unity-gain frequency, $\\omega_{\\mathrm{t}}$. Thus, an equivalent stability criterion is\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)>-180^{\\circ} \\tag{5.16}\n\\end{equation*}\n$$\n\nKey Point: The stability of a feedback amplifier can be verified by examining a Bode plot of the loop gain, $\\mathrm{L}(\\omega)$; as long as the phase response exceeds -180 degrees at the unity gain frequency, the feedback system is stable.\n\nIn summary, a feedback amplifier remains stable as long as (5.16) is fulfilled with $\\omega_{\\mathrm{t}}$ defined by (5.15). This criterion is entirely expressed in terms of the open-loop magnitude and phase response. Therefore, it can be checked simply by inspecting a Bode plot of $L(\\omega)$. There is minimal need for polar plots, and they will be avoided henceforth. Additionally, using the method outlined in Section 5.4.1, the Bode plot can be easily generated through computer simulation.\n\nimage_name:(a)\ndescription:The graph labeled (a) is a Bode plot, comprising two separate plots: one for the magnitude and one for the phase of the loop gain $L(\\omega)$ as a function of frequency $\\omega$. The magnitude plot is at the top, and the phase plot is at the bottom.\n\n1. **Magnitude Plot:**\n- **Axes Labels and Units:**\n- The vertical axis shows the magnitude of the loop gain $|L(\\omega)|$ in decibels (dB).\n- The horizontal axis represents the frequency $\\omega$, usually on a logarithmic scale, though specific units are not indicated.\n- **Overall Behavior and Trends:**\n- The plot begins at a high magnitude at low frequencies and decreases as frequency rises.\n- The magnitude crosses the 0 dB line at a specific frequency, marked as $\\omega_t$, which is the gain crossover frequency.\n\n2. **Phase Plot:**\n- **Axes Labels and Units:**\n- The vertical axis indicates the phase angle $\\angle L(\\omega)$ in degrees.\n- The horizontal axis is the same as the magnitude plot, representing frequency $\\omega$.\n- **Overall Behavior and Trends:**\n- The phase starts at 0 degrees at low frequencies and decreases with increasing frequency.\n- As the frequency nears $\\omega_t$, the phase angle approaches -180 degrees.\n- The phase margin (PM) is shown as the difference between the phase angle at $\\omega_t$ and -180 degrees.\n\n3. **Key Features and Technical Details:**\n- The Bode plot is used to determine the stability of a feedback system by analyzing the gain and phase margins.\n- The phase margin is a critical stability indicator, representing how close the phase is to -180 degrees when the gain is 0 dB.\n\n4. **Annotations and Specific Data Points:**\n- The plot includes a dashed line at $\\omega_t$, indicating the frequency where the magnitude is 0 dB.\n- The phase margin is clearly marked on the phase plot as the vertical distance between the phase at $\\omega_t$ and the -180-degree line.\n\nimage_name:(b)\ndescription:The graph labeled (b) is a polar plot showing the loop gain \\( L(\\omega) \\) for a feedback circuit as a function of frequency. This type of graph is used to visualize the stability of feedback systems, particularly in control systems and amplifier design.\n\nAxes and Units:\n- **Axes:** The polar plot lacks traditional Cartesian axes. Instead, it uses a circular coordinate system where the radial distance from the origin represents the magnitude of \\( L(\\omega) \\) and the angle represents the phase.\n- **Units:** The magnitude is typically dimensionless, while the phase is measured in degrees.\n\nOverall Behavior and Trends:\n- The plot illustrates the trajectory of \\( L(\\omega) \\) as the frequency \\( \\omega \\) varies from negative to positive values.\n- The trajectory starts on the positive real axis at \\( L(0) \\) for \\( \\omega < 0 \\) and loops around the origin.\n- As \\( \\omega \\) increases, the path crosses the negative real axis and continues, reflecting changes in phase and magnitude.\n\nKey Features and Technical Details:\n- The plot crosses the negative real axis at the point \\(-1\\), which is essential for stability assessment.\n- The phase margin (PM) is shown as the angle between the negative real axis and the point where the trajectory crosses the unit circle.\n- The loop gain \\( L(\\omega) \\) for \\( \\omega > 0 \\) is depicted with a thicker line, highlighting the focus on positive frequencies.\n- The trajectory does not encircle the point \\(-1\\), indicating the stability of the feedback system.\n\nAnnotations and Specific Data Points:\n- The plot is annotated with the point \\( L(0) \\) and the phase margin (PM).\n- The dashed circle represents the unit circle, a reference for evaluating gain and phase margins.\n\nThis polar plot complements the Bode plot in part (a) to provide a comprehensive view of the system's stability characteristics. The plot's shape and its relationship to the point \\(-1\\) are vital for determining whether the feedback system remains stable across different frequencies.\n\nFig. 5.4 The relationship between (a) a Bode plot and (b) a polar plot of $L(\\omega)$ for a stable feedback circuit.\n\n#### EXAMPLE 5.4\n\nSketch a polar plot of loop gain for the positive-feedback circuit in Fig. 5.3(b).\n\n#### Solution\n\nGiven the positive feedback, when modeled using our negative feedback framework of Fig. 5.1, the loop gain $L=A \\beta$ is negative at low frequencies where the opamp gain is very high. Thus, the plot starts on the negative real axis with a large magnitude. As the frequency increases, the magnitude response of the loop tends to zero, causing the polar plot to spiral into the origin, as shown in Fig. 5.5. Clearly, it must encircle the point -1, indicating that the loop is unstable."
},
{
    "text": "The techniques used to analyze the stability of analog circuits with feedback differ somewhat from those taught in introductory control theory courses and texts. Control theory often addresses the challenge of stabilizing an inherently unstable system through the application of feedback. ${ }^{2}$ In contrast, we will apply feedback to amplifiers A that are already inherently stable. Our goal is to enhance the amplifier's accuracy, bandwidth, and linearity, as outlined in Section 5.1. However, if not handled carefully, feedback can render the previously stable amplifier unstable, as illustrated in Example 5.3.\n\nStability can be assessed by ensuring that all poles of the closed-loop system,\n\n$$\n\\begin{equation*}\n\\mathrm{A}_{\\mathrm{CL}}(\\mathrm{~s})=\\frac{\\mathrm{A}(\\mathrm{~s})}{1+\\mathrm{A}(\\mathrm{~s}) \\beta} \\tag{5.12}\n\\end{equation*}\n$$\n\nare located in the left-half plane. Nevertheless, this method is seldom used due to the difficulty in accurately determining A(s).幸运的是, stability can be evaluated by analyzing the magnitude and phase of the frequency response $L(\\omega)$, which can be easily obtained through circuit simulation.\n\nIn all scenarios of interest, the amplifier's magnitude response is substantial at low frequencies, $|A(\\omega)| \\gg 1 / \\beta$, and diminishes at high frequencies. The same poles that cause the magnitude response to decline also introduce negative phase shift at higher frequencies. Additionally, consistent with the discussion in Section, we assume that the feedback circuit has a constant and well-controlled gain, $\\beta \\leq 1$. Consequently, the open-loop magnitude response is simply a scaled version of the amplifier's magnitude response,\n\n$$\n\\begin{equation*}\n|L(\\omega)|=|A(\\omega)| \\beta \\tag{5.13}\n\\end{equation*}\n$$\n\nand the open-loop phase response matches that of the amplifier,\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}(\\omega)=\\angle \\mathrm{A}(\\omega)+\\angle \\beta=\\angle \\mathrm{A}(\\omega)+0^{\\circ}=\\angle \\mathrm{A}(\\omega) \\tag{5.14}\n\\end{equation*}\n$$\n\nThe open-loop Bode plot depicted in Fig. 5.4(a) is representative of all the feedback circuits we will examine. Of particular interest is the frequency at which the open-loop magnitude response equals unity,\n\n$$\n\\begin{equation*}\n\\left|\\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)\\right|=1 \\tag{5.15}\n\\end{equation*}\n$$\n\nSolving (5.15) yields the loop's \"unity-gain frequency\", $\\omega_{t}{ }^{3}$\n2. The system to be stabilized is known as \"the plant.\"\n3. Absent any unusual fluctuations in the loop's magnitude response (which should be avoided by design), equation (5.15) has a single (positive) solution, making $\\omega_{\\mathrm{t}}$ unique.\n\nAn alternative graphical representation of the open-loop magnitude and phase response is illustrated in Fig. $5.4(b)$, which is a polar plot of $L(\\omega)=A(\\omega) \\beta$ across all frequencies, $-\\infty<\\omega<\\infty$. At low frequencies where $\\mathrm{L}(\\omega)$ exhibits large magnitude and near-zero phase shift, the polar plot will be distant from the origin along the positive real axis. As $\\omega$ rises to high positive values, the plot spirals clockwise inward toward the origin. For negative values of $\\omega$, the spiral mirrors across the real axis, spiraling counterclockwise from the point at $L(0)$. Given a stable amplifier A, the closed-loop feedback system will also be stable if and only if this polar plot does not encircle the point $-1 .{ }^{4}$ This condition is met as long as the polar plot intersects the unit circle below the real axis for positive frequencies, as shown in Fig. 5.4.\n\nBy definition, the polar plot's intersection with the unit circle occurs at the loop's unity-gain frequency, $\\omega_{\\mathrm{t}}$. Thus, an equivalent stability criterion is\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)>-180^{\\circ} \\tag{5.16}\n\\end{equation*}\n$$\n\nKey Point: The stability of a feedback amplifier can be verified by examining a Bode plot of the loop gain, $\\mathrm{L}(\\omega)$; as long as the phase response exceeds -180 degrees at the unity gain frequency, the feedback system is stable.\n\nIn summary, a feedback amplifier remains stable provided (5.16) is satisfied with $\\omega_{\\mathrm{t}}$ defined by (5.15). This criterion is entirely expressed in terms of the open-loop magnitude and phase response. Therefore, it can be checked simply by inspecting a Bode plot of $L(\\omega)$. There is minimal need for polar plots, and they will be avoided henceforth. Additionally, using the method in Section 5.4.1, the Bode plot can be easily generated through computer simulation.\n\nimage_name:(a)\ndescription:The graph labeled (a) is a Bode plot, comprising two separate plots: one for the magnitude and one for the phase of the loop gain $L(\\omega)$ as a function of frequency $\\omega$. The magnitude plot is at the top, and the phase plot is at the bottom.\n\n1. **Magnitude Plot:**\n- **Axes Labels and Units:**\n- The vertical axis shows the magnitude of the loop gain $|L(\\omega)|$ in decibels (dB).\n- The horizontal axis represents the frequency $\\omega$, typically on a logarithmic scale, though specific units are not indicated.\n- **Overall Behavior and Trends:**\n- The plot begins at a high magnitude at low frequencies and decreases as frequency rises.\n- The magnitude crosses the 0 dB line at a specific frequency, marked as $\\omega_t$, which is the gain crossover frequency.\n\n2. **Phase Plot:**\n- **Axes Labels and Units:**\n- The vertical axis indicates the phase angle $\\angle L(\\omega)$ in degrees.\n- The horizontal axis is the same as the magnitude plot, representing frequency $\\omega$.\n- **Overall Behavior and Trends:**\n- The phase starts at 0 degrees at low frequencies and decreases with increasing frequency.\n- As the frequency nears $\\omega_t$, the phase angle approaches -180 degrees.\n- The phase margin (PM) is shown as the difference between the phase angle at $\\omega_t$ and -180 degrees.\n\n3. **Key Features and Technical Details:**\n- The Bode plot is used to assess the stability of a feedback system by examining the gain and phase margins.\n- The phase margin is a critical stability indicator, representing how close the phase is to reaching -180 degrees when the gain is 0 dB.\n\n4. **Annotations and Specific Data Points:**\n- The plot includes a dashed line at $\\omega_t$, indicating the frequency where the magnitude is 0 dB.\n- The phase margin is explicitly marked on the phase plot as the vertical distance between the phase at $\\omega_t$ and the -180-degree line.\n\nimage_name:(b)\ndescription:The graph labeled (b) is a polar plot showing the loop gain \\( L(\\omega) \\) for a feedback circuit as a function of frequency. This type of graph is used to visualize the stability of feedback systems, particularly in control systems and amplifier design.\n\nAxes and Units:\n- **Axes:** The polar plot lacks traditional Cartesian axes. Instead, it uses a circular coordinate system where the radial distance from the origin represents the magnitude of \\( L(\\omega) \\) and the angle represents the phase.\n- **Units:** The magnitude is typically dimensionless, while the phase is measured in degrees.\n\nOverall Behavior and Trends:\n- The plot traces the trajectory of \\( L(\\omega) \\) as the frequency \\( \\omega \\) varies from negative to positive values.\n- The trajectory starts on the positive real axis at \\( L(0) \\) for \\( \\omega < 0 \\) and loops around the origin.\n- As \\( \\omega \\) increases, the path crosses the negative real axis and continues, indicating phase and magnitude changes.\n\nKey Features and Technical Details:\n- The plot crosses the negative real axis at the point \\(-1\\), which is vital for stability assessment.\n- The phase margin (PM) is shown as the angle between the negative real axis and the point where the trajectory crosses the unit circle.\n- The loop gain \\( L(\\omega) \\) for \\( \\omega > 0 \\) is depicted with a thicker line, highlighting the focus on positive frequencies.\n- The trajectory does not encircle the point \\(-1\\), indicating the feedback system's stability.\n\nAnnotations and Specific Data Points:\n- The plot is annotated with the point \\( L(0) \\) and the phase margin (PM).\n- The dashed circle represents the unit circle, a reference for evaluating gain and phase margins.\n\nThis polar plot, used alongside the Bode plot in part (a), provides a comprehensive view of the system's stability characteristics. The plot's shape and its relationship to the point \\(-1\\) are essential for determining the feedback system's stability across different frequencies.\n\nFig. 5.4 The relationship between (a) a Bode plot and (b) a polar plot of $L(\\omega)$ for a stable feedback circuit.\n\n#### EXAMPLE 5.4\n\nSketch a polar plot of loop gain for the positive-feedback circuit in Fig. 5.3(b).\n\n#### Solution\n\nGiven the positive feedback, when modeled using our negative feedback framework of Fig. 5.1, the loop gain $L=A \\beta$ is negative at low frequencies where the opamp gain is very high. Thus, the plot starts on the negative real axis with a large magnitude. From there, the loop's magnitude response tends to zero at high frequencies, causing the polar plot to spiral into the origin, as depicted in Fig. 5.5. Clearly, it must encircle the point -1, indicating that the loop is unstable."
},
{
    "text": "The techniques used to analyze the stability of analog circuits with feedback differ somewhat from those taught in introductory control theory courses and textbooks. Control theory often addresses the challenge of stabilizing an inherently unstable system through the application of feedback. ${ }^{2}$ In contrast, we will apply feedback to amplifiers A that are already inherently stable. Our goal is to enhance the amplifier's accuracy, bandwidth, and linearity, as detailed in Section 5.1. However, if not carefully managed, feedback can destabilize an amplifier that was previously stable, as illustrated in Example 5.3.\n\nStability can be assessed by ensuring that all poles of the closed-loop system,\n\n$$\n\\begin{equation*}\n\\mathrm{A}_{\\mathrm{CL}}(\\mathrm{~s})=\\frac{\\mathrm{A}(\\mathrm{~s})}{1+\\mathrm{A}(\\mathrm{~s}) \\beta} \\tag{5.12}\n\\end{equation*}\n$$\n\nreside in the left-half plane. Nevertheless, this method is seldom used due to the difficulty in accurately obtaining A(s). Fortunately, stability can be evaluated by analyzing the magnitude and phase of the frequency response $L(\\omega)$, which can be easily obtained through circuit simulation.\n\nIn all scenarios of interest, the amplifier's magnitude response is substantial at low frequencies, $|A(\\omega)| \\gg 1 / \\beta$, and diminishes at high frequencies. The same poles that cause the magnitude response to decrease also introduce negative phase shift at higher frequencies. Additionally, in line with the discussion in Section, we assume that the feedback circuit has a constant and well-controlled gain, $\\beta \\leq 1$. Consequently, the open-loop magnitude response is simply a scaled version of the amplifier's magnitude response,\n\n$$\n\\begin{equation*}\n|L(\\omega)|=|A(\\omega)| \\beta \\tag{5.13}\n\\end{equation*}\n$$\n\nand the open-loop phase response matches that of the amplifier,\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}(\\omega)=\\angle \\mathrm{A}(\\omega)+\\angle \\beta=\\angle \\mathrm{A}(\\omega)+0^{\\circ}=\\angle \\mathrm{A}(\\omega) \\tag{5.14}\n\\end{equation*}\n$$\n\nThe open-loop Bode plot depicted in Fig. 5.4(a) is representative of all the feedback circuits we will examine. Of particular note is the frequency at which the open-loop magnitude response equals unity,\n\n$$\n\\begin{equation*}\n\\left|\\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)\\right|=1 \\tag{5.15}\n\\end{equation*}\n$$\n\nSolving (5.15) yields the loop's \"unity-gain frequency\", $\\omega_{t}{ }^{3}$\n2. The system to be stabilized is known as \"the plant.\"\n3. Absent any unusual fluctuations in the loop's magnitude response (which should be avoided in design), equation (5.15) has a single (positive) solution, making $\\omega_{\\mathrm{t}}$ unique.\n\nAn alternative graphical representation of the open-loop magnitude and phase response is illustrated in Fig. $5.4(b)$, which is a polar plot of $L(\\omega)=A(\\omega) \\beta$ across all frequencies, $-\\infty<\\omega<\\infty$. At low frequencies, where $\\mathrm{L}(\\omega)$ has a large magnitude and near-zero phase shift, the polar plot extends far from the origin along the positive real axis. As $\\omega$ increases to high positive values, the plot spirals clockwise towards the origin. For negative values of $\\omega$, the spiral mirrors across the real axis, spiraling counterclockwise from the point at $L(0)$. Given a stable amplifier A, the closed-loop feedback system will also be stable if and only if this polar plot does not encircle the point $-1 .{ }^{4}$ This condition is met as long as the polar plot intersects the unit circle below the real axis for positive frequencies, as shown in Fig. 5.4.\n\nBy definition, the intersection of the polar plot with the unit circle occurs at the loop's unity-gain frequency, $\\omega_{\\mathrm{t}}$. Thus, an equivalent stability criterion is\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)>-180^{\\circ} \\tag{5.16}\n\\end{equation*}\n$$\n\nKey Point: The stability of a feedback amplifier can be verified by examining a Bode plot of the loop gain, $\\mathrm{L}(\\omega)$; as long as the phase response exceeds -180 degrees at the unity gain frequency, the feedback system is stable.\n\nIn summary, a feedback amplifier remains stable as long as (5.16) is satisfied with $\\omega_{\\mathrm{t}}$ defined by (5.15). This criterion is entirely expressed in terms of the open-loop magnitude and phase response. Therefore, it can be checked simply by inspecting a Bode plot of $L(\\omega)$. There is minimal need for polar plots, which will be avoided henceforth. Additionally, using the method in Section 5.4.1, the Bode plot can be easily generated through computer simulation.\n\nimage_name:(a)\ndescription:The graph labeled (a) is a Bode plot, consisting of two separate plots: one for the magnitude and one for the phase of the loop gain $L(\\omega)$ as a function of frequency $\\omega$. The magnitude plot is at the top, and the phase plot is at the bottom.\n\n1. **Magnitude Plot:**\n- **Axes Labels and Units:**\n- The vertical axis shows the magnitude of the loop gain $|L(\\omega)|$ in decibels (dB).\n- The horizontal axis represents the frequency $\\omega$, typically on a logarithmic scale, though specific units are not indicated.\n- **Overall Behavior and Trends:**\n- The plot begins at a high magnitude at low frequencies and decreases as frequency rises.\n- The magnitude crosses the 0 dB line at a specific frequency, marked as $\\omega_t$, the gain crossover frequency.\n\n2. **Phase Plot:**\n- **Axes Labels and Units:**\n- The vertical axis indicates the phase angle $\\angle L(\\omega)$ in degrees.\n- The horizontal axis is the same as the magnitude plot, showing frequency $\\omega$.\n- **Overall Behavior and Trends:**\n- The phase starts at 0 degrees at low frequencies and decreases with increasing frequency.\n- As the frequency nears $\\omega_t$, the phase angle approaches -180 degrees.\n- The phase margin (PM) is the difference between the phase angle at $\\omega_t$ and -180 degrees.\n\n3. **Key Features and Technical Details:**\n- The Bode plot helps determine the stability of a feedback system by analyzing the gain and phase margins.\n- The phase margin is a critical stability indicator, showing how close the phase is to -180 degrees when the gain is 0 dB.\n\n4. **Annotations and Specific Data Points:**\n- The plot includes a dashed line at $\\omega_t$, marking the frequency where the magnitude is 0 dB.\n- The phase margin is clearly marked on the phase plot as the vertical distance between the phase at $\\omega_t$ and the -180-degree line.\n\nimage_name:(b)\ndescription:The graph labeled (b) is a polar plot showing the loop gain \\( L(\\omega) \\) for a feedback circuit as a function of frequency. This type of graph is used to visualize the stability of feedback systems, particularly in control systems and amplifier design.\n\nAxes and Units:\n- **Axes:** The polar plot lacks traditional Cartesian axes. Instead, it uses a circular coordinate system where the radial distance from the origin represents the magnitude of \\( L(\\omega) \\) and the angle represents the phase.\n- **Units:** The magnitude is typically dimensionless, while the phase is measured in degrees.\n\nOverall Behavior and Trends:\n- The plot traces the trajectory of \\( L(\\omega) \\) as the frequency \\( \\omega \\) varies from negative to positive values.\n- The trajectory starts on the positive real axis at \\( L(0) \\) for \\( \\omega < 0 \\) and loops around the origin.\n- As \\( \\omega \\) increases, the path crosses the negative real axis and continues, indicating phase and magnitude changes.\n\nKey Features and Technical Details:\n- The plot crosses the negative real axis at the point \\(-1\\), crucial for stability assessment.\n- The phase margin (PM) is the angle between the negative real axis and the point where the trajectory crosses the unit circle.\n- The loop gain \\( L(\\omega) \\) for \\( \\omega > 0 \\) is shown with a thicker line, emphasizing positive frequencies.\n- The trajectory does not encircle the point \\(-1\\), indicating the feedback system's stability.\n\nAnnotations and Specific Data Points:\n- The plot is annotated with the point \\( L(0) \\) and the phase margin (PM).\n- The dashed circle represents the unit circle, a reference for assessing gain and phase margins.\n\nThis polar plot, used alongside the Bode plot in part (a), provides a comprehensive view of the system's stability characteristics. The plot's shape and its relation to the point \\(-1\\) are vital for determining the feedback system's stability across different frequencies.\n\nFig. 5.4 The relationship between (a) a Bode plot and (b) a polar plot of $L(\\omega)$ for a stable feedback circuit.\n\n#### EXAMPLE 5.4\n\nSketch a polar plot of loop gain for the positive-feedback circuit in Fig. 5.3(b).\n\n#### Solution\n\nGiven the positive feedback, when modeled using our negative feedback framework in Fig. 5.1, the loop gain $L=A \\beta$ is negative at low frequencies where the opamp gain is very high. Thus, the plot starts on the negative real axis with a large magnitude. As the frequency increases, the loop's magnitude response tends to zero, causing the polar plot to spiral into the origin, as depicted in Fig. 5.5. Clearly, it must encircle the point -1, indicating that the loop is unstable."
},
{
    "text": "The techniques used to analyze the stability of analog circuits with feedback diverge somewhat from those taught in introductory control theory courses and texts. Control theory often addresses the challenge of stabilizing an inherently unstable system through the application of feedback. ${ }^{2}$ In contrast, we will apply feedback to amplifiers A that are already inherently stable. Our goal is to enhance the amplifier's accuracy, bandwidth, and linearity, as outlined in Section 5.1. However, if not handled carefully, feedback can destabilize an amplifier that was previously stable, as illustrated in Example 5.3.\n\nStability can be assessed by ensuring that all poles of the closed-loop system,\n\n$$\n\\begin{equation*}\n\\mathrm{A}_{\\mathrm{CL}}(\\mathrm{~s})=\\frac{\\mathrm{A}(\\mathrm{~s})}{1+\\mathrm{A}(\\mathrm{~s}) \\beta} \\tag{5.12}\n\\end{equation*}\n$$\n\nreside in the left-half plane. Nevertheless, this method is seldom used due to the difficulty in accurately determining A(s). Fortunately, stability can be evaluated using the magnitude and phase of the frequency response $L(\\omega)$, which can be easily obtained through circuit simulation.\n\nIn all scenarios of interest, the amplifier's magnitude response is substantial at low frequencies, $|A(\\omega)| \\gg 1 / \\beta$, and diminishes at high frequencies. The same poles that cause the magnitude response to decline also introduce negative phase shift at higher frequencies. Additionally, following the discussion in Section, we will assume that the feedback circuit has a constant and well-controlled gain, $\\beta \\leq 1$. Consequently, the open-loop magnitude response is simply a scaled version of the amplifier's magnitude response,\n\n$$\n\\begin{equation*}\n|L(\\omega)|=|A(\\omega)| \\beta \\tag{5.13}\n\\end{equation*}\n$$\n\nand the open-loop phase response matches that of the amplifier,\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}(\\omega)=\\angle \\mathrm{A}(\\omega)+\\angle \\beta=\\angle \\mathrm{A}(\\omega)+0^{\\circ}=\\angle \\mathrm{A}(\\omega) \\tag{5.14}\n\\end{equation*}\n$$\n\nThe open-loop Bode plot depicted in Fig. 5.4(a) is representative of all the feedback circuits we will examine. Of particular note is the frequency at which the open-loop magnitude response equals unity,\n\n$$\n\\begin{equation*}\n\\left|\\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)\\right|=1 \\tag{5.15}\n\\end{equation*}\n$$\n\nThe solution to (5.15) is the loop's \"unity-gain frequency\", $\\omega_{t}{ }^{3}$\n2. The system to be stabilized is referred to as \"the plant.\"\n3. Absent any unusual fluctuations in the loop's magnitude response (which should be avoided by design), equation (5.15) has a single (positive) solution, making $\\omega_{\\mathrm{t}}$ unique.\n\nAn alternative graphical representation of the open-loop magnitude and phase response is presented in Fig. $5.4(b)$, which is a polar plot of $L(\\omega)=A(\\omega) \\beta$ across all frequencies, $-\\infty<\\omega<\\infty$. At low frequencies where $\\mathrm{L}(\\omega)$ exhibits a large magnitude and near-zero phase shift, the polar plot will be distant from the origin along the positive real axis. As $\\omega$ rises to high positive values, the plot spirals clockwise towards the origin. For negative $\\omega$ values, the spiral mirrors across the real axis, spiraling counterclockwise from the point at $L(0)$. Given a stable amplifier A, the closed-loop feedback system will also be stable if and only if this polar plot does not encircle the point $-1 .{ }^{4}$ This condition is met as long as the polar plot intersects the unit circle below the real axis for positive frequencies, as shown in Fig. 5.4.\n\nBy definition, the polar plot's intersection with the unit circle occurs at the loop's unity-gain frequency, $\\omega_{\\mathrm{t}}$. Thus, an equivalent stability criterion is\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)>-180^{\\circ} \\tag{5.16}\n\\end{equation*}\n$$\n\nKey Point: The stability of a feedback amplifier can be verified by examining a Bode plot of the loop gain, $\\mathrm{L}(\\omega)$; as long as the phase response exceeds -180 degrees at the unity gain frequency, the feedback system is stable.\n\nIn summary, a feedback amplifier remains stable as long as (5.16) is satisfied with $\\omega_{\\mathrm{t}}$ defined by (5.15). This criterion is entirely expressed in terms of the open-loop magnitude and phase response. Therefore, it can be checked by simply inspecting a Bode plot of $L(\\omega)$. There is minimal need for polar plots, and they will be avoided henceforth. Additionally, using the method in Section 5.4.1, the Bode plot can be easily generated through computer simulation.\n\nimage_name:(a)\ndescription:The graph labeled (a) is a Bode plot, featuring two separate plots: one for the magnitude and one for the phase of the loop gain $L(\\omega)$ as a function of frequency $\\omega$. The magnitude plot is located at the top, while the phase plot is at the bottom.\n\n1. **Magnitude Plot:**\n- **Axes Labels and Units:**\n- The vertical axis shows the magnitude of the loop gain $|L(\\omega)|$ in decibels (dB).\n- The horizontal axis represents the frequency $\\omega$, usually on a logarithmic scale, though specific units are not indicated.\n- **Overall Behavior and Trends:**\n- The plot begins at a high magnitude at low frequencies and decreases as the frequency rises.\n- The magnitude crosses the 0 dB line at a specific frequency, marked as $\\omega_t$, which is the gain crossover frequency.\n\n2. **Phase Plot:**\n- **Axes Labels and Units:**\n- The vertical axis depicts the phase angle $\\angle L(\\omega)$ in degrees.\n- The horizontal axis is the same as the magnitude plot, representing frequency $\\omega$.\n- **Overall Behavior and Trends:**\n- The phase starts at 0 degrees at low frequencies and decreases with increasing frequency.\n- As the frequency nears $\\omega_t$, the phase angle approaches -180 degrees.\n- The phase margin (PM) is indicated as the difference between the phase angle at $\\omega_t$ and -180 degrees.\n\n3. **Key Features and Technical Details:**\n- The Bode plot is used to assess the stability of a feedback system by examining the gain and phase margins.\n- The phase margin is a critical indicator of stability, representing how close the phase is to reaching -180 degrees when the gain is 0 dB.\n\n4. **Annotations and Specific Data Points:**\n- The plot includes a dashed line at $\\omega_t$, indicating the frequency where the magnitude is 0 dB.\n- The phase margin is explicitly marked on the phase plot as the vertical distance between the phase at $\\omega_t$ and the -180-degree line.\n\nimage_name:(b)\ndescription:The graph labeled (b) is a polar plot illustrating the loop gain \\( L(\\omega) \\) for a feedback circuit as a function of frequency. This type of graph is utilized to visualize the stability of feedback systems, particularly in control systems and amplifier design.\n\nAxes and Units:\n- **Axes:** The polar plot lacks traditional Cartesian axes. Instead, it uses a circular coordinate system where the radial distance from the origin represents the magnitude of \\( L(\\omega) \\) and the angle represents the phase.\n- **Units:** The magnitude is typically dimensionless, while the phase is measured in degrees.\n\nOverall Behavior and Trends:\n- The plot shows the trajectory of \\( L(\\omega) \\) as the frequency \\( \\omega \\) varies from negative to positive values.\n- The trajectory starts on the positive real axis at \\( L(0) \\) for \\( \\omega < 0 \\) and loops around the origin.\n- As \\( \\omega \\) increases, the path crosses the negative real axis and continues, indicating changes in phase and magnitude.\n\nKey Features and Technical Details:\n- The plot crosses the negative real axis at the point \\(-1\\), which is vital for stability assessment.\n- The phase margin (PM) is indicated as the angle between the negative real axis and the point where the trajectory crosses the unit circle.\n- The loop gain \\( L(\\omega) \\) for \\( \\omega > 0 \\) is shown with a thicker line, suggesting a focus on positive frequencies.\n- The trajectory does not encircle the point \\(-1\\), indicating the stability of the feedback system.\n\nAnnotations and Specific Data Points:\n- The plot is annotated with the point \\( L(0) \\) and the phase margin (PM).\n- The dashed circle represents the unit circle, a reference for assessing gain and phase margins.\n\nThis polar plot complements the Bode plot shown in part (a) to provide a comprehensive view of the system's stability characteristics. The plot's shape and its relation to the point \\(-1\\) are essential for determining whether the feedback system remains stable across the frequency range.\n\nFig. 5.4 The relationship between (a) a Bode plot and (b) a polar plot of $L(\\omega)$ for a stable feedback circuit.\n\n#### EXAMPLE 5.4\n\nSketch a polar plot of loop gain for the positive-feedback circuit in Fig. 5.3(b).\n\n#### Solution\n\nGiven the positive feedback, when modeled using our negative feedback framework in Fig. 5.1, the loop gain $L=A \\beta$ is negative at low frequencies where the opamp gain is very high. Thus, the plot starts on the negative real axis with a large magnitude. As the frequency increases, the magnitude response of the loop tends to zero, causing the polar plot to spiral into the origin, as depicted in Fig. 5.5. Clearly, it must encircle the point -1, indicating that the loop is unstable."
},
{
    "text": "The techniques used to analyze the stability of analog circuits with feedback differ somewhat from those taught in introductory control theory courses and textbooks. Control theory often addresses the challenge of stabilizing an inherently unstable system through the application of feedback. ${ }^{2}$ In contrast, we will apply feedback to amplifiers A that are already stable on their own. Our goal is to enhance the amplifier's accuracy, bandwidth, and linearity, as detailed in Section 5.1. However, if not properly managed, feedback can cause a previously stable amplifier to become unstable, as illustrated in Example 5.3.\n\nStability can be assessed by ensuring that all poles of the closed-loop system,\n\n$$\n\\begin{equation*}\n\\mathrm{A}_{\\mathrm{CL}}(\\mathrm{~s})=\\frac{\\mathrm{A}(\\mathrm{~s})}{1+\\mathrm{A}(\\mathrm{~s}) \\beta} \\tag{5.12}\n\\end{equation*}\n$$\n\nreside in the left-half plane. Nevertheless, this method is seldom used due to the difficulty in accurately obtaining A(s). Fortunately, stability can be evaluated by analyzing the magnitude and phase of the frequency response $L(\\omega)$, which can be easily obtained through circuit simulation.\n\nIn all scenarios of interest, the amplifier's magnitude response is substantial at low frequencies, $|A(\\omega)| \\gg 1 / \\beta$, and diminishes at high frequencies. The same poles that cause the magnitude response to decrease also introduce negative phase shift at higher frequencies. Additionally, consistent with the discussion in Section, we assume that the feedback circuit has a constant and well-controlled gain, $\\beta \\leq 1$. Consequently, the open-loop magnitude response is simply a scaled version of the amplifier's magnitude response,\n\n$$\n\\begin{equation*}\n|L(\\omega)|=|A(\\omega)| \\beta \\tag{5.13}\n\\end{equation*}\n$$\n\nand the open-loop phase response matches that of the amplifier,\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}(\\omega)=\\angle \\mathrm{A}(\\omega)+\\angle \\beta=\\angle \\mathrm{A}(\\omega)+0^{\\circ}=\\angle \\mathrm{A}(\\omega) \\tag{5.14}\n\\end{equation*}\n$$\n\nThe open-loop Bode plot depicted in Fig. 5.4(a) is representative of all the feedback circuits we will examine. Of particular interest is the frequency at which the open-loop magnitude response equals unity,\n\n$$\n\\begin{equation*}\n\\left|\\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)\\right|=1 \\tag{5.15}\n\\end{equation*}\n$$\n\nSolving (5.15) yields the loop's \"unity-gain frequency\", $\\omega_{t}{ }^{3}$\n2. The system to be stabilized is known as \"the plant.\"\n3. Absent any unusual fluctuations in the loop's magnitude response (which should be avoided by design), equation (5.15) has a single (positive) solution, making $\\omega_{\\mathrm{t}}$ unique.\n\nAn alternative graphical representation of the open-loop magnitude and phase response is presented in Fig. $5.4(b)$, which is a polar plot of $L(\\omega)=A(\\omega) \\beta$ across all frequencies, $-\\infty<\\omega<\\infty$. At low frequencies where $\\mathrm{L}(\\omega)$ has a large magnitude and near-zero phase shift, the polar plot extends far from the origin along the positive real axis. As $\\omega$ increases to high positive values, the plot spirals clockwise towards the origin. For negative values of $\\omega$, the spiral mirrors across the real axis, spiraling counterclockwise from the point at $L(0)$. Given a stable amplifier A, the closed-loop feedback system will also be stable if and only if this polar plot does not encircle the point $-1 .{ }^{4}$ This condition is met as long as the polar plot intersects the unit circle below the real axis for positive frequencies, as shown in Fig. 5.4.\n\nBy definition, the polar plot's intersection with the unit circle occurs at the loop's unity-gain frequency, $\\omega_{\\mathrm{t}}$. Therefore, an equivalent stability criterion is\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)>-180^{\\circ} \\tag{5.16}\n\\end{equation*}\n$$\n\nKey Point: The stability of a feedback amplifier can be verified by examining a Bode plot of the loop gain, $\\mathrm{L}(\\omega)$; as long as the phase response exceeds -180 degrees at the unity gain frequency, the feedback system is stable.\n\nIn summary, a feedback amplifier remains stable as long as (5.16) is satisfied with $\\omega_{\\mathrm{t}}$ defined by (5.15). This criterion is entirely expressed in terms of the open-loop magnitude and phase response. Thus, it can be checked by simply inspecting a Bode plot of $L(\\omega)$. There is minimal need for polar plots, and they will be avoided henceforth. Additionally, using the procedure outlined in Section 5.4.1, the Bode plot can be easily generated through computer simulation.\n\nimage_name:(a)\ndescription:The graph labeled (a) is a Bode plot, featuring two separate plots: one for the magnitude and one for the phase of the loop gain $L(\\omega)$ as a function of frequency $\\omega$. The magnitude plot is positioned at the top, while the phase plot is at the bottom.\n\n1. **Magnitude Plot:**\n- **Axes Labels and Units:**\n- The vertical axis shows the magnitude of the loop gain $|L(\\omega)|$ in decibels (dB).\n- The horizontal axis represents the frequency $\\omega$, typically on a logarithmic scale, though specific units are not indicated.\n- **Overall Behavior and Trends:**\n- The plot starts at a high magnitude at low frequencies and decreases as the frequency rises.\n- The magnitude crosses the 0 dB line at a specific frequency, designated as $\\omega_t$, which is the gain crossover frequency.\n\n2. **Phase Plot:**\n- **Axes Labels and Units:**\n- The vertical axis depicts the phase angle $\\angle L(\\omega)$ in degrees.\n- The horizontal axis is the same as the magnitude plot, representing frequency $\\omega$.\n- **Overall Behavior and Trends:**\n- The phase starts at 0 degrees at low frequencies and decreases as the frequency increases.\n- As the frequency nears $\\omega_t$, the phase angle approaches -180 degrees.\n- The phase margin (PM) is indicated as the difference between the phase angle at $\\omega_t$ and -180 degrees.\n\n3. **Key Features and Technical Details:**\n- The Bode plot is used to assess the stability of a feedback system by examining the gain and phase margins.\n- The phase margin is a critical indicator of stability, representing how far the phase is from reaching -180 degrees when the gain is 0 dB.\n\n4. **Annotations and Specific Data Points:**\n- The plot includes a dashed line at $\\omega_t$, marking the frequency where the magnitude is 0 dB.\n- The phase margin is explicitly marked on the phase plot as the vertical distance between the phase at $\\omega_t$ and the -180-degree line.\n\nimage_name:(b)\ndescription:The graph labeled (b) is a polar plot illustrating the loop gain \\( L(\\omega) \\) for a feedback circuit as a function of frequency. This type of graph is utilized to visualize the stability of feedback systems, particularly in control systems and amplifier design.\n\nAxes and Units:\n- **Axes:** The polar plot lacks traditional Cartesian axes. Instead, it uses a circular coordinate system where the radial distance from the origin represents the magnitude of \\( L(\\omega) \\) and the angle represents the phase.\n- **Units:** The magnitude is typically dimensionless, while the phase is measured in degrees.\n\nOverall Behavior and Trends:\n- The plot shows the trajectory of \\( L(\\omega) \\) as the frequency \\( \\omega \\) varies from negative to positive values.\n- The trajectory starts on the positive real axis at \\( L(0) \\) for \\( \\omega < 0 \\) and loops around the origin.\n- As \\( \\omega \\) increases, the path crosses the negative real axis and continues, indicating changes in phase and magnitude.\n\nKey Features and Technical Details:\n- The plot crosses the negative real axis at the point \\(-1\\), which is essential for stability assessment.\n- The phase margin (PM) is indicated as the angle between the negative real axis and the point where the trajectory crosses the unit circle.\n- The loop gain \\( L(\\omega) \\) for \\( \\omega > 0 \\) is shown with a thicker line, suggesting a focus on positive frequencies.\n- The trajectory does not encircle the point \\(-1\\), indicating the stability of the feedback system.\n\nAnnotations and Specific Data Points:\n- The plot is annotated with the point \\( L(0) \\) and the phase margin (PM).\n- The dashed circle represents the unit circle, a reference for assessing gain and phase margins.\n\nThis polar plot, used alongside the Bode plot in part (a), provides a comprehensive view of the system's stability characteristics. The plot's shape and its relation to the point \\(-1\\) are crucial for determining whether the feedback system remains stable across different frequencies.\n\nFig. 5.4 The relationship between (a) a Bode plot and (b) a polar plot of $L(\\omega)$ for a stable feedback circuit.\n\n#### EXAMPLE 5.4\n\nSketch a polar plot of the loop gain for the positive-feedback circuit in Fig. 5.3(b).\n\n#### Solution\n\nGiven the positive feedback, when modeled using our negative feedback framework in Fig. 5.1, the loop gain $L=A \\beta$ is negative at low frequencies where the opamp gain is very high. Thus, the plot starts on the negative real axis with a large magnitude. As the frequency increases, the magnitude response of the loop tends to zero, causing the polar plot to spiral into the origin, as depicted in Fig. 5.5. Clearly, it must encircle the point -1, indicating that the loop is unstable."
},
{
    "text": "As the name implies, phase margin quantifies how near a specific feedback system is to becoming unstable. Additionally, phase margin offers crucial insights into the closed-loop response of a feedback amplifier.\n\nPhase margin is defined for stable feedback systems as the extra phase shift needed at the unity-gain frequency to induce instability. This definition is visually represented in Fig. 5.4. Analytically, phase margin is expressed as:\n\n$$\n\\begin{equation*}\n\\mathrm{PM} \\equiv \\angle \\mathrm{~L}\\left(\\omega_{\\mathrm{t}}\\right)+180^{\\circ} \\tag{5.17}\n\\end{equation*}\n$$\n\nIt is standard practice to set a minimum phase margin as a fundamental specification in feedback amplifier design. A common misconception among analog design students is that these specifications are solely to prevent instability due to variations in circuit parameters. However, we typically require more phase margin than necessary for mere stability. Instead, phase margins ranging from $45^{\\circ}$ to $90^{\\circ}$ are often needed because systems with smaller phase margins exhibit unwanted dynamic behavior.\n\nimage_name: Fig. 5.5 Polar plot of the loop gain for the case of positive feedback\ndescription: This graph is a polar plot depicting the loop gain of a feedback system under positive feedback conditions. The axes lack specific unit labels but are centered on the complex plane, with the real axis extending horizontally and the imaginary axis vertically.\n\nThe plot includes a distinct loop that surrounds the point marked -1 on the real axis, indicating instability as it fails to meet the Nyquist stability criterion. The loop begins at a point where the loop gain, labeled L(0), is negative at low frequencies, as shown on the negative real axis.\n\nThe graph displays a closed loop that spirals outward and then inward, crossing the real axis multiple times. The encirclement of the -1 point is a key feature, signifying the system's instability under positive feedback conditions.\n\nNo specific numerical values or additional annotations are provided, but a dashed circle around the -1 point serves as a reference for assessing stability. The loop's behavior, particularly its encirclement of the -1 point, suggests the system will likely exhibit poor dynamic behavior due to inadequate phase margin.\n\nFig. 5.5 Polar plot of the loop gain for the case of positive feedback. Given that L is large and negative at low frequencies, the plot inevitably encircles the point -1, indicating the loop is unstable.\n\n#### EXAMPLE 5.5\n\nDerive an expression for the closed-loop gain of a feedback amplifier at the unity gain frequency, $\\omega_{\\mathrm{t}}$, assuming the system has a phase margin $\\theta$.\n\n#### Solution\n\nAt the unity gain frequency, combining (5.15) and (5.17) yields:\n\n$$\n\\begin{gather*}\n\\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)=-\\mathrm{e}^{\\mathrm{j} \\theta}  \\tag{5.18}\\\\\n\\Rightarrow \\mathrm{~A}\\left(\\omega_{\\mathrm{t}}\\right)=\\frac{\\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)}{\\beta}=-\\frac{\\mathrm{e}^{\\mathrm{j} \\theta}}{\\beta} \\tag{5.19}\n\\end{gather*}\n$$\n\nSubstituting (5.18) and (5.19) into (5.6) results in:\n\n$$\n\\begin{equation*}\nA_{C L}\\left(\\omega_{t}\\right)=\\frac{-e^{j \\theta} / \\beta}{1-e^{j \\theta}} \\tag{5.20}\n\\end{equation*}\n$$\n\nTaking the absolute value and noting that $\\left|1-\\mathrm{e}^{\\mathrm{j} \\theta}\\right|=\\sqrt{2(1-\\cos \\theta)}$,\n\n$$\n\\begin{equation*}\n\\left|A_{C L}\\left(\\omega_{t}\\right)\\right|=\\frac{1}{\\beta \\sqrt{2(1-\\cos \\theta)}} \\tag{5.21}\n\\end{equation*}\n$$\n\nIt is evident that for $\\theta<60^{\\circ}$, $\\left|A_{C L}\\left(\\omega_{t}\\right)\\right|>1 / \\beta$. However, it has been demonstrated in (5.9) that the closed-loop gain of such an amplifier at low frequencies is approximately\n\n$$\nA_{C L} \\cong 1 / \\beta\n$$\n\nThus, with a phase margin below $60^{\\circ}$, the closed-loop gain increases as the frequency moves from low values to $\\omega_{t}$. At even higher frequencies, the gain eventually decreases, leading to $A_{c L}(\\omega) \\cong A(\\omega) \\ll(1 / \\beta)$.\n\nKey Point: Merely ensuring an amplifier's stability is insufficient; it must also consistently maintain a large phase margin. To prevent unwanted behavior in the frequency and step responses of the closed-loop amplifier, phase margins of 45 to 90 degrees are typically required.\n\nExample 5.5 shows that the closed-loop frequency response sketch in Fig. 5.2 is accurate only for phase margins exceeding $60^{\\circ}$. Systems with phase margins below $60^{\\circ}$, though still stable, exhibit a closed-loop frequency response as depicted in Fig. 5.6, where peaking occurs around the unity gain frequency. Since the goal is to maintain a constant closed-loop amplifier gain around $1 / \\beta$, such peaking is undesirable and, as subsequent sections will show, is often accompanied by overshoot in the transient step response. Therefore, it is not enough for an amplifier to be merely stable; it must also reliably possess a large phase margin.\n\nimage_name: Fig. 5.6\ndescription: Fig. 5.6 presents a Bode plot of the closed-loop frequency response of a feedback amplifier. The horizontal axis represents frequency (ω), and the vertical axis shows the magnitude, |A(ω)|, on a logarithmic scale, focusing on the amplifier's behavior around its unity gain frequency.\n\n**Axes Labels and Units:**\n- Horizontal Axis (ω): Frequency, generally in radians per second (not explicitly labeled).\n- Vertical Axis (|A(ω)|): Gain magnitude, typically in decibels (dB), though not explicitly indicated.\n\n**Overall Behavior and Trends:**\n- The plot exhibits a typical frequency response with a distinct peak near the unity gain frequency, indicating resonance.\n- At low frequencies, the response is flat with a gain significantly above 1/β.\n- As frequency rises, the magnitude decreases, passing through the unity gain frequency where |A(ω)| = 1/β.\n- The peak occurs just beyond this point, suggesting a phase margin under 60 degrees, which correlates with potential instability or overshoot in transient response.\n- Beyond the peak, the gain continues to decline.\n\n**Key Features and Technical Details:**\n- The unity gain frequency is marked by a vertical dashed line where |A(ω)| = 1/β.\n- The peaking in the response is undesirable for maintaining a stable closed-loop gain around 1/β.\n- The closed-loop gain |A_CL(ω)| is highlighted at the peak, indicating it exceeds the desired value, leading to potential overshoot.\n\n**Annotations and Specific Data Points:**\n- The plot includes annotations illustrating the relationship between the open-loop gain |A(ω)| and the closed-loop gain |A_CL(ω)|.\n- The critical point where |A(ω)| = 1/β is marked, and the graph shows that beyond this frequency, the gain is insufficient to prevent peaking.\n- The closed-loop gain at the peak is noted as being greater than 1/β, which is undesirable for stability.\n\nIn essence, Fig. 5.6's Bode plot illustrates the frequency response of a feedback amplifier with a phase margin below 60 degrees, emphasizing the peaking around the unity gain frequency and the challenges in maintaining a stable closed-loop gain.\n\nFig. 5.6 The closed-loop frequency response of a feedback amplifier with a phase margin less than 60 degrees."
},
{
    "text": "As implied by its name, phase margin quantifies how near a feedback system is to instability. Additionally, it offers the designer crucial insights into the closed-loop behavior of a feedback amplifier.\n\nPhase margin, for stable feedback systems, is defined as the extra phase shift needed at the unity-gain frequency to induce instability. This definition is visually depicted in Fig. 5.4. Analytically, phase margin is expressed as:\n\n$$\n\\begin{equation*}\n\\mathrm{PM} \\equiv \\angle \\mathrm{~L}\\left(\\omega_{\\mathrm{t}}\\right)+180^{\\circ} \\tag{5.17}\n\\end{equation*}\n$$\n\nIt is standard practice to set a minimum phase margin as a fundamental specification in feedback amplifier design. A common misconception among analog design students is that these specifications merely prevent instability due to circuit parameter variations. However, we typically require more phase margin than necessary for mere stability. Instead, phase margins between $45^{\\circ}$ and $90^{\\circ}$ are often needed because smaller phase margins can lead to undesirable dynamic responses.\n\nimage_name:Fig. 5.5 Polar plot of the loop gain for the case of positive feedback\ndescription:The graph is a polar plot showing the loop gain of a feedback system under positive feedback. The axes lack specific units but center on the complex plane, with the real axis horizontal and the imaginary axis vertical.\n\nThe plot displays a distinct loop encircling the point labeled -1 on the real axis, indicating instability as it fails to meet the Nyquist stability criterion. The loop begins at a point where the loop gain, L(0), is negative at low frequencies, marked as L(0) < 0 on the real axis's negative side.\n\nThe graph shows a closed loop that spirals outward and then inward, crossing the real axis multiple times. The -1 point's encirclement is crucial, signifying the system's instability under positive feedback conditions.\n\nNo specific numerical values or extra annotations are provided, but a dashed circle around the -1 point serves as a stability evaluation reference. The loop's behavior, especially its -1 point encirclement, suggests potential for undesirable dynamic behavior due to inadequate phase margin.\n\nFig. 5.5 Polar plot of the loop gain for the case of positive feedback. Given that L is large and negative at low frequencies, the plot inevitably encircles the -1 point, rendering the loop unstable.\n\n#### EXAMPLE 5.5\n\nDerive an expression for the closed-loop gain of a feedback amplifier at the unity gain frequency, $\\omega_{\\mathrm{t}}$, assuming a phase margin $\\theta$.\n\n#### Solution\n\nAt the unity gain frequency, combining (5.15) and (5.17) yields:\n\n$$\n\\begin{gather*}\n\\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)=-\\mathrm{e}^{\\mathrm{j} \\theta}  \\tag{5.18}\\\\\n\\Rightarrow \\mathrm{~A}\\left(\\omega_{\\mathrm{t}}\\right)=\\frac{\\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)}{\\beta}=-\\frac{\\mathrm{e}^{\\mathrm{j} \\theta}}{\\beta} \\tag{5.19}\n\\end{gather*}\n$$\n\nSubstituting (5.18) and (5.19) into (5.6) results in:\n\n$$\n\\begin{equation*}\nA_{C L}\\left(\\omega_{t}\\right)=\\frac{-e^{j \\theta} / \\beta}{1-e^{j \\theta}} \\tag{5.20}\n\\end{equation*}\n$$\n\nTaking the absolute value and noting that $\\left|1-\\mathrm{e}^{\\mathrm{j} \\theta}\\right|=\\sqrt{2(1-\\cos \\theta)}$,\n\n$$\n\\begin{equation*}\n\\left|A_{C L}\\left(\\omega_{t}\\right)\\right|=\\frac{1}{\\beta \\sqrt{2(1-\\cos \\theta)}} \\tag{5.21}\n\\end{equation*}\n$$\n\nNote that for $\\theta<60^{\\circ}$, $\\left|A_{C L}\\left(\\omega_{t}\\right)\\right|>1 / \\beta$. However, it has been demonstrated in (5.9) that the closed-loop gain of such an amplifier at low frequencies is\n\n$$\nA_{C L} \\cong 1 / \\beta\n$$\n\nThus, with a phase margin below $60^{\\circ}$, the closed-loop gain increases from low frequencies to $\\omega_{t}$. At higher frequencies, the gain eventually drops, leading to $A_{c L}(\\omega) \\cong A(\\omega) \\ll(1 / \\beta)$.\n\nKey Point: An amplifier must not only be reliably stable but also possess a substantial phase margin. To prevent undesirable behavior in the frequency and step responses of the closed-loop amplifier, phase margins of 45 to 90 degrees are commonly required.\n\nExample 5.5 shows that the closed-loop frequency response sketch in Fig. 5.2 is accurate only for phase margins exceeding $60^{\\circ}$. Systems with phase margins below $60^{\\circ}$, while still stable, exhibit a closed-loop frequency response as in Fig. 5.6, where peaking occurs around the unity gain frequency. Since we aim for a constant closed-loop amplifier gain around $1 / \\beta$, such peaking is undesirable and, as later sections will discuss, often accompanies overshoot in the transient step response. Therefore, it is crucial for an amplifier to be not only reliably stable but also to have a substantial phase margin.\n\nimage_name:Fig. 5.6\ndescription:Fig. 5.6 presents a Bode plot of the closed-loop frequency response of a feedback amplifier. The horizontal axis represents frequency (ω), and the vertical axis shows the magnitude, |A(ω)|, on a logarithmic scale, focusing on behavior around the unity gain frequency.\n\n**Axes Labels and Units:**\n- Horizontal Axis (ω): Frequency, usually in radians per second (not explicitly labeled).\n- Vertical Axis (|A(ω)|): Gain magnitude, typically in decibels (dB), though not explicitly stated.\n\n**Overall Behavior and Trends:**\n- The plot shows a typical frequency response with a distinct peak near the unity gain frequency, indicating resonance.\n- At low frequencies, the gain is flat and significantly above 1/β.\n- As frequency rises, the magnitude decreases, passing through the unity gain frequency where |A(ω)| = 1/β.\n- The peak occurs just beyond this point, suggesting a phase margin under 60 degrees, which can lead to instability or overshoot.\n- Beyond the peak, the gain continues to fall.\n\n**Key Features and Technical Details:**\n- The unity gain frequency is marked by a vertical dashed line where |A(ω)| = 1/β.\n- The peaking indicates potential instability, making it undesirable for maintaining a stable closed-loop gain.\n- The closed-loop gain |A_CL(ω)| at the peak exceeds the desired value, leading to potential overshoot.\n\n**Annotations and Specific Data Points:**\n- Annotations illustrate the relationship between open-loop gain |A(ω)| and closed-loop gain |A_CL(ω)|.\n- The critical point where |A(ω)| = 1/β is highlighted, showing that beyond this frequency, the gain becomes inadequate for stability without peaking.\n- The closed-loop gain at the peak is noted as being greater than 1/β, which is unstable.\n\nIn summary, Fig. 5.6's Bode plot illustrates the frequency response of a feedback amplifier with a phase margin under 60 degrees, emphasizing the peaking around the unity gain frequency and the challenges in maintaining a stable closed-loop gain.\n\nFig. 5.6 The closed-loop frequency response of a feedback amplifier with a phase margin less than 60 degrees."
},
{
    "text": "As the name implies, phase margin quantifies how near a feedback system is to becoming unstable. Additionally, it offers crucial insights into the closed-loop behavior of a feedback amplifier.\n\nPhase margin, for stable feedback systems, is defined as the extra phase shift needed at the unity-gain frequency to induce instability. This concept is visually depicted in Fig. 5.4. Analytically, phase margin is expressed as:\n\n$$\n\\begin{equation*}\n\\mathrm{PM} \\equiv \\angle \\mathrm{~L}\\left(\\omega_{\\mathrm{t}}\\right)+180^{\\circ} \\tag{5.17}\n\\end{equation*}\n$$\n\nIt is standard practice to set a minimum phase margin as a fundamental design criterion for feedback amplifiers. A common misconception among analog design students is that these specifications merely prevent instability due to variations in circuit parameters. However, we typically require a significantly larger phase margin than what is necessary for mere stability. Instead, phase margins ranging from $45^{\\circ}$ to $90^{\\circ}$ are often needed because systems with smaller phase margins exhibit undesirable dynamic characteristics.\n\nThe graph in question, a polar plot representing the loop gain of a feedback system under positive feedback, centers around the complex plane with the real axis running horizontally and the imaginary axis vertically. The plot features a loop encircling the point labeled -1 on the real axis, indicating instability as it fails to meet the Nyquist stability criterion. The loop starts with L(0) < 0 at low frequencies, marked on the negative real axis. The graph shows a closed loop spiraling outward and inward, crossing the real axis multiple times, with the encirclement of the -1 point highlighting the system's instability under positive feedback. The dashed circle around the -1 point aids in evaluating stability, with the loop's behavior suggesting potential for undesirable dynamics due to insufficient phase margin.\n\nFig. 5.5 Polar plot of the loop gain for positive feedback. Given that L is large and negative at low frequencies, the plot must encircle the point -1, indicating instability.\n\n#### EXAMPLE 5.5\n\nDerive an expression for the closed-loop gain of a feedback amplifier at the unity gain frequency, $\\omega_{\\mathrm{t}}$, assuming a phase margin $\\theta$.\n\n#### Solution\n\nAt the unity gain frequency, combining (5.15) and (5.17) yields:\n\n$$\n\\begin{gather*}\n\\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)=-\\mathrm{e}^{\\mathrm{j} \\theta}  \\tag{5.18}\\\\\n\\Rightarrow \\mathrm{~A}\\left(\\omega_{\\mathrm{t}}\\right)=\\frac{\\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)}{\\beta}=-\\frac{\\mathrm{e}^{\\mathrm{j} \\theta}}{\\beta} \\tag{5.19}\n\\end{gather*}\n$$\n\nSubstituting (5.18) and (5.19) into (5.6) results in:\n\n$$\n\\begin{equation*}\nA_{C L}\\left(\\omega_{t}\\right)=\\frac{-e^{j \\theta} / \\beta}{1-e^{j \\theta}} \\tag{5.20}\n\\end{equation*}\n$$\n\nTaking the absolute value and noting that $\\left|1-\\mathrm{e}^{\\mathrm{j} \\theta}\\right|=\\sqrt{2(1-\\cos \\theta)}$,\n\n$$\n\\begin{equation*}\n\\left|A_{C L}\\left(\\omega_{t}\\right)\\right|=\\frac{1}{\\beta \\sqrt{2(1-\\cos \\theta)}} \\tag{5.21}\n\\end{equation*}\n$$\n\nNote that for $\\theta<60^{\\circ}$, $\\left|A_{C L}\\left(\\omega_{t}\\right)\\right|>1 / \\beta$. However, it has been shown in (5.9) that the closed-loop gain of such an amplifier at low frequencies is approximately\n\n$$\nA_{C L} \\cong 1 / \\beta\n$$\n\nThus, with a phase margin below $60^{\\circ}$, the closed-loop gain increases from low frequencies to $\\omega_{t}$. At higher frequencies, the gain eventually decreases, leading to $A_{c L}(\\omega) \\cong A(\\omega) \\ll(1 / \\beta)$.\n\nKey Point: An amplifier must not only be reliably stable but also possess a substantial phase margin. To prevent undesirable behavior in the frequency and step responses, phase margins of 45 to 90 degrees are typically required.\n\nExample 5.5 shows that the closed-loop frequency response sketch in Fig. 5.2 is accurate only for phase margins exceeding $60^{\\circ}$. Systems with phase margins below $60^{\\circ}$, while still stable, exhibit a closed-loop frequency response as shown in Fig. 5.6, where peaking occurs around the unity gain frequency. Since we aim for a constant closed-loop gain around $1 / \\beta$, such peaking is undesirable and often accompanied by overshoot in the transient step response. Therefore, an amplifier must reliably maintain a large phase margin, not just stability.\n\nThe graph in Fig. 5.6 is a Bode plot depicting the closed-loop frequency response of a feedback amplifier. The horizontal axis represents frequency (ω), and the vertical axis shows magnitude, |A(ω)|, on a logarithmic scale. The plot highlights the amplifier's behavior around its unity gain frequency.\n\n**Axes Labels and Units:**\n- Horizontal Axis (ω): Frequency, typically in radians per second (not explicitly labeled).\n- Vertical Axis (|A(ω)|): Magnitude of the gain, typically in decibels (dB), though not explicitly stated.\n\n**Overall Behavior and Trends:**\n- The plot shows a typical frequency response with a peak around the unity gain frequency, indicating resonant behavior.\n- At low frequencies, the gain is significantly greater than 1/β, represented by a flat region.\n- As frequency increases, the magnitude decreases, passing through the unity gain frequency where |A(ω)| = 1/β.\n- Peaking occurs just past this point, suggesting a phase margin less than 60 degrees, associated with potential instability or overshoot.\n- Beyond the peak, the gain continues to decrease.\n\n**Key Features and Technical Details:**\n- The unity gain frequency is marked by a vertical dashed line where |A(ω)| = 1/β.\n- The peaking in the response is undesirable for maintaining a stable closed-loop gain around 1/β.\n- The closed-loop gain |A_CL(ω)| is emphasized at the peak, indicating it exceeds the desired value, leading to potential overshoot.\n\n**Annotations and Specific Data Points:**\n- Annotations show the relationship between the open-loop gain |A(ω)| and the closed-loop gain |A_CL(ω)|.\n- The point where |A(ω)| = 1/β is critical, and beyond this frequency, the gain becomes insufficient to maintain stability without peaking.\n- The closed-loop gain at the peak is noted as being greater than 1/β, which is undesirable for a stable system.\n\nIn summary, Fig. 5.6 illustrates the frequency response of a feedback amplifier with a phase margin less than 60 degrees, highlighting peaking around the unity gain frequency and the challenges in maintaining a stable closed-loop gain.\n\nFig. 5.6 The closed-loop frequency response of a feedback amplifier with a phase margin less than 60 degrees."
},
{
    "text": "As the name implies, phase margin quantifies how near a feedback system is to instability. Additionally, it offers crucial insights into the closed-loop response of a feedback amplifier.\n\nPhase margin, for stable feedback systems, is defined as the extra phase shift needed at the unity-gain frequency to induce instability. This concept is visually depicted in Fig. 5.4. Analytically, phase margin is expressed as:\n\n$$\n\\begin{equation*}\n\\mathrm{PM} \\equiv \\angle \\mathrm{~L}\\left(\\omega_{\\mathrm{t}}\\right)+180^{\\circ} \\tag{5.17}\n\\end{equation*}\n$$\n\nIt is standard practice to set a minimum phase margin as a fundamental specification in feedback amplifier design. A common misconception among analog design students is that these specifications are solely to prevent instability due to circuit parameter variations. However, we typically require more phase margin than just for ensuring robust stability. Instead, phase margins ranging from $45^{\\circ}$ to $90^{\\circ}$ are often necessary because systems with smaller phase margins exhibit unfavorable dynamic behavior.\n\nimage_name:Fig. 5.5 Polar plot of the loop gain for the case of positive feedback\ndescription:The graph illustrates a polar plot of the loop gain for a feedback system under positive feedback. The plot is centered on the complex plane, with the real axis horizontal and the imaginary axis vertical, though specific units are not labeled.\n\nThe plot features a distinct loop encircling the -1 point on the real axis, indicating instability as it fails to meet the Nyquist stability criterion. The loop begins at a point where the loop gain, L(0), is negative at low frequencies, marked as L(0) < 0 on the real axis's negative side.\n\nThe graph shows a closed loop that spirals outward and then inward, crossing the real axis multiple times. The encirclement of the -1 point is a critical feature, signifying the system's instability under positive feedback conditions.\n\nNo specific numerical values or additional annotations are provided, but a dashed circle around the -1 point serves as a reference for stability evaluation. The loop's behavior, particularly its encirclement of the -1 point, suggests the system will likely exhibit undesirable dynamic behavior due to insufficient phase margin.\n\nFig. 5.5 Polar plot of the loop gain for the case of positive feedback. Given that L is large and negative at low frequencies, the plot inevitably encircles the -1 point, indicating the loop is unstable.\n\n#### EXAMPLE 5.5\n\nDerive an expression for the closed-loop gain of a feedback amplifier at the unity gain frequency, $\\omega_{\\mathrm{t}}$, assuming a phase margin $\\theta$.\n\n#### Solution\n\nAt the unity gain frequency, combining (5.15) and (5.17) yields:\n\n$$\n\\begin{gather*}\n\\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)=-\\mathrm{e}^{\\mathrm{j} \\theta}  \\tag{5.18}\\\\\n\\Rightarrow \\mathrm{~A}\\left(\\omega_{\\mathrm{t}}\\right)=\\frac{\\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)}{\\beta}=-\\frac{\\mathrm{e}^{\\mathrm{j} \\theta}}{\\beta} \\tag{5.19}\n\\end{gather*}\n$$\n\nSubstituting (5.18) and (5.19) into (5.6) results in:\n\n$$\n\\begin{equation*}\nA_{C L}\\left(\\omega_{t}\\right)=\\frac{-e^{j \\theta} / \\beta}{1-e^{j \\theta}} \\tag{5.20}\n\\end{equation*}\n$$\n\nTaking the absolute value and noting that $\\left|1-\\mathrm{e}^{\\mathrm{j} \\theta}\\right|=\\sqrt{2(1-\\cos \\theta)}$,\n\n$$\n\\begin{equation*}\n\\left|A_{C L}\\left(\\omega_{t}\\right)\\right|=\\frac{1}{\\beta \\sqrt{2(1-\\cos \\theta)}} \\tag{5.21}\n\\end{equation*}\n$$\n\nIt is observed that for $\\theta<60^{\\circ},\\left|A_{C L}\\left(\\omega_{t}\\right)\\right|>1 / \\beta$. However, it has been previously shown in (5.9) that the closed-loop gain of such an amplifier at low frequencies is approximately\n\n$$\nA_{C L} \\cong 1 / \\beta\n$$\n\nThus, with a phase margin below $60^{\\circ}$, the closed-loop gain increases from low frequencies up to $\\omega_{t}$. At even higher frequencies, the gain eventually declines, leading to $A_{c L}(\\omega) \\cong A(\\omega) \\ll(1 / \\beta)$.\n\nKey Point: Merely ensuring an amplifier's stability is insufficient; it must also consistently possess a large phase margin. To prevent undesirable behavior in the frequency and step responses of the closed-loop amplifier, phase margins of 45 to 90 degrees are commonly required.\n\nExample 5.5 demonstrates that the closed-loop frequency response sketch in Fig. 5.2 is accurate only for phase margins exceeding $60^{\\circ}$. Systems with phase margins below $60^{\\circ}$, though still stable, exhibit a closed-loop frequency response as shown in Fig. 5.6, where peaking occurs around the unity gain frequency. Since the desired closed-loop gain is around $1 / \\beta$, such peaking is undesirable and, as later sections will show, is often accompanied by overshoot in the transient step response. Therefore, it is not enough for an amplifier to be merely stable; it must also have a reliably large phase margin.\n\nimage_name:Fig. 5.6\ndescription:Fig. 5.6 presents a Bode plot of the closed-loop frequency response of a feedback amplifier. The horizontal axis represents frequency (ω), and the vertical axis shows the magnitude, |A(ω)|, on a logarithmic scale, focusing on behavior around the unity gain frequency.\n\n**Axes Labels and Units:**\n- Horizontal Axis (ω): Frequency, typically in radians per second (not explicitly labeled).\n- Vertical Axis (|A(ω)|): Magnitude of the gain, typically in decibels (dB), though not explicitly stated.\n\n**Overall Behavior and Trends:**\n- The plot shows a typical frequency response with a noticeable peak near the unity gain frequency, indicating resonance.\n- At low frequencies, the gain is significantly greater than 1/β, shown as a flat region.\n- As frequency increases, the magnitude decreases, passing through the unity gain frequency where |A(ω)| = 1/β.\n- The peak occurs just beyond this point, suggesting a phase margin less than 60 degrees, associated with potential instability or overshoot in transient response.\n- Beyond the peak, the gain continues to decline.\n\n**Key Features and Technical Details:**\n- The unity gain frequency is marked by a vertical dashed line where |A(ω)| = 1/β.\n- The peaking is undesirable for maintaining a stable closed-loop gain around 1/β.\n- The closed-loop gain |A_CL(ω)| at the peak exceeds the desired value, leading to potential overshoot.\n\n**Annotations and Specific Data Points:**\n- Annotations illustrate the relationship between the open-loop gain |A(ω)| and the closed-loop gain |A_CL(ω)|.\n- The critical point where |A(ω)| = 1/β is highlighted, showing that beyond this frequency, the gain becomes insufficient to maintain stability without peaking.\n- The closed-loop gain at the peak is noted as being greater than 1/β, which is undesirable for stability.\n\nIn summary, Fig. 5.6's Bode plot illustrates the frequency response of a feedback amplifier with a phase margin less than 60 degrees, emphasizing the peaking around the unity gain frequency and the challenges in maintaining a stable closed-loop gain.\n\nFig. 5.6 The closed-loop frequency response of a feedback amplifier with a phase margin less than 60 degrees."
},
{
    "text": "As its name implies, phase margin quantitatively measures how near a specific feedback system is to becoming unstable. Additionally, phase margin offers crucial insights into the closed-loop response characteristics of a feedback amplifier.\n\nFor stable feedback systems, phase margin is defined as the extra phase shift needed at the unity-gain frequency to induce instability. This definition is visually represented in Fig. 5.4. Analytically, phase margin is expressed as:\n\n$$\n\\begin{equation*}\n\\mathrm{PM} \\equiv \\angle \\mathrm{~L}\\left(\\omega_{\\mathrm{t}}\\right)+180^{\\circ} \\tag{5.17}\n\\end{equation*}\n$$\n\nIt is standard practice to set a minimum phase margin as a fundamental design specification for feedback amplifiers. A common misconception among analog design students is that these specifications are primarily to prevent instability due to variations in circuit parameters. However, we typically require a significantly larger phase margin than necessary for mere stability. Instead, phase margins ranging from $45^{\\circ}$ to $90^{\\circ}$ are often needed because systems with smaller phase margins exhibit unwanted dynamic behaviors.\n\nimage_name:Fig. 5.5 Polar plot of the loop gain for the case of positive feedback\ndescription:The depicted graph is a polar plot showing the loop gain of a feedback system under positive feedback conditions. The axes lack specific unit labels but are centered on the complex plane, with the real axis extending horizontally and the imaginary axis vertically.\n\nThe plot features a distinct loop that surrounds the point marked -1 on the real axis, indicating instability in the feedback loop as it fails to meet the Nyquist stability criterion. The loop originates at a point where the loop gain, denoted L(0), is negative at low frequencies, as indicated by the label L(0) < 0 on the real axis's negative side.\n\nThe graph displays a closed loop that spirals outward and then inward, crossing the real axis at multiple points. The encirclement of the -1 point is a key feature, signifying the system's instability under positive feedback conditions.\n\nNo specific numerical values or additional annotations are provided on the graph, but a dashed circle around the -1 point serves as a reference for assessing system stability. The loop's behavior, particularly its encirclement of the -1 point, suggests a system prone to undesirable dynamic behavior due to inadequate phase margin.\n\nFig. 5.5 Polar plot of the loop gain for the case of positive feedback. Given that L is large and negative at low frequencies, the plot inevitably encircles the -1 point, indicating the loop's instability.\n\n#### EXAMPLE 5.5\n\nDerive an expression for the closed-loop gain of a feedback amplifier at the unity gain frequency, $\\omega_{\\mathrm{t}}$, assuming the system has a phase margin $\\theta$.\n\n#### Solution\n\nAt the unity gain frequency, combining (5.15) and (5.17) results in:\n\n$$\n\\begin{gather*}\n\\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)=-\\mathrm{e}^{\\mathrm{j} \\theta}  \\tag{5.18}\\\\\n\\Rightarrow \\mathrm{~A}\\left(\\omega_{\\mathrm{t}}\\right)=\\frac{\\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)}{\\beta}=-\\frac{\\mathrm{e}^{\\mathrm{j} \\theta}}{\\beta} \\tag{5.19}\n\\end{gather*}\n$$\n\nSubstituting (5.18) and (5.19) into (5.6) gives:\n\n$$\n\\begin{equation*}\nA_{C L}\\left(\\omega_{t}\\right)=\\frac{-e^{j \\theta} / \\beta}{1-e^{j \\theta}} \\tag{5.20}\n\\end{equation*}\n$$\n\nTaking the absolute value and noting that $\\left|1-\\mathrm{e}^{\\mathrm{j} \\theta}\\right|=\\sqrt{2(1-\\cos \\theta)}$,\n\n$$\n\\begin{equation*}\n\\left|A_{C L}\\left(\\omega_{t}\\right)\\right|=\\frac{1}{\\beta \\sqrt{2(1-\\cos \\theta)}} \\tag{5.21}\n\\end{equation*}\n$$\n\nNote that for $\\theta<60^{\\circ},\\left|A_{C L}\\left(\\omega_{t}\\right)\\right|>1 / \\beta$. However, it has been demonstrated in (5.9) that the closed-loop gain of such an amplifier at low frequencies is\n\n$$\nA_{C L} \\cong 1 / \\beta\n$$\n\nThus, with a phase margin below $60^{\\circ}$, the closed-loop gain increases as the frequency moves from low values to $\\omega_{t}$. At even higher frequencies, the gain eventually declines, leading to $A_{c L}(\\omega) \\cong A(\\omega) \\ll(1 / \\beta)$.\n\nKey Point: It is insufficient for an amplifier to merely be stable; it must also consistently possess a large phase margin. To prevent unwanted behavior in the frequency and step responses of the closed-loop amplifier, phase margins of 45 to 90 degrees are typically required.\n\nExample 5.5 indicates that the closed-loop frequency response sketch in Fig. 5.2 is accurate only for phase margins exceeding $60^{\\circ}$. Systems with phase margins below $60^{\\circ}$ but still stable exhibit a closed-loop frequency response as shown in Fig. 5.6, where peaking occurs around the unity gain frequency. Since we aim for the closed-loop amplifier's gain to remain constant at $1 / \\beta$, such peaking is undesirable and, as subsequent sections will show, often accompanied by overshoot in the transient step response. Therefore, it is not enough for an amplifier to be merely stable; it must also reliably maintain a large phase margin.\n\nimage_name:Fig. 5.6\ndescription:Fig. 5.6 presents a Bode plot depicting the closed-loop frequency response of a feedback amplifier. The horizontal axis represents frequency (ω), while the vertical axis shows magnitude, |A(ω)|, on a logarithmic scale, focusing on the amplifier's behavior around its unity gain frequency.\n\n**Axes Labels and Units:**\n- Horizontal Axis (ω): Frequency, usually in radians per second (not explicitly labeled).\n- Vertical Axis (|A(ω)|): Gain magnitude, typically in decibels (dB), though not explicitly indicated.\n\n**Overall Behavior and Trends:**\n- The plot reveals a typical frequency response with a noticeable peak near the unity gain frequency, indicating resonance.\n- At low frequencies, the response starts flat, with gain significantly above 1/β.\n- As frequency rises, the magnitude decreases, passing through the unity gain frequency where |A(ω)| = 1/β.\n- The peak occurs just beyond this point, suggesting a phase margin under 60 degrees, associated with potential instability or overshoot in transient response.\n- Beyond the peak, the gain continues to fall.\n\n**Key Features and Technical Details:**\n- The plot highlights the unity gain frequency with a vertical dashed line where |A(ω)| = 1/β.\n- The peaking in the response is undesirable for maintaining a stable closed-loop gain around 1/β.\n- The closed-loop gain |A_CL(ω)| is emphasized at the peak, indicating it exceeds the desired value, leading to potential overshoot.\n\n**Annotations and Specific Data Points:**\n- The graph includes annotations showing the relationship between the open-loop gain |A(ω)| and the closed-loop gain |A_CL(ω)|.\n- The point where |A(ω)| = 1/β is critical, and the graph shows that beyond this frequency, the gain becomes insufficient to maintain stability without peaking.\n- The closed-loop gain at the peak is noted as being greater than 1/β, which is undesirable for a stable system.\n\nIn summary, Fig. 5.6's Bode plot illustrates the frequency response of a feedback amplifier with a phase margin less than 60 degrees, highlighting peaking around the unity gain frequency and the challenges in maintaining a stable closed-loop gain.\n\nFig. 5.6 The closed-loop frequency response of a feedback amplifier with a phase margin less than 60 degrees."
},
{
    "text": "As the name implies, phase margin quantifies how near a specific feedback system is to instability. Additionally, phase margin offers crucial insights into the closed-loop response of a feedback amplifier.\n\nPhase margin is defined for stable feedback systems as the extra phase shift needed at the unity-gain frequency to induce instability. This definition is graphically depicted in Fig. 5.4. Analytically, phase margin is expressed as\n\n$$\n\\begin{equation*}\n\\mathrm{PM} \\equiv \\angle \\mathrm{~L}\\left(\\omega_{\\mathrm{t}}\\right)+180^{\\circ} \\tag{5.17}\n\\end{equation*}\n$$\n\nIt is standard practice to set a minimum phase margin as a fundamental specification in feedback amplifier design. A common misconception among analog design students is that these specifications are solely to prevent instability due to variations in circuit parameters. However, we typically require a much larger phase margin than needed for mere stability. Instead, phase margins between $45^{\\circ}$ and $90^{\\circ}$ are often necessary because systems with smaller phase margins exhibit undesirable dynamic behavior.\n\nimage_name: Fig. 5.5 Polar plot of the loop gain for the case of positive feedback\ndescription: The graph represents a polar plot of the loop gain in a feedback system with positive feedback. The plot is centered on the complex plane, with the real axis horizontal and the imaginary axis vertical, though specific units are not labeled.\n\nThe plot shows a distinct loop encircling the point -1 on the real axis, indicating instability as it fails to meet the Nyquist stability criterion. The loop begins at a point where the loop gain, L(0), is negative at low frequencies, marked as L(0) < 0 on the negative real axis.\n\nThe graph displays a closed loop that spirals outward and then inward, crossing the real axis multiple times. The encirclement of the -1 point is a critical feature, signifying the system's instability under positive feedback conditions.\n\nNo specific numerical values or additional annotations are provided, but a dashed circle around the -1 point serves as a reference for stability evaluation. The loop's behavior, particularly its encirclement of the -1 point, suggests the system will likely exhibit poor dynamic behavior due to inadequate phase margin.\n\nFig. 5.5 Polar plot of the loop gain for the case of positive feedback. Given that L is large and negative at low frequencies, the plot inevitably encircles the point -1, indicating the loop is unstable.\n\n#### EXAMPLE 5.5\n\nDerive an expression for the closed-loop gain of a feedback amplifier at the unity gain frequency, $\\omega_{\\mathrm{t}}$, assuming the system has a phase margin $\\theta$.\n\n#### Solution\n\nAt the unity gain frequency, combining (5.15) and (5.17) yields\n\n$$\n\\begin{gather*}\n\\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)=-\\mathrm{e}^{\\mathrm{j} \\theta}  \\tag{5.18}\\\\\n\\Rightarrow \\mathrm{~A}\\left(\\omega_{\\mathrm{t}}\\right)=\\frac{\\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)}{\\beta}=-\\frac{\\mathrm{e}^{\\mathrm{j} \\theta}}{\\beta} \\tag{5.19}\n\\end{gather*}\n$$\n\nSubstituting (5.18) and (5.19) into (5.6) results in\n\n$$\n\\begin{equation*}\nA_{C L}\\left(\\omega_{t}\\right)=\\frac{-e^{j \\theta} / \\beta}{1-e^{j \\theta}} \\tag{5.20}\n\\end{equation*}\n$$\n\nTaking the absolute value and noting that $\\left|1-\\mathrm{e}^{\\mathrm{j} \\theta}\\right|=\\sqrt{2(1-\\cos \\theta)}$,\n\n$$\n\\begin{equation*}\n\\left|A_{C L}\\left(\\omega_{t}\\right)\\right|=\\frac{1}{\\beta \\sqrt{2(1-\\cos \\theta)}} \\tag{5.21}\n\\end{equation*}\n$$\n\nNote that for $\\theta<60^{\\circ},\\left|A_{C L}\\left(\\omega_{t}\\right)\\right|>1 / \\beta$. However, it has been shown in (5.9) that the closed-loop gain of such an amplifier at low frequencies is\n\n$$\nA_{C L} \\cong 1 / \\beta\n$$\n\nThus, with a phase margin below $60^{\\circ}$, the closed-loop gain increases from low frequencies to $\\omega_{t}$. At even higher frequencies, the gain eventually decreases, leading to $A_{c L}(\\omega) \\cong A(\\omega) \\ll(1 / \\beta)$.\n\nKey Point: It is insufficient for an amplifier to merely be stable; it must also possess a substantial phase margin. To prevent undesirable behavior in the frequency and step responses of the closed-loop amplifier, phase margins of 45 to 90 degrees are typically required.\n\nExample 5.5 shows that the closed-loop frequency response sketch in Fig. 5.2 is accurate only for phase margins exceeding $60^{\\circ}$. Systems with phase margins below $60^{\\circ}$, though still stable, exhibit a closed-loop frequency response as shown in Fig. 5.6, where peaking occurs around the unity gain frequency. Since the desired closed-loop gain is around $1 / \\beta$, such peaking is undesirable and is often accompanied by overshoot in the transient step response. Therefore, it is not enough for an amplifier to be merely stable; it must also consistently have a large phase margin.\n\nimage_name: Fig. 5.6\ndescription: Fig. 5.6 presents a Bode plot of the closed-loop frequency response of a feedback amplifier. The horizontal axis represents frequency (ω), and the vertical axis shows the magnitude, |A(ω)|, on a logarithmic scale, focusing on the amplifier's behavior around its unity gain frequency.\n\n**Axes Labels and Units:**\n- Horizontal Axis (ω): Frequency, typically in radians per second (not explicitly labeled).\n- Vertical Axis (|A(ω)|): Magnitude of the gain, usually in decibels (dB), though not explicitly stated.\n\n**Overall Behavior and Trends:**\n- The plot exhibits a typical frequency response with a distinct peak near the unity gain frequency, indicating resonant behavior.\n- At low frequencies, the response is flat with a gain significantly greater than 1/β.\n- As frequency increases, the magnitude decreases, passing through the unity gain frequency where |A(ω)| = 1/β.\n- The peak occurs just beyond this point, suggesting a phase margin less than 60 degrees, which can lead to instability or overshoot in the transient response.\n- Beyond the peak, the gain continues to decline.\n\n**Key Features and Technical Details:**\n- The unity gain frequency is marked by a vertical dashed line where |A(ω)| = 1/β.\n- The peaking indicates that the closed-loop gain |A_CL(ω)| exceeds the desired value, leading to potential instability.\n- Annotations highlight the relationship between the open-loop gain |A(ω)| and the closed-loop gain |A_CL(ω)|.\n\n**Annotations and Specific Data Points:**\n- The plot includes annotations showing the critical point where |A(ω)| = 1/β.\n- Beyond this frequency, the gain is insufficient to maintain stability without peaking.\n- The closed-loop gain at the peak is noted as being greater than 1/β, which is undesirable for stability.\n\nIn summary, Fig. 5.6 illustrates the closed-loop frequency response of a feedback amplifier with a phase margin less than 60 degrees, emphasizing the peaking around the unity gain frequency and the challenges in maintaining a stable closed-loop gain.\n\nFig. 5.6 The closed-loop frequency response of a feedback amplifier with a phase margin less than 60 degrees."
},
{
    "text": "As its name implies, phase margin quantifies how near a feedback system is to becoming unstable. Additionally, it offers designers crucial insights into the closed-loop behavior of a feedback amplifier.\n\nPhase margin, for stable feedback systems, is defined as the extra phase shift needed at the unity-gain frequency to induce instability. This concept is visually depicted in Fig. 5.4. Analytically, phase margin is expressed as:\n\n$$\n\\begin{equation*}\n\\mathrm{PM} \\equiv \\angle \\mathrm{~L}\\left(\\omega_{\\mathrm{t}}\\right)+180^{\\circ} \\tag{5.17}\n\\end{equation*}\n$$\n\nIt is standard practice to set a minimum phase margin as a fundamental design specification for feedback amplifiers. A common misconception among analog design students is that these specifications merely prevent instability due to circuit parameter variations. However, we typically require a significantly larger phase margin than needed for mere stability. Instead, phase margins between $45^{\\circ}$ and $90^{\\circ}$ are often necessary because systems with smaller margins exhibit unwanted dynamic characteristics.\n\nimage_name:Fig. 5.5 Polar plot of the loop gain for the case of positive feedback\ndescription:The graph illustrates a polar plot of the loop gain in a positive feedback scenario. The plot is centered on the complex plane with a horizontal real axis and a vertical imaginary axis, both unlabeled.\n\nThe plot features a loop that encircles the point -1 on the real axis, indicating instability as it fails the Nyquist stability criterion. The loop starts at a point where the loop gain, L(0), is negative at low frequencies, marked as L(0) < 0 on the real axis's negative side.\n\nThe graph shows a closed loop that spirals outward and then inward, crossing the real axis multiple times. The encirclement of the -1 point is a key feature, signaling the system's instability under positive feedback conditions.\n\nThe graph lacks specific numerical values or annotations, but a dashed circle around the -1 point serves as a stability reference. The loop's behavior, particularly its encirclement of the -1 point, suggests potential for undesirable dynamic behavior due to insufficient phase margin.\n\nFig. 5.5 Polar plot of the loop gain for the case of positive feedback. Given that L is large and negative at low frequencies, the plot must encircle the -1 point, indicating loop instability.\n\n#### EXAMPLE 5.5\n\nDerive an expression for the closed-loop gain of a feedback amplifier at the unity gain frequency, $\\omega_{\\mathrm{t}}$, assuming a phase margin $\\theta$.\n\n#### Solution\n\nAt the unity gain frequency, combining (5.15) and (5.17) yields:\n\n$$\n\\begin{gather*}\n\\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)=-\\mathrm{e}^{\\mathrm{j} \\theta}  \\tag{5.18}\\\\\n\\Rightarrow \\mathrm{~A}\\left(\\omega_{\\mathrm{t}}\\right)=\\frac{\\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)}{\\beta}=-\\frac{\\mathrm{e}^{\\mathrm{j} \\theta}}{\\beta} \\tag{5.19}\n\\end{gather*}\n$$\n\nSubstituting (5.18) and (5.19) into (5.6) results in:\n\n$$\n\\begin{equation*}\nA_{C L}\\left(\\omega_{t}\\right)=\\frac{-e^{j \\theta} / \\beta}{1-e^{j \\theta}} \\tag{5.20}\n\\end{equation*}\n$$\n\nTaking the absolute value and noting that $\\left|1-\\mathrm{e}^{\\mathrm{j} \\theta}\\right|=\\sqrt{2(1-\\cos \\theta)}$,\n\n$$\n\\begin{equation*}\n\\left|A_{C L}\\left(\\omega_{t}\\right)\\right|=\\frac{1}{\\beta \\sqrt{2(1-\\cos \\theta)}} \\tag{5.21}\n\\end{equation*}\n$$\n\nIt is observed that for $\\theta<60^{\\circ},\\left|A_{C L}\\left(\\omega_{t}\\right)\\right|>1 / \\beta$. However, it has been established in (5.9) that the closed-loop gain of such an amplifier at low frequencies is approximately\n\n$$\nA_{C L} \\cong 1 / \\beta\n$$\n\nThus, with a phase margin below $60^{\\circ}$, the closed-loop gain increases from low frequencies to $\\omega_{t}$. At even higher frequencies, the gain eventually decreases, leading to $A_{c L}(\\omega) \\cong A(\\omega) \\ll(1 / \\beta)$.\n\nKey Point: It is insufficient for an amplifier to merely be stable; it must also possess a substantial phase margin. To prevent undesirable behavior in the frequency and step responses of the closed-loop amplifier, phase margins of 45 to 90 degrees are typically required.\n\nExample 5.5 indicates that the closed-loop frequency response sketch in Fig. 5.2 is accurate only for phase margins exceeding $60^{\\circ}$. Systems with phase margins below $60^{\\circ}$, though stable, exhibit a closed-loop frequency response as shown in Fig. 5.6, where peaking occurs around the unity gain frequency. Since the desired closed-loop gain is around $1 / \\beta$, such peaking is undesirable and often accompanied by overshoot in the transient step response. Therefore, it is not enough for an amplifier to be merely stable; it must also consistently maintain a large phase margin.\n\nimage_name:Fig. 5.6\ndescription:Fig. 5.6 presents a Bode plot of the closed-loop frequency response of a feedback amplifier. The horizontal axis represents frequency (ω), and the vertical axis shows the magnitude, |A(ω)|, on a logarithmic scale, focusing on the amplifier's behavior around its unity gain frequency.\n\n**Axes Labels and Units:**\n- Horizontal Axis (ω): Frequency, typically in radians per second (not explicitly labeled).\n- Vertical Axis (|A(ω)|): Magnitude of the gain, usually in decibels (dB), though not explicitly stated.\n\n**Overall Behavior and Trends:**\n- The plot displays a typical frequency response with a peak near the unity gain frequency, indicating resonance.\n- At low frequencies, the gain is flat and significantly greater than 1/β.\n- As frequency rises, the magnitude decreases, passing through the unity gain frequency where |A(ω)| = 1/β.\n- The peak occurs just beyond this point, suggesting a phase margin less than 60 degrees, which can lead to instability or overshoot in the transient response.\n- Beyond the peak, the gain continues to decline.\n\n**Key Features and Technical Details:**\n- The unity gain frequency is marked by a vertical dashed line where |A(ω)| = 1/β.\n- The peaking is undesirable for maintaining a stable closed-loop gain around 1/β.\n- The closed-loop gain |A_CL(ω)| at the peak exceeds the desired value, leading to potential overshoot.\n\n**Annotations and Specific Data Points:**\n- The plot includes annotations showing the relationship between the open-loop gain |A(ω)| and the closed-loop gain |A_CL(ω)|.\n- The critical point where |A(ω)| = 1/β is highlighted, and the graph indicates that beyond this frequency, the gain becomes inadequate for stability without peaking.\n- The closed-loop gain at the peak is noted as being greater than 1/β, which is undesirable for stability.\n\nIn summary, Fig. 5.6 illustrates the frequency response of a feedback amplifier with a phase margin less than 60 degrees, emphasizing the peaking around the unity gain frequency and the challenges in maintaining a stable closed-loop gain.\n\nFig. 5.6 The closed-loop frequency response of a feedback amplifier with a phase margin less than 60 degrees."
},
{
    "text": "As the term implies, phase margin quantifies how near a specific feedback system is to becoming unstable. Additionally, it offers the designer crucial insights into the closed-loop behavior of a feedback amplifier.\n\nFor stable feedback systems, phase margin is defined as the extra phase shift needed at the unity-gain frequency to induce instability. This concept is visually depicted in Fig. 5.4. Analytically, phase margin is expressed as:\n\n$$\n\\begin{equation*}\n\\mathrm{PM} \\equiv \\angle \\mathrm{~L}\\left(\\omega_{\\mathrm{t}}\\right)+180^{\\circ} \\tag{5.17}\n\\end{equation*}\n$$\n\nIt is standard practice to set a minimum phase margin as a fundamental specification in feedback amplifier design. A common misconception among analog design students is that these specifications are solely to prevent instability due to variations in circuit parameters. However, we typically require a significantly larger phase margin than necessary for mere stability. Instead, phase margins ranging from $45^{\\circ}$ to $90^{\\circ}$ are often needed because systems with smaller margins exhibit unwanted dynamic characteristics.\n\nimage_name:Fig. 5.5 Polar plot of the loop gain for the case of positive feedback\ndescription:The graph illustrates a polar plot of the loop gain for a feedback system under positive feedback conditions. The plot is centered on the complex plane, with a horizontal real axis and a vertical imaginary axis, both unlabeled.\n\nThe plot shows a distinctive loop that encircles the point marked -1 on the real axis, indicating instability as it fails to meet the Nyquist stability criterion. The loop begins at a point where the loop gain, L(0), is negative at low frequencies, as indicated by L(0) < 0 on the negative real axis.\n\nThe graph displays a closed loop that spirals outward and then inward, crossing the real axis multiple times. The encirclement of the -1 point is a key feature, signifying the system's instability under positive feedback conditions.\n\nThe graph lacks specific numerical values or additional annotations, but a dashed circle around the -1 point serves as a reference for assessing stability. The loop's behavior, particularly its encirclement of the -1 point, suggests the system will likely exhibit undesirable dynamic behavior due to insufficient phase margin.\n\nFig. 5.5 Polar plot of the loop gain for the case of positive feedback. Given that L is large and negative at low frequencies, the plot inevitably encircles the point -1, indicating the loop is unstable.\n\n#### EXAMPLE 5.5\n\nDerive an expression for the closed-loop gain of a feedback amplifier at the unity gain frequency, $\\omega_{\\mathrm{t}}$, assuming the system has a phase margin $\\theta$.\n\n#### Solution\n\nAt the unity gain frequency, combining (5.15) and (5.17) yields:\n\n$$\n\\begin{gather*}\n\\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)=-\\mathrm{e}^{\\mathrm{j} \\theta}  \\tag{5.18}\\\\\n\\Rightarrow \\mathrm{~A}\\left(\\omega_{\\mathrm{t}}\\right)=\\frac{\\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)}{\\beta}=-\\frac{\\mathrm{e}^{\\mathrm{j} \\theta}}{\\beta} \\tag{5.19}\n\\end{gather*}\n$$\n\nSubstituting (5.18) and (5.19) into (5.6) results in:\n\n$$\n\\begin{equation*}\nA_{C L}\\left(\\omega_{t}\\right)=\\frac{-e^{j \\theta} / \\beta}{1-e^{j \\theta}} \\tag{5.20}\n\\end{equation*}\n$$\n\nTaking the absolute value and noting that $\\left|1-\\mathrm{e}^{\\mathrm{j} \\theta}\\right|=\\sqrt{2(1-\\cos \\theta)}$,\n\n$$\n\\begin{equation*}\n\\left|A_{C L}\\left(\\omega_{t}\\right)\\right|=\\frac{1}{\\beta \\sqrt{2(1-\\cos \\theta)}} \\tag{5.21}\n\\end{equation*}\n$$\n\nIt is evident that for $\\theta<60^{\\circ},\\left|A_{C L}\\left(\\omega_{t}\\right)\\right|>1 / \\beta$. However, it has been demonstrated in (5.9) that the closed-loop gain of such an amplifier at low frequencies is approximately\n\n$$\nA_{C L} \\cong 1 / \\beta\n$$\n\nThus, with a phase margin below $60^{\\circ}$, the closed-loop gain increases as the frequency moves from low values to $\\omega_{t}$. Naturally, at even higher frequencies, the gain eventually decreases, leading to $A_{c L}(\\omega) \\cong A(\\omega) \\ll(1 / \\beta)$.\n\nKey Point: Merely ensuring an amplifier's stability is insufficient; it must also consistently possess a large phase margin. To prevent undesirable behavior in both frequency and step responses of the closed-loop amplifier, phase margins of 45 to 90 degrees are commonly required.\n\nExample 5.5 indicates that the closed-loop frequency response depicted in Fig. 5.2 is accurate only for phase margins exceeding $60^{\\circ}$. Systems with phase margins below $60^{\\circ}$, yet still stable, exhibit a closed-loop frequency response as shown in Fig. 5.6, where peaking occurs around the unity gain frequency. Since the desired closed-loop gain is around $1 / \\beta$, such peaking is undesirable and, as later sections will discuss, often accompanies overshoot in the transient step response. Therefore, it is crucial that an amplifier not only be reliably stable but also maintain a substantial phase margin.\n\nimage_name:Fig. 5.6\ndescription:Fig. 5.6 presents a Bode plot of the closed-loop frequency response of a feedback amplifier. The horizontal axis represents frequency (ω), and the vertical axis shows the magnitude, |A(ω)|, on a logarithmic scale, focusing on the amplifier's behavior around its unity gain frequency.\n\n**Axes Labels and Units:**\n- Horizontal Axis (ω): Frequency, generally in radians per second (not explicitly labeled).\n- Vertical Axis (|A(ω)|): Magnitude of the gain, usually in decibels (dB), though not explicitly indicated.\n\n**Overall Behavior and Trends:**\n- The plot exhibits a typical frequency response with a distinct peak near the unity gain frequency, indicating resonance.\n- At low frequencies, the response is flat, with the gain significantly above 1/β.\n- As frequency rises, the magnitude decreases, passing through the unity gain frequency where |A(ω)| = 1/β.\n- The peak occurs just beyond this point, suggesting a phase margin under 60 degrees, which can lead to instability or overshoot in transient responses.\n- Beyond the peak, the gain continues to decline.\n\n**Key Features and Technical Details:**\n- The plot highlights the unity gain frequency with a vertical dashed line at |A(ω)| = 1/β.\n- The peaking is undesirable for maintaining a stable closed-loop gain around 1/β.\n- The closed-loop gain |A_CL(ω)| is noted at the peak, indicating it surpasses the desired value, leading to potential overshoot.\n\n**Annotations and Specific Data Points:**\n- The plot includes annotations showing the relationship between the open-loop gain |A(ω)| and the closed-loop gain |A_CL(ω)|.\n- The critical point where |A(ω)| = 1/β is marked, and the graph shows that beyond this frequency, the gain becomes inadequate for stability without peaking.\n- The closed-loop gain at the peak is noted as being greater than 1/β, which is undesirable for stability.\n\nIn essence, Fig. 5.6 illustrates the frequency response of a feedback amplifier with a phase margin below 60 degrees, emphasizing the peaking around the unity gain frequency and the challenges in maintaining a stable closed-loop gain.\n\nFig. 5.6 The closed-loop frequency response of a feedback amplifier with a phase margin less than 60 degrees."
},
{
    "text": "Even though the frequency response of a real amplifier may contain numerous poles and zeros, it is frequently adequate to represent it using a basic first- or second-order transfer function. Accurately grasping the amplifier's response at frequencies $\\omega \\lesssim \\omega_{\\mathrm{t}}$ is crucial, as it influences the amplifier's stability and in-band performance. Consequently, poles and zeros at frequencies $\\omega \\gg \\omega_{\\mathrm{t}}$ can be disregarded. Figure 5.7 illustrates a common scenario where a single pole is predominant. A first-order model is adequate for predicting the behavior of feedback amplifiers when the unity-gain frequency is significantly lower than the second- and higher-order pole- and zero-frequencies, $\\omega_{\\mathrm{t}} \\ll \\omega_{\\mathrm{p} 2}, \\omega_{\\mathrm{p} 3},\\left|\\omega_{\\mathrm{z} 1}\\right|, \\ldots$ A second-order model is more suitable when $\\omega_{\\mathrm{t}}$ is nearer to $\\omega_{\\mathrm{p} 2}, \\omega_{\\mathrm{p} 3}, \\omega_{\\mathrm{z} 1}, \\ldots$ In situations where $\\omega_{\\mathrm{t}}$ exceeds $\\omega_{\\mathrm{p} 2}, \\omega_{\\mathrm{p} 3}, \\omega_{\\mathrm{z} 1}, \\ldots$, even the second-order model lacks sufficient precision. However, such cases offer minimal phase margin and are thus of limited practical concern. This section emphasizes simple first- and second-order models to shed light on the behavior of practical feedback amplifiers, which often resist detailed analytical examination."
},
{
    "text": "Even though the frequency response of a real amplifier might include numerous poles and zeros, it is frequently adequate to represent it using a basic first- or second-order transfer function. It is crucial to precisely comprehend the amplifier's response at frequencies $\\omega \\lesssim \\omega_{\\mathrm{t}}$, as this influences the amplifier's stability and in-band performance. Consequently, poles and zeros at frequencies $\\omega \\gg \\omega_{\\mathrm{t}}$ can be disregarded. Figure 5.7 illustrates a common scenario where a single pole is predominant. A first-order model is adequate for predicting the behavior of feedback amplifiers when the unity-gain frequency is significantly lower than the second- and higher-order pole- and zero-frequencies, $\\omega_{\\mathrm{t}} \\ll \\omega_{\\mathrm{p} 2}, \\omega_{\\mathrm{p} 3}, \\left|\\omega_{\\mathrm{z} 1}\\right|, \\ldots$. The second-order model is more suitable when $\\omega_{\\mathrm{t}}$ is nearer to $\\omega_{\\mathrm{p} 2}, \\omega_{\\mathrm{p} 3}, \\omega_{\\mathrm{z} 1}, \\ldots$. In scenarios where $\\omega_{\\mathrm{t}}$ exceeds $\\omega_{\\mathrm{p} 2}, \\omega_{\\mathrm{p} 3}, \\omega_{\\mathrm{z} 1}, \\ldots$, even the second-order model lacks sufficient precision. However, such cases typically have minimal phase margin and are of limited practical concern. This section concentrates on simple first- and second-order models to offer insights into the behavior of practical feedback amplifiers, which often resist detailed analytical examination."
},
{
    "text": "Even though a practical amplifier's frequency response may encompass numerous poles and zeros, it is frequently adequate to represent it using a basic first- or second-order transfer function. Accurately grasping the amplifier's response at frequencies $\\omega \\lesssim \\omega_{\\mathrm{t}}$ is crucial, as it dictates the amplifier's stability and in-band performance. Consequently, poles and zeros at frequencies $\\omega \\gg \\omega_{\\mathrm{t}}$ can be disregarded. Figure 5.7 illustrates a common scenario where a single pole predominates. A simple first-order model suffices to predict feedback amplifier behavior when the unity-gain frequency is significantly lower than the second- and higher-order pole- and zero-frequencies, $\\omega_{\\mathrm{t}} \\ll \\omega_{\\mathrm{p} 2}, \\omega_{\\mathrm{p} 3},\\left|\\omega_{\\mathrm{z} 1}\\right|, \\ldots$ The second-order model is more appropriate when $\\omega_{\\mathrm{t}}$ is nearer to $\\omega_{\\mathrm{p} 2}, \\omega_{\\mathrm{p} 3}, \\omega_{\\mathrm{z} 1}, \\ldots$ In instances where $\\omega_{\\mathrm{t}}$ exceeds $\\omega_{\\mathrm{p} 2}, \\omega_{\\mathrm{p} 3}, \\omega_{\\mathrm{z} 1}, \\ldots$, even the second-order model lacks sufficient precision. However, such cases offer minimal phase margin and are thus of limited practical concern. This section concentrates on straightforward first- and second-order models to provide insights into the behavior of practical feedback amplifiers, which often resist rigorous analytical approaches."
},
{
    "text": "While a practical amplifier's frequency response may encompass numerous poles and zeros, it is commonly adequate to represent it using a basic first- or second-order transfer function. It is crucial to precisely grasp the amplifier's behavior at frequencies $\\omega \\lesssim \\omega_{\\mathrm{t}}$, as this influences its stability and in-band performance. Consequently, poles and zeros at frequencies $\\omega \\gg \\omega_{\\mathrm{t}}$ can be disregarded. Figure 5.7 illustrates a typical scenario where a single pole predominates. A first-order model is adequate for predicting feedback amplifier behavior when the unity-gain frequency is substantially lower than the second- and higher-order pole- and zero-frequencies, $\\omega_{\\mathrm{t}} \\ll \\omega_{\\mathrm{p} 2}, \\omega_{\\mathrm{p} 3},\\left|\\omega_{\\mathrm{z} 1}\\right|, \\ldots$. A second-order model is more suitable when $\\omega_{\\mathrm{t}}$ is nearer to $\\omega_{\\mathrm{p} 2}, \\omega_{\\mathrm{p} 3}, \\omega_{\\mathrm{z} 1}, \\ldots$. If $\\omega_{\\mathrm{t}}$ exceeds $\\omega_{\\mathrm{p} 2}, \\omega_{\\mathrm{p} 3}, \\omega_{\\mathrm{z} 1}, \\ldots$, even the second-order model lacks sufficient accuracy. However, such cases offer minimal phase margin and are thus of limited practical relevance. This section emphasizes simple first- and second-order models to elucidate the behavior of practical feedback amplifiers, which often resist detailed analytical examination."
},
{
    "text": "Even though a practical amplifier's frequency response may encompass numerous poles and zeros, it is frequently adequate to represent it using a basic first- or second-order transfer function. Crucially, it is essential to precisely comprehend the amplifier's response at frequencies $\\omega \\lesssim \\omega_{\\mathrm{t}}$, as this governs the amplifier's stability and in-band performance. Consequently, poles and zeros at frequencies $\\omega \\gg \\omega_{\\mathrm{t}}$ can be disregarded. Figure 5.7 illustrates a common scenario where a single pole predominates. A straightforward first-order model suffices to anticipate the behavior of feedback amplifiers when the unity-gain frequency is substantially lower than the second- and higher-order pole- and zero-frequencies, $\\omega_{\\mathrm{t}} \\ll \\omega_{\\mathrm{p} 2}, \\omega_{\\mathrm{p} 3}, \\left|\\omega_{\\mathrm{z} 1}\\right|, \\ldots$. The second-order model is more suitable when $\\omega_{\\mathrm{t}}$ is nearer to $\\omega_{\\mathrm{p} 2}, \\omega_{\\mathrm{p} 3}, \\omega_{\\mathrm{z} 1}, \\ldots$. In scenarios where $\\omega_{\\mathrm{t}}$ exceeds $\\omega_{\\mathrm{p} 2}, \\omega_{\\mathrm{p} 3}, \\omega_{\\mathrm{z} 1}, \\ldots$, even the second-order model lacks sufficient precision. However, such cases typically exhibit minimal phase margin and are, thus, of limited practical relevance. This section concentrates on basic first- and second-order models, offering insights into the behavior of practical feedback amplifiers, which often resist comprehensive analytical approaches."
},
{
    "text": "Even though a practical amplifier's frequency response may include numerous poles and zeros, it is frequently adequate to represent it using a basic first- or second-order transfer function. Accurately grasping the amplifier's response at frequencies $\\omega \\lesssim \\omega_{\\mathrm{t}}$ is crucial, as it dictates the amplifier's stability and in-band performance. Consequently, poles and zeros at frequencies $\\omega \\gg \\omega_{\\mathrm{t}}$ can be disregarded. Figure 5.7 illustrates a common scenario where one pole is predominant. A simple first-order model suffices to predict feedback amplifier behavior when the unity-gain frequency is significantly lower than the second- and higher-order pole- and zero-frequencies, $\\omega_{\\mathrm{t}} \\ll \\omega_{\\mathrm{p} 2}, \\omega_{\\mathrm{p} 3}, \\left|\\omega_{\\mathrm{z} 1}\\right|, \\ldots$. The second-order model is more appropriate when $\\omega_{\\mathrm{t}}$ is nearer to $\\omega_{\\mathrm{p} 2}, \\omega_{\\mathrm{p} 3}, \\omega_{\\mathrm{z} 1}, \\ldots$. In situations where $\\omega_{\\mathrm{t}}$ exceeds $\\omega_{\\mathrm{p} 2}, \\omega_{\\mathrm{p} 3}, \\omega_{\\mathrm{z} 1}, \\ldots$, even the second-order model lacks sufficient precision. However, such cases offer minimal phase margin and are thus of limited practical concern. This section concentrates on straightforward first- and second-order models to provide insights into the behavior of practical feedback amplifiers, which often resist detailed analytical examination."
},
{
    "text": "While a practical amplifier's frequency response may encompass numerous poles and zeros, it is frequently adequate to represent it using a basic first- or second-order transfer function. Crucially, comprehending the amplifier's behavior at frequencies $\\omega \\lesssim \\omega_{\\mathrm{t}}$ is vital, as this influences its stability and in-band performance. Consequently, poles and zeros at frequencies $\\omega \\gg \\omega_{\\mathrm{t}}$ can be disregarded. Figure 5.7 illustrates a common scenario where a single pole predominates. A first-order model suffices to forecast the behavior of feedback amplifiers when the unity-gain frequency significantly低于 the second- and higher-order pole- and zero-frequencies, $\\omega_{\\mathrm{t}} \\ll \\omega_{\\mathrm{p} 2}, \\omega_{\\mathrm{p} 3}, \\left|\\omega_{\\mathrm{z} 1}\\right|, \\ldots$. The second-order model is preferable when $\\omega_{\\mathrm{t}}$ is nearer to $\\omega_{\\mathrm{p} 2}, \\omega_{\\mathrm{p} 3}, \\omega_{\\mathrm{z} 1}, \\ldots$. In scenarios where $\\omega_{\\mathrm{t}}$ exceeds $\\omega_{\\mathrm{p} 2}, \\omega_{\\mathrm{p} 3}, \\omega_{\\mathrm{z} 1}, \\ldots$, even the second-order model lacks sufficient precision. However, such cases offer minimal phase margin and are thus of limited practical relevance. This section concentrates on simple first- and second-order models to provide insights into the behavior of practical feedback amplifiers, which often resist rigorous analytical methods."
},
{
    "text": "While a practical amplifier's frequency response may encompass numerous poles and zeros, it can generally be adequately represented by a basic first- or second-order transfer function. It is crucial to precisely comprehend the amplifier's behavior at frequencies $\\omega \\lesssim \\omega_{\\mathrm{t}}$, as this dictates its stability and in-band performance. Consequently, poles and zeros at frequencies $\\omega \\gg \\omega_{\\mathrm{t}}$ can be disregarded. Figure 5.7 illustrates a common scenario where a single pole predominates. A first-order model is adequate for predicting the behavior of feedback amplifiers when the unity-gain frequency is significantly lower than the second- and higher-order pole- and zero-frequencies, $\\omega_{\\mathrm{t}} \\ll \\omega_{\\mathrm{p} 2}, \\omega_{\\mathrm{p} 3}, \\left|\\omega_{\\mathrm{z} 1}\\right|, \\ldots$. A second-order model is more appropriate when $\\omega_{\\mathrm{t}}$ is nearer to $\\omega_{\\mathrm{p} 2}, \\omega_{\\mathrm{p} 3}, \\omega_{\\mathrm{z} 1}, \\ldots$. In instances where $\\omega_{\\mathrm{t}}$ exceeds $\\omega_{\\mathrm{p} 2}, \\omega_{\\mathrm{p} 3}, \\omega_{\\mathrm{z} 1}, \\ldots$, even a second-order model lacks sufficient precision. However, such cases offer minimal phase margin and are thus of limited practical relevance. This section concentrates on straightforward first- and second-order models to elucidate the behavior of practical feedback amplifiers, which often resist detailed analytical scrutiny."
},
{
    "text": "- **Type of Graph:** Bode plot (magnitude response).\n- **Axes Labels and Units:**\n- The vertical axis depicts the transfer function's magnitude, \\(|L(\\omega)|\\), measured in decibels (dB).\n- The horizontal axis represents frequency, \\(\\omega\\), in radians per second, displayed on a logarithmic scale.\n- **Overall Behavior and Trends:**\n- Initially, the graph exhibits a flat response at low frequencies, signifying a constant magnitude.\n- At the primary pole frequency \\(\\omega_{p1}\\), the magnitude starts to decline linearly on a logarithmic scale, indicative of a first-order roll-off.\n- Subsequent poles and zeros (\\(\\omega_{p2}, \\omega_{p3}, \\omega_{z1}, \\ldots\\)) cause further modifications in the slope, illustrated by the dashed lines representing first- and second-order models.\n- **Key Features and Technical Details:**\n- The first-order model demonstrates a solitary linear decline following \\(\\omega_{p1}\\).\n- The second-order model brings in additional slope variations, reflecting the impact of higher-order poles and zeros.\n- **Annotations and Specific Data Points:**\n- The graph highlights significant frequencies such as \\(\\omega_{p1}, \\omega_{p2}, \\omega_{p3}, \\omega_{z1}\\), marking shifts in the response."
},
{
    "text": "- **Graph Type:** Bode plot (magnitude response).\n- **Axis Labels and Units:**\n- The vertical axis depicts the transfer function magnitude, \\(|L(\\omega)|\\), measured in decibels (dB).\n- The horizontal axis denotes frequency, \\(\\omega\\), in radians per second, displayed logarithmically.\n- **General Behavior and Trends:**\n- At low frequencies, the graph exhibits a flat response, indicating consistent magnitude.\n- At the primary pole frequency \\(\\omega_{p1}\\), the magnitude starts to decline linearly on a logarithmic scale, characteristic of a first-order roll-off.\n- Additional poles and zeros (\\(\\omega_{p2}, \\omega_{p3}, \\omega_{z1}, \\ldots\\)) result in further slope variations, illustrated by dashed lines representing first- and second-order models.\n- **Key Characteristics and Technical Aspects:**\n- The first-order model displays a solitary linear drop post \\(\\omega_{p1}\\).\n- The second-order model incorporates extra slope alterations, reflecting the impact of higher-order poles and zeros.\n- **Markings and Specific Data Points:**\n- The graph highlights significant frequencies such as \\(\\omega_{p1}, \\omega_{p2}, \\omega_{p3}, \\omega_{z1}\\), signifying shifts in the response."
},
{
    "text": "- **Type of Graph:** Bode plot (magnitude response).\n- **Axes Labels and Units:**\n- The vertical axis depicts the transfer function's magnitude, \\(|L(\\omega)|\\), measured in decibels (dB).\n- The horizontal axis displays the frequency, \\(\\omega\\), in radians per second, presented on a logarithmic scale.\n- **Overall Behavior and Trends:**\n- Initially, the graph exhibits a flat response at low frequencies, signifying a consistent magnitude.\n- At the dominant pole frequency \\(\\omega_{p1}\\), the magnitude starts to decline linearly on a logarithmic scale, indicating a first-order roll-off.\n- The presence of additional poles and zeros (\\(\\omega_{p2}, \\omega_{p3}, \\omega_{z1}, \\ldots\\)) results in further slope variations, illustrated by dashed lines representing first- and second-order models.\n- **Key Features and Technical Details:**\n- The first-order model demonstrates a single linear decline post \\(\\omega_{p1}\\).\n- The second-order model showcases additional changes in slope, reflecting the impact of higher-order poles and zeros.\n- **Annotations and Specific Data Points:**\n- The graph highlights critical frequencies such as \\(\\omega_{p1}, \\omega_{p2}, \\omega_{p3}, \\omega_{z1}\\), marking shifts in the response."
},
{
    "text": "- **Graph Type:** Bode plot (magnitude response).\n- **Axes Labels and Units:**\n- The vertical axis denotes the transfer function's magnitude, \\(|L(\\omega)|\\), measured in decibels (dB).\n- The horizontal axis displays frequency, \\(\\omega\\), in radians per second, on a logarithmic scale.\n- **General Behavior and Trends:**\n- Initially, the graph exhibits a flat response at low frequencies, signifying a constant magnitude.\n- At the primary pole frequency \\(\\omega_{p1}\\), the magnitude starts to decline linearly on a logarithmic scale, indicating a first-order roll-off.\n- Additional poles and zeros (\\(\\omega_{p2}, \\omega_{p3}, \\omega_{z1}, \\ldots\\)) cause further slope variations, illustrated by dashed lines representing first- and second-order models.\n- **Notable Features and Technical Aspects:**\n- The first-order model displays a single linear decline post \\(\\omega_{p1}\\).\n- The second-order model adds more slope transitions, reflecting the impact of higher-order poles and zeros.\n- **Annotations and Specific Data Points:**\n- The graph highlights crucial frequencies like \\(\\omega_{p1}, \\omega_{p2}, \\omega_{p3}, \\omega_{z1}\\), marking shifts in the response."
},
{
    "text": "- **Graph Type:** Bode plot (magnitude response).\n- **Axis Labels and Units:**\n- The vertical axis depicts the transfer function's magnitude, \\(|L(\\omega)|\\), measured in decibels (dB).\n- The horizontal axis shows frequency, \\(\\omega\\), in radians per second, displayed on a logarithmic scale.\n- **General Behavior and Trends:**\n- At low frequencies, the graph exhibits a flat response, indicating a consistent magnitude.\n- At the primary pole frequency \\(\\omega_{p1}\\), the magnitude starts to decline linearly on a logarithmic scale, characteristic of a first-order roll-off.\n- Subsequent poles and zeros (\\(\\omega_{p2}, \\omega_{p3}, \\omega_{z1}, \\ldots\\)) cause further slope variations, illustrated by the dashed lines representing first- and second-order models.\n- **Notable Features and Technical Aspects:**\n- The first-order model displays a single linear decline post \\(\\omega_{p1}\\).\n- The second-order model adds more slope transitions, reflecting the impact of higher-order poles and zeros.\n- **Labels and Specific Data Points:**\n- The graph highlights crucial frequencies like \\(\\omega_{p1}, \\omega_{p2}, \\omega_{p3}, \\omega_{z1}\\), marking shifts in the response."
},
{
    "text": "- **Graph Type:** Bode plot (magnitude response).\n- **Axis Labels and Units:**\n- The vertical axis denotes the transfer function's magnitude, \\(|L(\\omega)|\\), measured in decibels (dB).\n- The horizontal axis displays frequency, \\(\\omega\\), in radians per second, presented on a logarithmic scale.\n- **General Behavior and Trends:**\n- Initially, the graph exhibits a flat response at low frequencies, suggesting a consistent magnitude.\n- At the primary pole frequency \\(\\omega_{p1}\\), the magnitude starts to decline linearly on a logarithmic scale, indicating a first-order decline.\n- Further poles and zeros (\\(\\omega_{p2}, \\omega_{p3}, \\omega_{z1}, \\ldots\\)) cause additional slope variations, illustrated by the dashed lines representing first- and second-order models.\n- **Key Characteristics and Technical Aspects:**\n- The first-order model exhibits a single linear drop post \\(\\omega_{p1}\\).\n- The second-order model introduces extra slope modifications, reflecting the impact of higher-order poles and zeros.\n- **Annotations and Specific Data Points:**\n- The graph highlights crucial frequencies like \\(\\omega_{p1}, \\omega_{p2}, \\omega_{p3}, \\omega_{z1}\\), marking shifts in the response."
},
{
    "text": "- **Graph Type:** Bode plot (magnitude response).\n- **Axis Labels and Units:**\n- The vertical axis depicts the transfer function magnitude, \\(|L(\\omega)|\\), measured in decibels (dB).\n- The horizontal axis denotes frequency, \\(\\omega\\), in radians per second, presented on a logarithmic scale.\n- **General Behavior and Trends:**\n- Initially, the graph exhibits a flat response at low frequencies, reflecting a constant magnitude.\n- At the primary pole frequency \\(\\omega_{p1}\\), the magnitude starts to decline linearly on a logarithmic scale, indicative of a first-order roll-off.\n- Subsequent poles and zeros (\\(\\omega_{p2}, \\omega_{p3}, \\omega_{z1}, \\ldots\\)) result in additional slope variations, illustrated by dashed lines representing first- and second-order models.\n- **Notable Features and Technical Aspects:**\n- The first-order model displays a solitary linear decline post \\(\\omega_{p1}\\).\n- The second-order model incorporates extra slope alterations, mirroring the impact of higher-order poles and zeros.\n- **Annotations and Specific Data Points:**\n- The graph highlights crucial frequencies like \\(\\omega_{p1}, \\omega_{p2}, \\omega_{p3}, \\omega_{z1}\\), signifying shifts in the response."
},
{
    "text": "- **Graph Type:** Bode plot (magnitude response).\n- **Axes Labels and Units:**\n- The vertical axis depicts the transfer function magnitude, \\(|L(\\omega)|\\), measured in decibels (dB).\n- The horizontal axis represents frequency, \\(\\omega\\), in radians per second, displayed on a logarithmic scale.\n- **General Behavior and Trends:**\n- Initially, the graph exhibits a flat response at low frequencies, signifying a consistent magnitude.\n- At the primary pole frequency \\(\\omega_{p1}\\), the magnitude starts to decline linearly on a logarithmic scale, indicating a first-order roll-off.\n- Additional poles and zeros (\\(\\omega_{p2}, \\omega_{p3}, \\omega_{z1}, \\ldots\\)) cause further slope variations, illustrated by the dashed lines that represent first- and second-order models.\n- **Key Characteristics and Technical Aspects:**\n- The first-order model displays a single linear decline following \\(\\omega_{p1}\\).\n- The second-order model adds more slope modifications, reflecting the impact of higher-order poles and zeros.\n- **Annotations and Specific Data Points:**\n- The graph highlights crucial frequencies such as \\(\\omega_{p1}, \\omega_{p2}, \\omega_{p3}, \\omega_{z1}\\), marking shifts in the response."
},
{
    "text": "- **Graph Type:** Bode plot (phase response).\n- **Axis Labels and Units:**\n- The vertical axis depicts the phase angle, \\(\\angle L(\\omega)\\), measured in degrees.\n- The horizontal axis represents the frequency, \\(\\omega\\), in radians per second, plotted on a logarithmic scale.\n- **General Behavior and Trends:**\n- The phase initiates near 0 degrees at low frequencies.\n- As the frequency surpasses \\(\\omega_{p1}\\), the phase begins to decline.\n- The first-order model exhibits a phase shift nearing -90 degrees.\n- The second-order model displays a more intricate phase shift, approaching -180 degrees as additional poles and zeros are considered.\n- **Key Characteristics and Technical Aspects:**\n- The first-order model exhibits a straightforward phase transition, whereas the second-order model reflects the collective impact of multiple poles and zeros.\n- **Annotations and Specific Data Points:**\n- The graph includes reference lines at -90 degrees and -180 degrees to emphasize the phase margin and stability considerations.\n\nFig. 5.7 Illustrative feedback amplifier open-loop frequency response and corresponding first- and second-order models.\n\nGiven that only one pole contributes to the phase shift, the phase response of a first-order system never falls below $-90^{\\circ}$. L,\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}(\\omega)>-90^{\\circ} \\tag{5.23}\n\\end{equation*}\n$$\n\nKey Point: A first-order feedback amplifier exhibits unconditional stability with approximately 90 degrees of phase margin.\n\nBy combining (5.23) with the stability criteria in (5.16) and the definition of phase margin in (5.17), it is evident that a first-order feedback system maintains stability with at least $90^{\\circ}$ phase margin. The Bode plot in Fig. 5.8(a) clearly shows that for substantial dc open-loop gain, $L_{0}$, the phase margin will be very close to $90^{\\circ}$. Moreover, the polar plot of $L(\\omega)$ for a negative feedback system with a single pole cannot encircle the point -1, as depicted in Fig. $5.8(b)$. Consequently, first-order feedback systems are stable with $90^{\\circ}$ phase margin regardless of the dc gain or pole frequency, unlike second- and higher-order loops where phase margin critically depends on the feedback factor, $\\beta$, dc gain, and pole frequencies.\n\nRecall the unity-gain frequency $\\omega_{\\mathrm{t}}$, which is the frequency at which $\\left|L\\left(\\omega_{\\mathrm{t}}\\right)\\right|=1$. We derive the following approximation, assuming $\\omega_{\\mathrm{t}} \\gg>\\omega_{\\mathrm{p} 1}$ :\n\n$$\n\\begin{equation*}\n\\left|\\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)\\right|=1 \\cong \\frac{\\mathrm{~L}_{0}}{\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{p} 1}} \\tag{5.24}\n\\end{equation*}\n$$\n\nimage_name:(a)\ndescription:The graph labeled \"(a)\" is a Bode plot representing the frequency response of a first-order feedback system. It comprises two subplots: one for the magnitude of the open-loop transfer function \\( |L(\\omega)| \\) in decibels (dB), and the other for the phase \\( \\angle L(\\omega) \\) in degrees.\n\n1. **Magnitude Plot:**\n- **Y-Axis:** Indicates the magnitude \\( |L(\\omega)| \\) in dB.\n- **X-Axis:** Shows the frequency \\( \\omega \\) on a logarithmic scale.\n- The plot starts at a high magnitude \\( L_0 \\) and decreases linearly with frequency, indicating a slope of -20 dB/decade post the pole frequency \\( \\omega_{p1} \\).\n- The magnitude intersects the 0 dB line at the unity-gain frequency \\( \\omega_{t} \\).\n\n2. **Phase Plot:**\n- **Y-Axis:** Represents the phase \\( \\angle L(\\omega) \\) in degrees.\n- **X-Axis:** Displays the frequency \\( \\omega \\) on a logarithmic scale.\n- The phase starts at 0° and gradually decreases, approaching -180° as frequency rises.\n- The phase margin is indicated to be greater than 90°, signifying the system's stability.\n\n3. **Notable Features:**\n- The pole frequency \\( \\omega_{p1} \\) is marked on both plots, indicating where the slope changes in the magnitude plot and where the phase begins to drop significantly.\n- The unity-gain frequency \\( \\omega_{t} \\) is also marked, where the magnitude crosses 0 dB.\n- The phase margin (PM) is highlighted, showing it exceeds 90°, indicating unconditional stability.\n\nThis Bode plot effectively illustrates how the system's gain and phase vary with frequency, demonstrating the unconditional stability and adequate phase margin of the first-order feedback system.\n\nimage_name:(b)\ndescription:### Graph Type and Function:\nThe graph labeled \"(b)\" is a polar plot depicting the open-loop frequency response of a first-order feedback system. This graph type is utilized to illustrate stability and phase margin in control systems.\n\nAxes Labels and Units:\nThe polar plot lacks conventional axes like Cartesian plots. Instead, it represents complex plane coordinates with real and imaginary components. The plot is centered at the origin, with the real axis extending horizontally and the imaginary axis vertically.\n\nOverall Behavior and Trends:\nThe plot shows a loop starting from the point labeled \\(L(0)\\) on the positive real axis and looping around the origin. The trajectory of \\(L(\\omega)\\) for \\(\\omega > 0\\) is depicted in black, while the trajectory for \\(\\omega < 0\\) is shown in gray. The loop passes near the point \\(-1\\) on the real axis, a critical point for stability analysis.\n\nKey Features and Technical Details:\n- The loop does not encircle the \\(-1\\) point, indicating unconditional stability.\n- The trajectory suggests a phase margin greater than \\(90^\\circ\\), a favorable condition for stability in feedback systems.\n- A dashed circle around the origin represents a reference magnitude, typically used to evaluate the gain margin.\n\nAnnotations and Specific Data Points:\n- The point \\(L(0)\\) is marked on the positive real axis, denoting the starting point of the frequency response.\n- The critical point \\(-1\\) is marked on the real axis, serving as a reference for stability assessment.\n- The phase margin (PM) is not explicitly labeled on the polar plot but is inferred to be greater than \\(90^\\circ\\) based on the loop's position relative to the \\(-1\\) point.\n\nFig. 5.8 Graphical representation of the unconditional stability and $90^{\\circ}$ phase margin of first-order feedback systems: (a) Bode plot and (b) polar plot of open-loop frequency response, L( $\\omega$ ).\n\nThus, we derive the following significant relationship for this first-order model:\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{t}} \\cong \\mathrm{~L}_{0} \\omega_{\\mathrm{p} 1} \\tag{5.25}\n\\end{equation*}\n$$\n\nSubstituting (5.25) into (5.22) for scenarios where $\\omega \\gg \\omega_{\\mathrm{pl}}$, we obtain at midband frequencies:\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s}) \\cong \\frac{\\omega_{\\mathrm{t}}}{\\mathrm{~s}} \\tag{5.26}\n\\end{equation*}\n$$\n\nThe relationship (5.26) represents a simplified first-order model assuming infinite dc gain, and hence, it is not accurate at low frequencies. However, it is useful for analyzing the system at midband frequencies, $\\omega_{\\mathrm{p} 1}<<\\omega<\\omega_{\\mathrm{t}}$, including estimating the closed-loop circuit's -3 dB frequency and settling time.\n\nAt midband frequencies, the transfer function of the closed-loop amplifier can be determined by substituting (5.26) into (5.8), resulting in:\n\n$$\n\\begin{equation*}\nA_{C L}(s) \\cong \\frac{1}{\\beta} \\frac{1}{\\left(1+s / \\omega_{t}\\right)} \\tag{5.27}\n\\end{equation*}\n$$\n\nAs anticipated, the closed-loop amplifier exhibits a low-frequency gain approximately equal to $1 / \\beta$. The -3 dB frequency of the closed-loop amplifier is given by:\n\n$$\n\\begin{equation*}\n\\omega_{-3 \\mathrm{~dB}} \\cong \\omega_{\\mathrm{t}} \\tag{5.28}\n\\end{equation*}\n$$\n\nFurthermore, from (5.27), we recognize that the closed-loop amplifier is a first-order system with a time-constant, $\\tau$, defined as:\n\n$$\n\\begin{equation*}\n\\tau=\\frac{1}{\\omega_{-3 \\mathrm{~dB}}}=\\frac{1}{\\omega_{t}} \\tag{5.29}\n\\end{equation*}\n$$\n\nThe settling-time performance of integrated amplifiers is often a critical design parameter. For instance, in switched-capacitor circuits, the charge from one or more capacitors must be largely transferred to a feedback capacitor within about half a clock period. This charge transfer is closely linked to the opamp's step response. Consequently, the settling time is defined as the time required for an opamp to reach a specified percentage of its final value following a step input.\n\nRecall that the step response of any first-order circuit is described by:\n\n$$\n\\begin{equation*}\n\\mathrm{V}_{\\text {out }}(\\mathrm{t})=\\mathrm{V}_{\\text {step }}\\left(1-\\mathrm{e}^{-\\mathrm{t} / \\tau}\\right) \\tag{5.30}\n\\end{equation*}\n$$\n\nHere, $\\mathrm{V}_{\\text {step }}$ denotes the magnitude of the voltage step. Using this exponential relationship, the time required for the first-order closed-loop circuit to settle to a specified accuracy can be determined. For instance, if $1 \\%$ accuracy is required, then $\\mathrm{e}^{-\\mathrm{t} / \\tau}$ must reach 0.01, which occurs at $\\mathrm{t}=4.6 \\tau$. For $0.1 \\%$ accuracy, the settling time required is approximately $7 \\tau$. Additionally, note that immediately after the step input, the output slope will be at its maximum, given by:\n\n$$\n\\begin{equation*}\n\\left.\\frac{d}{d t} v_{\\text {out }}(t)\\right|_{t=0}=\\frac{V_{\\text {step }}}{\\tau} \\tag{5.31}\n\\end{equation*}\n$$\n\nKey Point: The closed-loop bandwidth of a feedback amplifier is $\\omega_{\\mathrm{t}}$, independent of the amplifier's 3-dB bandwidth, $\\omega_{\\mathrm{p} 1}$. The settling time is $1 / \\omega_{\\mathrm{t}}$\n\nSince a real amplifier has a finite current capability to charge the parasitic capacitances at $\\mathrm{v}_{\\text {out }}$, in many practical scenarios for large steps $\\mathrm{V}_{\\text {step }}$, the amplifier may be unable to change the output voltage at the rate predicted by (5.31). In such cases, the amplifier deviates from linear behavior, and the model's predictions become invalid.\n\n#### EXAMPLE 5.6\n\nA phase of a switched-capacitor circuit is depicted in Fig. 5.9, where the input signal can be modeled as a voltage step requiring $0.1 \\%$ accuracy in $0.1 \\mu \\mathrm{~s}$. Assuming linear settling, determine the required unity-gain frequency in terms of the capacitance values, $C_{1}$ and $C_{2}$. For $C_{2}=10 C_{1}$, calculate the necessary unity-gain frequency of the opamp. What unity-gain frequency is needed if $\\mathrm{C}_{2}=0.2 \\mathrm{C}_{1}$ ?\n\n#### Solution\n\nFirst, note that a capacitive feedback network is employed instead of a resistive one. A potential issue with this network in a nonswitched circuit is the inability of bias current to flow into the negative opamp input terminal. However, in a switched CMOS opamp circuit, this configuration exists only briefly and does not pose any issues. Second, assume the opamp has a dominant pole response with unity gain frequency $\\omega_{\\mathrm{ta}}$ (distinct from the unity gain frequency of $L(s)$, denoted as $\\omega_{t}$) and a large dc gain. Thus, its midband frequency response is adequately approximated by $s / \\omega_{\\mathrm{ta}}$. The open-loop response, $L(s)$, is derived from this opamp response driving the capacitive feedback network, as illustrated in Fig. 5.9(b).\n\n$$\n\\begin{equation*}\nL(s) \\cong\\left(\\frac{s}{\\omega_{\\mathrm{ta}}}\\right)\\left(\\frac{\\mathrm{C}_{2}}{\\mathrm{C}_{1}+\\mathrm{C}_{2}}\\right) \\tag{5.32}\n\\end{equation*}\n$$\n\nThe unity gain frequency of $L(s)$ is determined by substituting (5.32) into (5.15) and solving for $\\omega_{\\mathrm{t}}=\\omega_{\\mathrm{ta}} \\mathrm{C}_{2} /\\left(\\mathrm{C}_{1}+\\mathrm{C}_{2}\\right)$. For $7 \\tau$ settling within $0.1 \\mu \\mathrm{~s}$, $\\tau$ must be less than 14.2 ns. Since $\\tau=1 / \\omega_{\\mathrm{t}}$,\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{ta}} \\geq\\left(\\frac{\\mathrm{C}_{1}+\\mathrm{C}_{2}}{\\mathrm{C}_{2}}\\right)\\left(\\frac{1}{14.2 \\mathrm{~ns}}\\right) \\tag{5.33}\n\\end{equation*}\n$$\n\nFor $\\mathrm{C}_{2}=10 \\mathrm{C}_{1}$, a unity-gain frequency of $2 \\pi \\cdot 12.3 \\mathrm{MHz}$ is required, whereas for $\\mathrm{C}_{2}=0.2 \\mathrm{C}_{1}$, $\\omega_{\\mathrm{ta}}$ should exceed $2 \\pi \\cdot 66.8 \\mathrm{MHz}$.\n\nThe unconditional stability, predictable bandwidth, and predictable settling time of first-order systems are compelling reasons to ensure feedback circuits have a dominant pole, thereby allowing them to be approximated by the single-pole model in (5.22)."
},
{
    "text": "- **Graph Type:** Bode plot (phase response).\n- **Axes Labels and Units:**\n- The vertical axis depicts the phase angle, \\(\\angle L(\\omega)\\), measured in degrees.\n- The horizontal axis represents frequency, \\(\\omega\\), in radians per second, plotted on a logarithmic scale.\n- **General Behavior and Trends:**\n- At low frequencies, the phase begins near 0 degrees.\n- As the frequency surpasses \\(\\omega_{p1}\\), the phase starts to decline.\n- The first-order model exhibits a phase shift nearing -90 degrees.\n- The second-order model displays a more intricate phase shift, approaching -180 degrees as additional poles and zeros are considered.\n- **Key Features and Technical Aspects:**\n- The first-order model exhibits a straightforward phase transition, whereas the second-order model reflects the combined impacts of multiple poles and zeros.\n- **Annotations and Specific Data Points:**\n- The graph includes reference lines at -90 degrees and -180 degrees to emphasize phase margin and stability considerations.\n\nFig. 5.7 Typical feedback amplifier open-loop frequency response and corresponding first- and second-order models.\n\nGiven that only one pole contributes to the phase shift, the phase response of a first-order system never falls below $-90^{\\circ}$. L,\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}(\\omega)>-90^{\\circ} \\tag{5.23}\n\\end{equation*}\n$$\n\nKey Point: A first-order feedback amplifier is inherently stable with approximately 90 degrees of phase margin.\n\nBy combining (5.23) with the stability criteria in (5.16) and the definition of phase margin in (5.17), it is evident that a first-order feedback system remains stable with at least $90^{\\circ}$ phase margin. The Bode plot in Fig. 5.8(a) clearly shows that for high dc open-loop gain, $L_{0}$, the phase margin is nearly $90^{\\circ}$. Furthermore, the polar plot of $L(\\omega)$ for a negative feedback system with a single pole cannot encircle the point -1, as depicted in Fig. $5.8(b)$. Thus, first-order feedback systems maintain stability with $90^{\\circ}$ phase margin regardless of the dc gain or pole frequency, unlike higher-order loops where phase margin critically depends on the feedback factor, $\\beta$, dc gain, and pole frequencies.\n\nRecall the unity-gain frequency $\\omega_{\\mathrm{t}}$, which is the frequency at which $\\left|L\\left(\\omega_{\\mathrm{t}}\\right)\\right|=1$. We then derive the following approximation, assuming $\\omega_{\\mathrm{t}} \\gg>\\omega_{\\mathrm{p} 1}$ :\n\n$$\n\\begin{equation*}\n\\left|\\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)\\right|=1 \\cong \\frac{\\mathrm{~L}_{0}}{\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{p} 1}} \\tag{5.24}\n\\end{equation*}\n$$\n\nimage_name:(a)\ndescription:The graph labeled \"(a)\" is a Bode plot representing the frequency response of a first-order feedback system. It comprises two subplots: one for the magnitude of the open-loop transfer function \\( |L(\\omega)| \\) in decibels (dB), and the other for the phase \\( \\angle L(\\omega) \\) in degrees.\n\n1. **Magnitude Plot:**\n- **Y-Axis:** Represents the magnitude \\( |L(\\omega)| \\) in dB.\n- **X-Axis:** Represents the frequency \\( \\omega \\) on a logarithmic scale.\n- The plot initiates at a high magnitude \\( L_0 \\) and decreases linearly with frequency, indicating a slope of -20 dB/decade post the pole frequency \\( \\omega_{p1} \\).\n- The magnitude intersects the 0 dB line at the unity-gain frequency \\( \\omega_{t} \\).\n\n2. **Phase Plot:**\n- **Y-Axis:** Represents the phase \\( \\angle L(\\omega) \\) in degrees.\n- **X-Axis:** Represents the frequency \\( \\omega \\) on a logarithmic scale.\n- The phase starts at 0° and gradually decreases, approaching -180° as frequency rises.\n- The phase margin is indicated as exceeding 90°, signifying the system's stability.\n\n3. **Key Features:**\n- The pole frequency \\( \\omega_{p1} \\) is marked on both plots, indicating the point where the slope changes in the magnitude plot and where the phase begins to significantly drop.\n- The unity-gain frequency \\( \\omega_{t} \\) is also marked, where the magnitude crosses 0 dB.\n- The phase margin (PM) is highlighted, showing it exceeds 90°, indicating unconditional stability.\n\nThis Bode plot effectively illustrates how the system's gain and phase vary with frequency, highlighting the unconditional stability and ample phase margin of the first-order feedback system.\nimage_name:(b)\ndescription:### Graph Type and Function:\nThe graph labeled \"(b)\" is a polar plot depicting the open-loop frequency response of a first-order feedback system. This graph type is utilized to demonstrate the stability and phase margin of control systems.\n\nAxes Labels and Units:\nThe polar plot lacks conventional axes like Cartesian plots. Instead, it represents complex plane coordinates with real and imaginary components. The plot is centered at the origin, with the real axis extending horizontally and the imaginary axis vertically.\n\nOverall Behavior and Trends:\nThe plot depicts a loop starting from the point labeled \\(L(0)\\) on the positive real axis and looping around the origin. The trajectory of \\(L(\\omega)\\) for \\(\\omega > 0\\) is shown in black, while the trajectory for \\(\\omega < 0\\) is shown in gray. The loop passes near the point \\(-1\\) on the real axis, a critical point for stability analysis.\n\nKey Features and Technical Details:\n- The loop does not encircle the \\(-1\\) point, indicating unconditional stability.\n- The trajectory suggests a phase margin greater than \\(90^\\circ\\), a favorable condition for stability in feedback systems.\n- A dashed circle around the origin represents a reference magnitude, typically used to assess the gain margin.\n\nAnnotations and Specific Data Points:\n- The point \\(L(0)\\) is marked on the positive real axis, indicating the starting point of the frequency response.\n- The critical point \\(-1\\) is marked on the real axis, serving as a reference for stability assessment.\n- The phase margin (PM) is not explicitly labeled on the polar plot but is inferred to be greater than \\(90^\\circ\\) based on the loop's position relative to the \\(-1\\) point.\n\nFig. 5.8 Graphical representation of the unconditional stability and $90^{\\circ}$ phase margin of first-order feedback systems: (a) Bode plot and (b) polar plot of open-loop frequency response, L( $\\omega$ ).\n\nThus, we derive the following significant relationship for this first-order model:\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{t}} \\cong \\mathrm{~L}_{0} \\omega_{\\mathrm{p} 1} \\tag{5.25}\n\\end{equation*}\n$$\n\nSubstituting (5.25) into (5.22) for scenarios where $\\omega \\gg \\omega_{\\mathrm{pl}}$, we obtain at midband frequencies:\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s}) \\cong \\frac{\\omega_{\\mathrm{t}}}{\\mathrm{~s}} \\tag{5.26}\n\\end{equation*}\n$$\n\nThe relationship (5.26) is a simplified first-order model assuming infinite dc gain, thus not accurate at low frequencies. However, it is useful for analyzing the system at midband frequencies, $\\omega_{\\mathrm{p} 1}<<\\omega<\\omega_{\\mathrm{t}}$, including estimating the closed-loop circuit's -3 dB frequency and settling time.\n\nAt midband frequencies, the transfer function of the closed-loop amplifier can be determined by substituting (5.26) into (5.8), resulting in:\n\n$$\n\\begin{equation*}\nA_{C L}(s) \\cong \\frac{1}{\\beta} \\frac{1}{\\left(1+s / \\omega_{t}\\right)} \\tag{5.27}\n\\end{equation*}\n$$\n\nAs anticipated, the closed-loop amplifier exhibits a closed-loop gain at low frequencies approximately equal to $1 / \\beta$. The -3 dB frequency of the closed-loop amplifier is given by:\n\n$$\n\\begin{equation*}\n\\omega_{-3 \\mathrm{~dB}} \\cong \\omega_{\\mathrm{t}} \\tag{5.28}\n\\end{equation*}\n$$\n\nFurthermore, from (5.27), we recognize that the closed-loop amplifier is a first-order system with a time-constant, $\\tau$, defined as:\n\n$$\n\\begin{equation*}\n\\tau=\\frac{1}{\\omega_{-3 \\mathrm{~dB}}}=\\frac{1}{\\omega_{t}} \\tag{5.29}\n\\end{equation*}\n$$\n\nThe settling-time performance of integrated amplifiers is often a critical design parameter. For instance, in switched-capacitor circuits, the charge from one or more capacitors must largely transfer to a feedback capacitor within about half a clock period. This charge transfer is closely tied to the opamp's step response. Consequently, the settling time is defined as the duration required for an opamp to reach a specified percentage of its final value following a step input.\n\nRecall that the step response of any first-order circuit is described by:\n\n$$\n\\begin{equation*}\n\\mathrm{V}_{\\text {out }}(\\mathrm{t})=\\mathrm{V}_{\\text {step }}\\left(1-\\mathrm{e}^{-\\mathrm{t} / \\tau}\\right) \\tag{5.30}\n\\end{equation*}\n$$\n\nHere, $\\mathrm{V}_{\\text {step }}$ denotes the magnitude of the voltage step. With this exponential relationship, the time required for the first-order closed-loop circuit to settle to a specified accuracy can be determined. For instance, achieving 1 \\% accuracy requires allowing $\\mathrm{e}^{-\\mathrm{t} / \\tau}$ to reach 0.01, which occurs at $\\mathrm{t}=4.6 \\tau$. For 0.1 \\% accuracy, the settling time needed is approximately $7 \\tau$. Additionally, note that immediately after the step input, the output slope reaches its maximum, given by:\n\n$$\n\\begin{equation*}\n\\left.\\frac{d}{d t} v_{\\text {out }}(t)\\right|_{t=0}=\\frac{V_{\\text {step }}}{\\tau} \\tag{5.31}\n\\end{equation*}\n$$\n\nKey Point: The closed-loop bandwidth of a feedback amplifier is $\\omega_{\\mathrm{t}}$, independent of the amplifier's 3-dB bandwidth, $\\omega_{\\mathrm{p} 1}$. The settling time is $1 / \\omega_{\\mathrm{t}}$.\n\nSince a real amplifier has a finite current capacity to charge the parasitic capacitances at $\\mathrm{v}_{\\text {out }}$, in many practical scenarios for large steps $\\mathrm{V}_{\\text {step }}$, the amplifier may fail to change the output voltage at the rate predicted by (5.31). In such cases, the amplifier deviates from linear behavior, and the model's predictions become invalid.\n\n#### EXAMPLE 5.6\n\nA phase of a switched-capacitor circuit is depicted in Fig. 5.9, where the input signal can be modeled as a voltage step requiring $0.1 \\%$ accuracy in $0.1 \\mu \\mathrm{~s}$. Assuming linear settling, determine the required unity-gain frequency in terms of the capacitance values, $C_{1}$ and $C_{2}$. For $C_{2}=10 C_{1}$, what is the necessary unity-gain frequency of the opamp? What unity-gain frequency is required if $\\mathrm{C}_{2}=0.2 \\mathrm{C}_{1}$ ?\n\n#### Solution\n\nFirst, note that a capacitive feedback network is employed instead of a resistive one. A challenge in a nonswitched circuit with this network is the inability for bias current to flow into the negative opamp input terminal. However, in a switched CMOS opamp circuit, this configuration occurs only briefly and does not pose issues. Second, assume the opamp has a dominant pole response with unity gain frequency $\\omega_{\\mathrm{ta}}$ (distinct from the unity gain frequency of $L(s)$, denoted as $\\omega_{t}$) and high dc gain. Thus, its midband frequency response is adequately approximated by $s / \\omega_{\\mathrm{ta}}$. The open-loop response, $L(s)$, is derived from this opamp response driving the capacitive feedback network, as illustrated in Fig. 5.9(b).\n\n$$\n\\begin{equation*}\nL(s) \\cong\\left(\\frac{s}{\\omega_{\\mathrm{ta}}}\\right)\\left(\\frac{\\mathrm{C}_{2}}{\\mathrm{C}_{1}+\\mathrm{C}_{2}}\\right) \\tag{5.32}\n\\end{equation*}\n$$\n\nThe unity gain frequency of $L(s)$ is determined by substituting (5.32) into (5.15) and solving for $\\omega_{\\mathrm{t}}=\\omega_{\\mathrm{ta}} \\mathrm{C}_{2} /\\left(\\mathrm{C}_{1}+\\mathrm{C}_{2}\\right)$. For $7 \\tau$ settling within $0.1 \\mu \\mathrm{~s}$, $\\tau$ must be less than 14.2 ns. Since $\\tau=1 / \\omega_{\\mathrm{t}}$,\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{ta}} \\geq\\left(\\frac{\\mathrm{C}_{1}+\\mathrm{C}_{2}}{\\mathrm{C}_{2}}\\right)\\left(\\frac{1}{14.2 \\mathrm{~ns}}\\right) \\tag{5.33}\n\\end{equation*}\n$$\n\nFor $\\mathrm{C}_{2}=10 \\mathrm{C}_{1}$, a unity-gain frequency of $2 \\pi \\cdot 12.3 \\mathrm{MHz}$ is required, whereas for $\\mathrm{C}_{2}=0.2 \\mathrm{C}_{1}$, $\\omega_{\\mathrm{ta}}$ should exceed $2 \\pi \\cdot 66.8 \\mathrm{MHz}$.\n\nThe inherent stability, predictable bandwidth, and predictable settling time of first-order systems are strong motivations to ensure feedback circuits possess a dominant pole, thereby allowing approximation by the single-pole model in (5.22)."
},
{
    "text": "- **Graph Type:** Bode plot (phase response).\n- **Axes Labels and Units:**\n- The vertical axis depicts the phase angle, \\(\\angle L(\\omega)\\), measured in degrees.\n- The horizontal axis represents the frequency, \\(\\omega\\), in radians per second, plotted logarithmically.\n- **General Behavior and Trends:**\n- At low frequencies, the phase begins near 0 degrees.\n- As the frequency surpasses \\(\\omega_{p1}\\), the phase starts to decline.\n- The first-order model exhibits a phase shift nearing -90 degrees.\n- The second-order model shows a more intricate phase shift, approaching -180 degrees as additional poles and zeros are taken into account.\n- **Key Features and Technical Aspects:**\n- The first-order model exhibits a straightforward phase transition, whereas the second-order model reflects the cumulative impact of multiple poles and zeros.\n- **Annotations and Specific Data Points:**\n- The graph includes reference lines at -90 degrees and -180 degrees to emphasize phase margin and stability considerations.\n\nFig. 5.7 Typical feedback amplifier open-loop frequency response and corresponding first- and second-order models.\n\nGiven that only one pole contributes to the phase shift, the phase response of a first-order system never falls below $-90^{\\circ}$. L,\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}(\\omega)>-90^{\\circ} \\tag{5.23}\n\\end{equation*}\n$$\n\nKey Point: A first-order feedback amplifier is inherently stable with approximately 90 degrees of phase margin.\n\nCombining (5.23) with the stability criteria in (5.16) and the phase margin definition in (5.17), it is evident that a first-order feedback system remains stable with at least $90^{\\circ}$ phase margin. The Bode plot in Fig. 5.8(a) clearly shows that for a high dc open-loop gain, $L_{0}$, the phase margin will be very close to $90^{\\circ}$. Furthermore, the polar plot of $L(\\omega)$ for a negative feedback system with a single pole cannot encircle the point -1, as illustrated in Fig. $5.8(b)$. Thus, first-order feedback systems are stable with $90^{\\circ}$ phase margin regardless of the dc gain or pole frequency, unlike second- and higher-order loops where phase margin critically depends on the feedback factor, $\\beta$, dc gain, and pole frequencies.\n\nRecall that the unity-gain frequency $\\omega_{\\mathrm{t}}$ is the frequency at which $\\left|L\\left(\\omega_{\\mathrm{t}}\\right)\\right|=1$. We then derive the following approximation, assuming $\\omega_{\\mathrm{t}} \\gg>\\omega_{\\mathrm{p} 1}$ :\n\n$$\n\\begin{equation*}\n\\left|\\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)\\right|=1 \\cong \\frac{\\mathrm{~L}_{0}}{\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{p} 1}} \\tag{5.24}\n\\end{equation*}\n$$\n\nimage_name:(a)\ndescription:The graph labeled \"(a)\" is a Bode plot representing the frequency response of a first-order feedback system. It comprises two subplots: one for the magnitude of the open-loop transfer function \\( |L(\\omega)| \\) in decibels (dB), and the other for the phase \\( \\angle L(\\omega) \\) in degrees.\n\n1. **Magnitude Plot:**\n- **Y-Axis:** Indicates the magnitude \\( |L(\\omega)| \\) in dB.\n- **X-Axis:** Shows the frequency \\( \\omega \\) on a logarithmic scale.\n- The plot initiates at a high magnitude \\( L_0 \\) and decreases linearly with frequency, indicating a slope of -20 dB/decade post the pole frequency \\( \\omega_{p1} \\).\n- The magnitude intersects the 0 dB line at the unity-gain frequency \\( \\omega_{t} \\).\n\n2. **Phase Plot:**\n- **Y-Axis:** Represents the phase \\( \\angle L(\\omega) \\) in degrees.\n- **X-Axis:** Depicts the frequency \\( \\omega \\) on a logarithmic scale.\n- The phase starts at 0° and gradually decreases, approaching -180° as frequency rises.\n- The phase margin is indicated as exceeding 90°, signifying the system's stability.\n\n3. **Key Features:**\n- The pole frequency \\( \\omega_{p1} \\) is marked on both plots, indicating the point where the slope changes in the magnitude plot and where the phase begins to drop significantly.\n- The unity-gain frequency \\( \\omega_{t} \\) is also marked, where the magnitude crosses 0 dB.\n- The phase margin (PM) is highlighted, showing it exceeds 90°, indicating unconditional stability.\n\nThis Bode plot effectively illustrates how the system's gain and phase vary with frequency, demonstrating the unconditional stability and ample phase margin of the first-order feedback system.\nimage_name:(b)\ndescription:### Graph Type and Function:\nThe graph labeled \"(b)\" is a polar plot depicting the open-loop frequency response of a first-order feedback system. This graph type is used to visualize stability and phase margin in control systems.\n\nAxes Labels and Units:\nThe polar plot lacks conventional axes like Cartesian plots. Instead, it represents complex plane coordinates with real and imaginary parts. The plot is centered at the origin, with the real axis extending horizontally and the imaginary axis vertically.\n\nOverall Behavior and Trends:\nThe plot displays a loop starting from the point labeled \\(L(0)\\) on the positive real axis and encircling the origin. The trajectory of \\(L(\\omega)\\) for \\(\\omega > 0\\) is shown in black, while the trajectory for \\(\\omega < 0\\) is in gray. The loop passes near the point \\(-1\\) on the real axis, a critical point for stability analysis.\n\nKey Features and Technical Details:\n- The loop does not encircle the \\(-1\\) point, indicating unconditional stability.\n- The trajectory suggests a phase margin greater than \\(90^\\circ\\), a favorable condition for stability in feedback systems.\n- A dashed circle around the origin represents a reference magnitude, typically used to assess gain margin.\n\nAnnotations and Specific Data Points:\n- The point \\(L(0)\\) is marked on the positive real axis, indicating the starting point of the frequency response.\n- The critical point \\(-1\\) is marked on the real axis, serving as a reference for stability assessment.\n- The phase margin (PM) is not explicitly labeled on the polar plot but is inferred to be greater than \\(90^\\circ\\) based on the loop's position relative to the \\(-1\\) point.\n\nFig. 5.8 Graphical depiction of the unconditional stability and $90^{\\circ}$ phase margin of first-order feedback systems: (a) Bode plot and (b) polar plot of open-loop frequency response, L( $\\omega$ ).\n\nThus, we derive the following significant relationship for this first-order model:\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{t}} \\cong \\mathrm{~L}_{0} \\omega_{\\mathrm{p} 1} \\tag{5.25}\n\\end{equation*}\n$$\n\nSubstituting (5.25) into (5.22) for scenarios where $\\omega \\gg \\omega_{\\mathrm{pl}}$, we obtain at midband frequencies:\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s}) \\cong \\frac{\\omega_{\\mathrm{t}}}{\\mathrm{~s}} \\tag{5.26}\n\\end{equation*}\n$$\n\nThe relationship (5.26) is a simplified first-order model assuming infinite dc gain, thus not accurate at low frequencies. However, it is useful for analyzing the system at midband frequencies, $\\omega_{\\mathrm{p} 1}<<\\omega<\\omega_{\\mathrm{t}}$, including estimating the closed-loop circuit's -3 dB frequency and settling time.\n\nAt midband frequencies, the transfer function of the closed-loop amplifier can be determined by substituting (5.26) into (5.8), resulting in:\n\n$$\n\\begin{equation*}\nA_{C L}(s) \\cong \\frac{1}{\\beta} \\frac{1}{\\left(1+s / \\omega_{t}\\right)} \\tag{5.27}\n\\end{equation*}\n$$\n\nAs anticipated, the closed-loop amplifier exhibits a low-frequency closed-loop gain approximately equal to $1 / \\beta$. The -3 dB frequency of the closed-loop amplifier is given by:\n\n$$\n\\begin{equation*}\n\\omega_{-3 \\mathrm{~dB}} \\cong \\omega_{\\mathrm{t}} \\tag{5.28}\n\\end{equation*}\n$$\n\nFurthermore, from (5.27), we recognize that the closed-loop amplifier is a first-order system with a time-constant, $\\tau$, defined as:\n\n$$\n\\begin{equation*}\n\\tau=\\frac{1}{\\omega_{-3 \\mathrm{~dB}}}=\\frac{1}{\\omega_{t}} \\tag{5.29}\n\\end{equation*}\n$$\n\nThe settling-time performance of integrated amplifiers is often a crucial design parameter. For instance, in switched-capacitor circuits, the charge from one or more capacitors must be mostly transferred to a feedback capacitor within about half a clock period. This charge transfer is closely related to the opamp's step response. Consequently, the settling time is defined as the time required for an opamp to reach a specified percentage of its final value following a step input.\n\nRecall that the step response of any first-order circuit is described by:\n\n$$\n\\begin{equation*}\n\\mathrm{V}_{\\text {out }}(\\mathrm{t})=\\mathrm{V}_{\\text {step }}\\left(1-\\mathrm{e}^{-\\mathrm{t} / \\tau}\\right) \\tag{5.30}\n\\end{equation*}\n$$\n\nHere, $\\mathrm{V}_{\\text {step }}$ represents the magnitude of the voltage step. Using this exponential relationship, the time required for the first-order closed-loop circuit to settle to a specified accuracy can be determined. For example, if $1 \\%$ accuracy is required, $\\mathrm{e}^{-\\mathrm{t} / \\tau}$ must reach 0.01, which occurs at $\\mathrm{t}=4.6 \\tau$. For $0.1 \\%$ accuracy, the settling time required is approximately $7 \\tau$. Additionally, note that immediately after the step input, the output slope will be at its maximum, given by:\n\n$$\n\\begin{equation*}\n\\left.\\frac{d}{d t} v_{\\text {out }}(t)\\right|_{t=0}=\\frac{V_{\\text {step }}}{\\tau} \\tag{5.31}\n\\end{equation*}\n$$\n\nKey Point: The closed-loop bandwidth of a feedback amplifier is $\\omega_{\\mathrm{t}}$, independent of the amplifier's 3-dB bandwidth, $\\omega_{\\mathrm{p} 1}$. The settling time is $1 / \\omega_{\\mathrm{t}}$\n\nSince a real amplifier has a finite current capacity to charge the parasitic capacitances at $\\mathrm{v}_{\\text {out }}$, in many practical cases for large steps $\\mathrm{V}_{\\text {step }}$, the amplifier may fail to change the output voltage at the rate predicted by (5.31). In such scenarios, the amplifier deviates from linear behavior, and the model's predictions become invalid.\n\n#### EXAMPLE 5.6\n\nA phase of a switched-capacitor circuit is illustrated in Fig. 5.9, where the input signal can be modeled as a voltage step requiring $0.1 \\%$ accuracy in $0.1 \\mu \\mathrm{~s}$. Assuming linear settling, determine the required unity-gain frequency in terms of the capacitance values, $C_{1}$ and $C_{2}$. For $C_{2}=10 C_{1}$, what is the necessary unity-gain frequency of the opamp? What unity-gain frequency is needed if $\\mathrm{C}_{2}=0.2 \\mathrm{C}_{1}$ ?\n\n#### Solution\n\nFirst, note that a capacitive feedback network is employed instead of a resistive one. A challenge in a nonswitched circuit with this network is the inability of bias current to flow into the negative opamp input terminal. However, in a switched CMOS opamp circuit, this configuration occurs only briefly and does not pose issues. Second, assume the opamp exhibits a dominant pole response with a unity gain frequency $\\omega_{\\mathrm{ta}}$ (distinct from the unity gain frequency of $L(s)$, denoted as $\\omega_{t}$) and a large dc gain. Thus, its midband frequency response is approximated by $s / \\omega_{\\mathrm{ta}}$. The open-loop response, $L(s)$, is derived from this opamp response driving the capacitive feedback network, as depicted in Fig. 5.9(b).\n\n$$\n\\begin{equation*}\nL(s) \\cong\\left(\\frac{s}{\\omega_{\\mathrm{ta}}}\\right)\\left(\\frac{\\mathrm{C}_{2}}{\\mathrm{C}_{1}+\\mathrm{C}_{2}}\\right) \\tag{5.32}\n\\end{equation*}\n$$\n\nThe unity gain frequency of $L(s)$ is obtained by substituting (5.32) into (5.15) and solving for $\\omega_{\\mathrm{t}}=\\omega_{\\mathrm{ta}} \\mathrm{C}_{2} /\\left(\\mathrm{C}_{1}+\\mathrm{C}_{2}\\right)$. For $7 \\tau$ settling within $0.1 \\mu \\mathrm{~s}$, $\\tau$ must be less than 14.2 ns. Since $\\tau=1 / \\omega_{\\mathrm{t}}$,\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{ta}} \\geq\\left(\\frac{\\mathrm{C}_{1}+\\mathrm{C}_{2}}{\\mathrm{C}_{2}}\\right)\\left(\\frac{1}{14.2 \\mathrm{~ns}}\\right) \\tag{5.33}\n\\end{equation*}\n$$\n\nFor $\\mathrm{C}_{2}=10 \\mathrm{C}_{1}$, a unity-gain frequency of $2 \\pi \\cdot 12.3 \\mathrm{MHz}$ is required, whereas for $\\mathrm{C}_{2}=0.2 \\mathrm{C}_{1}$, $\\omega_{\\mathrm{ta}}$ should exceed $2 \\pi \\cdot 66.8 \\mathrm{MHz}$.\n\nThe inherent stability, predictable bandwidth, and predictable settling time of first-order systems strongly motivate ensuring feedback circuits have a dominant pole, allowing them to be approximated by the single-pole model in (5.22)."
},
{
    "text": "- **Graph Type:** Bode plot (phase response).\n- **Axes Labels and Units:**\n- The vertical axis depicts the phase angle, \\(\\angle L(\\omega)\\), measured in degrees.\n- The horizontal axis represents frequency, \\(\\omega\\), in radians per second, plotted logarithmically.\n- **General Behavior and Trends:**\n- The phase initiates near 0 degrees at lower frequencies.\n- Beyond \\(\\omega_{p1}\\), the phase begins to decline.\n- A first-order model exhibits a phase shift nearing -90 degrees.\n- A second-order model displays a more intricate phase shift, trending towards -180 degrees as additional poles and zeros are incorporated.\n- **Key Features and Technical Aspects:**\n- The first-order model exhibits a straightforward phase transition, whereas the second-order model reflects the cumulative impact of multiple poles and zeros.\n- **Annotations and Specific Data Points:**\n- The graph includes reference lines at -90 degrees and -180 degrees to emphasize phase margin and stability considerations.\n\nFig. 5.7 Illustrative feedback amplifier open-loop frequency response and corresponding first- and second-order models.\n\nGiven that only one pole contributes to the phase shift, the phase response of a first-order system never falls below $-90^{\\circ}$. L,\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}(\\omega)>-90^{\\circ} \\tag{5.23}\n\\end{equation*}\n$$\n\nKey Point: A first-order feedback amplifier exhibits unconditional stability with approximately 90 degrees of phase margin.\n\nBy integrating (5.23) with the stability criteria from (5.16) and the phase margin definition in (5.17), it is evident that a first-order feedback system maintains stability with at least $90^{\\circ}$ phase margin. The Bode plot in Fig. 5.8(a) clearly shows that for substantial dc open-loop gain, $L_{0}$, the phase margin approaches $90^{\\circ}$. Moreover, the polar plot of $L(\\omega)$ for a negative feedback system with a single pole cannot encircle the point -1, as depicted in Fig. $5.8(b)$. Consequently, first-order feedback systems are stable with $90^{\\circ}$ phase margin regardless of dc gain or pole frequency, unlike higher-order loops where phase margin is critically dependent on the feedback factor, $\\beta$, dc gain, and pole frequencies.\n\nRecall the unity-gain frequency $\\omega_{\\mathrm{t}}$, which is the frequency at which $\\left|L\\left(\\omega_{\\mathrm{t}}\\right)\\right|=1$. We derive the following approximation, assuming $\\omega_{\\mathrm{t}} \\gg>\\omega_{\\mathrm{p} 1}$ :\n\n$$\n\\begin{equation*}\n\\left|\\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)\\right|=1 \\cong \\frac{\\mathrm{~L}_{0}}{\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{p} 1}} \\tag{5.24}\n\\end{equation*}\n$$\n\nimage_name:(a)\ndescription:The graph labeled \"(a)\" is a Bode plot representing the frequency response of a first-order feedback system. It comprises two subplots: one for the magnitude of the open-loop transfer function \\( |L(\\omega)| \\) in decibels (dB), and the other for the phase \\( \\angle L(\\omega) \\) in degrees.\n\n1. **Magnitude Plot:**\n- **Y-Axis:** Indicates the magnitude \\( |L(\\omega)| \\) in dB.\n- **X-Axis:** Shows the frequency \\( \\omega \\) on a logarithmic scale.\n- The plot initiates at a high magnitude \\( L_0 \\) and decreases linearly with frequency, exhibiting a slope of -20 dB/decade post the pole frequency \\( \\omega_{p1} \\).\n- The magnitude intersects the 0 dB line at the unity-gain frequency \\( \\omega_{t} \\).\n\n2. **Phase Plot:**\n- **Y-Axis:** Represents the phase \\( \\angle L(\\omega) \\) in degrees.\n- **X-Axis:** Depicts the frequency \\( \\omega \\) on a logarithmic scale.\n- The phase starts at 0° and gradually declines, approaching -180° with increasing frequency.\n- The phase margin is indicated as exceeding 90°, signifying the system's stability.\n\n3. **Key Features:**\n- The pole frequency \\( \\omega_{p1} \\) is marked on both plots, indicating the onset of slope change in the magnitude plot and significant phase drop.\n- The unity-gain frequency \\( \\omega_{t} \\) is also noted, where the magnitude crosses 0 dB.\n- The phase margin (PM) is highlighted, showing it exceeds 90°, indicating unconditional stability.\n\nThis Bode plot effectively illustrates the variation in gain and phase with frequency, underscoring the unconditional stability and ample phase margin of the first-order feedback system.\nimage_name:(b)\ndescription:### Graph Type and Function:\nThe graph labeled \"(b)\" is a polar plot depicting the open-loop frequency response of a first-order feedback system. This graph type is utilized to demonstrate stability and phase margin in control systems.\n\nAxes Labels and Units:\nThe polar plot lacks conventional axes like Cartesian plots. Instead, it represents complex plane coordinates with real and imaginary components. The plot centers around the origin, with the real axis extending horizontally and the imaginary axis vertically.\n\nOverall Behavior and Trends:\nThe plot displays a loop initiating from the point labeled \\(L(0)\\) on the positive real axis and encircling the origin. The trajectory of \\(L(\\omega)\\) for \\(\\omega > 0\\) is depicted in black, while \\(\\omega < 0\\) is shown in gray. The loop approaches but does not encircle the critical point \\(-1\\) on the real axis, crucial for stability analysis.\n\nKey Features and Technical Details:\n- The loop avoids encircling the \\(-1\\) point, indicating unconditional stability.\n- The trajectory suggests a phase margin greater than \\(90^\\circ\\), a favorable condition for stability in feedback systems.\n- A dashed circle around the origin represents a reference magnitude, typically used to assess gain margin.\n\nAnnotations and Specific Data Points:\n- The point \\(L(0)\\) is marked on the positive real axis, denoting the starting point of the frequency response.\n- The critical point \\(-1\\) is highlighted on the real axis, serving as a reference for stability assessment.\n- The phase margin (PM) is implied to exceed \\(90^\\circ\\) based on the loop's position relative to the \\(-1\\) point.\n\nFig. 5.8 Graphical depiction of the unconditional stability and $90^{\\circ}$ phase margin of first-order feedback systems: (a) Bode plot and (b) polar plot of open-loop frequency response, L( $\\omega$ ).\n\nThus, we derive the following crucial relationship for this first-order model:\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{t}} \\cong \\mathrm{~L}_{0} \\omega_{\\mathrm{p} 1} \\tag{5.25}\n\\end{equation*}\n$$\n\nSubstituting (5.25) into (5.22) for scenarios where $\\omega \\gg \\omega_{\\mathrm{pl}}$, we obtain at midband frequencies:\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s}) \\cong \\frac{\\omega_{\\mathrm{t}}}{\\mathrm{~s}} \\tag{5.26}\n\\end{equation*}\n$$\n\nThe relationship (5.26) is a simplified first-order model assuming infinite dc gain, thus not accurate at low frequencies. However, it is useful for analyzing the system at midband frequencies, $\\omega_{\\mathrm{p} 1}<<\\omega<\\omega_{\\mathrm{t}}$, including estimating the closed-loop circuit's -3 dB frequency and settling time.\n\nAt midband frequencies, the closed-loop amplifier's transfer function can be derived by substituting (5.26) into (5.8), resulting in:\n\n$$\n\\begin{equation*}\nA_{C L}(s) \\cong \\frac{1}{\\beta} \\frac{1}{\\left(1+s / \\omega_{t}\\right)} \\tag{5.27}\n\\end{equation*}\n$$\n\nAs anticipated, the closed-loop amplifier exhibits a low-frequency gain approximately equal to $1 / \\beta$. The -3 dB frequency of the closed-loop amplifier is given by:\n\n$$\n\\begin{equation*}\n\\omega_{-3 \\mathrm{~dB}} \\cong \\omega_{\\mathrm{t}} \\tag{5.28}\n\\end{equation*}\n$$\n\nFurthermore, from (5.27), we recognize that the closed-loop amplifier is a first-order system with a time-constant, $\\tau$, defined as:\n\n$$\n\\begin{equation*}\n\\tau=\\frac{1}{\\omega_{-3 \\mathrm{~dB}}}=\\frac{1}{\\omega_{t}} \\tag{5.29}\n\\end{equation*}\n$$\n\nSettling-time performance is often a critical design parameter for integrated amplifiers. For instance, in switched-capacitor circuits, the charge from one or more capacitors must largely transfer to a feedback capacitor within approximately half a clock period. This charge transfer is closely tied to the opamp's step response. Consequently, the settling time is defined as the duration required for an opamp to reach a specified percentage of its final value following a step input.\n\nThe step response of any first-order circuit is described by:\n\n$$\n\\begin{equation*}\n\\mathrm{V}_{\\text {out }}(\\mathrm{t})=\\mathrm{V}_{\\text {step }}\\left(1-\\mathrm{e}^{-\\mathrm{t} / \\tau}\\right) \\tag{5.30}\n\\end{equation*}\n$$\n\nHere, $\\mathrm{V}_{\\text {step }}$ denotes the step voltage size. Using this exponential relationship, the time required for the first-order closed-loop circuit to settle to a specified accuracy can be determined. For instance, achieving 1 \\% accuracy necessitates allowing $\\mathrm{e}^{-\\mathrm{t} / \\tau}$ to reach 0.01, which occurs at $\\mathrm{t}=4.6 \\tau$. For 0.1 \\% accuracy, the required settling time is approximately $7 \\tau$. Additionally, the output slope is maximized immediately after the step input, given by:\n\n$$\n\\begin{equation*}\n\\left.\\frac{d}{d t} v_{\\text {out }}(t)\\right|_{t=0}=\\frac{V_{\\text {step }}}{\\tau} \\tag{5.31}\n\\end{equation*}\n$$\n\nKey Point: The closed-loop bandwidth of a feedback amplifier is $\\omega_{\\mathrm{t}}$, independent of the amplifier's 3-dB bandwidth, $\\omega_{\\mathrm{p} 1}$. The settling time is $1 / \\omega_{\\mathrm{t}}$.\n\nIn practical scenarios, a real amplifier's finite current capability to charge parasitic capacitances at $\\mathrm{v}_{\\text {out }}$ means that for large steps $\\mathrm{V}_{\\text {step }}$, the amplifier may fail to change the output voltage at the rate predicted by (5.31). In such cases, the amplifier deviates from linear behavior, and the model's predictions become invalid.\n\n#### EXAMPLE 5.6\n\nConsider a phase of a switched-capacitor circuit depicted in Fig. 5.9, where the input signal can be modeled as a voltage step requiring $0.1 \\%$ accuracy in $0.1 \\mu \\mathrm{~s}$. Assuming linear settling, determine the necessary unity-gain frequency in terms of capacitance values, $C_{1}$ and $C_{2}$. For $C_{2}=10 C_{1}$, compute the required unity-gain frequency of the opamp. What unity-gain frequency is needed if $\\mathrm{C}_{2}=0.2 \\mathrm{C}_{1}$ ?\n\n#### Solution\n\nFirst, note that a capacitive feedback network is employed instead of a resistive one. A challenge in nonswitched circuits with this network is the inability for bias current to flow into the negative opamp input terminal. However, in a switched CMOS opamp circuit, this configuration exists only briefly and does not pose issues. Second, assume the opamp has a dominant pole response with unity gain frequency $\\omega_{\\mathrm{ta}}$ (distinct from $\\omega_{t}$ of $L(s)$) and high dc gain. Thus, its midband frequency response is approximated by $s / \\omega_{\\mathrm{ta}}$. The open-loop response, $L(s)$, results from this opamp response driving the capacitive feedback network, as illustrated in Fig. 5.9(b).\n\n$$\n\\begin{equation*}\nL(s) \\cong\\left(\\frac{s}{\\omega_{\\mathrm{ta}}}\\right)\\left(\\frac{\\mathrm{C}_{2}}{\\mathrm{C}_{1}+\\mathrm{C}_{2}}\\right) \\tag{5.32}\n\\end{equation*}\n$$\n\nThe unity gain frequency of $L(s)$ is determined by substituting (5.32) into (5.15) and solving for $\\omega_{\\mathrm{t}}=\\omega_{\\mathrm{ta}} \\mathrm{C}_{2} /\\left(\\mathrm{C}_{1}+\\mathrm{C}_{2}\\right)$. For $7 \\tau$ settling within $0.1 \\mu \\mathrm{~s}$, $\\tau$ must be less than 14.2 ns. Since $\\tau=1 / \\omega_{\\mathrm{t}}$,\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{ta}} \\geq\\left(\\frac{\\mathrm{C}_{1}+\\mathrm{C}_{2}}{\\mathrm{C}_{2}}\\right)\\left(\\frac{1}{14.2 \\mathrm{~ns}}\\right) \\tag{5.33}\n\\end{equation*}\n$$\n\nFor $\\mathrm{C}_{2}=10 \\mathrm{C}_{1}$, a unity-gain frequency of $2 \\pi \\cdot 12.3 \\mathrm{MHz}$ is required, whereas for $\\mathrm{C}_{2}=0.2 \\mathrm{C}_{1}$, $\\omega_{\\mathrm{ta}}$ should exceed $2 \\pi \\cdot 66.8 \\mathrm{MHz}$.\n\nThe unconditional stability, predictable bandwidth, and consistent settling time of first-order systems strongly motivate ensuring feedback circuits have a dominant pole, thereby allowing approximation by the single-pole model in (5.22)."
},
{
    "text": "- **Graph Type:** Bode plot (phase response).\n- **Axes Labels and Units:**\n- The vertical axis denotes the phase angle, \\(\\angle L(\\omega)\\), measured in degrees.\n- The horizontal axis represents the frequency, \\(\\omega\\), in radians per second, plotted logarithmically.\n- **General Behavior and Trends:**\n- At low frequencies, the phase begins near 0 degrees.\n- As the frequency surpasses \\(\\omega_{p1}\\), the phase starts to decline.\n- A first-order model exhibits a phase shift approaching -90 degrees.\n- A second-order model shows a more intricate phase shift, nearing -180 degrees as additional poles and zeros are taken into account.\n- **Key Characteristics and Technical Aspects:**\n- The first-order model exhibits a straightforward phase transition, whereas the second-order model reflects the combined impacts of multiple poles and zeros.\n- **Annotations and Specific Data Points:**\n- The graph includes reference lines at -90 degrees and -180 degrees to emphasize the phase margin and stability considerations.\n\nFig. 5.7 Typical feedback amplifier open-loop frequency response and corresponding first- and second-order models.\n\nGiven that only one pole contributes to the phase shift, the phase response of a first-order system never falls below $-90^{\\circ}$. L,\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}(\\omega)>-90^{\\circ} \\tag{5.23}\n\\end{equation*}\n$$\n\nKey Point: A first-order feedback amplifier is inherently stable with approximately 90 degrees of phase margin.\n\nBy combining (5.23) with the stability criteria in (5.16) and the definition of phase margin in (5.17), it is evident that a first-order feedback system remains stable with at least $90^{\\circ}$ phase margin. The Bode plot in Fig. 5.8(a) clearly shows that for a large dc open-loop gain, $L_{0}$, the phase margin will be very close to $90^{\\circ}$. Moreover, the polar plot of $L(\\omega)$ for a negative feedback system with a single pole cannot encircle the point -1, as depicted in Fig. $5.8(b)$. Thus, first-order feedback systems maintain stability with $90^{\\circ}$ phase margin regardless of the dc gain or pole frequency, unlike higher-order loops where phase margin critically depends on the feedback factor, $\\beta$, dc gain, and pole frequencies.\n\nRecall that the unity-gain frequency $\\omega_{\\mathrm{t}}$ is the frequency at which $\\left|L\\left(\\omega_{\\mathrm{t}}\\right)\\right|=1$. We then derive the following approximation, assuming $\\omega_{\\mathrm{t}} \\gg>\\omega_{\\mathrm{p} 1}$ :\n\n$$\n\\begin{equation*}\n\\left|\\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)\\right|=1 \\cong \\frac{\\mathrm{~L}_{0}}{\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{p} 1}} \\tag{5.24}\n\\end{equation*}\n$$\n\nimage_name:(a)\ndescription:The graph labeled \"(a)\" is a Bode plot representing the frequency response of a first-order feedback system. It comprises two subplots: one for the magnitude of the open-loop transfer function \\( |L(\\omega)| \\) in decibels (dB), and the other for the phase \\( \\angle L(\\omega) \\) in degrees.\n\n1. **Magnitude Plot:**\n- **Y-Axis:** Indicates the magnitude \\( |L(\\omega)| \\) in dB.\n- **X-Axis:** Shows the frequency \\( \\omega \\) on a logarithmic scale.\n- The plot initiates at a high magnitude \\( L_0 \\) and decreases linearly with frequency, indicating a slope of -20 dB/decade post the pole frequency \\( \\omega_{p1} \\).\n- The magnitude intersects the 0 dB line at the unity-gain frequency \\( \\omega_{t} \\).\n\n2. **Phase Plot:**\n- **Y-Axis:** Depicts the phase \\( \\angle L(\\omega) \\) in degrees.\n- **X-Axis:** Represents the frequency \\( \\omega \\) on a logarithmic scale.\n- The phase starts at 0° and gradually decreases, approaching -180° as frequency rises.\n- The phase margin is indicated to be greater than 90°, signifying the system's stability.\n\n3. **Key Features:**\n- The pole frequency \\( \\omega_{p1} \\) is marked on both plots, indicating where the slope changes in the magnitude plot and where the phase begins to drop significantly.\n- The unity-gain frequency \\( \\omega_{t} \\) is also marked, where the magnitude crosses 0 dB.\n- The phase margin (PM) is highlighted, showing it exceeds 90°, indicating unconditional stability.\n\nThis Bode plot effectively illustrates how the gain and phase of the system vary with frequency, demonstrating the unconditional stability and adequate phase margin of the first-order feedback system.\n\nimage_name:(b)\ndescription:### Graph Type and Function:\nThe graph labeled \"(b)\" is a polar plot depicting the open-loop frequency response of a first-order feedback system. This graph type is used to illustrate stability and phase margin in control systems.\n\nAxes Labels and Units:\nThe polar plot lacks conventional axes like Cartesian plots. Instead, it represents complex plane coordinates with real and imaginary components. The plot is centered around the origin, with the real axis extending horizontally and the imaginary axis vertically.\n\nOverall Behavior and Trends:\nThe plot displays a loop starting from the point labeled \\(L(0)\\) on the positive real axis and looping around the origin. The trajectory of \\(L(\\omega)\\) for \\(\\omega > 0\\) is shown in black, while the trajectory for \\(\\omega < 0\\) is in gray. The loop passes near the point \\(-1\\) on the real axis, indicating the critical point for stability analysis.\n\nKey Features and Technical Details:\n- The loop does not encircle the \\(-1\\) point, suggesting unconditional stability.\n- The trajectory indicates a phase margin exceeding \\(90^\\circ\\), a favorable condition for stability in feedback systems.\n- The dashed circle around the origin represents a reference magnitude, typically used to evaluate the gain margin.\n\nAnnotations and Specific Data Points:\n- The point \\(L(0)\\) is marked on the positive real axis, indicating the starting point of the frequency response.\n- The critical point \\(-1\\) is marked on the real axis, serving as a reference for assessing stability.\n- The phase margin (PM) is not explicitly labeled on the polar plot but is indicated to be greater than \\(90^\\circ\\) based on the loop's position relative to the \\(-1\\) point.\n\nFig. 5.8 Graphical depiction of the unconditional stability and $90^{\\circ}$ phase margin of first-order feedback systems: (a) Bode plot and (b) polar plot of open-loop frequency response, L( $\\omega$ ).\n\nThus, we derive the following significant relationship for this first-order model:\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{t}} \\cong \\mathrm{~L}_{0} \\omega_{\\mathrm{p} 1} \\tag{5.25}\n\\end{equation*}\n$$\n\nSubstituting (5.25) into (5.22) for cases where $\\omega \\gg \\omega_{\\mathrm{pl}}$, we obtain at midband frequencies:\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s}) \\cong \\frac{\\omega_{\\mathrm{t}}}{\\mathrm{~s}} \\tag{5.26}\n\\end{equation*}\n$$\n\nThe relationship (5.26) is a simplified first-order model assuming infinite dc gain, thus not accurate at low frequencies. However, it is useful for analyzing the system at midband frequencies, $\\omega_{\\mathrm{p} 1}<<\\omega<\\omega_{\\mathrm{t}}$, including estimating the closed-loop circuit's -3 dB frequency and settling time.\n\nAt midband frequencies, the transfer function of the closed-loop amplifier can be determined by substituting (5.26) into (5.8), resulting in:\n\n$$\n\\begin{equation*}\nA_{C L}(s) \\cong \\frac{1}{\\beta} \\frac{1}{\\left(1+s / \\omega_{t}\\right)} \\tag{5.27}\n\\end{equation*}\n$$\n\nAs anticipated, the closed-loop amplifier exhibits a closed-loop gain at low frequencies approximately equal to $1 / \\beta$. The -3 dB frequency of the closed-loop amplifier is given by:\n\n$$\n\\begin{equation*}\n\\omega_{-3 \\mathrm{~dB}} \\cong \\omega_{\\mathrm{t}} \\tag{5.28}\n\\end{equation*}\n$$\n\nFurthermore, from (5.27) we identify that the closed-loop amplifier is a first-order system with a time-constant, $\\tau$, given by:\n\n$$\n\\begin{equation*}\n\\tau=\\frac{1}{\\omega_{-3 \\mathrm{~dB}}}=\\frac{1}{\\omega_{t}} \\tag{5.29}\n\\end{equation*}\n$$\n\nThe settling-time performance of integrated amplifiers is often a crucial design parameter. For instance, in switched-capacitor circuits, the charge from one or more capacitors must be largely transferred to a feedback capacitor within about half a clock period. This charge transfer is closely related to the opamp's step response. Consequently, the settling time is defined as the time it takes for an opamp to reach a specified percentage of its final value when a step input is applied.\n\nRecall that the step response of any first-order circuit is given by:\n\n$$\n\\begin{equation*}\n\\mathrm{V}_{\\text {out }}(\\mathrm{t})=\\mathrm{V}_{\\text {step }}\\left(1-\\mathrm{e}^{-\\mathrm{t} / \\tau}\\right) \\tag{5.30}\n\\end{equation*}\n$$\n\nHere, $\\mathrm{V}_{\\text {step }}$ is the magnitude of the voltage step. With this exponential relationship, the time required for the first-order closed-loop circuit to settle to a specified accuracy can be determined. For instance, if $1 \\%$ accuracy is required, then $\\mathrm{e}^{-\\mathrm{t} / \\tau}$ must reach 0.01, which occurs at a time of $\\mathrm{t}=4.6 \\tau$. For settling to within $0.1 \\%$ accuracy, the required settling time is approximately $7 \\tau$. Additionally, note that immediately after the step input, the output slope will be at its maximum, given by:\n\n$$\n\\begin{equation*}\n\\left.\\frac{d}{d t} v_{\\text {out }}(t)\\right|_{t=0}=\\frac{V_{\\text {step }}}{\\tau} \\tag{5.31}\n\\end{equation*}\n$$\n\nKey Point: The closed-loop bandwidth of a feedback amplifier is $\\omega_{\\mathrm{t}}$, independent of the amplifier's 3-dB bandwidth, $\\omega_{\\mathrm{p} 1}$. The settling time is $1 / \\omega_{\\mathrm{t}}$.\n\nSince a real amplifier will have a finite current available to charge the parasitic capacitances at $\\mathrm{v}_{\\text {out }}$, in many practical cases for large steps $\\mathrm{V}_{\\text {step }}$, the amplifier may be unable to change the output voltage at the rate predicted by (5.31). In such scenarios, the amplifier deviates from linear behavior, and the model's predictions become invalid.\n\n#### EXAMPLE 5.6\n\nA phase of a switched-capacitor circuit is depicted in Fig. 5.9, where the input signal can be modeled as a voltage step requiring $0.1 \\%$ accuracy in $0.1 \\mu \\mathrm{~s}$. Assuming linear settling, determine the required unity-gain frequency in terms of the capacitance values, $C_{1}$ and $C_{2}$. For $C_{2}=10 C_{1}$, what is the necessary unity-gain frequency of the opamp? What unity-gain frequency is needed if $\\mathrm{C}_{2}=0.2 \\mathrm{C}_{1}$ ?\n\n#### Solution\n\nFirst, note that a capacitive feedback network is used instead of a resistive one. A challenge in a nonswitched circuit with this network is that no bias current can flow into the negative opamp input terminal. However, in a switched circuit using a CMOS opamp, this configuration occurs only briefly and does not pose any issues. Second, assume the opamp has a dominant pole response with unity gain frequency $\\omega_{\\mathrm{ta}}$ (distinct from the unity gain frequency of $L(s)$, defined as $\\omega_{t}$) and large dc gain. Thus, its frequency response at midband frequencies is well approximated by $s / \\omega_{\\mathrm{ta}}$. The open-loop response, $L(s)$, is given by this opamp response driving the capacitive feedback network, as shown in Fig. 5.9(b).\n\n$$\n\\begin{equation*}\nL(s) \\cong\\left(\\frac{s}{\\omega_{\\mathrm{ta}}}\\right)\\left(\\frac{\\mathrm{C}_{2}}{\\mathrm{C}_{1}+\\mathrm{C}_{2}}\\right) \\tag{5.32}\n\\end{equation*}\n$$\n\nThe unity gain frequency of $L(s)$ is determined by substituting (5.32) into (5.15) and solving for $\\omega_{\\mathrm{t}}=\\omega_{\\mathrm{ta}} \\mathrm{C}_{2} /\\left(\\mathrm{C}_{1}+\\mathrm{C}_{2}\\right)$. For $7 \\tau$ settling within $0.1 \\mu \\mathrm{~s}$, $\\tau$ must be less than 14.2 ns. Since $\\tau=1 / \\omega_{\\mathrm{t}}$,\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{ta}} \\geq\\left(\\frac{\\mathrm{C}_{1}+\\mathrm{C}_{2}}{\\mathrm{C}_{2}}\\right)\\left(\\frac{1}{14.2 \\mathrm{~ns}}\\right) \\tag{5.33}\n\\end{equation*}\n$$\n\nFor $C_{2}=10 C_{1}$, a unity-gain frequency of $2 \\pi \\cdot 12.3 \\mathrm{MHz}$ is required, whereas for $C_{2}=0.2 C_{1}$, $\\omega_{\\mathrm{ta}}$ should exceed $2 \\pi \\cdot 66.8 \\mathrm{MHz}$.\n\nThe unconditional stability, predictable bandwidth, and predictable settling time of first-order systems are strong motivations to ensure feedback circuits have a dominant pole, thus allowing them to be approximated by the single-pole model in (5.22)."
},
{
    "text": "- **Graph Type:** Bode plot (phase response).\n- **Axis Labels and Units:**\n- The vertical axis shows the phase angle, \\(\\angle L(\\omega)\\), measured in degrees.\n- The horizontal axis represents the frequency, \\(\\omega\\), in radians per second, plotted logarithmically.\n- **General Behavior and Trends:**\n- At low frequencies, the phase begins near 0 degrees.\n- As the frequency surpasses \\(\\omega_{p1}\\), the phase starts to decline.\n- The first-order model exhibits a phase shift nearing -90 degrees.\n- The second-order model displays a more intricate phase shift, approaching -180 degrees as additional poles and zeros are considered.\n- **Key Features and Technical Aspects:**\n- The first-order model exhibits a straightforward phase transition, whereas the second-order model reflects the combined impacts of multiple poles and zeros.\n- **Annotations and Specific Data Points:**\n- The graph includes reference lines at -90 degrees and -180 degrees to emphasize phase margin and stability considerations.\n\nFig. 5.7 Illustrative feedback amplifier open-loop frequency response and corresponding first- and second-order models.\n\nGiven that only one pole contributes to the phase shift, the phase response of a first-order system never falls below $-90^{\\circ}$. L,\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}(\\omega)>-90^{\\circ} \\tag{5.23}\n\\end{equation*}\n$$\n\nKey Point: A first-order feedback amplifier is inherently stable with approximately 90 degrees of phase margin.\n\nCombining (5.23) with the stability criteria in (5.16) and the phase margin definition in (5.17), it is evident that a first-order feedback system remains stable with at least $90^{\\circ}$ phase margin. The Bode plot in Fig. 5.8(a) clearly shows that for substantial dc open-loop gain, $L_{0}$, the phase margin is nearly $90^{\\circ}$. Moreover, the polar plot of $L(\\omega)$ for a negative feedback system with a single pole cannot encircle the -1 point, as depicted in Fig. $5.8(b)$. Thus, first-order feedback systems maintain stability with $90^{\\circ}$ phase margin regardless of dc gain or pole frequency, unlike higher-order loops where phase margin critically depends on the feedback factor, $\\beta$, dc gain, and pole frequencies.\n\nRecall the unity-gain frequency $\\omega_{\\mathrm{t}}$, which is the frequency at which $\\left|L\\left(\\omega_{\\mathrm{t}}\\right)\\right|=1$. We derive the following approximation, assuming $\\omega_{\\mathrm{t}} \\gg>\\omega_{\\mathrm{p} 1}$ :\n\n$$\n\\begin{equation*}\n\\left|\\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)\\right|=1 \\cong \\frac{\\mathrm{~L}_{0}}{\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{p} 1}} \\tag{5.24}\n\\end{equation*}\n$$\n\nimage_name:(a)\ndescription:Graph \"(a)\" is a Bode plot depicting the frequency response of a first-order feedback system. It comprises two subplots: one for the magnitude of the open-loop transfer function \\( |L(\\omega)| \\) in decibels (dB), and the other for the phase \\( \\angle L(\\omega) \\) in degrees.\n\n1. **Magnitude Plot:**\n- **Y-Axis:** Indicates the magnitude \\( |L(\\omega)| \\) in dB.\n- **X-Axis:** Represents the frequency \\( \\omega \\) on a logarithmic scale.\n- The plot initiates at a high magnitude \\( L_0 \\) and decreases linearly with frequency, indicating a slope of -20 dB/decade post the pole frequency \\( \\omega_{p1} \\).\n- The magnitude intersects the 0 dB line at the unity-gain frequency \\( \\omega_{t} \\).\n\n2. **Phase Plot:**\n- **Y-Axis:** Depicts the phase \\( \\angle L(\\omega) \\) in degrees.\n- **X-Axis:** Shows the frequency \\( \\omega \\) on a logarithmic scale.\n- The phase starts at 0° and gradually declines, approaching -180° as frequency rises.\n- The phase margin is indicated to be greater than 90°, signifying the system's stability.\n\n3. **Notable Features:**\n- The pole frequency \\( \\omega_{p1} \\) is marked on both plots, indicating the point where the slope changes in the magnitude plot and the phase begins to significantly drop.\n- The unity-gain frequency \\( \\omega_{t} \\) is also noted, where the magnitude crosses 0 dB.\n- The phase margin (PM) is highlighted, showing it exceeds 90°, indicating unconditional stability.\n\nThis Bode plot effectively illustrates how the system's gain and phase vary with frequency, showcasing the unconditional stability and ample phase margin of the first-order feedback system.\n\nimage_name:(b)\ndescription:### Graph Type and Function:\nGraph \"(b)\" is a polar plot representing the open-loop frequency response of a first-order feedback system. This graph type is utilized to depict the stability and phase margin of control systems.\n\nAxes Labels and Units:\nThe polar plot lacks conventional axes like Cartesian plots. Instead, it represents complex plane coordinates with real and imaginary components. The plot centers around the origin, with the real axis extending horizontally and the imaginary axis vertically.\n\nOverall Behavior and Trends:\nThe plot displays a loop starting from the point labeled \\(L(0)\\) on the positive real axis and encircling the origin. The trajectory of \\(L(\\omega)\\) for \\(\\omega > 0\\) is shown in black, while the trajectory for \\(\\omega < 0\\) is in gray. The loop passes near the point \\(-1\\) on the real axis, a critical point for stability analysis.\n\nKey Features and Technical Details:\n- The loop does not encircle the \\(-1\\) point, indicating unconditional stability.\n- The trajectory suggests a phase margin exceeding \\(90^\\circ\\), a favorable condition for stability in feedback systems.\n- A dashed circle around the origin represents a reference magnitude, typically used to assess the gain margin.\n\nAnnotations and Specific Data Points:\n- The point \\(L(0)\\) is marked on the positive real axis, denoting the starting point of the frequency response.\n- The critical point \\(-1\\) is marked on the real axis, serving as a reference for stability assessment.\n- The phase margin (PM) is not explicitly labeled on the polar plot but is inferred to exceed \\(90^\\circ\\) based on the loop's position relative to the \\(-1\\) point.\n\nFig. 5.8 Graphical representation of the unconditional stability and $90^{\\circ}$ phase margin of first-order feedback systems: (a) Bode plot and (b) polar plot of open-loop frequency response, L( $\\omega$ ).\n\nThus, we derive the following crucial relationship for this first-order model:\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{t}} \\cong \\mathrm{~L}_{0} \\omega_{\\mathrm{p} 1} \\tag{5.25}\n\\end{equation*}\n$$\n\nSubstituting (5.25) into (5.22) for scenarios where $\\omega \\gg \\omega_{\\mathrm{pl}}$, we obtain at midband frequencies:\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s}) \\cong \\frac{\\omega_{\\mathrm{t}}}{\\mathrm{~s}} \\tag{5.26}\n\\end{equation*}\n$$\n\nThe relationship (5.26) is a simplified first-order model assuming infinite dc gain, thus not accurate at low frequencies. However, it is useful for analyzing the system at midband frequencies, $\\omega_{\\mathrm{p} 1}<<\\omega<\\omega_{\\mathrm{t}}$, including estimating the closed-loop circuit's -3 dB frequency and settling time.\n\nAt midband frequencies, the closed-loop amplifier's transfer function can be derived by substituting (5.26) into (5.8), resulting in:\n\n$$\n\\begin{equation*}\nA_{C L}(s) \\cong \\frac{1}{\\beta} \\frac{1}{\\left(1+s / \\omega_{t}\\right)} \\tag{5.27}\n\\end{equation*}\n$$\n\nAs anticipated, the closed-loop amplifier exhibits a low-frequency gain approximately equal to $1 / \\beta$. The -3 dB frequency of the closed-loop amplifier is given by:\n\n$$\n\\begin{equation*}\n\\omega_{-3 \\mathrm{~dB}} \\cong \\omega_{\\mathrm{t}} \\tag{5.28}\n\\end{equation*}\n$$\n\nFurthermore, from (5.27), we identify that the closed-loop amplifier is a first-order system with a time-constant, $\\tau$, defined as:\n\n$$\n\\begin{equation*}\n\\tau=\\frac{1}{\\omega_{-3 \\mathrm{~dB}}}=\\frac{1}{\\omega_{t}} \\tag{5.29}\n\\end{equation*}\n$$\n\nSettling-time performance is often a critical design parameter for integrated amplifiers. For instance, in switched-capacitor circuits, the charge from one or more capacitors must largely transfer to a feedback capacitor within approximately half a clock period. This charge transfer is closely tied to the opamp's step response. Consequently, the settling time is defined as the duration required for an opamp to reach a specified percentage of its final value following a step input.\n\nThe step response of any first-order circuit is described by:\n\n$$\n\\begin{equation*}\n\\mathrm{V}_{\\text {out }}(\\mathrm{t})=\\mathrm{V}_{\\text {step }}\\left(1-\\mathrm{e}^{-\\mathrm{t} / \\tau}\\right) \\tag{5.30}\n\\end{equation*}\n$$\n\nHere, $\\mathrm{V}_{\\text {step }}$ denotes the step voltage magnitude. Using this exponential relationship, the time required for the first-order closed-loop circuit to settle to a specified accuracy can be determined. For instance, achieving 1 \\% accuracy necessitates allowing $\\mathrm{e}^{-\\mathrm{t} / \\tau}$ to reach 0.01, which occurs at $\\mathrm{t}=4.6 \\tau$. For 0.1 \\% accuracy, the required settling time is approximately $7 \\tau$. Additionally, note that immediately after the step input, the output slope is at its maximum, given by:\n\n$$\n\\begin{equation*}\n\\left.\\frac{d}{d t} v_{\\text {out }}(t)\\right|_{t=0}=\\frac{V_{\\text {step }}}{\\tau} \\tag{5.31}\n\\end{equation*}\n$$\n\nKey Point: The closed-loop bandwidth of a feedback amplifier is $\\omega_{\\mathrm{t}}$, independent of the amplifier's 3-dB bandwidth, $\\omega_{\\mathrm{p} 1}$. The settling time is $1 / \\omega_{\\mathrm{t}}$.\n\nIn practical scenarios, a real amplifier will have finite current available to charge parasitic capacitances at $\\mathrm{v}_{\\text {out }}$. Consequently, for large steps $\\mathrm{V}_{\\text {step }}$, the amplifier may fail to change the output voltage at the rate predicted by (5.31), indicating non-linear behavior and the breakdown of the model's predictions.\n\n#### EXAMPLE 5.6\n\nA phase of a switched-capacitor circuit is depicted in Fig. 5.9, where the input signal can be modeled as a voltage step requiring $0.1 \\%$ accuracy in $0.1 \\mu \\mathrm{~s}$. Assuming linear settling, determine the required unity-gain frequency in terms of the capacitance values, $C_{1}$ and $C_{2}$. For $C_{2}=10 C_{1}$, calculate the necessary unity-gain frequency of the opamp. What unity-gain frequency is required if $\\mathrm{C}_{2}=0.2 \\mathrm{C}_{1}$ ?\n\n#### Solution\n\nFirst, note that a capacitive feedback network is employed instead of a resistive one. A challenge in nonswitched circuits with this network is the inability for bias current to flow into the negative opamp input terminal. However, in a switched CMOS opamp circuit, this configuration exists only briefly and does not pose issues. Second, assume the opamp exhibits a dominant pole response with unity gain frequency $\\omega_{\\mathrm{ta}}$ (distinct from the unity gain frequency of $L(s)$, denoted as $\\omega_{t}$) and high dc gain. Thus, its midband frequency response is approximated by $s / \\omega_{\\mathrm{ta}}$. The open-loop response, $L(s)$, is determined by this opamp response driving the capacitive feedback network, as illustrated in Fig. 5.9(b).\n\n$$\n\\begin{equation*}\nL(s) \\cong\\left(\\frac{s}{\\omega_{\\mathrm{ta}}}\\right)\\left(\\frac{\\mathrm{C}_{2}}{\\mathrm{C}_{1}+\\mathrm{C}_{2}}\\right) \\tag{5.32}\n\\end{equation*}\n$$\n\nThe unity gain frequency of $L(s)$ is obtained by substituting (5.32) into (5.15) and solving for $\\omega_{\\mathrm{t}}=\\omega_{\\mathrm{ta}} \\mathrm{C}_{2} /\\left(\\mathrm{C}_{1}+\\mathrm{C}_{2}\\right)$. For $7 \\tau$ settling within $0.1 \\mu \\mathrm{~s}$, $\\tau$ must be less than 14.2 ns. Since $\\tau=1 / \\omega_{\\mathrm{t}}$,\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{ta}} \\geq\\left(\\frac{\\mathrm{C}_{1}+\\mathrm{C}_{2}}{\\mathrm{C}_{2}}\\right)\\left(\\frac{1}{14.2 \\mathrm{~ns}}\\right) \\tag{5.33}\n\\end{equation*}\n$$\n\nFor $\\mathrm{C}_{2}=10 \\mathrm{C}_{1}$, a unity-gain frequency of $2 \\pi \\cdot 12.3 \\mathrm{MHz}$ is required, whereas for $\\mathrm{C}_{2}=0.2 \\mathrm{C}_{1}$, $\\omega_{\\mathrm{ta}}$ should exceed $2 \\pi \\cdot 66.8 \\mathrm{MHz}$.\n\nThe inherent stability, predictable bandwidth, and predictable settling time of first-order systems strongly motivate ensuring feedback circuits have a dominant pole, thereby allowing approximation by the single-pole model in (5.22)."
},
{
    "text": "- **Graph Type:** Bode plot (phase response).\n- **Axes Labels and Units:**\n- The vertical axis depicts the phase angle, \\(\\angle L(\\omega)\\), measured in degrees.\n- The horizontal axis represents frequency, \\(\\omega\\), in radians per second, plotted logarithmically.\n- **General Behavior and Trends:**\n- At low frequencies, the phase starts near 0 degrees.\n- As frequency surpasses \\(\\omega_{p1}\\), the phase begins to decline.\n- The first-order model exhibits a phase shift nearing -90 degrees.\n- The second-order model displays a more intricate phase shift, approaching -180 degrees as additional poles and zeros are considered.\n- **Key Features and Technical Aspects:**\n- The first-order model exhibits a straightforward phase transition, whereas the second-order model reflects the cumulative effects of multiple poles and zeros.\n- **Annotations and Specific Data Points:**\n- The graph includes reference lines at -90 degrees and -180 degrees to emphasize phase margin and stability considerations.\n\nFig. 5.7 Typical feedback amplifier open-loop frequency response and corresponding first- and second-order models.\n\nGiven that only one pole contributes to the phase shift, the phase response of a first-order system never falls below $-90^{\\circ}$. L,\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}(\\omega)>-90^{\\circ} \\tag{5.23}\n\\end{equation*}\n$$\n\nKey Point: A first-order feedback amplifier is unconditionally stable with approximately 90 degrees of phase margin.\n\nCombining (5.23) with the stability criteria in (5.16) and the definition of phase margin in (5.17), it is evident that a first-order feedback system remains stable with at least $90^{\\circ}$ phase margin. The Bode plot in Fig. 5.8(a) illustrates that for substantial dc open-loop gain, $L_{0}$, the phase margin will closely approach $90^{\\circ}$. Furthermore, the polar plot of $L(\\omega)$ for a negative feedback system with a single pole cannot encircle the point -1, as shown in Fig. $5.8(b)$. Thus, first-order feedback systems maintain $90^{\\circ}$ phase margin stability for any dc gain or pole frequency, unlike second- and higher-order loops where phase margin critically depends on the feedback factor, $\\beta$, dc gain, and pole frequencies.\n\nRecall the unity-gain frequency $\\omega_{\\mathrm{t}}$ is the frequency at which $\\left|L\\left(\\omega_{\\mathrm{t}}\\right)\\right|=1$. We derive the following approximation, assuming $\\omega_{\\mathrm{t}} \\gg>\\omega_{\\mathrm{p} 1}$ :\n\n$$\n\\begin{equation*}\n\\left|\\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)\\right|=1 \\cong \\frac{\\mathrm{~L}_{0}}{\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{p} 1}} \\tag{5.24}\n\\end{equation*}\n$$\n\nimage_name:(a)\ndescription:The graph labeled \"(a)\" is a Bode plot depicting the frequency response of a first-order feedback system. It comprises two subplots: one for the magnitude of the open-loop transfer function \\( |L(\\omega)| \\) in decibels (dB), and the other for the phase \\( \\angle L(\\omega) \\) in degrees.\n\n1. **Magnitude Plot:**\n- **Y-Axis:** Represents the magnitude \\( |L(\\omega)| \\) in dB.\n- **X-Axis:** Represents the frequency \\( \\omega \\) on a logarithmic scale.\n- The plot initiates at a high magnitude \\( L_0 \\) and decreases linearly with frequency, indicating a slope of -20 dB/decade post the pole frequency \\( \\omega_{p1} \\).\n- The magnitude intersects the 0 dB line at the unity-gain frequency \\( \\omega_{t} \\).\n\n2. **Phase Plot:**\n- **Y-Axis:** Represents the phase \\( \\angle L(\\omega) \\) in degrees.\n- **X-Axis:** Represents the frequency \\( \\omega \\) on a logarithmic scale.\n- The phase starts at 0° and gradually decreases, approaching -180° as frequency rises.\n- The phase margin is indicated to be greater than 90°, signifying the system's stability.\n\n3. **Key Features:**\n- The pole frequency \\( \\omega_{p1} \\) is marked on both plots, indicating the onset of slope change in the magnitude plot and significant phase drop.\n- The unity-gain frequency \\( \\omega_{t} \\) is also marked, where the magnitude crosses 0 dB.\n- The phase margin (PM) is highlighted, showing it exceeds 90°, indicating unconditional stability.\n\nThis Bode plot effectively illustrates the gain and phase variations with frequency, showcasing the unconditional stability and adequate phase margin of the first-order feedback system.\nimage_name:(b)\ndescription:### Graph Type and Function:\nThe graph labeled \"(b)\" is a polar plot representing the open-loop frequency response of a first-order feedback system. This graph type is utilized to depict stability and phase margin in control systems.\n\nAxes Labels and Units:\nThe polar plot lacks conventional Cartesian axes. Instead, it represents complex plane coordinates with real and imaginary components. The plot is centered at the origin, with the real axis extending horizontally and the imaginary axis vertically.\n\nOverall Behavior and Trends:\nThe plot depicts a loop starting from the point labeled \\(L(0)\\) on the positive real axis and encircling the origin. The trajectory of \\(L(\\omega)\\) for \\(\\omega > 0\\) is shown in black, while \\(\\omega < 0\\) is shown in gray. The loop passes near the point \\(-1\\) on the real axis, a critical point for stability analysis.\n\nKey Features and Technical Details:\n- The loop avoids encircling the \\(-1\\) point, indicating unconditional stability.\n- The trajectory suggests a phase margin exceeding \\(90^\\circ\\), a favorable condition for stability in feedback systems.\n- A dashed circle around the origin represents a reference magnitude, typically used to assess gain margin.\n\nAnnotations and Specific Data Points:\n- The point \\(L(0)\\) is marked on the positive real axis, denoting the starting point of the frequency response.\n- The critical point \\(-1\\) is marked on the real axis, serving as a reference for stability assessment.\n- The phase margin (PM) is not explicitly labeled on the polar plot but is inferred to exceed \\(90^\\circ\\) based on the loop's position relative to the \\(-1\\) point.\n\nFig. 5.8 Graphical depiction of the unconditional stability and $90^{\\circ}$ phase margin of first-order feedback systems: (a) Bode plot and (b) polar plot of open-loop frequency response, L( $\\omega$ ).\n\nThus, we derive the following crucial relationship for this first-order model:\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{t}} \\cong \\mathrm{~L}_{0} \\omega_{\\mathrm{p} 1} \\tag{5.25}\n\\end{equation*}\n$$\n\nSubstituting (5.25) into (5.22) for scenarios where $\\omega \\gg \\omega_{\\mathrm{pl}}$, we obtain at midband frequencies:\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s}) \\cong \\frac{\\omega_{\\mathrm{t}}}{\\mathrm{~s}} \\tag{5.26}\n\\end{equation*}\n$$\n\nThe relationship (5.26) is a simplified first-order model assuming infinite dc gain, thus not accurate at low frequencies. However, it is useful for analyzing the system at midband frequencies, $\\omega_{\\mathrm{p} 1}<<\\omega<\\omega_{\\mathrm{t}}$, including estimating the closed-loop circuit's -3 dB frequency and settling time.\n\nAt midband frequencies, the closed-loop amplifier's transfer function can be derived by substituting (5.26) into (5.8), resulting in:\n\n$$\n\\begin{equation*}\nA_{C L}(s) \\cong \\frac{1}{\\beta} \\frac{1}{\\left(1+s / \\omega_{t}\\right)} \\tag{5.27}\n\\end{equation*}\n$$\n\nAs anticipated, the closed-loop amplifier exhibits a low-frequency gain approximately equal to $1 / \\beta$. The -3 dB frequency of the closed-loop amplifier is given by:\n\n$$\n\\begin{equation*}\n\\omega_{-3 \\mathrm{~dB}} \\cong \\omega_{\\mathrm{t}} \\tag{5.28}\n\\end{equation*}\n$$\n\nFurthermore, from (5.27), we identify that the closed-loop amplifier is a first-order system with a time-constant, $\\tau$, defined as:\n\n$$\n\\begin{equation*}\n\\tau=\\frac{1}{\\omega_{-3 \\mathrm{~dB}}}=\\frac{1}{\\omega_{t}} \\tag{5.29}\n\\end{equation*}\n$$\n\nSettling-time performance is often a critical design parameter for integrated amplifiers. For instance, in switched-capacitor circuits, the charge from one or more capacitors must predominantly transfer to a feedback capacitor within about half a clock period. This charge transfer is closely linked to the opamp's step response. Consequently, the settling time is defined as the duration required for an opamp to reach a specified percentage of its final value following a step input.\n\nRecall that the step response of any first-order circuit is described by:\n\n$$\n\\begin{equation*}\n\\mathrm{V}_{\\text {out }}(\\mathrm{t})=\\mathrm{V}_{\\text {step }}\\left(1-\\mathrm{e}^{-\\mathrm{t} / \\tau}\\right) \\tag{5.30}\n\\end{equation*}\n$$\n\nHere, $\\mathrm{V}_{\\text {step }}$ denotes the step voltage magnitude. Using this exponential relationship, the time required for the first-order closed-loop circuit to settle to a specified accuracy can be determined. For instance, achieving 1 \\% accuracy necessitates allowing $\\mathrm{e}^{-\\mathrm{t} / \\tau}$ to reach 0.01, which occurs at $\\mathrm{t}=4.6 \\tau$. For 0.1 \\% accuracy, the settling time required is approximately $7 \\tau$. Additionally, note that the output slope is maximum immediately after the step input, given by:\n\n$$\n\\begin{equation*}\n\\left.\\frac{d}{d t} v_{\\text {out }}(t)\\right|_{t=0}=\\frac{V_{\\text {step }}}{\\tau} \\tag{5.31}\n\\end{equation*}\n$$\n\nKey Point: The closed-loop bandwidth of a feedback amplifier is $\\omega_{\\mathrm{t}}$, independent of the amplifier's 3-dB bandwidth, $\\omega_{\\mathrm{p} 1}$. The settling time is $1 / \\omega_{\\mathrm{t}}$.\n\nSince real amplifiers have finite current to charge parasitic capacitances at $\\mathrm{v}_{\\text {out }}$, in many practical scenarios for large steps $\\mathrm{V}_{\\text {step }}$, the amplifier may fail to change the output voltage at the rate predicted by (5.31). In such cases, the amplifier deviates from linear behavior, and the model's predictions become invalid.\n\n#### EXAMPLE 5.6\n\nA phase of a switched-capacitor circuit is depicted in Fig. 5.9, where the input signal can be modeled as a voltage step requiring $0.1 \\%$ accuracy in $0.1 \\mu \\mathrm{~s}$. Assuming linear settling, determine the necessary unity-gain frequency in terms of the capacitance values, $C_{1}$ and $C_{2}$. For $C_{2}=10 C_{1}$, what is the required unity-gain frequency of the opamp? What unity-gain frequency is needed if $\\mathrm{C}_{2}=0.2 \\mathrm{C}_{1}$ ?\n\n#### Solution\n\nFirst, note that a capacitive feedback network is employed instead of a resistive one. A challenge in nonswitched circuits is the inability of bias current to flow into the negative opamp input terminal. However, in a switched CMOS opamp circuit, this configuration occurs briefly and does not pose issues. Second, assume the opamp has a dominant pole response with unity gain frequency $\\omega_{\\mathrm{ta}}$ (distinct from the unity gain frequency of $L(s)$, denoted as $\\omega_{t}$) and large dc gain. Thus, its midband frequency response is adequately approximated by $s / \\omega_{\\mathrm{ta}}$. The open-loop response, $L(s)$, is derived from this opamp response driving the capacitive feedback network, as illustrated in Fig. 5.9(b).\n\n$$\n\\begin{equation*}\nL(s) \\cong\\left(\\frac{s}{\\omega_{\\mathrm{ta}}}\\right)\\left(\\frac{\\mathrm{C}_{2}}{\\mathrm{C}_{1}+\\mathrm{C}_{2}}\\right) \\tag{5.32}\n\\end{equation*}\n$$\n\nThe unity gain frequency of $L(s)$ is determined by substituting (5.32) into (5.15) and solving for $\\omega_{\\mathrm{t}}=\\omega_{\\mathrm{ta}} \\mathrm{C}_{2} /\\left(\\mathrm{C}_{1}+\\mathrm{C}_{2}\\right)$. For $7 \\tau$ settling within $0.1 \\mu \\mathrm{~s}$, $\\tau$ must be less than 14.2 ns. Since $\\tau=1 / \\omega_{\\mathrm{t}}$,\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{ta}} \\geq\\left(\\frac{\\mathrm{C}_{1}+\\mathrm{C}_{2}}{\\mathrm{C}_{2}}\\right)\\left(\\frac{1}{14.2 \\mathrm{~ns}}\\right) \\tag{5.33}\n\\end{equation*}\n$$\n\nFor $\\mathrm{C}_{2}=10 \\mathrm{C}_{1}$, a unity-gain frequency of $2 \\pi \\cdot 12.3 \\mathrm{MHz}$ is required, whereas for $\\mathrm{C}_{2}=0.2 \\mathrm{C}_{1}$, $\\omega_{\\mathrm{ta}}$ should exceed $2 \\pi \\cdot 66.8 \\mathrm{MHz}$.\n\nThe unconditional stability, predictable bandwidth, and predictable settling time of first-order systems strongly motivate ensuring feedback circuits have a dominant pole, thereby allowing approximation by the single-pole model in (5.22)."
},
{
    "text": "- **Graph Type:** Bode plot (phase response).\n- **Axis Labels and Units:**\n- The vertical axis depicts the phase angle, \\(\\angle L(\\omega)\\), measured in degrees.\n- The horizontal axis represents frequency, \\(\\omega\\), in radians per second, plotted logarithmically.\n- **General Behavior and Trends:**\n- At low frequencies, the phase starts near 0 degrees.\n- As frequency surpasses \\(\\omega_{p1}\\), the phase begins to decline.\n- The first-order model shows a phase shift nearing -90 degrees.\n- The second-order model exhibits a more intricate phase shift, approaching -180 degrees as additional poles and zeros are considered.\n- **Key Features and Technical Aspects:**\n- The first-order model exhibits a straightforward phase transition, whereas the second-order model reflects the combined impact of multiple poles and zeros.\n- **Annotations and Specific Data Points:**\n- The graph includes reference lines at -90 degrees and -180 degrees to emphasize phase margin and stability considerations.\n\nFig. 5.7 Illustrative feedback amplifier open-loop frequency response and corresponding first- and second-order models.\n\nGiven that only one pole contributes to the phase shift, the phase response of a first-order system never falls below $-90^{\\circ}$. L,\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}(\\omega)>-90^{\\circ} \\tag{5.23}\n\\end{equation*}\n$$\n\nKey Point: A first-order feedback amplifier is inherently stable with approximately 90 degrees of phase margin.\n\nCombining (5.23) with the stability criteria in (5.16) and the definition of phase margin in (5.17), it is evident that a first-order feedback system remains stable with at least $90^{\\circ}$ phase margin. The Bode plot in Fig. 5.8(a) clearly shows that for high dc open-loop gain, $L_{0}$, the phase margin is nearly $90^{\\circ}$. Furthermore, the polar plot of $L(\\omega)$ for a negative feedback system with a single pole cannot encircle the point -1, as depicted in Fig. $5.8(b)$. Thus, first-order feedback systems maintain stability with $90^{\\circ}$ phase margin regardless of dc gain or pole frequency, unlike higher-order loops where phase margin critically depends on the feedback factor, $\\beta$, dc gain, and pole frequencies.\n\nRecall the unity-gain frequency $\\omega_{\\mathrm{t}}$, which is the frequency at which $\\left|L\\left(\\omega_{\\mathrm{t}}\\right)\\right|=1$. The following approximation holds, assuming $\\omega_{\\mathrm{t}} \\gg>\\omega_{\\mathrm{p} 1}$ :\n\n$$\n\\begin{equation*}\n\\left|\\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)\\right|=1 \\cong \\frac{\\mathrm{~L}_{0}}{\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{p} 1}} \\tag{5.24}\n\\end{equation*}\n$$\n\nimage_name:(a)\ndescription:Graph labeled \"(a)\" is a Bode plot depicting the frequency response of a first-order feedback system. It comprises two subplots: one for the magnitude of the open-loop transfer function \\( |L(\\omega)| \\) in decibels (dB), and the other for the phase \\( \\angle L(\\omega) \\) in degrees.\n\n1. **Magnitude Plot:**\n- **Y-Axis:** Shows the magnitude \\( |L(\\omega)| \\) in dB.\n- **X-Axis:** Displays the frequency \\( \\omega \\) on a logarithmic scale.\n- The plot initiates at a high magnitude \\( L_0 \\) and decreases linearly with frequency, indicating a slope of -20 dB/decade post the pole frequency \\( \\omega_{p1} \\).\n- The magnitude intersects the 0 dB line at the unity-gain frequency \\( \\omega_{t} \\).\n\n2. **Phase Plot:**\n- **Y-Axis:** Represents the phase \\( \\angle L(\\omega) \\) in degrees.\n- **X-Axis:** Indicates the frequency \\( \\omega \\) on a logarithmic scale.\n- The phase starts at 0° and gradually decreases, approaching -180° with increasing frequency.\n- The phase margin is indicated as exceeding 90°, signifying the system's stability.\n\n3. **Key Characteristics:**\n- The pole frequency \\( \\omega_{p1} \\) is marked on both plots, indicating the onset of slope change in the magnitude plot and significant phase drop.\n- The unity-gain frequency \\( \\omega_{t} \\) is also noted, where the magnitude crosses 0 dB.\n- The phase margin (PM) is highlighted, showing it exceeds 90°, indicating unconditional stability.\n\nThis Bode plot effectively illustrates the gain and phase variations with frequency, showcasing the unconditional stability and ample phase margin of the first-order feedback system.\nimage_name:(b)\ndescription:### Graph Type and Function:\nGraph labeled \"(b)\" is a polar plot representing the open-loop frequency response of a first-order feedback system. This graph type is utilized to depict stability and phase margin in control systems.\n\nAxes Labels and Units:\nThe polar plot lacks conventional Cartesian axes. Instead, it represents complex plane coordinates with real and imaginary components, centered around the origin, with the real axis extending horizontally and the imaginary axis vertically.\n\nOverall Behavior and Trends:\nThe plot depicts a loop starting from the point labeled \\(L(0)\\) on the positive real axis and encircling the origin. The trajectory of \\(L(\\omega)\\) for \\(\\omega > 0\\) is shown in black, while \\(\\omega < 0\\) is in gray. The loop approaches but does not encircle the point \\(-1\\) on the real axis, critical for stability analysis.\n\nKey Features and Technical Details:\n- The loop avoids encircling the \\(-1\\) point, indicating unconditional stability.\n- The trajectory suggests a phase margin greater than \\(90^\\circ\\), a favorable stability condition in feedback systems.\n- A dashed circle around the origin represents a reference magnitude, typically used for gain margin evaluation.\n\nAnnotations and Specific Data Points:\n- The point \\(L(0)\\) is marked on the positive real axis, denoting the starting point of the frequency response.\n- The critical point \\(-1\\) is highlighted on the real axis for stability assessment.\n- The phase margin (PM) is not explicitly labeled but is inferred to exceed \\(90^\\circ\\) based on the loop's proximity to the \\(-1\\) point.\n\nFig. 5.8 Graphical depiction of the unconditional stability and $90^{\\circ}$ phase margin of first-order feedback systems: (a) Bode plot and (b) polar plot of open-loop frequency response, L( $\\omega$ ).\n\nThus, we derive the following significant relationship for this first-order model:\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{t}} \\cong \\mathrm{~L}_{0} \\omega_{\\mathrm{p} 1} \\tag{5.25}\n\\end{equation*}\n$$\n\nSubstituting (5.25) into (5.22) for scenarios where $\\omega \\gg \\omega_{\\mathrm{pl}}$, we obtain at midband frequencies:\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s}) \\cong \\frac{\\omega_{\\mathrm{t}}}{\\mathrm{~s}} \\tag{5.26}\n\\end{equation*}\n$$\n\nThe relationship (5.26) is a simplified first-order model assuming infinite dc gain, thus not precise at low frequencies. However, it is applicable for midband frequency analysis, $\\omega_{\\mathrm{p} 1}<<\\omega<\\omega_{\\mathrm{t}}$, including estimating the closed-loop circuit's -3 dB frequency and settling time.\n\nAt midband frequencies, the closed-loop amplifier's transfer function can be derived by substituting (5.26) into (5.8), resulting in:\n\n$$\n\\begin{equation*}\nA_{C L}(s) \\cong \\frac{1}{\\beta} \\frac{1}{\\left(1+s / \\omega_{t}\\right)} \\tag{5.27}\n\\end{equation*}\n$$\n\nAs anticipated, the closed-loop amplifier exhibits a low-frequency gain approximately equal to $1 / \\beta$. The -3 dB frequency of the closed-loop amplifier is given by:\n\n$$\n\\begin{equation*}\n\\omega_{-3 \\mathrm{~dB}} \\cong \\omega_{\\mathrm{t}} \\tag{5.28}\n\\end{equation*}\n$$\n\nFurthermore, from (5.27), it is evident that the closed-loop amplifier is a first-order system with a time-constant, $\\tau$, defined as:\n\n$$\n\\begin{equation*}\n\\tau=\\frac{1}{\\omega_{-3 \\mathrm{~dB}}}=\\frac{1}{\\omega_{t}} \\tag{5.29}\n\\end{equation*}\n$$\n\nSettling-time performance is a crucial design parameter for integrated amplifiers. For instance, in switched-capacitor circuits, the charge from one or more capacitors must predominantly transfer to a feedback capacitor within approximately half a clock period. This charge transfer is closely linked to the opamp's step response. Consequently, the settling time is defined as the duration required for an opamp to reach a specified percentage of its final value following a step input.\n\nThe step response of any first-order circuit is described by:\n\n$$\n\\begin{equation*}\n\\mathrm{V}_{\\text {out }}(\\mathrm{t})=\\mathrm{V}_{\\text {step }}\\left(1-\\mathrm{e}^{-\\mathrm{t} / \\tau}\\right) \\tag{5.30}\n\\end{equation*}\n$$\n\nHere, $\\mathrm{V}_{\\text {step }}$ represents the step voltage magnitude. Using this exponential relationship, the time required for the first-order closed-loop circuit to settle to a specified accuracy can be determined. For instance, achieving 1 \\% accuracy necessitates allowing $\\mathrm{e}^{-\\mathrm{t} / \\tau}$ to reach 0.01, which occurs at $\\mathrm{t}=4.6 \\tau$. For 0.1 \\% accuracy, the settling time required is approximately $7 \\tau$. Additionally, immediately following the step input, the output slope is at its maximum, given by:\n\n$$\n\\begin{equation*}\n\\left.\\frac{d}{d t} v_{\\text {out }}(t)\\right|_{t=0}=\\frac{V_{\\text {step }}}{\\tau} \\tag{5.31}\n\\end{equation*}\n$$\n\nKey Point: The closed-loop bandwidth of a feedback amplifier is $\\omega_{\\mathrm{t}}$, independent of the amplifier's 3-dB bandwidth, $\\omega_{\\mathrm{p} 1}$. The settling time is $1 / \\omega_{\\mathrm{t}}$.\n\nIn practical scenarios, a real amplifier's finite current capability to charge parasitic capacitances at $\\mathrm{v}_{\\text {out }}$ means that for large steps $\\mathrm{V}_{\\text {step }}$, the amplifier may fail to change the output voltage at the rate predicted by (5.31). In such cases, the amplifier deviates from linear behavior, and the model's predictions become invalid.\n\n#### EXAMPLE 5.6\n\nA phase of a switched-capacitor circuit is depicted in Fig. 5.9, where the input signal can be modeled as a voltage step requiring $0.1 \\%$ accuracy in $0.1 \\mu \\mathrm{~s}$. Assuming linear settling, determine the required unity-gain frequency in terms of capacitance values, $C_{1}$ and $C_{2}$. For $C_{2}=10 C_{1}$, what is the necessary unity-gain frequency of the opamp? What unity-gain frequency is needed if $\\mathrm{C}_{2}=0.2 \\mathrm{C}_{1}$ ?\n\n#### Solution\n\nFirst, note that a capacitive feedback network is employed instead of a resistive one. In a nonswitched circuit, a challenge arises as no bias current can flow into the negative opamp input terminal. However, in a switched CMOS opamp circuit, this configuration exists only briefly and does not pose issues. Second, assume the opamp has a dominant pole response with unity gain frequency $\\omega_{\\mathrm{ta}}$ (distinct from $\\omega_{t}$ of $L(s)$) and high dc gain. Thus, its midband frequency response is adequately approximated by $s / \\omega_{\\mathrm{ta}}$. The open-loop response, $L(s)$, is derived from this opamp response driving the capacitive feedback network, as shown in Fig. 5.9(b).\n\n$$\n\\begin{equation*}\nL(s) \\cong\\left(\\frac{s}{\\omega_{\\mathrm{ta}}}\\right)\\left(\\frac{\\mathrm{C}_{2}}{\\mathrm{C}_{1}+\\mathrm{C}_{2}}\\right) \\tag{5.32}\n\\end{equation*}\n$$\n\nThe unity gain frequency of $L(s)$ is determined by substituting (5.32) into (5.15) and solving for $\\omega_{\\mathrm{t}}=\\omega_{\\mathrm{ta}} \\mathrm{C}_{2} /\\left(\\mathrm{C}_{1}+\\mathrm{C}_{2}\\right)$. For $7 \\tau$ settling within $0.1 \\mu \\mathrm{~s}$, $\\tau$ must be less than 14.2 ns. Since $\\tau=1 / \\omega_{\\mathrm{t}}$,\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{ta}} \\geq\\left(\\frac{\\mathrm{C}_{1}+\\mathrm{C}_{2}}{\\mathrm{C}_{2}}\\right)\\left(\\frac{1}{14.2 \\mathrm{~ns}}\\right) \\tag{5.33}\n\\end{equation*}\n$$\n\nFor $C_{2}=10 C_{1}$, a unity-gain frequency of $2 \\pi \\cdot 12.3 \\mathrm{MHz}$ is required, whereas for $C_{2}=0.2 C_{1}$, $\\omega_{\\mathrm{ta}}$ should exceed $2 \\pi \\cdot 66.8 \\mathrm{MHz}$.\n\nThe inherent stability, predictable bandwidth, and predictable settling time of first-order systems strongly motivate ensuring feedback circuits have a dominant pole, allowing approximation by the single-pole model in (5.22)."
},
{
    "text": "- **Graph Type:** Bode plot (phase response).\n- **Axis Labels and Units:**\n- The vertical axis depicts the phase angle, \\(\\angle L(\\omega)\\), measured in degrees.\n- The horizontal axis represents frequency, \\(\\omega\\), in radians per second, plotted logarithmically.\n- **General Behavior and Trends:**\n- The phase starts near 0 degrees at low frequencies.\n- As frequency surpasses \\(\\omega_{p1}\\), the phase begins to decline.\n- The first-order model shows a phase shift nearing -90 degrees.\n- The second-order model exhibits a more intricate phase shift, approaching -180 degrees as additional poles and zeros are considered.\n- **Key Features and Technical Aspects:**\n- The first-order model displays a straightforward phase transition, whereas the second-order model reflects the combined impact of multiple poles and zeros.\n- **Annotations and Specific Data Points:**\n- The graph includes reference lines at -90 degrees and -180 degrees to emphasize the phase margin and stability considerations.\n\nFig. 5.7 Illustrative feedback amplifier open-loop frequency response and corresponding first- and second-order models.\n\nGiven that only one pole contributes to the phase shift, the phase response of a first-order system never falls below $-90^{\\circ}$. L,\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}(\\omega)>-90^{\\circ} \\tag{5.23}\n\\end{equation*}\n$$\n\nKey Point: A first-order feedback amplifier exhibits unconditional stability with approximately 90 degrees of phase margin.\n\nCombining (5.23) with the stability criteria in (5.16) and the phase margin definition in (5.17), it is evident that a first-order feedback system remains stable with at least $90^{\\circ}$ phase margin. The Bode plot in Fig. 5.8(a) clearly shows that for substantial dc open-loop gain, $L_{0}$, the phase margin will be very close to $90^{\\circ}$. Furthermore, the polar plot of $L(\\omega)$ for a negative feedback system with a single pole cannot encircle the point -1, as depicted in Fig. $5.8(b)$. Thus, first-order feedback systems maintain stability with $90^{\\circ}$ phase margin regardless of dc gain or pole frequency, unlike second- and higher-order loops where phase margin critically depends on the feedback factor, $\\beta$, dc gain, and pole frequencies.\n\nRecall the unity-gain frequency $\\omega_{\\mathrm{t}}$, which is the frequency at which $\\left|L\\left(\\omega_{\\mathrm{t}}\\right)\\right|=1$. We derive the following approximation, assuming $\\omega_{\\mathrm{t}} \\gg>\\omega_{\\mathrm{p} 1}$ :\n\n$$\n\\begin{equation*}\n\\left|\\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)\\right|=1 \\cong \\frac{\\mathrm{~L}_{0}}{\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{p} 1}} \\tag{5.24}\n\\end{equation*}\n$$\n\nimage_name:(a)\ndescription:The graph labeled \"(a)\" is a Bode plot representing the frequency response of a first-order feedback system. It comprises two subplots: one for the magnitude of the open-loop transfer function \\( |L(\\omega)| \\) in decibels (dB), and the other for the phase \\( \\angle L(\\omega) \\) in degrees.\n\n1. **Magnitude Plot:**\n- **Y-Axis:** Indicates the magnitude \\( |L(\\omega)| \\) in dB.\n- **X-Axis:** Shows the frequency \\( \\omega \\) on a logarithmic scale.\n- The plot initiates at a high magnitude \\( L_0 \\) and decreases linearly with frequency, indicating a slope of -20 dB/decade post the pole frequency \\( \\omega_{p1} \\).\n- The magnitude intersects the 0 dB line at the unity-gain frequency \\( \\omega_{t} \\).\n\n2. **Phase Plot:**\n- **Y-Axis:** Represents the phase \\( \\angle L(\\omega) \\) in degrees.\n- **X-Axis:** Depicts the frequency \\( \\omega \\) on a logarithmic scale.\n- The phase starts at 0° and gradually declines, approaching -180° as frequency rises.\n- The phase margin is indicated as exceeding 90°, signifying the system's stability.\n\n3. **Key Characteristics:**\n- The pole frequency \\( \\omega_{p1} \\) is marked on both plots, indicating where the slope changes in the magnitude plot and where the phase significantly drops.\n- The unity-gain frequency \\( \\omega_{t} \\) is also marked, where the magnitude crosses 0 dB.\n- The phase margin (PM) is highlighted, showing it exceeds 90°, indicating unconditional stability.\n\nThis Bode plot effectively illustrates how the gain and phase of the system vary with frequency, demonstrating the unconditional stability and adequate phase margin of the first-order feedback system.\nimage_name:(b)\ndescription:### Graph Type and Function:\nThe graph labeled \"(b)\" is a polar plot depicting the open-loop frequency response of a first-order feedback system. This graph type is used to illustrate stability and phase margin in control systems.\n\nAxes Labels and Units:\nThe polar plot lacks conventional axes like Cartesian plots. Instead, it represents complex plane coordinates with real and imaginary components. The plot centers around the origin, with the real axis extending horizontally and the imaginary axis vertically.\n\nOverall Behavior and Trends:\nThe plot displays a loop starting from the point labeled \\(L(0)\\) on the positive real axis and looping around the origin. The trajectory of \\(L(\\omega)\\) for \\(\\omega > 0\\) is shown in black, while the trajectory for \\(\\omega < 0\\) is in gray. The loop passes near the point \\(-1\\) on the real axis, a critical point for stability analysis.\n\nKey Features and Technical Details:\n- The loop does not encircle the \\(-1\\) point, indicating unconditional stability.\n- The trajectory suggests a phase margin greater than \\(90^\\circ\\), a favorable condition for stability in feedback systems.\n- A dashed circle around the origin represents a reference magnitude, typically used to evaluate gain margin.\n\nAnnotations and Specific Data Points:\n- The point \\(L(0)\\) is marked on the positive real axis, indicating the starting point of the frequency response.\n- The critical point \\(-1\\) is marked on the real axis, serving as a reference for assessing stability.\n- The phase margin (PM) is not explicitly labeled on the polar plot but is inferred to be greater than \\(90^\\circ\\) based on the loop's position relative to the \\(-1\\) point.\n\nFig. 5.8 Graphical depiction of the unconditional stability and $90^{\\circ}$ phase margin of first-order feedback systems: (a) Bode plot and (b) polar plot of open-loop frequency response, L( $\\omega$ ).\n\nThus, we establish the following significant relationship for this first-order model:\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{t}} \\cong \\mathrm{~L}_{0} \\omega_{\\mathrm{p} 1} \\tag{5.25}\n\\end{equation*}\n$$\n\nSubstituting (5.25) into (5.22) for scenarios where $\\omega \\gg \\omega_{\\mathrm{pl}}$, we obtain at midband frequencies:\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s}) \\cong \\frac{\\omega_{\\mathrm{t}}}{\\mathrm{~s}} \\tag{5.26}\n\\end{equation*}\n$$\n\nThe relationship (5.26) represents a simplified first-order model assuming infinite dc gain, thus not accurate at low frequencies. However, it is useful for analyzing the system at midband frequencies, $\\omega_{\\mathrm{p} 1}<<\\omega<\\omega_{\\mathrm{t}}$, including estimating the closed-loop circuit's -3 dB frequency and settling time.\n\nAt midband frequencies, the transfer function of the closed-loop amplifier can be derived by substituting (5.26) into (5.8), resulting in:\n\n$$\n\\begin{equation*}\nA_{C L}(s) \\cong \\frac{1}{\\beta} \\frac{1}{\\left(1+s / \\omega_{t}\\right)} \\tag{5.27}\n\\end{equation*}\n$$\n\nAs anticipated, the closed-loop amplifier exhibits a closed-loop gain at low frequencies approximately equal to $1 / \\beta$. The -3 dB frequency of the closed-loop amplifier is given by:\n\n$$\n\\begin{equation*}\n\\omega_{-3 \\mathrm{~dB}} \\cong \\omega_{\\mathrm{t}} \\tag{5.28}\n\\end{equation*}\n$$\n\nFurthermore, from (5.27), we identify that the closed-loop amplifier is a first-order system with a time-constant, $\\tau$, defined as:\n\n$$\n\\begin{equation*}\n\\tau=\\frac{1}{\\omega_{-3 \\mathrm{~dB}}}=\\frac{1}{\\omega_{t}} \\tag{5.29}\n\\end{equation*}\n$$\n\nSettling-time performance is often a critical design parameter for integrated amplifiers. For instance, in switched-capacitor circuits, the charge from one or more capacitors must largely transfer to a feedback capacitor within approximately half a clock period. This charge transfer is closely tied to the opamp's step response. Consequently, the settling time is defined as the duration required for an opamp to reach a specified percentage of its final value following a step input.\n\nThe step response of any first-order circuit is described by:\n\n$$\n\\begin{equation*}\n\\mathrm{V}_{\\text {out }}(\\mathrm{t})=\\mathrm{V}_{\\text {step }}\\left(1-\\mathrm{e}^{-\\mathrm{t} / \\tau}\\right) \\tag{5.30}\n\\end{equation*}\n$$\n\nHere, $\\mathrm{V}_{\\text {step }}$ denotes the step voltage size. Using this exponential relationship, the time required for the first-order closed-loop circuit to settle to a specified accuracy can be determined. For a 1% accuracy requirement, $\\mathrm{e}^{-\\mathrm{t} / \\tau}$ must reach 0.01, achieved at $\\mathrm{t}=4.6 \\tau$. For 0.1% accuracy, the settling time required is approximately $7 \\tau$. Additionally, immediately after the step input, the output slope reaches its maximum, given by:\n\n$$\n\\begin{equation*}\n\\left.\\frac{d}{d t} v_{\\text {out }}(t)\\right|_{t=0}=\\frac{V_{\\text {step }}}{\\tau} \\tag{5.31}\n\\end{equation*}\n$$\n\nKey Point: The closed-loop bandwidth of a feedback amplifier is $\\omega_{\\mathrm{t}}$, independent of the amplifier's 3-dB bandwidth, $\\omega_{\\mathrm{p} 1}$. The settling time is $1 / \\omega_{\\mathrm{t}}$\n\nIn practical scenarios, a real amplifier has finite current available to charge parasitic capacitances at $\\mathrm{v}_{\\text {out }}$. Thus, for large steps $\\mathrm{V}_{\\text {step }}$, the amplifier may fail to change the output voltage at the rate predicted by (5.31), leading to nonlinear behavior and model inaccuracies.\n\n#### EXAMPLE 5.6\n\nA phase of a switched-capacitor circuit is illustrated in Fig. 5.9, where the input signal can be modeled as a voltage step requiring $0.1 \\%$ accuracy in $0.1 \\mu \\mathrm{~s}$. Assuming linear settling, determine the required unity-gain frequency in terms of capacitance values, $C_{1}$ and $C_{2}$. For $C_{2}=10 C_{1}$, compute the necessary unity-gain frequency of the opamp. What unity-gain frequency is needed if $\\mathrm{C}_{2}=0.2 \\mathrm{C}_{1}$ ?\n\n#### Solution\n\nFirst, note that a capacitive feedback network is employed instead of a resistive one. A potential issue in a nonswitched circuit is the inability of bias current to flow into the negative opamp input terminal. However, in a switched CMOS opamp circuit, this configuration occurs briefly and does not pose problems. Second, assume the opamp has a dominant pole response with unity gain frequency $\\omega_{\\mathrm{ta}}$ (distinct from the unity gain frequency of $L(s)$, denoted as $\\omega_{t}$) and high dc gain. Thus, its midband frequency response is adequately approximated by $s / \\omega_{\\mathrm{ta}}$. The open-loop response, $L(s)$, is derived from this opamp response driving the capacitive feedback network, as depicted in Fig. 5.9(b).\n\n$$\n\\begin{equation*}\nL(s) \\cong\\left(\\frac{s}{\\omega_{\\mathrm{ta}}}\\right)\\left(\\frac{\\mathrm{C}_{2}}{\\mathrm{C}_{1}+\\mathrm{C}_{2}}\\right) \\tag{5.32}\n\\end{equation*}\n$$\n\nThe unity gain frequency of $L(s)$ is determined by substituting (5.32) into (5.15) and solving for $\\omega_{\\mathrm{t}}=\\omega_{\\mathrm{ta}} \\mathrm{C}_{2} /\\left(\\mathrm{C}_{1}+\\mathrm{C}_{2}\\right)$. For $7 \\tau$ settling within $0.1 \\mu \\mathrm{~s}$, $\\tau$ must be less than 14.2 ns. Since $\\tau=1 / \\omega_{\\mathrm{t}}$,\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{ta}} \\geq\\left(\\frac{\\mathrm{C}_{1}+\\mathrm{C}_{2}}{\\mathrm{C}_{2}}\\right)\\left(\\frac{1}{14.2 \\mathrm{~ns}}\\right) \\tag{5.33}\n\\end{equation*}\n$$\n\nFor $\\mathrm{C}_{2}=10 \\mathrm{C}_{1}$, a unity-gain frequency of $2 \\pi \\cdot 12.3 \\mathrm{MHz}$ is required, whereas for $\\mathrm{C}_{2}=0.2 \\mathrm{C}_{1}$, $\\omega_{\\mathrm{ta}}$ should exceed $2 \\pi \\cdot 66.8 \\mathrm{MHz}$.\n\nThe unconditional stability, predictable bandwidth, and predictable settling time of first-order systems strongly motivate ensuring feedback circuits have a dominant pole, allowing approximation by the single-pole model in (5.22)."
},
{
    "text": "- **Type of Graph:** Bode plot (phase response).\n- **Axes Labels and Units:**\n- The vertical axis depicts the phase angle, \\(\\angle L(\\omega)\\), measured in degrees.\n- The horizontal axis represents the frequency, \\(\\omega\\), in radians per second, plotted on a logarithmic scale.\n- **Overall Behavior and Trends:**\n- The phase begins near 0 degrees at low frequencies.\n- As the frequency surpasses \\(\\omega_{p1}\\), the phase starts to decline.\n- The first-order model exhibits a phase shift nearing -90 degrees.\n- The second-order model displays a more intricate phase shift, approaching -180 degrees as additional poles and zeros are taken into account.\n- **Key Features and Technical Details:**\n- The first-order model exhibits a straightforward phase transition, whereas the second-order model reflects the combined impacts of multiple poles and zeros.\n- **Annotations and Specific Data Points:**\n- The graph includes reference lines at -90 degrees and -180 degrees to emphasize the phase margin and stability considerations.\n\nFig. 5.7 Typical feedback amplifier open-loop frequency response and the corresponding first- and second-order models.\n\nGiven that only one pole contributes to the phase shift, the phase response of a first-order system never falls below $-90^{\\circ}$. L,\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}(\\omega)>-90^{\\circ} \\tag{5.23}\n\\end{equation*}\n$$\n\nKey Point: A first-order feedback amplifier is unconditionally stable with approximately 90 degrees of phase margin.\n\nBy combining (5.23) with the stability criteria in (5.16) and the definition of phase margin in (5.17), it is clear that a first-order feedback system is stable with at least $90^{\\circ}$ phase margin. It is evident from the Bode plot in Fig. 5.8(a) that for large dc open-loop gain, $L_{0}$, the phase margin will be very close to $90^{\\circ}$. Furthermore, it is impossible for the polar plot of $L(\\omega)$ for a negative feedback system with only one pole to encircle the point -1, as shown in Fig. $5.8(b)$. Hence, first-order feedback systems are stable with $90^{\\circ}$ phase margin for any dc gain or pole frequency. This is unlike second- and higher-order loops where phase margin critically depends on the feedback factor, $\\beta$, dc gain, and pole frequencies.\n\nRecall that the unity-gain frequency $\\omega_{\\mathrm{t}}$ is the frequency at which $\\left|L\\left(\\omega_{\\mathrm{t}}\\right)\\right|=1$. We then have the following approximation, assuming $\\omega_{\\mathrm{t}} \\gg \\omega_{\\mathrm{p} 1}$:\n\n$$\n\\begin{equation*}\n\\left|\\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)\\right|=1 \\cong \\frac{\\mathrm{~L}_{0}}{\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{p} 1}} \\tag{5.24}\n\\end{equation*}\n$$\n\nimage_name:(a)\ndescription:The graph labeled \"(a)\" is a Bode plot representing the frequency response of a first-order feedback system. It comprises two subplots: one for the magnitude of the open-loop transfer function \\( |L(\\omega)| \\) in decibels (dB), and the other for the phase \\( \\angle L(\\omega) \\) in degrees.\n\n1. **Magnitude Plot:**\n- **Y-Axis:** Shows the magnitude \\( |L(\\omega)| \\) in dB.\n- **X-Axis:** Represents the frequency \\( \\omega \\) on a logarithmic scale.\n- The plot starts at a high magnitude \\( L_0 \\) and decreases linearly with frequency, indicating a slope of -20 dB/decade after the pole frequency \\( \\omega_{p1} \\).\n- The magnitude crosses the 0 dB line at the unity-gain frequency \\( \\omega_{t} \\).\n\n2. **Phase Plot:**\n- **Y-Axis:** Represents the phase \\( \\angle L(\\omega) \\) in degrees.\n- **X-Axis:** Represents the frequency \\( \\omega \\) on a logarithmic scale.\n- The phase starts at 0° and gradually decreases, approaching -180° as frequency increases.\n- The phase margin is indicated as being greater than 90°, signifying the system's stability.\n\n3. **Key Features:**\n- The pole frequency \\( \\omega_{p1} \\) is marked on both plots, indicating where the slope changes in the magnitude plot and where the phase begins to drop significantly.\n- The unity-gain frequency \\( \\omega_{t} \\) is also marked, where the magnitude crosses 0 dB.\n- The phase margin (PM) is highlighted, showing it is greater than 90°, indicating unconditional stability.\n\nThis Bode plot effectively illustrates how the gain and phase of the system vary with frequency, demonstrating the unconditional stability and sufficient phase margin of the first-order feedback system.\n\nimage_name:(b)\ndescription:### Type of Graph and Function:\nThe graph labeled \"(b)\" is a polar plot depicting the open-loop frequency response of a first-order feedback system. This type of graph is used to illustrate the stability and phase margin of control systems.\n\nAxes Labels and Units:\nThe polar plot lacks conventional axes like Cartesian plots. Instead, it represents complex plane coordinates with real and imaginary components. The plot is centered around the origin, with the real axis extending horizontally and the imaginary axis vertically.\n\nOverall Behavior and Trends:\nThe plot shows a loop starting from the point labeled \\(L(0)\\) on the positive real axis and looping around the origin. The trajectory of \\(L(\\omega)\\) for \\(\\omega > 0\\) is shown in black, while the trajectory for \\(\\omega < 0\\) is shown in gray. The loop passes close to the point \\(-1\\) on the real axis, indicating the critical point for stability analysis.\n\nKey Features and Technical Details:\n- The loop does not encircle the \\(-1\\) point, suggesting unconditional stability.\n- The trajectory indicates a phase margin greater than \\(90^\\circ\\), which is a desirable condition for stability in feedback systems.\n- The dashed circle around the origin represents a reference magnitude, typically used to evaluate the gain margin.\n\nAnnotations and Specific Data Points:\n- The point \\(L(0)\\) is marked on the positive real axis, indicating the starting point of the frequency response.\n- The critical point \\(-1\\) is marked on the real axis, serving as a reference for assessing stability.\n- The phase margin (PM) is not explicitly labeled on the polar plot but is indicated to be greater than \\(90^\\circ\\) based on the loop's position relative to the \\(-1\\) point.\n\nFig. 5.8 Graphical illustration of the unconditional stability and $90^{\\circ}$ phase margin of first-order feedback systems: (a) Bode plot and (b) polar plot of open-loop frequency response, L( $\\omega$ ).\n\nThus, we derive the following important relationship for this first-order model:\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{t}} \\cong \\mathrm{~L}_{0} \\omega_{\\mathrm{p} 1} \\tag{5.25}\n\\end{equation*}\n$$\n\nSubstituting (5.25) into (5.22) for the case where $\\omega \\gg \\omega_{\\mathrm{pl}}$, we obtain at midband frequencies:\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s}) \\cong \\frac{\\omega_{\\mathrm{t}}}{\\mathrm{~s}} \\tag{5.26}\n\\end{equation*}\n$$\n\nThe relationship (5.26) is a simplified first-order model that assumes infinite dc gain and is thus not accurate at low frequencies. However, it can be used to analyze the system at midband frequencies, $\\omega_{\\mathrm{p} 1}<<\\omega<\\omega_{\\mathrm{t}}$, including estimating the closed-loop circuit's -3 dB frequency and settling time.\n\nAt midband frequencies, the transfer function of the closed-loop amplifier can be determined by substituting (5.26) into (5.8), resulting in:\n\n$$\n\\begin{equation*}\nA_{C L}(s) \\cong \\frac{1}{\\beta} \\frac{1}{\\left(1+s / \\omega_{t}\\right)} \\tag{5.27}\n\\end{equation*}\n$$\n\nAs expected, the closed-loop amplifier has a closed-loop gain at low frequencies approximately equal to $1 / \\beta$. The -3 dB frequency of the closed-loop amplifier is given by:\n\n$$\n\\begin{equation*}\n\\omega_{-3 \\mathrm{~dB}} \\cong \\omega_{\\mathrm{t}} \\tag{5.28}\n\\end{equation*}\n$$\n\nFurthermore, from (5.27) we recognize that the closed-loop amplifier is a first-order system with a time-constant, $\\tau$, given by:\n\n$$\n\\begin{equation*}\n\\tau=\\frac{1}{\\omega_{-3 \\mathrm{~dB}}}=\\frac{1}{\\omega_{t}} \\tag{5.29}\n\\end{equation*}\n$$\n\nThe settling-time performance of integrated amplifiers is often a critical design parameter. For instance, in switched-capacitor circuits, the charge from one or more capacitors must be mostly transferred to a feedback capacitor within about half a clock period. This charge transfer is closely related to the opamp's step response. Consequently, the settling time is defined as the time it takes for an opamp to reach a specified percentage of its final value when a step input is applied.\n\nRecall that the step response of any first-order circuit is given by:\n\n$$\n\\begin{equation*}\n\\mathrm{V}_{\\text {out }}(\\mathrm{t})=\\mathrm{V}_{\\text {step }}\\left(1-\\mathrm{e}^{-\\mathrm{t} / \\tau}\\right) \\tag{5.30}\n\\end{equation*}\n$$\n\nHere, $\\mathrm{V}_{\\text {step }}$ is the size of the voltage step. With this exponential relationship, the time required for the first-order closed-loop circuit to settle with a specified accuracy can be determined. For example, if $1 \\%$ accuracy is required, then $\\mathrm{e}^{-\\mathrm{t} / \\tau}$ must reach 0.01, which occurs at a time of $\\mathrm{t}=4.6 \\tau$. For settling to within $0.1 \\%$ accuracy, the required settling time becomes approximately $7 \\tau$. Additionally, note that just after the step input, the slope of the output will be at its maximum, given by:\n\n$$\n\\begin{equation*}\n\\left.\\frac{d}{d t} v_{\\text {out }}(t)\\right|_{t=0}=\\frac{V_{\\text {step }}}{\\tau} \\tag{5.31}\n\\end{equation*}\n$$\n\nKey Point: The closed-loop bandwidth of a feedback amplifier is $\\omega_{\\mathrm{t}}$, independent of the amplifier's 3-dB bandwidth, $\\omega_{\\mathrm{p} 1}$. The settling time is $1 / \\omega_{\\mathrm{t}}$.\n\nSince a real amplifier will have a finite current available to charge the parasitic capacitances at $\\mathrm{v}_{\\text {out }}$, in many practical cases for large steps $\\mathrm{V}_{\\text {step }}$, the amplifier will be unable to change the output voltage at the rate predicted by (5.31). In such cases, the amplifier is no longer behaving linearly, and the model's predictions become invalid.\n\n#### EXAMPLE 5.6\n\nOne phase of a switched-capacitor circuit is depicted in Fig. 5.9, where the input signal can be modeled as a voltage step and $0.1 \\%$ accuracy is needed in $0.1 \\mu \\mathrm{~s}$. Assuming linear settling, find the required unity-gain frequency in terms of the capacitance values, $C_{1}$ and $C_{2}$. For $C_{2}=10 C_{1}$, what is the necessary unity-gain frequency of the opamp? What unity-gain frequency is needed in the case $\\mathrm{C}_{2}=0.2 \\mathrm{C}_{1}$ ?\n\n#### Solution\n\nFirst, note that a capacitive feedback network is used instead of a resistive one. A challenge with this network in a nonswitched circuit is that no bias current can flow into the negative opamp input terminal. However, in a switched circuit using a CMOS opamp, the shown configuration occurs only for a short time and does not cause any issues. Second, assume the opamp has a dominant pole response with unity gain frequency $\\omega_{\\mathrm{ta}}$ (different from the unity gain frequency of $L(s)$, defined as $\\omega_{t}$) and large dc gain. Hence, its frequency response at midband frequencies is well approximated by $s / \\omega_{\\mathrm{ta}}$. The open-loop response, $L(s)$, is given by this opamp response driving the capacitive feedback network, as shown in Fig. 5.9(b).\n\n$$\n\\begin{equation*}\nL(s) \\cong\\left(\\frac{s}{\\omega_{\\mathrm{ta}}}\\right)\\left(\\frac{\\mathrm{C}_{2}}{\\mathrm{C}_{1}+\\mathrm{C}_{2}}\\right) \\tag{5.32}\n\\end{equation*}\n$$\n\nThe unity gain frequency of $L(s)$ is found by substituting (5.32) into (5.15) and solving for $\\omega_{\\mathrm{t}}=\\omega_{\\mathrm{ta}} \\mathrm{C}_{2} /\\left(\\mathrm{C}_{1}+\\mathrm{C}_{2}\\right)$. For $7 \\tau$ settling within $0.1 \\mu \\mathrm{~s}$, we see that $\\tau$ must be less than 14.2 ns. Since $\\tau=1 / \\omega_{\\mathrm{t}}$,\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{ta}} \\geq\\left(\\frac{\\mathrm{C}_{1}+\\mathrm{C}_{2}}{\\mathrm{C}_{2}}\\right)\\left(\\frac{1}{14.2 \\mathrm{~ns}}\\right) \\tag{5.33}\n\\end{equation*}\n$$\n\nFor the case where $\\mathrm{C}_{2}=10 \\mathrm{C}_{1}$, a unity-gain frequency of $2 \\pi \\cdot 12.3 \\mathrm{MHz}$ is needed, whereas in the case of $\\mathrm{C}_{2}=0.2 \\mathrm{C}_{1}$, $\\omega_{\\mathrm{ta}}$ should be larger than $2 \\pi \\cdot 66.8 \\mathrm{MHz}$.\n\nThe unconditional stability, predictable bandwidth, and predictable settling time of first-order systems are strong incentives to ensure feedback circuits have a dominant pole and, therefore, may be approximated by the single-pole model in (5.22)."
},
{
    "text": "- **Graph Type:** Bode plot (phase response).\n- **Axes Labels and Units:**\n- The vertical axis depicts the phase angle, \\(\\angle L(\\omega)\\), measured in degrees.\n- The horizontal axis represents frequency, \\(\\omega\\), in radians per second, plotted logarithmically.\n- **Behavior and Trends:**\n- The phase begins near 0 degrees at low frequencies.\n- As frequency surpasses \\(\\omega_{p1}\\), the phase starts to decline.\n- The first-order model shows a phase shift nearing -90 degrees.\n- The second-order model exhibits a more intricate phase shift, approaching -180 degrees as additional poles and zeros are taken into account.\n- **Key Features and Technical Aspects:**\n- The first-order model displays a straightforward phase transition, whereas the second-order model reflects the combined impacts of multiple poles and zeros.\n- **Annotations and Specific Data Points:**\n- The graph includes reference lines at -90 degrees and -180 degrees to emphasize phase margin and stability considerations.\n\nFig. 5.7 Typical feedback amplifier open-loop frequency response and corresponding first- and second-order models.\n\nGiven that only one pole contributes to the phase shift, the phase response of a first-order system never falls below $-90^{\\circ}$. L,\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}(\\omega)>-90^{\\circ} \\tag{5.23}\n\\end{equation*}\n$$\n\nKey Point: A first-order feedback amplifier is unconditionally stable with approximately 90 degrees of phase margin.\n\nBy combining (5.23) with the stability criteria in (5.16) and the phase margin definition in (5.17), it is clear that a first-order feedback system remains stable with at least $90^{\\circ}$ phase margin. The Bode plot in Fig. 5.8(a) illustrates that for large dc open-loop gain, $L_{0}$, the phase margin will be very close to $90^{\\circ}$. Furthermore, the polar plot of $L(\\omega)$ for a negative feedback system with a single pole cannot encircle the -1 point, as shown in Fig. $5.8(b)$. Thus, first-order feedback systems are stable with $90^{\\circ}$ phase margin regardless of dc gain or pole frequency, unlike second- and higher-order loops where phase margin critically depends on the feedback factor, $\\beta$, dc gain, and pole frequencies.\n\nRecall that the unity-gain frequency $\\omega_{\\mathrm{t}}$ is the frequency at which $\\left|L\\left(\\omega_{\\mathrm{t}}\\right)\\right|=1$. The following approximation holds, assuming $\\omega_{\\mathrm{t}} \\gg>\\omega_{\\mathrm{p} 1}$ :\n\n$$\n\\begin{equation*}\n\\left|\\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)\\right|=1 \\cong \\frac{\\mathrm{~L}_{0}}{\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{p} 1}} \\tag{5.24}\n\\end{equation*}\n$$\n\nimage_name:(a)\ndescription:The graph labeled \"(a)\" is a Bode plot representing the frequency response of a first-order feedback system. It comprises two subplots: one for the magnitude of the open-loop transfer function \\( |L(\\omega)| \\) in decibels (dB), and the other for the phase \\( \\angle L(\\omega) \\) in degrees.\n\n1. **Magnitude Plot:**\n- **Y-Axis:** Shows the magnitude \\( |L(\\omega)| \\) in dB.\n- **X-Axis:** Displays the frequency \\( \\omega \\) on a logarithmic scale.\n- The plot starts at a high magnitude \\( L_0 \\) and decreases linearly with frequency, indicating a slope of -20 dB/decade after the pole frequency \\( \\omega_{p1} \\).\n- The magnitude crosses the 0 dB line at the unity-gain frequency \\( \\omega_{t} \\).\n\n2. **Phase Plot:**\n- **Y-Axis:** Represents the phase \\( \\angle L(\\omega) \\) in degrees.\n- **X-Axis:** Represents the frequency \\( \\omega \\) on a logarithmic scale.\n- The phase starts at 0° and gradually decreases, approaching -180° as frequency increases.\n- The phase margin is indicated as being greater than 90°, signifying the system's stability.\n\n3. **Key Features:**\n- The pole frequency \\( \\omega_{p1} \\) is marked on both plots, indicating where the slope changes in the magnitude plot and where the phase begins to drop significantly.\n- The unity-gain frequency \\( \\omega_{t} \\) is also marked, where the magnitude crosses 0 dB.\n- The phase margin (PM) is highlighted, showing it is greater than 90°, indicating unconditional stability.\n\nThis Bode plot effectively visualizes how the gain and phase of the system vary with frequency, demonstrating the unconditional stability and adequate phase margin of the first-order feedback system.\n\nimage_name:(b)\ndescription:### Graph Type and Function:\nThe graph labeled \"(b)\" is a polar plot depicting the open-loop frequency response of a first-order feedback system. This graph type is used to illustrate stability and phase margin in control systems.\n\nAxes Labels and Units:\nThe polar plot lacks conventional axes like Cartesian plots. Instead, it represents complex plane coordinates with real and imaginary components. The plot is centered around the origin, with the real axis extending horizontally and the imaginary axis vertically.\n\nOverall Behavior and Trends:\nThe plot shows a loop starting from the point labeled \\(L(0)\\) on the positive real axis and looping around the origin. The trajectory of \\(L(\\omega)\\) for \\(\\omega > 0\\) is depicted in black, while the trajectory for \\(\\omega < 0\\) is shown in gray. The loop passes close to the point \\(-1\\) on the real axis, indicating the critical point for stability analysis.\n\nKey Features and Technical Details:\n- The loop does not encircle the \\(-1\\) point, indicating unconditional stability.\n- The trajectory suggests a phase margin greater than \\(90^\\circ\\), a favorable condition for stability in feedback systems.\n- The dashed circle around the origin represents a reference magnitude, typically used to evaluate the gain margin.\n\nAnnotations and Specific Data Points:\n- The point \\(L(0)\\) is marked on the positive real axis, indicating the starting point of the frequency response.\n- The critical point \\(-1\\) is marked on the real axis, serving as a reference for assessing stability.\n- The phase margin (PM) is not explicitly labeled on the polar plot but is indicated to be greater than \\(90^\\circ\\) based on the loop's position relative to the \\(-1\\) point.\n\nFig. 5.8 Graphical representation of the unconditional stability and $90^{\\circ}$ phase margin of first-order feedback systems: (a) Bode plot and (b) polar plot of open-loop frequency response, L( $\\omega$ ).\n\nThus, we derive the following significant relationship for this first-order model:\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{t}} \\cong \\mathrm{~L}_{0} \\omega_{\\mathrm{p} 1} \\tag{5.25}\n\\end{equation*}\n$$\n\nSubstituting (5.25) into (5.22) for cases where $\\omega \\gg \\omega_{\\mathrm{pl}}$, we obtain at midband frequencies:\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s}) \\cong \\frac{\\omega_{\\mathrm{t}}}{\\mathrm{~s}} \\tag{5.26}\n\\end{equation*}\n$$\n\nThe relationship (5.26) is a simplified first-order model assuming infinite dc gain, hence it is not accurate at low frequencies. However, it is useful for analyzing the system at midband frequencies, $\\omega_{\\mathrm{p} 1}<<\\omega<\\omega_{\\mathrm{t}}$, including estimating the closed-loop circuit's -3 dB frequency and settling time.\n\nAt midband frequencies, the transfer function of the closed-loop amplifier can be determined by substituting (5.26) into (5.8), resulting in:\n\n$$\n\\begin{equation*}\nA_{C L}(s) \\cong \\frac{1}{\\beta} \\frac{1}{\\left(1+s / \\omega_{t}\\right)} \\tag{5.27}\n\\end{equation*}\n$$\n\nAs expected, the closed-loop amplifier exhibits a closed-loop gain at low frequencies approximately equal to $1 / \\beta$. The -3 dB frequency of the closed-loop amplifier is given by:\n\n$$\n\\begin{equation*}\n\\omega_{-3 \\mathrm{~dB}} \\cong \\omega_{\\mathrm{t}} \\tag{5.28}\n\\end{equation*}\n$$\n\nFurthermore, from (5.27), we recognize that the closed-loop amplifier is a first-order system with a time-constant, $\\tau$, given by:\n\n$$\n\\begin{equation*}\n\\tau=\\frac{1}{\\omega_{-3 \\mathrm{~dB}}}=\\frac{1}{\\omega_{t}} \\tag{5.29}\n\\end{equation*}\n$$\n\nThe settling-time performance of integrated amplifiers is often a critical design parameter. For instance, in switched-capacitor circuits, the charge from one or more capacitors must be largely transferred to a feedback capacitor within about half a clock period. This charge transfer is closely related to the opamp's step response. Consequently, the settling time is defined as the time it takes for an opamp to reach a specified percentage of its final value when a step input is applied.\n\nRecall that the step response of any first-order circuit is described by:\n\n$$\n\\begin{equation*}\n\\mathrm{V}_{\\text {out }}(\\mathrm{t})=\\mathrm{V}_{\\text {step }}\\left(1-\\mathrm{e}^{-\\mathrm{t} / \\tau}\\right) \\tag{5.30}\n\\end{equation*}\n$$\n\nHere, $\\mathrm{V}_{\\text {step }}$ represents the size of the voltage step. With this exponential relationship, the time required for the first-order closed-loop circuit to settle to a specified accuracy can be determined. For example, if $1 \\%$ accuracy is required, then $\\mathrm{e}^{-\\mathrm{t} / \\tau}$ must reach 0.01, which occurs at a time of $\\mathrm{t}=4.6 \\tau$. For settling to within $0.1 \\%$ accuracy, the required settling time is approximately $7 \\tau$. Additionally, note that immediately after the step input, the output slope will be at its maximum, given by:\n\n$$\n\\begin{equation*}\n\\left.\\frac{d}{d t} v_{\\text {out }}(t)\\right|_{t=0}=\\frac{V_{\\text {step }}}{\\tau} \\tag{5.31}\n\\end{equation*}\n$$\n\nKey Point: The closed-loop bandwidth of a feedback amplifier is $\\omega_{\\mathrm{t}}$, independent of the amplifier's 3-dB bandwidth, $\\omega_{\\mathrm{p} 1}$. The settling time is $1 / \\omega_{\\mathrm{t}}$.\n\nSince a real amplifier has a finite current available to charge the parasitic capacitances at $\\mathrm{v}_{\\text {out }}$, in many practical cases for large steps $\\mathrm{V}_{\\text {step }}$, the amplifier may be unable to change the output voltage at the rate predicted by (5.31). In such scenarios, the amplifier ceases to behave linearly, and the model's predictions become invalid.\n\n#### EXAMPLE 5.6\n\nA phase of a switched-capacitor circuit is depicted in Fig. 5.9, where the input signal can be modeled as a voltage step requiring $0.1 \\%$ accuracy in $0.1 \\mu \\mathrm{~s}$. Assuming linear settling, determine the required unity-gain frequency in terms of the capacitance values, $C_{1}$ and $C_{2}$. For $C_{2}=10 C_{1}$, what is the necessary unity-gain frequency of the opamp? What unity-gain frequency is needed if $\\mathrm{C}_{2}=0.2 \\mathrm{C}_{1}$ ?\n\n#### Solution\n\nFirst, note that a capacitive feedback network is used instead of a resistive one. A challenge in a nonswitched circuit with this network is that no bias current can flow into the negative opamp input terminal. However, in a switched CMOS opamp circuit, this configuration occurs only briefly and does not pose any issues. Second, assume the opamp has a dominant pole response with unity gain frequency $\\omega_{\\mathrm{ta}}$ (distinct from the unity gain frequency of $L(s)$, denoted as $\\omega_{t}$) and large dc gain. Thus, its frequency response at midband frequencies is approximated by $s / \\omega_{\\mathrm{ta}}$. The open-loop response, $L(s)$, is given by this opamp response driving the capacitive feedback network, as shown in Fig. 5.9(b).\n\n$$\n\\begin{equation*}\nL(s) \\cong\\left(\\frac{s}{\\omega_{\\mathrm{ta}}}\\right)\\left(\\frac{\\mathrm{C}_{2}}{\\mathrm{C}_{1}+\\mathrm{C}_{2}}\\right) \\tag{5.32}\n\\end{equation*}\n$$\n\nThe unity gain frequency of $L(s)$ is determined by substituting (5.32) into (5.15) and solving for $\\omega_{\\mathrm{t}}=\\omega_{\\mathrm{ta}} \\mathrm{C}_{2} /\\left(\\mathrm{C}_{1}+\\mathrm{C}_{2}\\right)$. For $7 \\tau$ settling within $0.1 \\mu \\mathrm{~s}$, $\\tau$ must be less than 14.2 ns. Since $\\tau=1 / \\omega_{\\mathrm{t}}$,\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{ta}} \\geq\\left(\\frac{\\mathrm{C}_{1}+\\mathrm{C}_{2}}{\\mathrm{C}_{2}}\\right)\\left(\\frac{1}{14.2 \\mathrm{~ns}}\\right) \\tag{5.33}\n\\end{equation*}\n$$\n\nFor $C_{2}=10 C_{1}$, a unity-gain frequency of $2 \\pi \\cdot 12.3 \\mathrm{MHz}$ is required, whereas for $C_{2}=0.2 C_{1}$, $\\omega_{\\mathrm{ta}}$ should exceed $2 \\pi \\cdot 66.8 \\mathrm{MHz}$.\n\nThe unconditional stability, predictable bandwidth, and predictable settling time of first-order systems are strong motivations to ensure feedback circuits have a dominant pole, allowing them to be approximated by the single-pole model in (5.22)."
},
{
    "text": "While first-order feedback amplifiers possess several favorable traits, practical feedback amplifiers typically feature multiple poles. The primary goal in designing amplifier $A$ is to achieve a high low-frequency gain. However, the maximum gain achievable with a single transistor, defined by its intrinsic gain $A_{i}=g_{m} r_{d s}$, is often inadequate. Consequently, multiple transistors must be used, resulting in a more intricate circuit with several nodes and, unavoidably, multiple poles.\n\nA general second-order feedback loop transfer function is given by,\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s})=\\frac{\\mathrm{L}_{0}}{\\left(1+\\mathrm{s} / \\omega_{\\mathrm{p} 1}\\right)\\left(1+\\mathrm{s} / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.34}\n\\end{equation*}\n$$\n\nIt is assumed that $\\omega_{\\text {eq }}>\\omega_{\\mathrm{p} 1}$. The Bode plot of (5.34) in Fig. 5.7 clearly indicates unconditional stability, as a phase shift of $-180^{\\circ}$ is never reached. Nonetheless, the phase margin can approach $0^{\\circ}$ depending on $L_{0}, \\omega_{p}$, and $\\omega_{\\text {eq }}$.\n\nAt frequencies significantly higher than the dominant pole frequency, $\\omega \\gg \\omega_{\\mathrm{p} 1}$, it can be observed that $1+j \\omega / \\omega_{\\mathrm{p} 1} \\cong j \\omega / \\omega_{\\mathrm{p} 1}$, allowing (5.34) to be accurately approximated by\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s}) \\cong \\frac{\\omega_{\\mathrm{t}}}{\\mathrm{~s}\\left(1+\\mathrm{s} / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.35}\n\\end{equation*}\n$$\n\nKey Point: All-pole second-order feedback systems are unconditionally stable with a phase margin ranging from 90 to 0 degrees.\n\nThis approximation is particularly valid at the loop's unity-gain frequency $\\omega_{\\mathrm{t}}$ (which is currently of interest) and is almost certainly much greater than $\\omega_{\\mathrm{p} 1}$, provided $\\mathrm{L}_{0}$ » 1.\n\nSince $L(s)=\\beta A(s)$, where $\\beta$ is a scalar constant, the poles are derived from the forward amplifier, $\\mathrm{A}(\\mathrm{s})$. Using (5.34), we can define $\\mathrm{A}_{0}=\\mathrm{L}_{0} / \\beta$ as the dc gain of $\\mathrm{A}(\\mathrm{s})$ and $\\omega_{\\mathrm{ta}}=\\mathrm{A}_{0} \\omega_{\\mathrm{p} 1}$ as the approximate unity-gain frequency of $\\mathrm{A}(\\mathrm{s})$ under a dominant pole approximation. Thus, at frequencies around $\\omega_{\\mathrm{t}}$, the loop gain, $L(\\mathrm{~s})$, is expressed as\n\n$$\n\\begin{equation*}\nL(s)=\\beta A(s)=\\frac{\\beta \\omega_{\\mathrm{ta}}}{s\\left(1+s / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.36}\n\\end{equation*}\n$$\n\nThe unity-gain frequency, $\\omega_{\\mathrm{t}}$, can be determined by setting the magnitude of (5.36) to unity after substituting $\\mathrm{s}=\\mathrm{j} \\omega_{\\mathrm{t}}$. Upon rearranging the equation, we obtain,\n\n$$\n\\begin{equation*}\n\\beta \\frac{\\omega_{\\mathrm{ta}}}{\\omega_{\\mathrm{eq}}}=\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}} \\sqrt{1+\\left(\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}}\\right)^{2}} \\tag{5.37}\n\\end{equation*}\n$$\n\nFor the special case where the unity-gain frequency is much lower than the equivalent nondominant pole frequency (i.e., $\\omega_{\\mathrm{t}}$ « $\\omega_{\\text {eq }}$ ), (5.37) can be simplified to\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{ta}}=\\frac{\\omega_{\\mathrm{t}}}{\\beta} \\sqrt{1+\\left(\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}}\\right)^{2}} \\cong \\frac{\\omega_{\\mathrm{t}}}{\\beta} \\tag{5.38}\n\\end{equation*}\n$$\n\nFrom (5.36), the phase shift, $\\angle \\mathrm{L}(\\omega)$, is determined as\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}(\\omega)=-90^{\\circ}-\\tan ^{-1}\\left(\\omega / \\omega_{\\mathrm{eq}}\\right) \\tag{5.39}\n\\end{equation*}\n$$\n\nThis equation implies that at the unity-gain frequency, $\\omega=\\omega_{\\mathrm{t}}$, we have\n\n$$\n\\begin{equation*}\n\\mathrm{PM}=\\angle \\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)-\\left(-180^{\\circ}\\right)=90^{\\circ}-\\tan ^{-1}\\left(\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}}\\right) \\tag{5.40}\n\\end{equation*}\n$$\n\nand, therefore,\n\nKey Point: The process of designing or modifying a feedback amplifier to achieve a specific phase margin is known as compensation.\n\n$$\n\\begin{align*}\n\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}} & =\\tan \\left(90^{\\circ}-\\mathrm{PM}\\right)  \\tag{5.41}\\\\\n\\Rightarrow \\omega_{\\mathrm{t}} & =\\tan \\left(90^{\\circ}-\\mathrm{PM}\\right) \\omega_{\\mathrm{eq}}\n\\end{align*}\n$$\n\nEquation (5.41) specifies the required $\\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}$ for a given phase margin. The process of designing or modifying a feedback amplifier to meet the $\\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}$ ratio required by (5.41) for a target phase margin is termed compensation.\n\n#### EXAMPLE 5.7\n\nA closed-loop amplifier is required to have a $75^{\\circ}$ phase margin with $\\beta=1$. What is the necessary unity-gain frequency $f_{t}$ if $f_{\\text {eq }}=\\omega_{\\text {eq }} /(2 \\pi)=50 \\mathrm{MHz}$? What is the required $f_{\\mathrm{ta}}$?\n\n#### Solution\n\nUsing (5.40), we find $\\omega_{\\mathrm{t}}=0.268 \\omega_{\\text {eq }}$, indicating that the loop-gain unity-gain frequency is $f_{t}=\\omega_{t} / 2 \\pi=13.4 \\mathrm{MHz}$. Using (5.38), for $\\beta=1$, we get $\\omega_{\\mathrm{ta}}=\\omega_{\\mathrm{t}} \\sqrt{1+0.268^{2}}=1.035 \\omega_{\\mathrm{t}}$, implying $\\mathrm{f}_{\\mathrm{ta}}=\\omega_{\\mathrm{ta}} / 2 \\pi=13.9 \\mathrm{MHz}$.\n\nThe closed-loop response of a second-order feedback amplifier can be derived by substituting (5.34) into (5.8) and rearranging, resulting in\n\n$$\n\\begin{equation*}\n\\mathrm{A}_{\\mathrm{CL}}(\\mathrm{~s})=\\frac{\\mathrm{A}_{\\mathrm{CL} 0}}{1+\\frac{\\mathrm{s}\\left(1 / \\omega_{\\mathrm{p} 1}+1 / \\omega_{\\mathrm{eq}}\\right)}{1+\\mathrm{L}_{0}}+\\frac{\\mathrm{s}^{2}}{\\left(1+\\mathrm{L}_{0}\\right)\\left(\\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}\\right)}} \\tag{5.42}\n\\end{equation*}\n$$\n\nwhere\n\n$$\n\\begin{equation*}\nA_{C L 0} \\equiv \\frac{\\mathrm{~L}_{0} / \\beta}{1+\\mathrm{L}_{0}} \\cong \\frac{1}{\\beta} \\tag{5.43}\n\\end{equation*}\n$$\n\nTable 5.1 The relationship between $\\mathrm{PM}, \\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}, Q$ factor, and percentage overshoot\n\n| PM <br> (Phase margin) | $\\omega_{\\mathbf{t}} / \\omega_{\\text {eq }}$ | Q factor | Percentage <br> overshoot for a <br> step input |\n| :---: | :---: | :---: | :---: |\n| $55^{\\circ}$ | 0.700 | 0.925 | $13.3 \\%$ |\n| $60^{\\circ}$ | 0.580 | 0.817 | $8.7 \\%$ |\n| $65^{\\circ}$ | 0.470 | 0.717 | $4.7 \\%$ |\n| $70^{\\circ}$ | 0.360 | 0.622 | $1.4 \\%$ |\n| $75^{\\circ}$ | 0.270 | 0.527 | $0.008 \\%$ |\n| $80^{\\circ}$ | 0.175 | 0.421 | - |\n| $85^{\\circ}$ | 0.087 | 0.296 | - |\n\nThus, the closed-loop response is also second-order. The general equation for a second-order all-pole transfer function is\n\n$$\n\\begin{equation*}\nH(s)=\\frac{K \\omega_{0}^{2}}{s^{2}+\\left(\\frac{\\omega_{0}}{Q}\\right) s+\\omega_{0}^{2}}=\\frac{K}{1+\\frac{s}{\\omega_{0} Q}+\\frac{s^{2}}{\\omega_{0}^{2}}} \\tag{5.44}\n\\end{equation*}\n$$\n\nRecall from the previous chapter that $\\omega_{0}$ is termed the resonant frequency, and the parameter Q is known as the Q factor ${ }^{5}$ [Sedra, 1991]. If $\\mathrm{Q}=\\sqrt{1 / 2} \\cong 0.707$, the magnitude response will exhibit a -3 dB frequency equal to $\\omega_{0}$. Lower Q-factors $(\\mathrm{Q}<\\sqrt{1 / 2}$ ) lead to reduced bandwidth, while higher Q-factors $(\\mathrm{Q}>\\sqrt{1 / 2}$ ) cause peaking in the frequency response. Additionally, recall that if $Q \\leq 0.5$, both poles of $A_{C L}(s)$ are real, resulting in no overshoot in the feedback amplifier's step response. When $Q>0.5$, the percentage overshoot of the step response is given by\n\n$$\n\\begin{equation*}\n\\% \\text { overshoot }=100 e^{\\frac{-\\pi}{\\sqrt{4 Q^{2}-1}}} \\tag{5.45}\n\\end{equation*}\n$$\n\nBy equating (5.42) with (5.44) and solving for $\\omega_{0}$ and Q, we obtain\n\n$$\n\\begin{equation*}\n\\omega_{0}=\\sqrt[t]{\\left(1+\\mathrm{L}_{0}\\right)\\left(\\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}\\right)} \\cong \\sqrt{\\omega_{i} \\omega_{\\mathrm{eq}}} \\tag{5.46}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{equation*}\nQ=\\frac{\\sqrt{\\left(1+\\mathrm{L}_{0}\\right) / \\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}}}{1 / \\omega_{\\mathrm{p} 1}+1 / \\omega_{\\mathrm{eq}}} \\cong \\sqrt{\\frac{\\mathrm{~L}_{0} \\omega_{\\mathrm{p} 1}}{\\omega_{\\mathrm{eq}}}}=\\sqrt{\\frac{\\beta \\omega_{\\mathrm{ta}}}{\\omega_{\\mathrm{eq}}}} \\tag{5.47}\n\\end{equation*}\n$$\n\nwhere the approximation on $Q$ is valid since $L_{0}>>1$ and $\\omega_{\\mathrm{p} 1}<<\\omega_{\\mathrm{eq}}$.\nIt is now possible to relate a specified phase margin to the Q factor of the resulting closed-loop amplifier. Equation (5.41) can be used to find $\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}}$. This result can be substituted into (5.37) to find $\\beta\\left(\\omega_{\\mathrm{ta}} / \\omega_{\\mathrm{eq}}\\right)$, which can then be substituted into (5.47) to determine the equivalent Q factor. Finally, (5.45) can be used to find the corresponding percentage overshoot for a step input. This procedure yields the information in Table 5.1.\n\nTable 5.1 leads to some interesting observations. First, a frequency response with $Q \\cong \\sqrt{1 / 2}$ roughly corresponds to a phase margin of $65^{\\circ}$. Therefore, a common specification is to design for a phase margin of at least $65^{\\circ}$ to avoid peaking in the closed-loop amplifier's frequency response, considering both process and temperature changes. If no overshoot for a step input is desired, the phase margin should be at least $75^{\\circ}$, again accounting for process and temperature variations. Hence, a nominal phase margin of $80^{\\circ}$ to $85^{\\circ}$ is often targeted to accommodate these variations.\n5. The Q factor is $1 / 2$ times the inverse of the damping factor. The damping factor is an alternative method of indicating the pole locations in second-order transfer functions.\n\nFinally, it is worth noting that when an amplifier is designed for use with various feedback networks, the worst-case phase margin occurs for the maximum value of $\\beta$, which corresponds to the smallest closed-loop gain. Thus, the amplifier is designed to have a sufficient phase margin for the maximum $\\beta$. This ensures that it will have an even greater phase margin for all other $\\beta$ values, although it may be sub-optimally compensated and slower than necessary in these cases."
},
{
    "text": "While first-order feedback amplifiers possess numerous favorable traits, practical feedback amplifiers typically feature multiple poles. The primary goal in designing the amplifier $A$ is to achieve a high low-frequency gain. However, the maximum gain achievable with a single transistor, defined by its intrinsic gain $A_{i}=g_{m} r_{d s}$, is often inadequate. Consequently, multiple transistors must be used, leading to a more intricate circuit with several nodes and, unavoidably, multiple poles.\n\nA standard second-order feedback loop transfer function is given by,\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s})=\\frac{\\mathrm{L}_{0}}{\\left(1+\\mathrm{s} / \\omega_{\\mathrm{p} 1}\\right)\\left(1+\\mathrm{s} / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.34}\n\\end{equation*}\n$$\n\nIt is presumed that $\\omega_{\\text {eq }}>\\omega_{\\mathrm{p} 1}$. The Bode plot of (5.34) in Fig. 5.7 clearly indicates unconditional stability, as a phase shift of $-180^{\\circ}$ is never reached. Nonetheless, the phase margin can approach $0^{\\circ}$ depending on $L_{0}, \\omega_{p}$, and $\\omega_{\\text {eq }}$.\n\nAt frequencies significantly higher than the dominant pole frequency, $\\omega \\gg \\omega_{\\mathrm{p} 1}$, it can be observed that $1+j \\omega / \\omega_{\\mathrm{p} 1} \\cong j \\omega / \\omega_{\\mathrm{p} 1}$, allowing (5.34) to be accurately approximated by\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s}) \\cong \\frac{\\omega_{\\mathrm{t}}}{\\mathrm{~s}\\left(1+\\mathrm{s} / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.35}\n\\end{equation*}\n$$\n\nKey Point: All-pole second-order feedback systems are unconditionally stable with a phase margin ranging from 90 to 0 degrees.\n\nThis approximation is particularly valid at the loop's unity-gain frequency $\\omega_{\\mathrm{t}}$ (which is currently of interest) and is almost certainly much greater than $\\omega_{\\mathrm{p} 1}$, provided $\\mathrm{L}_{0}$ » 1.\n\nSince $L(s)=\\beta A(s)$, where $\\beta$ is a scalar constant, it is evident that the poles are contributed by the forward amplifier, $\\mathrm{A}(\\mathrm{s})$. Using (5.34), we can define $\\mathrm{A}_{0}=\\mathrm{L}_{0} / \\beta$ as the dc gain of $\\mathrm{A}(\\mathrm{s})$ and $\\omega_{\\mathrm{ta}}=\\mathrm{A}_{0} \\omega_{\\mathrm{p} 1}$ as the approximate unity-gain frequency of $\\mathrm{A}(\\mathrm{s})$ under a dominant pole approximation. Thus, at frequencies around $\\omega_{\\mathrm{t}}$, the loop gain, $L(\\mathrm{~s})$, is expressed as\n\n$$\n\\begin{equation*}\nL(s)=\\beta A(s)=\\frac{\\beta \\omega_{\\mathrm{ta}}}{s\\left(1+s / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.36}\n\\end{equation*}\n$$\n\nThe unity-gain frequency, $\\omega_{\\mathrm{t}}$, can be determined by setting the magnitude of (5.36) to unity after substituting $\\mathrm{s}=\\mathrm{j} \\omega_{\\mathrm{t}}$. Upon rearranging the equation, we obtain,\n\n$$\n\\begin{equation*}\n\\beta \\frac{\\omega_{\\mathrm{ta}}}{\\omega_{\\mathrm{eq}}}=\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}} \\sqrt{1+\\left(\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}}\\right)^{2}} \\tag{5.37}\n\\end{equation*}\n$$\n\nFor the special case where the unity-gain frequency is much lower than the equivalent nondominant pole frequency (i.e., $\\omega_{\\mathrm{t}}$ « $\\omega_{\\text {eq }}$ ), (5.37) can be simplified to\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{ta}}=\\frac{\\omega_{\\mathrm{t}}}{\\beta} \\sqrt{1+\\left(\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}}\\right)^{2}} \\cong \\frac{\\omega_{\\mathrm{t}}}{\\beta} \\tag{5.38}\n\\end{equation*}\n$$\n\nFrom (5.36), the phase shift, $\\angle \\mathrm{L}(\\omega)$, is derived as\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}(\\omega)=-90^{\\circ}-\\tan ^{-1}\\left(\\omega / \\omega_{\\mathrm{eq}}\\right) \\tag{5.39}\n\\end{equation*}\n$$\n\nThis equation suggests that at the unity-gain frequency, $\\omega=\\omega_{\\mathrm{t}}$, we have\n\n$$\n\\begin{equation*}\n\\mathrm{PM}=\\angle \\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)-\\left(-180^{\\circ}\\right)=90^{\\circ}-\\tan ^{-1}\\left(\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}}\\right) \\tag{5.40}\n\\end{equation*}\n$$\n\nand, consequently,\n\nKey Point: The process of designing or modifying a feedback amplifier to achieve a specific phase margin is known as compensation.\n\n$$\n\\begin{align*}\n\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}} & =\\tan \\left(90^{\\circ}-\\mathrm{PM}\\right)  \\tag{5.41}\\\\\n\\Rightarrow \\omega_{\\mathrm{t}} & =\\tan \\left(90^{\\circ}-\\mathrm{PM}\\right) \\omega_{\\mathrm{eq}}\n\\end{align*}\n$$\n\nEquation (5.41) specifies the required $\\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}$ for a given phase margin. The process of designing or modifying a feedback amplifier to meet the $\\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}$ ratio specified by (5.41) for a target phase margin is termed compensation.\n\n#### EXAMPLE 5.7\n\nA closed-loop amplifier is required to have a $75^{\\circ}$ phase margin with $\\beta=1$. What is the necessary unity-gain frequency $f_{t}$ if $f_{\\text {eq }}=\\omega_{\\text {eq }} /(2 \\pi)=50 \\mathrm{MHz}$? What is the required $f_{\\mathrm{ta}}$?\n\n#### Solution\n\nUsing (5.40), we find $\\omega_{\\mathrm{t}}=0.268 \\omega_{\\text {eq }}$, indicating that the loop-gain unity-gain frequency is $f_{t}=\\omega_{t} / 2 \\pi=13.4 \\mathrm{MHz}$. From (5.38), for $\\beta=1$, we get $\\omega_{\\mathrm{ta}}=\\omega_{\\mathrm{t}} \\sqrt{1+0.268^{2}}=1.035 \\omega_{\\mathrm{t}}$, implying $\\mathrm{f}_{\\mathrm{ta}}=\\omega_{\\mathrm{ta}} / 2 \\pi=13.9 \\mathrm{MHz}$.\n\nThe closed-loop response of a second-order feedback amplifier can be determined by substituting (5.34) into (5.8) and rearranging, yielding\n\n$$\n\\begin{equation*}\n\\mathrm{A}_{\\mathrm{CL}}(\\mathrm{~s})=\\frac{\\mathrm{A}_{\\mathrm{CL} 0}}{1+\\frac{\\mathrm{s}\\left(1 / \\omega_{\\mathrm{p} 1}+1 / \\omega_{\\mathrm{eq}}\\right)}{1+\\mathrm{L}_{0}}+\\frac{\\mathrm{s}^{2}}{\\left(1+\\mathrm{L}_{0}\\right)\\left(\\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}\\right)}} \\tag{5.42}\n\\end{equation*}\n$$\n\nwhere\n\n$$\n\\begin{equation*}\nA_{C L 0} \\equiv \\frac{\\mathrm{~L}_{0} / \\beta}{1+\\mathrm{L}_{0}} \\cong \\frac{1}{\\beta} \\tag{5.43}\n\\end{equation*}\n$$\n\nTable 5.1 The relationship between $\\mathrm{PM}, \\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}, Q$ factor, and percentage overshoot\n\n| PM <br> (Phase margin) | $\\omega_{\\mathbf{t}} / \\omega_{\\text {eq }}$ | Q factor | Percentage <br> overshoot for a <br> step input |\n| :---: | :---: | :---: | :---: |\n| $55^{\\circ}$ | 0.700 | 0.925 | $13.3 \\%$ |\n| $60^{\\circ}$ | 0.580 | 0.817 | $8.7 \\%$ |\n| $65^{\\circ}$ | 0.470 | 0.717 | $4.7 \\%$ |\n| $70^{\\circ}$ | 0.360 | 0.622 | $1.4 \\%$ |\n| $75^{\\circ}$ | 0.270 | 0.527 | $0.008 \\%$ |\n| $80^{\\circ}$ | 0.175 | 0.421 | - |\n| $85^{\\circ}$ | 0.087 | 0.296 | - |\n\nThus, the closed-loop response is also second-order. The general equation for a second-order all-pole transfer function is\n\n$$\n\\begin{equation*}\nH(s)=\\frac{K \\omega_{0}^{2}}{s^{2}+\\left(\\frac{\\omega_{0}}{Q}\\right) s+\\omega_{0}^{2}}=\\frac{K}{1+\\frac{s}{\\omega_{0} Q}+\\frac{s^{2}}{\\omega_{0}^{2}}} \\tag{5.44}\n\\end{equation*}\n$$\n\nRecall from the previous chapter that $\\omega_{0}$ is termed the resonant frequency, and the parameter Q is the Q factor ${ }^{5}$ [Sedra, 1991]. If $\\mathrm{Q}=\\sqrt{1 / 2} \\cong 0.707$, the magnitude response will exhibit a -3 dB frequency equal to $\\omega_{0}$. Lower Q factors $(\\mathrm{Q}<\\sqrt{1 / 2}$ ) result in reduced bandwidth, whereas higher Q factors $(\\mathrm{Q}>\\sqrt{1 / 2}$ ) lead to peaking in the frequency response. Additionally, remember that if $Q \\leq 0.5$, both poles of $A_{C L}(s)$ are real, resulting in no overshoot in the feedback amplifier's step response. When $Q>0.5$, the percentage overshoot of the step response is given by\n\n$$\n\\begin{equation*}\n\\% \\text { overshoot }=100 e^{\\frac{-\\pi}{\\sqrt{4 Q^{2}-1}}} \\tag{5.45}\n\\end{equation*}\n$$\n\nEquating (5.42) with (5.44) and solving for $\\omega_{0}$ and Q yields\n\n$$\n\\begin{equation*}\n\\omega_{0}=\\sqrt[t]{\\left(1+\\mathrm{L}_{0}\\right)\\left(\\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}\\right)} \\cong \\sqrt{\\omega_{i} \\omega_{\\mathrm{eq}}} \\tag{5.46}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{equation*}\nQ=\\frac{\\sqrt{\\left(1+\\mathrm{L}_{0}\\right) / \\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}}}{1 / \\omega_{\\mathrm{p} 1}+1 / \\omega_{\\mathrm{eq}}} \\cong \\sqrt{\\frac{\\mathrm{~L}_{0} \\omega_{\\mathrm{p} 1}}{\\omega_{\\mathrm{eq}}}}=\\sqrt{\\frac{\\beta \\omega_{\\mathrm{ta}}}{\\omega_{\\mathrm{eq}}}} \\tag{5.47}\n\\end{equation*}\n$$\n\nwhere the approximation on $Q$ holds since $L_{0}>>1$ and $\\omega_{\\mathrm{p} 1}<<\\omega_{\\mathrm{eq}}$.\nIt is now possible to relate a specified phase margin to the Q factor of the resulting closed-loop amplifier. Equation (5.41) can be used to determine $\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}}$. This result can be substituted into (5.37) to find $\\beta\\left(\\omega_{\\mathrm{ta}} / \\omega_{\\mathrm{eq}}\\right)$, which can then be substituted into (5.47) to find the equivalent Q factor. Finally, (5.45) can be used to determine the corresponding percentage overshoot for a step input. This procedure yields the data in Table 5.1.\n\nTable 5.1 leads to some insightful observations. First, a frequency response with $Q \\cong \\sqrt{1 / 2}$ roughly corresponds to a phase margin of $65^{\\circ}$. Therefore, a common specification is to design for a phase margin of at least $65^{\\circ}$ to avoid peaking in the closed-loop amplifier's frequency response, considering both process and temperature changes. If no overshoot for a step input is desired, the phase margin should be at least $75^{\\circ}$, again accounting for process and temperature variations. Hence, a nominal phase margin of $80^{\\circ}$ to $85^{\\circ}$ is often targeted to accommodate these variations.\n5. The Q factor is $1 / 2$ times the inverse of the damping factor. The damping factor is another method of indicating the pole locations in second-order transfer functions.\n\nFinally, it is worth noting that when an amplifier is designed for use with various feedback networks, the worst-case phase margin occurs for the maximum value of $\\beta$, which corresponds to the smallest closed-loop gain. Thus, the amplifier is designed to ensure sufficient phase margin for the maximum $\\beta$. This guarantees that it will have an even greater phase margin for all other $\\beta$ values, although it may be sub-optimally compensated and slower than necessary in these cases."
},
{
    "text": "While first-order feedback amplifiers possess several advantageous traits, practical feedback amplifiers typically feature multiple poles. The primary goal in designing amplifier $A$ is to achieve a high low-frequency gain. However, the maximum gain achievable with a single transistor, defined by its intrinsic gain $A_{i}=g_{m} r_{d s}$, is often inadequate. Consequently, multiple transistors must be integrated, resulting in a more intricate circuit with several nodes and, inevitably, multiple poles.\n\nA general second-order feedback loop transfer function is given by,\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s})=\\frac{\\mathrm{L}_{0}}{\\left(1+\\mathrm{s} / \\omega_{\\mathrm{p} 1}\\right)\\left(1+\\mathrm{s} / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.34}\n\\end{equation*}\n$$\n\nIt is assumed that $\\omega_{\\text {eq }}>\\omega_{\\mathrm{p} 1}$. The Bode plot of (5.34) in Fig. 5.7 clearly indicates unconditional stability, as a phase shift of $-180^{\\circ}$ is never reached. Nonetheless, the phase margin may approach $0^{\\circ}$ depending on $L_{0}, \\omega_{p}$, and $\\omega_{\\text {eq }}$.\n\nAt frequencies significantly higher than the dominant pole frequency, $\\omega \\gg \\omega_{\\mathrm{p} 1}$, it can be observed that $1+j \\omega / \\omega_{\\mathrm{p} 1} \\cong j \\omega / \\omega_{\\mathrm{p} 1}$, allowing (5.34) to be accurately approximated by\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s}) \\cong \\frac{\\omega_{\\mathrm{t}}}{\\mathrm{~s}\\left(1+\\mathrm{s} / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.35}\n\\end{equation*}\n$$\n\nKey Point: All-pole second-order feedback systems are unconditionally stable with a phase margin ranging from 90 to 0 degrees.\n\nThis approximation is particularly valid at the loop's unity-gain frequency $\\omega_{\\mathrm{t}}$ (which is currently of interest) and is almost certainly much greater than $\\omega_{\\mathrm{p} 1}$, provided $\\mathrm{L}_{0}$ » 1.\n\nSince $L(s)=\\beta A(s)$, where $\\beta$ is a scalar constant, the poles are derived from the forward amplifier, $\\mathrm{A}(\\mathrm{s})$. Using (5.34), we can define $\\mathrm{A}_{0}=\\mathrm{L}_{0} / \\beta$ as the dc gain of $\\mathrm{A}(\\mathrm{s})$ and $\\omega_{\\mathrm{ta}}=\\mathrm{A}_{0} \\omega_{\\mathrm{p} 1}$ as the approximate unity-gain frequency of $\\mathrm{A}(\\mathrm{s})$ under a dominant pole approximation. Thus, at frequencies around $\\omega_{\\mathrm{t}}$, the loop gain, $L(\\mathrm{~s})$, is expressed as\n\n$$\n\\begin{equation*}\nL(s)=\\beta A(s)=\\frac{\\beta \\omega_{\\mathrm{ta}}}{s\\left(1+s / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.36}\n\\end{equation*}\n$$\n\nThe unity-gain frequency, $\\omega_{\\mathrm{t}}$, can be determined by setting the magnitude of (5.36) to unity after substituting $\\mathrm{s}=\\mathrm{j} \\omega_{\\mathrm{t}}$. Upon rearranging the equation, we obtain,\n\n$$\n\\begin{equation*}\n\\beta \\frac{\\omega_{\\mathrm{ta}}}{\\omega_{\\mathrm{eq}}}=\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}} \\sqrt{1+\\left(\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}}\\right)^{2}} \\tag{5.37}\n\\end{equation*}\n$$\n\nFor the special case where the unity-gain frequency is much lower than the equivalent nondominant pole frequency (i.e., $\\omega_{\\mathrm{t}}$ « $\\omega_{\\text {eq }}$ ), (5.37) can be simplified to\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{ta}}=\\frac{\\omega_{\\mathrm{t}}}{\\beta} \\sqrt{1+\\left(\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}}\\right)^{2}} \\cong \\frac{\\omega_{\\mathrm{t}}}{\\beta} \\tag{5.38}\n\\end{equation*}\n$$\n\nFrom (5.36), the phase shift, $\\angle \\mathrm{L}(\\omega)$, is determined as\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}(\\omega)=-90^{\\circ}-\\tan ^{-1}\\left(\\omega / \\omega_{\\mathrm{eq}}\\right) \\tag{5.39}\n\\end{equation*}\n$$\n\nThis implies that at the unity-gain frequency, $\\omega=\\omega_{\\mathrm{t}}$, we have\n\n$$\n\\begin{equation*}\n\\mathrm{PM}=\\angle \\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)-\\left(-180^{\\circ}\\right)=90^{\\circ}-\\tan ^{-1}\\left(\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}}\\right) \\tag{5.40}\n\\end{equation*}\n$$\n\nKey Point: The process of designing or modifying a feedback amplifier to achieve a specific phase margin is known as compensation.\n\n$$\n\\begin{align*}\n\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}} & =\\tan \\left(90^{\\circ}-\\mathrm{PM}\\right)  \\tag{5.41}\\\\\n\\Rightarrow \\omega_{\\mathrm{t}} & =\\tan \\left(90^{\\circ}-\\mathrm{PM}\\right) \\omega_{\\mathrm{eq}}\n\\end{align*}\n$$\n\nEquation (5.41) specifies the required $\\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}$ for a given phase margin. Designing or modifying a feedback amplifier to meet the $\\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}$ ratio specified by (5.41) for a target phase margin is termed compensation.\n\n#### EXAMPLE 5.7\n\nA closed-loop amplifier is required to have a $75^{\\circ}$ phase margin with $\\beta=1$. What is the necessary unity-gain frequency $f_{t}$ if $f_{\\text {eq }}=\\omega_{\\text {eq }} /(2 \\pi)=50 \\mathrm{MHz}$? What is the required $f_{\\mathrm{ta}}$?\n\n#### Solution\n\nUsing (5.40), we find $\\omega_{\\mathrm{t}}=0.268 \\omega_{\\text {eq }}$, indicating that the loop-gain unity-gain frequency is $f_{t}=\\omega_{t} / 2 \\pi=13.4 \\mathrm{MHz}$. From (5.38), for $\\beta=1$, we get $\\omega_{\\mathrm{ta}}=\\omega_{\\mathrm{t}} \\sqrt{1+0.268^{2}}=1.035 \\omega_{\\mathrm{t}}$, implying $\\mathrm{f}_{\\mathrm{ta}}=\\omega_{\\mathrm{ta}} / 2 \\pi=13.9 \\mathrm{MHz}$.\n\nThe closed-loop response of a second-order feedback amplifier can be derived by substituting (5.34) into (5.8) and rearranging, yielding\n\n$$\n\\begin{equation*}\n\\mathrm{A}_{\\mathrm{CL}}(\\mathrm{~s})=\\frac{\\mathrm{A}_{\\mathrm{CL} 0}}{1+\\frac{\\mathrm{s}\\left(1 / \\omega_{\\mathrm{p} 1}+1 / \\omega_{\\mathrm{eq}}\\right)}{1+\\mathrm{L}_{0}}+\\frac{\\mathrm{s}^{2}}{\\left(1+\\mathrm{L}_{0}\\right)\\left(\\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}\\right)}} \\tag{5.42}\n\\end{equation*}\n$$\n\nwhere\n\n$$\n\\begin{equation*}\nA_{C L 0} \\equiv \\frac{\\mathrm{~L}_{0} / \\beta}{1+\\mathrm{L}_{0}} \\cong \\frac{1}{\\beta} \\tag{5.43}\n\\end{equation*}\n$$\n\nTable 5.1 The relationship between $\\mathrm{PM}, \\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}, Q$ factor, and percentage overshoot\n\n| PM <br> (Phase margin) | $\\omega_{\\mathbf{t}} / \\omega_{\\text {eq }}$ | Q factor | Percentage <br> overshoot for a <br> step input |\n| :---: | :---: | :---: | :---: |\n| $55^{\\circ}$ | 0.700 | 0.925 | $13.3 \\%$ |\n| $60^{\\circ}$ | 0.580 | 0.817 | $8.7 \\%$ |\n| $65^{\\circ}$ | 0.470 | 0.717 | $4.7 \\%$ |\n| $70^{\\circ}$ | 0.360 | 0.622 | $1.4 \\%$ |\n| $75^{\\circ}$ | 0.270 | 0.527 | $0.008 \\%$ |\n| $80^{\\circ}$ | 0.175 | 0.421 | - |\n| $85^{\\circ}$ | 0.087 | 0.296 | - |\n\nThus, the closed-loop response is also second-order. The general equation for a second-order all-pole transfer function is\n\n$$\n\\begin{equation*}\nH(s)=\\frac{K \\omega_{0}^{2}}{s^{2}+\\left(\\frac{\\omega_{0}}{Q}\\right) s+\\omega_{0}^{2}}=\\frac{K}{1+\\frac{s}{\\omega_{0} Q}+\\frac{s^{2}}{\\omega_{0}^{2}}} \\tag{5.44}\n\\end{equation*}\n$$\n\nRecall from the previous chapter that $\\omega_{0}$ is termed the resonant frequency, and the parameter Q is the Q factor ${ }^{5}$ [Sedra, 1991]. If $\\mathrm{Q}=\\sqrt{1 / 2} \\cong 0.707$, the magnitude response will have a -3 dB frequency equal to $\\omega_{0}$. Lower Q factors $(\\mathrm{Q}<\\sqrt{1 / 2}$ ) result in reduced bandwidth, while higher Q factors $(\\mathrm{Q}>\\sqrt{1 / 2}$ ) lead to peaking in the frequency response. Additionally, if $Q \\leq 0.5$, both poles of $A_{C L}(s)$ are real, resulting in no overshoot in the feedback amplifier's step response. When $Q>0.5$, the percentage overshoot of the step response is given by\n\n$$\n\\begin{equation*}\n\\% \\text { overshoot }=100 e^{\\frac{-\\pi}{\\sqrt{4 Q^{2}-1}}} \\tag{5.45}\n\\end{equation*}\n$$\n\nBy equating (5.42) with (5.44) and solving for $\\omega_{0}$ and Q, we obtain\n\n$$\n\\begin{equation*}\n\\omega_{0}=\\sqrt[t]{\\left(1+\\mathrm{L}_{0}\\right)\\left(\\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}\\right)} \\cong \\sqrt{\\omega_{i} \\omega_{\\mathrm{eq}}} \\tag{5.46}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{equation*}\nQ=\\frac{\\sqrt{\\left(1+\\mathrm{L}_{0}\\right) / \\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}}}{1 / \\omega_{\\mathrm{p} 1}+1 / \\omega_{\\mathrm{eq}}} \\cong \\sqrt{\\frac{\\mathrm{~L}_{0} \\omega_{\\mathrm{p} 1}}{\\omega_{\\mathrm{eq}}}}=\\sqrt{\\frac{\\beta \\omega_{\\mathrm{ta}}}{\\omega_{\\mathrm{eq}}}} \\tag{5.47}\n\\end{equation*}\n$$\n\nwhere the approximation on $Q$ is valid since $L_{0}>>1$ and $\\omega_{\\mathrm{p} 1}<<\\omega_{\\mathrm{eq}}$.\nIt is now possible to relate a specified phase margin to the Q factor of the resulting closed-loop amplifier. Using (5.41) to find $\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}}$, this result can be substituted into (5.37) to determine $\\beta\\left(\\omega_{\\mathrm{ta}} / \\omega_{\\mathrm{eq}}\\right)$, which can then be used in (5.47) to find the equivalent Q factor. Finally, (5.45) can be applied to determine the corresponding percentage overshoot for a step input. This procedure yields the data in Table 5.1.\n\nTable 5.1 reveals some interesting insights. Firstly, a frequency response with $Q \\cong \\sqrt{1 / 2}$ roughly corresponds to a phase margin of $65^{\\circ}$. Consequently, a common design specification is to aim for a phase margin of at least $65^{\\circ}$ to avoid peaking in the closed-loop amplifier's frequency response, considering both process and temperature variations. To ensure no overshoot for a step input, the phase margin should be at least $75^{\\circ}$, again accounting for process and temperature changes. Therefore, a nominal phase margin of $80^{\\circ}$ to $85^{\\circ}$ is often targeted to accommodate these variations.\n5. The Q factor is $1 / 2$ times the inverse of the damping factor. The damping factor is another method of indicating the pole locations in second-order transfer functions.\n\nFinally, it is worth noting that when an amplifier is designed for use with various feedback networks, the worst-case phase margin occurs at the maximum value of $\\beta$, which corresponds to the smallest closed-loop gain. Thus, the amplifier is designed to maintain a sufficient phase margin for the maximum $\\beta$. This ensures that it will have an even greater phase margin for all other $\\beta$ values, although it may be sub-optimally compensated and slower than necessary in these cases."
},
{
    "text": "Although first-order feedback amplifiers possess several favorable traits, practical feedback amplifiers typically feature multiple poles. The primary goal in designing amplifier $A$ is to achieve a high low-frequency gain. However, the maximum gain achievable with a single transistor, defined by its intrinsic gain $A_{i}=g_{m} r_{d s}$, is often inadequate. Consequently, multiple transistors must be used, resulting in a more intricate circuit with several nodes and, inevitably, multiple poles.\n\nA general second-order feedback loop transfer function is given by,\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s})=\\frac{\\mathrm{L}_{0}}{\\left(1+\\mathrm{s} / \\omega_{\\mathrm{p} 1}\\right)\\left(1+\\mathrm{s} / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.34}\n\\end{equation*}\n$$\n\nIt is assumed that $\\omega_{\\text {eq }}>\\omega_{\\mathrm{p} 1}$. The Bode plot of (5.34) in Fig. 5.7 clearly indicates unconditional stability, as a phase shift of $-180^{\\circ}$ is never reached. Nonetheless, the phase margin can approach $0^{\\circ}$ depending on $L_{0}, \\omega_{p}$, and $\\omega_{\\text {eq }}$.\n\nAt frequencies significantly higher than the dominant pole frequency, $\\omega \\gg \\omega_{\\mathrm{p} 1}$, we observe that $1+j \\omega / \\omega_{\\mathrm{p} 1} \\cong j \\omega / \\omega_{\\mathrm{p} 1}$, allowing (5.34) to be accurately approximated by\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s}) \\cong \\frac{\\omega_{\\mathrm{t}}}{\\mathrm{~s}\\left(1+\\mathrm{s} / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.35}\n\\end{equation*}\n$$\n\nKey Point: All-pole second-order feedback systems are unconditionally stable with a phase margin ranging from 90 to 0 degrees.\n\nThis approximation is particularly valid at the loop's unity-gain frequency $\\omega_{\\mathrm{t}}$ (which is currently of interest) and is almost certainly much greater than $\\omega_{\\mathrm{p} 1}$, provided $\\mathrm{L}_{0}$ » 1.\n\nSince $L(s)=\\beta A(s)$, where $\\beta$ is a scalar constant, it is evident that the poles are contributed by the forward amplifier, $\\mathrm{A}(\\mathrm{s})$. Using (5.34), we can define $\\mathrm{A}_{0}=\\mathrm{L}_{0} / \\beta$ as the dc gain of $\\mathrm{A}(\\mathrm{s})$ and $\\omega_{\\mathrm{ta}}=\\mathrm{A}_{0} \\omega_{\\mathrm{p} 1}$ as the approximate unity-gain frequency of $\\mathrm{A}(\\mathrm{s})$ under a dominant pole approximation. Thus, at frequencies around $\\omega_{\\mathrm{t}}$, the loop gain, $L(\\mathrm{~s})$, is expressed as\n\n$$\n\\begin{equation*}\nL(s)=\\beta A(s)=\\frac{\\beta \\omega_{\\mathrm{ta}}}{s\\left(1+s / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.36}\n\\end{equation*}\n$$\n\nThe unity-gain frequency, $\\omega_{\\mathrm{t}}$, can be determined by setting the magnitude of (5.36) to unity after substituting $\\mathrm{s}=\\mathrm{j} \\omega_{\\mathrm{t}}$. Rearranging the equation yields,\n\n$$\n\\begin{equation*}\n\\beta \\frac{\\omega_{\\mathrm{ta}}}{\\omega_{\\mathrm{eq}}}=\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}} \\sqrt{1+\\left(\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}}\\right)^{2}} \\tag{5.37}\n\\end{equation*}\n$$\n\nFor the special case where the unity-gain frequency is much lower than the equivalent nondominant pole frequency (i.e., $\\omega_{\\mathrm{t}}$ « $\\omega_{\\text {eq }}$ ), (5.37) simplifies to\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{ta}}=\\frac{\\omega_{\\mathrm{t}}}{\\beta} \\sqrt{1+\\left(\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}}\\right)^{2}} \\cong \\frac{\\omega_{\\mathrm{t}}}{\\beta} \\tag{5.38}\n\\end{equation*}\n$$\n\nFrom (5.36), the phase shift, $\\angle \\mathrm{L}(\\omega)$, is derived as\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}(\\omega)=-90^{\\circ}-\\tan ^{-1}\\left(\\omega / \\omega_{\\mathrm{eq}}\\right) \\tag{5.39}\n\\end{equation*}\n$$\n\nThis implies that at the unity-gain frequency, $\\omega=\\omega_{\\mathrm{t}}$, we have\n\n$$\n\\begin{equation*}\n\\mathrm{PM}=\\angle \\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)-\\left(-180^{\\circ}\\right)=90^{\\circ}-\\tan ^{-1}\\left(\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}}\\right) \\tag{5.40}\n\\end{equation*}\n$$\n\nKey Point: The process of designing or modifying a feedback amplifier to achieve a specific phase margin is known as compensation.\n\n$$\n\\begin{align*}\n\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}} & =\\tan \\left(90^{\\circ}-\\mathrm{PM}\\right)  \\tag{5.41}\\\\\n\\Rightarrow \\omega_{\\mathrm{t}} & =\\tan \\left(90^{\\circ}-\\mathrm{PM}\\right) \\omega_{\\mathrm{eq}}\n\\end{align*}\n$$\n\nEquation (5.41) specifies the required $\\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}$ for a given phase margin. The process of designing or modifying a feedback amplifier to meet the $\\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}$ ratio specified by (5.41) for a target phase margin is termed compensation.\n\n#### EXAMPLE 5.7\n\nFor a closed-loop amplifier with a $75^{\\circ}$ phase margin and $\\beta=1$, what is the required unity-gain frequency $f_{t}$ if $f_{\\text {eq }}=\\omega_{\\text {eq }} /(2 \\pi)=50 \\mathrm{MHz}$? What is the required $f_{\\mathrm{ta}}$?\n\n#### Solution\n\nUsing (5.40), we find $\\omega_{\\mathrm{t}}=0.268 \\omega_{\\text {eq }}$, indicating that the loop-gain unity-gain frequency is $f_{t}=\\omega_{t} / 2 \\pi=13.4 \\mathrm{MHz}$. From (5.38), for $\\beta=1$, we have $\\omega_{\\mathrm{ta}}=\\omega_{\\mathrm{t}} \\sqrt{1+0.268^{2}}=1.035 \\omega_{\\mathrm{t}}$, implying $\\mathrm{f}_{\\mathrm{ta}}=\\omega_{\\mathrm{ta}} / 2 \\pi=13.9 \\mathrm{MHz}$.\n\nThe closed-loop response of a second-order feedback amplifier can be determined by substituting (5.34) into (5.8) and rearranging, resulting in\n\n$$\n\\begin{equation*}\n\\mathrm{A}_{\\mathrm{CL}}(\\mathrm{~s})=\\frac{\\mathrm{A}_{\\mathrm{CL} 0}}{1+\\frac{\\mathrm{s}\\left(1 / \\omega_{\\mathrm{p} 1}+1 / \\omega_{\\mathrm{eq}}\\right)}{1+\\mathrm{L}_{0}}+\\frac{\\mathrm{s}^{2}}{\\left(1+\\mathrm{L}_{0}\\right)\\left(\\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}\\right)}} \\tag{5.42}\n\\end{equation*}\n$$\n\nwhere\n\n$$\n\\begin{equation*}\nA_{C L 0} \\equiv \\frac{\\mathrm{~L}_{0} / \\beta}{1+\\mathrm{L}_{0}} \\cong \\frac{1}{\\beta} \\tag{5.43}\n\\end{equation*}\n$$\n\nTable 5.1 The relationship between $\\mathrm{PM}, \\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}, Q$ factor, and percentage overshoot\n\n| PM <br> (Phase margin) | $\\omega_{\\mathbf{t}} / \\omega_{\\text {eq }}$ | Q factor | Percentage <br> overshoot for a <br> step input |\n| :---: | :---: | :---: | :---: |\n| $55^{\\circ}$ | 0.700 | 0.925 | $13.3 \\%$ |\n| $60^{\\circ}$ | 0.580 | 0.817 | $8.7 \\%$ |\n| $65^{\\circ}$ | 0.470 | 0.717 | $4.7 \\%$ |\n| $70^{\\circ}$ | 0.360 | 0.622 | $1.4 \\%$ |\n| $75^{\\circ}$ | 0.270 | 0.527 | $0.008 \\%$ |\n| $80^{\\circ}$ | 0.175 | 0.421 | - |\n| $85^{\\circ}$ | 0.087 | 0.296 | - |\n\nThus, the closed-loop response is also second-order. The general equation for a second-order all-pole transfer function is\n\n$$\n\\begin{equation*}\nH(s)=\\frac{K \\omega_{0}^{2}}{s^{2}+\\left(\\frac{\\omega_{0}}{Q}\\right) s+\\omega_{0}^{2}}=\\frac{K}{1+\\frac{s}{\\omega_{0} Q}+\\frac{s^{2}}{\\omega_{0}^{2}}} \\tag{5.44}\n\\end{equation*}\n$$\n\nRecall from the previous chapter that $\\omega_{0}$ is termed the resonant frequency, and the parameter Q is the Q factor ${ }^{5}$ [Sedra, 1991]. If $\\mathrm{Q}=\\sqrt{1 / 2} \\cong 0.707$, the magnitude response will have a -3 dB frequency equal to $\\omega_{0}$. Lower Q factors $(\\mathrm{Q}<\\sqrt{1 / 2}$ ) lead to reduced bandwidth, while higher Q factors $(\\mathrm{Q}>\\sqrt{1 / 2}$ ) cause peaking in the frequency response. Additionally, if $Q \\leq 0.5$, both poles of $A_{C L}(s)$ are real, resulting in no overshoot in the feedback amplifier's step response. When $Q>0.5$, the percentage overshoot of the step response is given by\n\n$$\n\\begin{equation*}\n\\% \\text { overshoot }=100 e^{\\frac{-\\pi}{\\sqrt{4 Q^{2}-1}}} \\tag{5.45}\n\\end{equation*}\n$$\n\nEquating (5.42) with (5.44) and solving for $\\omega_{0}$ and Q yields\n\n$$\n\\begin{equation*}\n\\omega_{0}=\\sqrt[t]{\\left(1+\\mathrm{L}_{0}\\right)\\left(\\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}\\right)} \\cong \\sqrt{\\omega_{i} \\omega_{\\mathrm{eq}}} \\tag{5.46}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{equation*}\nQ=\\frac{\\sqrt{\\left(1+\\mathrm{L}_{0}\\right) / \\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}}}{1 / \\omega_{\\mathrm{p} 1}+1 / \\omega_{\\mathrm{eq}}} \\cong \\sqrt{\\frac{\\mathrm{~L}_{0} \\omega_{\\mathrm{p} 1}}{\\omega_{\\mathrm{eq}}}}=\\sqrt{\\frac{\\beta \\omega_{\\mathrm{ta}}}{\\omega_{\\mathrm{eq}}}} \\tag{5.47}\n\\end{equation*}\n$$\n\nwhere the approximation on $Q$ is valid since $L_{0}>>1$ and $\\omega_{\\mathrm{p} 1}<<\\omega_{\\mathrm{eq}}$.\nIt is now possible to relate a specified phase margin to the Q factor of the resulting closed-loop amplifier. Using (5.41) to find $\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}}$, this result can be substituted into (5.37) to determine $\\beta\\left(\\omega_{\\mathrm{ta}} / \\omega_{\\mathrm{eq}}\\right)$, which can then be used in (5.47) to find the equivalent Q factor. Finally, (5.45) can be applied to determine the corresponding percentage overshoot for a step input. This procedure yields the data in Table 5.1.\n\nTable 5.1 reveals some interesting insights. First, a frequency response with $Q \\cong \\sqrt{1 / 2}$ roughly corresponds to a phase margin of $65^{\\circ}$. Consequently, a common design specification is to aim for a phase margin of at least $65^{\\circ}$ to avoid peaking in the closed-loop amplifier's frequency response, considering both process and temperature variations. To ensure no overshoot for a step input, the phase margin should be at least $75^{\\circ}$, again accounting for process and temperature changes. Therefore, a nominal phase margin of $80^{\\circ}$ to $85^{\\circ}$ is often targeted to accommodate these variations.\n\n5. The Q factor is $1 / 2$ times the inverse of the damping factor. The damping factor is another method of indicating the pole locations in second-order transfer functions.\n\nFinally, it is noteworthy that when an amplifier is designed for use with various feedback networks, the worst-case phase margin occurs at the maximum value of $\\beta$, corresponding to the smallest closed-loop gain. Thus, the amplifier is designed to ensure sufficient phase margin for the maximum $\\beta$. This guarantees that it will have an even greater phase margin for all other $\\beta$ values, although it may be sub-optimally compensated and slower than necessary in these cases."
},
{
    "text": "While first-order feedback amplifiers possess several favorable traits, practical feedback amplifiers typically feature multiple poles. The primary goal in designing the amplifier $A$ is to achieve a high low-frequency gain. However, the maximum gain achievable with a single transistor, defined by its intrinsic gain $A_{i}=g_{m} r_{d s}$, is often inadequate. Consequently, multiple transistors must be combined, leading to a more intricate circuit with several nodes and, unavoidably, multiple poles.\n\nA general second-order feedback loop transfer function is given by,\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s})=\\frac{\\mathrm{L}_{0}}{\\left(1+\\mathrm{s} / \\omega_{\\mathrm{p} 1}\\right)\\left(1+\\mathrm{s} / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.34}\n\\end{equation*}\n$$\n\nIt is assumed that $\\omega_{\\text {eq }}>\\omega_{\\mathrm{p} 1}$. The Bode plot of (5.34) in Fig. 5.7 clearly indicates unconditional stability, as a phase shift of $-180^{\\circ}$ is never reached. Nevertheless, the phase margin may approach $0^{\\circ}$ depending on $L_{0}, \\omega_{p}$, and $\\omega_{\\text {eq }}$.\n\nAt frequencies significantly higher than the dominant pole frequency, $\\omega \\gg \\omega_{\\mathrm{p} 1}$, we observe that $1+j \\omega / \\omega_{\\mathrm{p} 1} \\cong j \\omega / \\omega_{\\mathrm{p} 1}$, allowing (5.34) to be accurately approximated by\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s}) \\cong \\frac{\\omega_{\\mathrm{t}}}{\\mathrm{~s}\\left(1+\\mathrm{s} / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.35}\n\\end{equation*}\n$$\n\nKey Point: All-pole second-order feedback systems are unconditionally stable with a phase margin ranging from 90 to 0 degrees.\n\nThis approximation is particularly valid at the loop's unity-gain frequency $\\omega_{\\mathrm{t}}$ (which is currently of interest) and is almost certainly much greater than $\\omega_{\\mathrm{p} 1}$, provided $\\mathrm{L}_{0}$ » 1.\n\nSince $L(s)=\\beta A(s)$, where $\\beta$ is a scalar constant, it is evident that the poles are contributed by the forward amplifier, $\\mathrm{A}(\\mathrm{s})$. Using (5.34), we can define $\\mathrm{A}_{0}=\\mathrm{L}_{0} / \\beta$ as the dc gain of $\\mathrm{A}(\\mathrm{s})$ and $\\omega_{\\mathrm{ta}}=\\mathrm{A}_{0} \\omega_{\\mathrm{p} 1}$ as the approximate unity-gain frequency of $\\mathrm{A}(\\mathrm{s})$ under a dominant pole approximation. Thus, at frequencies around $\\omega_{\\mathrm{t}}$, the loop gain, $L(\\mathrm{~s})$, is expressed as\n\n$$\n\\begin{equation*}\nL(s)=\\beta A(s)=\\frac{\\beta \\omega_{\\mathrm{ta}}}{s\\left(1+s / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.36}\n\\end{equation*}\n$$\n\nThe unity-gain frequency, $\\omega_{\\mathrm{t}}$, can be determined by setting the magnitude of (5.36) to unity after substituting $\\mathrm{s}=\\mathrm{j} \\omega_{\\mathrm{t}}$. Upon rearranging the equation, we obtain\n\n$$\n\\begin{equation*}\n\\beta \\frac{\\omega_{\\mathrm{ta}}}{\\omega_{\\mathrm{eq}}}=\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}} \\sqrt{1+\\left(\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}}\\right)^{2}} \\tag{5.37}\n\\end{equation*}\n$$\n\nFor the special case where the unity-gain frequency is much lower than the equivalent nondominant pole frequency (i.e., $\\omega_{\\mathrm{t}}$ « $\\omega_{\\text {eq }}$ ), (5.37) can be simplified to\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{ta}}=\\frac{\\omega_{\\mathrm{t}}}{\\beta} \\sqrt{1+\\left(\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}}\\right)^{2}} \\cong \\frac{\\omega_{\\mathrm{t}}}{\\beta} \\tag{5.38}\n\\end{equation*}\n$$\n\nFrom (5.36), the phase shift, $\\angle \\mathrm{L}(\\omega)$, is determined as\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}(\\omega)=-90^{\\circ}-\\tan ^{-1}\\left(\\omega / \\omega_{\\mathrm{eq}}\\right) \\tag{5.39}\n\\end{equation*}\n$$\n\nThis equation implies that at the unity-gain frequency, $\\omega=\\omega_{\\mathrm{t}}$, we have\n\n$$\n\\begin{equation*}\n\\mathrm{PM}=\\angle \\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)-\\left(-180^{\\circ}\\right)=90^{\\circ}-\\tan ^{-1}\\left(\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}}\\right) \\tag{5.40}\n\\end{equation*}\n$$\n\nand, consequently,\n\nKey Point: The process of designing or modifying a feedback amplifier to achieve a specific phase margin is known as compensation.\n\n$$\n\\begin{align*}\n\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}} & =\\tan \\left(90^{\\circ}-\\mathrm{PM}\\right)  \\tag{5.41}\\\\\n\\Rightarrow \\omega_{\\mathrm{t}} & =\\tan \\left(90^{\\circ}-\\mathrm{PM}\\right) \\omega_{\\mathrm{eq}}\n\\end{align*}\n$$\n\nEquation (5.41) specifies the required $\\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}$ for a given phase margin. Designing or modifying a feedback amplifier to achieve the $\\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}$ ratio specified by (5.41) for a target phase margin is termed compensation.\n\n#### EXAMPLE 5.7\n\nA closed-loop amplifier is required to have a $75^{\\circ}$ phase margin with $\\beta=1$. What is the necessary unity-gain frequency $f_{t}$ if $f_{\\text {eq }}=\\omega_{\\text {eq }} /(2 \\pi)=50 \\mathrm{MHz}$? What is the required $f_{\\mathrm{ta}}$?\n\n#### Solution\n\nUsing (5.40), we find $\\omega_{\\mathrm{t}}=0.268 \\omega_{\\text {eq }}$, indicating that the loop-gain unity-gain frequency is $f_{t}=\\omega_{t} / 2 \\pi=13.4 \\mathrm{MHz}$. From (5.38), for $\\beta=1$, we get $\\omega_{\\mathrm{ta}}=\\omega_{\\mathrm{t}} \\sqrt{1+0.268^{2}}=1.035 \\omega_{\\mathrm{t}}$, implying $\\mathrm{f}_{\\mathrm{ta}}=\\omega_{\\mathrm{ta}} / 2 \\pi=13.9 \\mathrm{MHz}$.\n\nThe closed-loop response of a second-order feedback amplifier can be derived by substituting (5.34) into (5.8) and rearranging, resulting in\n\n$$\n\\begin{equation*}\n\\mathrm{A}_{\\mathrm{CL}}(\\mathrm{~s})=\\frac{\\mathrm{A}_{\\mathrm{CL} 0}}{1+\\frac{\\mathrm{s}\\left(1 / \\omega_{\\mathrm{p} 1}+1 / \\omega_{\\mathrm{eq}}\\right)}{1+\\mathrm{L}_{0}}+\\frac{\\mathrm{s}^{2}}{\\left(1+\\mathrm{L}_{0}\\right)\\left(\\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}\\right)}} \\tag{5.42}\n\\end{equation*}\n$$\n\nwhere\n\n$$\n\\begin{equation*}\nA_{C L 0} \\equiv \\frac{\\mathrm{~L}_{0} / \\beta}{1+\\mathrm{L}_{0}} \\cong \\frac{1}{\\beta} \\tag{5.43}\n\\end{equation*}\n$$\n\nTable 5.1 The relationship between $\\mathrm{PM}, \\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}, Q$ factor, and percentage overshoot\n\n| PM <br> (Phase margin) | $\\omega_{\\mathbf{t}} / \\omega_{\\text {eq }}$ | Q factor | Percentage <br> overshoot for a <br> step input |\n| :---: | :---: | :---: | :---: |\n| $55^{\\circ}$ | 0.700 | 0.925 | $13.3 \\%$ |\n| $60^{\\circ}$ | 0.580 | 0.817 | $8.7 \\%$ |\n| $65^{\\circ}$ | 0.470 | 0.717 | $4.7 \\%$ |\n| $70^{\\circ}$ | 0.360 | 0.622 | $1.4 \\%$ |\n| $75^{\\circ}$ | 0.270 | 0.527 | $0.008 \\%$ |\n| $80^{\\circ}$ | 0.175 | 0.421 | - |\n| $85^{\\circ}$ | 0.087 | 0.296 | - |\n\nThus, the closed-loop response is also second-order. The general equation for a second-order all-pole transfer function is\n\n$$\n\\begin{equation*}\nH(s)=\\frac{K \\omega_{0}^{2}}{s^{2}+\\left(\\frac{\\omega_{0}}{Q}\\right) s+\\omega_{0}^{2}}=\\frac{K}{1+\\frac{s}{\\omega_{0} Q}+\\frac{s^{2}}{\\omega_{0}^{2}}} \\tag{5.44}\n\\end{equation*}\n$$\n\nRecall from the previous chapter that $\\omega_{0}$ is termed the resonant frequency and the parameter Q is the Q factor ${ }^{5}$ [Sedra, 1991]. If $\\mathrm{Q}=\\sqrt{1 / 2} \\cong 0.707$, the magnitude response will have a -3 dB frequency equal to $\\omega_{0}$. Lower Q factors $(\\mathrm{Q}<\\sqrt{1 / 2}$ ) result in reduced bandwidth, while higher Q factors $(\\mathrm{Q}>\\sqrt{1 / 2}$ ) lead to peaking in the frequency response. Additionally, if $Q \\leq 0.5$, both poles of $A_{C L}(s)$ are real, resulting in no overshoot in the feedback amplifier's step response. When $Q>0.5$, the percentage overshoot of the step response is given by\n\n$$\n\\begin{equation*}\n\\% \\text { overshoot }=100 e^{\\frac{-\\pi}{\\sqrt{4 Q^{2}-1}}} \\tag{5.45}\n\\end{equation*}\n$$\n\nEquating (5.42) with (5.44) and solving for $\\omega_{0}$ and Q yields\n\n$$\n\\begin{equation*}\n\\omega_{0}=\\sqrt[t]{\\left(1+\\mathrm{L}_{0}\\right)\\left(\\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}\\right)} \\cong \\sqrt{\\omega_{i} \\omega_{\\mathrm{eq}}} \\tag{5.46}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{equation*}\nQ=\\frac{\\sqrt{\\left(1+\\mathrm{L}_{0}\\right) / \\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}}}{1 / \\omega_{\\mathrm{p} 1}+1 / \\omega_{\\mathrm{eq}}} \\cong \\sqrt{\\frac{\\mathrm{~L}_{0} \\omega_{\\mathrm{p} 1}}{\\omega_{\\mathrm{eq}}}}=\\sqrt{\\frac{\\beta \\omega_{\\mathrm{ta}}}{\\omega_{\\mathrm{eq}}}} \\tag{5.47}\n\\end{equation*}\n$$\n\nwhere the approximation on $Q$ is valid since $L_{0}>>1$ and $\\omega_{\\mathrm{p} 1}<<\\omega_{\\mathrm{eq}}$.\nIt is now possible to relate a specified phase margin to the Q factor of the resulting closed-loop amplifier. Equation (5.41) can be used to find $\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}}$. This result can be substituted into (5.37) to find $\\beta\\left(\\omega_{\\mathrm{ta}} / \\omega_{\\mathrm{eq}}\\right)$, which can then be substituted into (5.47) to determine the equivalent Q factor. Finally, (5.45) can be used to find the corresponding percentage overshoot for a step input. This procedure provides the data in Table 5.1.\n\nTable 5.1 leads to some insightful observations. First, a frequency response with $Q \\cong \\sqrt{1 / 2}$ roughly corresponds to a phase margin of $65^{\\circ}$. Therefore, a common design specification is to aim for a phase margin of at least $65^{\\circ}$ to avoid peaking in the closed-loop amplifier's frequency response, considering both process and temperature variations. If no overshoot for a step input is desired, the phase margin should be at least $75^{\\circ}$, again accounting for process and temperature changes. Hence, a nominal phase margin of $80^{\\circ}$ to $85^{\\circ}$ is often targeted to accommodate these variations.\n5. The Q factor is $1 / 2$ times the inverse of the damping factor. The damping factor is another method of indicating the pole locations in second-order transfer functions.\n\nFinally, it is worth noting that when an amplifier is designed for use with various feedback networks, the worst-case phase margin occurs at the maximum value of $\\beta$, which corresponds to the smallest closed-loop gain. Thus, the amplifier is designed to ensure sufficient phase margin for the maximum $\\beta$. This guarantees that it will have an even greater phase margin for all other $\\beta$ values, although it may be sub-optimally compensated and slower than necessary in these cases."
},
{
    "text": "While first-order feedback amplifiers possess several favorable traits, practical feedback amplifiers typically feature multiple poles. The primary goal in designing the amplifier \\( A \\) is to achieve a high low-frequency gain. However, the maximum gain attainable with a single transistor, defined by its intrinsic gain \\( A_{i} = g_{m} r_{d s} \\), is often inadequate. Consequently, multiple transistors must be combined, resulting in a more intricate circuit with several nodes and, inevitably, multiple poles.\n\nA general second-order feedback loop transfer function is given by:\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s}) = \\frac{\\mathrm{L}_{0}}{\\left(1 + \\mathrm{s} / \\omega_{\\mathrm{p} 1}\\right)\\left(1 + \\mathrm{s} / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.34}\n\\end{equation*}\n$$\n\nIt is assumed that \\( \\omega_{\\text{eq}} > \\omega_{\\mathrm{p} 1} \\). The Bode plot of (5.34) in Fig. 5.7 clearly indicates unconditional stability, as a phase shift of \\( -180^{\\circ} \\) is never reached. Nonetheless, the phase margin can approach \\( 0^{\\circ} \\) depending on \\( L_{0}, \\omega_{p}, \\) and \\( \\omega_{\\text{eq}} \\).\n\nAt frequencies significantly higher than the dominant pole frequency, \\( \\omega \\gg \\omega_{\\mathrm{p} 1} \\), we observe that \\( 1 + j \\omega / \\omega_{\\mathrm{p} 1} \\approx j \\omega / \\omega_{\\mathrm{p} 1} \\), allowing (5.34) to be accurately approximated by:\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s}) \\approx \\frac{\\omega_{\\mathrm{t}}}{\\mathrm{~s}\\left(1 + \\mathrm{s} / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.35}\n\\end{equation*}\n$$\n\nKey Point: All-pole second-order feedback systems are unconditionally stable with a phase margin ranging from 90 to 0 degrees.\n\nThis approximation is particularly valid at the loop's unity-gain frequency \\( \\omega_{\\mathrm{t}} \\) (our current focus), which is almost certainly much greater than \\( \\omega_{\\mathrm{p} 1} \\) as long as \\( \\mathrm{L}_{0} \\gg 1 \\).\n\nSince \\( L(s) = \\beta A(s) \\) where \\( \\beta \\) is a scalar constant, it is evident that the poles are contributed by the forward amplifier, \\( \\mathrm{A}(\\mathrm{s}) \\). Using (5.34), we can define \\( \\mathrm{A}_{0} = \\mathrm{L}_{0} / \\beta \\) as the dc gain of \\( \\mathrm{A}(\\mathrm{s}) \\) and \\( \\omega_{\\mathrm{ta}} = \\mathrm{A}_{0} \\omega_{\\mathrm{p} 1} \\) as the approximate unity-gain frequency of \\( \\mathrm{A}(\\mathrm{s}) \\) under a dominant pole approximation. Thus, at frequencies around \\( \\omega_{\\mathrm{t}} \\), the loop gain, \\( L(\\mathrm{~s}) \\), is expressed as:\n\n$$\n\\begin{equation*}\nL(s) = \\beta A(s) = \\frac{\\beta \\omega_{\\mathrm{ta}}}{s\\left(1 + s / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.36}\n\\end{equation*}\n$$\n\nThe unity-gain frequency, \\( \\omega_{\\mathrm{t}} \\), can be determined by setting the magnitude of (5.36) to unity after substituting \\( \\mathrm{s} = \\mathrm{j} \\omega_{\\mathrm{t}} \\). Upon rearranging the equation, we obtain:\n\n$$\n\\begin{equation*}\n\\beta \\frac{\\omega_{\\mathrm{ta}}}{\\omega_{\\mathrm{eq}}} = \\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}} \\sqrt{1 + \\left(\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}}\\right)^{2}} \\tag{5.37}\n\\end{equation*}\n$$\n\nFor the special case where the unity-gain frequency is much lower than the equivalent nondominant pole frequency (i.e., \\( \\omega_{\\mathrm{t}} \\ll \\omega_{\\text{eq}} \\)), (5.37) can be simplified to:\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{ta}} = \\frac{\\omega_{\\mathrm{t}}}{\\beta} \\sqrt{1 + \\left(\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}}\\right)^{2}} \\approx \\frac{\\omega_{\\mathrm{t}}}{\\beta} \\tag{5.38}\n\\end{equation*}\n$$\n\nFrom (5.36), the phase shift, \\( \\angle \\mathrm{L}(\\omega) \\), is determined as:\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}(\\omega) = -90^{\\circ} - \\tan^{-1}\\left(\\omega / \\omega_{\\mathrm{eq}}\\right) \\tag{5.39}\n\\end{equation*}\n$$\n\nThis equation implies that at the unity-gain frequency, \\( \\omega = \\omega_{\\mathrm{t}} \\), we have:\n\n$$\n\\begin{equation*}\n\\mathrm{PM} = \\angle \\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right) - \\left(-180^{\\circ}\\right) = 90^{\\circ} - \\tan^{-1}\\left(\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}}\\right) \\tag{5.40}\n\\end{equation*}\n$$\n\nKey Point: The process of designing or modifying a feedback amplifier to achieve a specific phase margin is known as compensation.\n\n$$\n\\begin{align*}\n\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}} & = \\tan\\left(90^{\\circ} - \\mathrm{PM}\\right) \\tag{5.41}\\\\\n\\Rightarrow \\omega_{\\mathrm{t}} & = \\tan\\left(90^{\\circ} - \\mathrm{PM}\\right) \\omega_{\\mathrm{eq}}\n\\end{align*}\n$$\n\nEquation (5.41) specifies the required \\( \\omega_{\\mathrm{t}} / \\omega_{\\text{eq}} \\) for a given phase margin. Designing or modifying a feedback amplifier to achieve the \\( \\omega_{\\mathrm{t}} / \\omega_{\\text{eq}} \\) ratio required by (5.41) for a targeted phase margin is termed compensation.\n\n#### EXAMPLE 5.7\n\nA closed-loop amplifier is required to have a \\( 75^{\\circ} \\) phase margin with \\( \\beta = 1 \\). What is the necessary unity-gain frequency \\( f_{t} \\) if \\( f_{\\text{eq}} = \\omega_{\\text{eq}} / (2 \\pi) = 50 \\mathrm{MHz} \\)? What is the required \\( f_{\\mathrm{ta}} \\)?\n\n#### Solution\n\nUsing (5.40), we find \\( \\omega_{\\mathrm{t}} = 0.268 \\omega_{\\text{eq}} \\), indicating that the loop-gain unity-gain frequency is \\( f_{t} = \\omega_{t} / 2 \\pi = 13.4 \\mathrm{MHz} \\). From (5.38), for \\( \\beta = 1 \\), \\( \\omega_{\\mathrm{ta}} = \\omega_{\\mathrm{t}} \\sqrt{1 + 0.268^{2}} = 1.035 \\omega_{\\mathrm{t}} \\), implying \\( \\mathrm{f}_{\\mathrm{ta}} = \\omega_{\\mathrm{ta}} / 2 \\pi = 13.9 \\mathrm{MHz} \\).\n\nThe closed-loop response of a second-order feedback amplifier can be derived by substituting (5.34) into (5.8) and rearranging:\n\n$$\n\\begin{equation*}\n\\mathrm{A}_{\\mathrm{CL}}(\\mathrm{~s}) = \\frac{\\mathrm{A}_{\\mathrm{CL} 0}}{1 + \\frac{\\mathrm{s}\\left(1 / \\omega_{\\mathrm{p} 1} + 1 / \\omega_{\\mathrm{eq}}\\right)}{1 + \\mathrm{L}_{0}} + \\frac{\\mathrm{s}^{2}}{\\left(1 + \\mathrm{L}_{0}\\right)\\left(\\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}\\right)}} \\tag{5.42}\n\\end{equation*}\n$$\n\nwhere\n\n$$\n\\begin{equation*}\nA_{C L 0} \\equiv \\frac{\\mathrm{~L}_{0} / \\beta}{1 + \\mathrm{L}_{0}} \\approx \\frac{1}{\\beta} \\tag{5.43}\n\\end{equation*}\n$$\n\nTable 5.1 The relationship between \\( \\mathrm{PM}, \\omega_{\\mathrm{t}} / \\omega_{\\text{eq}}, Q \\) factor, and percentage overshoot\n\n| PM <br> (Phase margin) | \\( \\omega_{\\mathbf{t}} / \\omega_{\\text{eq}} \\) | Q factor | Percentage <br> overshoot for a <br> step input |\n| :---: | :---: | :---: | :---: |\n| \\( 55^{\\circ} \\) | 0.700 | 0.925 | \\( 13.3 \\% \\) |\n| \\( 60^{\\circ} \\) | 0.580 | 0.817 | \\( 8.7 \\% \\) |\n| \\( 65^{\\circ} \\) | 0.470 | 0.717 | \\( 4.7 \\% \\) |\n| \\( 70^{\\circ} \\) | 0.360 | 0.622 | \\( 1.4 \\% \\) |\n| \\( 75^{\\circ} \\) | 0.270 | 0.527 | \\( 0.008 \\% \\) |\n| \\( 80^{\\circ} \\) | 0.175 | 0.421 | - |\n| \\( 85^{\\circ} \\) | 0.087 | 0.296 | - |\n\nThus, the closed-loop response is also second-order. The general equation for a second-order all-pole transfer function is:\n\n$$\n\\begin{equation*}\nH(s) = \\frac{K \\omega_{0}^{2}}{s^{2} + \\left(\\frac{\\omega_{0}}{Q}\\right) s + \\omega_{0}^{2}} = \\frac{K}{1 + \\frac{s}{\\omega_{0} Q} + \\frac{s^{2}}{\\omega_{0}^{2}}} \\tag{5.44}\n\\end{equation*}\n$$\n\nRecall from the previous chapter that \\( \\omega_{0} \\) is termed the resonant frequency and the parameter \\( Q \\) is known as the Q factor [Sedra, 1991]. If \\( \\mathrm{Q} = \\sqrt{1 / 2} \\approx 0.707 \\), the magnitude response will exhibit a -3 dB frequency equal to \\( \\omega_{0} \\). Lower Q-factors (\\( \\mathrm{Q} < \\sqrt{1 / 2} \\)) result in reduced bandwidth, while higher Q-factors (\\( \\mathrm{Q} > \\sqrt{1 / 2} \\)) cause peaking in the frequency response. Additionally, if \\( Q \\leq 0.5 \\), both poles of \\( A_{C L}(s) \\) are real, leading to no overshoot in the feedback amplifier's step response. For \\( Q > 0.5 \\), the percentage overshoot of the step response is given by:\n\n$$\n\\begin{equation*}\n\\% \\text{ overshoot } = 100 e^{\\frac{-\\pi}{\\sqrt{4 Q^{2} - 1}}} \\tag{5.45}\n\\end{equation*}\n$$\n\nEquating (5.42) with (5.44) and solving for \\( \\omega_{0} \\) and Q yields:\n\n$$\n\\begin{equation*}\n\\omega_{0} = \\sqrt{\\left(1 + \\mathrm{L}_{0}\\right)\\left(\\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}\\right)} \\approx \\sqrt{\\omega_{i} \\omega_{\\mathrm{eq}}} \\tag{5.46}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{equation*}\nQ = \\frac{\\sqrt{\\left(1 + \\mathrm{L}_{0}\\right) / \\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}}}{1 / \\omega_{\\mathrm{p} 1} + 1 / \\omega_{\\mathrm{eq}}} \\approx \\sqrt{\\frac{\\mathrm{~L}_{0} \\omega_{\\mathrm{p} 1}}{\\omega_{\\mathrm{eq}}}} = \\sqrt{\\frac{\\beta \\omega_{\\mathrm{ta}}}{\\omega_{\\mathrm{eq}}}} \\tag{5.47}\n\\end{equation*}\n$$\n\nwhere the approximation on Q is valid since \\( L_{0} \\gg 1 \\) and \\( \\omega_{\\mathrm{p} 1} \\ll \\omega_{\\mathrm{eq}} \\).\n\nIt is now possible to relate a specified phase margin to the Q factor of the resulting closed-loop amplifier. Equation (5.41) can be used to find \\( \\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}} \\). This result can be substituted into (5.37) to find \\( \\beta\\left(\\omega_{\\mathrm{ta}} / \\omega_{\\mathrm{eq}}\\right) \\), which can then be substituted into (5.47) to find the equivalent Q factor. Finally, (5.45) can be used to determine the corresponding percentage overshoot for a step input. This procedure provides the data in Table 5.1.\n\nTable 5.1 leads to some insightful observations. First, a frequency response with \\( Q \\approx \\sqrt{1 / 2} \\) roughly corresponds to a phase margin of \\( 65^{\\circ} \\). Therefore, a common specification is to design for a phase margin of at least \\( 65^{\\circ} \\) to ensure no peaking in the closed-loop amplifier's frequency response, accounting for both process and temperature changes. If no overshoot for a step input is desired, the phase margin should be at least \\( 75^{\\circ} \\), again considering process and temperature variations. Hence, a nominal phase margin of \\( 80^{\\circ} \\) to \\( 85^{\\circ} \\) is often targeted to accommodate these variations.\n\n5. The Q factor is \\( 1 / 2 \\) times the inverse of the damping factor. The damping factor is an alternative method of indicating the pole locations in second-order transfer functions.\n\nFinally, it is worth noting that when an amplifier is designed for use with various feedback networks, the worst-case phase margin occurs for the maximum value of \\( \\beta \\), corresponding to the smallest closed-loop gain. Thus, the amplifier is designed to have a sufficient phase margin for the maximum value of \\( \\beta \\). It is then guaranteed to have an even greater phase margin for all other \\( \\beta \\), although in these cases it will be sub-optimally compensated and slower than necessary."
},
{
    "text": "While first-order feedback amplifiers possess several favorable traits, practical feedback amplifiers typically feature multiple poles. The primary goal in designing amplifier $A$ is to achieve a high low-frequency gain. However, the maximum gain attainable with a single transistor, defined by its intrinsic gain $A_{i}=g_{m} r_{d s}$, is often inadequate. Consequently, multiple transistors must be integrated, resulting in a more intricate circuit with several nodes and, unavoidably, multiple poles.\n\nA general second-order feedback loop transfer function is given by,\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s})=\\frac{\\mathrm{L}_{0}}{\\left(1+\\mathrm{s} / \\omega_{\\mathrm{p} 1}\\right)\\left(1+\\mathrm{s} / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.34}\n\\end{equation*}\n$$\n\nIt is presumed that $\\omega_{\\text {eq }}>\\omega_{\\mathrm{p} 1}$. The Bode plot of (5.34) in Fig. 5.7 clearly indicates unconditional stability, as a phase shift of $-180^{\\circ}$ is never reached. Nonetheless, the phase margin can approach $0^{\\circ}$ depending on $L_{0}, \\omega_{p}$, and $\\omega_{\\text {eq }}$.\n\nAt frequencies significantly higher than the dominant pole frequency, $\\omega \\gg \\omega_{\\mathrm{p} 1}$, it can be observed that $1+j \\omega / \\omega_{\\mathrm{p} 1} \\cong j \\omega / \\omega_{\\mathrm{p} 1}$, allowing (5.34) to be accurately approximated by\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s}) \\cong \\frac{\\omega_{\\mathrm{t}}}{\\mathrm{~s}\\left(1+\\mathrm{s} / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.35}\n\\end{equation*}\n$$\n\nKey Point: All-pole second-order feedback systems are unconditionally stable with a phase margin ranging from 90 to 0 degrees.\n\nThis approximation is particularly valid at the loop's unity-gain frequency $\\omega_{\\mathrm{t}}$ (currently of interest), which is almost certainly much greater than $\\omega_{\\mathrm{p} 1}$, provided $\\mathrm{L}_{0}$ » 1.\n\nSince $L(s)=\\beta A(s)$, where $\\beta$ is a scalar constant, the poles are derived from the forward amplifier, $\\mathrm{A}(\\mathrm{s})$. Using (5.34), we can define $\\mathrm{A}_{0}=\\mathrm{L}_{0} / \\beta$ as the dc gain of $\\mathrm{A}(\\mathrm{s})$ and $\\omega_{\\mathrm{ta}}=\\mathrm{A}_{0} \\omega_{\\mathrm{p} 1}$ as the approximate unity-gain frequency of $\\mathrm{A}(\\mathrm{s})$ under a dominant pole approximation. Thus, at frequencies around $\\omega_{\\mathrm{t}}$, the loop gain, $L(\\mathrm{~s})$, is expressed as\n\n$$\n\\begin{equation*}\nL(s)=\\beta A(s)=\\frac{\\beta \\omega_{\\mathrm{ta}}}{s\\left(1+s / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.36}\n\\end{equation*}\n$$\n\nThe unity-gain frequency, $\\omega_{\\mathrm{t}}$, can be determined by setting the magnitude of (5.36) to unity after substituting $\\mathrm{s}=\\mathrm{j} \\omega_{\\mathrm{t}}$. Upon rearranging the equation, we obtain,\n\n$$\n\\begin{equation*}\n\\beta \\frac{\\omega_{\\mathrm{ta}}}{\\omega_{\\mathrm{eq}}}=\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}} \\sqrt{1+\\left(\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}}\\right)^{2}} \\tag{5.37}\n\\end{equation*}\n$$\n\nFor the special case where the unity-gain frequency is much lower than the equivalent nondominant pole frequency (i.e., $\\omega_{\\mathrm{t}}$ « $\\omega_{\\text {eq }}$ ), (5.37) can be simplified to\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{ta}}=\\frac{\\omega_{\\mathrm{t}}}{\\beta} \\sqrt{1+\\left(\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}}\\right)^{2}} \\cong \\frac{\\omega_{\\mathrm{t}}}{\\beta} \\tag{5.38}\n\\end{equation*}\n$$\n\nFrom (5.36), the phase shift, $\\angle \\mathrm{L}(\\omega)$, is determined as\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}(\\omega)=-90^{\\circ}-\\tan ^{-1}\\left(\\omega / \\omega_{\\mathrm{eq}}\\right) \\tag{5.39}\n\\end{equation*}\n$$\n\nThis implies that at the unity-gain frequency, $\\omega=\\omega_{\\mathrm{t}}$, we have\n\n$$\n\\begin{equation*}\n\\mathrm{PM}=\\angle \\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)-\\left(-180^{\\circ}\\right)=90^{\\circ}-\\tan ^{-1}\\left(\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}}\\right) \\tag{5.40}\n\\end{equation*}\n$$\n\nand, therefore,\n\nKey Point: The process of designing or modifying a feedback amplifier to achieve a specific phase margin is known as compensation.\n\n$$\n\\begin{align*}\n\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}} & =\\tan \\left(90^{\\circ}-\\mathrm{PM}\\right)  \\tag{5.41}\\\\\n\\Rightarrow \\omega_{\\mathrm{t}} & =\\tan \\left(90^{\\circ}-\\mathrm{PM}\\right) \\omega_{\\mathrm{eq}}\n\\end{align*}\n$$\n\nEquation (5.41) specifies the required $\\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}$ for a given phase margin. The process of designing or modifying a feedback amplifier to meet the $\\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}$ ratio as per (5.41) for a target phase margin is termed compensation.\n\n#### EXAMPLE 5.7\n\nA closed-loop amplifier is required to have a $75^{\\circ}$ phase margin with $\\beta=1$. What is the necessary unity-gain frequency $f_{t}$ if $f_{\\text {eq }}=\\omega_{\\text {eq }} /(2 \\pi)=50 \\mathrm{MHz}$? What is the required $f_{\\mathrm{ta}}$?\n\n#### Solution\n\nUsing (5.40), we find $\\omega_{\\mathrm{t}}=0.268 \\omega_{\\text {eq }}$, indicating that the loop-gain unity-gain frequency is $f_{t}=\\omega_{t} / 2 \\pi=13.4 \\mathrm{MHz}$. From (5.38), for $\\beta=1$, we have $\\omega_{\\mathrm{ta}}=\\omega_{\\mathrm{t}} \\sqrt{1+0.268^{2}}=1.035 \\omega_{\\mathrm{t}}$, implying $\\mathrm{f}_{\\mathrm{ta}}=\\omega_{\\mathrm{ta}} / 2 \\pi=13.9 \\mathrm{MHz}$.\n\nThe closed-loop response of a second-order feedback amplifier can be determined by substituting (5.34) into (5.8) and rearranging, resulting in\n\n$$\n\\begin{equation*}\n\\mathrm{A}_{\\mathrm{CL}}(\\mathrm{~s})=\\frac{\\mathrm{A}_{\\mathrm{CL} 0}}{1+\\frac{\\mathrm{s}\\left(1 / \\omega_{\\mathrm{p} 1}+1 / \\omega_{\\mathrm{eq}}\\right)}{1+\\mathrm{L}_{0}}+\\frac{\\mathrm{s}^{2}}{\\left(1+\\mathrm{L}_{0}\\right)\\left(\\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}\\right)}} \\tag{5.42}\n\\end{equation*}\n$$\n\nwhere\n\n$$\n\\begin{equation*}\nA_{C L 0} \\equiv \\frac{\\mathrm{~L}_{0} / \\beta}{1+\\mathrm{L}_{0}} \\cong \\frac{1}{\\beta} \\tag{5.43}\n\\end{equation*}\n$$\n\nTable 5.1 The relationship between $\\mathrm{PM}, \\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}, Q$ factor, and percentage overshoot\n\n| PM <br> (Phase margin) | $\\omega_{\\mathbf{t}} / \\omega_{\\text {eq }}$ | Q factor | Percentage <br> overshoot for a <br> step input |\n| :---: | :---: | :---: | :---: |\n| $55^{\\circ}$ | 0.700 | 0.925 | $13.3 \\%$ |\n| $60^{\\circ}$ | 0.580 | 0.817 | $8.7 \\%$ |\n| $65^{\\circ}$ | 0.470 | 0.717 | $4.7 \\%$ |\n| $70^{\\circ}$ | 0.360 | 0.622 | $1.4 \\%$ |\n| $75^{\\circ}$ | 0.270 | 0.527 | $0.008 \\%$ |\n| $80^{\\circ}$ | 0.175 | 0.421 | - |\n| $85^{\\circ}$ | 0.087 | 0.296 | - |\n\nThus, the closed-loop response is also second-order. The general equation for a second-order all-pole transfer function is\n\n$$\n\\begin{equation*}\nH(s)=\\frac{K \\omega_{0}^{2}}{s^{2}+\\left(\\frac{\\omega_{0}}{Q}\\right) s+\\omega_{0}^{2}}=\\frac{K}{1+\\frac{s}{\\omega_{0} Q}+\\frac{s^{2}}{\\omega_{0}^{2}}} \\tag{5.44}\n\\end{equation*}\n$$\n\nRecall from the previous chapter that $\\omega_{0}$ is termed the resonant frequency, and the parameter Q is known as the Q factor ${ }^{5}$ [Sedra, 1991]. If $\\mathrm{Q}=\\sqrt{1 / 2} \\cong 0.707$, the magnitude response will exhibit a -3 dB frequency equal to $\\omega_{0}$. Lower Q-factors $(\\mathrm{Q}<\\sqrt{1 / 2}$ ) lead to reduced bandwidth, whereas higher Q-factors $(\\mathrm{Q}>\\sqrt{1 / 2}$ ) cause peaking in the frequency response. Additionally, if $Q \\leq 0.5$, both poles of $A_{C L}(s)$ are real, resulting in no overshoot in the feedback amplifier's step response. When $Q>0.5$, the percentage overshoot of the step response is given by\n\n$$\n\\begin{equation*}\n\\% \\text { overshoot }=100 e^{\\frac{-\\pi}{\\sqrt{4 Q^{2}-1}}} \\tag{5.45}\n\\end{equation*}\n$$\n\nBy equating (5.42) with (5.44) and solving for $\\omega_{0}$ and Q, we obtain\n\n$$\n\\begin{equation*}\n\\omega_{0}=\\sqrt[t]{\\left(1+\\mathrm{L}_{0}\\right)\\left(\\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}\\right)} \\cong \\sqrt{\\omega_{i} \\omega_{\\mathrm{eq}}} \\tag{5.46}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{equation*}\nQ=\\frac{\\sqrt{\\left(1+\\mathrm{L}_{0}\\right) / \\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}}}{1 / \\omega_{\\mathrm{p} 1}+1 / \\omega_{\\mathrm{eq}}} \\cong \\sqrt{\\frac{\\mathrm{~L}_{0} \\omega_{\\mathrm{p} 1}}{\\omega_{\\mathrm{eq}}}}=\\sqrt{\\frac{\\beta \\omega_{\\mathrm{ta}}}{\\omega_{\\mathrm{eq}}}} \\tag{5.47}\n\\end{equation*}\n$$\n\nwhere the approximation on $Q$ holds since $L_{0}>>1$ and $\\omega_{\\mathrm{p} 1}<<\\omega_{\\mathrm{eq}}$.\nIt is now possible to relate a specified phase margin to the Q factor of the resulting closed-loop amplifier. Equation (5.41) can be used to determine $\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}}$. This result can be substituted into (5.37) to find $\\beta\\left(\\omega_{\\mathrm{ta}} / \\omega_{\\mathrm{eq}}\\right)$, which can then be substituted into (5.47) to determine the equivalent Q factor. Finally, (5.45) can be used to find the corresponding percentage overshoot for a step input. This procedure yields the data in Table 5.1.\n\nTable 5.1 reveals some interesting insights. First, a frequency response with $Q \\cong \\sqrt{1 / 2}$ roughly corresponds to a phase margin of $65^{\\circ}$. Therefore, a common specification is to design for a phase margin of at least $65^{\\circ}$ to avoid peaking in the closed-loop amplifier's frequency response, considering both process and temperature variations. To ensure no overshoot for a step input, the phase margin should be at least $75^{\\circ}$, again accounting for process and temperature changes. Hence, a nominal phase margin of $80^{\\circ}$ to $85^{\\circ}$ is often targeted to accommodate these variations.\n5. The Q factor is $1 / 2$ times the inverse of the damping factor. The damping factor is another method of indicating the pole locations in second-order transfer functions.\n\nFinally, it is worth noting that when an amplifier is designed for use with various feedback networks, the worst-case phase margin occurs at the maximum value of $\\beta$, which corresponds to the smallest closed-loop gain. Thus, the amplifier is designed to ensure sufficient phase margin for the maximum $\\beta$. This guarantees that it will have an even greater phase margin for all other $\\beta$ values, although it may be sub-optimally compensated and slower than necessary in these cases."
},
{
    "text": "While first-order feedback amplifiers possess several advantageous traits, practical feedback amplifiers typically feature multiple poles. The primary goal in designing the amplifier $A$ is to achieve a high low-frequency gain. However, the maximum gain achievable with a single transistor, defined by its intrinsic gain $A_{i}=g_{m} r_{d s}$, is often inadequate. Consequently, multiple transistors must be utilized, leading to a more intricate circuit with several nodes and, inevitably, multiple poles.\n\nA standard second-order feedback loop transfer function is given by:\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s})=\\frac{\\mathrm{L}_{0}}{\\left(1+\\mathrm{s} / \\omega_{\\mathrm{p} 1}\\right)\\left(1+\\mathrm{s} / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.34}\n\\end{equation*}\n$$\n\nIt is assumed that $\\omega_{\\text {eq }}>\\omega_{\\mathrm{p} 1}$. The Bode plot of (5.34) in Fig. 5.7 clearly indicates unconditional stability, as a phase shift of $-180^{\\circ}$ is never reached. Nevertheless, the phase margin can approach $0^{\\circ}$ depending on $L_{0}, \\omega_{p}$, and $\\omega_{\\text {eq }}$.\n\nAt frequencies significantly higher than the dominant pole frequency, $\\omega \\gg \\omega_{\\mathrm{p} 1}$, it can be observed that $1+j \\omega / \\omega_{\\mathrm{p} 1} \\cong j \\omega / \\omega_{\\mathrm{p} 1}$, allowing (5.34) to be accurately approximated by:\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s}) \\cong \\frac{\\omega_{\\mathrm{t}}}{\\mathrm{~s}\\left(1+\\mathrm{s} / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.35}\n\\end{equation*}\n$$\n\nKey Point: All-pole second-order feedback systems are unconditionally stable with a phase margin ranging from 90 to 0 degrees.\n\nThis approximation is particularly valid at the loop's unity-gain frequency $\\omega_{\\mathrm{t}}$ (which is currently of interest) and is almost certainly much greater than $\\omega_{\\mathrm{p} 1}$, provided $\\mathrm{L}_{0}$ » 1.\n\nSince $L(s)=\\beta A(s)$, where $\\beta$ is a scalar constant, the poles are contributed by the forward amplifier, $\\mathrm{A}(\\mathrm{s})$. Using (5.34), we can define $\\mathrm{A}_{0}=\\mathrm{L}_{0} / \\beta$ as the dc gain of $\\mathrm{A}(\\mathrm{s})$ and $\\omega_{\\mathrm{ta}}=\\mathrm{A}_{0} \\omega_{\\mathrm{p} 1}$ as the approximate unity-gain frequency of $\\mathrm{A}(\\mathrm{s})$ under a dominant pole approximation. Thus, at frequencies around $\\omega_{\\mathrm{t}}$, the loop gain, $L(\\mathrm{~s})$, is:\n\n$$\n\\begin{equation*}\nL(s)=\\beta A(s)=\\frac{\\beta \\omega_{\\mathrm{ta}}}{s\\left(1+s / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.36}\n\\end{equation*}\n$$\n\nThe unity-gain frequency, $\\omega_{\\mathrm{t}}$, can be determined by setting the magnitude of (5.36) to unity after substituting $\\mathrm{s}=\\mathrm{j} \\omega_{\\mathrm{t}}$. Upon rearranging, we obtain:\n\n$$\n\\begin{equation*}\n\\beta \\frac{\\omega_{\\mathrm{ta}}}{\\omega_{\\mathrm{eq}}}=\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}} \\sqrt{1+\\left(\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}}\\right)^{2}} \\tag{5.37}\n\\end{equation*}\n$$\n\nFor the special case where the unity-gain frequency is much lower than the equivalent nondominant pole frequency (i.e., $\\omega_{\\mathrm{t}}$ « $\\omega_{\\text {eq }}$), (5.37) simplifies to:\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{ta}}=\\frac{\\omega_{\\mathrm{t}}}{\\beta} \\sqrt{1+\\left(\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}}\\right)^{2}} \\cong \\frac{\\omega_{\\mathrm{t}}}{\\beta} \\tag{5.38}\n\\end{equation*}\n$$\n\nFrom (5.36), the phase shift, $\\angle \\mathrm{L}(\\omega)$, is derived as:\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}(\\omega)=-90^{\\circ}-\\tan ^{-1}\\left(\\omega / \\omega_{\\mathrm{eq}}\\right) \\tag{5.39}\n\\end{equation*}\n$$\n\nThis implies that at the unity-gain frequency, $\\omega=\\omega_{\\mathrm{t}}$, we have:\n\n$$\n\\begin{equation*}\n\\mathrm{PM}=\\angle \\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)-\\left(-180^{\\circ}\\right)=90^{\\circ}-\\tan ^{-1}\\left(\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}}\\right) \\tag{5.40}\n\\end{equation*}\n$$\n\nKey Point: The process of designing or modifying a feedback amplifier to achieve a specific phase margin is known as compensation.\n\n$$\n\\begin{align*}\n\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}} & =\\tan \\left(90^{\\circ}-\\mathrm{PM}\\right)  \\tag{5.41}\\\\\n\\Rightarrow \\omega_{\\mathrm{t}} & =\\tan \\left(90^{\\circ}-\\mathrm{PM}\\right) \\omega_{\\mathrm{eq}}\n\\end{align*}\n$$\n\nEquation (5.41) specifies the required $\\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}$ for a given phase margin. Designing or modifying a feedback amplifier to meet the $\\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}$ ratio as per (5.41) for a targeted phase margin is termed compensation.\n\n#### EXAMPLE 5.7\n\nA closed-loop amplifier is required to have a $75^{\\circ}$ phase margin with $\\beta=1$. What is the necessary unity-gain frequency $f_{t}$ if $f_{\\text {eq }}=\\omega_{\\text {eq }} /(2 \\pi)=50 \\mathrm{MHz}$? What is the required $f_{\\mathrm{ta}}$?\n\n#### Solution\n\nUsing (5.40), we find $\\omega_{\\mathrm{t}}=0.268 \\omega_{\\text {eq }}$, indicating that the loop-gain unity-gain frequency is $f_{t}=\\omega_{t} / 2 \\pi=13.4 \\mathrm{MHz}$. From (5.38), for $\\beta=1$, we get $\\omega_{\\mathrm{ta}}=\\omega_{\\mathrm{t}} \\sqrt{1+0.268^{2}}=1.035 \\omega_{\\mathrm{t}}$, implying $\\mathrm{f}_{\\mathrm{ta}}=\\omega_{\\mathrm{ta}} / 2 \\pi=13.9 \\mathrm{MHz}$.\n\nThe closed-loop response of a second-order feedback amplifier can be determined by substituting (5.34) into (5.8) and rearranging:\n\n$$\n\\begin{equation*}\n\\mathrm{A}_{\\mathrm{CL}}(\\mathrm{~s})=\\frac{\\mathrm{A}_{\\mathrm{CL} 0}}{1+\\frac{\\mathrm{s}\\left(1 / \\omega_{\\mathrm{p} 1}+1 / \\omega_{\\mathrm{eq}}\\right)}{1+\\mathrm{L}_{0}}+\\frac{\\mathrm{s}^{2}}{\\left(1+\\mathrm{L}_{0}\\right)\\left(\\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}\\right)}} \\tag{5.42}\n\\end{equation*}\n$$\n\nwhere\n\n$$\n\\begin{equation*}\nA_{C L 0} \\equiv \\frac{\\mathrm{~L}_{0} / \\beta}{1+\\mathrm{L}_{0}} \\cong \\frac{1}{\\beta} \\tag{5.43}\n\\end{equation*}\n$$\n\nTable 5.1 The relationship between $\\mathrm{PM}, \\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}, Q$ factor, and percentage overshoot\n\n| PM <br> (Phase margin) | $\\omega_{\\mathbf{t}} / \\omega_{\\text {eq }}$ | Q factor | Percentage <br> overshoot for a <br> step input |\n| :---: | :---: | :---: | :---: |\n| $55^{\\circ}$ | 0.700 | 0.925 | $13.3 \\%$ |\n| $60^{\\circ}$ | 0.580 | 0.817 | $8.7 \\%$ |\n| $65^{\\circ}$ | 0.470 | 0.717 | $4.7 \\%$ |\n| $70^{\\circ}$ | 0.360 | 0.622 | $1.4 \\%$ |\n| $75^{\\circ}$ | 0.270 | 0.527 | $0.008 \\%$ |\n| $80^{\\circ}$ | 0.175 | 0.421 | - |\n| $85^{\\circ}$ | 0.087 | 0.296 | - |\n\nThus, the closed-loop response is also second-order. The general equation for a second-order all-pole transfer function is:\n\n$$\n\\begin{equation*}\nH(s)=\\frac{K \\omega_{0}^{2}}{s^{2}+\\left(\\frac{\\omega_{0}}{Q}\\right) s+\\omega_{0}^{2}}=\\frac{K}{1+\\frac{s}{\\omega_{0} Q}+\\frac{s^{2}}{\\omega_{0}^{2}}} \\tag{5.44}\n\\end{equation*}\n$$\n\nRecall from the previous chapter that $\\omega_{0}$ is termed the resonant frequency, and the parameter Q is the Q factor ${ }^{5}$ [Sedra, 1991]. If $\\mathrm{Q}=\\sqrt{1 / 2} \\cong 0.707$, the magnitude response will have a -3 dB frequency equal to $\\omega_{0}$. Lower Q-factors $(\\mathrm{Q}<\\sqrt{1 / 2}$) result in reduced bandwidth, whereas higher Q-factors $(\\mathrm{Q}>\\sqrt{1 / 2}$) lead to peaking in the frequency response. Additionally, if $Q \\leq 0.5$, both poles of $A_{C L}(s)$ are real, resulting in no overshoot in the feedback amplifier's step response. For $Q>0.5$, the percentage overshoot of the step response is given by:\n\n$$\n\\begin{equation*}\n\\% \\text { overshoot }=100 e^{\\frac{-\\pi}{\\sqrt{4 Q^{2}-1}}} \\tag{5.45}\n\\end{equation*}\n$$\n\nEquating (5.42) with (5.44) and solving for $\\omega_{0}$ and Q yields:\n\n$$\n\\begin{equation*}\n\\omega_{0}=\\sqrt[t]{\\left(1+\\mathrm{L}_{0}\\right)\\left(\\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}\\right)} \\cong \\sqrt{\\omega_{i} \\omega_{\\mathrm{eq}}} \\tag{5.46}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{equation*}\nQ=\\frac{\\sqrt{\\left(1+\\mathrm{L}_{0}\\right) / \\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}}}{1 / \\omega_{\\mathrm{p} 1}+1 / \\omega_{\\mathrm{eq}}} \\cong \\sqrt{\\frac{\\mathrm{~L}_{0} \\omega_{\\mathrm{p} 1}}{\\omega_{\\mathrm{eq}}}}=\\sqrt{\\frac{\\beta \\omega_{\\mathrm{ta}}}{\\omega_{\\mathrm{eq}}}} \\tag{5.47}\n\\end{equation*}\n$$\n\nwhere the approximation on $Q$ is valid since $L_{0}>>1$ and $\\omega_{\\mathrm{p} 1}<<\\omega_{\\mathrm{eq}}$.\nIt is now possible to relate a specified phase margin to the Q factor of the resulting closed-loop amplifier. Equation (5.41) can be used to find $\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}}$. This result can be substituted into (5.37) to find $\\beta\\left(\\omega_{\\mathrm{ta}} / \\omega_{\\mathrm{eq}}\\right)$, which can then be substituted into (5.47) to determine the equivalent Q factor. Finally, (5.45) can be used to find the corresponding percentage overshoot for a step input. This procedure provides the data in Table 5.1.\n\nTable 5.1 leads to some interesting observations. First, a frequency response with $Q \\cong \\sqrt{1 / 2}$ roughly corresponds to a phase margin of $65^{\\circ}$. Therefore, a common specification is to design for a phase margin of at least $65^{\\circ}$ to avoid peaking in the closed-loop amplifier's frequency response, considering both process and temperature changes. If no overshoot for a step input is desired, the phase margin should be at least $75^{\\circ}$, again accounting for process and temperature variations. Hence, a nominal phase margin of $80^{\\circ}$ to $85^{\\circ}$ is often targeted to accommodate these variations.\n5. The Q factor is $1 / 2$ times the inverse of the damping factor. The damping factor is an alternative method of indicating the pole locations in second-order transfer functions.\n\nFinally, it is worth noting that when an amplifier is designed for use with various feedback networks, the worst-case phase margin occurs at the maximum value of $\\beta$, corresponding to the smallest closed-loop gain. Thus, the amplifier is designed to ensure sufficient phase margin for the maximum $\\beta$. This guarantees that it will have an even greater phase margin for all other $\\beta$ values, although it may be sub-optimally compensated and slower than necessary in these cases."
},
{
    "text": "While first-order feedback amplifiers possess several favorable traits, practical feedback amplifiers typically feature multiple poles. The primary goal in designing the amplifier $A$ is to achieve a high low-frequency gain. Unfortunately, the maximum gain achievable with a single transistor, defined by its intrinsic gain $A_{i}=g_{m} r_{d s}$, is often inadequate. Consequently, multiple transistors must be used, leading to a more intricate circuit with several nodes and, inevitably, multiple poles.\n\nA general second-order feedback loop transfer function is expressed as,\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s})=\\frac{\\mathrm{L}_{0}}{\\left(1+\\mathrm{s} / \\omega_{\\mathrm{p} 1}\\right)\\left(1+\\mathrm{s} / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.34}\n\\end{equation*}\n$$\n\nIt is assumed that $\\omega_{\\text {eq }}>\\omega_{\\mathrm{p} 1}$. The Bode plot of (5.34) in Fig. 5.7 clearly indicates unconditional stability, as a phase shift of $-180^{\\circ}$ is never reached. However, the phase margin can approach $0^{\\circ}$ depending on $L_{0}, \\omega_{p}$, and $\\omega_{\\text {eq }}$.\n\nAt frequencies significantly higher than the dominant pole frequency, $\\omega \\gg \\omega_{\\mathrm{p} 1}$, it can be observed that $1+j \\omega / \\omega_{\\mathrm{p} 1} \\cong j \\omega / \\omega_{\\mathrm{p} 1}$, allowing (5.34) to be accurately approximated by\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s}) \\cong \\frac{\\omega_{\\mathrm{t}}}{\\mathrm{~s}\\left(1+\\mathrm{s} / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.35}\n\\end{equation*}\n$$\n\nKey Point: All-pole second-order feedback systems are unconditionally stable with a phase margin ranging from 90 to 0 degrees.\n\nThis approximation is particularly valid at the unity-gain frequency of the loop $\\omega_{\\mathrm{t}}$ (which is currently of interest) and is almost certainly much greater than $\\omega_{\\mathrm{p} 1}$, provided $\\mathrm{L}_{0}$ » 1.\n\nSince $L(s)=\\beta A(s)$, where $\\beta$ is a scalar constant, the poles are derived from the forward amplifier, $\\mathrm{A}(\\mathrm{s})$. Using (5.34), we can define $\\mathrm{A}_{0}=\\mathrm{L}_{0} / \\beta$ as the dc gain of $\\mathrm{A}(\\mathrm{s})$ and $\\omega_{\\mathrm{ta}}=\\mathrm{A}_{0} \\omega_{\\mathrm{p} 1}$ as the approximate unity-gain frequency of $\\mathrm{A}(\\mathrm{s})$ under a dominant pole approximation. Thus, at frequencies around $\\omega_{\\mathrm{t}}$, the loop gain, $L(\\mathrm{~s})$, is given by\n\n$$\n\\begin{equation*}\nL(s)=\\beta A(s)=\\frac{\\beta \\omega_{\\mathrm{ta}}}{s\\left(1+s / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.36}\n\\end{equation*}\n$$\n\nThe unity-gain frequency, $\\omega_{\\mathrm{t}}$, can be determined by setting the magnitude of (5.36) to unity after substituting $\\mathrm{s}=\\mathrm{j} \\omega_{\\mathrm{t}}$. Rearranging the equation yields,\n\n$$\n\\begin{equation*}\n\\beta \\frac{\\omega_{\\mathrm{ta}}}{\\omega_{\\mathrm{eq}}}=\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}} \\sqrt{1+\\left(\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}}\\right)^{2}} \\tag{5.37}\n\\end{equation*}\n$$\n\nFor the special case where the unity-gain frequency is much lower than the equivalent nondominant pole frequency (i.e., $\\omega_{\\mathrm{t}}$ « $\\omega_{\\text {eq }}$ ), (5.37) simplifies to\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{ta}}=\\frac{\\omega_{\\mathrm{t}}}{\\beta} \\sqrt{1+\\left(\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}}\\right)^{2}} \\cong \\frac{\\omega_{\\mathrm{t}}}{\\beta} \\tag{5.38}\n\\end{equation*}\n$$\n\nFrom (5.36), the phase shift, $\\angle \\mathrm{L}(\\omega)$, is determined as\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}(\\omega)=-90^{\\circ}-\\tan ^{-1}\\left(\\omega / \\omega_{\\mathrm{eq}}\\right) \\tag{5.39}\n\\end{equation*}\n$$\n\nThis implies that at the unity-gain frequency, $\\omega=\\omega_{\\mathrm{t}}$, we have\n\n$$\n\\begin{equation*}\n\\mathrm{PM}=\\angle \\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)-\\left(-180^{\\circ}\\right)=90^{\\circ}-\\tan ^{-1}\\left(\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}}\\right) \\tag{5.40}\n\\end{equation*}\n$$\n\nand, therefore,\n\nKey Point: The process of designing or modifying a feedback amplifier to achieve a specific phase margin is known as compensation.\n\n$$\n\\begin{align*}\n\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}} & =\\tan \\left(90^{\\circ}-\\mathrm{PM}\\right)  \\tag{5.41}\\\\\n\\Rightarrow \\omega_{\\mathrm{t}} & =\\tan \\left(90^{\\circ}-\\mathrm{PM}\\right) \\omega_{\\mathrm{eq}}\n\\end{align*}\n$$\n\nEquation (5.41) specifies the required $\\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}$ for a given phase margin. Designing or modifying a feedback amplifier to meet the $\\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}$ ratio as per (5.41) for a targeted phase margin is termed compensation.\n\n#### EXAMPLE 5.7\n\nA closed-loop amplifier is required to have a $75^{\\circ}$ phase margin with $\\beta=1$. What is the necessary unity-gain frequency $f_{t}$ if $f_{\\text {eq }}=\\omega_{\\text {eq }} /(2 \\pi)=50 \\mathrm{MHz}$ ? What is the required $f_{\\mathrm{ta}}$ ?\n\n#### Solution\n\nUsing (5.40), we find $\\omega_{\\mathrm{t}}=0.268 \\omega_{\\text {eq }}$, indicating that the loop-gain unity-gain frequency is $f_{t}=\\omega_{t} / 2 \\pi=13.4 \\mathrm{MHz}$. From (5.38), for $\\beta=1$, we get $\\omega_{\\mathrm{ta}}=\\omega_{\\mathrm{t}} \\sqrt{1+0.268^{2}}=1.035 \\omega_{\\mathrm{t}}$, implying $\\mathrm{f}_{\\mathrm{ta}}=\\omega_{\\mathrm{ta}} / 2 \\pi=13.9 \\mathrm{MHz}$.\n\nThe closed-loop response of a second-order feedback amplifier can be derived by substituting (5.34) into (5.8) and rearranging, resulting in\n\n$$\n\\begin{equation*}\n\\mathrm{A}_{\\mathrm{CL}}(\\mathrm{~s})=\\frac{\\mathrm{A}_{\\mathrm{CL} 0}}{1+\\frac{\\mathrm{s}\\left(1 / \\omega_{\\mathrm{p} 1}+1 / \\omega_{\\mathrm{eq}}\\right)}{1+\\mathrm{L}_{0}}+\\frac{\\mathrm{s}^{2}}{\\left(1+\\mathrm{L}_{0}\\right)\\left(\\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}\\right)}} \\tag{5.42}\n\\end{equation*}\n$$\n\nwhere\n\n$$\n\\begin{equation*}\nA_{C L 0} \\equiv \\frac{\\mathrm{~L}_{0} / \\beta}{1+\\mathrm{L}_{0}} \\cong \\frac{1}{\\beta} \\tag{5.43}\n\\end{equation*}\n$$\n\nTable 5.1 The relationship between $\\mathrm{PM}, \\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}, Q$ factor, and percentage overshoot\n\n| PM <br> (Phase margin) | $\\omega_{\\mathbf{t}} / \\omega_{\\text {eq }}$ | Q factor | Percentage <br> overshoot for a <br> step input |\n| :---: | :---: | :---: | :---: |\n| $55^{\\circ}$ | 0.700 | 0.925 | $13.3 \\%$ |\n| $60^{\\circ}$ | 0.580 | 0.817 | $8.7 \\%$ |\n| $65^{\\circ}$ | 0.470 | 0.717 | $4.7 \\%$ |\n| $70^{\\circ}$ | 0.360 | 0.622 | $1.4 \\%$ |\n| $75^{\\circ}$ | 0.270 | 0.527 | $0.008 \\%$ |\n| $80^{\\circ}$ | 0.175 | 0.421 | - |\n| $85^{\\circ}$ | 0.087 | 0.296 | - |\n\nThus, the closed-loop response is also second-order. The general equation for a second-order all-pole transfer function is\n\n$$\n\\begin{equation*}\nH(s)=\\frac{K \\omega_{0}^{2}}{s^{2}+\\left(\\frac{\\omega_{0}}{Q}\\right) s+\\omega_{0}^{2}}=\\frac{K}{1+\\frac{s}{\\omega_{0} Q}+\\frac{s^{2}}{\\omega_{0}^{2}}} \\tag{5.44}\n\\end{equation*}\n$$\n\nRecall from the previous chapter that $\\omega_{0}$ is termed the resonant frequency and the parameter Q is the Q factor ${ }^{5}$ [Sedra, 1991]. If $\\mathrm{Q}=\\sqrt{1 / 2} \\cong 0.707$, the magnitude response will have a -3 dB frequency equal to $\\omega_{0}$. Lower Q-factors $(\\mathrm{Q}<\\sqrt{1 / 2}$ ) lead to reduced bandwidth, while higher Q-factors $(\\mathrm{Q}>\\sqrt{1 / 2}$ ) cause peaking in the frequency response. Additionally, if $Q \\leq 0.5$, both poles of $A_{C L}(s)$ are real, resulting in no overshoot in the feedback amplifier's step response. When $Q>0.5$, the percentage overshoot of the step response is given by\n\n$$\n\\begin{equation*}\n\\% \\text { overshoot }=100 e^{\\frac{-\\pi}{\\sqrt{4 Q^{2}-1}}} \\tag{5.45}\n\\end{equation*}\n$$\n\nEquating (5.42) with (5.44) and solving for $\\omega_{0}$ and Q yields\n\n$$\n\\begin{equation*}\n\\omega_{0}=\\sqrt[t]{\\left(1+\\mathrm{L}_{0}\\right)\\left(\\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}\\right)} \\cong \\sqrt{\\omega_{i} \\omega_{\\mathrm{eq}}} \\tag{5.46}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{equation*}\nQ=\\frac{\\sqrt{\\left(1+\\mathrm{L}_{0}\\right) / \\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}}}{1 / \\omega_{\\mathrm{p} 1}+1 / \\omega_{\\mathrm{eq}}} \\cong \\sqrt{\\frac{\\mathrm{~L}_{0} \\omega_{\\mathrm{p} 1}}{\\omega_{\\mathrm{eq}}}}=\\sqrt{\\frac{\\beta \\omega_{\\mathrm{ta}}}{\\omega_{\\mathrm{eq}}}} \\tag{5.47}\n\\end{equation*}\n$$\n\nwhere the approximation on $Q$ is valid since $L_{0}>>1$ and $\\omega_{\\mathrm{p} 1}<<\\omega_{\\mathrm{eq}}$.\nIt is now possible to relate a specified phase margin to the Q factor of the resulting closed-loop amplifier. Using (5.41) to find $\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}}$, this result can be substituted into (5.37) to determine $\\beta\\left(\\omega_{\\mathrm{ta}} / \\omega_{\\mathrm{eq}}\\right)$, which can then be used in (5.47) to find the equivalent Q factor. Finally, (5.45) can be applied to determine the corresponding percentage overshoot for a step input. This procedure provides the data in Table 5.1.\n\nTable 5.1 reveals some interesting insights. First, a frequency response with $Q \\cong \\sqrt{1 / 2}$ corresponds roughly to a phase margin of $65^{\\circ}$. Therefore, a common design specification is to aim for a phase margin of at least $65^{\\circ}$ to avoid peaking in the closed-loop amplifier's frequency response, considering both process and temperature variations. To ensure no overshoot for a step input, the phase margin should be at least $75^{\\circ}$, again accounting for process and temperature changes. Hence, a nominal phase margin of $80^{\\circ}$ to $85^{\\circ}$ is often targeted to accommodate these variations.\n5. The Q factor is $1 / 2$ times the inverse of the damping factor. The damping factor is another method of indicating the pole locations in second-order transfer functions.\n\nFinally, it is worth noting that when an amplifier is designed for use with various feedback networks, the worst-case phase margin occurs at the maximum value of $\\beta$, which corresponds to the smallest closed-loop gain. Thus, the amplifier is designed to ensure sufficient phase margin for the maximum $\\beta$. This guarantees that it will have an even greater phase margin for all other $\\beta$ values, although it may be sub-optimally compensated and slower than necessary in these cases."
},
{
    "text": "While first-order feedback amplifiers possess several advantageous traits, practical feedback amplifiers typically feature multiple poles. The primary goal in designing the amplifier $A$ is to achieve a high low-frequency gain. However, the maximum gain achievable with a single transistor, defined by its intrinsic gain $A_{i}=g_{m} r_{d s}$, is often inadequate. Consequently, multiple transistors must be combined, resulting in a more intricate circuit with several nodes and, inevitably, multiple poles.\n\nA general second-order feedback loop transfer function is given by,\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s})=\\frac{\\mathrm{L}_{0}}{\\left(1+\\mathrm{s} / \\omega_{\\mathrm{p} 1}\\right)\\left(1+\\mathrm{s} / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.34}\n\\end{equation*}\n$$\n\nIt is assumed that $\\omega_{\\text {eq }}>\\omega_{\\mathrm{p} 1}$. The Bode plot of (5.34) in Fig. 5.7 clearly indicates unconditional stability, as a phase shift of $-180^{\\circ}$ is never reached. Nonetheless, the phase margin can approach $0^{\\circ}$ depending on $L_{0}, \\omega_{p}$, and $\\omega_{\\text {eq }}$.\n\nAt frequencies significantly higher than the dominant pole frequency, $\\omega \\gg \\omega_{\\mathrm{p} 1}$, it can be observed that $1+j \\omega / \\omega_{\\mathrm{p} 1} \\cong j \\omega / \\omega_{\\mathrm{p} 1}$, allowing (5.34) to be accurately approximated by\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s}) \\cong \\frac{\\omega_{\\mathrm{t}}}{\\mathrm{~s}\\left(1+\\mathrm{s} / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.35}\n\\end{equation*}\n$$\n\nKey Point: All-pole second-order feedback systems are unconditionally stable with a phase margin ranging from 90 to 0 degrees.\n\nThis approximation is particularly valid at the unity-gain frequency of the loop $\\omega_{\\mathrm{t}}$ (which is currently of interest) and is almost certainly much greater than $\\omega_{\\mathrm{p} 1}$, provided $\\mathrm{L}_{0}$ » 1.\n\nSince $L(s)=\\beta A(s)$, where $\\beta$ is a scalar constant, it is evident that the poles are contributed by the forward amplifier, $\\mathrm{A}(\\mathrm{s})$. Using (5.34), we can define $\\mathrm{A}_{0}=\\mathrm{L}_{0} / \\beta$ as the dc gain of $\\mathrm{A}(\\mathrm{s})$ and $\\omega_{\\mathrm{ta}}=\\mathrm{A}_{0} \\omega_{\\mathrm{p} 1}$ as the approximate unity-gain frequency of $\\mathrm{A}(\\mathrm{s})$ under a dominant pole approximation. Thus, at frequencies around $\\omega_{\\mathrm{t}}$, the loop gain, $L(\\mathrm{~s})$, is expressed as\n\n$$\n\\begin{equation*}\nL(s)=\\beta A(s)=\\frac{\\beta \\omega_{\\mathrm{ta}}}{s\\left(1+s / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.36}\n\\end{equation*}\n$$\n\nThe unity-gain frequency, $\\omega_{\\mathrm{t}}$, can be determined by setting the magnitude of (5.36) to unity after substituting $\\mathrm{s}=\\mathrm{j} \\omega_{\\mathrm{t}}$. Upon rearranging the equation, we obtain\n\n$$\n\\begin{equation*}\n\\beta \\frac{\\omega_{\\mathrm{ta}}}{\\omega_{\\mathrm{eq}}}=\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}} \\sqrt{1+\\left(\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}}\\right)^{2}} \\tag{5.37}\n\\end{equation*}\n$$\n\nFor the special case where the unity-gain frequency is much lower than the equivalent nondominant pole frequency (i.e., $\\omega_{\\mathrm{t}}$ « $\\omega_{\\text {eq }}$ ), (5.37) can be simplified to\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{ta}}=\\frac{\\omega_{\\mathrm{t}}}{\\beta} \\sqrt{1+\\left(\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}}\\right)^{2}} \\cong \\frac{\\omega_{\\mathrm{t}}}{\\beta} \\tag{5.38}\n\\end{equation*}\n$$\n\nFrom (5.36), the phase shift, $\\angle \\mathrm{L}(\\omega)$, is derived as\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}(\\omega)=-90^{\\circ}-\\tan ^{-1}\\left(\\omega / \\omega_{\\mathrm{eq}}\\right) \\tag{5.39}\n\\end{equation*}\n$$\n\nThis equation implies that at the unity-gain frequency, $\\omega=\\omega_{\\mathrm{t}}$, we have\n\n$$\n\\begin{equation*}\n\\mathrm{PM}=\\angle \\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)-\\left(-180^{\\circ}\\right)=90^{\\circ}-\\tan ^{-1}\\left(\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}}\\right) \\tag{5.40}\n\\end{equation*}\n$$\n\nand, therefore,\n\nKey Point: The process of designing or modifying a feedback amplifier to achieve a specific phase margin is known as compensation.\n\n$$\n\\begin{align*}\n\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}} & =\\tan \\left(90^{\\circ}-\\mathrm{PM}\\right)  \\tag{5.41}\\\\\n\\Rightarrow \\omega_{\\mathrm{t}} & =\\tan \\left(90^{\\circ}-\\mathrm{PM}\\right) \\omega_{\\mathrm{eq}}\n\\end{align*}\n$$\n\nEquation (5.41) specifies the required $\\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}$ for a given phase margin. The process of designing or modifying a feedback amplifier to achieve the ratio $\\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}$ as per (5.41) for a target phase margin is termed compensation.\n\n#### EXAMPLE 5.7\n\nFor a closed-loop amplifier requiring a $75^{\\circ}$ phase margin with $\\beta=1$, what is the necessary unity-gain frequency $f_{t}$ if $f_{\\text {eq }}=\\omega_{\\text {eq }} /(2 \\pi)=50 \\mathrm{MHz}$? What is the required $f_{\\mathrm{ta}}$?\n\n#### Solution\n\nUsing (5.40), we find $\\omega_{\\mathrm{t}}=0.268 \\omega_{\\text {eq }}$, indicating that the loop-gain unity-gain frequency is $f_{t}=\\omega_{t} / 2 \\pi=13.4 \\mathrm{MHz}$. With (5.38), for $\\beta=1$, we get $\\omega_{\\mathrm{ta}}=\\omega_{\\mathrm{t}} \\sqrt{1+0.268^{2}}=1.035 \\omega_{\\mathrm{t}}$, implying $\\mathrm{f}_{\\mathrm{ta}}=\\omega_{\\mathrm{ta}} / 2 \\pi=13.9 \\mathrm{MHz}$.\n\nThe closed-loop response of a second-order feedback amplifier can be determined by substituting (5.34) into (5.8) and rearranging, yielding\n\n$$\n\\begin{equation*}\n\\mathrm{A}_{\\mathrm{CL}}(\\mathrm{~s})=\\frac{\\mathrm{A}_{\\mathrm{CL} 0}}{1+\\frac{\\mathrm{s}\\left(1 / \\omega_{\\mathrm{p} 1}+1 / \\omega_{\\mathrm{eq}}\\right)}{1+\\mathrm{L}_{0}}+\\frac{\\mathrm{s}^{2}}{\\left(1+\\mathrm{L}_{0}\\right)\\left(\\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}\\right)}} \\tag{5.42}\n\\end{equation*}\n$$\n\nwhere\n\n$$\n\\begin{equation*}\nA_{C L 0} \\equiv \\frac{\\mathrm{~L}_{0} / \\beta}{1+\\mathrm{L}_{0}} \\cong \\frac{1}{\\beta} \\tag{5.43}\n\\end{equation*}\n$$\n\nTable 5.1 The relationship between $\\mathrm{PM}, \\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}, Q$ factor, and percentage overshoot\n\n| PM <br> (Phase margin) | $\\omega_{\\mathbf{t}} / \\omega_{\\text {eq }}$ | Q factor | Percentage <br> overshoot for a <br> step input |\n| :---: | :---: | :---: | :---: |\n| $55^{\\circ}$ | 0.700 | 0.925 | $13.3 \\%$ |\n| $60^{\\circ}$ | 0.580 | 0.817 | $8.7 \\%$ |\n| $65^{\\circ}$ | 0.470 | 0.717 | $4.7 \\%$ |\n| $70^{\\circ}$ | 0.360 | 0.622 | $1.4 \\%$ |\n| $75^{\\circ}$ | 0.270 | 0.527 | $0.008 \\%$ |\n| $80^{\\circ}$ | 0.175 | 0.421 | - |\n| $85^{\\circ}$ | 0.087 | 0.296 | - |\n\nThus, the closed-loop response is also second-order. The general equation for a second-order all-pole transfer function is\n\n$$\n\\begin{equation*}\nH(s)=\\frac{K \\omega_{0}^{2}}{s^{2}+\\left(\\frac{\\omega_{0}}{Q}\\right) s+\\omega_{0}^{2}}=\\frac{K}{1+\\frac{s}{\\omega_{0} Q}+\\frac{s^{2}}{\\omega_{0}^{2}}} \\tag{5.44}\n\\end{equation*}\n$$\n\nRecall from the previous chapter that $\\omega_{0}$ is termed the resonant frequency, and the parameter Q is the Q factor ${ }^{5}$ [Sedra, 1991]. If $\\mathrm{Q}=\\sqrt{1 / 2} \\cong 0.707$, the magnitude response will exhibit a -3 dB frequency equal to $\\omega_{0}$. Lower Q factors $(\\mathrm{Q}<\\sqrt{1 / 2}$ ) result in reduced bandwidth, while higher Q factors $(\\mathrm{Q}>\\sqrt{1 / 2}$ ) lead to peaking in the frequency response. Additionally, note that if $Q \\leq 0.5$, both poles of $A_{C L}(s)$ are real, resulting in no overshoot in the feedback amplifier's step response. When $Q>0.5$, the percentage overshoot of the step response is given by\n\n$$\n\\begin{equation*}\n\\% \\text { overshoot }=100 e^{\\frac{-\\pi}{\\sqrt{4 Q^{2}-1}}} \\tag{5.45}\n\\end{equation*}\n$$\n\nEquating (5.42) with (5.44) and solving for $\\omega_{0}$ and Q yields\n\n$$\n\\begin{equation*}\n\\omega_{0}=\\sqrt[t]{\\left(1+\\mathrm{L}_{0}\\right)\\left(\\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}\\right)} \\cong \\sqrt{\\omega_{i} \\omega_{\\mathrm{eq}}} \\tag{5.46}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{equation*}\nQ=\\frac{\\sqrt{\\left(1+\\mathrm{L}_{0}\\right) / \\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}}}{1 / \\omega_{\\mathrm{p} 1}+1 / \\omega_{\\mathrm{eq}}} \\cong \\sqrt{\\frac{\\mathrm{~L}_{0} \\omega_{\\mathrm{p} 1}}{\\omega_{\\mathrm{eq}}}}=\\sqrt{\\frac{\\beta \\omega_{\\mathrm{ta}}}{\\omega_{\\mathrm{eq}}}} \\tag{5.47}\n\\end{equation*}\n$$\n\nwhere the approximation on $Q$ holds valid since $L_{0}>>1$ and $\\omega_{\\mathrm{p} 1}<<\\omega_{\\mathrm{eq}}$.\nIt is now possible to relate a specified phase margin to the Q factor of the resulting closed-loop amplifier. Using (5.41), $\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}}$ can be determined. This result can be substituted into (5.37) to find $\\beta\\left(\\omega_{\\mathrm{ta}} / \\omega_{\\mathrm{eq}}\\right)$, which can then be used in (5.47) to find the equivalent Q factor. Finally, (5.45) can be applied to determine the corresponding percentage overshoot for a step input. This procedure provides the data in Table 5.1.\n\nTable 5.1 reveals some interesting insights. First, a frequency response with $Q \\cong \\sqrt{1 / 2}$ approximately corresponds to a phase margin of $65^{\\circ}$. Therefore, a common design specification is to aim for a phase margin of at least $65^{\\circ}$ to avoid peaking in the closed-loop amplifier's frequency response, considering both process and temperature variations. To ensure no overshoot for a step input, the phase margin should be at least $75^{\\circ}$, again accounting for process and temperature changes. Consequently, a nominal phase margin of $80^{\\circ}$ to $85^{\\circ}$ is often targeted to accommodate these variations.\n5. The Q factor is $1 / 2$ times the inverse of the damping factor. The damping factor is another method of indicating the pole locations in second-order transfer functions.\n\nFinally, it is noteworthy that when an amplifier is designed for use with various feedback networks, the worst-case phase margin occurs at the maximum value of $\\beta$, corresponding to the smallest closed-loop gain. Thus, the amplifier is designed to ensure sufficient phase margin for the maximum $\\beta$. This guarantees that it will have an even greater phase margin for all other $\\beta$ values, although it may be sub-optimally compensated and slower than necessary in these cases."
},
{
    "text": "While first-order feedback amplifiers possess several favorable traits, practical feedback amplifiers typically feature multiple poles. The primary goal in designing amplifier $A$ is to achieve a high low-frequency gain. However, the maximum gain attainable with a single transistor, defined by its intrinsic gain $A_{i}=g_{m} r_{d s}$, is often inadequate. Consequently, multiple transistors must be integrated, leading to a more intricate circuit with several nodes and, unavoidably, multiple poles.\n\nA general second-order feedback loop transfer function is given by,\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s})=\\frac{\\mathrm{L}_{0}}{\\left(1+\\mathrm{s} / \\omega_{\\mathrm{p} 1}\\right)\\left(1+\\mathrm{s} / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.34}\n\\end{equation*}\n$$\n\nIt is assumed that $\\omega_{\\text {eq }}>\\omega_{\\mathrm{p} 1}$. The Bode plot of (5.34) in Fig. 5.7 clearly indicates unconditional stability, as a phase shift of $-180^{\\circ}$ is never reached. Nevertheless, the phase margin can approach $0^{\\circ}$ depending on $L_{0}, \\omega_{p}$, and $\\omega_{\\text {eq }}$.\n\nAt frequencies significantly higher than the dominant pole frequency, $\\omega \\gg \\omega_{\\mathrm{p} 1}$, it can be observed that $1+j \\omega / \\omega_{\\mathrm{p} 1} \\cong j \\omega / \\omega_{\\mathrm{p} 1}$, allowing (5.34) to be accurately approximated by\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s}) \\cong \\frac{\\omega_{\\mathrm{t}}}{\\mathrm{~s}\\left(1+\\mathrm{s} / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.35}\n\\end{equation*}\n$$\n\nKey Point: All-pole second-order feedback systems are unconditionally stable with a phase margin ranging from 90 to 0 degrees.\n\nThis approximation is particularly valid at the unity-gain frequency of the loop $\\omega_{\\mathrm{t}}$ (which is currently of interest) and is almost certainly much greater than $\\omega_{\\mathrm{p} 1}$, provided $\\mathrm{L}_{0}$ » 1.\n\nSince $L(s)=\\beta A(s)$, where $\\beta$ is a scalar constant, the poles are contributed by the forward amplifier, $\\mathrm{A}(\\mathrm{s})$. Using (5.34), we can define $\\mathrm{A}_{0}=\\mathrm{L}_{0} / \\beta$ as the dc gain of $\\mathrm{A}(\\mathrm{s})$ and $\\omega_{\\mathrm{ta}}=\\mathrm{A}_{0} \\omega_{\\mathrm{p} 1}$ as the approximate unity-gain frequency of $\\mathrm{A}(\\mathrm{s})$ under a dominant pole approximation. Thus, at frequencies around $\\omega_{\\mathrm{t}}$, the loop gain, $L(\\mathrm{~s})$, is expressed as\n\n$$\n\\begin{equation*}\nL(s)=\\beta A(s)=\\frac{\\beta \\omega_{\\mathrm{ta}}}{s\\left(1+s / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.36}\n\\end{equation*}\n$$\n\nThe unity-gain frequency, $\\omega_{\\mathrm{t}}$, can be determined by setting the magnitude of (5.36) to unity after substituting $\\mathrm{s}=\\mathrm{j} \\omega_{\\mathrm{t}}$. Upon rearranging the equation, we obtain\n\n$$\n\\begin{equation*}\n\\beta \\frac{\\omega_{\\mathrm{ta}}}{\\omega_{\\mathrm{eq}}}=\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}} \\sqrt{1+\\left(\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}}\\right)^{2}} \\tag{5.37}\n\\end{equation*}\n$$\n\nFor the special case where the unity-gain frequency is much lower than the equivalent nondominant pole frequency (i.e., $\\omega_{\\mathrm{t}}$ « $\\omega_{\\text {eq }}$ ), (5.37) can be simplified to\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{ta}}=\\frac{\\omega_{\\mathrm{t}}}{\\beta} \\sqrt{1+\\left(\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}}\\right)^{2}} \\cong \\frac{\\omega_{\\mathrm{t}}}{\\beta} \\tag{5.38}\n\\end{equation*}\n$$\n\nFrom (5.36), the phase shift, $\\angle \\mathrm{L}(\\omega)$, is determined as\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}(\\omega)=-90^{\\circ}-\\tan ^{-1}\\left(\\omega / \\omega_{\\mathrm{eq}}\\right) \\tag{5.39}\n\\end{equation*}\n$$\n\nThis equation implies that at the unity-gain frequency, $\\omega=\\omega_{\\mathrm{t}}$, we have\n\n$$\n\\begin{equation*}\n\\mathrm{PM}=\\angle \\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)-\\left(-180^{\\circ}\\right)=90^{\\circ}-\\tan ^{-1}\\left(\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}}\\right) \\tag{5.40}\n\\end{equation*}\n$$\n\nand, therefore,\n\nKey Point: The process of designing or modifying a feedback amplifier to achieve a specific phase margin is known as compensation.\n\n$$\n\\begin{align*}\n\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}} & =\\tan \\left(90^{\\circ}-\\mathrm{PM}\\right)  \\tag{5.41}\\\\\n\\Rightarrow \\omega_{\\mathrm{t}} & =\\tan \\left(90^{\\circ}-\\mathrm{PM}\\right) \\omega_{\\mathrm{eq}}\n\\end{align*}\n$$\n\nEquation (5.41) specifies the required $\\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}$ for a given phase margin. The process of designing or modifying a feedback amplifier to meet the $\\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}$ ratio specified by (5.41) for a target phase margin is termed compensation.\n\n#### EXAMPLE 5.7\n\nA closed-loop amplifier is required to have a $75^{\\circ}$ phase margin with $\\beta=1$. What is the necessary unity-gain frequency $f_{t}$ if $f_{\\text {eq }}=\\omega_{\\text {eq }} /(2 \\pi)=50 \\mathrm{MHz}$? What is the required $f_{\\mathrm{ta}}$?\n\n#### Solution\n\nUsing (5.40), we find $\\omega_{\\mathrm{t}}=0.268 \\omega_{\\text {eq }}$, indicating that the loop-gain unity-gain frequency is $f_{t}=\\omega_{t} / 2 \\pi=13.4 \\mathrm{MHz}$. From (5.38), for $\\beta=1$, we get $\\omega_{\\mathrm{ta}}=\\omega_{\\mathrm{t}} \\sqrt{1+0.268^{2}}=1.035 \\omega_{\\mathrm{t}}$, implying $\\mathrm{f}_{\\mathrm{ta}}=\\omega_{\\mathrm{ta}} / 2 \\pi=13.9 \\mathrm{MHz}$.\n\nThe closed-loop response of a second-order feedback amplifier can be determined by substituting (5.34) into (5.8) and rearranging, yielding\n\n$$\n\\begin{equation*}\n\\mathrm{A}_{\\mathrm{CL}}(\\mathrm{~s})=\\frac{\\mathrm{A}_{\\mathrm{CL} 0}}{1+\\frac{\\mathrm{s}\\left(1 / \\omega_{\\mathrm{p} 1}+1 / \\omega_{\\mathrm{eq}}\\right)}{1+\\mathrm{L}_{0}}+\\frac{\\mathrm{s}^{2}}{\\left(1+\\mathrm{L}_{0}\\right)\\left(\\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}\\right)}} \\tag{5.42}\n\\end{equation*}\n$$\n\nwhere\n\n$$\n\\begin{equation*}\nA_{C L 0} \\equiv \\frac{\\mathrm{~L}_{0} / \\beta}{1+\\mathrm{L}_{0}} \\cong \\frac{1}{\\beta} \\tag{5.43}\n\\end{equation*}\n$$\n\nTable 5.1 The relationship between $\\mathrm{PM}, \\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}, Q$ factor, and percentage overshoot\n\n| PM <br> (Phase margin) | $\\omega_{\\mathbf{t}} / \\omega_{\\text {eq }}$ | Q factor | Percentage <br> overshoot for a <br> step input |\n| :---: | :---: | :---: | :---: |\n| $55^{\\circ}$ | 0.700 | 0.925 | $13.3 \\%$ |\n| $60^{\\circ}$ | 0.580 | 0.817 | $8.7 \\%$ |\n| $65^{\\circ}$ | 0.470 | 0.717 | $4.7 \\%$ |\n| $70^{\\circ}$ | 0.360 | 0.622 | $1.4 \\%$ |\n| $75^{\\circ}$ | 0.270 | 0.527 | $0.008 \\%$ |\n| $80^{\\circ}$ | 0.175 | 0.421 | - |\n| $85^{\\circ}$ | 0.087 | 0.296 | - |\n\nThus, the closed-loop response is also second-order. The general equation for a second-order all-pole transfer function is\n\n$$\n\\begin{equation*}\nH(s)=\\frac{K \\omega_{0}^{2}}{s^{2}+\\left(\\frac{\\omega_{0}}{Q}\\right) s+\\omega_{0}^{2}}=\\frac{K}{1+\\frac{s}{\\omega_{0} Q}+\\frac{s^{2}}{\\omega_{0}^{2}}} \\tag{5.44}\n\\end{equation*}\n$$\n\nRecall from the previous chapter that $\\omega_{0}$ is termed the resonant frequency and the parameter Q is the Q factor ${ }^{5}$ [Sedra, 1991]. If $\\mathrm{Q}=\\sqrt{1 / 2} \\cong 0.707$, the magnitude response will have a -3 dB frequency equal to $\\omega_{0}$. Lower Q-factors $(\\mathrm{Q}<\\sqrt{1 / 2}$ ) result in reduced bandwidth, while higher Q-factors $(\\mathrm{Q}>\\sqrt{1 / 2}$ ) lead to peaking in the frequency response. Additionally, if $Q \\leq 0.5$, both poles of $A_{C L}(s)$ are real, resulting in no overshoot in the feedback amplifier's step response. When $Q>0.5$, the percentage overshoot of the step response is given by\n\n$$\n\\begin{equation*}\n\\% \\text { overshoot }=100 e^{\\frac{-\\pi}{\\sqrt{4 Q^{2}-1}}} \\tag{5.45}\n\\end{equation*}\n$$\n\nEquating (5.42) with (5.44) and solving for $\\omega_{0}$ and Q yields\n\n$$\n\\begin{equation*}\n\\omega_{0}=\\sqrt{\\left(1+\\mathrm{L}_{0}\\right)\\left(\\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}\\right)} \\cong \\sqrt{\\omega_{i} \\omega_{\\mathrm{eq}}} \\tag{5.46}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{equation*}\nQ=\\frac{\\sqrt{\\left(1+\\mathrm{L}_{0}\\right) / \\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}}}{1 / \\omega_{\\mathrm{p} 1}+1 / \\omega_{\\mathrm{eq}}} \\cong \\sqrt{\\frac{\\mathrm{~L}_{0} \\omega_{\\mathrm{p} 1}}{\\omega_{\\mathrm{eq}}}}=\\sqrt{\\frac{\\beta \\omega_{\\mathrm{ta}}}{\\omega_{\\mathrm{eq}}}} \\tag{5.47}\n\\end{equation*}\n$$\n\nwhere the approximation on $Q$ is valid since $L_{0}>>1$ and $\\omega_{\\mathrm{p} 1}<<\\omega_{\\mathrm{eq}}$.\nIt is now possible to relate a specified phase margin to the Q factor of the resulting closed-loop amplifier. Equation (5.41) can be used to find $\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}}$. This result can be substituted into (5.37) to find $\\beta\\left(\\omega_{\\mathrm{ta}} / \\omega_{\\mathrm{eq}}\\right)$, which can then be substituted into (5.47) to determine the equivalent Q factor. Finally, (5.45) can be used to find the corresponding percentage overshoot for a step input. This procedure provides the data in Table 5.1.\n\nTable 5.1 leads to some interesting observations. First, a frequency response with $Q \\cong \\sqrt{1 / 2}$ roughly corresponds to a phase margin of $65^{\\circ}$. Therefore, a common specification is to design for a phase margin of at least $65^{\\circ}$ to avoid peaking in the closed-loop amplifier's frequency response, considering both process and temperature changes. If no overshoot for a step input is desired, the phase margin should be at least $75^{\\circ}$, again accounting for process and temperature variations. Hence, a nominal phase margin of $80^{\\circ}$ to $85^{\\circ}$ is often targeted to accommodate these variations.\n5. The Q factor is $1 / 2$ times the inverse of the damping factor. The damping factor is another method of indicating the pole locations in second-order transfer functions.\n\nFinally, it is worth noting that when an amplifier is designed for use with various feedback networks, the worst-case phase margin occurs for the maximum value of $\\beta$, which corresponds to the smallest closed-loop gain. Thus, the amplifier is designed to ensure sufficient phase margin for the maximum $\\beta$. This guarantees that it will have an even greater phase margin for all other $\\beta$ values, although it may be sub-optimally compensated and slower than necessary in these cases."
},
{
    "text": "Although first-order feedback amplifiers possess several favorable traits, practical feedback amplifiers typically feature multiple poles. The primary goal in designing the amplifier $A$ is to achieve a high low-frequency gain. However, the maximum gain achievable with a single transistor, represented by its intrinsic gain $A_{i}=g_{m} r_{d s}$, is often inadequate. Consequently, multiple transistors must be used, resulting in a more complex circuit with several nodes and, inevitably, multiple poles.\n\nA general second-order feedback loop transfer function is given by,\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s})=\\frac{\\mathrm{L}_{0}}{\\left(1+\\mathrm{s} / \\omega_{\\mathrm{p} 1}\\right)\\left(1+\\mathrm{s} / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.34}\n\\end{equation*}\n$$\n\nIt is assumed that $\\omega_{\\text {eq }}>\\omega_{\\mathrm{p} 1}$. The Bode plot of (5.34) in Fig. 5.7 clearly indicates unconditional stability, as a phase shift of $-180^{\\circ}$ is never reached. Nonetheless, the phase margin can approach $0^{\\circ}$ depending on $L_{0}, \\omega_{p}$, and $\\omega_{\\text {eq }}$.\n\nAt frequencies significantly higher than the dominant pole frequency, $\\omega \\gg \\omega_{\\mathrm{p} 1}$, we observe that $1+j \\omega / \\omega_{\\mathrm{p} 1} \\cong j \\omega / \\omega_{\\mathrm{p} 1}$, allowing (5.34) to be accurately approximated by\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s}) \\cong \\frac{\\omega_{\\mathrm{t}}}{\\mathrm{~s}\\left(1+\\mathrm{s} / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.35}\n\\end{equation*}\n$$\n\nKey Point: All-pole second-order feedback systems are unconditionally stable with a phase margin ranging from 90 to 0 degrees.\n\nThis approximation is particularly valid at the unity-gain frequency of the loop $\\omega_{\\mathrm{t}}$ (which is currently of interest) and is almost certainly much greater than $\\omega_{\\mathrm{p} 1}$, provided $\\mathrm{L}_{0}$ » 1.\n\nSince $L(s)=\\beta A(s)$, where $\\beta$ is a scalar constant, the poles are contributed by the forward amplifier, $\\mathrm{A}(\\mathrm{s})$. Using (5.34), we can define $\\mathrm{A}_{0}=\\mathrm{L}_{0} / \\beta$ as the dc gain of $\\mathrm{A}(\\mathrm{s})$ and $\\omega_{\\mathrm{ta}}=\\mathrm{A}_{0} \\omega_{\\mathrm{p} 1}$ as the approximate unity-gain frequency of $\\mathrm{A}(\\mathrm{s})$ under a dominant pole approximation. Thus, at frequencies around $\\omega_{\\mathrm{t}}$, the loop gain, $L(\\mathrm{~s})$, is expressed as\n\n$$\n\\begin{equation*}\nL(s)=\\beta A(s)=\\frac{\\beta \\omega_{\\mathrm{ta}}}{s\\left(1+s / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.36}\n\\end{equation*}\n$$\n\nThe unity-gain frequency, $\\omega_{\\mathrm{t}}$, can be determined by setting the magnitude of (5.36) to unity after substituting $\\mathrm{s}=\\mathrm{j} \\omega_{\\mathrm{t}}$. Upon rearranging the equation, we obtain,\n\n$$\n\\begin{equation*}\n\\beta \\frac{\\omega_{\\mathrm{ta}}}{\\omega_{\\mathrm{eq}}}=\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}} \\sqrt{1+\\left(\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}}\\right)^{2}} \\tag{5.37}\n\\end{equation*}\n$$\n\nFor the special case where the unity-gain frequency is much lower than the equivalent nondominant pole frequency (i.e., $\\omega_{\\mathrm{t}}$ « $\\omega_{\\text {eq }}$ ), (5.37) can be simplified to\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{ta}}=\\frac{\\omega_{\\mathrm{t}}}{\\beta} \\sqrt{1+\\left(\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}}\\right)^{2}} \\cong \\frac{\\omega_{\\mathrm{t}}}{\\beta} \\tag{5.38}\n\\end{equation*}\n$$\n\nFrom (5.36), the phase shift, $\\angle \\mathrm{L}(\\omega)$, is determined as\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}(\\omega)=-90^{\\circ}-\\tan ^{-1}\\left(\\omega / \\omega_{\\mathrm{eq}}\\right) \\tag{5.39}\n\\end{equation*}\n$$\n\nThis implies that at the unity-gain frequency, $\\omega=\\omega_{\\mathrm{t}}$, we have\n\n$$\n\\begin{equation*}\n\\mathrm{PM}=\\angle \\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)-\\left(-180^{\\circ}\\right)=90^{\\circ}-\\tan ^{-1}\\left(\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}}\\right) \\tag{5.40}\n\\end{equation*}\n$$\n\nand, consequently,\n\nKey Point: The process of designing or modifying a feedback amplifier to achieve a specific phase margin is known as compensation.\n\n$$\n\\begin{align*}\n\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}} & =\\tan \\left(90^{\\circ}-\\mathrm{PM}\\right)  \\tag{5.41}\\\\\n\\Rightarrow \\omega_{\\mathrm{t}} & =\\tan \\left(90^{\\circ}-\\mathrm{PM}\\right) \\omega_{\\mathrm{eq}}\n\\end{align*}\n$$\n\nEquation (5.41) specifies the required $\\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}$ for a given phase margin. The process of designing or modifying a feedback amplifier to achieve the ratio $\\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}$ as per (5.41) for a targeted phase margin is termed compensation.\n\n#### EXAMPLE 5.7\n\nA closed-loop amplifier is required to have a $75^{\\circ}$ phase margin with $\\beta=1$. What is the necessary unity-gain frequency $f_{t}$ if $f_{\\text {eq }}=\\omega_{\\text {eq }} /(2 \\pi)=50 \\mathrm{MHz}$ ? What is the required $f_{\\mathrm{ta}}$ ?\n\n#### Solution\n\nUsing (5.40), we find $\\omega_{\\mathrm{t}}=0.268 \\omega_{\\text {eq }}$, indicating that the loop-gain unity-gain frequency is $f_{t}=\\omega_{t} / 2 \\pi=13.4 \\mathrm{MHz}$. Using (5.38), for $\\beta=1$, we get $\\omega_{\\mathrm{ta}}=\\omega_{\\mathrm{t}} \\sqrt{1+0.268^{2}}=1.035 \\omega_{\\mathrm{t}}$, implying $\\mathrm{f}_{\\mathrm{ta}}=\\omega_{\\mathrm{ta}} / 2 \\pi=13.9 \\mathrm{MHz}$.\n\nThe closed-loop response of a second-order feedback amplifier can be determined by substituting (5.34) into (5.8) and rearranging.\n\n$$\n\\begin{equation*}\n\\mathrm{A}_{\\mathrm{CL}}(\\mathrm{~s})=\\frac{\\mathrm{A}_{\\mathrm{CL} 0}}{1+\\frac{\\mathrm{s}\\left(1 / \\omega_{\\mathrm{p} 1}+1 / \\omega_{\\mathrm{eq}}\\right)}{1+\\mathrm{L}_{0}}+\\frac{\\mathrm{s}^{2}}{\\left(1+\\mathrm{L}_{0}\\right)\\left(\\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}\\right)}} \\tag{5.42}\n\\end{equation*}\n$$\n\nwhere\n\n$$\n\\begin{equation*}\nA_{C L 0} \\equiv \\frac{\\mathrm{~L}_{0} / \\beta}{1+\\mathrm{L}_{0}} \\cong \\frac{1}{\\beta} \\tag{5.43}\n\\end{equation*}\n$$\n\nTable 5.1 The relationship between $\\mathrm{PM}, \\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}, Q$ factor, and percentage overshoot\n\n| PM <br> (Phase margin) | $\\omega_{\\mathbf{t}} / \\omega_{\\text {eq }}$ | Q factor | Percentage <br> overshoot for a <br> step input |\n| :---: | :---: | :---: | :---: |\n| $55^{\\circ}$ | 0.700 | 0.925 | $13.3 \\%$ |\n| $60^{\\circ}$ | 0.580 | 0.817 | $8.7 \\%$ |\n| $65^{\\circ}$ | 0.470 | 0.717 | $4.7 \\%$ |\n| $70^{\\circ}$ | 0.360 | 0.622 | $1.4 \\%$ |\n| $75^{\\circ}$ | 0.270 | 0.527 | $0.008 \\%$ |\n| $80^{\\circ}$ | 0.175 | 0.421 | - |\n| $85^{\\circ}$ | 0.087 | 0.296 | - |\n\nThus, the closed-loop response is also second-order. The general equation for a second-order all-pole transfer function is\n\n$$\n\\begin{equation*}\nH(s)=\\frac{K \\omega_{0}^{2}}{s^{2}+\\left(\\frac{\\omega_{0}}{Q}\\right) s+\\omega_{0}^{2}}=\\frac{K}{1+\\frac{s}{\\omega_{0} Q}+\\frac{s^{2}}{\\omega_{0}^{2}}} \\tag{5.44}\n\\end{equation*}\n$$\n\nRecall from the previous chapter that $\\omega_{0}$ is termed the resonant frequency and the parameter Q is known as the Q factor ${ }^{5}$ [Sedra, 1991]. If $\\mathrm{Q}=\\sqrt{1 / 2} \\cong 0.707$, the magnitude response will exhibit a -3 dB frequency equal to $\\omega_{0}$. Lower Q factors $(\\mathrm{Q}<\\sqrt{1 / 2}$ ) result in reduced bandwidth, whereas higher Q factors $(\\mathrm{Q}>\\sqrt{1 / 2}$ ) lead to peaking in the frequency response. Additionally, recall that if $Q \\leq 0.5$, both poles of $A_{C L}(s)$ are real, resulting in no overshoot in the feedback amplifier's step response. When $Q>0.5$, the percentage overshoot of the step response is given by\n\n$$\n\\begin{equation*}\n\\% \\text { overshoot }=100 e^{\\frac{-\\pi}{\\sqrt{4 Q^{2}-1}}} \\tag{5.45}\n\\end{equation*}\n$$\n\nEquating (5.42) with (5.44) and solving for $\\omega_{0}$ and Q yields\n\n$$\n\\begin{equation*}\n\\omega_{0}=\\sqrt[t]{\\left(1+\\mathrm{L}_{0}\\right)\\left(\\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}\\right)} \\cong \\sqrt{\\omega_{i} \\omega_{\\mathrm{eq}}} \\tag{5.46}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{equation*}\nQ=\\frac{\\sqrt{\\left(1+\\mathrm{L}_{0}\\right) / \\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}}}{1 / \\omega_{\\mathrm{p} 1}+1 / \\omega_{\\mathrm{eq}}} \\cong \\sqrt{\\frac{\\mathrm{~L}_{0} \\omega_{\\mathrm{p} 1}}{\\omega_{\\mathrm{eq}}}}=\\sqrt{\\frac{\\beta \\omega_{\\mathrm{ta}}}{\\omega_{\\mathrm{eq}}}} \\tag{5.47}\n\\end{equation*}\n$$\n\nwhere the approximation on $Q$ is valid since $L_{0}>>1$ and $\\omega_{\\mathrm{p} 1}<<\\omega_{\\mathrm{eq}}$.\nIt is now possible to relate a specified phase margin to the Q factor of the resulting closed-loop amplifier. Equation (5.41) can be used to find $\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}}$. This result can be substituted into (5.37) to find $\\beta\\left(\\omega_{\\mathrm{ta}} / \\omega_{\\mathrm{eq}}\\right)$, which can then be substituted into (5.47) to determine the equivalent Q factor. Finally, (5.45) can be used to find the corresponding percentage overshoot for a step input. This procedure yields the data in Table 5.1.\n\nTable 5.1 leads to some insightful observations. First, a frequency response with $Q \\cong \\sqrt{1 / 2}$ approximately corresponds to a phase margin of $65^{\\circ}$. Therefore, a common specification is to design for a phase margin of at least $65^{\\circ}$ to avoid peaking in the closed-loop amplifier's frequency response, considering both process and temperature changes. If no overshoot for a step input is desired, the phase margin should be at least $75^{\\circ}$, again accounting for process and temperature variations. Hence, a nominal phase margin of $80^{\\circ}$ to $85^{\\circ}$ is often targeted to accommodate these variations.\n5. The Q factor is $1 / 2$ times the inverse of the damping factor. The damping factor is another method of indicating the pole locations in second-order transfer functions.\n\nFinally, it is worth noting that when an amplifier is designed for use with various feedback networks, the worst-case phase margin occurs at the maximum value of $\\beta$, corresponding to the smallest closed-loop gain. Thus, the amplifier is designed to ensure sufficient phase margin for the maximum $\\beta$. It is then guaranteed to have an even greater phase margin for all other $\\beta$, although it may be sub-optimally compensated and slower than necessary in these cases."
},
{
    "text": "Despite the favorable traits of first-order feedback amplifiers, practical implementations typically feature multiple poles. The primary goal in designing amplifier $A$ is to achieve a high low-frequency gain. However, the maximum gain achievable with a single transistor, represented by its intrinsic gain $A_{i}=g_{m} r_{d s}$, is often inadequate. Consequently, multiple transistors must be integrated, resulting in a more intricate circuit with several nodes and, inevitably, multiple poles.\n\nA general second-order feedback loop transfer function is given by,\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s})=\\frac{\\mathrm{L}_{0}}{\\left(1+\\mathrm{s} / \\omega_{\\mathrm{p} 1}\\right)\\left(1+\\mathrm{s} / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.34}\n\\end{equation*}\n$$\n\nIt is assumed that $\\omega_{\\text {eq }}>\\omega_{\\mathrm{p} 1}$. The Bode plot of (5.34) in Fig. 5.7 clearly indicates unconditional stability, as a phase shift of $-180^{\\circ}$ is never reached. Nonetheless, the phase margin can approach $0^{\\circ}$ depending on $L_{0}, \\omega_{p}$, and $\\omega_{\\text {eq }}$.\n\nAt frequencies significantly higher than the dominant pole frequency, $\\omega \\gg \\omega_{\\mathrm{p} 1}$, we observe that $1+j \\omega / \\omega_{\\mathrm{p} 1} \\cong j \\omega / \\omega_{\\mathrm{p} 1}$, allowing (5.34) to be accurately approximated by\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s}) \\cong \\frac{\\omega_{\\mathrm{t}}}{\\mathrm{~s}\\left(1+\\mathrm{s} / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.35}\n\\end{equation*}\n$$\n\nKey Point: All-pole second-order feedback systems are unconditionally stable with a phase margin ranging from 90 to 0 degrees.\n\nThis approximation is particularly valid at the loop's unity-gain frequency $\\omega_{\\mathrm{t}}$ (which is currently of interest) and is almost certainly much greater than $\\omega_{\\mathrm{p} 1}$, provided $\\mathrm{L}_{0}$ » 1.\n\nSince $L(s)=\\beta A(s)$, where $\\beta$ is a scalar constant, it is evident that the poles are derived from the forward amplifier, $\\mathrm{A}(\\mathrm{s})$. Using (5.34), we can define $\\mathrm{A}_{0}=\\mathrm{L}_{0} / \\beta$ as the dc gain of $\\mathrm{A}(\\mathrm{s})$ and $\\omega_{\\mathrm{ta}}=\\mathrm{A}_{0} \\omega_{\\mathrm{p} 1}$ as the approximate unity-gain frequency of $\\mathrm{A}(\\mathrm{s})$ under a dominant pole approximation. Thus, at frequencies around $\\omega_{\\mathrm{t}}$, the loop gain, $L(\\mathrm{~s})$, is expressed as\n\n$$\n\\begin{equation*}\nL(s)=\\beta A(s)=\\frac{\\beta \\omega_{\\mathrm{ta}}}{s\\left(1+s / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.36}\n\\end{equation*}\n$$\n\nThe unity-gain frequency, $\\omega_{\\mathrm{t}}$, can be determined by setting the magnitude of (5.36) to unity after substituting $\\mathrm{s}=\\mathrm{j} \\omega_{\\mathrm{t}}$. Rearranging the equation yields,\n\n$$\n\\begin{equation*}\n\\beta \\frac{\\omega_{\\mathrm{ta}}}{\\omega_{\\mathrm{eq}}}=\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}} \\sqrt{1+\\left(\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}}\\right)^{2}} \\tag{5.37}\n\\end{equation*}\n$$\n\nFor the special case where the unity-gain frequency is much lower than the equivalent nondominant pole frequency (i.e., $\\omega_{\\mathrm{t}}$ « $\\omega_{\\text {eq }}$), (5.37) simplifies to\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{ta}}=\\frac{\\omega_{\\mathrm{t}}}{\\beta} \\sqrt{1+\\left(\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}}\\right)^{2}} \\cong \\frac{\\omega_{\\mathrm{t}}}{\\beta} \\tag{5.38}\n\\end{equation*}\n$$\n\nFrom (5.36), the phase shift, $\\angle \\mathrm{L}(\\omega)$, is determined as\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}(\\omega)=-90^{\\circ}-\\tan ^{-1}\\left(\\omega / \\omega_{\\mathrm{eq}}\\right) \\tag{5.39}\n\\end{equation*}\n$$\n\nThis implies that at the unity-gain frequency, $\\omega=\\omega_{\\mathrm{t}}$, we have\n\n$$\n\\begin{equation*}\n\\mathrm{PM}=\\angle \\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)-\\left(-180^{\\circ}\\right)=90^{\\circ}-\\tan ^{-1}\\left(\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}}\\right) \\tag{5.40}\n\\end{equation*}\n$$\n\nKey Point: The process of designing or modifying a feedback amplifier to achieve a specific phase margin is known as compensation.\n\n$$\n\\begin{align*}\n\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}} & =\\tan \\left(90^{\\circ}-\\mathrm{PM}\\right)  \\tag{5.41}\\\\\n\\Rightarrow \\omega_{\\mathrm{t}} & =\\tan \\left(90^{\\circ}-\\mathrm{PM}\\right) \\omega_{\\mathrm{eq}}\n\\end{align*}\n$$\n\nEquation (5.41) specifies the required $\\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}$ for a given phase margin. Designing or modifying a feedback amplifier to meet the $\\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}$ ratio specified by (5.41) for a target phase margin is termed compensation.\n\n#### EXAMPLE 5.7\n\nFor a closed-loop amplifier with a $75^{\\circ}$ phase margin and $\\beta=1$, determine the required unity-gain frequency $f_{t}$ if $f_{\\text {eq }}=\\omega_{\\text {eq }} /(2 \\pi)=50 \\mathrm{MHz}$. Also, find the required $f_{\\mathrm{ta}}$.\n\n#### Solution\n\nUsing (5.40), we find $\\omega_{\\mathrm{t}}=0.268 \\omega_{\\text {eq }}$, indicating that the loop-gain unity-gain frequency is $f_{t}=\\omega_{t} / 2 \\pi=13.4 \\mathrm{MHz}$. From (5.38), for $\\beta=1$, we get $\\omega_{\\mathrm{ta}}=\\omega_{\\mathrm{t}} \\sqrt{1+0.268^{2}}=1.035 \\omega_{\\mathrm{t}}$, implying $\\mathrm{f}_{\\mathrm{ta}}=\\omega_{\\mathrm{ta}} / 2 \\pi=13.9 \\mathrm{MHz}$.\n\nThe closed-loop response of a second-order feedback amplifier can be derived by substituting (5.34) into (5.8) and rearranging, resulting in\n\n$$\n\\begin{equation*}\n\\mathrm{A}_{\\mathrm{CL}}(\\mathrm{~s})=\\frac{\\mathrm{A}_{\\mathrm{CL} 0}}{1+\\frac{\\mathrm{s}\\left(1 / \\omega_{\\mathrm{p} 1}+1 / \\omega_{\\mathrm{eq}}\\right)}{1+\\mathrm{L}_{0}}+\\frac{\\mathrm{s}^{2}}{\\left(1+\\mathrm{L}_{0}\\right)\\left(\\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}\\right)}} \\tag{5.42}\n\\end{equation*}\n$$\n\nwhere\n\n$$\n\\begin{equation*}\nA_{C L 0} \\equiv \\frac{\\mathrm{~L}_{0} / \\beta}{1+\\mathrm{L}_{0}} \\cong \\frac{1}{\\beta} \\tag{5.43}\n\\end{equation*}\n$$\n\nTable 5.1 The relationship between $\\mathrm{PM}, \\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}, Q$ factor, and percentage overshoot\n\n| PM <br> (Phase margin) | $\\omega_{\\mathbf{t}} / \\omega_{\\text {eq }}$ | Q factor | Percentage <br> overshoot for a <br> step input |\n| :---: | :---: | :---: | :---: |\n| $55^{\\circ}$ | 0.700 | 0.925 | $13.3 \\%$ |\n| $60^{\\circ}$ | 0.580 | 0.817 | $8.7 \\%$ |\n| $65^{\\circ}$ | 0.470 | 0.717 | $4.7 \\%$ |\n| $70^{\\circ}$ | 0.360 | 0.622 | $1.4 \\%$ |\n| $75^{\\circ}$ | 0.270 | 0.527 | $0.008 \\%$ |\n| $80^{\\circ}$ | 0.175 | 0.421 | - |\n| $85^{\\circ}$ | 0.087 | 0.296 | - |\n\nThus, the closed-loop response is also second-order. The general equation for a second-order all-pole transfer function is\n\n$$\n\\begin{equation*}\nH(s)=\\frac{K \\omega_{0}^{2}}{s^{2}+\\left(\\frac{\\omega_{0}}{Q}\\right) s+\\omega_{0}^{2}}=\\frac{K}{1+\\frac{s}{\\omega_{0} Q}+\\frac{s^{2}}{\\omega_{0}^{2}}} \\tag{5.44}\n\\end{equation*}\n$$\n\nRecall that $\\omega_{0}$ is termed the resonant frequency and Q is the Q factor ${ }^{5}$ [Sedra, 1991]. If $\\mathrm{Q}=\\sqrt{1 / 2} \\cong 0.707$, the magnitude response will have a -3 dB frequency equal to $\\omega_{0}$. Lower Q-factors $(\\mathrm{Q}<\\sqrt{1 / 2}$) lead to reduced bandwidth, while higher Q-factors $(\\mathrm{Q}>\\sqrt{1 / 2}$) cause peaking in the frequency response. Additionally, if $Q \\leq 0.5$, both poles of $A_{C L}(s)$ are real, resulting in no overshoot in the feedback amplifier's step response. For $Q>0.5$, the percentage overshoot of the step response is given by\n\n$$\n\\begin{equation*}\n\\% \\text { overshoot }=100 e^{\\frac{-\\pi}{\\sqrt{4 Q^{2}-1}}} \\tag{5.45}\n\\end{equation*}\n$$\n\nEquating (5.42) with (5.44) and solving for $\\omega_{0}$ and Q yields\n\n$$\n\\begin{equation*}\n\\omega_{0}=\\sqrt[t]{\\left(1+\\mathrm{L}_{0}\\right)\\left(\\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}\\right)} \\cong \\sqrt{\\omega_{i} \\omega_{\\mathrm{eq}}} \\tag{5.46}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{equation*}\nQ=\\frac{\\sqrt{\\left(1+\\mathrm{L}_{0}\\right) / \\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}}}{1 / \\omega_{\\mathrm{p} 1}+1 / \\omega_{\\mathrm{eq}}} \\cong \\sqrt{\\frac{\\mathrm{~L}_{0} \\omega_{\\mathrm{p} 1}}{\\omega_{\\mathrm{eq}}}}=\\sqrt{\\frac{\\beta \\omega_{\\mathrm{ta}}}{\\omega_{\\mathrm{eq}}}} \\tag{5.47}\n\\end{equation*}\n$$\n\nwhere the approximation on $Q$ holds since $L_{0}>>1$ and $\\omega_{\\mathrm{p} 1}<<\\omega_{\\mathrm{eq}}$.\nIt is now possible to relate a specified phase margin to the Q factor of the resulting closed-loop amplifier. Using (5.41) to find $\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}}$, this result can be substituted into (5.37) to determine $\\beta\\left(\\omega_{\\mathrm{ta}} / \\omega_{\\mathrm{eq}}\\right)$, which can then be used in (5.47) to find the equivalent Q factor. Finally, (5.45) can be applied to determine the corresponding percentage overshoot for a step input, as summarized in Table 5.1.\n\nTable 5.1 reveals some interesting insights. A frequency response with $Q \\cong \\sqrt{1 / 2}$ corresponds roughly to a phase margin of $65^{\\circ}$. Therefore, a common design target is a phase margin of at least $65^{\\circ}$ to avoid peaking in the closed-loop amplifier's frequency response, considering both process and temperature variations. To ensure no overshoot for a step input, the phase margin should be at least $75^{\\circ}$, again accounting for process and temperature changes. Hence, a nominal phase margin of $80^{\\circ}$ to $85^{\\circ}$ is often aimed for to accommodate these variations.\n\n5. The Q factor is $1 / 2$ times the inverse of the damping factor. The damping factor is another method of indicating pole locations in second-order transfer functions.\n\nFinally, it is important to note that when an amplifier is designed for use with various feedback networks, the worst-case phase margin occurs at the maximum value of $\\beta$, corresponding to the smallest closed-loop gain. Thus, the amplifier is designed to ensure sufficient phase margin for the maximum $\\beta$. This guarantees that it will have an even greater phase margin for all other $\\beta$ values, although it may be sub-optimally compensated and slower than necessary in these cases."
},
{
    "text": "While first-order feedback amplifiers possess several advantageous traits, practical feedback amplifiers typically feature multiple poles. The primary goal in designing amplifier $A$ is to achieve a high low-frequency gain. However, the maximum gain achievable with a single transistor, defined by its intrinsic gain $A_{i}=g_{m} r_{d s}$, is often inadequate. Consequently, multiple transistors must be integrated, resulting in a more intricate circuit with several nodes and, inevitably, multiple poles.\n\nA general second-order feedback loop transfer function is given by,\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s})=\\frac{\\mathrm{L}_{0}}{\\left(1+\\mathrm{s} / \\omega_{\\mathrm{p} 1}\\right)\\left(1+\\mathrm{s} / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.34}\n\\end{equation*}\n$$\n\nIt is assumed that $\\omega_{\\text {eq }}>\\omega_{\\mathrm{p} 1}$. The Bode plot of (5.34) in Fig. 5.7 clearly indicates unconditional stability, as a phase shift of $-180^{\\circ}$ is never reached. Nonetheless, the phase margin may approach $0^{\\circ}$ depending on $L_{0}, \\omega_{p}$, and $\\omega_{\\text {eq }}$.\n\nAt frequencies significantly higher than the dominant pole frequency, $\\omega \\gg \\omega_{\\mathrm{p} 1}$, it can be observed that $1+j \\omega / \\omega_{\\mathrm{p} 1} \\cong j \\omega / \\omega_{\\mathrm{p} 1}$, allowing (5.34) to be accurately approximated by\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s}) \\cong \\frac{\\omega_{\\mathrm{t}}}{\\mathrm{~s}\\left(1+\\mathrm{s} / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.35}\n\\end{equation*}\n$$\n\nKey Point: All-pole second-order feedback systems are unconditionally stable with a phase margin ranging from 90 to 0 degrees.\n\nThis approximation is particularly valid at the loop's unity-gain frequency $\\omega_{\\mathrm{t}}$ (which is currently of interest) and is almost certainly much greater than $\\omega_{\\mathrm{p} 1}$, provided $\\mathrm{L}_{0}$ » 1.\n\nSince $L(s)=\\beta A(s)$, where $\\beta$ is a scalar constant, the poles are contributed by the forward amplifier, $\\mathrm{A}(\\mathrm{s})$. Using (5.34), we can define $\\mathrm{A}_{0}=\\mathrm{L}_{0} / \\beta$ as the dc gain of $\\mathrm{A}(\\mathrm{s})$ and $\\omega_{\\mathrm{ta}}=\\mathrm{A}_{0} \\omega_{\\mathrm{p} 1}$ as the approximate unity-gain frequency of $\\mathrm{A}(\\mathrm{s})$ under a dominant pole approximation. Thus, at frequencies around $\\omega_{\\mathrm{t}}$, the loop gain, $L(\\mathrm{~s})$, is expressed as\n\n$$\n\\begin{equation*}\nL(s)=\\beta A(s)=\\frac{\\beta \\omega_{\\mathrm{ta}}}{s\\left(1+s / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.36}\n\\end{equation*}\n$$\n\nThe unity-gain frequency, $\\omega_{\\mathrm{t}}$, can be determined by setting the magnitude of (5.36) to unity after substituting $\\mathrm{s}=\\mathrm{j} \\omega_{\\mathrm{t}}$. Upon rearranging, we obtain,\n\n$$\n\\begin{equation*}\n\\beta \\frac{\\omega_{\\mathrm{ta}}}{\\omega_{\\mathrm{eq}}}=\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}} \\sqrt{1+\\left(\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}}\\right)^{2}} \\tag{5.37}\n\\end{equation*}\n$$\n\nFor the special case where the unity-gain frequency is much lower than the equivalent nondominant pole frequency (i.e., $\\omega_{\\mathrm{t}}$ « $\\omega_{\\text {eq }}$), (5.37) simplifies to\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{ta}}=\\frac{\\omega_{\\mathrm{t}}}{\\beta} \\sqrt{1+\\left(\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}}\\right)^{2}} \\cong \\frac{\\omega_{\\mathrm{t}}}{\\beta} \\tag{5.38}\n\\end{equation*}\n$$\n\nFrom (5.36), the phase shift, $\\angle \\mathrm{L}(\\omega)$, is derived as\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}(\\omega)=-90^{\\circ}-\\tan ^{-1}\\left(\\omega / \\omega_{\\mathrm{eq}}\\right) \\tag{5.39}\n\\end{equation*}\n$$\n\nThis implies that at the unity-gain frequency, $\\omega=\\omega_{\\mathrm{t}}$, we have\n\n$$\n\\begin{equation*}\n\\mathrm{PM}=\\angle \\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)-\\left(-180^{\\circ}\\right)=90^{\\circ}-\\tan ^{-1}\\left(\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}}\\right) \\tag{5.40}\n\\end{equation*}\n$$\n\nand, consequently,\n\nKey Point: The process of designing or modifying a feedback amplifier to achieve a specific phase margin is known as compensation.\n\n$$\n\\begin{align*}\n\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}} & =\\tan \\left(90^{\\circ}-\\mathrm{PM}\\right)  \\tag{5.41}\\\\\n\\Rightarrow \\omega_{\\mathrm{t}} & =\\tan \\left(90^{\\circ}-\\mathrm{PM}\\right) \\omega_{\\mathrm{eq}}\n\\end{align*}\n$$\n\nEquation (5.41) specifies the required $\\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}$ for a given phase margin. Designing or modifying a feedback amplifier to meet the ratio $\\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}$ as per (5.41) for a target phase margin is termed compensation.\n\n#### EXAMPLE 5.7\n\nA closed-loop amplifier is required to have a $75^{\\circ}$ phase margin with $\\beta=1$. What is the necessary unity-gain frequency $f_{t}$ if $f_{\\text {eq }}=\\omega_{\\text {eq }} /(2 \\pi)=50 \\mathrm{MHz}$? What is the required $f_{\\mathrm{ta}}$?\n\n#### Solution\n\nUsing (5.40), we find $\\omega_{\\mathrm{t}}=0.268 \\omega_{\\text {eq }}$, indicating that the loop-gain unity-gain frequency is $f_{t}=\\omega_{t} / 2 \\pi=13.4 \\mathrm{MHz}$. From (5.38), for $\\beta=1$, we have $\\omega_{\\mathrm{ta}}=\\omega_{\\mathrm{t}} \\sqrt{1+0.268^{2}}=1.035 \\omega_{\\mathrm{t}}$, implying $\\mathrm{f}_{\\mathrm{ta}}=\\omega_{\\mathrm{ta}} / 2 \\pi=13.9 \\mathrm{MHz}$.\n\nThe closed-loop response of a second-order feedback amplifier can be determined by substituting (5.34) into (5.8) and rearranging, resulting in\n\n$$\n\\begin{equation*}\n\\mathrm{A}_{\\mathrm{CL}}(\\mathrm{~s})=\\frac{\\mathrm{A}_{\\mathrm{CL} 0}}{1+\\frac{\\mathrm{s}\\left(1 / \\omega_{\\mathrm{p} 1}+1 / \\omega_{\\mathrm{eq}}\\right)}{1+\\mathrm{L}_{0}}+\\frac{\\mathrm{s}^{2}}{\\left(1+\\mathrm{L}_{0}\\right)\\left(\\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}\\right)}} \\tag{5.42}\n\\end{equation*}\n$$\n\nwhere\n\n$$\n\\begin{equation*}\nA_{C L 0} \\equiv \\frac{\\mathrm{~L}_{0} / \\beta}{1+\\mathrm{L}_{0}} \\cong \\frac{1}{\\beta} \\tag{5.43}\n\\end{equation*}\n$$\n\nTable 5.1 The relationship between $\\mathrm{PM}, \\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}, Q$ factor, and percentage overshoot\n\n| PM <br> (Phase margin) | $\\omega_{\\mathbf{t}} / \\omega_{\\text {eq }}$ | Q factor | Percentage <br> overshoot for a <br> step input |\n| :---: | :---: | :---: | :---: |\n| $55^{\\circ}$ | 0.700 | 0.925 | $13.3 \\%$ |\n| $60^{\\circ}$ | 0.580 | 0.817 | $8.7 \\%$ |\n| $65^{\\circ}$ | 0.470 | 0.717 | $4.7 \\%$ |\n| $70^{\\circ}$ | 0.360 | 0.622 | $1.4 \\%$ |\n| $75^{\\circ}$ | 0.270 | 0.527 | $0.008 \\%$ |\n| $80^{\\circ}$ | 0.175 | 0.421 | - |\n| $85^{\\circ}$ | 0.087 | 0.296 | - |\n\nThus, the closed-loop response is also second-order. The general equation for a second-order all-pole transfer function is\n\n$$\n\\begin{equation*}\nH(s)=\\frac{K \\omega_{0}^{2}}{s^{2}+\\left(\\frac{\\omega_{0}}{Q}\\right) s+\\omega_{0}^{2}}=\\frac{K}{1+\\frac{s}{\\omega_{0} Q}+\\frac{s^{2}}{\\omega_{0}^{2}}} \\tag{5.44}\n\\end{equation*}\n$$\n\nRecall from the previous chapter that $\\omega_{0}$ is termed the resonant frequency, and the parameter Q is known as the Q factor ${ }^{5}$ [Sedra, 1991]. If $\\mathrm{Q}=\\sqrt{1 / 2} \\cong 0.707$, the magnitude response will exhibit a -3 dB frequency equal to $\\omega_{0}$. Lower Q factors $(\\mathrm{Q}<\\sqrt{1 / 2}$) lead to reduced bandwidth, while higher Q factors $(\\mathrm{Q}>\\sqrt{1 / 2}$) cause peaking in the frequency response. Additionally, note that if $Q \\leq 0.5$, both poles of $A_{C L}(s)$ are real, resulting in no overshoot in the feedback amplifier's step response. When $Q>0.5$, the percentage overshoot of the step response is given by\n\n$$\n\\begin{equation*}\n\\% \\text { overshoot }=100 e^{\\frac{-\\pi}{\\sqrt{4 Q^{2}-1}}} \\tag{5.45}\n\\end{equation*}\n$$\n\nEquating (5.42) with (5.44) and solving for $\\omega_{0}$ and Q yields\n\n$$\n\\begin{equation*}\n\\omega_{0}=\\sqrt[t]{\\left(1+\\mathrm{L}_{0}\\right)\\left(\\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}\\right)} \\cong \\sqrt{\\omega_{i} \\omega_{\\mathrm{eq}}} \\tag{5.46}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{equation*}\nQ=\\frac{\\sqrt{\\left(1+\\mathrm{L}_{0}\\right) / \\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}}}{1 / \\omega_{\\mathrm{p} 1}+1 / \\omega_{\\mathrm{eq}}} \\cong \\sqrt{\\frac{\\mathrm{~L}_{0} \\omega_{\\mathrm{p} 1}}{\\omega_{\\mathrm{eq}}}}=\\sqrt{\\frac{\\beta \\omega_{\\mathrm{ta}}}{\\omega_{\\mathrm{eq}}}} \\tag{5.47}\n\\end{equation*}\n$$\n\nwhere the approximation for Q is valid since $L_{0}>>1$ and $\\omega_{\\mathrm{p} 1}<<\\omega_{\\mathrm{eq}}$.\nIt is now possible to relate a specified phase margin to the Q factor of the resulting closed-loop amplifier. Using (5.41) to find $\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}}$, this result can be substituted into (5.37) to determine $\\beta\\left(\\omega_{\\mathrm{ta}} / \\omega_{\\mathrm{eq}}\\right)$, which can then be used in (5.47) to find the equivalent Q factor. Finally, (5.45) can be applied to determine the corresponding percentage overshoot for a step input. This procedure yields the data in Table 5.1.\n\nTable 5.1 reveals some interesting insights. Firstly, a frequency response with $Q \\cong \\sqrt{1 / 2}$ roughly corresponds to a phase margin of $65^{\\circ}$. Therefore, a common design specification is to aim for a phase margin of at least $65^{\\circ}$ to avoid peaking in the closed-loop amplifier's frequency response, considering both process and temperature variations. To ensure no overshoot for a step input, the phase margin should be at least $75^{\\circ}$, again accounting for process and temperature changes. Hence, a nominal phase margin of $80^{\\circ}$ to $85^{\\circ}$ is often targeted to accommodate these variations.\n5. The Q factor is $1 / 2$ times the inverse of the damping factor. The damping factor is another method of indicating the pole locations in second-order transfer functions.\n\nFinally, it is worth noting that when an amplifier is designed for use with various feedback networks, the worst-case phase margin occurs at the maximum value of $\\beta$, which corresponds to the smallest closed-loop gain. Thus, the amplifier is designed to ensure sufficient phase margin for the maximum $\\beta$. This guarantees that it will have an even greater phase margin for all other $\\beta$ values, although it may be sub-optimally compensated and slower than necessary in these cases."
},
{
    "text": "While first-order feedback amplifiers possess several advantageous traits, practical feedback amplifiers typically feature multiple poles. The primary goal in designing amplifier $A$ is to achieve a high low-frequency gain. However, the maximum gain achievable with a single transistor, defined by its intrinsic gain $A_{i}=g_{m} r_{d s}$, is often inadequate. Consequently, multiple transistors must be combined, resulting in a more intricate circuit with several nodes and, unavoidably, multiple poles.\n\nA general second-order feedback loop transfer function is given by,\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s})=\\frac{\\mathrm{L}_{0}}{\\left(1+\\mathrm{s} / \\omega_{\\mathrm{p} 1}\\right)\\left(1+\\mathrm{s} / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.34}\n\\end{equation*}\n$$\n\nIt is assumed that $\\omega_{\\text {eq }}>\\omega_{\\mathrm{p} 1}$. The Bode plot of (5.34) in Fig. 5.7 clearly indicates unconditional stability, as a phase shift of $-180^{\\circ}$ is never reached. Nevertheless, the phase margin can approach $0^{\\circ}$ depending on $L_{0}, \\omega_{p}$, and $\\omega_{\\text {eq }}$.\n\nAt frequencies significantly higher than the dominant pole frequency, $\\omega \\gg \\omega_{\\mathrm{p} 1}$, it can be observed that $1+j \\omega / \\omega_{\\mathrm{p} 1} \\cong j \\omega / \\omega_{\\mathrm{p} 1}$, allowing (5.34) to be accurately approximated by\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s}) \\cong \\frac{\\omega_{\\mathrm{t}}}{\\mathrm{~s}\\left(1+\\mathrm{s} / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.35}\n\\end{equation*}\n$$\n\nKey Point: All-pole second-order feedback systems are unconditionally stable with a phase margin ranging from 90 to 0 degrees.\n\nThis approximation is particularly valid at the loop's unity-gain frequency $\\omega_{\\mathrm{t}}$ (which is currently of interest) and is almost certainly much greater than $\\omega_{\\mathrm{p} 1}$, provided $\\mathrm{L}_{0}$ » 1.\n\nSince $L(s)=\\beta A(s)$, where $\\beta$ is a scalar constant, the poles are contributed by the forward amplifier, $\\mathrm{A}(\\mathrm{s})$. Using (5.34), we can define $\\mathrm{A}_{0}=\\mathrm{L}_{0} / \\beta$ as the dc gain of $\\mathrm{A}(\\mathrm{s})$ and $\\omega_{\\mathrm{ta}}=\\mathrm{A}_{0} \\omega_{\\mathrm{p} 1}$ as the approximate unity-gain frequency of $\\mathrm{A}(\\mathrm{s})$ under a dominant pole approximation. Thus, at frequencies around $\\omega_{\\mathrm{t}}$, the loop gain, $L(\\mathrm{~s})$, is expressed as\n\n$$\n\\begin{equation*}\nL(s)=\\beta A(s)=\\frac{\\beta \\omega_{\\mathrm{ta}}}{s\\left(1+s / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.36}\n\\end{equation*}\n$$\n\nThe unity-gain frequency, $\\omega_{\\mathrm{t}}$, can be determined by setting the magnitude of (5.36) to unity after substituting $\\mathrm{s}=\\mathrm{j} \\omega_{\\mathrm{t}}$. Upon rearranging the equation, we obtain,\n\n$$\n\\begin{equation*}\n\\beta \\frac{\\omega_{\\mathrm{ta}}}{\\omega_{\\mathrm{eq}}}=\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}} \\sqrt{1+\\left(\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}}\\right)^{2}} \\tag{5.37}\n\\end{equation*}\n$$\n\nFor the special case where the unity-gain frequency is much lower than the equivalent nondominant pole frequency (i.e., $\\omega_{\\mathrm{t}}$ « $\\omega_{\\text {eq }}$ ), (5.37) can be simplified to\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{ta}}=\\frac{\\omega_{\\mathrm{t}}}{\\beta} \\sqrt{1+\\left(\\frac{\\omega_{\\mathrm{t}}}{\\omega_{\\mathrm{eq}}}\\right)^{2}} \\cong \\frac{\\omega_{\\mathrm{t}}}{\\beta} \\tag{5.38}\n\\end{equation*}\n$$\n\nFrom (5.36), the phase shift, $\\angle \\mathrm{L}(\\omega)$, is derived as\n\n$$\n\\begin{equation*}\n\\angle \\mathrm{L}(\\omega)=-90^{\\circ}-\\tan ^{-1}\\left(\\omega / \\omega_{\\mathrm{eq}}\\right) \\tag{5.39}\n\\end{equation*}\n$$\n\nThis equation implies that at the unity-gain frequency, $\\omega=\\omega_{\\mathrm{t}}$, we have\n\n$$\n\\begin{equation*}\n\\mathrm{PM}=\\angle \\mathrm{L}\\left(\\omega_{\\mathrm{t}}\\right)-\\left(-180^{\\circ}\\right)=90^{\\circ}-\\tan ^{-1}\\left(\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}}\\right) \\tag{5.40}\n\\end{equation*}\n$$\n\nand, therefore,\n\nKey Point: The process of designing or modifying a feedback amplifier to achieve a specific phase margin is known as compensation.\n\n$$\n\\begin{align*}\n\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}} & =\\tan \\left(90^{\\circ}-\\mathrm{PM}\\right)  \\tag{5.41}\\\\\n\\Rightarrow \\omega_{\\mathrm{t}} & =\\tan \\left(90^{\\circ}-\\mathrm{PM}\\right) \\omega_{\\mathrm{eq}}\n\\end{align*}\n$$\n\nEquation (5.41) specifies the required $\\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}$ for a given phase margin. Designing or modifying a feedback amplifier to meet the $\\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}$ ratio specified by (5.41) for a target phase margin is termed compensation.\n\n#### EXAMPLE 5.7\n\nFor a closed-loop amplifier with a $75^{\\circ}$ phase margin and $\\beta=1$, what is the required unity-gain frequency $f_{t}$ if $f_{\\text {eq }}=\\omega_{\\text {eq }} /(2 \\pi)=50 \\mathrm{MHz}$? What is the required $f_{\\mathrm{ta}}$?\n\n#### Solution\n\nUsing (5.40), we find $\\omega_{\\mathrm{t}}=0.268 \\omega_{\\text {eq }}$, indicating that the loop-gain unity-gain frequency is $f_{t}=\\omega_{t} / 2 \\pi=13.4 \\mathrm{MHz}$. From (5.38), for $\\beta=1$, we have $\\omega_{\\mathrm{ta}}=\\omega_{\\mathrm{t}} \\sqrt{1+0.268^{2}}=1.035 \\omega_{\\mathrm{t}}$, implying $\\mathrm{f}_{\\mathrm{ta}}=\\omega_{\\mathrm{ta}} / 2 \\pi=13.9 \\mathrm{MHz}$.\n\nThe closed-loop response of a second-order feedback amplifier can be determined by substituting (5.34) into (5.8) and rearranging, yielding\n\n$$\n\\begin{equation*}\n\\mathrm{A}_{\\mathrm{CL}}(\\mathrm{~s})=\\frac{\\mathrm{A}_{\\mathrm{CL} 0}}{1+\\frac{\\mathrm{s}\\left(1 / \\omega_{\\mathrm{p} 1}+1 / \\omega_{\\mathrm{eq}}\\right)}{1+\\mathrm{L}_{0}}+\\frac{\\mathrm{s}^{2}}{\\left(1+\\mathrm{L}_{0}\\right)\\left(\\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}\\right)}} \\tag{5.42}\n\\end{equation*}\n$$\n\nwhere\n\n$$\n\\begin{equation*}\nA_{C L 0} \\equiv \\frac{\\mathrm{~L}_{0} / \\beta}{1+\\mathrm{L}_{0}} \\cong \\frac{1}{\\beta} \\tag{5.43}\n\\end{equation*}\n$$\n\nTable 5.1 The relationship between $\\mathrm{PM}, \\omega_{\\mathrm{t}} / \\omega_{\\text {eq }}, Q$ factor, and percentage overshoot\n\n| PM <br> (Phase margin) | $\\omega_{\\mathbf{t}} / \\omega_{\\text {eq }}$ | Q factor | Percentage <br> overshoot for a <br> step input |\n| :---: | :---: | :---: | :---: |\n| $55^{\\circ}$ | 0.700 | 0.925 | $13.3 \\%$ |\n| $60^{\\circ}$ | 0.580 | 0.817 | $8.7 \\%$ |\n| $65^{\\circ}$ | 0.470 | 0.717 | $4.7 \\%$ |\n| $70^{\\circ}$ | 0.360 | 0.622 | $1.4 \\%$ |\n| $75^{\\circ}$ | 0.270 | 0.527 | $0.008 \\%$ |\n| $80^{\\circ}$ | 0.175 | 0.421 | - |\n| $85^{\\circ}$ | 0.087 | 0.296 | - |\n\nThus, the closed-loop response is also second-order. The general equation for a second-order all-pole transfer function is\n\n$$\n\\begin{equation*}\nH(s)=\\frac{K \\omega_{0}^{2}}{s^{2}+\\left(\\frac{\\omega_{0}}{Q}\\right) s+\\omega_{0}^{2}}=\\frac{K}{1+\\frac{s}{\\omega_{0} Q}+\\frac{s^{2}}{\\omega_{0}^{2}}} \\tag{5.44}\n\\end{equation*}\n$$\n\nRecall from the previous chapter that $\\omega_{0}$ is termed the resonant frequency, and the parameter Q is the Q factor ${ }^{5}$ [Sedra, 1991]. If $\\mathrm{Q}=\\sqrt{1 / 2} \\cong 0.707$, the magnitude response will exhibit a -3 dB frequency equal to $\\omega_{0}$. Lower Q-factors $(\\mathrm{Q}<\\sqrt{1 / 2}$ ) lead to reduced bandwidth, while higher Q-factors $(\\mathrm{Q}>\\sqrt{1 / 2}$ ) cause peaking in the frequency response. Additionally, if $Q \\leq 0.5$, both poles of $A_{C L}(s)$ are real, resulting in no overshoot in the feedback amplifier's step response. When $Q>0.5$, the percentage overshoot of the step response is given by\n\n$$\n\\begin{equation*}\n\\% \\text { overshoot }=100 e^{\\frac{-\\pi}{\\sqrt{4 Q^{2}-1}}} \\tag{5.45}\n\\end{equation*}\n$$\n\nBy equating (5.42) with (5.44) and solving for $\\omega_{0}$ and Q, we obtain\n\n$$\n\\begin{equation*}\n\\omega_{0}=\\sqrt[t]{\\left(1+\\mathrm{L}_{0}\\right)\\left(\\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}\\right)} \\cong \\sqrt{\\omega_{i} \\omega_{\\mathrm{eq}}} \\tag{5.46}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{equation*}\nQ=\\frac{\\sqrt{\\left(1+\\mathrm{L}_{0}\\right) / \\omega_{\\mathrm{p} 1} \\omega_{\\mathrm{eq}}}}{1 / \\omega_{\\mathrm{p} 1}+1 / \\omega_{\\mathrm{eq}}} \\cong \\sqrt{\\frac{\\mathrm{~L}_{0} \\omega_{\\mathrm{p} 1}}{\\omega_{\\mathrm{eq}}}}=\\sqrt{\\frac{\\beta \\omega_{\\mathrm{ta}}}{\\omega_{\\mathrm{eq}}}} \\tag{5.47}\n\\end{equation*}\n$$\n\nwhere the approximation on $Q$ is valid since $L_{0}>>1$ and $\\omega_{\\mathrm{p} 1}<<\\omega_{\\mathrm{eq}}$.\nIt is now possible to relate a specified phase margin to the Q factor of the resulting closed-loop amplifier. Using (5.41) to find $\\omega_{\\mathrm{t}} / \\omega_{\\mathrm{eq}}$, this result can be substituted into (5.37) to determine $\\beta\\left(\\omega_{\\mathrm{ta}} / \\omega_{\\mathrm{eq}}\\right)$, which can then be used in (5.47) to find the equivalent Q factor. Finally, (5.45) can be applied to determine the corresponding percentage overshoot for a step input. This procedure yields the data in Table 5.1.\n\nTable 5.1 highlights some interesting observations. Firstly, a frequency response with $Q \\cong \\sqrt{1 / 2}$ corresponds roughly to a phase margin of $65^{\\circ}$. Consequently, a common design specification is to aim for a phase margin of at least $65^{\\circ}$ to avoid peaking in the closed-loop amplifier's frequency response, considering both process and temperature variations. To ensure no overshoot for a step input, the phase margin should be at least $75^{\\circ}$, again accounting for process and temperature changes. Therefore, a nominal phase margin of $80^{\\circ}$ to $85^{\\circ}$ is often targeted to accommodate these variations.\n5. The Q factor is $1 / 2$ times the inverse of the damping factor. The damping factor is another method of indicating the pole locations in second-order transfer functions.\n\nLastly, it is noteworthy that when an amplifier is designed for use with various feedback networks, the worst-case phase margin occurs at the maximum value of $\\beta$, corresponding to the smallest closed-loop gain. Thus, the amplifier is designed to maintain a sufficient phase margin for the maximum $\\beta$. This ensures that it will have an even greater phase margin for all other $\\beta$ values, although it may be sub-optimally compensated and slower than necessary in these cases."
},
{
    "text": "High-gain amplifiers typically feature more than two poles and possibly some zeros. A general transfer function for such an amplifier is expressed as\n\n$$\n\\begin{equation*}\nA(s)=A_{0} \\frac{\\left(1+\\frac{s}{\\omega_{\\mathrm{z} 1}}\\right)\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{z} 2}}\\right) \\ldots\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{zm}}}\\right)}{\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{p} 1}}\\right)\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{p} 2}}\\right) \\ldots\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{pn}}}\\right)} \\tag{5.48}\n\\end{equation*}\n$$\n\nFeedback systems utilizing these amplifiers are not inherently stable, as they might reach a phase shift exceeding $180^{\\circ}$ at certain frequencies.\n\nAccurately modeling the open-loop transfer function at frequencies up to and around the loop's unity-gain frequency, $\\omega_{\\mathrm{t}}$, is crucial. This can be achieved using the first-order model (5.22) only if the second and higher-order poles and all zeros are situated at frequencies significantly higher than $\\omega_{\\mathrm{t}}$,\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{t}} « \\omega_{\\mathrm{p} 2}, \\ldots, \\omega_{\\mathrm{pn}},\\left|\\omega_{\\mathrm{z} 1}\\right|, \\ldots,\\left|\\omega_{\\mathrm{zm}}\\right| \\tag{5.49}\n\\end{equation*}\n$$\n\nEven when designing an amplifier that meets condition (5.49) is feasible, it often leads to overly conservative designs, resulting in significant over-design and sub-optimal circuit performance. Instead, by considering all poles and zeros, the desired phase margin can be attained with a higher unity-gain frequency, $\\omega_{\\mathrm{t}}$, which, as discussed in Section 5.1.3, enhances the closed-loop bandwidth.\n\nKey Point: Higher-order feedback amplifiers can be modeled using a second-order transfer function, provided they are not nearing instability. The second pole is selected at the frequency where a phase response of -135 degrees is achieved.\n\nWhen all poles and zeros lie on the real axis, they can be effectively modeled using just two poles. Specifically, the model includes the first dominant-pole frequency, $\\omega_{\\mathrm{pl}}$, and a second pole frequency, $\\omega_{\\text {eq }}$, that represents all higher-frequency poles and zeros. For a given set of real-axis poles, $\\omega_{\\mathrm{pi}}$, and zeros, $\\omega_{\\mathrm{zi}}$, a suitable choice for $\\omega_{\\text {eq}}$ is\n\n$$\n\\begin{equation*}\n\\frac{1}{\\omega_{\\text {eq }}} \\cong \\sum_{i=2}^{n} \\frac{1}{\\omega_{p i}}-\\sum_{i=1}^{m} \\frac{1}{\\omega_{z i}} \\tag{5.50}\n\\end{equation*}\n$$\n\nIt is important to note that the approximation in (5.50) differs from that in [Sedra, 1991], as our focus is primarily on the phase shifts caused by higher-frequency poles and zeros, rather than the attenuation. In practice, $\\omega_{\\text {eq }}$ is determined through simulation as the frequency at which the open-loop transfer function, $L(s)$, exhibits a $-135^{\\circ}$ phase shift (comprising a $-90^{\\circ}$ shift due to the dominant pole and an additional $-45^{\\circ}$ shift due to the combined effect of higher-frequency poles and zeros)."
},
{
    "text": "High-gain amplifiers typically encompass more than two poles and may include some zeroes. The general transfer function for such an amplifier is represented as\n\n$$\n\\begin{equation*}\nA(s)=A_{0} \\frac{\\left(1+\\frac{s}{\\omega_{\\mathrm{z} 1}}\\right)\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{z} 2}}\\right) \\ldots\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{zm}}}\\right)}{\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{p} 1}}\\right)\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{p} 2}}\\right) \\ldots\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{pn}}}\\right)} \\tag{5.48}\n\\end{equation*}\n$$\n\nFeedback systems utilizing these amplifiers are not inherently stable, as they may reach a phase shift exceeding $180^{\\circ}$ at certain frequencies.\n\nAccurately modeling the open-loop transfer function at frequencies up to and around the loop's unity-gain frequency, $\\omega_{\\mathrm{t}}$, is crucial. This can be achieved using the first-order model (5.22) only if the second and higher-order poles and all zeros are at significantly higher frequencies than $\\omega_{\\mathrm{t}}$,\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{t}} « \\omega_{\\mathrm{p} 2}, \\ldots, \\omega_{\\mathrm{pn}},\\left|\\omega_{\\mathrm{z} 1}\\right|, \\ldots,\\left|\\omega_{\\mathrm{zm}}\\right| \\tag{5.49}\n\\end{equation*}\n$$\n\nEven when designing an amplifier that meets condition (5.49) is feasible, it often leads to overly conservative designs, resulting in significant over-design and sub-optimal circuit performance. Instead, by considering all poles and zeros, the desired phase margin can be attained with a higher unity-gain frequency, $\\omega_{\\mathrm{t}}$, which, as discussed in Section 5.1.3, enhances the closed-loop bandwidth.\n\nKey Point: Higher-order feedback amplifiers can be modeled using a second-order transfer function, provided they are not nearing instability. The second pole is selected at the frequency where the phase response reaches -135 degrees.\n\nWhen all poles and zeros lie on the real axis, they can be effectively modeled using just two poles. Specifically, the model includes the first dominant-pole frequency, $\\omega_{\\mathrm{pl}}$, and a second pole frequency, $\\omega_{\\text {eq }}$, that represents all higher-frequency poles and zeros. For a given set of real-axis poles, $\\omega_{\\mathrm{pi}}$, and zeros, $\\omega_{\\mathrm{zi}}$, a suitable choice for $\\omega_{\\text {eq}}$ is\n\n$$\n\\begin{equation*}\n\\frac{1}{\\omega_{\\text {eq }}} \\cong \\sum_{i=2}^{n} \\frac{1}{\\omega_{p i}}-\\sum_{i=1}^{m} \\frac{1}{\\omega_{z i}} \\tag{5.50}\n\\end{equation*}\n$$\n\nIt is important to note that the approximation in (5.50) differs from that in [Sedra, 1991], as our focus is primarily on the phase shifts caused by higher-frequency poles and zeros, rather than the attenuation. In practice, $\\omega_{\\text {eq }}$ is determined through simulation as the frequency at which the open-loop transfer function, $L(s)$, exhibits a $-135^{\\circ}$ phase shift ($-90^{\\circ}$ from the dominant pole and an additional $-45^{\\circ}$ from the combined effect of higher-frequency poles and zeros)."
},
{
    "text": "High-gain amplifiers typically feature more than two poles and may include some zeroes. The general transfer function for such an amplifier is expressed as\n\n$$\n\\begin{equation*}\nA(s)=A_{0} \\frac{\\left(1+\\frac{s}{\\omega_{\\mathrm{z} 1}}\\right)\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{z} 2}}\\right) \\ldots\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{zm}}}\\right)}{\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{p} 1}}\\right)\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{p} 2}}\\right) \\ldots\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{pn}}}\\right)} \\tag{5.48}\n\\end{equation*}\n$$\n\nFeedback systems utilizing these amplifiers are not inherently stable, as they can reach a phase shift exceeding $180^{\\circ}$ at certain frequencies.\n\nIt is crucial to precisely model the open-loop transfer function at frequencies up to and surrounding the loop's unity-gain frequency, $\\omega_{\\mathrm{t}}$. This can be achieved using the first-order model (5.22) only if the second and higher-order poles and all zeros are situated at frequencies significantly higher than $\\omega_{\\mathrm{t}}$,\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{t}} « \\omega_{\\mathrm{p} 2}, \\ldots, \\omega_{\\mathrm{pn}},\\left|\\omega_{\\mathrm{z} 1}\\right|, \\ldots,\\left|\\omega_{\\mathrm{zm}}\\right| \\tag{5.49}\n\\end{equation*}\n$$\n\nEven when designing an amplifier that meets condition (5.49) is feasible, it often leads to overly conservative designs, resulting in substantial over-design and a less-than-optimal circuit. By considering all poles and zeros, the desired phase margin can be attained with a higher unity-gain frequency, $\\omega_{\\mathrm{t}}$, which, as discussed in Section 5.1.3, enhances the closed-loop bandwidth.\n\nKey Point: Higher-order feedback amplifiers can be modeled using a second-order transfer function, provided they are not nearing instability. The second pole is selected at the frequency where the phase response reaches -135 degrees.\n\nWhen all poles and zeros lie on the real axis, they can be effectively modeled using just two poles. Specifically, the model includes the first dominant-pole frequency, $\\omega_{\\mathrm{pl}}$, and a second pole frequency, $\\omega_{\\text {eq }}$, which represents all higher-frequency poles and zeros. For a given set of real-axis poles, $\\omega_{\\mathrm{pi}}$, and zeros, $\\omega_{\\mathrm{zi}}$, a suitable choice for $\\omega_{\\text {eq}}$ is\n\n$$\n\\begin{equation*}\n\\frac{1}{\\omega_{\\text {eq }}} \\cong \\sum_{i=2}^{n} \\frac{1}{\\omega_{p i}}-\\sum_{i=1}^{m} \\frac{1}{\\omega_{z i}} \\tag{5.50}\n\\end{equation*}\n$$\n\nIt is important to note that the approximation in (5.50) differs from that in [Sedra, 1991], as our focus is primarily on the phase shifts caused by higher-frequency poles and zeros, rather than the attenuation. In practice, $\\omega_{\\text {eq }}$ is determined through simulation as the frequency at which the open-loop transfer function, $L(s)$, exhibits a $-135^{\\circ}$ phase shift (comprising a $-90^{\\circ}$ shift due to the dominant pole and an additional $-45^{\\circ}$ shift from the combined effect of higher-frequency poles and zeros)."
},
{
    "text": "High-gain amplifiers typically incorporate more than two poles and possibly some zeroes. A general transfer function for such an amplifier is expressed as\n\n$$\n\\begin{equation*}\nA(s)=A_{0} \\frac{\\left(1+\\frac{s}{\\omega_{\\mathrm{z} 1}}\\right)\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{z} 2}}\\right) \\ldots\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{zm}}}\\right)}{\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{p} 1}}\\right)\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{p} 2}}\\right) \\ldots\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{pn}}}\\right)} \\tag{5.48}\n\\end{equation*}\n$$\n\nFeedback systems utilizing these amplifiers are not inherently stable, as they may experience a phase shift exceeding $180^{\\circ}$ at certain frequencies.\n\nIt is crucial to accurately model the open-loop transfer function at frequencies up to and around the loop's unity-gain frequency, $\\omega_{\\mathrm{t}}$. This can be achieved using the first-order model (5.22) only if the second and higher-order poles and all zeros are at frequencies significantly higher than $\\omega_{\\mathrm{t}}$,\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{t}} « \\omega_{\\mathrm{p} 2}, \\ldots, \\omega_{\\mathrm{pn}},\\left|\\omega_{\\mathrm{z} 1}\\right|, \\ldots,\\left|\\omega_{\\mathrm{zm}}\\right| \\tag{5.49}\n\\end{equation*}\n$$\n\nEven when designing an amplifier that meets condition (5.49) is feasible, it often leads to overly conservative designs, resulting in significant over-design and a less than optimal circuit. Instead, by considering all poles and zeros, the desired phase margin can be achieved with a higher unity-gain frequency, $\\omega_{\\mathrm{t}}$, which, as discussed in Section 5.1.3, enhances the closed-loop bandwidth.\n\nKey Point: Higher-order feedback amplifiers can be modeled using a second-order transfer function provided they are not nearing instability. The second pole is selected at the frequency where the phase response reaches -135 degrees.\n\nWhen all poles and zeros lie on the real axis, they can be effectively modeled using just two poles. Specifically, the model includes the first dominant-pole frequency, $\\omega_{\\mathrm{pl}}$, and a second pole frequency, $\\omega_{\\text {eq }}$, which represents all higher-frequency poles and zeros. For a given set of real-axis poles, $\\omega_{\\mathrm{pi}}$, and zeros, $\\omega_{\\mathrm{zi}}$, a suitable choice for $\\omega_{\\text {eq}}$ is\n\n$$\n\\begin{equation*}\n\\frac{1}{\\omega_{\\text {eq }}} \\cong \\sum_{i=2}^{n} \\frac{1}{\\omega_{p i}}-\\sum_{i=1}^{m} \\frac{1}{\\omega_{z i}} \\tag{5.50}\n\\end{equation*}\n$$\n\nIt is important to note that the approximation in (5.50) differs from that in [Sedra, 1991], as our focus is primarily on the phase shifts caused by higher-frequency poles and zeros, rather than the attenuation. In practice, $\\omega_{\\text {eq }}$ is determined through simulation as the frequency at which the open-loop transfer function, $L(s)$, exhibits a $-135^{\\circ}$ phase shift (comprising $-90^{\\circ}$ from the dominant pole and an additional $-45^{\\circ}$ from the combined effect of higher-frequency poles and zeros)."
},
{
    "text": "High-gain amplifiers typically feature more than two poles and may also include some zeroes. The general transfer function for such an amplifier is expressed as\n\n$$\n\\begin{equation*}\nA(s)=A_{0} \\frac{\\left(1+\\frac{s}{\\omega_{\\mathrm{z} 1}}\\right)\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{z} 2}}\\right) \\ldots\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{zm}}}\\right)}{\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{p} 1}}\\right)\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{p} 2}}\\right) \\ldots\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{pn}}}\\right)} \\tag{5.48}\n\\end{equation*}\n$$\n\nFeedback systems utilizing these amplifiers are not inherently stable, as they may reach a phase shift exceeding $180^{\\circ}$ at certain frequencies.\n\nAccurately modeling the open-loop transfer function at frequencies up to and around the loop's unity-gain frequency, $\\omega_{\\mathrm{t}}$, is crucial. This can be achieved using the first-order model (5.22) only if the second and higher-order poles and all zeros are situated at frequencies significantly higher than $\\omega_{\\mathrm{t}}$,\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{t}} « \\omega_{\\mathrm{p} 2}, \\ldots, \\omega_{\\mathrm{pn}},\\left|\\omega_{\\mathrm{z} 1}\\right|, \\ldots,\\left|\\omega_{\\mathrm{zm}}\\right| \\tag{5.49}\n\\end{equation*}\n$$\n\nEven when it is feasible to design an amplifier that meets condition (5.49), such a design often proves excessively conservative, leading to substantial over-design and a less-than-optimal circuit. Instead, by considering all poles and zeros, the desired phase margin can be attained with a higher unity-gain frequency, $\\omega_{\\mathrm{t}}$, which, as discussed in Section 5.1.3, results in an increased closed-loop bandwidth.\n\nKey Point: Higher-order feedback amplifiers can be modeled using a second-order transfer function provided they are not nearing instability. The second pole is selected at the frequency where a phase response of -135 degrees is achieved.\n\nWhen all poles and zeros lie on the real axis, they can be effectively modeled using just two poles. Specifically, the model includes the first dominant-pole frequency, $\\omega_{\\mathrm{pl}}$, and a second pole frequency, $\\omega_{\\text {eq }}$, which represents all higher-frequency poles and zeros. For a given set of real-axis poles, $\\omega_{\\mathrm{pi}}$, and zeros, $\\omega_{\\mathrm{zi}}$, a suitable value for $\\omega_{\\text {eq}}$ is\n\n$$\n\\begin{equation*}\n\\frac{1}{\\omega_{\\text {eq }}} \\cong \\sum_{i=2}^{n} \\frac{1}{\\omega_{p i}}-\\sum_{i=1}^{m} \\frac{1}{\\omega_{z i}} \\tag{5.50}\n\\end{equation*}\n$$\n\nIt is important to note that the approximation in (5.50) differs from that in [Sedra, 1991], as our focus is primarily on the phase shifts caused by higher-frequency poles and zeros, rather than the attenuation. In practice, $\\omega_{\\text {eq }}$ is determined through simulation as the frequency at which the open-loop transfer function, $L(s)$, exhibits a $-135^{\\circ}$ phase shift (comprising a $-90^{\\circ}$ shift due to the dominant pole and an additional $-45^{\\circ}$ shift due to the combined effect of higher-frequency poles and zeros)."
},
{
    "text": "High-gain amplifiers typically feature more than two poles and may include some zeroes. The general transfer function for such an amplifier is expressed as\n\n$$\n\\begin{equation*}\nA(s)=A_{0} \\frac{\\left(1+\\frac{s}{\\omega_{\\mathrm{z} 1}}\\right)\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{z} 2}}\\right) \\ldots\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{zm}}}\\right)}{\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{p} 1}}\\right)\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{p} 2}}\\right) \\ldots\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{pn}}}\\right)} \\tag{5.48}\n\\end{equation*}\n$$\n\nFeedback systems utilizing these amplifiers are not inherently stable, as they can reach a phase shift exceeding $180^{\\circ}$ at certain frequencies.\n\nAccurately modeling the open-loop transfer function at frequencies up to and around the loop's unity-gain frequency, $\\omega_{\\mathrm{t}}$, is crucial. This can be achieved using the first-order model (5.22) only if the second and higher-order poles and all zeros are at frequencies significantly higher than $\\omega_{\\mathrm{t}}$,\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{t}} « \\omega_{\\mathrm{p} 2}, \\ldots, \\omega_{\\mathrm{pn}},\\left|\\omega_{\\mathrm{z} 1}\\right|, \\ldots,\\left|\\omega_{\\mathrm{zm}}\\right| \\tag{5.49}\n\\end{equation*}\n$$\n\nEven when designing an amplifier that meets condition (5.49) is feasible, it often leads to overly conservative designs, resulting in substantial over-design and a less-than-optimal circuit. By considering all poles and zeros, the desired phase margin can be attained with a higher unity-gain frequency, $\\omega_{\\mathrm{t}}$, which, as discussed in Section 5.1.3, enhances the closed-loop bandwidth.\n\nKey Point: Higher-order feedback amplifiers can be modeled using a second-order transfer function, provided they are not nearing instability. The second pole is selected at the frequency where the phase response reaches -135 degrees.\n\nWhen all poles and zeros lie on the real axis, they can be effectively modeled using just two poles. Specifically, the model includes the first dominant-pole frequency, $\\omega_{\\mathrm{pl}}$, and a second pole frequency, $\\omega_{\\text {eq }}$, that represents all higher-frequency poles and zeros. For a given set of real-axis poles, $\\omega_{\\mathrm{pi}}$, and zeros, $\\omega_{\\mathrm{zi}}$, a suitable choice for $\\omega_{\\text {eq}}$ is\n\n$$\n\\begin{equation*}\n\\frac{1}{\\omega_{\\text {eq }}} \\cong \\sum_{i=2}^{n} \\frac{1}{\\omega_{p i}}-\\sum_{i=1}^{m} \\frac{1}{\\omega_{z i}} \\tag{5.50}\n\\end{equation*}\n$$\n\nIt is important to note that the approximation in (5.50) differs from that in [Sedra, 1991], as our focus is primarily on phase shifts caused by higher-frequency poles and zeros, rather than attenuation. In practice, $\\omega_{\\text {eq }}$ is determined through simulation as the frequency at which the open-loop transfer function, $L(s)$, exhibits a $-135^{\\circ}$ phase shift (comprising a $-90^{\\circ}$ shift due to the dominant pole and an additional $-45^{\\circ}$ from the combined effect of higher-frequency poles and zeros)."
},
{
    "text": "High-gain amplifiers typically feature more than two poles and may include some zeroes. A general transfer function for such an amplifier is expressed as\n\n$$\n\\begin{equation*}\nA(s)=A_{0} \\frac{\\left(1+\\frac{s}{\\omega_{\\mathrm{z} 1}}\\right)\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{z} 2}}\\right) \\ldots\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{zm}}}\\right)}{\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{p} 1}}\\right)\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{p} 2}}\\right) \\ldots\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{pn}}}\\right)} \\tag{5.48}\n\\end{equation*}\n$$\n\nFeedback systems utilizing these amplifiers are not inherently stable, as they can reach a phase shift exceeding $180^{\\circ}$ at certain frequencies.\n\nAccurately modeling the open-loop transfer function at frequencies up to and around the loop's unity-gain frequency, $\\omega_{\\mathrm{t}}$, is crucial. This can be achieved using the first-order model (5.22) only if the second and higher-order poles and all zeros are at frequencies significantly higher than $\\omega_{\\mathrm{t}}$,\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{t}} « \\omega_{\\mathrm{p} 2}, \\ldots, \\omega_{\\mathrm{pn}},\\left|\\omega_{\\mathrm{z} 1}\\right|, \\ldots,\\left|\\omega_{\\mathrm{zm}}\\right| \\tag{5.49}\n\\end{equation*}\n$$\n\nEven when designing an amplifier that meets condition (5.49) is feasible, it often leads to overly conservative designs, resulting in significant over-design and sub-optimal circuit performance. Instead, by considering all poles and zeros, the desired phase margin can be achieved with a higher unity-gain frequency, $\\omega_{\\mathrm{t}}$, which, as discussed in Section 5.1.3, enhances the closed-loop bandwidth.\n\nKey Point: Higher-order feedback amplifiers can be modeled using a second-order transfer function provided they are not nearing instability. The second pole is selected at the frequency where a phase response of -135 degrees is achieved.\n\nWhen all poles and zeros lie on the real axis, they can be effectively modeled using just two poles. Specifically, the model includes the first dominant-pole frequency, $\\omega_{\\mathrm{pl}}$, and a second pole frequency, $\\omega_{\\text {eq }}$, that accounts for all higher-frequency poles and zeros. For a given set of real-axis poles, $\\omega_{\\mathrm{pi}}$, and zeros, $\\omega_{\\mathrm{zi}}$, a suitable choice for $\\omega_{\\text {eq}}$ is\n\n$$\n\\begin{equation*}\n\\frac{1}{\\omega_{\\text {eq }}} \\cong \\sum_{i=2}^{n} \\frac{1}{\\omega_{p i}}-\\sum_{i=1}^{m} \\frac{1}{\\omega_{z i}} \\tag{5.50}\n\\end{equation*}\n$$\n\nIt is important to note that the approximation in (5.50) differs from that in [Sedra, 1991], as our focus is primarily on the phase shifts caused by higher-frequency poles and zeros, rather than the attenuation. In practice, $\\omega_{\\text {eq }}$ is determined through simulation as the frequency at which the open-loop transfer function, $L(s)$, exhibits a $-135^{\\circ}$ phase shift (comprising $-90^{\\circ}$ due to the dominant pole and an additional $-45^{\\circ}$ from the combined effect of higher-frequency poles and zeros)."
},
{
    "text": "High-gain amplifiers typically feature more than two poles and may include some zeroes. The general transfer function for such an amplifier is expressed as\n\n$$\n\\begin{equation*}\nA(s)=A_{0} \\frac{\\left(1+\\frac{s}{\\omega_{\\mathrm{z} 1}}\\right)\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{z} 2}}\\right) \\ldots\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{zm}}}\\right)}{\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{p} 1}}\\right)\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{p} 2}}\\right) \\ldots\\left(1+\\frac{\\mathrm{s}}{\\omega_{\\mathrm{pn}}}\\right)} \\tag{5.48}\n\\end{equation*}\n$$\n\nFeedback systems utilizing these amplifiers are not inherently stable, as they may experience a phase shift exceeding $180^{\\circ}$ at certain frequencies.\n\nAccurately modeling the open-loop transfer function at frequencies up to and around the loop's unity-gain frequency, $\\omega_{\\mathrm{t}}$, is crucial. This can be achieved using the first-order model (5.22) only if the second and higher-order poles and all zeros are situated at frequencies significantly higher than $\\omega_{\\mathrm{t}}$,\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{t}} « \\omega_{\\mathrm{p} 2}, \\ldots, \\omega_{\\mathrm{pn}},\\left|\\omega_{\\mathrm{z} 1}\\right|, \\ldots,\\left|\\omega_{\\mathrm{zm}}\\right| \\tag{5.49}\n\\end{equation*}\n$$\n\nEven when designing an amplifier that meets condition (5.49) is feasible, it often leads to overly conservative designs, resulting in significant over-design and a less-than-optimal circuit. By considering all poles and zeros, the desired phase margin can be attained with a higher unity-gain frequency, $\\omega_{\\mathrm{t}}$, which, as discussed in Section 5.1.3, enhances the closed-loop bandwidth.\n\nKey Point: Higher-order feedback amplifiers can be modeled using a second-order transfer function provided they are not approaching instability. The second pole is selected at the frequency where a phase response of -135 degrees is achieved.\n\nWhen all poles and zeros lie on the real axis, they can be effectively modeled using just two poles. Specifically, the model includes the first dominant-pole frequency, $\\omega_{\\mathrm{pl}}$, and a second pole frequency, $\\omega_{\\text {eq }}$, which represents all higher-frequency poles and zeros. For a given set of real-axis poles, $\\omega_{\\mathrm{pi}}$, and zeros, $\\omega_{\\mathrm{zi}}$, a suitable choice for $\\omega_{\\text {eq}}$ is\n\n$$\n\\begin{equation*}\n\\frac{1}{\\omega_{\\text {eq }}} \\cong \\sum_{i=2}^{n} \\frac{1}{\\omega_{p i}}-\\sum_{i=1}^{m} \\frac{1}{\\omega_{z i}} \\tag{5.50}\n\\end{equation*}\n$$\n\nIt is important to note that the approximation in (5.50) differs from that in [Sedra, 1991], as our focus is primarily on phase shifts caused by higher-frequency poles and zeros, rather than attenuation. In practice, $\\omega_{\\text {eq }}$ is determined through simulation as the frequency at which the open-loop transfer function, $L(s)$, exhibits a $-135^{\\circ}$ phase shift (comprising $-90^{\\circ}$ from the dominant pole and an additional $-45^{\\circ}$ from the combined effect of higher-frequency poles and zeros)."
},
{
    "text": "We will now apply our general analysis of feedback systems to small-signal circuits. To achieve this, we must model the circuit of interest according to Fig. 5.1. However, this process can be challenging. There may be uncertainties in determining whether the inputs and/or outputs of a specific circuit are voltages or currents. Additionally, distinguishing between the forward amplifier, $A$, and the feedback network, $\\beta$, can be difficult, as some components participate in both aspects simultaneously.\n\nSpecifically, identifying $A$ is problematic. For instance, consider the inverting amplifier setup in Fig. 5.10, where the opamp has a finite output impedance, $Z_{0}$. It might seem that $A$ is simply the voltage gain of the opamp, but this is incorrect. Equation (5.5) and Fig. 5.1 indicate that when $A=0$, the closed-loop amplifier output should be zero. Nonetheless, even if the opamp's gain were zero, a finite voltage would still appear at $v_{\\text{out}}$ due to the division of the source voltage, $v_{s}$, by the impedances in the feedback network ($Z_{1}$ and $Z_{2}$) and at the output node ($Z_{0}$ and $Z_{L}$). In reality, an accurate analysis for $A$ is quite intricate, even in this common example, as it depends on the opamp, the feedback components $Z_{1}$ and $Z_{2}$, and the load, $Z_{L}$. Computer simulations offer limited assistance since it's not clear which circuit configuration needs to be simulated to determine $A$, the forward gain without feedback.\n\nConversely, determining $\\beta$ is usually more straightforward if one recalls that the circuit's desired gain is simply $1/\\beta$. For example, the expected gain from the inverting opamp configuration mentioned is well-known to be $-\\left(Z_{2}/Z_{1}\\right)$. Thus, we can assume that $\\beta=-\\left(Z_{1}/Z_{2}\\right)$. Generally, $\\beta$ is the inverse of the closed-loop gain expected under ideal conditions of very high loop gain. In opamp circuits, this gain is derived by analyzing the circuit assuming infinite opamp gain. While this choice of $\\beta$ may not pinpoint the gain between any specific voltages or currents in the circuit, it aligns with our goal of modeling the circuit within the ideal feedback framework. More importantly, it enables us to determine key feedback circuit properties such as gain error, bandwidth, phase margin, and settling time.\n\nAlthough defining $A$ may involve some ambiguity, the loop gain $L$ is unique. This is reassuring because the loop's stability depends solely on $L(s)$, and a feedback circuit will be either stable or unstable, irrespective of the analysis method.\n\nIf $L$ is known and $\\beta$ is defined as the reciprocal of the desired closed-loop gain, we can infer $A$ from $A=L/\\beta$ without conducting a rigorous analysis. Therefore, our feedback circuit analysis will rely on knowledge of $\\beta$, obtained either by design or by examining a relatively simple circuit, and on $L$, which can be estimated using a systematic procedure outlined in Section 5.4.1.\n\nGeneralizing the expression for closed-loop gain in (5.8), the closed-loop frequency response of a feedback circuit can be formulated without referencing $A(s)$.\n\n$$\n\\begin{equation*}\nA_{CL}(s)=\\frac{1}{\\beta} \\cdot \\frac{L(s)}{1+L(s)} \\tag{5.51}\n\\end{equation*}\n$$\n\nIn (5.51), the term $L(s)/(1+L(s))$ represents the closed-loop amplifier gain normalized to the desired gain, $1/\\beta$. Many circuit attributes of interest can be understood in terms of this normalized frequency response, which depends solely on $L(s)$. For example, the bandwidth, poles, and zeros of the closed-loop amplifier correspond to those of $L(s)/(1+L(s))$. The gain error at dc, defined as the fractional error between the desired gain, $1/\\beta$, and the actual gain, $A_{CL0}=A_{CL}(0)$, is simply\n\n$$\n\\begin{equation*}\n\\text{Gain error}=1-\\frac{A_{CL0}}{1/\\beta}=1-\\frac{L_{0}}{1+L_{0}} \\tag{5.52}\n\\end{equation*}\n$$\n\nKey Point: Feedback systems can be analyzed based on their desired gain, $\\beta$, and loop gain, $L(\\omega)$, from which the closed-loop amplifier's gain, bandwidth, phase margin, and frequency response can all be deduced. This will be nearly zero as long as the loop gain at dc, $L_{0}=L(0)$, is substantial.\n\n**Image Description:**\nFig. 5.10 illustrates an inverting opamp configuration. The circuit includes:\n- A voltage source, $V_s$, connected between $V_s$ and ground.\n- A resistor, $Z_1$, linking $V_s$ to the inverting input of the opamp, $A_1$.\n- A resistor, $Z_2$, connecting the inverting input of $A_1$ to the output, $V_{out}$.\n- An opamp, $A_1$, with its non-inverting input grounded, inverting input connected to $Z_1$ and $Z_2$, and output at $V_{out}$.\n- A load resistor, $Z_L$, attached from $V_{out}$ to ground.\n\nThe circuit is an inverting op-amp configuration with feedback resistors $Z_1$ and $Z_2$ setting the gain, and the load resistor $Z_L$ connected at the output $V_{out}$."
},
{
    "text": "We will now apply our general analysis of feedback systems to small-signal circuits. To achieve this, we must fit the circuit of interest into the model depicted in Fig. 5.1. However, this process can be more challenging than it appears. There may be uncertainty in determining whether the inputs and/or outputs of a specific circuit are voltages or currents. Additionally, distinguishing between the forward amplifier, $A$, and the feedback network, $\\beta$, can be difficult, as some components participate in both aspects of the circuit.\n\nParticularly, identifying $A$ is tricky. For instance, consider the inverting amplifier setup in Fig. 5.10, where the opamp has a finite output impedance, $Z_{0}$. It might seem straightforward to assume that $A$ is simply the voltage gain of the opamp, but this is incorrect. According to Equation (5.5) and Fig. 5.1, when $A=0$, the closed-loop amplifier output should be zero. Nonetheless, even if the opamp's gain were zero, a finite voltage would still appear at $v_{\\text{out}}$ due to the voltage division of $v_{s}$ by the impedances in the feedback network ($Z_{1}$ and $Z_{2}$) and at the output node ($Z_{0}$ and $Z_{L}$). In reality, an accurate analysis for $A$ is quite intricate, even in this common example, as it depends not only on the opamp but also on the feedback components $Z_{1}$ and $Z_{2}$, and the load $Z_{L}$. Computer simulations offer limited assistance since it's not clear which specific circuit needs to be simulated to determine $A$, the forward gain without feedback.\n\nConversely, determining $\\beta$ is usually more straightforward if one recalls that the circuit's intended gain is simply $1/\\beta$. For example, the expected gain from the inverting opamp configuration mentioned is well-known to be $-\\left(Z_{2}/Z_{1}\\right)$. Thus, we can assume that $\\beta=-\\left(Z_{1}/Z_{2}\\right)$. Generally, $\\beta$ is the inverse of the closed-loop gain anticipated under ideal conditions of very high loop gain. In opamp circuits, this gain results from analyzing the circuit assuming infinite opamp gain. While this choice of $\\beta$ may not pinpoint the gain between any specific voltages or currents in the circuit, it aligns with our goal of fitting the circuit into the ideal feedback model. More importantly, it enables us to determine key feedback circuit properties such as gain error, bandwidth, phase margin, and settling time.\n\nAlthough defining $A$ may present some ambiguity, the loop gain $L$ is unique. This is reassuring because the stability of the loop depends solely on $L(s)$, and physically, a feedback circuit will either be stable or unstable, regardless of the analysis method.\n\nIf $L$ is known and $\\beta$ is defined as the reciprocal of the desired closed-loop gain, we can infer $A$ from $A=L/\\beta$ without performing a rigorous analysis. Therefore, our feedback circuit analysis will rely on knowledge of $\\beta$, obtained either by design or by examining a relatively simple circuit, and on $L$, which can be estimated using a systematic procedure detailed in Section 5.4.1.\n\nGeneralizing the expression for closed-loop gain in (5.8), the closed-loop frequency response of a feedback circuit can be formulated without referencing $A(s)$.\n\n$$\n\\begin{equation*}\nA_{CL}(s)=\\frac{1}{\\beta} \\cdot \\frac{L(s)}{1+L(s)} \\tag{5.51}\n\\end{equation*}\n$$\n\nIn (5.51), the term $L(s)/(1+L(s))$ represents the closed-loop amplifier gain normalized to the desired gain, $1/\\beta$. Many circuit attributes of interest can be understood in terms of this normalized frequency response, which depends solely on $L(s)$. For example, the bandwidth, poles, and zeros of the closed-loop amplifier correspond to those of $L(s)/(1+L(s))$. The gain error at dc, defined as the fractional error between the desired gain, $1/\\beta$, and the actual gain, $A_{CL0}=A_{CL}(0)$, is simply\n\n$$\n\\begin{equation*}\n\\text{Gain error}=1-\\frac{A_{CL0}}{1/\\beta}=1-\\frac{L_{0}}{1+L_{0}} \\tag{5.52}\n\\end{equation*}\n$$\n\nKey Point: Feedback systems can be analyzed based on their desired gain, $\\beta$, and loop gain, $L(\\omega)$, from which the closed-loop amplifier's gain, bandwidth, phase margin, and frequency response can all be deduced. This will be nearly zero as long as the loop gain at dc, $L_{0}=L(0)$, is large.\n\nImage Description:\n[name: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}]\n[name: Z1, type: Resistor, value: Z1, ports: {N1: Vs, N2: InN(A1)}]\n[name: Z2, type: Resistor, value: Z2, ports: {N1: InN(A1), N2: Vout}]\n[name: A1, type: OpAmp, value: A1, ports: {InP: GND, InN: InN(A1), OutP: Vout, OutN: GND}]\n[name: ZL, type: Resistor, value: ZL, ports: {N1: Vout, N2: GND}]\nExtra Info: The circuit is an inverting op-amp configuration with feedback resistors Z1 and Z2 setting the gain. The load resistor ZL is connected at the output Vout.\n\nFig. 5.10 An inverting opamp configuration."
},
{
    "text": "We will now apply our general analysis of feedback systems to small-signal circuits. To achieve this, we must fit the circuit of interest into the model depicted in Fig. 5.1. However, this process can be more challenging than it appears. There may be uncertainty in determining whether the inputs and/or outputs of a specific circuit are voltages or currents. Additionally, distinguishing between the forward amplifier, $A$, and the feedback network, $\\beta$, can be difficult, as some components are involved in both.\n\nParticularly, identifying $A$ is problematic. For instance, consider the inverting amplifier setup in Fig. 5.10, where the opamp has a finite output impedance, $Z_{0}$. It might seem that $A$ is simply the voltage gain of the opamp, but this is incorrect. According to Equation (5.5) and Fig. 5.1, when $A=0$, the closed-loop amplifier output should be zero. Nevertheless, even if the opamp's gain were zero, a finite voltage would still appear at $v_{\\text{out}}$ due to the division of the source voltage, $v_{s}$, by the impedances in the feedback network ($Z_{1}$ and $Z_{2}$) and at the output node ($Z_{0}$ and $Z_{L}$). In reality, an accurate analysis for $A$ is quite intricate, even in this common example. It depends not only on the opamp but also on the feedback components $Z_{1}$ and $Z_{2}$, and the load, $Z_{L}$. Computer simulations offer limited assistance since it's unclear which circuit configuration needs to be simulated to determine $A$, the forward gain without feedback.\n\nConversely, determining $\\beta$ is usually straightforward if one recalls that the circuit's desired gain is simply $1/\\beta$. For example, the expected gain from the inverting opamp configuration mentioned earlier is well-known to be $-\\left(Z_{2}/Z_{1}\\right)$. Thus, we can assume that $\\beta=-\\left(Z_{1}/Z_{2}\\right)$. Generally, $\\beta$ is the inverse of the closed-loop gain expected under ideal conditions of very high loop gain. In opamp circuits, this gain is derived by analyzing the circuit assuming infinite opamp gain. While this choice of $\\beta$ may not pinpoint the gain between any specific voltages or currents in the circuit, it aligns with our goal of fitting the circuit into the ideal feedback model. More importantly, it enables us to determine key feedback circuit properties such as gain error, bandwidth, phase margin, and settling time.\n\nAlthough defining $A$ might involve some ambiguity, the loop gain $L$ is unique. This is reassuring because the stability of the loop depends solely on $L(s)$, and physically, a feedback circuit will either be stable or unstable, regardless of the analysis method.\n\nIf $L$ is known and $\\beta$ is defined as the reciprocal of the desired closed-loop gain, we can infer $A$ from $A=L/\\beta$ without conducting a rigorous analysis. Therefore, our analysis of feedback circuits will rely on knowledge of $\\beta$, obtained either by design or by inspecting a relatively simple circuit, and on $L$, which can be estimated using a systematic procedure detailed in Section 5.4.1.\n\nGeneralizing the expression for closed-loop gain in (5.8), the closed-loop frequency response of a feedback circuit can be formulated without referencing $A(s)$.\n\n$$\n\\begin{equation*}\nA_{CL}(s)=\\frac{1}{\\beta} \\cdot \\frac{L(s)}{1+L(s)} \\tag{5.51}\n\\end{equation*}\n$$\n\nIn (5.51), the term $L(s)/(1+L(s))$ represents the closed-loop amplifier gain normalized to the desired gain, $1/\\beta$. Many circuit attributes of interest can be understood in terms of this normalized frequency response, which depends solely on $L(s)$. For example, the bandwidth, poles, and zeros of the closed-loop amplifier correspond to those of $L(s)/(1+L(s))$. The gain error at dc, defined as the fractional error between the desired gain, $1/\\beta$, and the actual gain, $A_{CL0}=A_{CL}(0)$, is simply\n\n$$\n\\begin{equation*}\n\\text{Gain error} = 1 - \\frac{A_{CL0}}{1/\\beta} = 1 - \\frac{L_0}{1+L_0} \\tag{5.52}\n\\end{equation*}\n$$\n\nKey Point: Feedback systems can be analyzed based on their desired gain, $\\beta$, and loop gain, $L(\\omega)$, from which the closed-loop amplifier's gain, bandwidth, phase margin, and frequency response can all be deduced. This will be very close to zero as long as the loop gain at dc, $L_0=L(0)$, is large.\n\nImage Description: Fig. 5.10 illustrates an inverting opamp configuration. The circuit includes a voltage source $V_s$, resistors $Z_1$ and $Z_2$ setting the gain, and a load resistor $Z_L$ connected at the output $V_{\\text{out}}$. The opamp $A_1$ has its inverting input connected to $Z_1$ and $Z_2$, and its output to $V_{\\text{out}}$. The non-inverting input is grounded."
},
{
    "text": "We will now apply our general analysis of feedback systems to small-signal circuits. To do this, we must fit the circuit of interest into the model shown in Fig. 5.1. However, this process can be challenging. There may be uncertainty in determining whether the inputs and/or outputs of a specific circuit are voltages or currents. Additionally, distinguishing between the forward amplifier, $A$, and the feedback network, $\\beta$, is often difficult. Some circuit components are involved in both the forward amplifier and the feedback network simultaneously.\n\nSpecifically, identifying $A$ is problematic. For instance, consider the inverting amplifier setup in Fig. 5.10, where the opamp has a finite output impedance, $Z_{0}$. It might seem that $A$ is simply the voltage gain of the opamp, but this is incorrect. Equation (5.5) and Fig. 5.1 indicate that when $A=0$, the closed-loop amplifier output should be zero. Nevertheless, even if the opamp's gain were zero, a finite voltage would still appear at $v_{\\text{out}}$ due to the division of the source voltage, $v_{s}$, by the impedances in the feedback network ($Z_{1}$ and $Z_{2}$) and at the output node ($Z_{0}$ and $Z_{L}$). In reality, an accurate analysis for $A$ is quite complex, even in this common example. It depends not only on the opamp but also on the feedback components $Z_{1}$ and $Z_{2}$, and the load, $Z_{L}$. Computer simulation offers limited assistance since it is not clear which circuit needs to be simulated to determine $A$, the forward gain without feedback.\n\nConversely, the value of $\\beta$ is usually straightforward if one recalls that the circuit's desired gain is simply $1/\\beta$. For example, the expected gain from the inverting opamp configuration mentioned is well-known to be $-\\left(Z_{2}/Z_{1}\\right)$. Thus, we can assume that $\\beta=-\\left(Z_{1}/Z_{2}\\right)$. Generally, $\\beta$ is the inverse of the closed-loop gain expected under ideal conditions of very high loop gain. In opamp circuits, this gain results from analyzing the circuit assuming infinite opamp gain. While this choice of $\\beta$ may not pinpoint the gain between any specific voltages and/or currents in the circuit, it aligns with our goal of fitting the circuit into the ideal feedback model. More importantly, it allows us to determine key feedback circuit properties such as gain error, bandwidth, phase margin, and settling time.\n\nAlthough defining $A$ may have some ambiguity, the loop gain $L$ is unique. This is reassuring because the stability of the loop depends solely on $L(s)$, and physically, a feedback circuit will be either stable or unstable, regardless of the analysis method.\n\nIf $L$ is known and $\\beta$ is defined as the reciprocal of the desired closed-loop gain, we can infer $A$ from $A=L/\\beta$ without performing a rigorous analysis. Therefore, our feedback circuit analysis will rely on knowledge of $\\beta$, obtained either by design or by inspecting a relatively simple circuit, and on $L$, which can be estimated using a systematic procedure outlined in Section 5.4.1.\n\nGeneralizing the expression for closed-loop gain in (5.8), the closed-loop frequency response of a feedback circuit can be expressed without referencing $A(s)$.\n\n$$\n\\begin{equation*}\nA_{CL}(s)=\\frac{1}{\\beta} \\cdot \\frac{L(s)}{1+L(s)} \\tag{5.51}\n\\end{equation*}\n$$\n\nIn (5.51), the term $L(s)/(1+L(s))$ represents the closed-loop amplifier gain normalized to the desired gain, $1/\\beta$. Many circuit attributes of interest can be understood in terms of this normalized frequency response, which depends only on $L(s)$. For example, the bandwidth, poles, and zeros of the closed-loop amplifier correspond to those of $L(s)/(1+L(s))$. The gain error at dc, defined as the fractional error between the desired gain, $1/\\beta$, and the actual gain, $A_{CL0}=A_{CL}(0)$, is simply\n\n$$\n\\begin{equation*}\n\\text{Gain error}=1-\\frac{A_{CL0}}{1/\\beta}=1-\\frac{L_{0}}{1+L_{0}} \\tag{5.52}\n\\end{equation*}\n$$\n\nKey Point: Feedback systems can be analyzed based on their desired gain, $\\beta$, and loop gain, $L(\\omega)$, from which the closed-loop amplifier's gain, bandwidth, phase margin, and frequency response can all be deduced. This will be very close to zero as long as the loop gain at dc, $L_{0}=L(0)$, is large.\n\nImage Description: Fig. 5.10 illustrates an inverting opamp configuration. The circuit includes a voltage source (Vs), resistors (Z1 and Z2) setting the gain, an opamp (A1) with its inverting input connected to Z1 and output to Z2, and a load resistor (ZL) connected at the output (Vout). The feedback resistors Z1 and Z2 determine the gain, and ZL is attached at Vout."
},
{
    "text": "We will now apply our general analysis of feedback systems to small-signal circuits. To achieve this, we must model the circuit of interest according to Fig. 5.1. However, this process can be challenging. There may be uncertainty in determining whether the inputs and/or outputs of a specific circuit are voltages or currents. Additionally, distinguishing between the forward amplifier, $A$, and the feedback network, $\\beta$, can be difficult, as some components participate in both.\n\nSpecifically, identifying $A$ is problematic. For instance, consider the inverting amplifier setup in Fig. 5.10, where the opamp has a finite output impedance, $Z_{0}$. It might seem that $A$ is simply the opamp's voltage gain, but this is incorrect. According to Equation (5.5) and Fig. 5.1, if $A=0$, the closed-loop amplifier output should be zero. Nevertheless, even with zero opamp gain, a finite voltage would appear at $v_{\\text{out}}$ due to the voltage division by the feedback network impedances ($Z_{1}$ and $Z_{2}$) and the output node impedances ($Z_{0}$ and $Z_{L}$). In reality, accurately determining $A$ is complex, even in this common example, as it depends on the opamp, feedback components $Z_{1}$ and $Z_{2}$, and the load $Z_{L}$. Computer simulations offer limited assistance since it's unclear which circuit configuration to simulate to find $A$, the forward gain without feedback.\n\nConversely, determining $\\beta$ is usually straightforward if one recalls that the circuit's desired gain is $1/\\beta$. For example, the expected gain from the inverting opamp configuration mentioned is $-\\left(Z_{2}/Z_{1}\\right)$, leading us to assume $\\beta=-\\left(Z_{1}/Z_{2}\\right)$. Generally, $\\beta$ is the inverse of the closed-loop gain expected under ideal conditions of high loop gain. In opamp circuits, this gain results from analyzing the circuit assuming infinite opamp gain. While this $\\beta$ value may not pinpoint the gain between specific voltages or currents, it aligns with our goal of fitting the circuit into the ideal feedback model and helps us determine key feedback circuit properties like gain error, bandwidth, phase margin, and settling time.\n\nAlthough defining $A$ may be ambiguous, the loop gain $L$ is unique, which is reassuring since loop stability depends solely on $L(s)$. Physically, a feedback circuit will be either stable or unstable, regardless of the analysis method.\n\nIf $L$ is known and $\\beta$ is defined as the reciprocal of the desired closed-loop gain, we can deduce $A$ from $A=L/\\beta$. Thus, our feedback circuit analysis will rely on knowledge of $\\beta$, obtained either by design or inspection of a simple circuit, and $L$, which can be estimated using a systematic procedure outlined in Section 5.4.1.\n\nGeneralizing the closed-loop gain expression in (5.8), the closed-loop frequency response of a feedback circuit can be expressed without referencing $A(s)$:\n\n$$\n\\begin{equation*}\nA_{CL}(s)=\\frac{1}{\\beta} \\cdot \\frac{L(s)}{1+L(s)} \\tag{5.51}\n\\end{equation*}\n$$\n\nIn (5.51), the term $L(s)/(1+L(s))$ represents the closed-loop amplifier gain normalized to the desired gain, $1/\\beta$. Many circuit attributes of interest can be understood through this normalized frequency response, which depends only on $L(s)$. For example, the bandwidth, poles, and zeros of the closed-loop amplifier correspond to those of $L(s)/(1+L(s))$. The gain error at dc, defined as the fractional error between the desired gain, $1/\\beta$, and the actual gain, $A_{CL0}=A_{CL}(0)$, is simply:\n\n$$\n\\begin{equation*}\n\\text{Gain error}=1-\\frac{A_{CL0}}{1/\\beta}=1-\\frac{L_{0}}{1+L_{0}} \\tag{5.52}\n\\end{equation*}\n$$\n\nKey Point: Feedback systems can be analyzed based on their desired gain, $\\beta$, and loop gain, $L(\\omega)$, from which the closed-loop amplifier's gain, bandwidth, phase margin, and frequency response can be inferred. This gain error will be close to zero as long as the loop gain at dc, $L_{0}=L(0)$, is large.\n\n**Image Description:**\nFig. 5.10 illustrates an inverting opamp configuration. The circuit includes:\n- A voltage source, $V_s$, connected between $V_s$ and ground.\n- A resistor, $Z_1$, linking $V_s$ to the inverting input of the opamp, $A_1$.\n- A resistor, $Z_2$, connecting the inverting input of $A_1$ to the output, $V_{\\text{out}}$.\n- An opamp, $A_1$, with its non-inverting input grounded, inverting input connected to $Z_1$ and $Z_2$, and output at $V_{\\text{out}}$.\n- A load resistor, $Z_L$, attached from $V_{\\text{out}}$ to ground.\n\nThe circuit is an inverting op-amp configuration with feedback resistors $Z_1$ and $Z_2$ setting the gain. The load resistor $Z_L$ is connected at the output $V_{\\text{out}}$."
},
{
    "text": "We will now apply our general analysis of feedback systems to small-signal circuits. To do this, we must fit the circuit of interest into the model depicted in Fig. 5.1. However, this process can be more challenging than it appears. There may be uncertainties in determining whether the inputs and/or outputs of a specific circuit are voltages or currents. Additionally, distinguishing between the forward amplifier, $A$, and the feedback network, $\\beta$, can be difficult. Some circuit components are involved in both the forward amplifier and the feedback network simultaneously.\n\nSpecifically, identifying $A$ is problematic. For instance, consider the inverting amplifier setup in Fig. 5.10, where the opamp has a finite output impedance, $Z_{0}$. It might seem straightforward to assume that $A$ is simply the voltage gain of the opamp, but this is incorrect. Equation (5.5) and Fig. 5.1 indicate that when $A=0$, the closed-loop amplifier output should be zero. Nonetheless, even if the opamp's gain were zero, a finite voltage would still appear at $v_{\\text{out}}$ due to the division of the source voltage, $v_{s}$, by the impedances in the feedback network ($Z_{1}$ and $Z_{2}$) and at the output node ($Z_{0}$ and $Z_{L}$). In reality, an accurate analysis of $A$ is quite intricate, even in this common example. It depends not only on the opamp but also on the feedback components $Z_{1}$ and $Z_{2}$, and the load $Z_{L}$. Computer simulation offers limited assistance since it is not clear what specific circuit needs to be simulated to determine $A$, the forward gain without feedback.\n\nConversely, determining the value of $\\beta$ is usually more straightforward if one recalls that the circuit's desired gain is simply $1/\\beta$. For example, the expected gain from the inverting opamp configuration mentioned earlier is well-known to be $-\\left(Z_{2}/Z_{1}\\right)$. Thus, we can assume that $\\beta=-\\left(Z_{1}/Z_{2}\\right)$. Generally, the value of $\\beta$ is the inverse of the closed-loop gain expected under ideal conditions of very high loop gain. In opamp circuits, this gain results from analyzing the circuit assuming infinite opamp gain. While this choice of $\\beta$ may not pinpoint the gain between any specific voltages and/or currents in the circuit, it aligns with our goal of fitting the circuit into the ideal feedback model. More importantly, it enables us to determine key feedback circuit properties such as gain error, bandwidth, phase margin, and settling time.\n\nAlthough defining $A$ may present some ambiguity, the loop gain $L$ is unique. This is reassuring because the stability of the loop depends solely on $L(s)$, and physically, a feedback circuit will either be stable or unstable, regardless of the analysis method.\n\nIf $L$ is known and $\\beta$ is defined as the reciprocal of the desired closed-loop gain, we can infer $A$ from $A=L/\\beta$ instead of conducting a rigorous analysis for $A$. Therefore, our analysis of feedback circuits will rely on knowledge of $\\beta$, obtained either by design or by inspecting a relatively simple circuit, and on knowledge of $L$, which can be estimated using a systematic procedure described in Section 5.4.1.\n\nGeneralizing the expression for closed-loop gain in (5.8), the closed-loop frequency response of a feedback circuit can be formulated without referencing $A(s)$.\n\n$$\n\\begin{equation*}\nA_{CL}(s)=\\frac{1}{\\beta} \\cdot \\frac{L(s)}{1+L(s)} \\tag{5.51}\n\\end{equation*}\n$$\n\nIn (5.51), the term $L(s)/(1+L(s))$ represents the closed-loop amplifier gain normalized to the desired gain, $1/\\beta$. Many circuit attributes of interest can be understood in terms of this normalized frequency response, which depends solely on $L(s)$. For example, the bandwidth, poles, and zeros of the closed-loop amplifier correspond to those of $L(s)/(1+L(s))$. The gain error at dc, defined as the fractional error between the desired gain, $1/\\beta$, and the actual gain, $A_{CL0}=A_{CL}(0)$, is simply\n\n$$\n\\begin{equation*}\n\\text{Gain error}=1-\\frac{A_{CL0}}{1/\\beta}=1-\\frac{L_{0}}{1+L_{0}} \\tag{5.52}\n\\end{equation*}\n$$\n\nKey Point: Feedback systems can be analyzed based on their desired gain, $\\beta$, and loop gain, $L(\\omega)$, from which the closed-loop amplifier's gain, bandwidth, phase margin, and frequency response can all be deduced. This will clearly approach a value very close to zero as long as the loop gain at dc, $L_{0}=L(0)$, is large.\n\n**Fig. 5.10 An inverting opamp configuration.**\nDescription:\n- **Components:**\n  - **Vs:** VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\n  - **Z1:** Resistor, value: Z1, ports: {N1: Vs, N2: InN(A1)}\n  - **Z2:** Resistor, value: Z2, ports: {N1: InN(A1), N2: Vout}\n  - **A1:** OpAmp, value: A1, ports: {InP: GND, InN: InN(A1), OutP: Vout, OutN: GND}\n  - **ZL:** Resistor, value: ZL, ports: {N1: Vout, N2: GND}\n- **Extra Info:** The circuit is an inverting op-amp configuration with feedback resistors Z1 and Z2 setting the gain. The load resistor ZL is connected at the output Vout."
},
{
    "text": "We will now apply our general analysis of feedback systems to small-signal circuits. To achieve this, we must fit the circuit of interest into the model depicted in Fig. 5.1. However, this process can be more challenging than it appears. There may be uncertainty in determining whether the inputs and/or outputs of a specific circuit are voltages or currents. Additionally, distinguishing between the forward amplifier, $A$, and the feedback network, $\\beta$, can be difficult, as some components participate in both aspects simultaneously.\n\nSpecifically, identifying $A$ is problematic. For instance, consider the inverting amplifier setup in Fig. 5.10, where the opamp has a finite output impedance, $Z_{0}$. It might seem straightforward to assume that $A$ is simply the opamp's voltage gain, but this is incorrect. According to Equation (5.5) and Fig. 5.1, if $A=0$, the closed-loop amplifier output should be zero. Nevertheless, even with zero opamp gain, a finite voltage would still appear at $v_{\\text{out}}$ due to the voltage division of $v_{s}$ by the impedances in the feedback network ($Z_{1}$ and $Z_{2}$) and at the output node ($Z_{0}$ and $Z_{L}$). In reality, accurately determining $A$ is quite complex, even in this common example, as it depends not only on the opamp but also on the feedback components $Z_{1}$ and $Z_{2}$, and the load $Z_{L}$. Computer simulations offer limited assistance since it's unclear which specific circuit configuration needs to be simulated to find $A$, the forward gain without feedback.\n\nConversely, the value of $\\beta$ is usually more apparent if one recalls that the circuit's desired gain is simply $1/\\beta$. For example, the expected gain from the inverting opamp configuration mentioned is well-known to be $-\\left(Z_{2}/Z_{1}\\right)$. Thus, we can assume that $\\beta=-\\left(Z_{1}/Z_{2}\\right)$. Generally, $\\beta$ is the inverse of the closed-loop gain anticipated under ideal conditions of very high loop gain. In opamp circuits, this gain is derived by analyzing the circuit assuming infinite opamp gain. While this choice of $\\beta$ may not pinpoint the gain between specific voltages and/or currents in the circuit, it aligns with our goal of fitting the circuit into the ideal feedback model. More importantly, it enables us to determine key feedback circuit properties such as gain error, bandwidth, phase margin, and settling time.\n\nAlthough defining $A$ may involve some ambiguity, the loop gain $L$ is distinct. This is reassuring because loop stability depends solely on $L(s)$, and a feedback circuit will be either stable or unstable, regardless of the analysis method.\n\nIf $L$ is known and $\\beta$ is defined as the reciprocal of the desired closed-loop gain, we can deduce $A$ from $A=L/\\beta$ instead of conducting a rigorous analysis for $A$. Therefore, our feedback circuit analysis will rely on knowledge of $\\beta$, acquired either by design or by examining a relatively simple circuit, and on $L$, which can be estimated using a systematic procedure outlined in Section 5.4.1.\n\nGeneralizing the expression for closed-loop gain in (5.8), the closed-loop frequency response of a feedback circuit can be formulated without referencing $A(s)$.\n\n$$\n\\begin{equation*}\nA_{CL}(s)=\\frac{1}{\\beta} \\cdot \\frac{L(s)}{1+L(s)} \\tag{5.51}\n\\end{equation*}\n$$\n\nIn (5.51), the term $L(s)/(1+L(s))$ represents the closed-loop amplifier gain normalized to the desired gain, $1/\\beta$. Many circuit attributes of interest can be understood through this normalized frequency response, which depends solely on $L(s)$. For example, the bandwidth, poles, and zeros of the closed-loop amplifier correspond to those of $L(s)/(1+L(s))$. The gain error at dc, defined as the fractional error between the desired gain, $1/\\beta$, and the actual gain, $A_{CL0}=A_{CL}(0)$, is simply\n\n$$\n\\begin{equation*}\n\\text{Gain error} = 1 - \\frac{A_{CL0}}{1/\\beta} = 1 - \\frac{L_{0}}{1+L_{0}} \\tag{5.52}\n\\end{equation*}\n$$\n\nKey Point: Feedback systems can be analyzed based on their desired gain, $\\beta$, and loop gain, $L(\\omega)$, from which the closed-loop amplifier's gain, bandwidth, phase margin, and frequency response can all be derived. This will be nearly zero as long as the loop gain at dc, $L_{0}=L(0)$, is substantial.\n\n**Image Description:**\nFig. 5.10 illustrates an inverting opamp configuration. The circuit includes:\n- A voltage source, $V_s$, connected between $V_s$ and ground.\n- A resistor, $Z_1$, linking $V_s$ to the inverting input of the opamp, $InN(A1)$.\n- A resistor, $Z_2$, connecting the inverting input of the opamp, $InN(A1)$, to the output, $Vout$.\n- An opamp, $A1$, with its non-inverting input grounded, inverting input connected to $InN(A1)$, and output at $Vout$.\n- A load resistor, $Z_L$, attached from $Vout$ to ground.\n\nThe circuit is an inverting op-amp configuration with feedback resistors $Z_1$ and $Z_2$ setting the gain. The load resistor $Z_L$ is connected at the output $Vout$."
},
{
    "text": "We will now apply our general analysis of feedback systems to small-signal circuits. To achieve this, we must fit the circuit of interest into the model depicted in Fig. 5.1. However, this process can be more challenging than it appears. There may be uncertainties in determining whether the inputs and/or outputs of a specific circuit are voltages or currents. Additionally, distinguishing between the forward amplifier, $A$, and the feedback network, $\\beta$, can be difficult, as some components participate in both aspects simultaneously.\n\nSpecifically, identifying $A$ is problematic. For instance, consider the inverting amplifier setup in Fig. 5.10, where the opamp has a finite output impedance, $Z_{0}$. It might seem straightforward to assume that $A$ is simply the voltage gain of the opamp, but this is incorrect. According to Equation (5.5) and Fig. 5.1, if $A=0$, the closed-loop amplifier output should be zero. Nevertheless, even with zero opamp gain, a finite voltage would still appear at $v_{\\text{out}}$ due to the voltage division of $v_{s}$ by the impedances in the feedback network ($Z_{1}$ and $Z_{2}$) and at the output node ($Z_{0}$ and $Z_{L}$). In reality, an accurate analysis for $A$ is quite intricate, even in this common example, as it depends on the opamp, the feedback components $Z_{1}$ and $Z_{2}$, and the load $Z_{L}$. Computer simulations offer limited assistance since it's unclear which specific circuit configuration needs to be simulated to determine $A$, the forward gain without feedback.\n\nConversely, determining $\\beta$ is usually more straightforward if one recalls that the circuit's intended gain is simply $1/\\beta$. For example, the expected gain from the aforementioned inverting opamp configuration is well-known to be $-\\left(Z_{2}/Z_{1}\\right)$, leading us to assume $\\beta=-\\left(Z_{1}/Z_{2}\\right)$. Generally, $\\beta$ is the inverse of the closed-loop gain anticipated under ideal conditions of very high loop gain. In opamp circuits, this gain results from analyzing the circuit assuming infinite opamp gain. While this choice of $\\beta$ may not pinpoint the gain between specific voltages and/or currents in the circuit, it aligns with our goal of fitting the circuit into the ideal feedback model. More importantly, it enables us to determine key feedback circuit properties such as gain error, bandwidth, phase margin, and settling time.\n\nAlthough defining $A$ may involve some ambiguity, the loop gain $L$ is distinct. This is reassuring because loop stability depends solely on $L(s)$, and physically, a feedback circuit will either be stable or unstable, regardless of the analysis method.\n\nIf $L$ is known and $\\beta$ is defined as the reciprocal of the desired closed-loop gain, we can infer $A$ from $A=L/\\beta$ without conducting a rigorous analysis. Thus, our feedback circuit analysis will rely on understanding $\\beta$, either through design or inspection of a relatively simple circuit, and on $L$, which can be estimated using a systematic procedure outlined in Section 5.4.1.\n\nBy generalizing the closed-loop gain expression in (5.8), the closed-loop frequency response of a feedback circuit can be formulated without referencing $A(s)$.\n\n$$\n\\begin{equation*}\nA_{CL}(s)=\\frac{1}{\\beta} \\cdot \\frac{L(s)}{1+L(s)} \\tag{5.51}\n\\end{equation*}\n$$\n\nIn (5.51), the term $L(s)/(1+L(s))$ represents the closed-loop amplifier gain normalized to the desired gain, $1/\\beta$. Many circuit attributes of interest can be understood through this normalized frequency response, which depends solely on $L(s)$. For example, the bandwidth, poles, and zeros of the closed-loop amplifier correspond to those of $L(s)/(1+L(s))$. The gain error at dc, defined as the fractional error between the desired gain, $1/\\beta$, and the actual gain, $A_{CL0}=A_{CL}(0)$, is simply\n\n$$\n\\begin{equation*}\n\\text{Gain error} = 1 - \\frac{A_{CL0}}{1/\\beta} = 1 - \\frac{L_{0}}{1+L_{0}} \\tag{5.52}\n\\end{equation*}\n$$\n\nKey Point: Feedback systems can be analyzed based on their desired gain, $\\beta$, and loop gain, $L(\\omega)$, from which the closed-loop amplifier's gain, bandwidth, phase margin, and frequency response can all be deduced. This approach will yield a value very close to zero as long as the loop gain at dc, $L_{0}=L(0)$, is substantial.\n\nimage_name: Fig. 5.10 An inverting opamp configuration.\ndescription:\n[\nname: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\nname: Z1, type: Resistor, value: Z1, ports: {N1: Vs, N2: InN(A1)}\nname: Z2, type: Resistor, value: Z2, ports: {N1: InN(A1), N2: Vout}\nname: A1, type: OpAmp, value: A1, ports: {InP: GND, InN: InN(A1), OutP: Vout, OutN: GND}\nname: ZL, type: Resistor, value: ZL, ports: {N1: Vout, N2: GND}\n]\nextrainfo: The circuit is an inverting op-amp configuration with feedback resistors Z1 and Z2 setting the gain. The load resistor ZL is connected at the output Vout.\n\nFig. 5.10 An inverting opamp configuration."
},
{
    "text": "To determine the loop gain of a feedback circuit, the loop is interrupted, a test signal (either voltage or current) is introduced, and the signal returned to the opposite side of the break is observed. This process is depicted in Fig. 5.11. Specifically, for any small-signal feedback circuit:\n\n1. Set all independent sources in the circuit, including the input source, to zero. Zeroing a voltage source involves replacing it with a short circuit (an ideal voltage source of 0 V). Zeroing a current source means replacing it with an open circuit (an ideal current source of 0 A).\n2. Interrupt the loop. Determine the impedance at the break point, $Z_{t}$, and terminate the loop with this impedance, as illustrated in Fig. 5.11.\n3. Insert a test signal (either voltage, $\\mathrm{v}_{\\mathrm{t}}$, or current, $\\mathrm{i}_{\\mathrm{t}}$) into the loop at the break and measure the returned signal: either the voltage across $Z_{t}, v_{r}$, or the current through $Z_{t}, i_{r}$. The loop gain is then calculated as\n\n$$\n\\begin{equation*}\nL=-\\frac{v_{r}}{v_{t}} \\text { (for voltage test signals) or }-\\frac{i_{r}}{i_{t}} \\text { (for current test signals). } \\tag{5.53}\n\\end{equation*}\n$$\n\nimage_name:Fig. 5.11\ndescription:The circuit is used to determine the loop gain L by breaking the loop and inserting a test signal. The loop gain is calculated as L = -Vr/Vt or -Ir/It. The diagram shows a series of blocks, each containing a resistor, capacitor, and a voltage-controlled voltage source, connected in a loop with a test impedance Zt and test voltage Vt.\n\nFig. 5.11 Determining the loop gain, L, by breaking the loop.\n\nThe critical step is step 2. While the loop can be broken at any point, it is convenient to do so at an ideal voltage or current source so that the terminating impedance does not affect the result and can be omitted. Alternatively, a point in the loop where the terminating impedance is easily determined can be chosen.\n\nThe loop gain obtained through this method is an approximation, as it ignores the possibility of signals circulating in the opposite direction around the loop. This approximation is accurate provided the gain in the forward direction (clockwise in Fig. 5.11) is significantly greater than the gain in the opposite direction (counterclockwise in Fig. 5.11). This is typically the case in the circuits of interest, where feedback is used to trade high gain for other beneficial properties, as discussed in Section 5.1.\n\n#### EXAMPLE 5.8\n\nDetermine the loop gain, $L(s)$, and closed-loop gain, $A_{C L}(s)$, for the inverting opamp configuration shown in Fig. 5.10, assuming the load impedance, $Z_{L}$, is infinite. The opamp has a voltage gain $A_{v}$ and an infinite input impedance.\n\n#### Solution\n\nThe small-signal equivalent circuit is shown in Fig. 5.12(a). We apply the loop gain determination procedure to this circuit.\n\n1. The input source is zeroed by grounding $\\mathrm{v}_{\\mathrm{s}}$.\n2. The loop is broken at the opamp input terminals, chosen because the input impedance there is infinite, simplifying the determination of $Z_{t}$.\n3. The test signal $v_{t}$ is injected into the modified circuit, Fig. 5.12(b). The returned voltage is determined using nodal analysis:\n\n$$\nv_{r}=-A_{v}(s) \\frac{Z_{1}}{Z_{1}+Z_{2}+Z_{0}} v_{t}\n$$\n\nThus, the loop gain is\n\n$$\nL(s)=-\\frac{v_{r}}{v_{t}}=A_{v}(s) \\frac{Z_{1}}{Z_{1}+Z_{2}+Z_{0}}\n$$\n\nThe normalized closed-loop gain is\n\n$$\n\\frac{L(s)}{1+L(s)}=\\frac{A_{v}(s) Z_{1}}{A_{v}(s) Z_{1}+Z_{1}+Z_{2}+Z_{o}}\n$$\n\nThe desired gain for this circuit is $1 / \\beta=-\\left(Z_{2} / Z_{1}\\right)$, so the closed-loop gain is given by (5.51):\n\n$$\nA_{\\mathrm{CL}}(\\mathrm{~s})=-\\frac{Z_{2}}{Z_{1}} \\cdot \\frac{A_{v}(s) Z_{1}}{A_{v}(s) Z_{1}+Z_{1}+Z_{2}+Z_{o}}\n$$\n\nAs long as $A_{v}$ is much greater than $\\left(Z_{1}+Z_{2}+Z_{0}\\right) / Z_{1}$, the closed-loop gain will approximate the desired gain. The same result can be obtained by direct nodal analysis of the circuit in Fig. 5.12(a) without breaking the loop.\n(a)\nimage_name:Fig. 5.12 (b)\ndescription:\n[\nname: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\nname: Z1, type: Resistor, value: Z1, ports: {N1: Vs, N2: -Vi}\nname: Z2, type: Resistor, value: Z2, ports: {N1: -Vi, N2: Vout}\nname: Opamp, type: OpAmp, value: Av(s), ports: {InP: GND, InN: -Vi, OutP: Vout}\nname: Zo, type: Resistor, value: Zo, ports: {N1: Vout, N2: GND}\n]\nextrainfo:This circuit represents a small-signal model of an inverting op-amp configuration with a feedback loop. The loop is broken at the indicated point for analysis of the loop gain.\n\n(b)\nimage_name:Fig. 5.12 (b)\ndescription:\n[\nname: Vs, type: VoltageSource, value: 0, ports: {Np: GND, Nn: Vs}\nname: Z1, type: Resistor, value: Z1, ports: {N1: Vr, N2: GND}\nname: Z2, type: Resistor, value: Z2, ports: {N1: Vr, N2: Vout}\nname: Av(s)Vi, type: VoltageControlledVoltageSource, ports: {Np: Vout, Nn: GND}\nname: Zo, type: Resistor, value: Zo, ports: {N1: Av(s)*Vi, N2: Vout}\n]\nextrainfo:This circuit represents a configuration for determining the loop gain L = -vr/vt of a small-signal model. It includes a feedback loop broken at a specific point for analysis. The voltage source Vs is set to 0, indicating a test condition for loop gain measurement.\n\nFig. 5.12 (a) Small-signal model of an inverting opamp configuration. (b) Circuit for determining the loop gain, $L=-v_{r} / v_{t}$.\n\n#### EXAMPLE 5.9\n\nCalculate the loop gain of the differential pair feedback circuit shown in Fig. 5.13(a).\n\n#### Solution\n\nWe focus on the small-signal response of the circuit, starting with its small-signal equivalent, shown in Fig. 5.13(b), where $Q_{1,2}$ and $Q_{3,4}$ are assumed to be matched device pairs. A simplified small-signal model of the differential pair with an active load is used; for full details, refer to Chapter 3.\n\nThe circuit for determining the loop gain is shown in Fig. 5.13(c).\n\n1. The input source is zeroed by grounding $\\mathrm{v}_{\\mathrm{in}}$.\n2. The loop is broken at the gate of $M 2$, chosen because the terminating impedance, $Z_{t}$, is simply the input capacitance to the differential pair. In Fig. 5.13(c), this terminating capacitance is in parallel with the larger $\\mathrm{C}_{\\mathrm{L}}$, so any inaccuracies in accounting for all parasitic components of the input capacitance will have minimal impact on the analysis.\n3. A test source, $\\mathrm{v}_{\\mathrm{t}}$, is introduced at the break point. The circuit in Fig. 5.13(c) is then analyzed to find $\\mathrm{L}=-\\left(\\mathrm{v}_{\\mathrm{r}} / \\mathrm{v}_{\\mathrm{t}}\\right)$. The dc analysis proceeds as follows.\nimage_name:(a)\ndescription:The circuit diagram (a) represents a unity-gain feedback circuit with two NMOS transistors (Q1 and Q2) and three PMOS transistors (Q3, Q4, and Q5). The circuit is configured to provide negative feedback with the output voltage 'Vout' being fed back to the gates of the PMOS transistors. The capacitor 'CL' is the load capacitance at the output, and 'Cgs,1/2' and 'Cgs,5' are gate-source capacitances. The circuit includes voltage-controlled current sources and several resistive and capacitive elements to stabilize the feedback loop.\nimage_name:(b)\ndescription:The circuit diagram represents a small-signal equivalent model for a unity-gain feedback circuit. It includes capacitors, resistors, and a voltage-controlled current source. The node 'Vgs,5' is connected to the gate-source voltage of a transistor, while 'Vout' is the output node. The diagram is used to analyze the loop gain of the circuit.\nimage_name:(c)\ndescription:The circuit is a small-signal model used to analyze the loop gain L = -vr/vt. It includes MOSFET devices and capacitors to model parasitic effects in the feedback loop.\n\nFig. 5.13 (a) A unity-gain feedback circuit. (b) Its small-signal equivalent. (c) The small-signal circuit for finding the loop gain, $L=-v_{r} / v_{t}$.\n\nSince the impedance looking into the gate of $Q_{5}$ is infinite at dc, the small-signal gate voltage is\n\n$$\n\\mathrm{v}_{\\mathrm{g}, 5}=-\\mathrm{g}_{\\mathrm{m}, 1} \\mathrm{v}_{\\mathrm{t}}\\left(\\mathrm{r}_{\\mathrm{ds}, 1}| | \\mathrm{r}_{\\mathrm{ds}, 3}\\right)\n$$\n\nThe returned voltage is then determined by voltage division:\n\n$$\nv_{r}=v_{g, 5}\\left(\\frac{g_{m, 5}}{g_{m, 5}+1 / r_{d s, 5}+g_{m b, 5}}\\right)=-\\left[\\frac{g_{m, 1}\\left(r_{d s, 1}| | r_{d s, 3}\\right) g_{m, 5}}{g_{m, 5}+1 / r_{d s, 5}+g_{m b, 5}}\\right] v_{t}\n$$\n\nThus, the loop gain at dc is\n\n$$\n\\mathrm{L}=\\frac{\\mathrm{g}_{\\mathrm{m}, 1}\\left(\\mathrm{r}_{\\mathrm{ds}, 1}| | \\mathrm{r}_{\\mathrm{ds}, 3}\\right) \\mathrm{g}_{\\mathrm{m}, 5}}{\\mathrm{~g}_{\\mathrm{m}, 5}+1 / \\mathrm{r}_{\\mathrm{ds}, 5}+\\mathrm{g}_{\\mathrm{mb}, 5}}\n$$\n\nThe high-frequency analysis is left as an exercise, where it may be helpful to refer to the common-source amplifier high-frequency analysis in Chapter 4.\n\nThis method is also highly useful for computer circuit simulations to accurately determine the loop gain. However, it must be applied only to the small-signal equivalent circuit. In a transistor circuit, the dc biasing connections should not be broken, as this would alter some of the circuit's small-signal parameters. This can be achieved in simulation by using a very large ideal inductance, as shown in Fig. 5.14. The large inductance acts as a short at dc, preserving the dc biasing, but functions as an open circuit at frequencies of interest. A test small signal can then be introduced via a large coupling capacitor."
},
{
    "text": "To determine the loop gain of a feedback circuit, we interrupt the loop, introduce a test signal (either voltage or current), and observe the signal returned to the opposite side of the break. This process is depicted in Fig. 5.11. Specifically, for any small-signal feedback circuit:\n\n1. Set all independent sources in the circuit, including the input source, to zero. Zeroing a voltage source involves replacing it with a short circuit (an ideal voltage source of 0 V). Zeroing a current source involves replacing it with an open circuit (an ideal current source of 0 A).\n2. Interrupt the loop. Determine the impedance at the break point, $Z_{t}$, and terminate the loop with this impedance, as illustrated in Fig. 5.11.\n3. Insert a test signal (either voltage, $\\mathrm{v}_{\\mathrm{t}}$, or current, $\\mathrm{i}_{\\mathrm{t}}$) into the loop at the break and measure the returned signal: either the voltage across $Z_{t}, v_{r}$, or the current through $Z_{t}, i_{r}$. The loop gain is then calculated as\n\n$$\n\\begin{equation*}\nL=-\\frac{v_{r}}{v_{t}} \\text { (for voltage test signals) or }-\\frac{i_{r}}{i_{t}} \\text { (for current test signals). } \\tag{5.53}\n\\end{equation*}\n$$\n\nimage_name:Fig. 5.11\ndescription:The circuit is used to determine the loop gain L by breaking the loop and inserting a test signal. The loop gain is calculated as L = -Vr/Vt or -Ir/It. The diagram shows a series of blocks, each containing a resistor, capacitor, and a voltage-controlled voltage source, connected in a loop with a test impedance Zt and test voltage Vt.\n\nFig. 5.11 Determining the loop gain, L, by breaking the loop.\n\nThe crucial step is step 2. While the loop can be broken at any point, it is convenient to do so at an ideal voltage or current source so that the terminating impedance does not affect the result and can be omitted. Alternatively, one may choose a point in the loop where the terminating impedance is easily determined.\n\nThe loop gain obtained through this method is an approximation, as it ignores the possibility of signals circulating in the opposite direction around the loop. This approximation is accurate as long as the gain in the forward direction (clockwise in Fig. 5.11) is significantly greater than the gain in the opposite direction (counterclockwise in Fig. 5.11). This is typically the case in the circuits of interest where feedback is used to trade high gain for other beneficial properties, as discussed in Section 5.1.\n\n#### EXAMPLE 5.8\n\nDetermine the loop gain, $L(s)$, and closed-loop gain, $A_{C L}(s)$, of the inverting opamp configuration shown in Fig. 5.10, assuming the load impedance, $Z_{L}$, is infinite. The opamp has a voltage gain $A_{v}$ and an infinite input impedance.\n\n#### Solution\n\nThe small-signal equivalent circuit is shown in Fig. 5.12(a). We apply the loop gain determination procedure to this circuit.\n\n1. The input source is zeroed by setting $\\mathrm{v}_{\\mathrm{s}}$ to ground.\n2. The loop is broken at the opamp input terminals, chosen because the input impedance there is infinite, simplifying the determination of $Z_{t}$.\n3. The test signal $v_{t}$ is injected into the modified circuit, Fig. 5.12(b). The returned voltage is determined by nodal analysis:\n\n$$\nv_{r}=-A_{v}(s) \\frac{Z_{1}}{Z_{1}+Z_{2}+Z_{0}} v_{t}\n$$\n\nThus, the loop gain is\n\n$$\nL(s)=-\\frac{v_{r}}{v_{t}}=A_{v}(s) \\frac{Z_{1}}{Z_{1}+Z_{2}+Z_{0}}\n$$\n\nThe normalized closed-loop gain is\n\n$$\n\\frac{L(s)}{1+L(s)}=\\frac{A_{v}(s) Z_{1}}{A_{v}(s) Z_{1}+Z_{1}+Z_{2}+Z_{o}}\n$$\n\nThe desired gain of this circuit is $1 / \\beta=-\\left(Z_{2} / Z_{1}\\right)$, so the closed-loop gain is given by (5.51):\n\n$$\nA_{\\mathrm{CL}}(\\mathrm{~s})=-\\frac{Z_{2}}{Z_{1}} \\cdot \\frac{A_{v}(s) Z_{1}}{A_{v}(s) Z_{1}+Z_{1}+Z_{2}+Z_{o}}\n$$\n\nAs long as $A_{v}$ is much greater than $\\left(Z_{1}+Z_{2}+Z_{0}\\right) / Z_{1}$, the closed-loop gain will approximate the desired gain. The same result can be obtained by direct nodal analysis of the circuit in Fig. 5.12(a) without breaking the loop.\n(a)\nimage_name:Fig. 5.12 (b)\ndescription:\n[\nname: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\nname: Z1, type: Resistor, value: Z1, ports: {N1: Vs, N2: -Vi}\nname: Z2, type: Resistor, value: Z2, ports: {N1: -Vi, N2: Vout}\nname: Opamp, type: OpAmp, value: Av(s), ports: {InP: GND, InN: -Vi, OutP: Vout}\nname: Zo, type: Resistor, value: Zo, ports: {N1: Vout, N2: GND}\n]\nextrainfo:This circuit represents a small-signal model of an inverting op-amp configuration with a feedback loop. The loop is broken at the indicated point for analysis of the loop gain.\n\n(b)\nimage_name:Fig. 5.12 (b)\ndescription:\n[\nname: Vs, type: VoltageSource, value: 0, ports: {Np: GND, Nn: Vs}\nname: Z1, type: Resistor, value: Z1, ports: {N1: Vr, N2: GND}\nname: Z2, type: Resistor, value: Z2, ports: {N1: Vr, N2: Vout}\nname: Av(s)Vi, type: VoltageControlledVoltageSource, ports: {Np: Vout, Nn: GND}\nname: Zo, type: Resistor, value: Zo, ports: {N1: Av(s)*Vi, N2: Vout}\n]\nextrainfo:This circuit represents a configuration for determining the loop gain L = -vr/vt of a small-signal model. It includes a feedback loop broken at a specific point for analysis. The voltage source Vs is set to 0, indicating a test condition for loop gain measurement.\n\nFig. 5.12 (a) Small-signal model of an inverting opamp configuration. (b) Circuit for determining the loop gain, $L=-v_{r} / v_{t}$.\n\n#### EXAMPLE 5.9\n\nFind the loop gain of the differential pair feedback circuit shown in Fig. 5.13(a).\n\n#### Solution\n\nWe consider only the small-signal response of the circuit, starting with its small-signal equivalent, shown in Fig. 5.13(b), where $Q_{1,2}$ and $Q_{3,4}$ are assumed to be matched device pairs. A simplified small-signal model of the differential pair with an active load is used; for full details, refer to Chapter 3.\n\nThe circuit for determining the loop gain is shown in Fig. 5.13(c).\n\n1. The input source is zeroed by setting $\\mathrm{v}_{\\mathrm{in}}$ to ground.\n2. The loop is broken at the gate of $M 2$, chosen because the terminating impedance, $Z_{t}$, is simply the input capacitance to the differential pair. In Fig. 5.13(c), this terminating capacitance is in parallel with the larger $\\mathrm{C}_{\\mathrm{L}}$, so any inaccuracies in accounting for all parasitic components of the input capacitance will have minimal impact on the analysis.\n3. A test source, $\\mathrm{v}_{\\mathrm{t}}$, is introduced at the break point. The circuit in Fig. 5.13(c) is then analyzed to find $\\mathrm{L}=-\\left(\\mathrm{v}_{\\mathrm{r}} / \\mathrm{v}_{\\mathrm{t}}\\right)$. The dc analysis proceeds as follows.\nimage_name:(a)\ndescription:The circuit diagram (a) represents a unity-gain feedback circuit with two NMOS transistors (Q1 and Q2) and three PMOS transistors (Q3, Q4, and Q5). The circuit is configured to provide negative feedback with the output voltage 'Vout' being fed back to the gates of the PMOS transistors. The capacitor 'CL' is the load capacitance at the output, and 'Cgs,1/2' and 'Cgs,5' are gate-source capacitances. The circuit includes voltage-controlled current sources and several resistive and capacitive elements to stabilize the feedback loop.\nimage_name:(b)\ndescription:The circuit diagram represents a small-signal equivalent model for a unity-gain feedback circuit. It includes capacitors, resistors, and a voltage-controlled current source. The node 'Vgs,5' is connected to the gate-source voltage of a transistor, while 'Vout' is the output node. The diagram is used to analyze the loop gain of the circuit.\nimage_name:(c)\ndescription:The circuit is a small-signal model used to analyze the loop gain L = -vr/vt. It includes MOSFET devices and capacitors to model parasitic effects in the feedback loop.\n\nFig. 5.13 (a) A unity-gain feedback circuit. (b) Its small-signal equivalent. (c) The small-signal circuit for finding the loop gain, $L=-v_{r} / v_{t}$.\n\nSince the impedance looking into the gate of $Q_{5}$ is infinite at dc, the small-signal gate voltage is\n\n$$\n\\mathrm{v}_{\\mathrm{g}, 5}=-\\mathrm{g}_{\\mathrm{m}, 1} \\mathrm{v}_{\\mathrm{t}}\\left(\\mathrm{r}_{\\mathrm{ds}, 1}| | \\mathrm{r}_{\\mathrm{ds}, 3}\\right)\n$$\n\nThe returned voltage is then given by voltage division:\n\n$$\nv_{r}=v_{g, 5}\\left(\\frac{g_{m, 5}}{g_{m, 5}+1 / r_{d s, 5}+g_{m b, 5}}\\right)=-\\left[\\frac{g_{m, 1}\\left(r_{d s, 1}| | r_{d s, 3}\\right) g_{m, 5}}{g_{m, 5}+1 / r_{d s, 5}+g_{m b, 5}}\\right] v_{t}\n$$\n\nThus, the loop gain at dc is\n\n$$\n\\mathrm{L}=\\frac{\\mathrm{g}_{\\mathrm{m}, 1}\\left(\\mathrm{r}_{\\mathrm{ds}, 1}| | \\mathrm{r}_{\\mathrm{ds}, 3}\\right) \\mathrm{g}_{\\mathrm{m}, 5}}{\\mathrm{~g}_{\\mathrm{m}, 5}+1 / \\mathrm{r}_{\\mathrm{ds}, 5}+\\mathrm{g}_{\\mathrm{mb}, 5}}\n$$\n\nThe high-frequency analysis is left as an exercise, where it may be helpful to refer to the common-source amplifier high-frequency analysis in Chapter 4.\n\nThis method is also highly useful for computer circuit simulations to accurately determine the loop gain. However, it must be applied only to the small-signal equivalent circuit. In a transistor circuit, the dc biasing connections should not be broken, as this would alter some of the circuit's small-signal parameters. This can be achieved in simulation by using a very large ideal inductance, as shown in Fig. 5.14. The large inductance acts as a short at dc, preserving the biasing, but is effectively an open circuit at frequencies of interest. A test small signal can then be introduced via a large coupling capacitor."
},
{
    "text": "To determine the loop gain of a feedback circuit, the loop is interrupted, a test signal (either voltage or current) is introduced, and the signal returned to the other side of the break is observed. This method is depicted in Fig. 5.11. Specifically, for any small-signal feedback circuit:\n\n1. Set all independent sources in the circuit, including the input source, to zero. Zeroing a voltage source involves replacing it with a short circuit (an ideal voltage source of 0 V). Zeroing a current source involves replacing it with an open circuit (an ideal current source of 0 A).\n2. Interrupt the loop. Determine the impedance at the break point, $Z_{t}$, and terminate the loop with this impedance, as illustrated in Fig. 5.11.\n3. Insert a test signal (either voltage, $\\mathrm{v}_{\\mathrm{t}}$, or current, $\\mathrm{i}_{\\mathrm{t}}$) into the loop at the break and measure the returned signal: either the voltage across $Z_{t}$, $v_{r}$, or the current through $Z_{t}$, $i_{r}$. The loop gain is then calculated as\n\n$$\n\\begin{equation*}\nL=-\\frac{v_{r}}{v_{t}} \\text { (for voltage test signals) or }-\\frac{i_{r}}{i_{t}} \\text { (for current test signals). } \\tag{5.53}\n\\end{equation*}\n$$\n\nimage_name:Fig. 5.11\ndescription:The circuit is used to determine the loop gain L by breaking the loop and inserting a test signal. The loop gain is calculated as L = -Vr/Vt or -Ir/It. The diagram shows a series of blocks, each containing a resistor, capacitor, and a voltage-controlled voltage source, connected in a loop with a test impedance Zt and test voltage Vt.\n\nFig. 5.11 Illustration of determining the loop gain, L, by breaking the loop.\n\nThe critical step is step 2. While the loop can be broken at any point, it is advantageous to do so at an ideal voltage or current source so that the terminating impedance does not affect the result and can be disregarded. Alternatively, a point in the loop where the terminating impedance is easily determined can be chosen.\n\nThe loop gain obtained through this method is an approximation, as it ignores the possibility of signals circulating in the opposite direction around the loop. This approximation is accurate provided the gain in the forward direction (clockwise in Fig. 5.11) is significantly greater than the gain in the opposite direction (counterclockwise in Fig. 5.11). This is typically the case in the circuits of interest, where feedback is used to trade high gain for other beneficial properties, as discussed in Section 5.1.\n\nKey Point: The loop gain, $\\mathrm{L}(\\omega)$, can be estimated by zeroing the input, breaking the loop, and injecting a test signal. This method provides an accurate approximation, especially when high forward gain around the loop is exchanged for increased bandwidth, accuracy, etc.\n\n#### EXAMPLE 5.8\n\nDetermine the loop gain, $L(s)$, and closed-loop gain, $A_{C L}(s)$, of the inverting opamp configuration shown in Fig. 5.10, assuming an infinite load impedance, $Z_{L}$. The opamp has a voltage gain $A_{v}$ and an infinite input impedance.\n\n#### Solution\n\nThe small-signal equivalent of the circuit is shown in Fig. 5.12(a). We apply the loop gain determination procedure to this circuit.\n\n1. The input source is zeroed by grounding $\\mathrm{v}_{\\mathrm{s}}$.\n2. The loop is broken at the opamp input terminals, chosen due to the infinite input impedance, simplifying the determination of $Z_{t}$.\n3. The test signal $v_{t}$ is injected into the modified circuit, Fig. 5.12(b). The returned voltage is determined via nodal analysis:\n\n$$\nv_{r}=-A_{v}(s) \\frac{Z_{1}}{Z_{1}+Z_{2}+Z_{0}} v_{t}\n$$\n\nThus, the loop gain is\n\n$$\nL(s)=-\\frac{v_{r}}{v_{t}}=A_{v}(s) \\frac{Z_{1}}{Z_{1}+Z_{2}+Z_{0}}\n$$\n\nThe normalized closed-loop gain is\n\n$$\n\\frac{L(s)}{1+L(s)}=\\frac{A_{v}(s) Z_{1}}{A_{v}(s) Z_{1}+Z_{1}+Z_{2}+Z_{o}}\n$$\n\nThe desired gain of this circuit is $1 / \\beta=-\\left(Z_{2} / Z_{1}\\right)$, so the closed-loop gain is given by (5.51):\n\n$$\nA_{\\mathrm{CL}}(\\mathrm{~s})=-\\frac{Z_{2}}{Z_{1}} \\cdot \\frac{A_{v}(s) Z_{1}}{A_{v}(s) Z_{1}+Z_{1}+Z_{2}+Z_{o}}\n$$\n\nAs long as $A_{v}$ is much greater than $\\left(Z_{1}+Z_{2}+Z_{0}\\right) / Z_{1}$, the closed-loop gain will approximate the desired gain. The same result can be achieved through direct nodal analysis of Fig. 5.12(a) without breaking the loop.\n(a)\nimage_name:Fig. 5.12 (b)\ndescription:\n[\nname: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\nname: Z1, type: Resistor, value: Z1, ports: {N1: Vs, N2: -Vi}\nname: Z2, type: Resistor, value: Z2, ports: {N1: -Vi, N2: Vout}\nname: Opamp, type: OpAmp, value: Av(s), ports: {InP: GND, InN: -Vi, OutP: Vout}\nname: Zo, type: Resistor, value: Zo, ports: {N1: Vout, N2: GND}\n]\nextrainfo:This circuit represents a small-signal model of an inverting op-amp configuration with a feedback loop. The loop is broken at the indicated point for analysis of the loop gain.\n\n(b)\nimage_name:Fig. 5.12 (b)\ndescription:\n[\nname: Vs, type: VoltageSource, value: 0, ports: {Np: GND, Nn: Vs}\nname: Z1, type: Resistor, value: Z1, ports: {N1: Vr, N2: GND}\nname: Z2, type: Resistor, value: Z2, ports: {N1: Vr, N2: Vout}\nname: Av(s)Vi, type: VoltageControlledVoltageSource, ports: {Np: Vout, Nn: GND}\nname: Zo, type: Resistor, value: Zo, ports: {N1: Av(s)*Vi, N2: Vout}\n]\nextrainfo:This circuit represents a configuration for determining the loop gain L = -vr/vt of a small-signal model. It includes a feedback loop broken at a specific point for analysis. The voltage source Vs is set to 0, indicating a test condition for loop gain measurement.\n\nFig. 5.12 (a) Small-signal model of an inverting opamp configuration. (b) Circuit for determining the loop gain, $L=-v_{r} / v_{t}$.\n\n#### EXAMPLE 5.9\n\nCalculate the loop gain of the differential pair feedback circuit shown in Fig. 5.13(a).\n\n#### Solution\n\nWe consider only the small-signal response of the circuit, starting with its small-signal equivalent shown in Fig. 5.13(b), assuming $Q_{1,2}$ and $Q_{3,4}$ are matched device pairs. A simplified small-signal model of the differential pair with an active load is used; for full details, refer to Chapter 3.\n\nThe circuit for determining the loop gain is shown in Fig. 5.13(c).\n\n1. The input source is zeroed by grounding $\\mathrm{v}_{\\mathrm{in}}$.\n2. The loop is broken at the gate of $M 2$, chosen because the terminating impedance, $Z_{t}$, is simply the input capacitance to the differential pair. In Fig. 5.13(c), this terminating capacitance is in parallel with the larger $\\mathrm{C}_{\\mathrm{L}}$, minimizing the impact of any parasitic components on the analysis.\n3. A test source, $\\mathrm{v}_{\\mathrm{t}}$, is introduced at the break point. The circuit in Fig. 5.13(c) is then analyzed to find $\\mathrm{L}=-\\left(\\mathrm{v}_{\\mathrm{r}} / \\mathrm{v}_{\\mathrm{t}}\\right)$. The dc analysis proceeds as follows.\nimage_name:(a)\ndescription:The circuit diagram (a) represents a unity-gain feedback circuit with two NMOS transistors (Q1 and Q2) and three PMOS transistors (Q3, Q4, and Q5). The circuit is configured to provide negative feedback with the output voltage 'Vout' being fed back to the gates of the PMOS transistors. The capacitor 'CL' is the load capacitance at the output, and 'Cgs,1/2' and 'Cgs,5' are gate-source capacitances. The circuit includes voltage-controlled current sources and several resistive and capacitive elements to stabilize the feedback loop.\nimage_name:(b)\ndescription:The circuit diagram represents a small-signal equivalent model for a unity-gain feedback circuit. It includes capacitors, resistors, and a voltage-controlled current source. The node 'Vgs,5' is connected to the gate-source voltage of a transistor, while 'Vout' is the output node. The diagram is used to analyze the loop gain of the circuit.\nimage_name:(c)\ndescription:The circuit is a small-signal model used to analyze the loop gain L = -vr/vt. It includes MOSFET devices and capacitors to model parasitic effects in the feedback loop.\n\nFig. 5.13 (a) A unity-gain feedback circuit. (b) Its small-signal equivalent. (c) The small-signal circuit for finding the loop gain, $L=-v_{r} / v_{t}$.\n\nAt dc, the impedance looking into the gate of $Q_{5}$ is infinite, so the small-signal gate voltage is\n\n$$\n\\mathrm{v}_{\\mathrm{g}, 5}=-\\mathrm{g}_{\\mathrm{m}, 1} \\mathrm{v}_{\\mathrm{t}}\\left(\\mathrm{r}_{\\mathrm{ds}, 1}| | \\mathrm{r}_{\\mathrm{ds}, 3}\\right)\n$$\n\nThe returned voltage is then determined by voltage division:\n\n$$\nv_{r}=v_{g, 5}\\left(\\frac{g_{m, 5}}{g_{m, 5}+1 / r_{d s, 5}+g_{m b, 5}}\\right)=-\\left[\\frac{g_{m, 1}\\left(r_{d s, 1}| | r_{d s, 3}\\right) g_{m, 5}}{g_{m, 5}+1 / r_{d s, 5}+g_{m b, 5}}\\right] v_{t}\n$$\n\nThus, the loop gain at dc is\n\n$$\n\\mathrm{L}=\\frac{\\mathrm{g}_{\\mathrm{m}, 1}\\left(\\mathrm{r}_{\\mathrm{ds}, 1}| | \\mathrm{r}_{\\mathrm{ds}, 3}\\right) \\mathrm{g}_{\\mathrm{m}, 5}}{\\mathrm{~g}_{\\mathrm{m}, 5}+1 / \\mathrm{r}_{\\mathrm{ds}, 5}+\\mathrm{g}_{\\mathrm{mb}, 5}}\n$$\n\nThe high-frequency analysis is left as an exercise, with reference to the common-source amplifier high-frequency analysis in Chapter 4.\n\nThis method is also highly useful for computer simulations to accurately determine the loop gain. However, it must be applied only to the small-signal equivalent circuit. In transistor circuits, dc biasing connections should not be broken, as this would alter the small-signal parameters. This can be achieved in simulations using a large ideal inductance, as shown in Fig. 5.14, which acts as a short at dc and an open circuit at relevant frequencies. A test signal can then be introduced via a large coupling capacitor."
},
{
    "text": "To determine the loop gain of a feedback circuit, we interrupt the loop, introduce a test signal (either voltage or current), and observe the signal returned to the opposite side of the break. This method is depicted in Fig. 5.11. Specifically, for any small-signal feedback circuit:\n\n1. Set all independent sources in the circuit to zero, including the input source. Zeroing a voltage source involves replacing it with a short circuit (an ideal voltage source of 0 V). Zeroing a current source involves replacing it with an open circuit (an ideal current source of 0 A).\n2. Interrupt the loop. Determine the impedance at the break point, $Z_{t}$, and terminate the loop with this impedance, as illustrated in Fig. 5.11.\n3. Insert a test signal (either voltage, $\\mathrm{v}_{\\mathrm{t}}$, or current, $\\mathrm{i}_{\\mathrm{t}}$) into the loop at the break and measure the returned signal: either the voltage across $Z_{t}, v_{r}$, or the current through $Z_{t}, i_{r}$. The loop gain is then calculated as\n\n$$\n\\begin{equation*}\nL=-\\frac{v_{r}}{v_{t}} \\text { (for voltage test signals) or }-\\frac{i_{r}}{i_{t}} \\text { (for current test signals). } \\tag{5.53}\n\\end{equation*}\n$$\n\nimage_name:Fig. 5.11\ndescription:The circuit is used to determine the loop gain L by breaking the loop and inserting a test signal. The loop gain is calculated as L = -Vr/Vt or -Ir/It. The diagram shows a series of blocks, each containing a resistor, capacitor, and a voltage-controlled voltage source, connected in a loop with a test impedance Zt and test voltage Vt.\n\nFig. 5.11 Determining the loop gain, L, by breaking the loop.\n\nThe critical step is step 2. Although the loop can be broken at any point, it is convenient to do so at an ideal voltage or current source so that the terminating impedance does not affect the result and can be omitted. Alternatively, one can choose a point in the loop where the terminating impedance is easily determined.\n\nThe loop gain obtained through this method is an approximation, as it ignores the possibility of signals circulating in the opposite direction around the loop. This approximation is accurate as long as the gain in the forward direction (clockwise in Fig. 5.11) is significantly greater than the gain in the opposite direction (counterclockwise in Fig. 5.11). This is typically the case in circuits of interest where feedback is used to trade high gain for other beneficial properties, as discussed in Section 5.1.\n\nKey Point: The loop gain, $\\mathrm{L}(\\omega)$, can be estimated by zeroing the input, breaking the loop, and injecting a test signal. This provides an accurate approximation in typical scenarios where high forward gain around the loop is exchanged for increased bandwidth, accuracy, etc.\n\n#### EXAMPLE 5.8\n\nDetermine the loop gain, $L(s)$, and closed-loop gain, $A_{C L}(s)$, of the inverting opamp configuration shown in Fig. 5.10, assuming the load impedance, $Z_{L}$, is infinite. The opamp has a voltage gain $A_{v}$ and an infinite input impedance.\n\n#### Solution\n\nThe small-signal equivalent circuit is shown in Fig. 5.12(a). We apply the procedure to determine the loop gain.\n\n1. The input source is zeroed by grounding $\\mathrm{v}_{\\mathrm{s}}$.\n2. The loop is broken at the opamp input terminals, chosen because the input impedance there is infinite, simplifying the determination of $Z_{t}$.\n3. The test signal $v_{t}$ is injected into the modified circuit, Fig. $5.12(b)$. The returned voltage is found using nodal analysis:\n\n$$\nv_{r}=-A_{v}(s) \\frac{Z_{1}}{Z_{1}+Z_{2}+Z_{0}} v_{t}\n$$\n\nThus, the loop gain is\n\n$$\nL(s)=-\\frac{v_{r}}{v_{t}}=A_{v}(s) \\frac{Z_{1}}{Z_{1}+Z_{2}+Z_{0}}\n$$\n\nThe normalized closed-loop gain is\n\n$$\n\\frac{L(s)}{1+L(s)}=\\frac{A_{v}(s) Z_{1}}{A_{v}(s) Z_{1}+Z_{1}+Z_{2}+Z_{o}}\n$$\n\nThe desired gain of this circuit is $1 / \\beta=-\\left(Z_{2} / Z_{1}\\right)$, so the closed-loop gain is given by (5.51):\n\n$$\nA_{\\mathrm{CL}}(\\mathrm{~s})=-\\frac{Z_{2}}{Z_{1}} \\cdot \\frac{A_{v}(s) Z_{1}}{A_{v}(s) Z_{1}+Z_{1}+Z_{2}+Z_{o}}\n$$\n\nAs long as $A_{v}$ is much greater than $\\left(Z_{1}+Z_{2}+Z_{0}\\right) / Z_{1}$, the closed-loop gain will approximate the desired gain. The same result can be obtained by direct nodal analysis of the circuit in Fig. 5.12(a) without breaking the loop.\n(a)\nimage_name:Fig. 5.12 (b)\ndescription:\n[\nname: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\nname: Z1, type: Resistor, value: Z1, ports: {N1: Vs, N2: -Vi}\nname: Z2, type: Resistor, value: Z2, ports: {N1: -Vi, N2: Vout}\nname: Opamp, type: OpAmp, value: Av(s), ports: {InP: GND, InN: -Vi, OutP: Vout}\nname: Zo, type: Resistor, value: Zo, ports: {N1: Vout, N2: GND}\n]\nextrainfo:This circuit represents a small-signal model of an inverting op-amp configuration with a feedback loop. The loop is broken at the indicated point for analysis of the loop gain.\n\n(b)\nimage_name:Fig. 5.12 (b)\ndescription:\n[\nname: Vs, type: VoltageSource, value: 0, ports: {Np: GND, Nn: Vs}\nname: Z1, type: Resistor, value: Z1, ports: {N1: Vr, N2: GND}\nname: Z2, type: Resistor, value: Z2, ports: {N1: Vr, N2: Vout}\nname: Av(s)Vi, type: VoltageControlledVoltageSource, ports: {Np: Vout, Nn: GND}\nname: Zo, type: Resistor, value: Zo, ports: {N1: Av(s)*Vi, N2: Vout}\n]\nextrainfo:This circuit represents a configuration for determining the loop gain L = -vr/vt of a small-signal model. It includes a feedback loop broken at a specific point for analysis. The voltage source Vs is set to 0, indicating a test condition for loop gain measurement.\n\nFig. 5.12 (a) Small-signal model of an inverting opamp configuration. (b) Circuit for determining the loop gain, $L=-v_{r} / v_{t}$.\n\n#### EXAMPLE 5.9\n\nFind the loop gain of the differential pair feedback circuit shown in Fig. 5.13(a).\n\n#### Solution\n\nWe consider only the small-signal response of the circuit, starting with its small-signal equivalent, shown in Fig. 5.13(b), where $Q_{1,2}$ and $Q_{3,4}$ are assumed to be matched device pairs. A simplified small-signal model of the differential pair with an active load is used; for full details, refer to Chapter 3.\n\nThe circuit for determining the loop gain is shown in Fig. 5.13(c).\n\n1. The input source is zeroed by grounding $\\mathrm{v}_{\\mathrm{in}}$.\n2. The loop is broken at the gate of $M 2$, chosen because the terminating impedance, $Z_{t}$, is simply the input capacitance to the differential pair. In Fig. 5.13(c), this terminating capacitance is in parallel with the larger $\\mathrm{C}_{\\mathrm{L}}$, so any inaccuracies in accounting for all parasitic components of the input capacitance will have minimal impact on the analysis.\n3. A test source, $\\mathrm{v}_{\\mathrm{t}}$, is introduced at the break point. The circuit in Fig. $5.13(c)$ is then analyzed to find $\\mathrm{L}=-\\left(\\mathrm{v}_{\\mathrm{r}} / \\mathrm{v}_{\\mathrm{t}}\\right)$. The dc analysis follows.\nimage_name:(a)\ndescription:The circuit diagram (a) represents a unity-gain feedback circuit with two NMOS transistors (Q1 and Q2) and three PMOS transistors (Q3, Q4, and Q5). The circuit is configured to provide negative feedback with the output voltage 'Vout' being fed back to the gates of the PMOS transistors. The capacitor 'CL' is the load capacitance at the output, and 'Cgs,1/2' and 'Cgs,5' are gate-source capacitances. The circuit includes voltage-controlled current sources and several resistive and capacitive elements to stabilize the feedback loop.\nimage_name:(b)\ndescription:The circuit diagram represents a small-signal equivalent model for a unity-gain feedback circuit. It includes capacitors, resistors, and a voltage-controlled current source. The node 'Vgs,5' is connected to the gate-source voltage of a transistor, while 'Vout' is the output node. The diagram is used to analyze the loop gain of the circuit.\nimage_name:(c)\ndescription:The circuit is a small-signal model used to analyze the loop gain L = -vr/vt. It includes MOSFET devices and capacitors to model parasitic effects in the feedback loop.\n\nFig. 5.13 (a) A unity-gain feedback circuit. (b) Its small-signal equivalent. (c) The small-signal circuit for finding the loop gain, $L=-v_{r} / v_{t}$.\n\nSince the impedance looking into the gate of $Q_{5}$ is infinite at dc, the small-signal gate voltage is\n\n$$\n\\mathrm{v}_{\\mathrm{g}, 5}=-\\mathrm{g}_{\\mathrm{m}, 1} \\mathrm{v}_{\\mathrm{t}}\\left(\\mathrm{r}_{\\mathrm{ds}, 1}| | \\mathrm{r}_{\\mathrm{ds}, 3}\\right)\n$$\n\nThe returned voltage is then determined by voltage division:\n\n$$\nv_{r}=v_{g, 5}\\left(\\frac{g_{m, 5}}{g_{m, 5}+1 / r_{d s, 5}+g_{m b, 5}}\\right)=-\\left[\\frac{g_{m, 1}\\left(r_{d s, 1}| | r_{d s, 3}\\right) g_{m, 5}}{g_{m, 5}+1 / r_{d s, 5}+g_{m b, 5}}\\right] v_{t}\n$$\n\nThus, the loop gain at dc is\n\n$$\n\\mathrm{L}=\\frac{\\mathrm{g}_{\\mathrm{m}, 1}\\left(\\mathrm{r}_{\\mathrm{ds}, 1}| | \\mathrm{r}_{\\mathrm{ds}, 3}\\right) \\mathrm{g}_{\\mathrm{m}, 5}}{\\mathrm{~g}_{\\mathrm{m}, 5}+1 / \\mathrm{r}_{\\mathrm{ds}, 5}+\\mathrm{g}_{\\mathrm{mb}, 5}}\n$$\n\nThe high-frequency analysis is left as an exercise for the reader, with reference to the common-source amplifier high-frequency analysis in Chapter 4.\n\nThis method is also highly useful for computer circuit simulations to accurately determine the loop gain. However, it must be applied only to the small-signal equivalent circuit. In a transistor circuit, the dc biasing connections should not be broken, as this would alter some of the circuit's small-signal parameters. This can be achieved in simulation by using a very large ideal inductance, as shown in Fig. 5.14. The large inductance acts as a short at dc, preserving the dc biasing, but functions as an open circuit at frequencies of interest. A test small signal can then be introduced via a large coupling capacitor."
},
{
    "text": "To determine the loop gain of a feedback circuit, the loop is interrupted, a test signal (either voltage or current) is introduced, and the signal returned to the other side of the break is observed. This process is depicted in Fig. 5.11. Specifically, for any small-signal feedback circuit:\n\n1. Set all independent sources in the circuit to zero, including the input source. Zeroing a voltage source involves replacing it with a short circuit (an ideal voltage source of 0 V). Zeroing a current source involves replacing it with an open circuit (an ideal current source of 0 A).\n2. Interrupt the loop. Determine the impedance at the break point, $Z_{t}$, and terminate the loop with this impedance, as illustrated in Fig. 5.11.\n3. Insert a test signal (either voltage, $\\mathrm{v}_{\\mathrm{t}}$, or current, $\\mathrm{i}_{\\mathrm{t}}$) into the loop at the break and measure the returned signal: either the voltage across $Z_{t}$, $v_{r}$, or the current through $Z_{t}$, $i_{r}$. The loop gain is then calculated as\n\n$$\n\\begin{equation*}\nL=-\\frac{v_{r}}{v_{t}} \\text { (for voltage test signals) or }-\\frac{i_{r}}{i_{t}} \\text { (for current test signals). } \\tag{5.53}\n\\end{equation*}\n$$\n\nimage_name:Fig. 5.11\ndescription:The circuit is used to determine the loop gain L by breaking the loop and inserting a test signal. The loop gain is calculated as L = -Vr/Vt or -Ir/It. The diagram shows a series of blocks, each containing a resistor, capacitor, and a voltage-controlled voltage source, connected in a loop with a test impedance Zt and test voltage Vt.\n\nFig. 5.11 Illustration of determining the loop gain, L, by breaking the loop.\n\nThe crucial step is step 2. While the loop can be broken at any point, it is convenient to do so at an ideal voltage or current source, ensuring the terminating impedance does not affect the result and can be omitted. Alternatively, choose a point where the terminating impedance is easily determined.\n\nThe loop gain obtained through this method is an approximation, as it ignores the possibility of signals circulating in the opposite direction around the loop. This approximation is accurate when the gain in the forward direction (clockwise in Fig. 5.11) significantly exceeds the gain in the opposite direction (counterclockwise in Fig. 5.11). This is typically the case in circuits of interest where feedback is used to trade high gain for other beneficial properties, as discussed in Section 5.1.\n\nKey Point: The loop gain, $\\mathrm{L}(\\omega)$, can be estimated by zeroing the input, breaking the loop, and injecting a test signal. This method provides an accurate approximation, especially when high forward gain around the loop is exchanged for increased bandwidth, accuracy, etc.\n\n#### EXAMPLE 5.8\n\nDetermine the loop gain, $L(s)$, and closed-loop gain, $A_{C L}(s)$, of the inverting opamp configuration shown in Fig. 5.10, assuming an infinite load impedance, $Z_{L}$. The opamp has a voltage gain $A_{v}$ and an infinite input impedance.\n\n#### Solution\n\nThe small-signal equivalent circuit is shown in Fig. 5.12(a). We apply the loop gain determination procedure to this circuit.\n\n1. The input source is zeroed by grounding $\\mathrm{v}_{\\mathrm{s}}$.\n2. The loop is broken at the opamp input terminals, chosen due to the infinite input impedance, simplifying the determination of $Z_{t}$.\n3. The test signal $v_{t}$ is injected into the modified circuit, Fig. $5.12(b)$. The returned voltage is found using nodal analysis:\n\n$$\nv_{r}=-A_{v}(s) \\frac{Z_{1}}{Z_{1}+Z_{2}+Z_{0}} v_{t}\n$$\n\nThus, the loop gain is\n\n$$\nL(s)=-\\frac{v_{r}}{v_{t}}=A_{v}(s) \\frac{Z_{1}}{Z_{1}+Z_{2}+Z_{0}}\n$$\n\nThe normalized closed-loop gain is\n\n$$\n\\frac{L(s)}{1+L(s)}=\\frac{A_{v}(s) Z_{1}}{A_{v}(s) Z_{1}+Z_{1}+Z_{2}+Z_{o}}\n$$\n\nThe desired gain for this circuit is $1 / \\beta=-\\left(Z_{2} / Z_{1}\\right)$, so the closed-loop gain is given by (5.51):\n\n$$\nA_{\\mathrm{CL}}(\\mathrm{~s})=-\\frac{Z_{2}}{Z_{1}} \\cdot \\frac{A_{v}(s) Z_{1}}{A_{v}(s) Z_{1}+Z_{1}+Z_{2}+Z_{o}}\n$$\n\nIf $A_{v}$ is much greater than $\\left(Z_{1}+Z_{2}+Z_{0}\\right) / Z_{1}$, the closed-loop gain will approximate the desired gain. This result can also be obtained by direct nodal analysis of Fig. 5.12(a) without breaking the loop.\n(a)\nimage_name:Fig. 5.12 (b)\ndescription:\n[\nname: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\nname: Z1, type: Resistor, value: Z1, ports: {N1: Vs, N2: -Vi}\nname: Z2, type: Resistor, value: Z2, ports: {N1: -Vi, N2: Vout}\nname: Opamp, type: OpAmp, value: Av(s), ports: {InP: GND, InN: -Vi, OutP: Vout}\nname: Zo, type: Resistor, value: Zo, ports: {N1: Vout, N2: GND}\n]\nextrainfo:This circuit represents a small-signal model of an inverting op-amp configuration with a feedback loop. The loop is broken at the indicated point for analysis of the loop gain.\n\n(b)\nimage_name:Fig. 5.12 (b)\ndescription:\n[\nname: Vs, type: VoltageSource, value: 0, ports: {Np: GND, Nn: Vs}\nname: Z1, type: Resistor, value: Z1, ports: {N1: Vr, N2: GND}\nname: Z2, type: Resistor, value: Z2, ports: {N1: Vr, N2: Vout}\nname: Av(s)Vi, type: VoltageControlledVoltageSource, ports: {Np: Vout, Nn: GND}\nname: Zo, type: Resistor, value: Zo, ports: {N1: Av(s)*Vi, N2: Vout}\n]\nextrainfo:This circuit represents a configuration for determining the loop gain L = -vr/vt of a small-signal model. It includes a feedback loop broken at a specific point for analysis. The voltage source Vs is set to 0, indicating a test condition for loop gain measurement.\n\nFig. 5.12 (a) Small-signal model of an inverting opamp configuration. (b) Circuit for determining the loop gain, $L=-v_{r} / v_{t}$.\n\n#### EXAMPLE 5.9\n\nCalculate the loop gain of the differential pair feedback circuit shown in Fig. 5.13(a).\n\n#### Solution\n\nWe focus on the small-signal response, starting with the small-signal equivalent circuit shown in Fig. 5.13(b), assuming $Q_{1,2}$ and $Q_{3,4}$ are matched device pairs. A simplified small-signal model of the differential pair with an active load is used; for full details, refer to Chapter 3.\n\nThe circuit for loop gain determination is shown in Fig. 5.13(c).\n\n1. The input source is zeroed by grounding $\\mathrm{v}_{\\mathrm{in}}$.\n2. The loop is broken at the gate of $M 2$, chosen because the terminating impedance, $Z_{t}$, is simply the input capacitance to the differential pair. In Fig. 5.13(c), this capacitance is paralleled with the larger $\\mathrm{C}_{\\mathrm{L}}$, minimizing the impact of any parasitic components on the analysis.\n3. A test source, $\\mathrm{v}_{\\mathrm{t}}$, is introduced at the break point. The circuit in Fig. $5.13(c)$ is then analyzed to find $\\mathrm{L}=-\\left(\\mathrm{v}_{\\mathrm{r}} / \\mathrm{v}_{\\mathrm{t}}\\right)$. The dc analysis proceeds as follows.\nimage_name:(a)\ndescription:The circuit diagram (a) represents a unity-gain feedback circuit with two NMOS transistors (Q1 and Q2) and three PMOS transistors (Q3, Q4, and Q5). The circuit is configured to provide negative feedback with the output voltage 'Vout' being fed back to the gates of the PMOS transistors. The capacitor 'CL' is the load capacitance at the output, and 'Cgs,1/2' and 'Cgs,5' are gate-source capacitances. The circuit includes voltage-controlled current sources and several resistive and capacitive elements to stabilize the feedback loop.\nimage_name:(b)\ndescription:The circuit diagram represents a small-signal equivalent model for a unity-gain feedback circuit. It includes capacitors, resistors, and a voltage-controlled current source. The node 'Vgs,5' is connected to the gate-source voltage of a transistor, while 'Vout' is the output node. The diagram is used to analyze the loop gain of the circuit.\nimage_name:(c)\ndescription:The circuit is a small-signal model used to analyze the loop gain L = -vr/vt. It includes MOSFET devices and capacitors to model parasitic effects in the feedback loop.\n\nFig. 5.13 (a) A unity-gain feedback circuit. (b) Its small-signal equivalent. (c) The small-signal circuit for finding the loop gain, $L=-v_{r} / v_{t}$.\n\nGiven the infinite impedance looking into the gate of $Q_{5}$ at dc, the small-signal gate voltage is\n\n$$\n\\mathrm{v}_{\\mathrm{g}, 5}=-\\mathrm{g}_{\\mathrm{m}, 1} \\mathrm{v}_{\\mathrm{t}}\\left(\\mathrm{r}_{\\mathrm{ds}, 1}| | \\mathrm{r}_{\\mathrm{ds}, 3}\\right)\n$$\n\nThe returned voltage is then determined by voltage division:\n\n$$\nv_{r}=v_{g, 5}\\left(\\frac{g_{m, 5}}{g_{m, 5}+1 / r_{d s, 5}+g_{m b, 5}}\\right)=-\\left[\\frac{g_{m, 1}\\left(r_{d s, 1}| | r_{d s, 3}\\right) g_{m, 5}}{g_{m, 5}+1 / r_{d s, 5}+g_{m b, 5}}\\right] v_{t}\n$$\n\nThus, the loop gain at dc is\n\n$$\n\\mathrm{L}=\\frac{\\mathrm{g}_{\\mathrm{m}, 1}\\left(\\mathrm{r}_{\\mathrm{ds}, 1}| | \\mathrm{r}_{\\mathrm{ds}, 3}\\right) \\mathrm{g}_{\\mathrm{m}, 5}}{\\mathrm{~g}_{\\mathrm{m}, 5}+1 / \\mathrm{r}_{\\mathrm{ds}, 5}+\\mathrm{g}_{\\mathrm{mb}, 5}}\n$$\n\nThe high-frequency analysis is left as an exercise, with Chapter 4's common-source amplifier high-frequency analysis as a useful reference.\n\nThis method is also valuable for computer circuit simulations to accurately determine loop gain. However, it must be applied only to the small-signal equivalent circuit. In transistor circuits, dc biasing connections should not be broken, as this would alter small-signal parameters. In simulations, this can be achieved using a large ideal inductance, as shown in Fig. 5.14, which acts as a short at dc and an open circuit at relevant frequencies. A test signal can then be introduced via a large coupling capacitor."
},
{
    "text": "To determine the loop gain of a feedback circuit, the loop is interrupted, a test signal (either voltage or current) is introduced, and the signal returned to the opposite side of the break is observed. This method is depicted in Fig. 5.11. Specifically, for any small-signal feedback circuit:\n\n1. Set all independent sources in the circuit, including the input source, to zero. Zeroing a voltage source involves replacing it with a short circuit (an ideal voltage source of 0 V). Zeroing a current source involves replacing it with an open circuit (an ideal current source of 0 A).\n2. Interrupt the loop. Determine the impedance at the break point, $Z_{t}$, and terminate the loop with this impedance, as illustrated in Fig. 5.11.\n3. Insert a test signal (either voltage, $\\mathrm{v}_{\\mathrm{t}}$, or current, $\\mathrm{i}_{\\mathrm{t}}$) into the loop at the break and measure the returned signal: either the voltage across $Z_{t}$, $v_{r}$, or the current through $Z_{t}$, $i_{r}$. The loop gain is then calculated as\n\n$$\n\\begin{equation*}\nL=-\\frac{v_{r}}{v_{t}} \\text { (for voltage test signals) or }-\\frac{i_{r}}{i_{t}} \\text { (for current test signals). } \\tag{5.53}\n\\end{equation*}\n$$\n\nimage_name:Fig. 5.11\ndescription:The circuit is used to determine the loop gain L by breaking the loop and inserting a test signal. The loop gain is calculated as L = -Vr/Vt or -Ir/It. The diagram shows a series of blocks, each containing a resistor, capacitor, and a voltage-controlled voltage source, connected in a loop with a test impedance Zt and test voltage Vt.\n\nFig. 5.11 Illustration of determining the loop gain, L, by breaking the loop.\n\nThe critical step is step 2. While the loop can be broken at any point, it is convenient to do so at an ideal voltage or current source, ensuring the terminating impedance does not affect the result and can thus be omitted. Alternatively, a point in the loop where the terminating impedance is easily determined can be chosen.\n\nThe loop gain obtained through this method is an approximation, as it ignores the possibility of signals circulating in the opposite direction around the loop. This approximation is accurate provided the gain in the forward direction (clockwise in Fig. 5.11) significantly exceeds the gain in the opposite direction (counterclockwise in Fig. 5.11). This is typically the case in the circuits of interest, where feedback is used to trade high gain for other beneficial properties, as discussed in Section 5.1.\n\n#### EXAMPLE 5.8\n\nCalculate the loop gain, $L(s)$, and closed-loop gain, $A_{C L}(s)$, for the inverting opamp configuration shown in Fig. 5.10, assuming the load impedance, $Z_{L}$, is infinite. The opamp has a voltage gain $A_{v}$ and an infinite input impedance.\n\n#### Solution\n\nThe small-signal equivalent circuit is shown in Fig. 5.12(a). We apply the loop gain determination procedure to this circuit.\n\n1. The input source is zeroed by grounding $\\mathrm{v}_{\\mathrm{s}}$.\n2. The loop is broken at the opamp input terminals, chosen due to the infinite input impedance, simplifying the determination of $Z_{t}$.\n3. The test signal $v_{t}$ is injected into the modified circuit, Fig. 5.12(b). The returned voltage is determined using nodal analysis,\n\n$$\nv_{r}=-A_{v}(s) \\frac{Z_{1}}{Z_{1}+Z_{2}+Z_{0}} v_{t}\n$$\n\nThus, the loop gain is\n\n$$\nL(s)=-\\frac{v_{r}}{v_{t}}=A_{v}(s) \\frac{Z_{1}}{Z_{1}+Z_{2}+Z_{0}}\n$$\n\nThe normalized closed-loop gain is\n\n$$\n\\frac{L(s)}{1+L(s)}=\\frac{A_{v}(s) Z_{1}}{A_{v}(s) Z_{1}+Z_{1}+Z_{2}+Z_{o}}\n$$\n\nThe desired gain for this circuit is $1 / \\beta=-\\left(Z_{2} / Z_{1}\\right)$, so the closed-loop gain is given by (5.51),\n\n$$\nA_{\\mathrm{CL}}(\\mathrm{~s})=-\\frac{Z_{2}}{Z_{1}} \\cdot \\frac{A_{v}(s) Z_{1}}{A_{v}(s) Z_{1}+Z_{1}+Z_{2}+Z_{o}}\n$$\n\nAs long as $A_{v}$ is much greater than $\\left(Z_{1}+Z_{2}+Z_{0}\\right) / Z_{1}$, the closed-loop gain will closely approximate the desired gain. This result can also be obtained through direct nodal analysis of Fig. 5.12(a) without breaking the loop.\n(a)\nimage_name:Fig. 5.12 (b)\ndescription:\n[\nname: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\nname: Z1, type: Resistor, value: Z1, ports: {N1: Vs, N2: -Vi}\nname: Z2, type: Resistor, value: Z2, ports: {N1: -Vi, N2: Vout}\nname: Opamp, type: OpAmp, value: Av(s), ports: {InP: GND, InN: -Vi, OutP: Vout}\nname: Zo, type: Resistor, value: Zo, ports: {N1: Vout, N2: GND}\n]\nextrainfo:This circuit represents a small-signal model of an inverting op-amp configuration with a feedback loop. The loop is broken at the indicated point for analysis of the loop gain.\n\n(b)\nimage_name:Fig. 5.12 (b)\ndescription:\n[\nname: Vs, type: VoltageSource, value: 0, ports: {Np: GND, Nn: Vs}\nname: Z1, type: Resistor, value: Z1, ports: {N1: Vr, N2: GND}\nname: Z2, type: Resistor, value: Z2, ports: {N1: Vr, N2: Vout}\nname: Av(s)Vi, type: VoltageControlledVoltageSource, ports: {Np: Vout, Nn: GND}\nname: Zo, type: Resistor, value: Zo, ports: {N1: Av(s)*Vi, N2: Vout}\n]\nextrainfo:This circuit represents a configuration for determining the loop gain L = -vr/vt of a small-signal model. It includes a feedback loop broken at a specific point for analysis. The voltage source Vs is set to 0, indicating a test condition for loop gain measurement.\n\nFig. 5.12 (a) Small-signal model of an inverting opamp configuration. (b) Circuit for determining the loop gain, $L=-v_{r} / v_{t}$.\n\n#### EXAMPLE 5.9\n\nDetermine the loop gain of the differential pair feedback circuit shown in Fig. 5.13(a).\n\n#### Solution\n\nWe focus on the small-signal response, starting with the small-signal equivalent circuit shown in Fig. 5.13(b), assuming $Q_{1,2}$ and $Q_{3,4}$ are matched device pairs. A simplified small-signal model of the differential pair with an active load is used; for full details, refer to Chapter 3.\n\nThe circuit for calculating the loop gain is shown in Fig. 5.13(c).\n\n1. The input source is zeroed by grounding $\\mathrm{v}_{\\mathrm{in}}$.\n2. The loop is broken at the gate of $M 2$, chosen because the terminating impedance, $Z_{t}$, is simply the input capacitance to the differential pair. In Fig. 5.13(c), this capacitance is in parallel with the larger $\\mathrm{C}_{\\mathrm{L}}$, minimizing the impact of any parasitic components on the analysis.\n3. A test source, $\\mathrm{v}_{\\mathrm{t}}$, is introduced at the break point. The circuit in Fig. 5.13(c) is then analyzed to find $\\mathrm{L}=-\\left(\\mathrm{v}_{\\mathrm{r}} / \\mathrm{v}_{\\mathrm{t}}\\right)$. The dc analysis proceeds as follows.\nimage_name:(a)\ndescription:The circuit diagram (a) represents a unity-gain feedback circuit with two NMOS transistors (Q1 and Q2) and three PMOS transistors (Q3, Q4, and Q5). The circuit is configured to provide negative feedback with the output voltage 'Vout' being fed back to the gates of the PMOS transistors. The capacitor 'CL' is the load capacitance at the output, and 'Cgs,1/2' and 'Cgs,5' are gate-source capacitances. The circuit includes voltage-controlled current sources and several resistive and capacitive elements to stabilize the feedback loop.\nimage_name:(b)\ndescription:The circuit diagram represents a small-signal equivalent model for a unity-gain feedback circuit. It includes capacitors, resistors, and a voltage-controlled current source. The node 'Vgs,5' is connected to the gate-source voltage of a transistor, while 'Vout' is the output node. The diagram is used to analyze the loop gain of the circuit.\nimage_name:(c)\ndescription:The circuit is a small-signal model used to analyze the loop gain L = -vr/vt. It includes MOSFET devices and capacitors to model parasitic effects in the feedback loop.\n\nFig. 5.13 (a) A unity-gain feedback circuit. (b) Its small-signal equivalent. (c) The small-signal circuit for finding the loop gain, $L=-v_{r} / v_{t}$.\n\nGiven the infinite impedance looking into the gate of $Q_{5}$ at dc, the small-signal gate voltage is\n\n$$\n\\mathrm{v}_{\\mathrm{g}, 5}=-\\mathrm{g}_{\\mathrm{m}, 1} \\mathrm{v}_{\\mathrm{t}}\\left(\\mathrm{r}_{\\mathrm{ds}, 1}| | \\mathrm{r}_{\\mathrm{ds}, 3}\\right)\n$$\n\nThe returned voltage is then determined by voltage division,\n\n$$\nv_{r}=v_{g, 5}\\left(\\frac{g_{m, 5}}{g_{m, 5}+1 / r_{d s, 5}+g_{m b, 5}}\\right)=-\\left[\\frac{g_{m, 1}\\left(r_{d s, 1}| | r_{d s, 3}\\right) g_{m, 5}}{g_{m, 5}+1 / r_{d s, 5}+g_{m b, 5}}\\right] v_{t}\n$$\n\nThus, the loop gain at dc is\n\n$$\n\\mathrm{L}=\\frac{\\mathrm{g}_{\\mathrm{m}, 1}\\left(\\mathrm{r}_{\\mathrm{ds}, 1}| | \\mathrm{r}_{\\mathrm{ds}, 3}\\right) \\mathrm{g}_{\\mathrm{m}, 5}}{\\mathrm{~g}_{\\mathrm{m}, 5}+1 / \\mathrm{r}_{\\mathrm{ds}, 5}+\\mathrm{g}_{\\mathrm{mb}, 5}}\n$$\n\nThe high-frequency analysis is left as an exercise, with Chapter 4's common-source amplifier analysis as a useful reference.\n\nThis method is also highly effective for computer simulations to accurately determine loop gain. However, it must be applied only to the small-signal equivalent circuit. In transistor circuits, dc biasing connections should not be disrupted, as this would alter small-signal parameters. In simulations, this can be achieved using a large ideal inductance, as shown in Fig. 5.14. The large inductance acts as a short at dc, preserving biasing, but as an open circuit at relevant frequencies, allowing a test signal to be introduced via a large coupling capacitor."
},
{
    "text": "To determine the loop gain of a feedback circuit, the loop is interrupted, a test signal (either voltage or current) is introduced, and the signal returned to the opposite side of the break is observed. This process is depicted in Fig. 5.11. Specifically, for any small-signal feedback circuit:\n\n1. Set all independent sources in the circuit to zero, including the input source. Zeroing a voltage source involves replacing it with a short circuit (an ideal voltage source of 0 V). Zeroing a current source involves replacing it with an open circuit (an ideal current source of 0 A).\n2. Interrupt the loop. Determine the impedance at the break point, $Z_{t}$, and terminate the loop with this impedance, as illustrated in Fig. 5.11.\n3. Insert a test signal (either voltage, $\\mathrm{v}_{\\mathrm{t}}$, or current, $\\mathrm{i}_{\\mathrm{t}}$) into the loop at the break and measure the returned signal: either the voltage across $Z_{t}, v_{r}$, or the current through $Z_{t}, i_{r}$. The loop gain is then calculated as\n\n$$\n\\begin{equation*}\nL=-\\frac{v_{r}}{v_{t}} \\text { (for voltage test signals) or }-\\frac{i_{r}}{i_{t}} \\text { (for current test signals). } \\tag{5.53}\n\\end{equation*}\n$$\n\nimage_name:Fig. 5.11\ndescription:The circuit is used to determine the loop gain L by breaking the loop and inserting a test signal. The loop gain is calculated as L = -Vr/Vt or -Ir/It. The diagram shows a series of blocks, each containing a resistor, capacitor, and a voltage-controlled voltage source, connected in a loop with a test impedance Zt and test voltage Vt.\n\nFig. 5.11 Illustrating the determination of loop gain, L, by breaking the loop.\n\nThe critical step is step 2. While the loop can be broken at any point, it is advantageous to do so at an ideal voltage or current source, ensuring the terminating impedance does not affect the result and can thus be omitted. Alternatively, a point in the loop where the terminating impedance is easily determined can be chosen.\n\nThe loop gain obtained through this method is an approximation, as it disregards the possibility of signals circulating in the opposite direction around the loop. This approximation is valid as long as the gain in the forward direction (clockwise in Fig. 5.11) significantly exceeds the gain in the opposite direction (counterclockwise in Fig. 5.11). This condition typically holds in the circuits of interest, where feedback is employed to trade high gain for other beneficial attributes, as discussed in Section 5.1.\n\nKey Point: The loop gain, $\\mathrm{L}(\\omega)$, can be estimated by zeroing the input, breaking the loop, and injecting a test signal. This approximation is accurate in typical scenarios where high forward gain around the loop is exchanged for increased bandwidth, accuracy, etc.\n\n#### EXAMPLE 5.8\n\nDetermine the loop gain, $L(s)$, and closed-loop gain, $A_{C L}(s)$, for the inverting opamp configuration shown in Fig. 5.10, assuming the load impedance, $Z_{L}$, is infinite. The opamp has a voltage gain $A_{v}$ and an infinite input impedance.\n\n#### Solution\n\nThe small-signal equivalent circuit is presented in Fig. 5.12(a). We apply the loop gain determination procedure to this circuit.\n\n1. The input source is zeroed by grounding $\\mathrm{v}_{\\mathrm{s}}$.\n2. The loop is broken at the opamp input terminals, chosen due to the infinite input impedance, simplifying the determination of $Z_{t}$.\n3. The test signal $v_{t}$ is injected into the modified circuit, Fig. $5.12(b)$. The returned voltage is determined via nodal analysis:\n\n$$\nv_{r}=-A_{v}(s) \\frac{Z_{1}}{Z_{1}+Z_{2}+Z_{0}} v_{t}\n$$\n\nThus, the loop gain is\n\n$$\nL(s)=-\\frac{v_{r}}{v_{t}}=A_{v}(s) \\frac{Z_{1}}{Z_{1}+Z_{2}+Z_{0}}\n$$\n\nThe normalized closed-loop gain is\n\n$$\n\\frac{L(s)}{1+L(s)}=\\frac{A_{v}(s) Z_{1}}{A_{v}(s) Z_{1}+Z_{1}+Z_{2}+Z_{o}}\n$$\n\nThe desired gain for this circuit is $1 / \\beta=-\\left(Z_{2} / Z_{1}\\right)$, so the closed-loop gain, as given by (5.51), is\n\n$$\nA_{\\mathrm{CL}}(\\mathrm{~s})=-\\frac{Z_{2}}{Z_{1}} \\cdot \\frac{A_{v}(s) Z_{1}}{A_{v}(s) Z_{1}+Z_{1}+Z_{2}+Z_{o}}\n$$\n\nProvided $A_{v}$ is much greater than $\\left(Z_{1}+Z_{2}+Z_{0}\\right) / Z_{1}$, the closed-loop gain will approximate the desired gain. The same result can be derived through direct nodal analysis of Fig. 5.12(a) without breaking the loop.\n(a)\nimage_name:Fig. 5.12 (b)\ndescription:\n[\nname: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\nname: Z1, type: Resistor, value: Z1, ports: {N1: Vs, N2: -Vi}\nname: Z2, type: Resistor, value: Z2, ports: {N1: -Vi, N2: Vout}\nname: Opamp, type: OpAmp, value: Av(s), ports: {InP: GND, InN: -Vi, OutP: Vout}\nname: Zo, type: Resistor, value: Zo, ports: {N1: Vout, N2: GND}\n]\nextrainfo:This circuit represents a small-signal model of an inverting op-amp configuration with a feedback loop. The loop is broken at the indicated point for analysis of the loop gain.\n\n(b)\nimage_name:Fig. 5.12 (b)\ndescription:\n[\nname: Vs, type: VoltageSource, value: 0, ports: {Np: GND, Nn: Vs}\nname: Z1, type: Resistor, value: Z1, ports: {N1: Vr, N2: GND}\nname: Z2, type: Resistor, value: Z2, ports: {N1: Vr, N2: Vout}\nname: Av(s)Vi, type: VoltageControlledVoltageSource, ports: {Np: Vout, Nn: GND}\nname: Zo, type: Resistor, value: Zo, ports: {N1: Av(s)*Vi, N2: Vout}\n]\nextrainfo:This circuit represents a configuration for determining the loop gain L = -vr/vt of a small-signal model. It includes a feedback loop broken at a specific point for analysis. The voltage source Vs is set to 0, indicating a test condition for loop gain measurement.\n\nFig. 5.12 (a) Small-signal model of an inverting opamp configuration. (b) Circuit for determining the loop gain, $L=-v_{r} / v_{t}$.\n\n#### EXAMPLE 5.9\n\nCalculate the loop gain of the differential pair feedback circuit shown in Fig. 5.13(a).\n\n#### Solution\n\nWe focus on the small-signal response, starting with the small-signal equivalent circuit depicted in Fig. 5.13(b), assuming $Q_{1,2}$ and $Q_{3,4}$ are matched device pairs. A simplified small-signal model of the differential pair with an active load is used; for full details, refer to Chapter 3.\n\nThe circuit for loop gain determination is shown in Fig. 5.13(c).\n\n1. The input source is zeroed by grounding $\\mathrm{v}_{\\mathrm{in}}$.\n2. The loop is broken at the gate of $M 2$, chosen because the terminating impedance, $Z_{t}$, is simply the input capacitance of the differential pair. In Fig. 5.13(c), this capacitance is in parallel with the larger $\\mathrm{C}_{\\mathrm{L}}$, minimizing the impact of any parasitic components on the analysis.\n3. A test source, $\\mathrm{v}_{\\mathrm{t}}$, is introduced at the break point. The circuit in Fig. $5.13(c)$ is then analyzed to find $\\mathrm{L}=-\\left(\\mathrm{v}_{\\mathrm{r}} / \\mathrm{v}_{\\mathrm{t}}\\right)$. The dc analysis proceeds as follows.\nimage_name:(a)\ndescription:The circuit diagram (a) represents a unity-gain feedback circuit with two NMOS transistors (Q1 and Q2) and three PMOS transistors (Q3, Q4, and Q5). The circuit is configured to provide negative feedback with the output voltage 'Vout' being fed back to the gates of the PMOS transistors. The capacitor 'CL' is the load capacitance at the output, and 'Cgs,1/2' and 'Cgs,5' are gate-source capacitances. The circuit includes voltage-controlled current sources and several resistive and capacitive elements to stabilize the feedback loop.\nimage_name:(b)\ndescription:The circuit diagram represents a small-signal equivalent model for a unity-gain feedback circuit. It includes capacitors, resistors, and a voltage-controlled current source. The node 'Vgs,5' is connected to the gate-source voltage of a transistor, while 'Vout' is the output node. The diagram is used to analyze the loop gain of the circuit.\nimage_name:(c)\ndescription:The circuit is a small-signal model used to analyze the loop gain L = -vr/vt. It includes MOSFET devices and capacitors to model parasitic effects in the feedback loop.\n\nFig. 5.13 (a) A unity-gain feedback circuit. (b) Its small-signal equivalent. (c) The small-signal circuit for finding the loop gain, $L=-v_{r} / v_{t}$.\n\nGiven the infinite impedance looking into the gate of $Q_{5}$ at dc, the small-signal gate voltage is\n\n$$\n\\mathrm{v}_{\\mathrm{g}, 5}=-\\mathrm{g}_{\\mathrm{m}, 1} \\mathrm{v}_{\\mathrm{t}}\\left(\\mathrm{r}_{\\mathrm{ds}, 1}| | \\mathrm{r}_{\\mathrm{ds}, 3}\\right)\n$$\n\nThe returned voltage is then determined by voltage division,\n\n$$\nv_{r}=v_{g, 5}\\left(\\frac{g_{m, 5}}{g_{m, 5}+1 / r_{d s, 5}+g_{m b, 5}}\\right)=-\\left[\\frac{g_{m, 1}\\left(r_{d s, 1}| | r_{d s, 3}\\right) g_{m, 5}}{g_{m, 5}+1 / r_{d s, 5}+g_{m b, 5}}\\right] v_{t}\n$$\n\nThus, the loop gain at dc is\n\n$$\n\\mathrm{L}=\\frac{\\mathrm{g}_{\\mathrm{m}, 1}\\left(\\mathrm{r}_{\\mathrm{ds}, 1}| | \\mathrm{r}_{\\mathrm{ds}, 3}\\right) \\mathrm{g}_{\\mathrm{m}, 5}}{\\mathrm{~g}_{\\mathrm{m}, 5}+1 / \\mathrm{r}_{\\mathrm{ds}, 5}+\\mathrm{g}_{\\mathrm{mb}, 5}}\n$$\n\nThe high-frequency analysis is left as an exercise, with Chapter 4's common-source amplifier high-frequency analysis serving as a useful reference.\n\nThis method is also valuable for computer circuit simulations, providing accurate loop gain measurements. However, it must be applied only to the small-signal equivalent circuit. In transistor circuits, dc biasing connections should not be disrupted, as this would alter small-signal parameters. In simulations, a large ideal inductance can be used to maintain dc biasing while acting as an open circuit at relevant frequencies, allowing a test signal to be introduced via a large coupling capacitor."
},
{
    "text": "To determine the loop gain of a feedback circuit, the loop is interrupted, a test signal (either voltage or current) is introduced, and the signal returned to the other side of the break is observed. This process is depicted in Fig. 5.11. Specifically, for any small-signal feedback circuit:\n\n1. Set all independent sources in the circuit, including the input source, to zero. Zeroing a voltage source involves replacing it with a short circuit (an ideal voltage source of 0 V). Zeroing a current source involves replacing it with an open circuit (an ideal current source of 0 A).\n2. Interrupt the loop. Determine the impedance at the break point, $Z_{t}$, and terminate the loop with this impedance, as illustrated in Fig. 5.11.\n3. Insert a test signal (either voltage, $\\mathrm{v}_{\\mathrm{t}}$, or current, $\\mathrm{i}_{\\mathrm{t}}$) into the loop at the break and measure the returned signal: either the voltage across $Z_{t}$, $v_{r}$, or the current through $Z_{t}$, $i_{r}$. The loop gain is then calculated as\n\n$$\n\\begin{equation*}\nL=-\\frac{v_{r}}{v_{t}} \\text { (for voltage test signals) or }-\\frac{i_{r}}{i_{t}} \\text { (for current test signals). } \\tag{5.53}\n\\end{equation*}\n$$\n\nimage_name:Fig. 5.11\ndescription:The circuit is used to determine the loop gain L by breaking the loop and inserting a test signal. The loop gain is calculated as L = -Vr/Vt or -Ir/It. The diagram shows a series of blocks, each containing a resistor, capacitor, and a voltage-controlled voltage source, connected in a loop with a test impedance Zt and test voltage Vt.\n\nFig. 5.11 Illustration of determining the loop gain, L, by breaking the loop.\n\nThe crucial step is step 2. While the loop can be broken at any point, it is convenient to do so at an ideal voltage or current source, ensuring the terminating impedance does not affect the result and can thus be omitted. Alternatively, a point in the loop where the terminating impedance is easily determined can be chosen.\n\nThe loop gain obtained through this method is an approximation, as it overlooks the possibility of signals circulating in the opposite direction around the loop. This approximation is accurate provided the gain in the forward direction (clockwise in Fig. 5.11) significantly exceeds the gain in the opposite direction (counterclockwise in Fig. 5.11). This condition typically holds in the circuits of interest, where feedback is employed to trade high gain for other beneficial properties, as discussed in Section 5.1.\n\n#### EXAMPLE 5.8\n\nCalculate the loop gain, $L(s)$, and closed-loop gain, $A_{C L}(s)$, for the inverting opamp configuration shown in Fig. 5.10, assuming the load impedance, $Z_{L}$, is infinite. The opamp has a voltage gain $A_{v}$ and an infinite input impedance.\n\n#### Solution\n\nThe small-signal equivalent circuit is shown in Fig. 5.12(a). We apply the loop gain determination procedure to this circuit.\n\n1. The input source is zeroed by grounding $\\mathrm{v}_{\\mathrm{s}}$.\n2. The loop is broken at the opamp input terminals, chosen due to the infinite input impedance, simplifying the determination of $Z_{t}$.\n3. The test signal $v_{t}$ is injected into the modified circuit, Fig. $5.12(b)$. The returned voltage is found using nodal analysis,\n\n$$\nv_{r}=-A_{v}(s) \\frac{Z_{1}}{Z_{1}+Z_{2}+Z_{0}} v_{t}\n$$\n\nThus, the loop gain is\n\n$$\nL(s)=-\\frac{v_{r}}{v_{t}}=A_{v}(s) \\frac{Z_{1}}{Z_{1}+Z_{2}+Z_{0}}\n$$\n\nThe normalized closed-loop gain is\n\n$$\n\\frac{L(s)}{1+L(s)}=\\frac{A_{v}(s) Z_{1}}{A_{v}(s) Z_{1}+Z_{1}+Z_{2}+Z_{o}}\n$$\n\nThe desired gain for this circuit is $1 / \\beta=-\\left(Z_{2} / Z_{1}\\right)$, so the closed-loop gain is given by (5.51),\n\n$$\nA_{\\mathrm{CL}}(\\mathrm{~s})=-\\frac{Z_{2}}{Z_{1}} \\cdot \\frac{A_{v}(s) Z_{1}}{A_{v}(s) Z_{1}+Z_{1}+Z_{2}+Z_{o}}\n$$\n\nAs long as $A_{v}$ is much greater than $\\left(Z_{1}+Z_{2}+Z_{0}\\right) / Z_{1}$, the closed-loop gain will closely approximate the desired gain. The same result can be achieved through direct nodal analysis of Fig. 5.12(a) without breaking the loop.\n(a)\nimage_name:Fig. 5.12 (b)\ndescription:\n[\nname: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\nname: Z1, type: Resistor, value: Z1, ports: {N1: Vs, N2: -Vi}\nname: Z2, type: Resistor, value: Z2, ports: {N1: -Vi, N2: Vout}\nname: Opamp, type: OpAmp, value: Av(s), ports: {InP: GND, InN: -Vi, OutP: Vout}\nname: Zo, type: Resistor, value: Zo, ports: {N1: Vout, N2: GND}\n]\nextrainfo:This circuit represents a small-signal model of an inverting op-amp configuration with a feedback loop. The loop is broken at the indicated point for analysis of the loop gain.\n\n(b)\nimage_name:Fig. 5.12 (b)\ndescription:\n[\nname: Vs, type: VoltageSource, value: 0, ports: {Np: GND, Nn: Vs}\nname: Z1, type: Resistor, value: Z1, ports: {N1: Vr, N2: GND}\nname: Z2, type: Resistor, value: Z2, ports: {N1: Vr, N2: Vout}\nname: Av(s)Vi, type: VoltageControlledVoltageSource, ports: {Np: Vout, Nn: GND}\nname: Zo, type: Resistor, value: Zo, ports: {N1: Av(s)*Vi, N2: Vout}\n]\nextrainfo:This circuit represents a configuration for determining the loop gain L = -vr/vt of a small-signal model. It includes a feedback loop broken at a specific point for analysis. The voltage source Vs is set to 0, indicating a test condition for loop gain measurement.\n\nFig. 5.12 (a) Small-signal model of an inverting opamp configuration. (b) Circuit for determining the loop gain, $L=-v_{r} / v_{t}$.\n\n#### EXAMPLE 5.9\n\nDetermine the loop gain of the differential pair feedback circuit shown in Fig. 5.13(a).\n\n#### Solution\n\nWe focus on the small-signal response, starting with the small-signal equivalent circuit shown in Fig. 5.13(b), where $Q_{1,2}$ and $Q_{3,4}$ are assumed to be matched device pairs. A simplified small-signal model of the differential pair with an active load is used; detailed information can be found in Chapter 3.\n\nThe circuit for loop gain determination is shown in Fig. 5.13(c).\n\n1. The input source is zeroed by grounding $\\mathrm{v}_{\\mathrm{in}}$.\n2. The loop is broken at the gate of $M 2$, chosen because the terminating impedance, $Z_{t}$, is simply the input capacitance to the differential pair. In Fig. 5.13(c), this capacitance is paralleled with the larger $\\mathrm{C}_{\\mathrm{L}}$, minimizing the impact of any parasitic components on the analysis.\n3. A test source, $\\mathrm{v}_{\\mathrm{t}}$, is introduced at the break point. The circuit in Fig. $5.13(c)$ is then analyzed to find $\\mathrm{L}=-\\left(\\mathrm{v}_{\\mathrm{r}} / \\mathrm{v}_{\\mathrm{t}}\\right)$. The dc analysis proceeds as follows.\nimage_name:(a)\ndescription:The circuit diagram (a) represents a unity-gain feedback circuit with two NMOS transistors (Q1 and Q2) and three PMOS transistors (Q3, Q4, and Q5). The circuit is configured to provide negative feedback with the output voltage 'Vout' being fed back to the gates of the PMOS transistors. The capacitor 'CL' is the load capacitance at the output, and 'Cgs,1/2' and 'Cgs,5' are gate-source capacitances. The circuit includes voltage-controlled current sources and several resistive and capacitive elements to stabilize the feedback loop.\nimage_name:(b)\ndescription:The circuit diagram represents a small-signal equivalent model for a unity-gain feedback circuit. It includes capacitors, resistors, and a voltage-controlled current source. The node 'Vgs,5' is connected to the gate-source voltage of a transistor, while 'Vout' is the output node. The diagram is used to analyze the loop gain of the circuit.\nimage_name:(c)\ndescription:The circuit is a small-signal model used to analyze the loop gain L = -vr/vt. It includes MOSFET devices and capacitors to model parasitic effects in the feedback loop.\n\nFig. 5.13 (a) A unity-gain feedback circuit. (b) Its small-signal equivalent. (c) The small-signal circuit for finding the loop gain, $L=-v_{r} / v_{t}$.\n\nAt dc, the impedance looking into the gate of $Q_{5}$ is infinite, so the small-signal gate voltage is\n\n$$\n\\mathrm{v}_{\\mathrm{g}, 5}=-\\mathrm{g}_{\\mathrm{m}, 1} \\mathrm{v}_{\\mathrm{t}}\\left(\\mathrm{r}_{\\mathrm{ds}, 1}| | \\mathrm{r}_{\\mathrm{ds}, 3}\\right)\n$$\n\nThe returned voltage is then determined by voltage division,\n\n$$\nv_{r}=v_{g, 5}\\left(\\frac{g_{m, 5}}{g_{m, 5}+1 / r_{d s, 5}+g_{m b, 5}}\\right)=-\\left[\\frac{g_{m, 1}\\left(r_{d s, 1}| | r_{d s, 3}\\right) g_{m, 5}}{g_{m, 5}+1 / r_{d s, 5}+g_{m b, 5}}\\right] v_{t}\n$$\n\nThus, the loop gain at dc is\n\n$$\n\\mathrm{L}=\\frac{\\mathrm{g}_{\\mathrm{m}, 1}\\left(\\mathrm{r}_{\\mathrm{ds}, 1}| | \\mathrm{r}_{\\mathrm{ds}, 3}\\right) \\mathrm{g}_{\\mathrm{m}, 5}}{\\mathrm{~g}_{\\mathrm{m}, 5}+1 / \\mathrm{r}_{\\mathrm{ds}, 5}+\\mathrm{g}_{\\mathrm{mb}, 5}}\n$$\n\nThe high-frequency analysis is left as an exercise, with Chapter 4's common-source amplifier high-frequency analysis providing a useful reference.\n\nThis method is also valuable for computer circuit simulations, enabling precise loop gain determination. However, it must be applied exclusively to the small-signal equivalent circuit. In transistor circuits, dc biasing connections should not be disrupted, as this would alter small-signal parameters. In simulations, a very large ideal inductance can be used, as shown in Fig. 5.14. This inductance acts as a short at dc, preserving biasing, but as an open circuit at frequencies of interest, allowing a test signal to be introduced via a large coupling capacitor."
},
{
    "text": "The noninverting op-amp configuration depicted in Fig. 5.15 serves as a prototypical example of a feedback amplifier. It is assumed that the op-amp has a frequency-dependent voltage gain, represented by \\( A_v(s) \\), along with complex input and output impedances denoted as \\( Z_i(s) \\) and \\( Z_o(s) \\), respectively. A comprehensive circuit model can be found in Fig. 5.16. It's worth noting that the circuit depicted in Fig. 5.14 employs a large ideal inductance to open the loop and introduces a test signal through a large coupling capacitor to ascertain the small-signal loop gain in simulations without disrupting the DC biasing of the circuit.\n\nFig. 5.15 presents a generalized noninverting feedback operational amplifier setup. The small-signal model of this noninverting feedback amplifier is shown in Fig. 5.16, which includes an operational amplifier with feedback components \\( Z_1 \\) and \\( Z_2 \\). The input signal is applied via a voltage source \\( V_s \\) and resistor \\( Z_s \\), and the output is measured across load resistor \\( Z_L \\). The op-amp features a small-signal open-circuit gain \\( A_v(s) \\) and is configured with input and feedback resistors \\( Z_i \\) and \\( Z_o \\). The gain \\( A_v \\) represents the (small-signal) open-circuit gain of the op-amp and is therefore distinct from the forward-path gain \\( A \\) of the feedback amplifier, which encompasses all loading effects.\n\nExample 5.10 involves an op-amp with specified characteristics, including an input capacitance of 0.5 pF, an output resistance of \\( 500 \\Omega \\), a DC gain of 80 dB, and a unity-gain frequency of 100 MHz. The op-amp's phase response is -105 degrees at the unity-gain frequency. The task is to determine the op-amp model components: \\( Z_i \\), \\( Z_o \\), and \\( A_v(s) \\).\n\nThe solution to Example 5.10 provides the input and output impedances directly from the specifications and calculates the gain using a second-order model. The DC gain of 80 dB corresponds to \\( A_{v0} = 10^4 \\). The unity-gain frequency \\( \\omega_{ta} \\) is used to find the dominant pole frequency \\( \\omega_{p1} \\) and the non-dominant pole frequency \\( \\omega_{eq} \\).\n\nExample 5.11 involves using the op-amp from Example 5.10 in a unity-gain configuration to drive a load of \\( Z_L = 200 \\Omega \\). The goal is to find the DC gain error, phase margin, and bandwidth. The unity-gain configuration is a special case of the noninverting operational amplifier where \\( Z_1 = \\infty \\) and \\( Z_2 = 0 \\). The loop gain \\( L(s) \\) is calculated and used to find the closed-loop gain \\( A_{CL}(s) \\). The gain error is determined to be 0.03%, and the phase margin is found to be \\( 85.6^{\\circ} \\). The bandwidth is approximated using a first-order approximation of the op-amp gain.\n\nExample 5.12 addresses the output impedance of the closed-loop amplifier from Example 5.11. By equating the closed-loop gain to one-half the value obtained with \\( Z_L = \\infty \\), the output impedance \\( Z_{out} \\) is calculated to be approximately \\( 0.05 \\Omega \\).\n\nA key point discussed is that feedback in integrated circuits, particularly in CMOS, effectively reduces the output impedance of an amplifier by a factor roughly equal to the loop gain. This reduction in output impedance is crucial in CMOS circuits where low output impedance is desirable to minimize power dissipation. Noninverting amplifiers utilize voltage feedback because the signal subtracted from the source is a voltage, specifically the voltage at the negative op-amp terminal. This setup ensures that the op-amp input terminals are subjected to very small differential voltages, resulting in minimal input current requirements."
},
{
    "text": "---[Rephrased Text]---\n\nA quintessential feedback amplifier example is depicted in Fig. 5.15, showcasing a noninverting operational amplifier (opamp) circuit with a frequency-dependent voltage gain, $A_{\\mathrm{v}}(\\mathrm{s})$, and complex input/output impedances denoted by $Z_{i}(\\mathrm{~s})$ and $Z_{o}(s)$. The full circuit model can be seen in Fig. 5.16. It's worth noting that Fig. 5.14 illustrates a loop-broken circuit using a high-value ideal inductor, and it introduces a test signal via a substantial coupling capacitor to assess the small-signal loop gain through simulation, without disrupting the DC biasing.\n\nIn the noninverting feedback opamp configuration in Fig. 5.15, the components include a voltage source Vs, resistors Zs, Z1, Z2, and ZL, and the opamp Av itself, which has the input at InP(Av) and InN(Av) and the output at Vout. \n\nThe small-signal model in Fig. 5.16 includes all these elements along with the additional resistor Zo, and the voltage-controlled voltage source Av(s)*Vi, representing the operational amplifier's small-signal open-circuit gain. \n\nThe text goes on to discuss the opamp model components for an opamp with specified characteristics and derives the expressions for $Z_{i}, Z_{o}$, and $A_{v}(s)$. It then examines the loop gain L(s) for a voltage feedback amplifier in Fig. 5.17 and calculates the gain error, phase margin, and bandwidth for a unity-gain configuration with a load $Z_{L}=200 \\Omega$ in Example 5.11.\n\nIn Example 5.12, the output impedance of the closed-loop amplifier from Example 5.11 is determined, highlighting the effect of feedback in reducing the output impedance significantly, which is a critical feature in CMOS integrated circuits.\n\nLastly, the text touches on the importance of feedback in amplifying current signals and the impact of feedback on output impedance in CMOS circuits, emphasizing its role in achieving low input impedances in current amplifiers.\n\n---[End of Rephrased Text]---"
},
{
    "text": "The generalized noninverting operational amplifier, as illustrated in Fig. 5.15, serves as a typical example of a feedback amplifier. This operational amplifier is presumed to possess a voltage gain, $\\mathrm{A}_{\\mathrm{v}}(\\mathrm{s})$, that varies with frequency, alongside complex input and output impedances denoted by $Z_{i}(\\mathrm{~s})$ and $Z_{o}(s)$, respectively. The complete circuit model is depicted in Fig. 5.16. It's worth mentioning that the circuit represented in Fig. 5.14 employs a substantial ideal inductance to open the loop and introduces a test signal through a large coupling capacitor, enabling the determination of the small-signal loop gain during simulation without干扰到电路的直流偏置。\n\nFig. 5.15 presents a generalized noninverting feedback operational amplifier configuration. The circuit comprises components like voltage source Vs, resistors Zs, Z1, Z2, ZL, and the operational amplifier Av, which has its input and output ports connected as described.\n\nFig. 5.16 shows the small-signal model of a noninverting feedback amplifier, including voltage source Vs, resistors Zs, Zi, Z1, Z2, ZL, Zo, and the voltage-controlled voltage source Av(s)*Vi, representing the operational amplifier's small-signal open-circuit gain.\n\nIn the context of the amplifier's gain, it's important to distinguish between the (small-signal) open-circuit gain $A_{v}$ of the opamp and the forward-path gain $A$ of the feedback amplifier, which encompasses all loading effects.\n\n#### EXAMPLE 5.10\n\nGiven an opamp with specified input capacitance, output resistance, dc gain, unity-gain frequency, and phase response, the task is to determine the opamp model components: $Z_{i}, Z_{o}$, and $A_{v}(s)$.\n\n#### Solution\n\nThe input and output impedances are provided directly in the opamp's specification. The gain model adopted is a second-order model, from which the dominant and non-dominant pole frequencies are calculated.\n\nThe noninverting amplifier's gain under ideal conditions, where the opamp gain is infinite, is derived. To find the loop gain, the circuit in Fig. 5.17 is analyzed, leading to expressions for the loop gain $L(s)$.\n\n#### EXAMPLE 5.11\n\nThis example involves using the opamp from Example 5.10 in a unity-gain configuration to drive a load of $Z_{L}=200 \\Omega$, as shown in Fig. 5.18. The objectives are to find the dc gain error, phase margin, and bandwidth.\n\n#### Solution\n\nIn a unity-gain configuration, the loop gain $L(s)$ is simplified, and the closed-loop gain $A_{C L}(s)$ is calculated. The gain error is determined to be 0.03%, and the phase margin is found to be $85.6^{\\circ}$. The bandwidth is approximated using a first-order approximation of the opamp gain.\n\n#### EXAMPLE 5.12\n\nThe output impedance of the closed-loop amplifier from Example 5.11 is calculated, demonstrating that feedback effectively reduces the output impedance.\n\n#### Key Point\n\nFeedback in CMOS integrated circuits significantly reduces the output impedance of an amplifier, which is particularly beneficial in reducing power dissipation. Noninverting amplifiers utilize voltage feedback, which ensures that the opamp input terminals experience only minimal differential voltages, thus requiring very little input current. This property is especially useful when designing CMOS circuits to amplify current signals, as current feedback can be employed to achieve very low input impedances."
},
{
    "text": "An illustration of a feedback amplifier is depicted in the generalized noninverting opamp configuration presented in Fig. 5.15. This operational amplifier is considered to have a voltage gain, $A_{v}(s)$, that varies with frequency, as well as complex input and output impedances represented by $Z_{i}(s)$ and $Z_{o}(s)$ respectively. A comprehensive circuit model is provided in Fig. 5.16. It should be noted that the circuit in Fig. 5.14 employs a large ideal inductance to open the loop and a large coupling capacitor to inject a test signal, allowing the determination of the small-signal loop gain through simulation without disrupting the DC biasing of the circuit.\n\nThe configuration depicted in Fig. 5.15 represents a noninverting feedback operational amplifier setup, incorporating feedback elements Z1 and Z2. The input signal is introduced via voltage source Vs and resistor Zs, while the output is measured across resistor ZL. \n\nFig. 5.16 presents a small-signal model of a noninverting feedback amplifier, using an operational amplifier with feedback components Z1 and Z2. The input is connected through voltage source Vs and resistor Zs, and the output is obtained across load resistor ZL. The opamp is characterized by a small-signal open-circuit gain Av(s)Vi and is configured with input and feedback resistors Zi and Zo.\n\nIn the context of the amplifier's gain, $A_{v}$ refers to the (small-signal) open-circuit gain of the opamp, which is distinct from the forward-path gain A of the feedback amplifier, as the latter must account for all loading effects.\n\n#### EXAMPLE 5.10\n\nGiven an operational amplifier with a specified input capacitance of 0.5 pF, an output resistance of $500 \\Omega$, a DC gain of 80 dB, and a unity-gain frequency of 100 MHz, along with a phase response of -105 degrees at the unity-gain frequency of $A_{v}(s)$, determine the opamp model components: $Z_{i}, Z_{o}$, and $A_{v}(s)$.\n\n#### Solution\n\nThe input and output impedances are directly provided in the specifications.\n\n$$\n\\begin{gathered}\nZ_{i}(s)=\\frac{1}{\\left(5 \\cdot 10^{-13}\\right) s} \\Omega \\\\\nZ_{o}(s)=500 \\Omega\n\\end{gathered}\n$$\n\nFor the gain, we employ a second-order model analogous to (5.34).\n\n$$\n\\begin{equation*}\nA_{v}(s)=\\frac{A_{v 0}}{\\left(1+s / \\omega_{\\mathrm{p} 1}\\right)\\left(1+s / \\omega_{\\mathrm{eq}}\\right)} \\tag{5.54}\n\\end{equation*}\n$$\n\nA DC gain of 80 dB corresponds to $\\mathrm{A}_{\\mathrm{v} 0}=10^{4}$. Given that the unity-gain frequency, $\\omega_{\\mathrm{ta}}$, satisfies $\\omega_{\\mathrm{p} 1}$ « $\\omega_{\\mathrm{ta}}$ « $\\omega_{\\mathrm{p} 2}$, the dominant pole frequency is\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{p} 1}=\\frac{\\omega_{\\mathrm{ta}}}{\\mathrm{~A}_{\\mathrm{v} 0}}=2 \\pi \\frac{10^{8}}{10^{4}}=2 \\pi \\cdot\\left(10^{4} \\mathrm{~Hz}\\right) \\tag{5.55}\n\\end{equation*}\n$$\n\nTo find the non-dominant pole frequency, assuming the dominant pole contributes $-90^{\\circ}$ phase shift at $\\omega_{\\mathrm{ta}}$,\n\n$$\n\\begin{equation*}\n\\tan ^{-1}\\left(\\frac{\\omega_{\\mathrm{ta}}}{\\omega_{\\mathrm{eq}}}\\right)=15^{\\circ} \\Rightarrow \\frac{\\omega_{\\mathrm{ta}}}{\\omega_{\\mathrm{eq}}}=0.270 \\Rightarrow \\omega_{\\mathrm{eq}}=\\frac{\\omega_{\\mathrm{ta}}}{0.270}=2 \\pi \\cdot\\left(3.70 \\cdot 10^{8} \\mathrm{~Hz}\\right) \\tag{5.56}\n\\end{equation*}\n$$\n\nUnder ideal conditions with infinite opamp gain, the gain of the noninverting amplifier is\n\n$$\n\\begin{align*}\n& \\frac{1}{\\beta}=\\frac{Z_{1}+Z_{2}}{Z_{1}}  \\tag{5.57}\\\\\n& \\Rightarrow \\beta=\\frac{Z_{1}}{Z_{1}+Z_{2}}\n\\end{align*}\n$$\n\nTo calculate the loop gain, we must examine the circuit depicted in Fig. 5.17. The loop is interrupted at the output of the voltage-controlled source Av, which models the opamp voltage gain. As the termination impedance, $Z_{t}$, is in series with an ideal voltage source, it does not influence the analysis. The redrawn schematic at the bottom of Fig. 5.17 clearly illustrates\n\n$$\n\\begin{gather*}\nv_{r}=A_{v}(s) v_{i}=-A_{v}(s) \\frac{Z_{i}}{Z_{o}}\\left[\\frac{Z_{L}| | Z_{o}}{Z_{L}| | Z_{o}+Z_{2}+Z_{1}| |\\left(Z_{s}+Z_{i}\\right)}\\right]\\left[\\frac{Z_{1}}{Z_{s}+Z_{i}+Z_{1}}\\right] v_{t} \\\\\nL(s)=A_{v}(s) \\frac{Z_{i}}{Z_{o}}\\left[\\frac{Z_{L}| | Z_{o}}{Z_{L}| | Z_{o}+Z_{2}+Z_{1}| |\\left(Z_{s}+Z_{i}\\right)}\\right]\\left[\\frac{Z_{1}}{Z_{s}+Z_{i}+Z_{1}}\\right] \\tag{5.58}\n\\end{gather*}\n$$\n\nA Bode plot of $\\mathrm{L}(\\mathrm{s})$ yields the phase margin. Inserting (5.57) and (5.58) into (5.51) and (5.52) provides the closed-loop frequency response and gain error. If the simplifying assumptions $Z_{i} \\gg Z_{1}, Z_{s}$ and $Z_{o}$ « $Z_{L}, Z_{2}$ are adopted (indicating that the opamp has high input impedance and low output impedance), (5.58) simplifies significantly.\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s}) \\approx \\mathrm{A}_{\\mathrm{v}}(\\mathrm{~s}) \\frac{\\mathrm{Z}_{1}}{\\mathrm{Z}_{1}+\\mathrm{Z}_{2}}=\\mathrm{A}_{\\mathrm{v}}(\\mathrm{~s}) \\beta \\tag{5.59}\n\\end{equation*}\n$$\n\nFig. 5.17 displays equivalent circuits for determining the loop gain, $L(s)$, of a voltage feedback amplifier, incorporating various resistive components and voltage sources to model the feedback and input/output impedances.\n\n#### EXAMPLE 5.11\n\nAn operational amplifier from Example 5.10 is utilized in a unity-gain configuration to drive a load of $Z_{L}=200 \\Omega$, as depicted in Fig. 5.18. Calculate the DC gain error, phase margin, and bandwidth.\n\n#### Solution\n\nA unity-gain opamp configuration is a specific instance of the noninverting operational amplifier where $\\mathbf{Z}_{1}=\\infty$ and $Z_{2}=0$. Substituting these values and $Z_{s}=0$ into (5.58), and assuming $Z_{L} \\ll Z_{i}$,\n\n$$\n\\begin{equation*}\nL(s)=A_{v}(s)\\left(\\frac{Z_{L}}{Z_{L}+Z_{o}}\\right) \\tag{5.60}\n\\end{equation*}\n$$\n\nGiven that the desired gain is $1 / \\beta=1$, the closed-loop gain becomes\n\n$$\n\\begin{equation*}\nA_{C L}(s)=\\frac{L(s)}{1+L(s)}=\\frac{A_{v}(s) Z_{L}}{A_{v}(s) Z_{L}+Z_{L}+Z_{0}} \\tag{5.61}\n\\end{equation*}\n$$\n\nUsing the DC parameter values for the opamp,\n\n$$\n\\begin{equation*}\n1-\\frac{\\mathrm{L}_{0}}{1+\\mathrm{L}_{0}}=1-\\frac{\\mathrm{A}_{\\mathrm{v} 0} \\mathrm{Z}_{\\mathrm{L}}}{\\mathrm{~A}_{\\mathrm{v} 0} \\mathrm{Z}_{\\mathrm{L}}+\\mathrm{Z}_{\\mathrm{L}}+\\mathrm{Z}_{\\mathrm{o}}}=0.0003 \\tag{5.62}\n\\end{equation*}\n$$\n\nindicating a gain error of 0.03%.\n\nSubstituting (5.54) into (5.60) yields the loop gain,\n\n$$\n\\begin{equation*}\nL(s)=\\frac{A_{v 0}}{\\left(1+\\frac{s}{\\omega_{\\mathrm{p} 1}}\\right)\\left(1+\\frac{s}{\\omega_{\\mathrm{eq}}}\\right)}\\left(\\frac{Z_{\\mathrm{L}}}{Z_{\\mathrm{L}}+Z_{\\mathrm{o}}}\\right) \\tag{5.63}\n\\end{equation*}\n$$\n\nA Bode plot of (5.63) reveals a phase margin of $85.6^{\\circ}$.\n\nTo find the bandwidth, solve for the -3 dB frequency of (5.61). Since the phase margin is close to $90^{\\circ}$, the equivalent second pole $\\omega_{\\text {eq }}$ has a minimal effect at frequencies near the closed-loop bandwidth. Thus, a first-order approximation can be used for the opamp, $\\mathrm{A}_{\\mathrm{v}}(\\mathrm{s}) \\cong \\omega_{\\mathrm{ta}} / \\mathrm{s}$. Substituting this into (5.61) yields\n\n$$\n\\begin{equation*}\n\\mathrm{A}_{\\mathrm{CL}}(\\mathrm{~s}) \\cong \\frac{1}{1+\\left(\\frac{Z_{\\mathrm{L}}+Z_{\\mathrm{o}}}{\\mathrm{Z}_{\\mathrm{L}}}\\right) \\frac{\\mathrm{s}}{\\omega_{\\mathrm{ta}}}} \\tag{5.64}\n\\end{equation*}\n$$\n\nFrom this, the -3 dB bandwidth is approximately $\\left(\\omega_{t a} Z_{L}\\right) /\\left(Z_{L}+Z_{o}\\right)$, which in this case equals $2 \\pi \\cdot 2.86 \\mathrm{MHz}$.\n\nFig. 5.18 illustrates a unity-gain opamp configuration with a feedback loop, where the opamp is set up as a voltage follower, with the output directly connected to the inverting input to ensure unity gain. The load resistor ZL is connected to the output and ground.\n\nIn Example 5.11, despite the amplifier's output impedance of $500 \\Omega$ driving a load of only $200 \\Omega$, a gain very close to unity is achieved. The voltage division between the opamp's output impedance and load, $Z_{L} /\\left(Z_{L}+Z_{o}\\right)$, is a term in (5.60) that diminishes the open-loop gain, L. However, as long as the opamp maintains a high voltage gain, $A_{v}$, the open-loop gain $L$ remains much greater than unity, and the circuit functions as an ideal voltage buffer with a closed-loop gain $\\mathrm{A}_{\\mathrm{CL}} \\cong 1$.\n\n#### EXAMPLE 5.12\n\nDetermine the output impedance of the closed-loop amplifier in Example 5.11.\n\n#### Solution\n\nIf the load of the closed-loop amplifier, $Z_{\\mathrm{L}}$, were equal to its output impedance, $Z_{\\text {out }}$ in Fig. 5.18, the closed-loop amplifier gain would be exactly one-half the value obtained with $Z_{L}=\\infty$. In this scenario, the closed-loop gain with $Z_{L}=\\infty$ is nearly unity. Therefore, we can substitute $Z_{L}=Z_{\\text {out }}$ and $A_{C L}=1 / 2$ into (5.61) and solve for $\\mathrm{Z}_{\\text {out }}$.\n\n$$\n\\frac{1}{2}=\\frac{A_{v} Z_{\\text {out }}}{A_{v} Z_{\\text {out }}+Z_{\\text {out }}+Z_{o}} \\Rightarrow Z_{\\text {out }}=Z_{o} \\cdot \\frac{1}{A_{v}-1}\n$$\n\nUsing the DC values from Example 5.10, $Z_{o}=500 \\Omega$ and $A_{v}=A_{v 0}=10^{4}$, results in a DC closed-loop output impedance of\n\n$$\n\\mathrm{Z}_{\\text {out }}=\\frac{(500 \\Omega)}{\\left(10^{4}-1\\right)} \\cong 0.05 \\Omega\n$$\n\n#### Key Point\n\nAn important aspect of feedback in CMOS integrated circuits is its ability to reduce the output impedance of an amplifier by a factor approximately equal to the loop gain. This effectively increases the amplifier's input impedance, as the feedback ensures that the opamp input terminals are subjected to only very small differential voltages, $\\mathrm{v}_{\\mathrm{i}}$, thus requiring very little input current. Although MOSFET gates inherently provide high input impedance even without feedback, current feedback can be employed to achieve very low input impedances, which is particularly useful when designing CMOS circuits for amplifying current signals.\n\nIn general, feedback in integrated circuits effectively decreases the output impedance of an amplifier. Specifically, the output impedance of the amplifier, considering the loading of the feedback network, is reduced by a factor approximately equal to the loop gain, L. This property of feedback is particularly significant in CMOS integrated circuits, where achieving low output impedance without feedback would necessitate high power dissipation."
},
{
    "text": "A quintessential illustration of a feedback amplifier is the generalized noninverting operational amplifier depicted in Fig. 5.15. It is presumed that the operational amplifier features a voltage gain, $\\mathrm{A}_{\\mathrm{v}}(\\mathrm{s})$, that varies with frequency, as well as complex input and output impedances denoted by $Z_{i}(\\mathrm{~s})$ and $Z_{o}(s)$, respectively. A comprehensive circuit model is presented in Fig. 5.16. It should be noted that the\n\nimage_name:Fig. 5.14\ndescription:In Fig. 5.14, the circuit employs a substantial ideal inductance to open the loop and introduces a test signal via a large coupling capacitor to ascertain the small-signal loop gain through simulation, without tampering with the circuit's DC bias.\n\nFig. 5.14 features a loop disruption via a sizeable ideal inductance and incorporates a test signal via a large coupling capacitor, facilitating the determination of the small-signal loop gain in simulation while preserving the circuit's DC biasing.\n\nFig. 5.15 presents a generalized noninverting feedback operational amplifier configuration.\nimage_name:Fig. 5.15 A generalized noninverting feedback operational amplifier configuration.\ndescription:\n[\nname: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\nname: Zs, type: Resistor, value: Zs, ports: {N1: Vs, N2: InP(Av)}\nname: Z1, type: Resistor, value: Z1, ports: {N1: InN(Av), N2: GND}\nname: Z2, type: Resistor, value: Z2, ports: {N1: InN(Av), N2: Vout}\nname: ZL, type: Resistor, value: ZL, ports: {N1: Vout, N2: GND}\nname: Av, type: OpAmp, value: Av, ports: {InP: InP(Av), InN: InN(Av), OutP: Vout}\n]\nextrainfo:This circuit exemplifies a noninverting feedback operational amplifier configuration, utilizing feedback components Z1 and Z2. The input is introduced through Vs and Zs, with the output measured across ZL.\n\nimage_name:Fig. 5.16 Small-signal model of a noninverting feedback amplifier\ndescription:\n[\nname: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\nname: Zs, type: Resistor, value: Zs, ports: {N1: Vs, N2: InP(Av)}\nname: Zi, type: Resistor, value: Zi, ports: {N1: InP(Av), N2: InN(Av)}\nname: Z1, type: Resistor, value: Z1, ports: {N1: InN(Av), N2: GND}\nname: Z2, type: Resistor, value: Z2, ports: {N1: InN(Av), N2: Vout}\nname: ZL, type: Resistor, value: ZL, ports: {N1: Vout, N2: GND}\nname: Zo, type: Resistor, value: Zo, ports: {N1: Av(s)Vi, N2: Vout}\nname: Av(s)*Vi, type: VoltageControlVotageSource, value: Av(s)*Vi, ports: {N1: Av(s)*Vi, N2: GND}\n]\nextrainfo:This illustration depicts a small-signal model of a noninverting feedback amplifier. It incorporates an operational amplifier with feedback components Z1 and Z2. The input signal is applied through a voltage source Vs and resistor Zs, with the output measured across the load resistor ZL. The opamp exhibits a small-signal open-circuit gain Av(s)Vi and is configured with input and feedback resistors Zi and Zo.\n\nFig. 5.16 Small-signal model of a noninverting feedback amplifier.\nThe gain $A_{v}$ represents the (small-signal) open-circuit gain of the opamp and is thus distinct from the forward-path gain $A$ of the feedback amplifier, which encompasses all loading effects.\n\n#### EXAMPLE 5.10\n\nAn operational amplifier's specifications include an input capacitance of 0.5 pF, an output resistance of $500 \\Omega$, a DC gain of 80 dB, and a unity-gain frequency of 100 MHz. Additionally, the opamp exhibits a phase response of -105 degrees at the unity-gain frequency of $A_{v}(s)$. Determine the opamp model components: $Z_{i}, Z_{o}$, and $A_{v}(s)$.\n\n#### Solution\n\nThe input and output impedances are explicitly provided in the specifications.\n\n$$\n\\begin{gathered}\nZ_{i}(s)=\\frac{1}{\\left(5 \\cdot 10^{-13}\\right) s} \\Omega \\\\\nZ_{0}(s)=500 \\Omega\n\\end{gathered}\n$$\n\nFor the gain, we utilize a second-order model akin to (5.34).\n\n$$\n\\begin{equation*}\nA_{v}(s)=\\frac{A_{v 0}}{\\left(1+s / \\omega_{\\mathrm{p} 1}\\right)\\left(1+s / \\omega_{e q}\\right)} \\tag{5.54}\n\\end{equation*}\n$$\n\nA DC gain of 80 dB equates to $\\mathrm{A}_{\\mathrm{v} 0}=10^{4}$. Given that the unity-gain frequency, $\\omega_{\\mathrm{ta}}$, satisfies $\\omega_{\\mathrm{p} 1}$ 《 $\\omega_{\\mathrm{ta}}$ « $\\omega_{\\mathrm{p} 2}$, the dominant pole frequency is\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{p} 1}=\\frac{\\omega_{\\mathrm{ta}}}{\\mathrm{~A}_{\\mathrm{v} 0}}=2 \\pi \\frac{10^{8}}{10^{4}}=2 \\pi \\cdot\\left(10^{4} \\mathrm{~Hz}\\right) \\tag{5.55}\n\\end{equation*}\n$$\n\nTo ascertain the non-dominant pole frequency, we posit that the dominant pole contributes $-90^{\\circ}$ phase shift at $\\omega_{\\mathrm{ta}}$, hence,\n\n$$\n\\begin{equation*}\n\\tan ^{-1}\\left(\\frac{\\omega_{\\mathrm{ta}}}{\\omega_{\\mathrm{eq}}}\\right)=15^{\\circ} \\Rightarrow \\frac{\\omega_{\\mathrm{ta}}}{\\omega_{\\mathrm{eq}}}=0.270 \\Rightarrow \\omega_{\\mathrm{eq}}=\\frac{\\omega_{\\mathrm{ta}}}{0.270}=2 \\pi \\cdot\\left(3.70 \\cdot 10^{8} \\mathrm{~Hz}\\right) \\tag{5.56}\n\\end{equation*}\n$$\n\nIt is widely recognized that under ideal conditions of infinite opamp gain, the gain of the noninverting amplifier is\n\n$$\n\\begin{align*}\n& \\frac{1}{\\beta}=\\frac{Z_{1}+Z_{2}}{Z_{1}}  \\tag{5.57}\\\\\n& \\Rightarrow \\beta=\\frac{Z_{1}}{Z_{1}+Z_{2}}\n\\end{align*}\n$$\n\nTo compute the loop gain, we must scrutinize the circuit in Fig. 5.17. The loop is severed at the output of the controlled-source $A_{v}$, which emulates the opamp voltage gain. As the termination impedance, $Z_{t}$, is situated across an ideal voltage source, its value holds no influence on the analysis. The redrawn schematic at the base of Fig. 5.17 distinctly illustrates\n\n$$\n\\begin{gather*}\nv_{r}=A_{v}(s) v_{i}=-A_{v}(s) \\frac{Z_{i}}{Z_{o}}\\left[\\frac{Z_{L}| | Z_{o}}{Z_{L}| | Z_{o}+Z_{2}+Z_{1}| |\\left(Z_{s}+Z_{i}\\right)}\\right]\\left[\\frac{Z_{1}}{Z_{s}+Z_{i}+Z_{1}}\\right] v_{t} \\\\\nL(s)=A_{v}(s) \\frac{Z_{i}}{Z_{o}}\\left[\\frac{Z_{L}| | Z_{o}}{Z_{L}| | Z_{o}+Z_{2}+Z_{1}| |\\left(Z_{s}+Z_{i}\\right)}\\right]\\left[\\frac{Z_{1}}{Z_{s}+Z_{i}+Z_{1}}\\right] \\tag{5.58}\n\\end{gather*}\n$$\n\nA Bode plot of $\\mathrm{L}(\\mathrm{s})$ yields the phase margin. Inserting (5.57) and (5.58) into (5.51) and (5.52) yields the closed-loop frequency response and gain error. If the simplifying assumptions $Z_{i} \\gg Z_{1}, Z_{s}$ and $Z_{o}$ « $Z_{L}, Z_{2}$ are adopted (i.e., the opamp possesses relatively high input impedance and low output impedance), (5.58) simplifies to a straightforward result.\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s}) \\approx \\mathrm{A}_{\\mathrm{v}}(\\mathrm{~s}) \\frac{\\mathrm{Z}_{1}}{\\mathrm{Z}_{1}+\\mathrm{Z}_{2}}=\\mathrm{A}_{\\mathrm{v}}(\\mathrm{~s}) \\beta \\tag{5.59}\n\\end{equation*}\n$$\n\nimage_name:Fig. 5.17\ndescription:\n[\nname: Zs, type: Resistor, value: Zs, ports: {N1: GND, N2: X}\nname: Zi, type: Resistor, value: Zi, ports: {N1: X, N2: Y}\nname: Z1, type: Resistor, value: Z1, ports: {N1: Y, N2: GND}\nname: Z2, type: Resistor, value: Z2, ports: {N1: Y, N2: Vout}\nname: Zt, type: Resistor, value: Zt, ports: {N1: Vr(Av(s)*Vi), N2: GND}\nname: Zo, type: Resistor, value: Zo, ports: {N1: Vt, N2: Vout}\nname: ZL, type: Resistor, value: ZL, ports: {N1: Vout, N2: GND}\nname: Av(s)*Vi, type: VoltageControlledVoltageSource, ports: {Np: Vr, Nn: GND}\nname: Vt, type: VoltageSource, value: Vt, ports: {Np: Vt, Nn: GND}\n]\nextrainfo:This circuit diagram depicts equivalent circuits for determining the loop gain, L(s), of a voltage feedback amplifier. It incorporates various resistive elements and voltage sources to model the feedback and input/output impedances.\n\nFig. 5.17 Equivalent circuits for calculating the loop gain, $L(s)$, of a voltage feedback amplifier.\n\n#### EXAMPLE 5.11\n\nThe operational amplifier from Example 5.10 is to be employed to drive a load of $Z_{L}=200 \\Omega$ in a unity-gain configuration, as illustrated in Fig. 5.18. Ascertain the DC gain error, phase margin, and bandwidth.\n\n#### Solution\n\nA unity-gain operational amplifier configuration is a particular instance of the noninverting operational amplifier where $\\mathbf{Z}_{1}=\\infty$ and $Z_{2}=0$. Inserting these and $Z_{s}=0$ into (5.58), and assuming $Z_{L} \\ll Z_{i}$,\n\n$$\n\\begin{equation*}\nL(s)=A_{v}(s)\\left(\\frac{Z_{L}}{Z_{L}+Z_{o}}\\right) \\tag{5.60}\n\\end{equation*}\n$$\n\nGiven that the intended gain is $1 / \\beta=1$, the closed-loop gain is\n\n$$\n\\begin{equation*}\nA_{C L}(s)=\\frac{L(s)}{1+L(s)}=\\frac{A_{v}(s) Z_{L}}{A_{v}(s) Z_{L}+Z_{L}+Z_{0}} \\tag{5.61}\n\\end{equation*}\n$$\n\nA numerical outcome for the gain error is acquired using the parameter values for the opamp at DC,\n\n$$\n\\begin{equation*}\n1-\\frac{\\mathrm{L}_{0}}{1+\\mathrm{L}_{0}}=1-\\frac{\\mathrm{A}_{\\mathrm{v} 0} \\mathrm{Z}_{\\mathrm{L}}}{\\mathrm{~A}_{\\mathrm{v} 0} \\mathrm{Z}_{\\mathrm{L}}+\\mathrm{Z}_{\\mathrm{L}}+\\mathrm{Z}_{\\mathrm{o}}}=0.0003 \\tag{5.62}\n\\end{equation*}\n$$\n\nindicating a gain error of 0.03%.\nInserting (5.54) into equation (5.60) yields the loop gain,\n\n$$\n\\begin{equation*}\nL(s)=\\frac{A_{v 0}}{\\left(1+\\frac{s}{\\omega_{\\mathrm{p} 1}}\\right)\\left(1+\\frac{s}{\\omega_{\\mathrm{eq}}}\\right)}\\left(\\frac{Z_{\\mathrm{L}}}{Z_{\\mathrm{L}}+Z_{\\mathrm{o}}}\\right) \\tag{5.63}\n\\end{equation*}\n$$\n\nA Bode plot of (5.63) indicates a phase margin of $85.6^{\\circ}$.\nUltimately, the bandwidth can be ascertained by solving for the -3 dB frequency of (5.61). To simplify the analysis, observe that the phase margin is close to $90^{\\circ}$, suggesting that the equivalent second pole $\\omega_{\\text {eq }}$ has a negligible impact at frequencies around the closed-loop bandwidth. Hence, a first-order approximation may be employed for the opamp, $\\mathrm{A}_{\\mathrm{v}}(\\mathrm{s}) \\cong \\omega_{\\mathrm{ta}} / \\mathrm{s}$. Inserting this into (5.61) results in\n\n$$\n\\begin{equation*}\n\\mathrm{A}_{\\mathrm{CL}}(\\mathrm{~s}) \\cong \\frac{1}{1+\\left(\\frac{Z_{\\mathrm{L}}+Z_{\\mathrm{o}}}{\\mathrm{Z}_{\\mathrm{L}}}\\right) \\frac{\\mathrm{s}}{\\omega_{\\mathrm{ta}}}} \\tag{5.64}\n\\end{equation*}\n$$\n\nfrom which it straightforwardly follows that the $3-\\mathrm{dB}$ bandwidth is approximately $\\left(\\omega_{t a} Z_{L}\\right) /\\left(Z_{L}+Z_{o}\\right)$, which in this instance equals $2 \\pi \\cdot 2.86 \\mathrm{MHz}$.\nimage_name:Fig. 5.18 Unity-gain opamp configuration\ndescription:\n[\nname: Vs, type: VoltageSource, value: Vs, ports: {Np: Vs, Nn: GND}\nname: A1, type: OpAmp, value: A1, ports: {InP: Vs, InN: Vout, OutP: Vout}\nname: ZL, type: Resistor, value: ZL, ports: {N1: Vout, N2: GND}\n]\nextrainfo:This circuit represents a unity-gain operational amplifier configuration with a feedback loop. The operational amplifier is configured in a voltage follower setup, with the output directly connected to the inverting input, ensuring unity gain. The load resistor ZL is connected to the output and ground.\n\nFig. 5.18 Unity-gain opamp configuration.\n\nIn Example 5.11, an amplifier with an output impedance of $500 \\Omega$ is employed to drive a load of only $200 \\Omega$, which might suggest a reduction in the amplifier's gain. Nonetheless, a result very close to the desired gain of unity is achieved. The voltage division between the opamp's output impedance and load, $Z_{L} /\\left(Z_{L}+Z_{0}\\right)$, does indeed manifest as a term in (5.60) that diminishes the open-loop gain, $L$. However, as long as the opamp maintains a high voltage gain, $A_{v}$, the open-loop gain $L$ remains substantially greater than unity, and the circuit continues to function as an ideal voltage buffer with a closed-loop gain $\\mathrm{A}_{\\mathrm{CL}} \\cong 1$.\n\n#### EXAMPLE 5.12\n\nWhat is the output impedance of the closed-loop amplifier in Example 5.11?\n\n#### Solution\n\nIf the load of the closed-loop amplifier, $Z_{\\mathrm{L}}$, were equivalent to its output impedance, $Z_{\\text {out }}$ in Fig. 5.18, the closed-loop amplifier gain would be precisely one-half the value obtained with $Z_{L}=\\infty$. In this scenario, the closed-loop gain with $Z_{L}=\\infty$ is nearly unity. Thus, we can substitute $Z_{L}=Z_{\\text {out }}$ and $A_{C L}=1 / 2$ into (5.61) and solve for $\\mathrm{Z}_{\\text {out }}$.\n\n$$\n\\frac{1}{2}=\\frac{A_{v} Z_{\\text {out }}}{A_{v} Z_{\\text {out }}+Z_{\\text {out }}+Z_{o}} \\Rightarrow Z_{\\text {out }}=Z_{o} \\cdot \\frac{1}{A_{v}-1}\n$$\n\nSubstituting in DC values from Example 5.10, $Z_{o}=500 \\Omega$ and $A_{v}=A_{v 0}=10^{4}$, yields a DC closed-loop output impedance of\n\n$$\n\\mathrm{Z}_{\\text {out }}"
},
{
    "text": "A quintessential instance of a feedback amplifier is depicted by the generalized noninverting operational amplifier configuration as illustrated in Fig. 5.15. The operational amplifier is presumed to possess a frequency-variant voltage gain denoted as $\\mathrm{A}_{\\mathrm{v}}(\\mathrm{s})$, and complex input and output impedances represented by $Z_{i}(\\mathrm{~s})$ and $Z_{o}(s)$, respectively. A comprehensive circuit model is presented in Fig. 5.16. It is worth noting that the circuit in Fig. 5.14 employs a large ideal inductance to disrupt the loop and incorporates a test signal through a large coupling capacitor, which is designed to ascertain the small-signal loop gain in simulations without perturbing the circuit's DC biasing.\n\nThe noninverting operational amplifier circuit in Fig. 5.15 is characterized by feedback elements Z1 and Z2, with the input being applied through Vs and Zs, and the output being measured across ZL. In the small-signal model of a noninverting feedback amplifier depicted in Fig. 5.16, the operational amplifier features feedback components Z1 and Z2, with the input signal applied through a voltage source Vs and resistor Zs, and the output measured across load resistor ZL. The opamp has a small-signal open-circuit gain Av(s)Vi and is configured with input and feedback resistors Zi and Zo. It is important to note that the gain $A_{v}$ refers to the (small-signal) open-circuit gain of the opamp and is not synonymous with the forward-path gain $A$ of the feedback amplifier, which must encompass all loading.\n\nMoving on to Example 5.10, an operational amplifier specification details an input capacitance of 0.5 pF, an output resistance of $500 \\Omega$, a DC gain of 80 dB, and a unity-gain frequency of 100 MHz. Additionally, the opamp is reported to exhibit a phase response of -105 degrees at the unity-gain frequency of $A_{v}(s)$. The task is to derive the opamp model components: $Z_{i}, Z_{o}$, and $A_{v}(s)$.\n\nIn the solution, the input and output impedances are directly provided in the specification. For the gain, a second-order model akin to (5.34) is adopted.\n\nFurther analysis of the circuit in Fig. 5.17 is required to determine the loop gain, L(s), of a voltage feedback amplifier. The loop is severed at the output of the controlled-source $A_{v}$, which models the opamp voltage gain. Since the termination impedance, $Z_{t}$, is inserted across an ideal voltage source, its value does not influence the analysis. The redrawn schematic at the bottom of Fig. 5.17 clearly exhibits\n\nIn Example 5.11, the operational amplifier from Example 5.10 is utilized to drive a load of $Z_{L}=200 \\Omega$ in a unity-gain configuration, as depicted in Fig. 5.18. The objectives are to find the DC gain error, phase margin, and bandwidth.\n\nA unity-gain opamp configuration is a particular case of the noninverting operational amplifier where $\\mathbf{Z}_{1}=\\infty$ and $Z_{2}=0$. Assuming $Z_{L} \\ll Z_{i}$, substituting these and $Z_{s}=0$ into (5.58) yields\n\nA numerical result for the gain error is derived using the parameter values for the opamp at DC,\n\nindicating a gain error of 0.03%.\n\nSubstituting (5.54) into equation (5.60) yields the loop gain,\n\nA Bode plot of (5.63) indicates a phase margin of $85.6^{\\circ}$.\n\nFinally, the bandwidth can be determined by solving for the -3 dB frequency of (5.61). To simplify the analysis, note that the phase margin is close to $90^{\\circ}$, so the equivalent second pole $\\omega_{\\text {eq }}$ plays only a minor role at frequencies around the closed-loop bandwidth. Therefore, a first-order approximation can be used for the opamp, $\\mathrm{A}_{\\mathrm{v}}(\\mathrm{s}) \\cong \\omega_{\\mathrm{ta}} / \\mathrm{s}$. Substituting this into (5.61) results in\n\nfrom which it straightforwardly follows that the $3-\\mathrm{dB}$ bandwidth is approximately $\\left(\\omega_{t a} Z_{L}\\right) /\\left(Z_{L}+Z_{o}\\right)$, which in this case equals $2 \\pi \\cdot 2.86 \\mathrm{MHz}$.\n\nIn Example 5.11, an amplifier with an output impedance of $500 \\Omega$ is used to drive a load of only $200 \\Omega$, which one might expect to result in a decrease in the amplifier's gain. However, a result very close to the desired gain of unity is achieved. The voltage division between the opamp's output impedance and load, $Z_{L} /\\left(Z_{L}+Z_{0}\\right)$, does indeed appear as a term in (5.60) that reduces the open-loop gain, $L$. Nevertheless, as long as the opamp has a large voltage gain, $A_{v}$, the open-loop gain $L$ remains much larger than unity, and the circuit continues to function as an ideal voltage buffer with a closed-loop gain $\\mathrm{A}_{\\mathrm{CL}} \\cong 1$.\n\nExample 5.12 seeks to determine the output impedance of the closed-loop amplifier in Example 5.11. If the load of the closed-loop amplifier, $Z_{\\mathrm{L}}$, were equal to its output impedance, $Z_{\\text {out }}$ in Fig. 5.18, the closed-loop amplifier gain would be precisely one-half the value obtained with $Z_{L}=\\infty$. In this case, the closed-loop gain with $Z_{L}=\\infty$ is almost exactly unity. Therefore, we can substitute $Z_{L}=Z_{\\text {out }}$ and $A_{C L}=1 / 2$ into (5.61) and solve for $\\mathrm{Z}_{\\text {out }}$.\n\nSubstituting in DC values from Example 5.10, $Z_{o}=500 \\Omega$ and $A_{v}=A_{v 0}=10^{4}$, yields a DC closed-loop output impedance of\n\nAn important attribute of feedback in CMOS integrated circuits is that it diminishes the output impedance of an amplifier by a factor approximately equal to the loop gain. This effectively increases the amplifier's input impedance; the feedback ensures the opamp input terminals are subjected to only very small differential voltages, $\\mathrm{v}_{\\mathrm{i}}$, so very little input current is required. However, this is not a particularly remarkable property since MOSFET gates inherently provide relatively high input impedance even without feedback. Nevertheless, in the following section, we will explore how current feedback can be utilized to achieve very low input impedances, which can be highly beneficial when designing a CMOS circuit to amplify current signals.\n\nFor instance, a common-source amplifier has an output impedance that depends on its small-signal $r_{d s}$ in active mode, which is in turn inversely proportional to its drain current. Hence, to decrease the output impedance, the drain current must increase.\n\nIn summary, feedback in integrated circuits effectively reduces the output impedance of an amplifier. Specifically, the output impedance of the amplifier, including the loading of the feedback network, is diminished by a factor approximately equal to the loop gain, L. This is a significant feature of feedback, particularly in CMOS integrated circuits, where low output impedance would otherwise necessitate high power dissipation."
},
{
    "text": "A quintessential instance of a feedback amplifier is depicted in the generalized noninverting op-amp circuit shown in Fig. 5.15. Here, the operational amplifier is presumed to exhibit a frequency-dependent voltage gain, denoted as \\( A_v(s) \\), alongside complex input and output impedances represented by \\( Z_i(s) \\) and \\( Z_o(s) \\), respectively. A comprehensive circuit model is provided in Fig. 5.16. It is important to observe that the circuit illustrated in Fig. 5.14 employs a substantial ideal inductance to sever the loop and incorporates a large coupling capacitor to inject a test signal. This setup allows for the determination of the small-signal loop gain through simulation without interfering with the circuit's DC bias.\n\nFig. 5.14 showcases a technique where a large ideal inductance is used to open the loop, and a large coupling capacitor introduces a test signal. This is done to calculate the small-signal loop gain in a simulation environment while preserving the DC bias of the circuit.\n\nFig. 5.15 presents a generalized noninverting feedback operational amplifier configuration.\n\nThe detailed description of Fig. 5.15 reveals a noninverting feedback operational amplifier setup that incorporates feedback components Z1 and Z2. The input is fed through the voltage source Vs and resistor Zs, with the output measured across resistor ZL.\n\nFig. 5.16 displays a small-signal model of a noninverting feedback amplifier, which utilizes an operational amplifier with feedback components Z1 and Z2. The input signal is applied via a voltage source Vs and resistor Zs, while the output is drawn across load resistor ZL. The operational amplifier has a small-signal open-circuit gain \\( A_v(s)Vi \\) and is arranged with input and feedback resistors Zi and Zo.\n\nIt is noted that the gain \\( A_v \\) represents the (small-signal) open-circuit gain of the op-amp and is thus distinct from the forward-path gain \\( A \\) of the feedback amplifier, which must account for all loading effects.\n\n#### EXAMPLE 5.10\n\nAn operational amplifier's specifications include an input capacitance of 0.5 pF, an output resistance of \\( 500 \\Omega \\), a DC gain of 80 dB, and a unity-gain frequency of 100 MHz. Additionally, the op-amp's phase response is specified as -105 degrees at the unity-gain frequency of \\( A_v(s) \\). The task is to determine the op-amp model components: \\( Z_i \\), \\( Z_o \\), and \\( A_v(s) \\).\n\n#### Solution\n\nThe input and output impedances are directly provided in the specifications.\n\n$$\n\\begin{gathered}\nZ_i(s) = \\frac{1}{(5 \\cdot 10^{-13}) s} \\Omega \\\\\nZ_o(s) = 500 \\Omega\n\\end{gathered}\n$$\n\nFor the gain, a second-order model similar to (5.34) is employed.\n\n$$\nA_v(s) = \\frac{A_{v0}}{(1 + s/\\omega_{p1})(1 + s/\\omega_{eq})} \\tag{5.54}\n$$\n\nA DC gain of 80 dB corresponds to \\( A_{v0} = 10^4 \\). Given that the unity-gain frequency, \\( \\omega_{ta} \\), satisfies \\( \\omega_{p1} \\ll \\omega_{ta} \\ll \\omega_{p2} \\), the dominant pole frequency is calculated as\n\n$$\n\\omega_{p1} = \\frac{\\omega_{ta}}{A_{v0}} = 2\\pi \\frac{10^8}{10^4} = 2\\pi \\cdot 10^4 \\text{ Hz} \\tag{5.55}\n$$\n\nTo find the non-dominant pole frequency, it is assumed that the dominant pole contributes a -90-degree phase shift at \\( \\omega_{ta} \\), leading to\n\n$$\n\\tan^{-1}\\left(\\frac{\\omega_{ta}}{\\omega_{eq}}\\right) = 15^\\circ \\Rightarrow \\frac{\\omega_{ta}}{\\omega_{eq}} = 0.270 \\Rightarrow \\omega_{eq} = \\frac{\\omega_{ta}}{0.270} = 2\\pi \\cdot 3.70 \\cdot 10^8 \\text{ Hz} \\tag{5.56}\n$$\n\nIt is widely recognized that the gain of the noninverting amplifier under ideal conditions of infinite op-amp gain is given by\n\n$$\n\\frac{1}{\\beta} = \\frac{Z_1 + Z_2}{Z_1} \\tag{5.57}\n$$\n\nTo ascertain the loop gain, the circuit depicted in Fig. 5.17 must be examined. The loop is severed at the output of the voltage-controlled source \\( A_v \\), which models the op-amp voltage gain. Since the termination impedance \\( Z_t \\) is placed across an ideal voltage source, its value does not influence the analysis. The redrawn schematic at the bottom of Fig. 5.17 clearly illustrates\n\n$$\n\\begin{gather*}\nv_r = A_v(s) v_i = -A_v(s) \\frac{Z_i}{Z_o}\\left[\\frac{Z_L || Z_o}{Z_L || Z_o + Z_2 + Z_1 || (Z_s + Z_i)}\\right]\\left[\\frac{Z_1}{Z_s + Z_i + Z_1}\\right] v_t \\\\\nL(s) = A_v(s) \\frac{Z_i}{Z_o}\\left[\\frac{Z_L || Z_o}{Z_L || Z_o + Z_2 + Z_1 || (Z_s + Z_i)}\\right]\\left[\\frac{Z_1}{Z_s + Z_i + Z_1}\\right] \\tag{5.58}\n\\end{gather*}\n$$\n\nA Bode plot of \\( L(s) \\) yields the phase margin. Substituting (5.57) and (5.58) into (5.51) and (5.52) provides the closed-loop frequency response and gain error. Assuming the simplifying conditions \\( Z_i \\gg Z_1, Z_s \\) and \\( Z_o \\ll Z_L, Z_2 \\) (i.e., the op-amp possesses relatively high input impedance and low output impedance), (5.58) simplifies significantly.\n\n$$\nL(s) \\approx A_v(s) \\frac{Z_1}{Z_1 + Z_2} = A_v(s) \\beta \\tag{5.59}\n$$\n\nFig. 5.17 depicts equivalent circuits for determining the loop gain \\( L(s) \\) of a voltage feedback amplifier, incorporating various resistive components and voltage sources to model the feedback and input/output impedances.\n\n#### EXAMPLE 5.11\n\nThe operational amplifier from Example 5.10 is to be utilized in a unity-gain configuration to drive a load of \\( Z_L = 200 \\Omega \\), as illustrated in Fig. 5.18. The objective is to calculate the DC gain error, phase margin, and bandwidth.\n\n#### Solution\n\nA unity-gain op-amp configuration is a particular instance of the noninverting operational amplifier where \\( Z_1 = \\infty \\) and \\( Z_2 = 0 \\). Substituting these values and \\( Z_s = 0 \\) into (5.58), and assuming \\( Z_L \\ll Z_i \\),\n\n$$\nL(s) = A_v(s)\\left(\\frac{Z_L}{Z_L + Z_o}\\right) \\tag{5.60}\n$$\n\nSince the desired gain is \\( 1/\\beta = 1 \\), the closed-loop gain is expressed as\n\n$$\nA_{CL}(s) = \\frac{L(s)}{1 + L(s)} = \\frac{A_v(s) Z_L}{A_v(s) Z_L + Z_L + Z_o} \\tag{5.61}\n$$\n\nThe DC gain error is numerically determined using the parameter values for the op-amp at DC,\n\n$$\n1 - \\frac{L_0}{1 + L_0} = 1 - \\frac{A_{v0} Z_L}{A_{v0} Z_L + Z_L + Z_o} = 0.0003 \\tag{5.62}\n$$\n\nindicating a gain error of 0.03%.\n\nSubstituting (5.54) into equation (5.60) yields the loop gain,\n\n$$\nL(s) = \\frac{A_{v0}}{(1 + s/\\omega_{p1})(1 + s/\\omega_{eq})}\\left(\\frac{Z_L}{Z_L + Z_o}\\right) \\tag{5.63}\n$$\n\nA Bode plot of (5.63) indicates a phase margin of \\( 85.6^\\circ \\).\n\nTo determine the bandwidth, the -3 dB frequency of (5.61) is solved. For simplification, note that the phase margin is close to \\( 90^\\circ \\), implying that the equivalent second pole \\( \\omega_{eq} \\) has a minimal impact at frequencies around the closed-loop bandwidth. Therefore, a first-order approximation can be used for the op-amp, \\( A_v(s) \\cong \\omega_{ta}/s \\). Substituting this into (5.61) results in\n\n$$\nA_{CL}(s) \\cong \\frac{1}{1 + (Z_L + Z_o/Z_L) s/\\omega_{ta}} \\tag{5.64}\n$$\n\nwhich straightforwardly leads to the \\( 3 \\text{ dB} \\) bandwidth being approximately \\( (\\omega_{ta} Z_L)/(Z_L + Z_o) \\), which in this case equals \\( 2\\pi \\cdot 2.86 \\text{ MHz} \\).\n\nFig. 5.18 depicts a unity-gain op-amp configuration, featuring a feedback loop where the op-amp is configured as a voltage follower, ensuring unity gain. The load resistor \\( Z_L \\) is connected to the output and ground.\n\nIn Example 5.11, an amplifier with an output impedance of \\( 500 \\Omega \\) is used to drive a load of only \\( 200 \\Omega \\), which might suggest a decrease in the amplifier's gain. However, a gain very close to the desired unity is achieved. The voltage division between the op-amp's output impedance and load, \\( Z_L/(Z_L + Z_o) \\), does indeed appear as a term in (5.60) that diminishes the open-loop gain, \\( L \\). Nonetheless, as long as the op-amp has a large voltage gain, \\( A_v \\), the open-loop gain \\( L \\) remains much greater than unity, and the circuit functions as an ideal voltage buffer with a closed-loop gain \\( A_{CL} \\cong 1 \\).\n\n#### EXAMPLE 5.12\n\nThe output impedance of the closed-loop amplifier in Example 5.11 is to be determined.\n\n#### Solution\n\nIf the load of the closed-loop amplifier, \\( Z_L \\), were equal to its output impedance, \\( Z_{out} \\) in Fig. 5.18, the closed-loop amplifier gain would be precisely one-half the value obtained with \\( Z_L = \\infty \\). In this scenario, the closed-loop gain with \\( Z_L = \\infty \\) is nearly unity. Therefore, substituting \\( Z_L = Z_{out} \\) and \\( A_{CL} = 1/2 \\) into (5.61) and solving for \\( Z_{out} \\) yields\n\n$$\n\\frac{1}{2} = \\frac{A_v Z_{out}}{A_v Z_{out} + Z_{out} + Z_o} \\Rightarrow Z_{out} = Z_o \\cdot \\frac{1}{A_v - 1}\n$$\n\nUsing the DC values from Example 5.10, \\( Z_o = 500 \\Omega \\) and \\( A_v = A_{v0} = 10^4 \\), the DC closed-loop output impedance is calculated as\n\n$$\nZ_{out} = \\frac{(500 \\Omega)}{(10^4 - 1)} \\cong 0.05 \\Omega\n$$\n\n#### Key Point: Another\n\nsignificant advantage of feedback in CMOS integrated circuits is the substantial reduction in the output impedance of an amplifier by a factor roughly equivalent to the loop gain. This effectively increases the amplifier's input impedance; the feedback ensures that the op-amp input terminals are subjected to only very small differential voltages, \\( v_i \\), necessitating minimal input current. Although MOSFET gates inherently provide high input impedance even without feedback, current feedback can be leveraged to achieve very low input impedances, which is particularly beneficial when designing CMOS circuits to amplify current signals.\n\nFor instance, a common-source amplifier's output impedance depends on its small-signal \\( r_{ds} \\) in active mode, which is inversely proportional to its drain current. Consequently, to reduce the output impedance, the drain current must be increased.\n\nIn summary, feedback in integrated circuits effectively reduces the output impedance of an amplifier. Specifically, the output impedance of the amplifier, including the loading of the feedback network, is diminished by a factor approximately equal to the loop gain, \\( L \\). This is a crucial aspect of feedback, especially in CMOS integrated circuits, where achieving low output impedance without feedback would necessitate high power dissipation."
},
{
    "text": "A prime illustration of a feedback amplifier is the generalized noninverting operational amplifier depicted in Fig. 5.15. It is presumed that the operational amplifier possesses a frequency-dependent voltage gain, denoted as $\\mathrm{A}_{\\mathrm{v}}(\\mathrm{s})$, and has complex input and output impedances represented by $Z_{i}(\\mathrm{~s})$ and $Z_{o}(s)$, respectively. A comprehensive circuit model is presented in Fig. 5.16. Observing that the circuit depicted in Fig. 5.14 employs a substantial ideal inductance to open the loop and introduces a test signal through a large coupling capacitor, this arrangement allows for the determination of the small-signal loop gain during simulation while preserving the DC biasing of the circuit.\n\nFig. 5.14 illustrates the use of a large ideal inductance to break the loop and the introduction of a test signal via a large coupling capacitor to ascertain the small-signal loop gain in simulation without disturbing the circuit's DC biasing.\n\nFig. 5.15 presents a generalized noninverting feedback operational amplifier configuration.\n\nThe small-signal model of a noninverting feedback amplifier is shown in Fig. 5.16. The circuit incorporates an operational amplifier with feedback components Z1 and Z2. The input signal is applied through a voltage source Vs and resistor Zs, and the output is measured across the load resistor ZL. The operational amplifier has a small-signal open-circuit gain Av(s)Vi and is configured with input and feedback resistors Zi and Zo.\n\nThe gain $A_{v}$ represents the (small-signal) open-circuit gain of the operational amplifier and is thus not the same as the forward-path gain $A$ of the feedback amplifier, which must account for all loading.\n\n#### EXAMPLE 5.10\n\nAn operational amplifier's specifications indicate an input capacitance of 0.5 pF, an output resistance of $500 \\Omega$, a DC gain of 80 dB, and a unity-gain frequency of 100 MHz. Additionally, the specification notes that the operational amplifier exhibits a phase response of -105 degrees at the unity-gain frequency of $A_{v}(s)$. Determine the operational amplifier model components: $Z_{i}, Z_{o}$, and $A_{v}(s)$.\n\n#### Solution\n\nThe input and output impedances are explicitly provided in the specification.\n\n$$\n\\begin{gathered}\nZ_{i}(s)=\\frac{1}{\\left(5 \\cdot 10^{-13}\\right) s} \\Omega \\\\\nZ_{0}(s)=500 \\Omega\n\\end{gathered}\n$$\n\nFor the gain, we utilize a second-order model akin to (5.34).\n\n$$\n\\begin{equation*}\nA_{v}(s)=\\frac{A_{v 0}}{\\left(1+s / \\omega_{\\mathrm{p} 1}\\right)\\left(1+s / \\omega_{e q}\\right)} \\tag{5.54}\n\\end{equation*}\n$$\n\nA DC gain of 80 dB implies $\\mathrm{A}_{\\mathrm{v} 0}=10^{4}$. Given that the unity-gain frequency, $\\omega_{\\mathrm{ta}}$, satisfies $\\omega_{\\mathrm{p} 1}$ 《 $\\omega_{\\mathrm{ta}}$ « $\\omega_{\\mathrm{p} 2}$, the dominant pole frequency is\n\n$$\n\\begin{equation*}\n\\omega_{\\mathrm{p} 1}=\\frac{\\omega_{\\mathrm{ta}}}{\\mathrm{~A}_{\\mathrm{v} 0}}=2 \\pi \\frac{10^{8}}{10^{4}}=2 \\pi \\cdot\\left(10^{4} \\mathrm{~Hz}\\right) \\tag{5.55}\n\\end{equation*}\n$$\n\nTo determine the non-dominant pole frequency, we assume the dominant pole contributes $-90^{\\circ}$ phase shift at $\\omega_{\\mathrm{ta}}$, and hence,\n\n$$\n\\begin{equation*}\n\\tan ^{-1}\\left(\\frac{\\omega_{\\mathrm{ta}}}{\\omega_{\\mathrm{eq}}}\\right)=15^{\\circ} \\Rightarrow \\frac{\\omega_{\\mathrm{ta}}}{\\omega_{\\mathrm{eq}}}=0.270 \\Rightarrow \\omega_{\\mathrm{eq}}=\\frac{\\omega_{\\mathrm{ta}}}{0.270}=2 \\pi \\cdot\\left(3.70 \\cdot 10^{8} \\mathrm{~Hz}\\right) \\tag{5.56}\n\\end{equation*}\n$$\n\nIt is widely recognized that the gain of the noninverting amplifier under ideal conditions of infinite operational amplifier gain is\n\n$$\n\\begin{align*}\n& \\frac{1}{\\beta}=\\frac{Z_{1}+Z_{2}}{Z_{1}}  \\tag{5.57}\\\\\n& \\Rightarrow \\beta=\\frac{Z_{1}}{Z_{1}+Z_{2}}\n\\end{align*}\n$$\n\nTo ascertain the loop gain, we must scrutinize the circuit depicted in Fig. 5.17. The loop is severed at the output of the controlled-source $A_{v}$, which emulates the operational amplifier voltage gain. Since the termination impedance, $Z_{t}$, is placed across an ideal voltage source, its value will exert no influence on the analysis. The redrawn schematic at the base of Fig. 5.17 clearly reveals\n\n$$\n\\begin{gather*}\nv_{r}=A_{v}(s) v_{i}=-A_{v}(s) \\frac{Z_{i}}{Z_{o}}\\left[\\frac{Z_{L}| | Z_{o}}{Z_{L}| | Z_{o}+Z_{2}+Z_{1}| |\\left(Z_{s}+Z_{i}\\right)}\\right]\\left[\\frac{Z_{1}}{Z_{s}+Z_{i}+Z_{1}}\\right] v_{t} \\\\\nL(s)=A_{v}(s) \\frac{Z_{i}}{Z_{o}}\\left[\\frac{Z_{L}| | Z_{o}}{Z_{L}| | Z_{o}+Z_{2}+Z_{1}| |\\left(Z_{s}+Z_{i}\\right)}\\right]\\left[\\frac{Z_{1}}{Z_{s}+Z_{i}+Z_{1}}\\right] \\tag{5.58}\n\\end{gather*}\n$$\n\nA Bode plot of $\\mathrm{L}(\\mathrm{s})$ reveals the phase margin. Incorporating (5.57) and (5.58) into (5.51) and (5.52) yields the closed-loop frequency response and gain error. Assuming the simplifying assumptions $Z_{i} \\gg Z_{1}, Z_{s}$ and $Z_{o}$ « $Z_{L}, Z_{2}$ are valid (i.e., the operational amplifier possesses relatively high input impedance and low output impedance), (5.58) simplifies to a straightforward result.\n\n$$\n\\begin{equation*}\n\\mathrm{L}(\\mathrm{~s}) \\approx \\mathrm{A}_{\\mathrm{v}}(\\mathrm{~s}) \\frac{\\mathrm{Z}_{1}}{\\mathrm{Z}_{1}+\\mathrm{Z}_{2}}=\\mathrm{A}_{\\mathrm{v}}(\\mathrm{~s}) \\beta \\tag{5.59}\n\\end{equation*}\n$$\n\n#### EXAMPLE 5.11\n\nThe operational amplifier from Example 5.10 is intended for driving a load of $Z_{L}=200 \\Omega$ in a unity-gain configuration, as illustrated in Fig. 5.18. Calculate the DC gain error, phase margin, and bandwidth.\n\n#### Solution\n\nA unity-gain operational amplifier configuration is a specific instance of the noninverting operational amplifier where $\\mathbf{Z}_{1}=\\infty$ and $Z_{2}=0$. Inserting these values and $Z_{s}=0$ into (5.58), and assuming $Z_{L} \\ll Z_{i}$,\n\n$$\n\\begin{equation*}\nL(s)=A_{v}(s)\\left(\\frac{Z_{L}}{Z_{L}+Z_{o}}\\right) \\tag{5.60}\n\\end{equation*}\n$$\n\nSince the desired gain is $1 / \\beta=1$, the closed-loop gain becomes\n\n$$\n\\begin{equation*}\nA_{C L}(s)=\\frac{L(s)}{1+L(s)}=\\frac{A_{v}(s) Z_{L}}{A_{v}(s) Z_{L}+Z_{L}+Z_{0}} \\tag{5.61}\n\\end{equation*}\n$$\n\nA numerical value for the gain error is obtained using the parameter values for the operational amplifier at DC,\n\n$$\n\\begin{equation*}\n1-\\frac{\\mathrm{L}_{0}}{1+\\mathrm{L}_{0}}=1-\\frac{\\mathrm{A}_{\\mathrm{v} 0} \\mathrm{Z}_{\\mathrm{L}}}{\\mathrm{~A}_{\\mathrm{v} 0} \\mathrm{Z}_{\\mathrm{L}}+\\mathrm{Z}_{\\mathrm{L}}+\\mathrm{Z}_{\\mathrm{o}}}=0.0003 \\tag{5.62}\n\\end{equation*}\n$$\n\nindicating a gain error of 0.03%.\n\nSubstituting (5.54) into equation (5.60) yields the loop gain,\n\n$$\n\\begin{equation*}\nL(s)=\\frac{A_{v 0}}{\\left(1+\\frac{s}{\\omega_{\\mathrm{p} 1}}\\right)\\left(1+\\frac{s}{\\omega_{\\mathrm{eq}}}\\right)}\\left(\\frac{Z_{\\mathrm{L}}}{Z_{\\mathrm{L}}+Z_{\\mathrm{o}}}\\right) \\tag{5.63}\n\\end{equation*}\n$$\n\nA Bode plot of (5.63) indicates a phase margin of $85.6^{\\circ}$.\nUltimately, the bandwidth may be ascertained by solving for the -3 dB frequency of (5.61). To simplify the analysis, note that the phase margin is close to $90^{\\circ}$, so the equivalent second pole $\\omega_{\\text {eq }}$ plays a minor role at frequencies around the closed-loop bandwidth. Therefore, a first-order approximation may be employed for the operational amplifier, $\\mathrm{A}_{\\mathrm{v}}(\\mathrm{s}) \\cong \\omega_{\\mathrm{ta}} / \\mathrm{s}$. Inserting this into (5.61) results in\n\n$$\n\\begin{equation*}\n\\mathrm{A}_{\\mathrm{CL}}(\\mathrm{~s}) \\cong \\frac{1}{1+\\left(\\frac{Z_{\\mathrm{L}}+Z_{\\mathrm{o}}}{\\mathrm{Z}_{\\mathrm{L}}}\\right) \\frac{\\mathrm{s}}{\\omega_{\\mathrm{ta}}}} \\tag{5.64}\n\\end{equation*}\n$$\n\nfrom which it straightforwardly follows that the $3-\\mathrm{dB}$ bandwidth is approximately $\\left(\\omega_{t a} Z_{L}\\right) /\\left(Z_{L}+Z_{o}\\right)$, which in this case equals $2 \\pi \\cdot 2.86 \\mathrm{MHz}$.\n\n#### EXAMPLE 5.12\n\nWhat is the output impedance of the closed-loop amplifier in Example 5.11?\n\n#### Solution\n\nIf the load of the closed-loop amplifier, $Z_{\\mathrm{L}}$, were equivalent to its output impedance, $Z_{\\text {out }}$ in Fig. 5.18, the closed-loop amplifier gain would be precisely one-half the value obtained with $Z_{L}=\\infty$. In this scenario, the closed-loop gain with $Z_{L}=\\infty$ is almost exactly unity. Therefore, we can substitute $Z_{L}=Z_{\\text {out }}$ and $A_{C L}=1 / 2$ into (5.61) and solve for $\\mathrm{Z}_{\\text {out }}$.\n\n$$\n\\frac{1}{2}=\\frac{A_{v} Z_{\\text {out }}}{A_{v} Z_{\\text {out }}+Z_{\\text {out }}+Z_{o}} \\Rightarrow Z_{\\text {out }}=Z_{o} \\cdot \\frac{1}{A_{v}-1}\n$$\n\nSubstituting in DC values from Example 5.10, $Z_{o}=500 \\Omega$ and $A_{v}=A_{v 0}=10^{4}$, yields a DC closed-loop output impedance of\n\n$$\n\\mathrm{Z}_{\\text {out }}=\\frac{(500 \\Omega)}{\\left(10^{4}-1\\right)} \\cong 0.05 \\Omega\n$$\n\n#### Key Point: Another\n\nsignificant attribute of feedback in CMOS integrated circuits is that it diminishes the output impedance of an amplifier by a factor approximately equal to the loop gain. This effectively enhances the amplifier's input impedance; the feedback ensures the operational amplifier input terminals are subjected to only very small differential voltages, $\\mathrm{v}_{\\mathrm{i}}$, so clearly very little input current is required. However, this is not a particularly remarkable property since MOSFET gates provide relatively high input impedance even without feedback. Nevertheless, we shall see in the next section that current feedback can be utilized to achieve very low input impedances, which can be particularly useful when designing a CMOS circuit to amplify current signals.\n6. For instance, a common-source amplifier has an output impedance that depends on its small-signal $r_{d s}$ in active mode, which is in turn inversely proportional to its drain current. Thus, to diminish the output impedance, the drain current must increase.\n\nIn summary, feedback in integrated circuits effectively diminishes the output impedance of an amplifier. Specifically, the output impedance of the amplifier, including the loading of the feedback network, is reduced by a factor approximately equal to the loop gain, L. This is a significant attribute of feedback, particularly in CMOS integrated circuits where low output impedance would otherwise necessitate high power dissipation. ${ }^{6}$\n\nNoninverting amplifiers are said to employ voltage feedback because the signal being subtracted from the source is a voltage—in this case, the voltage at the negative operational amplifier terminal."
}
]