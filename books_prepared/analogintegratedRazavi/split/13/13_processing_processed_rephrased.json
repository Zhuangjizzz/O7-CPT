[

{
    "text": "Our examination of amplifiers in earlier chapters has solely focused on scenarios where the input signal is perpetually present and fed into the circuit, with the output signal being continuously monitored. These are termed \"continuous-time\" circuits, which are extensively used in audio, video, and high-speed analog systems. Nonetheless, in numerous instances, we may only detect the input at specific, regular intervals, disregarding its value at other times. The circuit then processes each individual \"sample,\" generating a valid output at the conclusion of each interval. Such circuits are known as \"discrete-time\" or \"sampled-data\" systems.\n\nIn this chapter, we delve into a prevalent category of discrete-time systems referred to as \"switched-capacitor (SC) circuits.\" Our aim is to lay the groundwork for more sophisticated subjects like filters, comparators, ADCs, and DACs. The majority of our exploration centers on switched-capacitor amplifiers, though the principles can be extended to other discrete-time circuits as well. We start with an overarching perspective on SC circuits, discussing sampling switches and their associated speed and precision challenges. Following this, we analyze switched-capacitor amplifiers, examining unity-gain, noninverting, and multiply-by-two configurations. Lastly, we investigate a switched-capacitor integrator."
},
{
    "text": "Our exploration of amplifiers in earlier chapters has solely addressed scenarios where the input signal is perpetually present and fed into the circuit, with the output signal being continuously monitored. These are termed \"continuous-time\" circuits, which are extensively used in audio, video, and high-speed analog systems. Nonetheless, in numerous instances, we may only detect the input at specific, regular intervals, disregarding its value at other times. The circuit then processes each individual \"sample,\" generating a valid output at the conclusion of each interval. Such circuits are known as \"discrete-time\" or \"sampled-data\" systems.\n\nIn this chapter, we delve into a prevalent category of discrete-time systems referred to as \"switched-capacitor (SC) circuits.\" Our aim is to lay the groundwork for more intricate subjects like filters, comparators, ADCs, and DACs. The majority of our examination focuses on switched-capacitor amplifiers, though the principles can be extended to other discrete-time circuits as well. We commence with an overarching perspective on SC circuits, discussing sampling switches and the associated challenges of speed and precision. Subsequently, we analyze switched-capacitor amplifiers, covering unity-gain, noninverting, and multiply-by-two configurations. Ultimately, we investigate a switched-capacitor integrator."
},
{
    "text": "Our examination of amplifiers in earlier chapters has solely addressed scenarios where the input signal is perpetually present and applied to the circuit, with the output signal being continuously monitored. These are known as \"continuous-time\" circuits and are extensively used in audio, video, and high-speed analog systems. However, in numerous instances, we only detect the input at specific, regular intervals, disregarding its value at other times. The circuit then processes each individual \"sample,\" generating a valid output at the conclusion of each interval. Such circuits are termed \"discrete-time\" or \"sampled-data\" systems.\n\nIn this chapter, we explore a prevalent category of discrete-time systems known as \"switched-capacitor (SC) circuits.\" Our aim is to establish the groundwork for more sophisticated subjects like filters, comparators, ADCs, and DACs. The majority of our investigation focuses on switched-capacitor amplifiers, though the principles can be extended to other discrete-time circuits. We start with an overarching perspective of SC circuits, detailing sampling switches and their associated speed and precision challenges. Subsequently, we analyze switched-capacitor amplifiers, examining unity-gain, noninverting, and multiply-by-two configurations. Lastly, we investigate a switched-capacitor integrator."
},
{
    "text": "Our examination of amplifiers in prior chapters has solely addressed scenarios where the input signal is perpetually present and applied to the circuit, with the output signal being continuously monitored. These are termed \"continuous-time\" circuits and are extensively used in audio, video, and high-speed analog systems. Nonetheless, in numerous instances, we might only detect the input at specific, periodic intervals, disregarding its value at other times. The circuit then processes each individual \"sample,\" generating a valid output at the conclusion of each period. Such circuits are known as \"discrete-time\" or \"sampled-data\" systems.\n\nIn this chapter, we delve into a prevalent category of discrete-time systems referred to as \"switched-capacitor (SC) circuits.\" Our aim is to establish the groundwork for more intricate subjects like filters, comparators, ADCs, and DACs. The majority of our exploration focuses on switched-capacitor amplifiers, though the principles can be extended to other discrete-time circuits. We initiate with an overview of SC circuits, detailing sampling switches and the associated challenges of speed and precision. Subsequently, we analyze switched-capacitor amplifiers, examining unity-gain, noninverting, and multiply-by-two configurations. Ultimately, we investigate a switched-capacitor integrator."
},
{
    "text": "Our examination of amplifiers in prior chapters has solely addressed scenarios where the input signal is perpetually present and applied to the circuit, with the output signal being continuously monitored. These are termed \"continuous-time\" circuits and are extensively used in audio, video, and high-speed analog systems. Nevertheless, in numerous instances, we might only detect the input at specific, regular intervals, disregarding its value at other times. The circuit then processes each individual \"sample,\" generating a valid output at the conclusion of each interval. Such circuits are known as \"discrete-time\" or \"sampled-data\" systems.\n\nIn this chapter, we delve into a prevalent category of discrete-time systems referred to as \"switched-capacitor (SC) circuits.\" Our aim is to establish the groundwork for more sophisticated subjects like filters, comparators, ADCs, and DACs. The majority of our exploration focuses on switched-capacitor amplifiers, though the principles can also be extended to other discrete-time circuits. We initiate with an overarching perspective of SC circuits, detailing sampling switches and the associated challenges of speed and precision. Subsequently, we analyze switched-capacitor amplifiers, examining unity-gain, noninverting, and multiply-by-two configurations. Lastly, we investigate a switched-capacitor integrator."
},
{
    "text": "Our examination of amplifiers in prior chapters has exclusively covered scenarios where the input signal is perpetually present and applied to the circuit, with the output signal being continuously monitored. These are termed \"continuous-time\" circuits and are extensively used in audio, video, and high-speed analog systems. However, in numerous instances, we only detect the input at specific, regular intervals, disregarding its value at other times. The circuit then processes each individual \"sample,\" generating a valid output at the conclusion of each interval. Such circuits are known as \"discrete-time\" or \"sampled-data\" systems.\n\nIn this chapter, we delve into a prevalent category of discrete-time systems referred to as \"switched-capacitor (SC) circuits.\" Our aim is to establish the groundwork for more intricate subjects like filters, comparators, ADCs, and DACs. The majority of our exploration focuses on switched-capacitor amplifiers, though the principles are applicable to other discrete-time circuits as well. We initiate with an overarching perspective on SC circuits, detailing sampling switches and the associated challenges of speed and precision. Subsequently, we analyze switched-capacitor amplifiers, examining unity-gain, noninverting, and multiply-by-two configurations. Ultimately, we investigate a switched-capacitor integrator."
},
{
    "text": "In earlier chapters, our examination of amplifiers has solely focused on scenarios where the input signal is perpetually present and applied to the circuit, with the output signal being continuously monitored. These are termed \"continuous-time\" circuits and are extensively used in audio, video, and high-speed analog systems. However, in numerous instances, we only detect the input at specific, regular intervals, disregarding its value at other times. The circuit then processes each individual \"sample,\" generating a valid output at the conclusion of each interval. These types of circuits are known as \"discrete-time\" or \"sampled-data\" systems.\n\nThis chapter delves into a prevalent category of discrete-time systems referred to as \"switched-capacitor (SC) circuits.\" Our aim is to establish a foundational understanding for more sophisticated subjects like filters, comparators, ADCs, and DACs. The majority of our exploration centers on switched-capacitor amplifiers, though the principles can be extended to other discrete-time circuits as well. We initiate with an overarching perspective of SC circuits, detailing sampling switches and the associated challenges of speed and precision. Subsequently, we analyze various switched-capacitor amplifiers, including unity-gain, noninverting, and multiply-by-two configurations. Lastly, we investigate a switched-capacitor integrator."
},
{
    "text": "Our examination of amplifiers in earlier chapters has solely addressed scenarios where the input signal is consistently present and applied to the circuit, with the output signal being continuously monitored. These are known as \"continuous-time\" circuits and are extensively used in audio, video, and high-speed analog systems. However, in numerous instances, we only detect the input at specific, regular intervals, disregarding its value at other times. The circuit then processes each individual \"sample,\" generating a valid output at the conclusion of each interval. Such circuits are termed \"discrete-time\" or \"sampled-data\" systems.\n\nIn this chapter, we delve into a prevalent category of discrete-time systems referred to as \"switched-capacitor (SC) circuits.\" Our aim is to establish a groundwork for more sophisticated subjects like filters, comparators, ADCs, and DACs. The majority of our exploration focuses on switched-capacitor amplifiers, though the principles can also be extended to other discrete-time circuits. We initiate with an overview of SC circuits, detailing sampling switches and their associated speed and precision challenges. Subsequently, we analyze switched-capacitor amplifiers, examining unity-gain, noninverting, and multiply-by-two configurations. Lastly, we investigate a switched-capacitor integrator."
},
{
    "text": "---[Attention]---\nWhen examining image descriptions, note that images linked within the [Context Provided] have been converted into textual descriptions. You are also tasked with rephrasing the content within the [Context Provided] Section to ensure it retains its original meaning and length.\n---[Task]---\nPlease rephrase the text provided in the [Context Provided] Section, ensuring the rephrased version maintains the original intent and length. Your response should only contain the rephrased text.\n---[Context Provided]---\nTo comprehend the rationale behind sampled-data circuits, let's initially look at the straightforward continuous-time amplifier depicted in Figure 13.1(a), where the ratio of \\(V_{\\text {out }}\\) to \\(V_{\\text {in }}\\) is theoretically equal to \\(-R_{2} / R_{1}\\). This configuration, frequently paired with bipolar operational amplifiers, poses a challenge when implemented in CMOS technology. Remember that CMOS op amps maximize the open-loop output resistance for high voltage gain, usually reaching hundreds of kilohms. This leads us to suspect that \\(R_{2}\\) significantly reduces the open-loop gain, compromising the circuit's accuracy. In reality, with the help of the elementary equivalent circuit depicted in the following image, we observe that \\(R_{2}\\) has a substantial impact on the open-loop gain, particularly in CMOS technology.\n\n[Image shown]\n\nThe circuit in Figure 13.1(b) represents an equivalent circuit of a continuous-time feedback amplifier. It models the amplifier's behavior using resistors \\(R_{1}\\), \\(R_{2}\\), and \\(R_{out}\\), as well as an operational amplifier with gain \\(A_v\\). The intermediate node \\(V_{x}\\) connects \\(R_{1}\\) and \\(R_{2}\\), and the output voltage is measured across \\(R_{out}\\).\n\n[Image shown]\n\nFigure 13.1 shows a continuous-time feedback amplifier, with Figure 13.1(a) presenting the amplifier itself and Figure 13.1(b) depicting its equivalent circuit.\n\nWe can derive the following equation using the simple equivalent circuit shown in the previous image:\n\n\\[\n\\begin{equation*}\n-A_{v}\\left(\\frac{V_{\\text {out }}-V_{\\text {in }}}{R_{1}+R_{2}} R_{1}+V_{\\text {in }}\\right)-R_{\\text {out }} \\frac{V_{\\text {out }}-V_{\\text {in }}}{R_{1}+R_{2}}=V_{\\text {out }} \\tag{13.1}\n\\end{equation*}\n\\]\n\nFrom this, we can deduce:\n\n\\[\n\\begin{equation*}\n\\frac{V_{\\text {out }}}{V_{\\text {in }}}=-\\frac{R_{2}}{R_{1}} \\cdot \\frac{A_{v}-\\frac{R_{\\text {out }}}{R_{2}}}{1+\\frac{R_{\\text {out }}}{R_{1}}+A_{v}+\\frac{R_{2}}{R_{1}}} \\tag{13.2}\n\\end{equation*}\n\\]\n\nEquation (13.2) indicates that compared to the scenario where \\(R_{\\text {out }}=0\\), the closed-loop gain is subject to inaccuracies in both the numerator and the denominator. Moreover, the amplifier's input resistance, which is approximately equal to \\(R_{1}\\), loads the preceding stage while introducing thermal noise.\n\n[Example 13.1]\nUtilize the feedback strategies outlined in Chapter 8 to calculate the closed-loop gain of the circuit depicted in Figure 13.1(a) and compare the outcome to Eq. (13.2).\n\n[Solution]\nApplying the method described in Example 8.16, the reader can establish that:\n\n\\[\n\\begin{align*}\n\\frac{V_{\\text {out }}}{V_{\\text {in }}} & =\\frac{-R^{2} A_{v}}{R_{2}^{2}+R_{1} R_{\\text {out }}+R_{2} R_{\\text {out }}+\\left(1+A_{v}\\right) R_{1} R_{2}}  \\tag{13.3}\\\\\n& =-\\frac{R_{2}}{R_{1}} \\cdot \\frac{A_{v}}{\\frac{R_{2}}{R_{1}}+\\frac{R_{\\text {out }}}{R_{2}}+\\frac{R_{\\text {out }}}{R_{1}}+1+A_{v}} \\tag{13.4}\n\\end{align*}\n\\]\n\nThe two expressions are roughly equal if \\(R_{\\text {out }} / R_{2} \\ll A_{v}\\), which is a requirement to ensure the negligible transmission through \\(R_{2}\\).\n\nIn the circuit of Figure 13.1(a), the closed-loop gain is determined by the ratio of \\(R_{2}\\) to \\(R_{1}\\). To prevent diminishing the open-loop gain of the op amp, it is proposed that the resistors can be replaced by capacitors [Figure 13.2(a)]. The ideal gain of the circuit is equivalent to the impedance of \\(C_{2}\\) divided by the impedance of \\(C_{1}\\) and multiplied by -1, that is, it is equal to \\(-C_{1} / C_{2}\\).\n\n[Image shown]\n\nFigure 13.2(a) illustrates a continuous-time feedback amplifier that employs capacitors, with the closed-loop gain determined by the ratio of \\(C_{2}\\) to \\(C_{1}\\), ideally \\(-C_{1} / C_{2}\\).\n\n[Image shown]\n\nIn the circuit of Figure 13.1(a), the closed-loop gain is determined by the ratio of \\(R_{2}\\) to \\(R_{1}\\). To avoid reducing the open-loop gain of the op amp, we suggest that the resistors can be replaced by capacitors [Figure 13.2(a)]. Ideally, the circuit's gain is equal to the impedance of \\(C_{2}\\) divided by the impedance of \\(C_{1}\\) and multiplied by -1, i.e., \\(-C_{1} / C_{2}\\).\n\n[Image shown]\n\nFigure 13.2(a) depicts a continuous-time feedback amplifier using capacitors, while Figure 13.2(b) shows the use of a resistor to define the bias point at node \\(X\\).\n\n[Image shown]\n\nFigure 13.3 illustrates a time-domain waveform that portrays the step response of an amplifier circuit. The horizontal axis denotes time (\\(t\\)), and the vertical axis indicates voltage, featuring two distinct levels labeled \\(V_{\\text {in}}\\) and \\(V_{\\text {out}}\\).\n\n[Image shown]\n\nThis step response graph analyzes how an amplifier responds to a sudden change in input voltage over time. The horizontal axis, typically denoted as \\(t\\) in seconds or milliseconds, represents time, while the vertical axis, usually labeled as voltage in volts, indicates the voltage level.\n\nThe graph illustrates a sharp step input \\(V_{\\text {in}}\\), which remains constant after the initial step. The output voltage \\(V_{\\text {out}}\\) starts at a lower level, then increases gradually, following an exponential curve, to reach a steady state. This indicates the amplifier's response to the input step.\n\nThe output voltage \\(V_{\\text {out}}\\) initially rises sharply, reflecting a rapid response to the input step, followed by an exponential growth pattern as it approaches the steady state. Eventually, \\(V_{\\text {out}}\\) stabilizes, suggesting the completion of the transient response phase.\n\nThe graph does not include specific numerical values or annotations for time constants or voltage levels. The step input \\(V_{\\text {in}}\\) is depicted as a constant voltage level after the initial step, and \\(V_{\\text {out}}\\) is shown rising to match this level over time.\n\nThis graph effectively demonstrates the transient behavior of the amplifier circuit when exposed to a step input, emphasizing the time it takes for the output to reach a new voltage level and stabilize.\n\n[Image shown]\n\nHow does the bias voltage at node \\(X\\) get established? By adding a large feedback resistor similar to Figure 13.2(b), we can provide DC feedback without significantly affecting the amplifier's AC behavior within the frequency band of interest. This setup is practical if the circuit senses only high-frequency signals. However, if the circuit is intended to amplify a voltage step, as shown in Figure 13.3, the response includes a step change due to the initial amplification by the circuit comprising \\(C_{1}\\), \\(C_{2}\\), and the op amp, followed by a \"tail\" resulting from the discharge of \\(C_{2}\\) through \\(R_{F}\\). From another perspective, the circuit might not be suitable for amplifying wideband signals because it exhibits a high-pass transfer function. Indeed, the transfer function is given by:\n\n\\[\n\\begin{align*}\n\\frac{V_{\\text {out }}}{V_{\\text {in }}}(s) & \\approx-\\frac{R_{F} \\frac{1}{C_{2} s}}{R_{F}+\\frac{1}{C_{2} s}} \\div \\frac{1}{C_{1} s}  \\tag{13.5}\\\\\n& =-\\frac{R_{F} C_{1} s}{R_{F} C_{2} s+1} \\tag{13.6}\n\\end{align*}\n\\]\n\nThis implies that \\(V_{\\text {out }} / V_{\\text {in }} \\approx-C_{1} / C_{2}\\) only if \\(\\omega \\gg\\left(R_{F} C_{2}\\right)^{-1}\\).\n\nThe above issue can be addressed by increasing \\(R_{F} C_{2}\\), but in many cases, the required values for these two components become excessively large. Consequently, we must explore alternative methods for setting the bias while using capacitive feedback networks.\n\nIt is possible to replace \\(R_{F}\\) in Figure 13.2(b) with a switch. As depicted in Figure 13.4, the idea is to close switch \\(S_{2}\\) to place the op amp in unity-gain feedback, forcing \\(V_{X}\\) to \\(V_{B}\\), which is an appropriately selected input common-mode level for the op amp. Once the switch is turned off, node \\(X\\) retains this voltage, enabling proper operation. Of course, when \\(S_{2}\\) is on, the circuit does not amplify \\(V_{i n}\\).\n\n[Image shown]\n\nFigure 13.4 illustrates the use of a feedback switch to define the DC input level.\n\nConsider the switched-capacitor circuit shown in Figure 13.5, which is controlled by three switches: \\(S_{1}\\) and \\(S_{3}\\) connect the left plate of \\(C_{1}\\) to \\(V_{\\text {in}}\\) and ground, respectively, and \\(S_{2}\\) provides unity-gain feedback. Let's assume the op amp's open-loop gain is very large and analyze the circuit in two phases. Initially, \\(S_{1}\\) and \\(S_{2}\\) are closed, and \\(S_{3}\\) is open, resulting in the equivalent circuit depicted in Figure 13.6(a). For a high-gain op amp, \\(V_{B}=V_{\\text {out }} \\approx 0\\), and thus the voltage across \\(C_{1}\\) is approximately \\(V_{\\text {in}}\\).\n\n[Image shown]\n\n[Image shown]\n\nSeveral characteristics of the circuit in Figure 13.5 differentiate it from continuous-time implementations. First, the circuit allocates some time to \"sampling\" the input, halting output amplification and setting the output to zero during this period. Second, following sampling, after \\(t>t_{0}\\), the circuit disregards the input voltage \\(V_{\\text {in}}\\), amplifying the sampled voltage. Third, the circuit configuration changes significantly from one phase to another, as seen in Figure 13.6(a) and (b), prompting concerns about stability. Note that \\(S_{2}\\) must be toggled periodically to counteract the leakage currents that gradually discharge \\(X\\). These currents stem from \\(S_{2}\\) itself and the gate leakage of the op amp.\n\nWhat is the advantage of the amplifier in Figure 13.5 over the one in Figure 13.1? In addition to the sampling feature, the waveforms shown in Figure 13.6 indicate that after \\(V_{\\text {out}}\\) stabilizes at \\(V_{\\text {in}} \\cdot C_{1} / C_{2}\\), the current through \\(C_{2}\\) approaches zero. This means that the feedback capacitor does not diminish the open-loop gain of the amplifier if the output voltage is allowed to settle. Conversely, in Figure 13.1, \\(R_{2}\\) continuously loads the amplifier.\n\nThe switched-capacitor amplifier in Figure 13.5 is more conducive to implementation in CMOS technology compared to other technologies. This is because discrete-time operations necessitate switches for sampling and require a high input impedance to detect stored quantities without corruption. For instance, if the op amp in Figure 13.5 incorporates bipolar transistors at its input, the base current drawn from the inverting input during the amplification phase [Figure 13.6(b)] introduces an error in the output voltage. The presence of simple switches and high input impedance has made CMOS technology the dominant choice for sampled-data applications.\n\nThe discussion thus far leads to the conceptual view of switched-capacitor amplifiers as depicted in Figure 13.8. In the simplest case, the operation occurs in two phases: sampling and amplification. Hence, in addition to the analog input \\(V_{\\text {in}}\\), the circuit requires a clock to define each phase.\n\nOur study of switched-capacitor amplifiers will proceed according to these two phases. Initially, we will analyze various sampling techniques. Subsequently, we will examine SC amplifier topologies.\n\n[Image shown]\n\n[Image shown]\n\n[Image shown]\n\nThe graph labeled \"CK\" is a time-domain waveform illustrating the operation of a switched-capacitor amplifier circuit. The horizontal axis represents time (\\(t\\)), and the vertical axis represents the clock signal (\\(CK\\)), which is a digital waveform with two distinct levels corresponding to the sampling and amplification phases.\n\nThis rectangular pulse waveform indicates a digital clock signal that controls the switched-capacitor amplifier. The waveform features two primary phases:\n\n1. **Sample Phase:** The clock signal \\(CK\\) is high, denoting the period during which the input voltage \\(V_{\\text {in}}\\) is sampled. This phase is represented by the elevated portion of the waveform.\n2. **Amplify Phase:** The clock signal \\(CK\\) returns to low, marking the transition to the amplification phase where the previously sampled voltage is processed by the amplifier.\n\nThe waveform shows clear transitions from low to high and back to low, indicating the precise timing of the sampling and amplification phases. The width of the high pulse represents the duration of the sampling phase, which is crucial for determining how long the input signal is observed.\n\nThe graph includes annotations indicating the \"Sample\" and \"Amplify\" phases directly beneath the waveform, providing clarity on the function of each phase.\n\nFigure 13.8 shows a general view of a switched-capacitor amplifier that operates in two distinct phases: sampling and amplification. The diagram consists of two main blocks connected in series, with additional control provided by a clock signal (CK).\n\n1. **Main Components:**\n- **Sampling Block:** This block includes a switch and a capacitor. The switch is controlled by the clock signal (CK) and is used to sample the input voltage, \\(V_{\\text {in}}\\). When the clock signal is high, the switch closes, allowing the capacitor to charge to the input voltage level.\n- **Amplifier Block:** This block consists of an operational amplifier with a feedback capacitor. The sampled voltage from the sampling block is fed into this amplifier block, where it is amplified.\n\n2. **Flow of Information or Control:**\n- The input voltage \\(V_{\\text {in}}\\) is first directed to the sampling block. Here, the switch, controlled by the clock signal, determines when the input is sampled.\n- Once the input is sampled, the stored charge on the capacitor is transferred to the amplifier block.\n- The operational amplifier then processes this input, and the amplified output voltage \\(V_{\\text {out}}\\) is generated.\n- The clock signal (CK) orchestrates the timing of these phases, switching between sampling and amplification.\n\n3. **Labels, Annotations, and Key Indicators:**\n- **\\(V_{\\text {in}}\\):** Input voltage signal.\n- **\\(V_{\\text {out}}\\):** Output voltage signal.\n- **CK:** Clock signal that controls the switching between the sampling and amplification phases.\n- A timing diagram is included below the blocks, showing the clock signal's high phase corresponding to the sampling phase and the low phase corresponding to the amplification phase.\n\n4. **Overall System Function:**\n- The primary function of this system is to sample an analog input voltage and subsequently amplify it. The switched-capacitor topology allows precise sampling and amplification controlled by the clock signal. This design is particularly useful in sampled-data applications, where the timing of the sample and hold operation is critical for accurate signal processing."
},
{
    "text": "To grasp the rationale behind sampled-data circuits, we must first examine the straightforward continuous-time amplifier depicted in Fig. 13.1(a), where ideally, the ratio of the output voltage \\( V_{\\text {out }} \\) to the input voltage \\( V_{\\text {in }} \\) is \\( -R_{2} / R_{1} \\). Although widely employed with bipolar op-amps, this configuration encounters significant challenges when realized in CMOS technology. Remember that to enhance the voltage gain, the open-loop output resistance of CMOS op-amps is maximized, frequently reaching several hundred kilohms. Consequently, \\( R_{2} \\) is likely to substantially diminish the open-loop gain, compromising the circuit's precision. Indeed, with the help of the simple equivalent circuit depicted in the image, we can observe this effect.\n\nFig. 13.1(b) allows us to derive the following equation:\n\n\\[\n-A_{v}\\left(\\frac{V_{\\text {out }}-V_{\\text {in }}}{R_{1}+R_{2}} R_{1}+V_{\\text {in }}\\right)-R_{\\text {out }} \\frac{V_{\\text {out }}-V_{\\text {in }}}{R_{1}+R_{2}}=V_{\\text {out }}\n\\]\n\nFrom this, we can deduce:\n\n\\[\n\\frac{V_{\\text {out }}}{V_{\\text {in }}}=-\\frac{R_{2}}{R_{1}} \\cdot \\frac{A_{v}-\\frac{R_{\\text {out }}}{R_{2}}}{1+\\frac{R_{\\text {out }}}{R_{1}}+A_{v}+\\frac{R_{2}}{R_{1}}}\n\\]\n\nThis equation indicates that, in comparison to scenarios where \\( R_{\\text {out }}=0 \\), the closed-loop gain is marred by inaccuracies in both the numerator and the denominator. Additionally, the amplifier's input resistance, roughly equivalent to \\( R_{1} \\), imposes a load on the preceding stage while introducing thermal noise.\n\nExample 13.1 involves calculating the closed-loop gain of the circuit in Fig. 13.1(a) using feedback techniques discussed in Chapter 8 and comparing the findings with Eq. (13.2). The reader, guided by the method outlined in Example 8.16, can demonstrate that:\n\n\\[\n\\frac{V_{\\text {out }}}{V_{\\text {in }}} = \\frac{-R^{2} A_{v}}{R_{2}^{2}+R_{1} R_{\\text {out }}+R_{2} R_{\\text {out }}+\\left(1+A_{v}\\right) R_{1} R_{2}}\n\\]\n\nThe results from the two methods are approximately equivalent if \\( R_{\\text {out }} / R_{2} \\ll A_{v} \\), a condition necessary to ensure that the transmission through \\( R_{2} \\) is insignificant.\n\nIn the circuit of Fig. 13.1(a), the closed-loop gain is determined by the \\( R_{2} \\) to \\( R_{1} \\) ratio. To prevent diminishing the op-amp's open-loop gain, we hypothesize that the resistors can be substituted with capacitors as shown in Fig. 13.2(a). Ideally, the circuit's gain is the impedance of \\( C_{2} \\) divided by the impedance of \\( C_{1} \\), multiplied by -1, which is \\( -C_{1} / C_{2} \\).\n\nFig. 13.2(b) introduces a feedback resistor \\( R_{F} \\) to establish the bias point at node \\( X \\). This circuit, while practical for sensing high-frequency signals, may not be suitable for amplifying a voltage step due to the exponential tail in the response caused by the discharge of \\( C_{2} \\) through \\( R_{F} \\). Additionally, the circuit may not be appropriate for amplifying wideband signals because it exhibits a high-pass transfer function.\n\nThe transfer function is given by:\n\n\\[\n\\frac{V_{\\text {out }}}{V_{\\text {in }}}(s) \\approx -\\frac{R_{F} \\frac{1}{C_{2} s}}{R_{F}+\\frac{1}{C_{2} s}} \\div \\frac{1}{C_{1} s}\n\\]\n\nThis simplifies to:\n\n\\[\n\\frac{V_{\\text {out }}}{V_{\\text {in }}} \\approx -\\frac{R_{F} C_{1} s}{R_{F} C_{2} s+1}\n\\]\n\nindicating that \\( V_{\\text {out }} / V_{\\text {in }} \\approx -C_{1} / C_{2} \\) only if \\( \\omega \\gg\\left(R_{F} C_{2}\\right)^{-1} \\).\n\nOne method to address this issue is by increasing \\( R_{F} C_{2} \\), but in many applications, the required values for these components become excessively large. Therefore, alternative methods for establishing the bias using capacitive feedback networks must be explored.\n\nA possible solution is to replace \\( R_{F} \\) in Fig. 13.2(b) with a switch, as shown in Fig. 13.4. The idea is to close \\( S_{2} \\) to place the op-amp in unity-gain feedback, forcing \\( V_{X} \\) to \\( V_{B} \\), an appropriately chosen input common-mode level for the op-amp. Once \\( S_{2} \\) is opened, node \\( X \\) retains this voltage, allowing proper operation. However, when \\( S_{2} \\) is closed, the circuit does not amplify \\( V_{i n} \\).\n\nThe switched-capacitor circuit in Fig. 13.5 uses three switches to control its operation: \\( S_{1} \\) and \\( S_{3} \\) connect the left plate of \\( C_{1} \\) to \\( V_{i n} \\) and ground, respectively, while \\( S_{2} \\) provides unity-gain feedback. Assuming a very high open-loop gain for the op-amp, we analyze the circuit in two phases. First, \\( S_{1} \\) and \\( S_{2} \\) are closed, and \\( S_{3} \\) is open, resulting in the equivalent circuit of Fig. 13.6(a). For a high-gain op-amp, \\( V_{B}=V_{\\text {out }} \\approx 0 \\), so the voltage across \\( C_{1} \\) is approximately equal to \\( V_{\\text {in }} \\).\n\nAt \\( t=t_{0} \\), \\( S_{1} \\) and \\( S_{2} \\) open, and \\( S_{3} \\) closes, grounding node \\( A \\). Since the gain is \\( -C_{1} / C_{2} \\) and \\( V_{A} \\) changes from \\( V_{i n 0} \\) to 0, the output voltage must change from zero to \\( V_{i n 0} C_{1} / C_{2} \\).\n\nThis output voltage change can also be calculated by examining the transfer of charge. The charge stored on \\( C_{1} \\) just before \\( t_{0} \\) is \\( V_{i n 0} C_{1} \\). After \\( t=t_{0} \\), the negative feedback through \\( C_{2} \\) drives the op-amp input differential voltage, and hence the voltage across \\( C_{1} \\), to zero (Fig. 13.7). The charge stored on \\( C_{1} \\) at \\( t=t_{0} \\) is then transferred to \\( C_{2} \\), producing an output voltage of \\( V_{i n 0} C_{1} / C_{2} \\). Thus, the circuit amplifies \\( V_{i n 0} \\) by a factor of \\( C_{1} / C_{2} \\).\n\nThe switched-capacitor circuit of Fig. 13.5 differs from continuous-time implementations in several ways. It allocates time for \"sampling\" the input, setting the output to zero and providing no amplification during this period. After sampling, for \\( t>t_{0} \\), the circuit disregards the input voltage \\( V_{i n} \\) and amplifies the sampled voltage. The circuit configuration also undergoes significant changes from one phase to another, as seen in Fig. 13.6(a) and (b), raising concerns about stability. Note that \\( S_{2} \\) must close periodically to counteract the leakage currents that gradually discharge \\( X \\). These currents stem from \\( S_{2} \\) itself and the gate leakage of the op-amp.\n\nThe advantage of the amplifier in Fig. 13.5 over that in Fig. 13.1 lies in its sampling capability and the fact that the feedback capacitor does not diminish the open-loop gain if the output voltage is allowed sufficient time to stabilize. In contrast, \\( R_{2} \\) continuously loads the amplifier in Fig. 13.1.\n\nThe switched-capacitor amplifier in Fig. 13.5 is particularly well-suited for implementation in CMOS technology due to its discrete-time operations requiring switches for sampling and a high input impedance to sense stored quantities without distortion. For instance, if the op-amp in Fig. 13.5 employed bipolar transistors at its input, the base current drawn from the inverting input during the amplification phase [Fig. 13.6(b)] would introduce an error in the output voltage. The presence of simple switches and a high input impedance has made CMOS technology the preferred choice for sampled-data applications.\n\nThe discussion leads to the conceptual view in Fig. 13.8 for switched-capacitor amplifiers. In the simplest case, the operation occurs in two phases: sampling and amplification. Thus, in addition to the analog input \\( V_{i n} \\), the circuit requires a clock to define each phase.\n\nOur investigation of SC amplifiers follows these two phases. Initially, we analyze various sampling techniques. Then, we examine SC amplifier topologies."
},
{
    "text": "To grasp the incentives behind sampled-data circuits, we should initially examine the straightforward continuous-time amplifier depicted in Fig. 13.1(a), where ideally, the ratio of the output voltage to the input voltage ($V_{\\text {out }} / V_{\\text {in }}$) is equal to $-R_{2} / R_{1}$. This circuit, commonly employed with bipolar op amps, encounters a challenges when realized in CMOS technology. It's important to remember that, to attain a high voltage gain in CMOS op amps, the open-loop output resistance is maximized, often reaching hundreds hundred kilohms. Consequently, $R_{2}$ is substantially reduce the open-loop gain, compromising the circuit's accuracy\nTo comprehend the imp\nTo comprehend the incentives for sampled-data circuits, let should first examine the straightforward continuous-time amplifier depicted in Fig. 13.1(a), where ideally the the ratio of the output voltage to the input voltage ($V_{\\text {out }} / V_{\\text {in }}$) is equal to $-R_{2} / R_{1}$. This circuit, commonly utilized with bipolar op amps, encounters significant challenges when realized in CMOS technology. It's important to remember that, to achieve a high voltage gain in CMOS op amps, their open-loop output resistance is maximized, often reaching several hundred kilohms. Consequently, $R_{2}$ can significantly reduce the open-loop gain, compromising the circuit's precision. In fact, with the aid of the simple equivalent circuit shown in Fig. 13.1(b), we can write the equation for the output voltage as\n\n$$\n\\begin{equation*}\n-A_{v}\\left(\\frac{V_{\\text {out }}-V_{\\text {in }}}{R_{1}+R_{2}} R_{1}+V_{\\text {in }}\\right)-R_{\\text {out }} \\frac{V_{\\text {out }}-V_{\\text {in }}}{R_{1}+R_{2}}=V_{\\text {out }} \\tag{13.1}\n\\end{equation*}\n$$\n\nand hence\n\n$$\n\\begin{equation*}\n\\frac{V_{\\text {out }}}{V_{\\text {in }}}=-\\frac{R_{2}}{R_{1}} \\cdot \\frac{A_{v}-\\frac{R_{\\text {out }}}{R_{2}}}{1+\\frac{R_{\\text {out }}}{R_{1}}+A_{v}+\\frac{R_{2}}{R_{1}}} \\tag{13.2}\n\\end{equation*}\n$$\n\nEquation (13.2) suggests that, compared to the case where $R_{\\text {out }}=0$, the closed-loop gain is affected by inaccuracies in both the numerator and the denominator. Additionally, the input resistance of the amplifier, approximately equal to $R_{1}$, loads the preceding stage while introducing thermal noise.\n\n#### Example 13.1\n\nUsing the feedback techniques described in Chapter 8, calculate the closed-loop gain of the circuit of Fig. 13.1(a) and compare the result with Eq. (13.2).\n\n#### Solution\n\nBy applying the approach outlined in Example 8.16, the reader can verify that\n\n$$\n\\begin{align*}\n\\frac{V_{\\text {out }}}{V_{\\text {in }}} & =\\frac{-R^{2} A_{v}}{R_{2}^{2}+R_{1} R_{\\text {out }}+R_{2} R_{\\text {out }}+\\left(1+A_{v}\\right) R_{1} R_{2}}  \\tag{13.3}\\\\\n& =-\\frac{R_{2}}{R_{1}} \\cdot \\frac{A_{v}}{\\frac{R_{2}}{R_{1}}+\\frac{R_{\\text {out }}}{R_{2}}+\\frac{R_{\\text {out }}}{R_{1}}+1+A_{v}} \\tag{13.4}\n\\end{align*}\n$$\n\nThe two results are approximately equal if $R_{\\text {out }} / R_{2} \\ll A_{v}$, a condition necessary to ensure that the transmission through $R_{2}$ is negligible.\n\nIn the circuit of Fig. 13.1(a), the closed-loop gain is determined by the ratio of $R_{2}$ and $R_{1}$. To prevent diminishing the open-loop gain of the op amp, we propose that the resistors can be substituted with capacitors [Fig. 13.2(a)]. Ideally, the gain of the circuit is the impedance of $C_{2}$ divided by the impedance of $C_{1}$ and multiplied by -1, i.e., equal to $-C_{1} / C_{2}$.\n\nThe circuit in Fig. 13.2(a) is a continuous-time feedback amplifier using capacitors. The closed-loop gain is set by the ratio of C2 and C1, ideally equal to -C1/C2. In Fig. 13.2(b), a feedback resistor RF is added to define the bias point at node X.\n\nFigure 13.3 illustrates the step response of the amplifier of Fig. 13.2(b). The graph is a time-domain waveform showing how the amplifier responds to a sudden change in input voltage over time. The x-axis represents time (t), while the y-axis indicates voltage, with two distinct levels labeled as \\( V_{in} \\) and \\( V_{out} \\).\n\nThe graph demonstrates the transient behavior of the amplifier circuit when subjected to a step input, highlighting the time it takes for the output to stabilize at a new voltage level.\n\nBut, how is the bias voltage at node $X$ set? We may add a large feedback resistor as in Fig. 13.2(b), providing dc feedback while negligibly affecting the ac behavior of the amplifier in the frequency band of interest. Such an arrangement is indeed practical if the circuit senses only high-frequency signals. However, if the circuit is to amplify a voltage step, as illustrated in Fig. 13.3, the response contains a step change due to the initial amplification by the circuit consisting of $C_{1}, C_{2}$, and the op amp, followed by a \"tail\" resulting from the loss of charge on $C_{2}$ through $R_{F}$. From another point of view, the circuit may not be suited to amplify wideband signals because it exhibits a high-pass transfer function. In fact, the transfer function is given by\n\n$$\n\\begin{align*}\n\\frac{V_{\\text {out }}}{V_{\\text {in }}}(s) & \\approx-\\frac{R_{F} \\frac{1}{C_{2} s}}{R_{F}+\\frac{1}{C_{2} s}} \\div \\frac{1}{C_{1} s}  \\tag{13.5}\\\\\n& =-\\frac{R_{F} C_{1} s}{R_{F} C_{2} s+1} \\tag{13.6}\n\\end{align*}\n$$\n\nindicating that $V_{\\text {out }} / V_{\\text {in }} \\approx-C_{1} / C_{2}$ only if $\\omega \\gg\\left(R_{F} C_{2}\\right)^{-1}$.\n\nThe above difficulty can be remedied by increasing $R_{F} C_{2}$, but in many applications, the required values of the two components become prohibitively large. We must therefore seek other methods of establishing the bias while utilizing capacitive feedback networks.\n\nIt is possible to replace $R_{F}$ in Fig. 13.2(b) with a switch. As illustrated in Fig. 13.4, the idea is to turn $S_{2}$ on to place the op amp in unity-gain feedback and force $V_{X}$ to $V_{B}$, an appropriately chosen input common-mode level for the op amp. After the switch turns off, node $X$ retains this voltage, allowing proper operation. Of course, when $S_{2}$ is on, the circuit does not amplify $V_{i n}$.\n\nLet us now consider the switched-capacitor circuit depicted in Fig. 13.5, where three switches control the operation: $S_{1}$ and $S_{3}$ connect the left plate of $C_{1}$ to $V_{i n}$ and ground, respectively, and $S_{2}$ provides unity-gain feedback. We first assume that the open-loop gain of the op amp is very large and study the circuit in two phases. First, $S_{1}$ and $S_{2}$ are on and $S_{3}$ is off, yielding the equivalent circuit of Fig. 13.6(a). For a high-gain op amp, $V_{B}=V_{\\text {out }} \\approx 0$, and hence the voltage across $C_{1}$ is approximately equal to $V_{\\text {in }}$.\n\nFigure 13.5 is a switched-capacitor amplifier with two modes: sampling and amplification. In sampling mode, S1 and S2 are on, and S3 is off, allowing C1 to sample the input voltage. In amplification mode, S1 and S2 are off, and S3 is on, grounding node A and amplifying the input signal with a gain of -C1/C2.\n\nFigure 13.6 shows the circuit of Fig. 13.5 in (a) sampling mode, (b) amplification mode, and (c) input and output waveforms in the two modes.\n\nWe say that $C_{1}$ samples the input. Next, at $t=t_{0}$, $S_{1}$ and $S_{2}$ turn off and $S_{3}$ turns on, pulling node $A$ to ground. Since the gain is equal to $-C_{1} / C_{2}$ and since $V_{A}$ changes from $V_{i n 0}$ to 0, the output voltage must change from zero to $V_{i n 0} C_{1} / C_{2}$.\n\nThe output voltage change can also be calculated by examining the transfer of charge. Note that the charge stored on $C_{1}$ just before $t_{0}$ is equal to $V_{i n 0} C_{1}$. After $t=t_{0}$, the negative feedback through $C_{2}$ drives the op amp input differential voltage, and hence the voltage across $C_{1}$, to zero (Fig. 13.7). The charge stored on $C_{1}$ at $t=t_{0}$ must then be transferred to $C_{2}$, producing an output voltage equal to $V_{i n 0} C_{1} / C_{2}$. Thus, the circuit amplifies $V_{i n 0}$ by a factor of $C_{1} / C_{2}$.\n\nFigure 13.7 illustrates the transfer of charge from $C_{1}$ to $C_{2}$, amplifying the input voltage $V_{i n}$ by a factor of $C_{1} / C_{2}$. Initially, $C_{1}$ is charged with $V_{i n 0}$, and after $t=t_{0}$, the charge is transferred to $C_{2}$, setting $V_{\\text {out }}$ to $V_{i n 0} C_{1} / C_{2}$. The circuit operates in two phases: sampling and amplification.\n\nSeveral attributes of the circuit of Fig. 13.5 distinguish it from continuous-time implementations. First, the circuit devotes some time to \"sampling\" the input, setting the output to zero and providing no amplification during this period. Second, after sampling, for $t>t_{0}$, the circuit ignores the input voltage $V_{i n}$, amplifying the sampled voltage. Third, the circuit configuration changes considerably from one phase to another, as seen in Fig. 13.6(a) and (b), raising concern about its stability. Note that $S_{2}$ must turn on periodically to compensate for the leakage currents that slowly discharge $X$. These currents arise from $S_{2}$ itself and the gate leakage of the op amp.\n\nWhat is the advantage of the amplifier of Fig. 13.5 over that in Fig. 13.1? In addition to sampling capability, we note from the waveforms depicted in Fig. 13.6 that after $V_{\\text {out }}$ settles to $V_{\\text {in }} \\cdot C_{1} / C_{2}$, the current through $C_{2}$ approaches zero. That is, the feedback capacitor does not reduce the open-loop gain of the amplifier if the output voltage is given enough time to settle. In Fig. 13.1, on the other hand, $R_{2}$ loads the amplifier continuously.\n\nThe switched-capacitor amplifier of Fig. 13.5 lends itself to implementation in CMOS technology much more easily than in other technologies. This is because discrete-time operations require switches to perform sampling as well as a high input impedance to sense the stored quantities with no corruption. For example, if the op amp of Fig. 13.5 incorporates bipolar transistors at its input, the base current drawn from the inverting input in the amplification phase [Fig. 13.6(b)] creates an error in the output voltage. The existence of simple switches and a high input impedance has made CMOS technology the dominant choice for sampled-data applications.\n\nThe foregoing discussion leads to the conceptual view illustrated in Fig. 13.8 for switched-capacitor amplifiers. In the simplest case, the operation takes place in two phases: sampling and amplification. Thus, in addition to the analog input, $V_{i n}$, the circuit requires a clock to define each phase.\n\nOur study of SC amplifiers proceeds according to these two phases. First, we analyze various sampling techniques. Second, we consider SC amplifier topologies.\n\nFigure 13.8 provides a general view of a switched-capacitor amplifier, which operates in two distinct phases: sampling and amplification. The diagram consists of two main blocks connected in series, with additional control provided by a clock signal (CK).\n\nThe primary function of this system is to sample an analog input voltage and subsequently amplify it. The switched-capacitor topology allows precise sampling and amplification controlled by the clock signal. This design is particularly useful in sampled-data applications, where the timing of the sample and hold operation is critical for accurate signal processing.\n\nThe graph labeled \"CK\" is a time-domain waveform illustrating the operation of a switched-capacitor amplifier circuit. The waveform is a rectangular pulse, indicating a digital clock signal used to control the switched-capacitor amplifier. The waveform consists of two primary phases:\n1. **Sample Phase:** The clock signal 'CK' is high, indicating the period during which the input voltage, 'V_in', is sampled.\n2. **Amplify Phase:** The clock signal 'CK' returns to low, marking the transition to the amplification phase where the previously sampled voltage is processed by the amplifier.\n\nThe waveform's rectangular shape and annotations suffice to understand the timing sequence of the switched-capacitor amplifier operation."
},
{
    "text": "To comprehend the rationale behind sampled-data circuits, let's start by examining the straightforward continuous-time amplifier illustrated in Fig. 13.1(a), where the ratio of output to input voltage, $V_{\\text {out }} / V_{\\text {in }}$, is ideally $-R_{2} / R_{1}$. This circuit, commonly employed with bipolar op amps, encounters a significant challenge when realized in CMOS technology. It's important to remember that to achieve a high voltage gain in CMOS op amps, the open-loop output resistance is maximized, often reaching hundreds of kilohms. Consequently, we anticipate that $R_{2}$ will significantly reduce the open-loop gain, compromising the circuit's accuracy. Indeed, with the help of the simple equivalent circuit depicted in image_name:(a), where the circuit consists of resistors R1 and R2 and an op amp Av, we can observe that the presence of R2 impacts the open-loop gain, particularly in CMOS technology.\n\nIn the equivalent circuit shown in image_name:(b), which represents the behavior of the amplifier with resistors R1, R2, and Rout, and an op amp with gain Av, the node Vx acts as an intermediate connection between R1 and R2, and the output voltage is measured across Rout.\n\nThe equations derived from the circuit analysis demonstrate that the closed-loop gain is affected by inaccuracies in both the numerator and the denominator, compared to the scenario where $R_{\\text {out }}=0$. Additionally, the input resistance of the amplifier, approximately equal to $R_{1}$, imposes a load on the preceding stage while introducing thermal noise.\n\nThe example provided illustrates the calculation of the closed-loop gain using feedback techniques and compares it to the derived equation, highlighting the impact of $R_{\\text {out }} / R_{2}$ on the transmission through $R_{2}$.\n\nTo prevent a decrease in the open-loop gain of the op amp in the circuit of Fig. 13.1(a), it is proposed that resistors can be substituted with capacitors, as shown in Fig. 13.2(a). Ideally, the gain of this circuit is determined by the ratio of the impedances of $C_{2}$ and $C_{1}$, multiplied by -1, which equates to $-C_{1} / C_{2}$.\n\nThe circuit in Fig. 13.2(b) introduces a feedback resistor RF to establish the bias voltage at node X, which is crucial for defining the bias point.\n\nThe step response graph in Fig. 13.3 showcases the amplifier's response to a sudden change in input voltage over time, demonstrating the time required for the output to stabilize at a new voltage level.\n\nHowever, the question arises: How is the bias voltage at node $X$ established? One solution is to incorporate a large feedback resistor, as depicted in Fig. 13.2(b), which provides dc feedback without significantly affecting the ac behavior of the amplifier within the frequency band of interest. This approach is practical when the circuit is designed to handle high-frequency signals. However, if the circuit is intended to amplify a voltage step, the response will exhibit a step change due to the initial amplification, followed by a \"tail\" caused by the discharge of $C_{2}$ through $R_{F}$. Additionally, the circuit may not be suitable for amplifying wideband signals due to its high-pass transfer function characteristics.\n\nTo address the challenge of establishing the bias while utilizing capacitive feedback networks, a switch can replace $R_{F}$ in Fig. 13.2(b). As shown in Fig. 13.4, the switch $S_{2}$ is activated to implement unity-gain feedback, forcing $V_{X}$ to $V_{B}$, an appropriately chosen input common-mode level for the op amp. Once the switch is turned off, node $X$ maintains this voltage, enabling proper operation.\n\nThe switched-capacitor circuit in Fig. 13.5 operates with three switches controlling the sampling and amplification phases. During the sampling phase, $C_{1}$ charges to the input voltage $V_{i n}$, and in the amplification phase, the charge is transferred to $C_{2}$, resulting in an output voltage proportional to $V_{i n} C_{1} / C_{2}$.\n\nThe circuit of Fig. 13.5 differs from continuous-time implementations in several aspects. It dedicates time to \"sampling\" the input without providing amplification during this period. After sampling, the circuit amplifies the sampled voltage while ignoring the input voltage $V_{i n}$. The circuit configuration also undergoes significant changes between phases, raising concerns about stability. Additionally, $S_{2}$ must be activated periodically to counteract leakage currents that gradually discharge node $X$.\n\nThe advantage of the amplifier in Fig. 13.5 over that in Fig. 13.1 lies in its sampling capability and the fact that the feedback capacitor does not diminish the open-loop gain if the output voltage is allowed sufficient time to stabilize.\n\nThe switched-capacitor amplifier in Fig. 13.5 is particularly well-suited for implementation in CMOS technology due to the availability of simple switches and high input impedance, which are essential for discrete-time operations.\n\nThe conceptual view in Fig. 13.8 for switched-capacitor amplifiers highlights the two main phases: sampling and amplification, with the operation controlled by a clock signal (CK).\n\nThe study of switched-capacitor amplifiers involves analyzing various sampling techniques and considering different SC amplifier topologies, as these circuits play a vital role in sampled-data applications where precise timing of the sample and hold operation is crucial for accurate signal processing."
},
{
    "text": "To grasp the impetus behind sampled-data circuits, let's initially examine the straightforward continuous-time amplifier depicted in Fig. 13.1(a), where the ratio of the output voltage to the input voltage, \\( V_{\\text {out }} / V_{\\text {in }} \\), is ideally \\( -R_{2} / R_{1} \\). While this configuration is widely employed with bipolar op amps, it encounters a significant challenge when realized in CMOS technology. It's important to remember that, to attain a high voltage gain in CMOS op amps, the open-loop output resistance is maximized, frequently reaching into the hundreds of kilohms. Consequently, \\( R_{2} \\) is likely to substantially diminish the open-loop gain, compromising the circuit's precision. Indeed, with the assistance of the simplified equivalent circuit displayed in the associated image, it becomes evident that the presence of \\( R_{2} \\) is particularly detrimental in CMOS technology.\n\nThe equivalent circuit, as illustrated in Fig. 13.1(b), allows us to formulate the equation:\n\n\\[\n-A_{v}\\left(\\frac{V_{\\text {out }}-V_{\\text {in }}}{R_{1}+R_{2}} R_{1}+V_{\\text {in }}\\right)-R_{\\text {out }} \\frac{V_{\\text {out }}-V_{\\text {in }}}{R_{1}+R_{2}}=V_{\\text {out }}\n\\]\n\nwhich leads to:\n\n\\[\n\\frac{V_{\\text {out }}}{V_{\\text {in }}}=-\\frac{R_{2}}{R_{1}} \\cdot \\frac{A_{v}-\\frac{R_{\\text {out }}}{R_{2}}}{1+\\frac{R_{\\text {out }}}{R_{1}}+A_{v}+\\frac{R_{2}}{R_{1}}}\n\\]\n\nThis equation suggests that, compared to scenarios where \\( R_{\\text {out }}=0 \\), the closed-loop gain is afflicted by inaccuracies in both the numerator and the denominator. Additionally, the amplifier's input resistance, roughly equivalent to \\( R_{1} \\), burdens the preceding stage while introducing thermal noise.\n\n#### Example 13.1\n\nUtilize the feedback methodologies outlined in Chapter 8 to compute the closed-loop gain of the circuit in Fig. 13.1(a) and contrast the findings with Eq. (13.2).\n\n#### Solution\n\nBy following the method detailed in Example 8.16, one can demonstrate that:\n\n\\[\n\\begin{align*}\n\\frac{V_{\\text {out }}}{V_{\\text {in }}} & =\\frac{-R^{2} A_{v}}{R_{2}^{2}+R_{1} R_{\\text {out }}+R_{2} R_{\\text {out }}+\\left(1+A_{v}\\right) R_{1} R_{2}} \\\\\n& =-\\frac{R_{2}}{R_{1}} \\cdot \\frac{A_{v}}{\\frac{R_{2}}{R_{1}}+\\frac{R_{\\text {out }}}{R_{2}}+\\frac{R_{\\text {out }}}{R_{1}}+1+A_{v}}\n\\end{align*}\n\\]\n\nThe two outcomes are nearly identical if \\( R_{\\text {out }} / R_{2} \\ll A_{v} \\), a condition necessary to ensure that the transmission through \\( R_{2} \\) is insignificant.\n\nIn the circuit of Fig. 13.1(a), the closed-loop gain is dictated by the \\( R_{2} \\) to \\( R_{1} \\) ratio. To prevent diminishing the op amp's open-loop gain, it is hypothesized that resistors can be substituted with capacitors, as shown in Fig. 13.2(a). Ideally, the circuit's gain is the impedance of \\( C_{2} \\) divided by the impedance of \\( C_{1} \\), multiplied by -1, or \\( -C_{1} / C_{2} \\).\n\nThe circuit in Fig. 13.2(b) incorporates an additional feedback resistor \\( R_{F} \\) to establish the bias point at node X.\n\nFigure 13.3 portrays the step response of the amplifier circuit of Fig. 13.2(b), illustrating the amplifier's response to a sudden input voltage change over time.\n\nTo determine the bias voltage at node X, a large feedback resistor as shown in Fig. 13.2(b) can be introduced, providing dc feedback with minimal impact on the amplifier's ac behavior within the frequency band of interest. This setup is practical when the circuit is exclusively sensitive to high-frequency signals. However, if the circuit is intended to amplify a voltage step, as depicted in Fig. 13.3, the response includes a step change due to the initial amplification by the circuit composed of \\( C_{1}, C_{2} \\), and the op amp, followed by a \"tail\" caused by the charge loss on \\( C_{2} \\) through \\( R_{F} \\). From another perspective, the circuit may not be appropriate for amplifying wideband signals due to its high-pass transfer function. The transfer function is expressed as:\n\n\\[\n\\begin{align*}\n\\frac{V_{\\text {out }}}{V_{\\text {in }}}(s) & \\approx-\\frac{R_{F} \\frac{1}{C_{2} s}}{R_{F}+\\frac{1}{C_{2} s}} \\div \\frac{1}{C_{1} s} \\\\\n& =-\\frac{R_{F} C_{1} s}{R_{F} C_{2} s+1}\n\\end{align*}\n\\]\n\nindicating that \\( V_{\\text {out }} / V_{\\text {in }} \\approx-C_{1} / C_{2} \\) only if \\( \\omega \\gg\\left(R_{F} C_{2}\\right)^{-1} \\).\n\nTo address this issue, increasing \\( R_{F} C_{2} \\) is possible, but in many applications, the necessary values for these components become excessively large. Consequently, alternative methods must be explored to establish the bias while leveraging capacitive feedback networks.\n\nOne approach is to replace \\( R_{F} \\) in Fig. 13.2(b) with a switch, as depicted in Fig. 13.4. The concept is to activate \\( S_{2} \\) to place the op amp in unity-gain feedback and force \\( V_{X} \\) to \\( V_{B} \\), a carefully selected input common-mode level for the op amp. Once \\( S_{2} \\) is turned off, node X maintains this voltage, enabling proper operation. However, when \\( S_{2} \\) is on, the circuit does not amplify \\( V_{i n} \\).\n\nThe switched-capacitor circuit in Fig. 13.5 employs three switches to govern its operation: \\( S_{1} \\) and \\( S_{3} \\) connect the left plate of \\( C_{1} \\) to \\( V_{i n} \\) and ground, respectively, while \\( S_{2} \\) supplies unity-gain feedback. Assuming a very high open-loop gain for the op amp, the circuit's behavior is analyzed in two phases. Initially, \\( S_{1} \\) and \\( S_{2} \\) are on, and \\( S_{3} \\) is off, resulting in the equivalent circuit shown in Fig. 13.6(a). For an op amp with high gain, \\( V_{B}=V_{\\text {out }} \\approx 0 \\), and thus the voltage across \\( C_{1} \\) is approximately \\( V_{\\text {in }} \\).\n\nAt \\( t=t_{0} \\), \\( S_{1} \\) and \\( S_{2} \\) turn off, and \\( S_{3} \\) turns on, grounding node A. Since the gain is \\( -C_{1} / C_{2} \\) and \\( V_{A} \\) shifts from \\( V_{i n 0} \\) to 0, the output voltage must transition from zero to \\( V_{i n 0} C_{1} / C_{2} \\).\n\nThis output voltage change can also be deduced by examining the charge transfer. The charge stored on \\( C_{1} \\) just before \\( t_{0} \\) is \\( V_{i n 0} C_{1} \\). After \\( t=t_{0} \\), the negative feedback through \\( C_{2} \\) drives the op amp input differential voltage, and hence the voltage across \\( C_{1} \\), to zero (Fig. 13.7). The charge stored on \\( C_{1} \\) at \\( t=t_{0} \\) is then transferred to \\( C_{2} \\), generating an output voltage of \\( V_{i n 0} C_{1} / C_{2} \\). Thus, the circuit amplifies \\( V_{i n 0} \\) by a factor of \\( C_{1} / C_{2} \\).\n\nThe switched-capacitor circuit in Fig. 13.5 exhibits several characteristics distinct from continuous-time implementations. Firstly, the circuit dedicates time to \"sampling\" the input, setting the output to zero and providing no amplification during this phase. Secondly, after sampling, for \\( t>t_{0} \\), the circuit disregards the input voltage \\( V_{i n} \\) and amplifies the sampled voltage. Thirdly, the circuit configuration undergoes a significant change from one phase to another, as observed in Fig. 13.6(a) and (b), raising concerns about its stability. It is crucial that \\( S_{2} \\) is periodically activated to counteract the leakage currents that gradually discharge X. These currents stem from \\( S_{2} \\) itself and the gate leakage of the op amp.\n\nThe advantage of the amplifier in Fig. 13.5 over that in Fig. 13.1 lies in its sampling capability and the fact that, as depicted in Fig. 13.6, once \\( V_{\\text {out }} \\) stabilizes at \\( V_{\\text {in }} \\cdot C_{1} / C_{2} \\), the current through \\( C_{2} \\) approaches zero. This means that the feedback capacitor does not diminish the open-loop gain of the amplifier if the output voltage is given sufficient time to stabilize. In contrast, in Fig. 13.1, \\( R_{2} \\) continuously loads the amplifier.\n\nThe switched-capacitor amplifier in Fig. 13.5 is particularly well-suited for implementation in CMOS technology compared to other technologies. Discrete-time operations necessitate switches for sampling and a high input impedance to detect stored quantities without distortion. For instance, if the op amp in Fig. 13.5 incorporates bipolar transistors at its input, the base current drawn from the inverting input during the amplification phase [Fig. 13.6(b)] introduces an error in the output voltage. The availability of simple switches and a high input impedance have established CMOS technology as the preferred choice for sampled-data applications.\n\nThis discussion leads to the conceptual representation in Fig. 13.8 for switched-capacitor amplifiers. In its simplest form, the operation occurs in two phases: sampling and amplification. Hence, in addition to the analog input \\( V_{i n} \\), the circuit requires a clock to delineate each phase.\n\nThe analysis of SC amplifiers follows these two phases. Initially, various sampling techniques are examined. Subsequently, SC amplifier topologies are considered.\n\nThe block diagram in Fig. 13.8 presents a general view of a switched-capacitor amplifier, which operates in two distinct phases: sampling and amplification. The diagram consists of two primary blocks connected in series, with a clock signal (CK) providing additional control.\n\nThe graph labeled \"CK\" illustrates the operation of a switched-capacitor amplifier circuit, depicting the timing of of the sampling and amplification phases controlled by the clock signal."
},
{
    "text": "To grasp the rationale behind sampled-data circuits, we should initially examine the straightforward continuous-time amplifier depicted in Fig. 13.1(a), where the ratio of the output voltage \\( V_{\\text{out}} \\) to the input voltage \\( V_{\\text{in}} \\) is ideally \\( -R_2 / R_1 \\). This circuit, commonly used with bipolar op amps, encounters significant challenges when realized in CMOS technology. It's important to remember that to attain a high voltage gain, the open-loop output resistance of CMOS op amps is maximized, usually reaching values in the hundreds of kilohms. Consequently, \\( R_2 \\) can drastically reduce the open-loop gain, compromising the circuit's precision. This is evident when analyzing the simple equivalent circuit provided in the figure descriptions.\n\nThe amplifier circuit in Fig. 13.1(a) is designed to deliver a high voltage gain, but the presence of \\( R_2 \\) impacts the open-loop gain, particularly in CMOS technology. The equivalent circuit in Fig. 13.1(b) illustrates this behavior, modeling the amplifier with resistors \\( R_1, R_2 \\), and \\( R_{\\text{out}} \\), and an operational amplifier with gain \\( A_v \\). The node \\( V_x \\) is the intermediate node connecting \\( R_1 \\) and \\( R_2 \\), and the output voltage is measured across \\( R_{\\text{out}} \\).\n\nThe equations derived from these circuits show that the closed-loop gain is affected by inaccuracies in both the numerator and the denominator compared to the case where \\( R_{\\text{out}} = 0 \\). Additionally, the input resistance of the amplifier, roughly equivalent to \\( R_1 \\), loads the preceding stage and introduces thermal noise.\n\nAn example is provided to calculate the closed-loop gain of the circuit in Fig. 13.1(a) using feedback techniques described in Chapter 8 and to compare the result with the derived equation. The solution demonstrates that the two results are approximately equal if \\( R_{\\text{out}} / R_2 \\ll A_v \\), a condition necessary to ensure that the transmission through \\( R_2 \\) is insignificant.\n\nTo prevent the reduction of the op amp's open-loop gain in the circuit of Fig. 13.1(a), it is proposed that resistors can be substituted with capacitors, as shown in Fig. 13.2(a). Ideally, the gain of this circuit is the impedance of \\( C_2 \\) divided by the impedance of \\( C_1 \\) and multiplied by -1, i.e., \\( -C_1 / C_2 \\).\n\nFig. 13.2(b) introduces a feedback resistor \\( R_F \\) to define the bias point at node \\( X \\). The circuit is a continuous-time feedback amplifier using capacitors with an added feedback resistor to set the bias voltage.\n\nThe step response graph in Fig. 13.3 shows the amplifier's response to a sudden change in input voltage over time. The x-axis represents time (t), and the y-axis indicates voltage, with two distinct levels labeled as \\( V_{in} \\) and \\( V_{out} \\). The graph demonstrates the amplifier's transient behavior, highlighting the time it takes for the output to stabilize at a new voltage level.\n\nHowever, the bias voltage at node \\( X \\) needs to be established. One approach is to add a large feedback resistor, as in Fig. 13.2(b), which provides dc feedback while minimally affecting the ac behavior of the amplifier in the frequency band of interest. This arrangement is practical if the circuit only senses high-frequency signals. But if the circuit is to amplify a voltage step, the response will contain a step change due to the initial amplification by the circuit consisting of \\( C_1, C_2 \\), and the op amp, followed by a \"tail\" resulting from the loss of charge on \\( C_2 \\) through \\( R_F \\). The circuit may not be suitable for amplifying wideband signals because it exhibits a high-pass transfer function.\n\nThe transfer function of the circuit is given by equations that indicate \\( V_{\\text{out}} / V_{\\text{in}} \\approx -C_1 / C_2 \\) only if \\( \\omega \\gg (R_F C_2)^{-1} \\). The difficulty can be mitigated by increasing \\( R_F C_2 \\), but in many applications, the required values of the two components become prohibitively large. Therefore, alternative methods must be sought to establish the bias while utilizing capacitive feedback networks.\n\nOne possible solution is to replace \\( R_F \\) in Fig. 13.2(b) with a switch, as shown in Fig. 13.4. The idea is to turn \\( S_2 \\) on to place the op amp in unity-gain feedback and force \\( V_X \\) to \\( V_B \\), an appropriately chosen input common-mode level for the op amp. After the switch turns off, node \\( X \\) retains this voltage, allowing proper operation. Of course, when \\( S_2 \\) is on, the circuit does not amplify \\( V_{in} \\).\n\nThe switched-capacitor circuit in Fig. 13.5 uses three switches to control the operation: \\( S_1 \\) and \\( S_3 \\) connect the left plate of \\( C_1 \\) to \\( V_{in} \\) and ground, respectively, and \\( S_2 \\) provides unity-gain feedback. The circuit operates in two phases: sampling and amplification. In the sampling phase, \\( S_1 \\) and \\( S_2 \\) are on, and \\( S_3 \\) is off, allowing \\( C_1 \\) to sample the input voltage. In the amplification phase, \\( S_1 \\) and \\( S_2 \\) are off, and \\( S_3 \\) is on, grounding node \\( A \\) and amplifying the input signal with a gain of \\( -C_1 / C_2 \\).\n\nThe input and output waveforms for the switched-capacitor amplifier operating in the two modes are illustrated in Fig. 13.6(c). The graph shows how voltage changes over time, with the transition at \\( t = t_0 \\) marking the shift from sampling to amplification.\n\nThe charge transfer from \\( C_1 \\) to \\( C_2 \\) is depicted in Fig. 13.7, which amplifies the input voltage \\( V_{in} \\) by a factor of \\( C_1 / C_2 \\). Initially, \\( C_1 \\) is charged with \\( V_{in0} \\), and after \\( t = t_0 \\), the charge is transferred to \\( C_2 \\), setting \\( V_{out} \\) to \\( V_{in0} \\cdot C_1 / C_2 \\).\n\nThe switched-capacitor amplifier has several distinct attributes compared to continuous-time implementations. It dedicates time to \"sampling\" the input, setting the output to zero and providing no amplification during this period. After sampling, for \\( t > t_0 \\), the circuit disregards the input voltage \\( V_{in} \\) and amplifies the sampled voltage. The circuit configuration changes significantly from one phase to another, raising concerns about its stability. The switch \\( S_2 \\) must turn on periodically to compensate for the leakage currents that slowly discharge node \\( X \\).\n\nThe advantage of the amplifier in Fig. 13.5 over that in Fig. 13.1 is that after \\( V_{\\text{out}} \\) settles to \\( V_{\\text{in}} \\cdot C_1 / C_2 \\), the current through \\( C_2 \\) approaches zero. The feedback capacitor does not reduce the open-loop gain of the amplifier if the output voltage is given enough time to settle. In contrast, \\( R_2 \\) in Fig. 13.1 loads the amplifier continuously.\n\nThe switched-capacitor amplifier in Fig. 13.5 is more amenable to implementation in CMOS technology than in other technologies due to the availability of simple switches and high input impedance, which are essential for sampled-data applications.\n\nThe conceptual view in Fig. 13.8 illustrates the general operation of switched-capacitor amplifiers, which operate in two phases: sampling and amplification. The diagram consists of two main blocks connected in series, with a clock signal (CK) controlling the switching between phases.\n\nThe study of SC amplifiers proceeds according to these two phases. First, various sampling techniques are analyzed. Second, SC amplifier topologies are considered."
},
{
    "text": "To comprehend the impetus behind sampled-data circuits, we should initially examine the straightforward continuous-time amplifier illustrated in Fig. 13.1(a), wherein the ratio of output voltage to input voltage is ideally $-R_{2} / R_{1}$. While this circuit is commonly employed with bipolar op amps, it encounters significant challenges when realized in CMOS technology. In order to attain a substantial voltage gain, the open-loop output resistance of CMOS op amps is maximized, frequently reaching into the hundreds of kilohms. Consequently, it becomes evident that $R_{2}$ would substantially diminish the open-loop gain, thereby compromising the accuracy of the circuit. Utilizing the simple equivalent circuit provided in Fig. 13.1(b), we can deduce that the closed-loop gain is compromised by inaccuracies in both the numerator and the denominator when compared to a scenario where $R_{\\text {out }}=0$. Additionally, the input resistance of the amplifier, which is roughly equivalent to $R_{1}$, burdens the preceding stage while also introducing thermal noise.\n\nThe circuit depicted in Fig. 13.1(a) relies on the ratio of $R_{2}$ to $R_{1}$ to establish the closed-loop gain. To prevent diminishing the open-loop gain of the op amp, it is proposed that the resistors be substituted with capacitors, as shown in Fig. 13.2(a). Ideally, the gain of this circuit is determined by the impedance of $C_{2}$ divided by the impedance of $C_{1}$, multiplied by -1, hence equating to $-C_{1} / C_{2}$.\n\nTo ascertain the bias voltage at node $X$, a large feedback resistor, as seen in Fig. 13.2(b), may be introduced, offering dc feedback with minimal impact on the ac behavior of the amplifier within the frequency band of interest. This configuration is particularly viable when the circuit is exclusively detecting high-frequency signals. However, if the circuit is intended to amplify a voltage step, as depicted in Fig. 13.3, the response includes a step change due to the initial amplification by the circuit consisting of $C_{1}, C_{2}$, and the op amp, followed by a \"tail\" resulting from the discharge of $C_{2}$ through $R_{F}$. From a different perspective, the circuit may be unsuitable for amplifying wideband signals due to its high-pass transfer function. The transfer function is given by\n\n$$\n\\frac{V_{\\text {out }}}{V_{\\text {in }}}(s) \\approx-\\frac{R_{F} \\frac{1}{C_{2} s}}{R_{F}+\\frac{1}{C_{2} s}} \\div \\frac{1}{C_{1} s} =-\\frac{R_{F} C_{1} s}{R_{F} C_{2} s+1}\n$$\n\nindicating that $V_{\\text {out }}/V_{\\text {in }} \\approx-C_{1}/C_{2}$ only if $\\omega \\gg\\left(R_{F} C_{2}\\right)^{-1}$. This limitation can be mitigated by increasing $R_{F} C_{2}$, but in many cases, the necessary values for these components become excessively large. Therefore, alternative methods for establishing the bias while leveraging capacitive feedback networks must be sought.\n\nOne possible solution involves replacing $R_{F}$ in Fig. 13.2(b) with a switch, as shown in Fig. 13.4. The objective is to activate $S_{2}$, implement\nTo order the rationaleetus for sampled-data circuits, we should initially examine the straightforward continuous-time amplifier illustrated in Fig. 13.1(a), wherein the ratio of output voltage to input voltage is ideally $-R_{2} / R_{1}$. While this circuit is commonly employed with bipolar op amps, it encounters significant challenges when realized in CMOS technology. In order to attain a substantial voltage gain, the open-loop output resistance of CMOS op amps is maximized, frequently reaching into the hundreds of kilohms. Consequently, it becomes evident that $R_{2}$ would substantially diminish the open-loop gain, thereby compromising the accuracy of the circuit. Utilizing the simple equivalent circuit provided in Fig. 13.1(b), we can deduce that the closed-loop gain is compromised by inaccuracies in both the numerator and the denominator when compared to a scenario where $R_{\\text {out }}=0$. Additionally, the input resistance of the amplifier, which is roughly equivalent to $R_{1}$, burdens the preceding stage while also introducing thermal noise.\n\nThe circuit depicted in Fig. 13.1(a) relies on the ratio of $R_{2}$ to $R_{1}$ to establish the closed-loop gain. To prevent diminishing the open-loop gain of the op amp, it is proposed that the resistors be substituted with capacitors, as shown in Fig. 13.2(a). Ideally, the gain of this circuit is determined by the impedance of $C_{2}$ divided by the impedance of $C_{1}$, multiplied by -1, hence equating to $-C_{1} / C_{2}$.\n\nTo ascertain the bias voltage at node $X$, a large feedback resistor, as seen in Fig. 13.2(b), may be introduced, offering dc feedback with minimal impact on the ac behavior of the amplifier within the frequency band of interest. This configuration is particularly viable when the circuit is exclusively detecting high-frequency signals. However, if the circuit is intended to amplify a voltage step, as depicted in Fig. 13.3, the response includes a step change due to the initial amplification by the circuit consisting of $C_{1}, C_{2}$, and the op amp, followed by a \"tail\" resulting from the discharge of $C_{2}$ through $R_{F}$. From a different perspective, the circuit may be unsuitable for amplifying wideband signals due to its high-pass transfer function. The transfer function is given by\n\n$$\n\\frac{V_{\\text {out }}}{V_{\\text {in }}}(s) \\approx-\\frac{R_{F} \\frac{1}{C_{2} s}}{R_{F}+\\frac{1}{C_{2} s}} \\div \\frac{1}{C_{1} s} =-\\frac{R_{F} C_{1} s}{R_{F} C_{2} s+1}\n$$\n\nindicating that $V_{\\text {out }}/V_{\\text {in }} \\approx-C_{1}/C_{2}$ only if $\\omega \\gg\\left(R_{F} C_{2}\\right)^{-1}$. This limitation can be mitigated by increasing $R_{F} C_{2}$, but in many cases, the necessary values for these components become excessively large. Therefore, alternative methods for establishing the bias while leveraging capacitive feedback networks must be sought.\n\nOne possible solution involves replacing $R_{F}$ in Fig. 13.2(b) with a switch, as shown in Fig. 13.4. The concept is to activate $S_{2}$ to"
},
{
    "text": "To comprehend the incentive behind sampled-data circuits, we should initially examine the straightforward continuous-time amplifier depicted in Fig. 13.1(a), where ideally the ratio of the output voltage \\( V_{\\text{out}} \\) to the input voltage \\( V_{\\text{in}} \\) is \\( -R_{2} / R_{1} \\). This circuit, commonly employed with bipolar op amps, encounters a significant challenge when realized in CMOS technology. It is important to remember that to obtain a high voltage gain in CMOS op amps, their open-loop output resistance is maximized, often reaching several hundred kilohms. Consequently, \\( R_{2} \\) substantially diminishes the open-loop gain, compromising the circuit's precision. Indeed, utilizing the simple equivalent circuit presented in the\nTo grasp the rationale behind sampled-data circuits, let's start by examining the basic continuous-time amplifier shown in Fig. 13.1(a), where ideally the output voltage \\( V_{\\text{out}} \\) to input voltage \\( V_{\\text{in}} \\) ratio is \\( -R_{2} / R_{1} \\). This circuit, frequently used with bipolar op amps, encounters a major challenge when implemented in CMOS technology. It's crucial to remember that to achieve a high voltage gain in CMOS op amps, their open-loop output resistance is maximized, often reaching several hundred kilohms. Therefore, \\( R_{2} \\) significantly reduces the open-loop gain, compromising the circuit's accuracy. Indeed, using the simple equivalent circuit presented in"
},
{
    "text": "To comprehend the rationale behind sampled-data circuits, it's imperative to initially examine the straightforward continuous-time amplifier depicted in Fig. 13.1(a), where the ratio of output to input voltage, \\( V_{\\text {out }} / V_{\\text {in }} \\), ideally corresponds to \\( -R_{2} / R_{1} \\). While this circuit is widely utilized with bipolar op amps, its realization in CMOS technology poses a significant challenge. It's important to remember that CMOS op amps maximize their open-loop output resistance to achieve high voltage gain, often reaching values in the hundreds of kilohms. Consequently, \\( R_{2} \\) could drastically reduce the open-loop gain, thereby diminishing the circuit's precision. This assertion is further substantiated by the simple equivalent circuit presented in Fig. 13.1(b), which elucidates the impact of \\( R_{2} \\) on the gain.\n\nThe provided equations (13.1) and (13.2) quantify the relationship between the output and input voltages, taking into account the resistors and the op amp's gain. They reveal that the closed-loop gain is compromised by inaccuracies in both the numerator and the denominator, and the input resistance of the amplifier, roughly equivalent to \\( R_{1} \\), imposes a load on the preceding stage while introducing thermal noise.\n\nExample 13.1 demonstrates the application of feedback techniques to calculate the closed-loop gain of the circuit in Fig. 13.1(a) and compares it with Eq. (13.2). The solution, as outlined in Eqs. (13.3) and (13.4), shows that the two results are approximately equivalent if \\( R_{\\text {out }} / R_{2} \\) is much smaller than \\( A_{v} \\), a condition necessary to ensure that the transmission through \\( R_{2} \\) is insignificant.\n\nTo circumvent the reduction in open-loop gain, the resistors in the circuit of Fig. 13.1(a) can be substituted with capacitors, as shown in Fig. 13.2(a). Ideally, the gain of this circuit is determined by the ratio of the impedances of \\( C_{2} \\) and \\( C_{1} \\), multiplied by -1, resulting.e., \\( -C_{1} / C_{2} \\).\n\nFigures 13.2(b) and 13.3 depict an equivalent circuit with a feedback resistor \\( R_{F} \\) to establish the bias point at node X and the step response of the amplifier circuit, respectively. The step response graph illustrates the amplifier's response to a sudden change in input voltage over time, highlighting the time it takes for the output to stabilize at a new voltage level.\n\nThe challenge of setting the bias voltage at node X is addressed by incorporating a large feedback resistor \\( R_{F} \\) in Fig. 13.2(b). This arrangement provides dc feedback without significantly impacting the ac behavior of the amplifier within the frequency band of interest. However, it may not be suitable for amplifying wideband signals due to the high-pass transfer function exhibited by the circuit.\n\nTo overcome this limitation, a switch can replace \\( R_{F} \\) in Fig. 13.2(b), as shown in Fig. 13.4. The idea is to activate the switch \\( S_{2} \\) to establish unity-gain feedback and force node X to \\( V_{B} \\), an appropriately chosen input common-mode level for the op amp. Once the switch is turned off, node X retains this voltage, enabling proper operation.\n\nThe switched-capacitor circuit in Fig. 13.5, controlled by three switches, is then discussed. The operation of this circuit is analyzed in two phases: sampling and amplification. During the sampling phase, \\( C_{1} \\) charges to the input voltage \\( V_{\\text {in }} \\), and during the amplification phase, the charge is transferred to \\( C_{2} \\), resulting in an output voltage proportional to \\( V_{\\text {in }} \\cdot C_{1} / C_{2} \\).\n\nThe advantages of the switched-capacitor amplifier in Fig. 13.5 over the continuous-time amplifier in Fig. 13.1 are highlighted, including its sampling capability and the fact that the feedback capacitor does not reduce the open-loop gain if the output voltage is allowed to settle.\n\nThe discussion concludes with a conceptual view of switched-capacitor amplifiers in Fig. 13.8, which operates in two phases: sampling and amplification. This design is particularly well-suited for implementation in CMOS technology due to its ability to perform discrete-time operations and its high input impedance."
},
{
    "text": "A straightforward sampling circuit is composed of a switch and a capacitor, as depicted in Figure 13.9(a). A Metal-Oxide-Semiconductor (MOS) transistor can act as this switch, as shown in Figure 13.9(b), since it can conduct with zero current.\n\nTo comprehend how the circuit in Figure 13.9(b) captures the input signal, it's essential to examine the simplified scenarios in Figure 13.10, where the gate command, CK, rises at time \\( t = t_0 \\). In Figure 13.10(a), it's assumed that the input voltage \\( V_{in} \\) is zero, and the capacitor starts with a voltage equal to \\( V_{DD} \\). Thus, at \\( t = t_0 \\), the transistor \\( M_1 \\) perceives a gate-source voltage equal to \\( V_{DD} \\), and its drain voltage is also \\( V_{DD} \\). Consequently, \\( M_1 \\) operates in saturation, sourcing a current of \\( I_{D1} = \\left(\\frac{\\mu_n C_{ox}}{2}\\right)\\left(\\frac{W}{L}\\right)\\left(V_{DD} - V_{TH}\\right)^2 \\) from the capacitor. As \\( V_{out} \\) decreases, it eventually reaches a point where \\( V_{out} = V_{DD} - V_{TH} \\), pushing \\( M_1 \\) into the triode region. Despite this, \\( M_1 \\) continues to discharge \\( C_H \\) until \\( V_{out} \\) nears zero. For \\( V_{out} \\ll 2(V_{DD} - V_{TH}) \\), the transistor can be approximated as a resistor with a value of \\( R_{on} = \\left[\\mu_n C_{ox}\\left(\\frac{W}{L}\\right)(V_{DD} - V_{TH})\\right]^{-1} \\).\n\nNext, consider the scenario in Figure 13.10(b), where \\( V_{in} = +1 \\text{ V} \\), \\( V_{out}(t = t_0) = 0 \\text{ V} \\), and \\( V_{DD} = 3 \\text{ V} \\). In this case, the terminal of \\( M_1 \\) connected to \\( C_H \\) behaves as the source, and the transistor turns on with \\( V_{GS} = +3 \\text{ V} \\), but \\( V_{DS} = +1 \\text{ V} \\). Hence, \\( M_1 \\) operates in the triode region, charging \\( C_H \\) until \\( V_{out} \\) approaches +1 V. For \\( V_{out} \\approx +1 \\text{ V} \\), \\( M_1 \\) exhibits an on-resistance of \\( R_{on} = \\left[\\mu_n C_{ox}\\left(\\frac{W}{L}\\right)(V_{DD} - V_{in} - V_{TH})\\right]^{-1} \\).\n\nThese observations highlight two significant points. First, a MOS switch can conduct current in both directions by swapping the roles of its source and drain terminals. Second, as shown in Figure 13.11, when the switch is on, \\( V_{out} \\) mirrors \\( V_{in} \\), and when the switch is off, \\( V_{out} \\) remains steady. Therefore, the circuit \"tracks\" the signal when CK is high and \"freezes\" the instantaneous value of \\( V_{in} \\) across \\( C_H \\) when CK goes low."
},
{
    "text": "---[Attention]---\nImage Descriptions: Images referenced in the [Context Provided] area have been transformed into textual narratives. Please rephrase the following [Context Provided] text, ensuring the revised version retains the original meaning and length.\n\n---[Task]---\nRephrase the provided text in the [Context Provided] Section. The rephrased text should preserve the original meaning and length. Present only the revised text.\n\n---[Context Provided]---\nRephrased text:\n```\nA basic sampling circuit includes a switch and a capacitor [Figure 13.9(a)]. A MOS transistor can act as a switch [Figure 13.9(b)] since it can conduct current while being activated.\n\nTo comprehend how the circuit in Figure 13.9(b) captures the input, first analyze the scenarios depicted in Figure 13.10, where the gate control signal, $C K$, becomes activated at $t=t_{0}$. In Figure 13.10(a), it's assumed that $V_{i n}=0$ and the capacitor initially holds a voltage matching $V_{D D}$. Consequently, at $t=t_{0}, M_{1}$ detects a gate-source voltage of $V_{D D}$, while its drain voltage is also at $V_{D D}$. As a result, the transistor is in saturation, drawing a current of $I_{D 1}=\\left(\\mu_{n} C_{o x} / 2\\right)(W / L)\\left(V_{D D}-V_{T H}\\right)^{2}$ from the capacitor. As $V_{\\text {out }}$ diminishes, the transistor moves to a point where $V_{o u t}=V_{D D}-V_{T H}$, driving $M_{1}$ into the triode region. Despite this, $M_{1}$ keeps discharging $C_{H}$ until $V_{\\text {out }}$ nears zero. Note that when $V_{\\text {out }} \\ll 2\\left(V_{D D}-V_{T H}\\right)$, the transistor can be regarded as a resistor with an equivalent resistance $R_{o n}=\\left[\\mu_{n} C_{o x}(W / L)\\left(V_{D D}-V_{T H}\\right)\\right]^{-1}$.\n\nNow consider Figure 13.10(b), where $V_{\\text {in }}=+1 \\mathrm{~V}, V_{\\text {out }}\\left(t=t_{0}\\right)=0 \\mathrm{~V}$, and $V_{D D}=3 \\mathrm{~V}$. Here, the terminal of $M_{1}$ linked to $C_{H}$ behaves as the source, and the transistor activates with $V_{G S}=+3$ V, while $V_{D S}=+1 \\mathrm{~V}$. Therefore, $M_{1}$ operates in the triode region, charging $C_{H}$ until $V_{\\text {out }}$ is close to +1 V. For $V_{\\text {out }} \\approx+1 \\mathrm{~V}, M_{1}$ displays an on-resistance of $R_{o n}=\\left[\\mu_{n} C_{o x}(W / L)\\left(V_{D D}-V_{\\text {in }}-V_{T H}\\right)\\right]^{-1}$.\n\nThese observations highlight two significant aspects. Firstly, a MOS switch can conduct in both directions simply by swapping the roles of its source and drain terminals. Secondly, as depicted in Figure 13.11, when the switch is activated, $V_{\\text {out }}$ follows $V_{\\text {in }}$, and when the switch is deactivated, $V_{o u t}$ remains constant. Consequently, the circuit \" follows\" the signal when $C K$ is high and \"freezes\" the instantaneous value of $V_{i n}$ across $C_{H}$ when $C K$ becomes low.\n\n#### Example 13.2\n\nIn the circuit shown in Figure 13.10(a), determine $V_{\\text {out }}$ as a function of time. Assume $\\lambda=0$.\n\n#### Solution\n\nBefore $V_{\\text {out }}$ falls below $V_{D D}-V_{T H}, M_{1}$ remains in saturation, and we get\n\n$$\n\\begin{align*}\nV_{\\text {out }}(t) & =V_{D D}-\\frac{I_{D 1} t}{C_{H}}  \\tag{13.7}\\\\\n& =V_{D D}-\\frac{1}{2} \\mu_{n} C_{o x} \\frac{W}{L}\\left(V_{D D}-V_{T H}\\right)^{2} \\frac{t}{C_{H}} \\tag{13.8}\n\\end{align*}\n$$\n\nimage_name:(a)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout, D: Vin, G: High}\nname: C_H, type: Capacitor, value: C_H, ports: {Np: Vout, Nn: GND}\n'name': 'R', 'type': 'Resistor', 'value': 'R', 'ports': {'N1': 'Vin', 'N2': 'Vout'\n'name': 'C_H', 'type': 'Capacitor', 'value': 'C_H', 'ports': {'N1': 'Vout', 'N2': 'Vout'\n]\nextrainfo:The circuit is a track and hold sampling circuit. The NMOS transistor M1 is used as a switch controlled by the input voltage Vin. When the switch is closed, the capacitor CH charges to the input voltage. The resistor R is used to control the charging time constant.\n\nimage_name:(b)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout, D: Vin, G: High}\nname: C_H, type: Capacitor, value: C_H, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit is a track and hold sampling circuit with an NMOS transistor, a resistor, and a capacitor. The NMOS transistor is controlled by a 'Low' signal, and the output voltage is sampled across the capacitor CH.\n\nFigure 13.11 Track and hold capabilities of a sampling circuit.\nAfter\n\n$$\n\\begin{equation*}\nt_{1}=\\frac{2 V_{T H} C_{H}}{\\mu_{n} C_{o x} \\frac{W}{L}\\left(V_{D D}-V_{T H}\\right)^{2}} \\tag{13.9}\n\\end{equation*}\n$$\n\nM_{1}$ enters the triode region, and its drain current becomes time-dependent. Consequently, we can express\n\n$$\n\\begin{align*}\nC_{H} \\frac{d V_{\\text {out }}}{d t} & =-I_{D 1}  \\tag{13.10}\\\\\n& =-\\frac{1}{2} \\mu_{n} C_{o x} \\frac{W}{L}\\left[2\\left(V_{D D}-V_{T H}\\right) V_{\\text {out }}-V_{\\text {out }}^{2}\\right] \\quad t>t_{1} \\tag{13.11}\n\\end{align*}\n$$\n\nRearranging (13.11), we have\n\n$$\n\\begin{equation*}\n\\frac{d V_{\\text {out }}}{\\left[2\\left(V_{D D}-V_{T H}\\right)-V_{\\text {out }}\\right] V_{\\text {out }}}=-\\frac{1}{2} \\mu_{n} \\frac{C_{o x}}{C_{H}} \\frac{W}{L} d t \\tag{13.12}\n\\end{equation*}\n$$\n\nUpon partial fraction decomposition, we obtain\n\n$$\n\\begin{equation*}\n\\left[\\frac{1}{V_{\\text {out }}}+\\frac{1}{2\\left(V_{D D}-V_{T H}\\right)-V_{\\text {out }}}\\right] \\frac{d V_{\\text {out }}}{V_{D D}-V_{T H}}=-\\mu_{n} \\frac{C_{o x}}{C_{H}} \\frac{W}{L} d t \\tag{13.13}\n\\end{equation*}\n$$\n\nThus,\n\n$$\n\\begin{equation*}\n\\ln V_{\\text {out }}-\\ln \\left[2\\left(V_{D D}-V_{T H}\\right)-V_{\\text {out }}\\right]=-\\left(V_{D D}-V_{T H}\\right) \\mu_{n} \\frac{C_{o x}}{C_{H}} \\frac{W}{L}\\left(t-t_{1}\\right) \\tag{13.14}\n\\end{equation*}\n$$\n\nthat is\n\n$$\n\\begin{equation*}\n\\ln \\frac{V_{\\text {out }}}{2\\left(V_{D D}-V_{T H}\\right)-V_{\\text {out }}}=-\\left(V_{D D}-V_{T H}\\right) \\mu_{n} \\frac{C_{\\text {ox }}}{C_{H}} \\frac{W}{L}\\left(t-t_{1}\\right) \\tag{13.15}\n\\end{equation*}\n$$\n\nTaking the exponential of both sides and solving for $V_{\\text {out }}$, we find\n\n$$\n\\begin{equation*}\nV_{o u t}=\\frac{2\\left(V_{D D}-V_{T H}\\right) \\exp \\left[-\\left(V_{D D}-V_{T H}\\right) \\mu_{n} \\frac{C_{o x}}{C_{H}} \\cdot \\frac{W}{L}\\left(t-t_{1}\\right)\\right]}{1+\\exp \\left[-\\left(V_{D D}-V_{T H}\\right) \\mu_{n} \\frac{C_{o x}}{C_{H}} \\cdot \\frac{W}{L}\\left(t-t_{1}\\right)\\right]} \\tag{13.16}\n\\end{equation*}\n$$\n\nimage_name:Figure 13.12 Maximum output level in an NMOS sampler\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout, D: VDD, G: CK}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit is an NMOS sampler with an input voltage Vin set to VDD. The NMOS transistor M1 is controlled by a clock signal CK. The output voltage Vout changes over time as shown in the graph, reaching a maximum of VDD - VTH.\nimage_name:Vout vs time\ndescription:The graph titled \"Vout vs time\" is a time-domain waveform representing the output voltage \\( V_{\\text{out}} \\) of an NMOS sampler circuit over time.\n\n**Axes Labels and Units:**\n- The horizontal axis represents time \\( t \\), though no specific units are provided, it is generally in seconds or milliseconds.\n- The vertical axis represents the output voltage \\( V_{\\text{out}} \\) in volts.\n\n**Overall Behavior and Trends:**\n- The graph shows the output voltage \\( V_{\\text{out}} \\) increasing exponentially as time progresses.\n- Initially, at time \\( t_0 \\), the output voltage \\( V_{\\text{out}} \\) is at \\( V_{DD} \\).\n- As time elapses, \\( V_{\\text{out}} \\) decreases exponentially towards zero.\n- This trend indicates the charging of the capacitor \\( C_H \\) through the NMOS switch \\( M_1 \\) when the clock signal \\( CK \\) is high.\n\n**Key Features and Technical Details:**\n- The graph demonstrates an exponential decay, a typical characteristic of an RC charging circuit.\n- The point where \\( V_{\\text{out}} \\) starts to decline is marked as \\( t_0 \\), indicating the activation of the NMOS switch by the clock signal.\n- The rate of decay depends on the time constant of the circuit, influenced by the resistance and capacitance values.\n\n**Annotations and Specific Data Points:**\n- The graph begins at \\( V_{DD} \\) and approaches zero as time increases.\n- There are no specific numerical values or annotations for the time constant or the precise rate of decay, but the overall trend is clear from the graph's shape.\n\nFigure 13.12 Maximum output level in an NMOS sampler.\nIn the circuit of Figure 13.10(b), we previously assumed that $V_{i n}=+1 \\mathrm{~V}$ (Figure 13.12). Now, let's assume $V_{i n}=V_{D D}$. How does $V_{\\text {out }}$ change with time? Since the gate and drain of $M_{1}$ are at the same potential, the transistor is in saturation, and we have\n\n$$\n\\begin{align*}\nC_{H} \\frac{d V_{\\text {out }}}{d t} & =I_{D 1}  \\tag{13.17}\\\\\n& =\\frac{1}{2} \\mu_{n} C_{\\text {ox }} \\frac{W}{L}\\left(V_{D D}-V_{\\text {out }}-V_{T H}\\right)^{2} \\tag{13.18}\n\\end{align*}\n$$\n\nwhere channel-length modulation is disregarded. It follows that\n\n$$\n\\begin{equation*}\n\\frac{d V_{\\text {out }}}{\\left(V_{D D}-V_{\\text {out }}-V_{T H}\\right)^{2}}=\\frac{1}{2} \\mu_{n} \\frac{C_{\\text {ox }}}{C_{H}} \\frac{W}{L} d t \\tag{13.19}\n\\end{equation*}\n$$\n\nand hence\n\n$$\n\\begin{equation*}\n\\left.\\frac{1}{V_{D D}-V_{\\text {out }}-V_{T H}}\\right|_{0} ^{\\text {Vout }}=\\left.\\frac{1}{2} \\mu_{n} \\frac{C_{o x}}{C_{H}} \\frac{W}{L} t\\right|_{0} ^{t} \\tag{13.20}\n\\end{equation*}\n$$\n\nwhere body effect is ignored and $V_{\\text {out }}(t=0)$ is assumed to be zero. Thus,\n\n$$\n\\begin{equation*}\nV_{\\text {out }}=V_{D D}-V_{T H}-\\frac{1}{\\frac{1}{2} \\mu_{n} \\frac{C_{o x}}{C_{H}} \\frac{W}{L} t+\\frac{1}{V_{D D}-V_{T H}}} \\tag{13.21}\n\\end{equation*}\n$$\n\nEquation (13.21) suggests that as $t \\rightarrow \\infty, V_{\\text {out }} \\rightarrow V_{D D}-V_{T H}$. This is because as $V_{\\text {out }}$ approaches $V_{D D}-V_{T H}$, the overdrive voltage of $M_{1}$ fades away, reducing the current available for charging $C_{H}$ to negligible values. Nonetheless, even for $V_{o u t}=V_{D D}-V_{T H}$, the transistor conducts some subthreshold current and, with sufficient time, eventually brings $V_{\\text {out }}$ to $V_{D D}$. Nonetheless, as mentioned in Chapter 3, for typical operation speeds, it is reasonable to assume that $V_{\\text {out }}$ does not exceed $V_{D D}-V_{T H}$.\n\nThe analysis above illustrates a significant limitation of MOS switches: if the input signal level is nearly equal to $V_{D D}$, the output provided by an NMOS switch may not accurately track the input. Additionally, the on-resistance of the switch increases significantly as the input and output voltages near $V_{D D}-V_{T H}$. Consequently, it is crucial to consider the maximum input level that the switch can transfer to the output without distortion. In Figure 13.12, for $V_{\\text {out }} \\approx V_{i n}$, the transistor must operate in the deep triode region, and thus, the upper limit of $V_{i n}$ is $V_{D D}-V_{T H}$. As discussed later, in practice, $V_{i n}$ must be much lower than this value.\n\n#### Example 13.3\n\nIn the circuit depicted in Figure 13.13, calculate the minimum and maximum on-resistance of $M_{1}$. Assume $\\mu_{n} C_{o x}=$ $50 \\mu \\mathrm{~A} / \\mathrm{V}^{2}, W / L=10 / 1, V_{T H}=0.7 \\mathrm{~V}, V_{D D}=3 \\mathrm{~V}$, and $\\gamma=0$.\nimage_name:f_{in} = 10 MHz\ndescription:The graph depicted is a time-domain waveform representing the input and output voltages of a circuit involving a transistor $M_1$ and a capacitor $C_H$. The input signal, labeled $f_{in} = 10 \\text{ MHz}$, is shown on the left side of the diagram. It is a sinusoidal waveform with a frequency of 10 MHz and an amplitude of 0.5 V. The horizontal axis represents time $t$, and the vertical axis represents voltage in volts.\n\nThe output signal, $V_{out}$, is displayed on the right side of the diagram. It mirrors the input waveform, indicating that $V_{out}$ closely follows $V_{in}$. This suggests that the transistor $M_1$ is operating in a region that allows the output to mirror the input with minimal phase shift or distortion.\n\nThe circuit schematic in the center shows a transistor $M_1$ connected to a 3 V supply and a 1 pF capacitor $C_H$. The gate of the transistor is driven by the input voltage, and the source is connected to the output node $V_{out}$. The configuration implies that $M_1$ is functioning as a pass transistor, enabling the input signal to pass through to the output while the capacitor $C_H$ likely serves to stabilize or filter the output signal.\n\nOverall, the graph"
},
{
    "text": "An elementary sampling circuit is composed of a switch and a capacitor [as seen in Fig. 13.9(a)]. A metal-oxide-semiconductor field-effect transistor (MOSFET) can act as a switch [refer to Fig. 13.9(b)], as it can remain in an 'on' state while carrying zero current.\n\nTo grasp how the circuit depicted in Fig. 13.9(b) captures the input, first examine the straightforward scenarios shown in Fig. 13.10, where the gate control signal, denoted as $C K$, rises to a high level at time $t=t_{0}$. In Fig. 13.10(a), it is assumed that $V_{i n}=0$ and that the capacitor has an initial voltage that matches $V_{D D}$. Consequently, at $t=t_{0}, M_{1}$ detects a gate-source voltage identical to $V_{D D}$, and its drain voltage is also $V_{D D}$. Hence, the transistor operates in saturation, drawing a current of $I_{D 1}=\\left(\\mu_{n} C_{o x} / 2\\right)(W / L)\\left(V_{D D}-V_{T H}\\right)^{2}$ from the capacitor. As $V_{\\text {out }}$ diminishes, at some point $V_{\\text {out }}=V_{D D}-V_{T H}$, it drives $M_{1}$ into the triode region. However, the device continues to discharge $C_{H}$ until $V_{\\text {out }}$ nears zero. Notably, when $V_{\\text {out }} \\ll 2\\left(V_{D D}-V_{T H}\\right)$, the transistor can be conceptualized as a resistor with a resistance of $R_{o n}=\\left[\\mu_{n} C_{o x}(W / L)\\left(V_{D D}-V_{T H}\\right)\\right]^{-1}$.\n\nMoving to Fig. 13.10(b), where $V_{\\text {in }}=+1 \\mathrm{~V}, V_{\\text {out }}\\left(t=t_{0}\\right)=0 \\mathrm{~V}$, and $V_{D D}=3 \\mathrm{~V}$, the terminal of $M_{1}$ connected to $C_{H}$ behaves as the source, and the transistor turns on with $V_{G S}=+3$ V, yet $V_{D S}=+1 \\mathrm{~V}$. Therefore, $M_{1}$ operates in the triode region, charging $C_{H}$ until $V_{\\text {out }}$ gets close to +1 V. For $V_{\\text {out }} \\approx+1 \\mathrm{~V}, M_{1}$ shows an on-resistance of $R_{o n}=\\left[\\mu_{n} C_{o x}(W / L)\\left(V_{D D}-V_{\\text {in }}-V_{T H}\\right)\\right]^{-1}$.\n\nThe observations above highlight two critical aspects. Firstly, a MOSFET can conduct current in either direction by simply swapping its source and drain terminals. Secondly, as depicted in Fig. 13.11, when the switch is active, $V_{\\text {out }}$ follows $V_{\\text {in }}$, and when the switch is inactive, $V_{o u t}$ remains constant. Consequently, the circuit \"monitors\" the signal when $C K$ is high and \"locks\" the instantaneous value of $V_{i n}$ across $C_{H}$ when $C K$ transitions to low.\n\n#### Example 13.2\n\nIn the circuit of Fig. 13.10(a), determine $V_{\\text {out }}$ as a function of time. Assume that $\\lambda=0$.\n\n#### Solution\n\nPrior to $V_{\\text {out }}$ falling below $V_{D D}-V_{T H}, M_{1}$ is in saturation, and we have\n\n$$\n\\begin{align*}\nV_{\\text {out }}(t) & =V_{D D}-\\frac{I_{D 1} t}{C_{H}}  \\tag{13.7}\\\\\n& =V_{D D}-\\frac{1}{2} \\mu_{n} C_{o x} \\frac{W}{L}\\left(V_{D D}-V_{T H}\\right)^{2} \\frac{t}{C_{H}} \\tag{13.8}\n\\end{align*}\n$$\n\nimage_name:(a)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout, D: Vin, G: High}\nname: C_H, type: Capacitor, value: C_H, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit is a track and hold sampling circuit. The NMOS transistor M1 is utilized as a switch controlled by the input voltage Vin. When the switch is engaged, the capacitor CH charges to the input voltage. The resistor R is applied to control the charging time constant.\n\nimage_name:(b)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout, D: Vin, G: High}\nname: C_H, type: Capacitor, value: C_H, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit is a track and hold sampling circuit equipped with an NMOS transistor, a resistor, and a capacitor. The NMOS transistor is managed by a 'Low' signal, and the output voltage is sampled across the capacitor CH.\n\nFigure 13.11 Track and hold capabilities of a sampling circuit.\nAfter\n\n$$\n\\begin{equation*}\nt_{1}=\\frac{2 V_{T H} C_{H}}{\\mu_{n} C_{o x} \\frac{W}{L}\\left(V_{D D}-V_{T H}\\right)^{2}} \\tag{13.9}\n$$\n\n$M_{1}$ transitions into the triode region, producing a time-varying current. Consequently, we write\n\n$$\n\\begin{align*}\nC_{H} \\frac{d V_{\\text {out }}}{d t} & =-I_{D 1}  \\tag{13.10}\\\\\n& =-\\frac{1}{2} \\mu_{n} C_{o x} \\frac{W}{L}\\left[2\\left(V_{D D}-V_{T H}\\right) V_{\\text {out }}-V_{\\text {out }}^{2}\\right] \\quad t>t_{1} \\tag{13.11}\n\\end{align*}\n$$\n\nRearranging (13.11), we obtain\n\n$$\n\\begin{equation*}\n\\frac{d V_{\\text {out }}}{\\left[2\\left(V_{D D}-V_{T H}\\right)-V_{\\text {out }}\\right] V_{\\text {out }}}=-\\frac{1}{2} \\mu_{n} \\frac{C_{o x}}{C_{H}} \\frac{W}{L} d t \\tag{13.12}\n\\end{equation*}\n$$\n\nThis, after partial fraction decomposition, becomes\n\n$$\n\\begin{equation*}\n\\left[\\frac{1}{V_{\\text {out }}}+\\frac{1}{2\\left(V_{D D}-V_{T H}\\right)-V_{\\text {out }}}\\right] \\frac{d V_{\\text {out }}}{V_{D D}-V_{T H}}=-\\mu_{n} \\frac{C_{o x}}{C_{H}} \\frac{W}{L} d t \\tag{13.13}\n\\end{equation*}\n$$\n\nThus,\n\n$$\n\\begin{equation*}\n\\ln V_{\\text {out }}-\\ln \\left[2\\left(V_{D D}-V_{T H}\\right)-V_{\\text {out }}\\right]=-\\left(V_{D D}-V_{T H}\\right) \\mu_{n} \\frac{C_{o x}}{C_{H}} \\frac{W}{L}\\left(t-t_{1}\\right) \\tag{13.14}\n\\end{equation*}\n$$\n\nwhich simplifies to\n\n$$\n\\begin{equation*}\n\\ln \\frac{V_{\\text {out }}}{2\\left(V_{D D}-V_{T H}\\right)-V_{\\text {out }}}=-\\left(V_{D D}-V_{T H}\\right) \\mu_{n} \\frac{C_{\\text {ox }}}{C_{H}} \\frac{W}{L}\\left(t-t_{1}\\right) \\tag{13.15}\n\\end{equation*}\n$$\n\nTaking the exponential of both sides and solving for $V_{\\text {out }}$, we find\n\n$$\n\\begin{equation*}\nV_{o u t}=\\frac{2\\left(V_{D D}-V_{T H}\\right) \\exp \\left[-\\left(V_{D D}-V_{T H}\\right) \\mu_{n} \\frac{C_{o x}}{C_{H}} \\cdot \\frac{W}{L}\\left(t-t_{1}\\right)\\right]}{1+\\exp \\left[-\\left(V_{D D}-V_{T H}\\right) \\mu_{n} \\frac{C_{o x}}{C_{H}} \\cdot \\frac{W}{L}\\left(t-t_{1}\\right)\\right]} \\tag{13.16}\n\\end{equation*}\n$$\n\nimage_name:Figure 13.12 Maximum output level in an NMOS sampler\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout, D: VDD, G: CK}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit is an NMOS sampler with an input voltage Vin set to VDD. The NMOS transistor M1 is controlled by a clock signal CK. The output voltage Vout changes over time as shown in the graph, reaching a maximum of VDD - VTH.\nimage_name:Vout vs time\ndescription:The graph titled \"Vout vs time\" is a time-domain waveform representing the output voltage \\( V_{\\text{out}} \\) of an NMOS sampler circuit over time.\n\n**Axes Labels and Units:**\n- The horizontal axis represents time \\( t \\), though no specific units are provided, it is typically measured in seconds or milliseconds in such contexts.\n- The vertical axis represents the output voltage \\( V_{\\text{out}} \\) in volts.\n\n**Overall Behavior and Trends:**\n- The graph shows an exponential rise in the output voltage \\( V_{\\text{out}} \\) as time progresses.\n- Initially, \\( V_{\\text{out}} \\) starts at 0 volts and increases towards \\( V_{DD} - V_{TH} \\) as \\( t \\) increases.\n- The shape of the curve is characteristic of an RC discharge circuit, where the voltage asymptotically approaches its maximum value.\n\n**Key Features and Technical Details:**\n- The curve starts at the origin (0,0), indicating that \\( V_{\\text{out}} \\) is zero at \\( t=0 \\).\n- As time progresses, the curve rises sharply initially and then gradually flattens out as it approaches the voltage level \\( V_{DD} - V_{TH} \\), indicating saturation.\n- The curve does not reach \\( V_{DD} \\) entirely, due to the threshold voltage \\( V_{TH} \\) of the transistor.\n\n**Annotations and Specific Data Points:**\n- A step input \\( V_{\\text{in}} = V_{DD} \\) is applied at the beginning of the time axis, which is reflected in the waveform.\n- The graph does not provide specific numerical values for \\( V_{DD} \\) or \\( V_{TH} \\), but the trend and behavior are clearly illustrated.\n\nThis graph gives insight into the transient response of the NMOS sampler circuit when a step voltage \\( V_{DD} \\) is applied, demonstrating how \\( V_{\\text{out}} \\) evolves over time until it stabilizes at \\( V_{DD} - V_{TH} \\).\n\nFigure 13.12 Maximum output level in an NMOS sampler.\nIn the circuit of Fig. 13.10(b), we initially assumed that $V_{i n}=+1 \\mathrm{~V}$ (Fig. 13.12). Now, assume $V_{i n}=V_{D D}$. How does $V_{\\text {out }}$ change over time? As the gate and drain of $M_{1}$ share the same potential, the transistor is saturated, and we have\n\n$$\n\\begin{align*}\nC_{H} \\frac{d V_{\\text {out }}}{d t} & =I_{D 1}  \\tag{13.17}\\\\\n& =\\frac{1}{2} \\mu_{n} C_{\\text {ox }} \\frac{W}{L}\\left(V_{D D}-V_{\\text {out }}-V_{T H}\\right)^{2} \\tag{13.18}\n\\end{align*}\n$$\n\nwhere channel-length modulation is ignored. It follows that\n\n$$\n\\begin{equation*}\n\\frac{d V_{\\text {out }}}{\\left(V_{D D}-V_{\\text {out }}-V_{T H}\\right)^{2}}=\\frac{1}{2} \\mu_{n} \\frac{C_{\\text {ox }}}{C_{H}} \\frac{W}{L} d t \\tag{13.19}\n\\end{equation*}\n$$\n\nand hence\n\n$$\n\\begin{equation*}\n\\left.\\frac{1}{V_{D D}-V_{\\text {out }}-V_{T H}}\\right|_{0} ^{\\text {Vout }}=\\left.\\frac{1}{2} \\mu_{n} \\frac{C_{o x}}{C_{H}} \\frac{W}{L} t\\right|_{0} ^{t} \\tag{13.20}\n\\end{equation*}\n$$\n\nwhere body effect is neglected and $V_{\\text {out }}(t=0)$ is assumed zero. Thus,\n\n$$\n\\begin{equation*}\nV_{\\text {out }}=V_{D D}-V_{T H}-\\frac{1}{\\frac{1}{2} \\mu_{n} \\frac{C_{o x}}{C_{H}} \\frac{W}{L} t+\\frac{1}{V_{D D}-V_{T H}}} \\tag{13.21}\n\\end{equation*}\n$$\n\nEquation (13.21) suggests that as $t \\rightarrow \\infty, V_{\\text {out }} \\rightarrow V_{D D}-V_{T H}$. This is because as $V_{\\text {out }}$ approaches $V_{D D}-V_{T H}$, the overdrive voltage of $M_{1}$ diminishes, reducing the current available for charging $C_{H}$ to insignificant levels. Of course, even for $V_{o u t}=V_{D D}-V_{T H}$, the transistor conducts some subthreshold current, and given sufficient time, eventually brings $V_{\\text {out }}$ to $V_{D D}$. However, as mentioned in Chapter 3, for typical operating speeds, it is reasonable to assume that $V_{\\text {out }}$ does not surpass $V_{D D}-V_{T H}$.\n\nThe aforementioned analysis reveals a significant limitation of MOSFET switches: if the input signal level is nearly $V_{D D}$, then the output provided by an NMOS switch cannot accurately represent the input. From another perspective, the on-resistance of the switch increases significantly as the input and output voltages approach $V_{D D}-V_{T H}$. Consequently, it is worthwhile to inquireWhat is the maximum input level that the switch can transfer to the output without error? In Fig. 13.12, for $V_{\\text {out }} \\approx V_{i n}$, the transistor must operate in the deep triode region, and thus the upper bound of $V_{i n}$ equals $V_{D D}-V_{T H}$. As discussed later, in practice, $V_{i n}$ must be significantly less than this value."
},
{
    "text": "A basic sampling circuit comprises a switch and a capacitor, as depicted in Figure 13.9(a). A MOS transistor can act as a switch, as shown in Figure 13.9(b), since it can be turned on while conducting zero current.\n\nTo comprehend how the circuit in Figure 13.9(b) samples the input, first examine the straightforward scenarios illustrated in Figure 13.10, where the gate command, $C K$, rises at $t=t_{0}$. In Figure 13.10(a), we assume that $V_{i n}=0$ and the capacitor has an initial voltage equal to $V_{D D}$. Consequently, at $t=t_{0},\nA basic sampling circuit consists made up of a switch and a capacitor, as illustrated in Figure 13.9(a). A MOS transistor can function as a switch, as depicted in Figure 13.9(b), since it can be turned\nA fundamental sampling circuit includes a switch and a capacitor, as illustrated in Figure 13.9(a). A MOS transistor can act as a switch, as represented in Figure 13.9(b), given it can be active on without carrying no current.\n\n"
},
{
    "text": "A straightforward sampling circuit comprises a switch and a capacitor [Fig. 13.9(a)]. A MOS transistor can function as this switch [Fig. 13.9(b)], capable of being on while carrying no current.\n\nTo grasp how the circuit in Fig. 13.9(b) captures the input, first examine the simple scenarios shown in Fig. 13.10, where the gate command, $C K$, rises at $t=t_{0}$. In Fig. 13.10(a), it is assumed that $V_{i n}=0$ and the capacitor has an initial voltage equal to $V_{D D}$. Therefore, at $t=t_{0}$, $M_{1}$ detects a gate-source voltage equal to $V_{D D}$ while its drain voltage is also equal to $V_{D D}$. Consequently, the transistor operates in saturation, drawing a current of $I_{D 1}=\\left(\\mu_{n} C_{o x} / 2\\right)(W / L)\\left(V_{D D}-V_{T H}\\right)^{2}$ from the capacitor. As $V_{\\text {out }}$ drops, at some point $V_{\\text {out }}=V_{D D}-V_{T H}$, pushing $M_{1}$ into the triode region. Despite this, the device continues to discharge $C_{H}$ until $V_{\\text {out }}$ nears zero. We observe that for $V_{\\text {out }} \\ll 2\\left(V_{D D}-V_{T H}\\right)$, the transistor can be regarded as a resistor equivalent to $R_{o n}=\\left[\\mu_{n} C_{o x}(W / L)\\left(V_{D D}-V_{T H}\\right)\\right]^{-1}$.\n\nNow, consider the situation in Fig. 13.10(b), where $V_{\\text {in }}=+1 \\mathrm{~V}$, $V_{\\text {out }}\\left(t=t_{0}\\right)=0 \\mathrm{~V}$, and $V_{D D}=3 \\mathrm{~V}$. Here, the terminal of $M_{1}$ connected to $C_{H}$ acts as the source, and the transistor turns on with $V_{G S}=+3$ V, but $V_{D S}=+1 \\mathrm{~V}$. Hence, $M_{1}$ operates in the triode region, charging $C_{H}$ until $V_{\\text {out }}$ approaches +1 V. For $V_{\\text {out }} \\approx+1 \\mathrm{~V}$, $M_{1}$ exhibits an on-resistance of $R_{o n}=\\left[\\mu_{n} C_{o x}(W / L)\\left(V_{D D}-V_{\\text {in }}-V_{T H}\\right)\\right]^{-1}$.\n\nThe above observations highlight two crucial points. First, a MOS switch can conduct current in either direction simply by swapping the roles of its source and drain terminals. Second, as depicted in Fig. 13.11, when the switch is on, $V_{\\text {out }}$ follows $V_{\\text {in }}$, and when the switch is off, $V_{o u t}$ remains constant. Thus, the circuit \"tracks\" the signal when $C K$ is high and \"freezes\" the instantaneous value of $V_{i n}$ across $C_{H}$ when C K goes low."
},
{
    "text": "A straightforward sampling circuit comprises a switch and a capacitor [Fig. 13.9(a)]. A MOS transistor is capable of acting as a switch [Fig. 13.9(b)] as it can be in the 'on' state while carrying zero current.\n\nTo grasp how the circuit in Fig. 13.9(b) samples the input, initially examine the simplified scenarios depicted in Fig. 13.10, where the gate command, $C K$, rises at $t=t_{0}$. In Fig. 13.10(a), we consider that $V_{i n}=0$ and the capacitor has an initial voltage equal to $V_{D D}$. Therefore, at $t=t_{0}$, $M_{1}$ detects a gate-source voltage equal to $V_{D D}$ while its drain voltage is also equal to $V_{D D}$. The transistor thus operates in saturation, drawing a current of $I_{D 1}=\\left(\\mu_{n} C_{o x} / 2\\right)(W / L)\\left(V_{D D}-V_{T H}\\right)^{2}$ from the capacitor. As $V_{\\text {out }}$ falls, at some point $V_{o u t}=V_{D D}-V_{T H}$, driving $M_{1}$ into the triode region. The device however continues to discharge $C_{H}$ until $V_{\\text {out }}$ approaches zero. We note that for $V_{\\text {out }} \\ll 2\\left(V_{D D}-V_{T H}\\right)$, the transistor can be viewed as a resistor equal to $R_{o n}=\\left[\\mu_{n} C_{o x}(W / L)\\left(V_{D D}-V_{T H}\\right)\\right]^{-1}$.\n\nNow consider the scenario in Fig. 13.10(b), where $V_{\\text {in }}=+1 \\mathrm{~V}, V_{\\text {out }}\\left(t=t_{0}\\right)=0 \\mathrm{~V}$, and $V_{D D}=3 \\mathrm{~V}$. Here, the terminal of $M_{1}$ connected to $C_{H}$ acts as the source, and the transistor turns on with $V_{G S}=+3$ V, but $V_{D S}=+1 \\mathrm{~V}$. Thus, $M_{1}$ operates in the triode region, charging $C_{H}$ until $V_{\\text {out }}$ approaches +1 V. For $V_{\\text {out }} \\approx+1 \\mathrm{~V}, M_{1}$ exhibits an on-resistance of $R_{o n}=\\left[\\mu_{n} C_{o x}(W / L)\\left(V_{D D}-V_{\\text {in }}-V_{T H}\\right)\\right]^{-1}$.\n\nThe above observations reveal two important points. First, a MOS switch can conduct current in either direction simply by swapping the role of its source and drain terminals. Second, as shown in Fig. 13.11, when the switch is on, $V_{\\text {out }}$ follows $V_{\\text {in }}$, and when the switch is off, $V_{o u t}$ remains constant. Thus, the circuit \"tracks\" the signal when $C K$ is high and \"freezes\" the instantaneous value of $V_{i n}$ across $C_{H}$ when C K goes low.\n\n#### Example 13.2\n\nIn the circuit of Fig. 13.10(a), calculate $V_{\\text {out }}$ as a function of time. Assume that $\\lambda=0$.\n\n#### Solution\n\nBefore $V_{\\text {out }}$ drops below $V_{D D}-V_{T H}, M_{1}$ is saturated and we have\n\n$$\n\\begin{align*}\nV_{\\text {out }}(t) & =V_{D D}-\\frac{I_{D 1} t}{C_{H}}  \\tag{13.7}\\\\\n& =V_{D D}-\\frac{1}{2} \\mu_{n} C_{o x} \\frac{W}{L}\\left(V_{D D}-V_{T H}\\right)^{2} \\frac{t}{C_{H}} \\tag{13.8}\n\\end{align*}\n$$\n\nAfter\n\n$$\n\\begin{equation*}\nt_{1}=\\frac{2 V_{T H} C_{H}}{\\mu_{n} C_{o x} \\frac{W}{L}\\left(V_{D D}-V_{T H}\\right)^{2}} \\tag{13.9}\n\\end{equation*}\n$$\n\n$M_{1}$ enters the triode region, yielding a time-dependent current. We therefore write\n\n$$\n\\begin{align*}\nC_{H} \\frac{d V_{\\text {out }}}{d t} & =-I_{D 1}  \\tag{13.10}\\\\\n& =-\\frac{1}{2} \\mu_{n} C_{o x} \\frac{W}{L}\\left[2\\left(V_{D D}-V_{T H}\\right) V_{\\text {out }}-V_{\\text {out }}^{2}\\right] \\quad t>t_{1} \\tag{13.11}\n\\end{align*}\n$$\n\nRearranging (13.11), we have\n\n$$\n\\begin{equation*}\n\\frac{d V_{\\text {out }}}{\\left[2\\left(V_{D D}-V_{T H}\\right)-V_{\\text {out }}\\right] V_{\\text {out }}}=-\\frac{1}{2} \\mu_{n} \\frac{C_{\\text {ox }}}{C_{H}} \\frac{W}{L} d t \\tag{13.12}\n\\end{equation*}\n$$\n\nwhich, upon separation into partial fractions, is written as\n\n$$\n\\begin{equation*}\n\\left[\\frac{1}{V_{\\text {out }}}+\\frac{1}{2\\left(V_{D D}-V_{T H}\\right)-V_{\\text {out }}\\right] \\frac{d V_{\\text {out }}}{V_{D D}-V_{T H}}=-\\mu_{n} \\frac{C_{o x}}{C_{H}} \\frac{W}{L} d t \\tag{13.13}\n\\end{equation*}\n$$\n\nThus,\n\n$$\n\\begin{equation*}\n\\ln V_{\\text {out }}-\\ln \\left[2\\left(V_{D D}-V_{T H}\\right)-V_{\\text {out }}\\right]=-\\left(V_{D D}-V_{T H}\\right) \\mu_{n} \\frac{C_{o x}}{C_{H}} \\frac{W}{L}\\left(t-t_{1}\\right) \\tag{13.14}\n\\end{equation*}\n$$\n\nthat is\n\n$$\n\\begin{equation*}\n\\ln \\frac{V_{\\text {out }}}{2\\left(V_{D D}-V_{T H}\\right)-V_{\\text {out }}}=-\\left(V_{D D}-V_{T H}\\right) \\mu_{n} \\frac{C_{\\text {ox }}}{C_{H}} \\frac{W}{L}\\left(t-t_{1}\\right) \\tag{13.15}\n\\end{equation*}\n$$\n\nTaking the exponential of both sides and solving for $V_{\\text {out }}$, we obtain\n\n$$\n\\begin{equation*}\nV_{o u t}=\\frac{2\\left(V_{D D}-V_{T H}\\right) \\exp \\left[-\\left(V_{D D}-V_{T H}\\right) \\mu_{n} \\frac{C_{o x}}{C_{H}} \\cdot \\frac{W}{L}\\left(t-t_{1}\\right)\\right]}{1+\\exp \\left[-\\left(V_{D D}-V_{T H}\\right) \\mu_{n} \\frac{C_{o x}}{C_{H}} \\cdot \\frac{W}{L}\\left(t-t_{1}\\right)\\right]} \\tag{13.16}\n\\end{equation*}\n$$\n\nIn the circuit of Fig. 13.10(b), we assumed that $V_{i n}=+1 \\mathrm{~V}$ (Fig. 13.12). Now suppose $V_{i n}=V_{D D}$. How does $V_{\\text {out }}$ vary with time? Since the gate and drain of $M_{1}$ are at the same potential, the transistor is saturated, and we have\n\n$$\n\\begin{align*}\nC_{H} \\frac{d V_{\\text {out }}}{d t} & =I_{D 1}  \\tag{13.17}\\\\\n& =\\frac{1}{2} \\mu_{n} C_{\\text {ox }} \\frac{W}{L}\\left(V_{D D}-V_{\\text {out }}-V_{T H}\\right)^{2} \\tag{13.18}\n\\end{align*}\n$$\n\nwhere channel-length modulation is neglected. It follows that\n\n$$\n\\begin{equation*}\n\\frac{d V_{\\text {out }}}{\\left(V_{D D}-V_{\\text {out }}-V_{T H}\\right)^{2}}=\\frac{1}{2} \\mu_{n} \\frac{C_{\\text {ox }}}{C_{H}} \\frac{W}{L} d t \\tag{13.19}\n\\end{equation*}\n$$\n\nand hence\n\n$$\n\\begin{equation*}\n\\left.\\frac{1}{V_{D D}-V_{\\text {out }}-V_{T H}}\\right|_{0} ^{\\text {Vout }}=\\left.\\frac{1}{2} \\mu_{n} \\frac{C_{o x}}{C_{H}} \\frac{W}{L} t\\right|_{0} ^{t} \\tag{13.20}\n\\end{equation*}\n$$\n\nwhere body effect is neglected and $V_{\\text {out }}(t=0)$ is assumed zero. Thus,\n\n$$\n\\begin{equation*}\nV_{\\text {out }}=V_{D D}-V_{T H}-\\frac{1}{\\frac{1}{2} \\mu_{n} \\frac{C_{o x}}{C_{H}} \\frac{W}{L} t+\\frac{1}{V_{D D}-V_{T H}}} \\tag{13.21}\n\\end{equation*}\n$$\n\nEquation (13.21) implies that as $t \\rightarrow \\infty, V_{\\text {out }} \\rightarrow V_{D D}-V_{T H}$. This is because as $V_{\\text {out }}$ approaches $V_{D D}-V_{T H}$, the overdrive voltage of $M_{1}$ vanishes, reducing the current available for charging $C_{H}$ to negligible values. Of course, even for $V_{o u t}=V_{D D}-V_{T H}$, the transistor conducts some subthreshold current and, given enough time, eventually brings $V_{\\text {out }}$ to $V_{D D}$. Nonetheless, as mentioned in Chapter 3, for typical operation speeds, it is reasonable to assume that $V_{\\text {out }}$ does not exceed $V_{D D}-V_{T H}$.\n\nThe foregoing analysis demonstrates a serious limitation of MOS switches: if the input signal level is close to $V_{D D}$, then the output provided by an NMOS switch cannot track the input. From another point of view, the on-resistance of the switch increases considerably as the input and output voltages approach $V_{D D}-V_{T H}$. We may then ask-What is the maximum input level that the switch can pass to the output faithfully? In Fig. 13.12, for $V_{\\text {out }} \\approx V_{i n}$, the transistor must operate in the deep triode region, and hence the upper bound of $V_{i n}$ equals $V_{D D}-V_{T H}$. As explained later, in practice, $V_{i n}$ must be quite lower than this value.\n\n#### Example 13.3\n\nIn the circuit of Fig. 13.13, calculate the minimum and maximum on-resistance of $M_{1}$. Assume that $\\mu_{n} C_{o x}=$ $50 \\mu \\mathrm{~A} / \\mathrm{V}^{2}, W / L=10 / 1, V_{T H}=0.7 \\mathrm{~V}, V_{D D}=3 \\mathrm{~V}$, and $\\gamma=0$.\nimage_name:f_{in} = 10 MHz\ndescription:The graph depicted is a time-domain waveform representing the input and output voltages of a circuit involving a transistor $M_1$ and a capacitor $C_H$. The input signal, labeled $f_{in} = 10 \\text{ MHz}$, is shown on the left side of the diagram. It is a sinusoidal waveform with a frequency of 10 MHz and an amplitude of 0.5 V. The horizontal axis represents time $t$, and the vertical axis represents voltage in volts.\n\nThe output signal, $V_{out}$, is displayed on the right side of the diagram. It mirrors the input waveform, indicating that $V_{out}$ tracks $V_{in}$ closely. This correspondence suggests that the transistor $M_1$ is operating in a region where it allows the output to follow the input with minimal phase shift or amplitude distortion.\n\nThe circuit schematic in the center shows a transistor $M_1$ connected to a 3 V supply and a 1 pF capacitor $C_H$. The gate of the transistor is driven by the input voltage, and the source is connected to the output node $V_{out}$. The configuration suggests that $M_1$ is acting as a pass transistor, allowing the input signal to pass through to the output while the capacitor $C_H$ likely serves to stabilize or filter the output signal.\n\nOverall, the graph indicates that the design achieves a high-fidelity transmission of the input signal to the output, appropriate for the given frequency and amplitude, and confirms the transistor's operation in the desired region, as described in the context.\nimage_name:Figure 13.13\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout, D: Vin, G: 3V}\nname: CH, type: Capacitor, value: 1 pF, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit consists of an NMOS transistor M1 and a capacitor CH. The NMOS operates in the triode region to allow Vout to track Vin with a negligible phase shift. The input frequency is 10 MHz, and the input and output signals have a peak of +0.5 V.\nimage_name:\ndescription:The diagram consists of a circuit schematic and two time-domain waveforms. The circuit features a MOSFET labeled as M1, with its gate connected to a +3 V supply, and its source connected to the output voltage, V_out. A capacitor, C_H, with a capacitance of 1 pF, is connected to V_out and grounded.\n\nOn either side of the circuit, there are two identical sinusoidal waveforms representing input and output voltages over time. Both waveforms have an amplitude of +0.5 V and a frequency of 10 MHz, as indicated by the label 'f_in = 10 MHz'. The waveforms are plotted against time (t) on the horizontal axis. The vertical axis represents voltage, although it is not explicitly labeled.\n\nThe waveforms suggest that the input and output signals are sinusoidal with no visible phase shift, indicating that V_out closely tracks V_in. This behavior is consistent with the operation of M1 in the triode region, where the on-resistance is low, allowing the output to follow the input with minimal distortion or delay.\n\n#### Solution\n\nWe note that in the steady state, $M_{1}$ remains in the triode region because the gate voltage is higher than both $V_{i n}$ and $V_{\\text {out }}$ by a value greater than $V_{T H}$. If $f_{\\text {in }}=10 \\mathrm{MHz}$, we predict that $V_{\\text {out }}$ tracks $V_{\\text {in }}$ with a negligible phase shift due to the on-resistance of $M_{1}$ and $C_{H}$. Assuming that $V_{\\text {out }} \\approx V_{i n}$, we need not distinguish between the source and drain terminals, obtaining\n\n$$\n\\begin{equation*}\nR_{o n 1}=\\frac{1}{\\mu_{n} C_{o x} \\frac{W}{L}\\left(V_{D D}-V_{i n}-V_{T H}\\right)} \\tag{13.22}\n\\end{equation*}\n$$\n\nThus, $R_{\\text {on } 1, \\max } \\approx 1.11 \\mathrm{k} \\Omega$ and $R_{\\text {on } 1, \\min } \\approx 870 \\Omega$. By contrast, if the maximum input level is raised to 1.5 V, then $R_{\\text {on } 1, \\max }=2.5 \\mathrm{k} \\Omega$.\n\nMOS devices operating in the deep triode region are sometimes called \"zero-offset\" switches to emphasize that they exhibit no dc shift between the input and output voltages of the simple sampling circuit of Fig. 13.9(b). ${ }^{2}$ This is evident from the examples of Fig. 13.10, where the output eventually becomes equal to the input. Nonexistent in bipolar technology, the zero-offset property proves crucial in precise sampling of analog signals.\n\nWe have thus far considered only NMOS switches. The reader can verify that the foregoing principles apply to PMOS switches as well. In particular, as shown in Fig. 13.14, a PMOS transistor fails to operate as a switch if its gate is grounded and its drain terminal senses an input voltage of $\\left|V_{T H P}\\right|$ or less. In other words, the on-resistance of the device rises rapidly as the input and output levels drop to $\\left|V_{T H P}\\right|$ above ground.\n"
},
{
    "text": "A basic sampling circuit comprises a switch and a capacitor [Fig. 13.9(a)]. A MOS transistor is utilized as a switch [Fig. 13.9(b)] since it can be activated while conducting zero current.\n\nTo comprehend the operation of the circuit in Fig. 13.9(b), initially examine the simplified scenarios illustrated in Fig. 13.10, where the gate command, $C K$, rises at $t=t_{0}$. In Fig. 13.10(a), it is assumed that $V_{i n}=0$ and the capacitor possesses an initial voltage equivalent to $V_{D D}$. Consequently, at $t=t_{0}$, $M_{1}$ perceives a gate-source voltage equal to $V_{D D}$ while its drain voltage is also equal to $V_{D D}$. Hence, the transistor operates in saturation, drawing a current of $I_{D 1}=\\left(\\mu_{n} C_{o x} / 2\\right)(W / L)\\left(V_{D D}-V_{T H}\\right)^{2}$ from the capacitor. As $V_{\\text {out }}$ diminishes, at some point, $V_{\\text {out }}=V_{D D}-V_{T H}$, forcing $M_{1}$ into the triode region. The device, however, continues to discharge $C_{H}$ until $V_{\\text {out }}$ approaches zero. We observe that for $V_{\\text {out }} \\ll 2\\left(V_{D D}-V_{T H}\\right)$, the transistor can be regarded as a resistor equal to $R_{o n}=\\left[\\mu_{n} C_{o x}(W / L)\\left(V_{D D}-V_{T H}\\right)\\right]^{-1}$.\n\nNow consider the instance in Fig. 13.10(b), where $V_{\\text {in }}=+1 \\mathrm{~V}$, $V_{\\text {out }}\\left(t=t_{0}\\right)=0 \\mathrm{~V}$, and $V_{D D}=3 \\mathrm{~V}$. Here, the terminal of $M_{1}$ linked to $C_{H}$ functions as the source, and the transistor turns on with $V_{G S}=+3$ V, but $V_{D S}=+1 \\mathrm{~V}$. Thus, $M_{1}$ operates in the triode region, charging $C_{H}$ until $V_{\\text {out }}$ approaches +1 V. For $V_{\\text {out }} \\approx+1 \\mathrm{~V}$, $M_{1}$ exhibits an on-resistance of $R_{o n}=\\left[\\mu_{n} C_{o x}(W / L)\\left(V_{D D}-V_{\\text {in }}-V_{T H}\\right)\\right]^{-1}$.\n\nThe aforementioned observations reveal two crucial points. First, a MOS switch can conduct current in either direction merely by swapping the roles of its source and drain terminals. Second, as depicted in Fig. 13.11, when the switch is activated, $V_{\\text {out }}$ mirrors $V_{\\text {in }}$, and when the switch is deactivated, $V_{o u t}$ remains constant. Thus, the circuit \"tracks\" the signal when $C K$ is high and \"freezes\" the instantaneous value of $V_{i n}$ across $C_{H}$ when C K goes low.\n\n#### Example 13.2\n\nIn the circuit of Fig. 13.10(a), compute $V_{\\text {out }}$ as a function of time. Assume that $\\lambda=0$.\n\n#### Solution\n\nPrior to $V_{\\text {out }}$ declining below $V_{D D}-V_{T H}$, $M_{1}$ is saturated, and we have\n\n$$\n\\begin{align*}\nV_{\\text {out }}(t) & =V_{D D}-\\frac{I_{D 1} t}{C_{H}}  \\tag{13.7}\\\\\n& =V_{D D}-\\frac{1}{2} \\mu_{n} C_{o x} \\frac{W}{L}\\left(V_{D D}-V_{T H}\\right)^{2} \\frac{t}{C_{H}} \\tag{13.8}\n\\end{align*}\n$$\n\nAfter\n\n$$\n\\begin{equation*}\nt_{1}=\\frac{2 V_{T H} C_{H}}{\\mu_{n} C_{o x} \\frac{W}{L}\\left(V_{D D}-V_{T H}\\right)^{2}} \\tag{13.9}\n\\end{equation*}\n$$\n\n$M_{1}$ transitions to the triode region, yielding a time-dependent current. We therefore write\n\n$$\n\\begin{align*}\nC_{H} \\frac{d V_{\\text {out }}}{d t} & =-I_{D 1}  \\tag{13.10}\\\\\n& =-\\frac{1}{2} \\mu_{n} C_{o x} \\frac{W}{L}\\left[2\\left(V_{D D}-V_{T H}\\right) V_{\\text {out }}-V_{\\text {out }}^{2}\\right] \\quad t>t_{1} \\tag{13.11}\n\\end{align*}\n$$\n\nRearranging (13.11), we obtain\n\n$$\n\\begin{equation*}\n\\frac{d V_{\\text {out }}}{\\left[2\\left(V_{D D}-V_{T H}\\right)-V_{\\text {out }}\\right] V_{\\text {out }}}=-\\frac{1}{2} \\mu_{n} \\frac{C_{\\text {ox }}}{C_{H}} \\frac{W}{L} d t \\tag{13.12}\n\\end{equation*}\n$$\n\nwhich, upon separation into partial fractions, is expressed as\n\n$$\n\\begin{equation*}\n\\left[\\frac{1}{V_{\\text {out }}}+\\frac{1}{2\\left(V_{D D}-V_{T H}\\right)-V_{\\text {out }}\\right] \\frac{d V_{\\text {out }}}{V_{D D}-V_{T H}}=-\\mu_{n} \\frac{C_{o x}}{C_{H}} \\frac{W}{L} d t \\tag{13.13}\n\\end{equation*}\n$$\n\nThus,\n\n$$\n\\begin{equation*}\n\\ln V_{\\text {out }}-\\ln \\left[2\\left(V_{D D}-V_{T H}\\right)-V_{\\text {out }}\\right]=-\\left(V_{D D}-V_{T H}\\right) \\mu_{n} \\frac{C_{\\text {ox }}}{C_{H}} \\frac{W}{L}\\left(t-t_{1}\\right) \\tag{13.14}\n\\end{equation*}\n$$\n\nthat is\n\n$$\n\\begin{equation*}\n\\ln \\frac{V_{\\text {out }}}{2\\left(V_{D D}-V_{T H}\\right)-V_{\\text {out }}}=-\\left(V_{D D}-V_{T H}\\right) \\mu_{n} \\frac{C_{\\text {ox }}}{C_{H}} \\frac{W}{L}\\left(t-t_{1}\\right) \\tag{13.15}\n\\end{equation*}\n$$\n\nTaking the exponential of both sides and solving for $V_{\\text {out }}$, we derive\n\n$$\n\\begin{equation*}\nV_{o u t}=\\frac{2\\left(V_{D D}-V_{T H}\\right) \\exp \\left[-\\left(V_{D D}-V_{T H}\\right) \\mu_{n} \\frac{C_{o x}}{C_{H}} \\cdot \\frac{W}{L}\\left(t-t_{1}\\right)\\right]}{1+\\exp \\left[-\\left(V_{D D}-V_{T H}\\right) \\mu_{n} \\frac{C_{o x}}{C_{H}} \\cdot \\frac{W}{L}\\left(t-t_{1}\\right)\\right]} \\tag{13.16}\n\\end{equation*}\n$$\n\nIn the circuit of Fig. 13.10(b), we assumed that $V_{i n}=V_{D D}$. How does $V_{\\text {out }}$ vary with time? Since the gate and drain of $M_{1}$ are at the same potential, the transistor is saturated, and we have\n\n$$\n\\begin{align*}\nC_{H} \\frac{d V_{\\text {out }}}{d t} & =I_{D 1}  \\tag{13.17}\\\\\n& =\\frac{1}{2} \\mu_{n} C_{\\text {ox }} \\frac{W}{L}\\left(V_{D D}-V_{\\text {out }}-V_{T H}\\right)^{2} \\tag{13.18}\n\\end{align*}\n$$\n\nwhere channel-length modulation is neglected. It follows that\n\n$$\n\\begin{equation*}\n\\frac{d V_{\\text {out }}}{\\left(V_{D D}-V_{\\text {out }}-V_{T H}\\right)^{2}}=\\frac{1}{2} \\mu_{n} \\frac{C_{\\text {ox }}}{C_{H}} \\frac{W}{L} d t \\tag{13.19}\n\\end{equation*}\n$$\n\nand hence\n\n$$\n\\begin{equation*}\n\\left.\\frac{1}{V_{D D}-V_{\\text {out }}-V_{T H}}\\right|_{0} ^{\\text {Vout }}=\\left.\\frac{1}{2} \\mu_{n} \\frac{C_{o x}}{C_{H}} \\frac{W}{L} t\\right|_{0} ^{t} \\tag{13.20}\n\\end{equation*}\n$$\n\nwhere body effect is neglected and $V_{\\text {out }}(t=0)$ is assumed zero. Thus,\n\n$$\n\\begin{equation*}\nV_{\\text {out }}=V_{D D}-V_{T H}-\\frac{1}{\\frac{1}{2} \\mu_{n} \\frac{C_{o x}}{C_{H}} \\frac{W}{L} t+\\frac{1}{V_{D D}-V_{T H}}} \\tag{13.21}\n\\end{equation*}\n$$\n\nEquation (13.21) implies that as $t \\rightarrow \\infty$, $V_{\\text {out }} \\rightarrow V_{D D}-V_{T H}$. This is because as $V_{\\text {out }}$ approaches $V_{D D}-V_{T H}$, the overdrive voltage of $M_{1}$ diminishes, reducing the current available for charging $C_{H}$ to negligible values. Of course, even for $V_{o u t}=V_{D D}-V_{T H}$, the transistor conducts some subthreshold current and, given enough time, eventually brings $V_{\\text {out }}$ to $V_{D D}$. Nonetheless, as mentioned in Chapter 3, for typical operation speeds, it is reasonable to assume that $V_{\\text {out }}$ does not exceed $V_{D D}-V_{T H}$.\n\nThe preceding analysis demonstrates a significant limitation of MOS switches: if the input signal level is close to $V_{D D}$, then the output provided by an NMOS switch cannot track the input. From another perspective, the on-resistance of the switch increases considerably as the input and output voltages approach $V_{D D}-V_{T H}$. We may then inquire-What is the maximum input level that the switch can pass to the output reliably? In Fig. 13.12, for $V_{\\text {out }} \\approx V_{i n}$, the transistor must operate in the deep triode region, and hence the upper bound of $V_{i n}$ equals $V_{D D}-V_{T H}$. As explained later, in practice, $V_{i n}$ must be substantially lower than this value.\n\n#### Example 13.3\n\nIn the circuit of Fig. 13.13, calculate the minimum and maximum on-resistance of $M_{1}$. Assume that $\\mu_{n} C_{o x}=$ $50 \\mu \\mathrm{~A} / \\mathrm{V}^{2}$, $W / L=10 / 1$, $V_{T H}=0.7 \\mathrm{~V}$, $V_{D D}=3 \\mathrm{~V}$, and $\\gamma=0$.\n\n#### Solution\n\nWe observe that in the steady state, $M_{1}$ remains in the triode region because the gate voltage is higher than both $V_{i n}$ and $V_{\\text {out }}$ by a value greater than $V_{T H}$. If $f_{\\text {in }}=10 \\mathrm{MHz}$, we predict that $V_{\\text {out }}$ tracks $V_{\\text {in }}$ with a negligible phase shift due to the on-resistance of $M_{1}$ and $C_{H}$. Assuming that $V_{\\text {out }} \\approx V_{i n}$, we need not distinguish between the source and drain terminals, obtaining\n\n$$\n\\begin{equation*}\nR_{o n 1}=\\frac{1}{\\mu_{n} C_{o x} \\frac{W}{L}\\left(V_{D D}-V_{i n}-V_{T H}\\right)} \\tag{13.22}\n\\end{equation*}\n$$\n\nThus, $R_{\\text {on } 1, \\max } \\approx 1.11 \\mathrm{k} \\Omega$ and $R_{\\text {on } 1, \\min } \\approx 870 \\Omega$. By contrast, if the maximum input level is raised to 1.5 V, then $R_{\\text {on } 1, \\max }=2.5 \\mathrm{k} \\Omega$.\n\nMOS devices operating in the deep triode region are occasionally referred to as \"zero-offset\" switches to emphasize that they exhibit no dc shift between the input and output voltages of the simple sampling circuit of Fig. 13.9(b). This is evident from the examples of Fig. 13.10, where the output eventually becomes equal to the input. Nonexistent in bipolar technology, the zero-offset property proves crucial in precise sampling of analog signals.\n\nWe have thus far considered only NMOS switches. The reader can verify that the aforementioned principles apply to PMOS switches as well. In particular, as shown in Fig. 13.14, a PMOS transistor fails to operate as a switch if its gate is grounded and its drain terminal senses an input voltage of $\\left|V_{T H P}\\right|$ or less. In other words, the on-resistance of the device rises rapidly as the input and output levels drop to $\\left|V_{T H P}\\right|$ above ground."
},
{
    "text": "Image Descriptions: All images referenced within the [Context Provided] section have been transformed into textual descriptions. Further, this text has been rephrased to retain its original meaning and length.\n---[Task]---\nPlease rephrase the content found in the [Context Provided] Section. Ensure the revised text preserves the original intent and length. Here is the rephrased text:\n---[Context Provided]---\nA basic sampling circuit is composed of a switch and a capacitor [Refer to Figure 13.9(a)]. A MOSFET can function as a switch [Refer to Figure 13.9(b)] due to its capability to be conductive with zero current flow.\n\nTo comprehend the sampling process of the circuit in Figure 13.9(b), one should first analyze the simple scenarios presented in Figure 13.10, where the gate voltage, denoted as $C K$, becomes high at $t=t_{0}$. In Figure 13.10(a), it is assumed that $V_{i n}=0$ and the capacitor has an initial voltage equal to $V_{D D}$. Consequently, at $t=t_{0}, M_{1}$ detects a gate-source voltage equivalent to $V_{D D}$, and its drain voltage is also equal to $V_{D D}$. As a result, the transistor operates in the saturation region, drawing a current of $I_{D 1}=\\left(\\mu_{n} C_{o x} / 2\\right)(W / L)\\left(V_{D D}-V_{T H}\\right)^{2}$ from the capacitor. As $V_{\\text {out }}$ decreases, at a certain point $V_{o u t}=V_{D D}-V_{T H}$, the transistor transitions into the triode region. Despite this, the device continues to discharge $C_{H}$ until $V_{\\text {out }}$ reaches nearly zero. We observe that when $V_{\\text {out }}$ is significantly less than $2\\left(V_{D D}-V_{T H}\\right)$, the transistor can be considered as a resistor with a value of $R_{o n}=\\left[\\mu_{n} C_{o x}(W / L)\\left(V_{D D}-V_{T H}\\right)\\right]^{-1}$.\n\nNext, let's examine the case depicted in Figure 13.10(b), where $V_{\\text {in }}=+1 \\mathrm{~V}, V_{\\text {out }}\\left(t=t_{0}\\right)=0 \\mathrm{~V}$, and $V_{D D}=3 \\mathrm{~V}$. In this scenario, the terminal of $M_{1}$ connected to $C_{H}$ acts as the source, and the transistor turns on with $V_{G S}=+3$ V, but $V_{D S}=+1 \\mathrm{~V}$. Thus, $M_{1}$ operates in the triode region, charging $C_{H}$ until $V_{\\text {out }}$ reaches approximately +1 V. When $V_{\\text {out }} \\approx+1 \\mathrm{~V}$, the on-resistance of $M_{1}$ is $R_{o n}=\\left[\\mu_{n} C_{o x}(W / L)\\left(V_{D D}-V_{\\text {in }}-V_{T H}\\right)\\right]^{-1}$.\n\nThese observations highlight two critical aspects. Firstly, a MOSFET switch can conduct current in either direction by swapping the roles of its source and drain terminals. Secondly, as depicted in Figure 13.11, when the switch is activated, $V_{\\text {out }}$ follows $V_{\\text {in }}$, and when the switch is deactivated, $V_{o u t}$ remains constant. Consequently, the circuit \"tracks\" the signal when $C K$ is high and \"freezes\" the instantaneous value of $V_{i n}$ across $C_{H}$ when $C K$ goes low.\n\n[Rephrased continuation of the text...]"
},
{
    "text": "A fundamental sampling circuit is composed of a switch and a capacitor, as illustrated in Fig. 13.9(a). A MOS transistor is capable of acting as this switch, as depicted in Fig. 13.9(b), due to its ability to be conductive even when no current is flowing.\n\nTo comprehend how the circuit in Fig. 13.9(b) captures the input signal, we should first examine the straightforward scenarios shown in Fig. 13.10, where the gate command, CK, becomes high at time t0. In Fig. 13.10(a), it is assumed that the input voltage, Vin, is zero, and the capacitor holds an initial voltage equivalent to VDD. Consequently, at t0, M1 perceives a gate-source voltage equal to VDD, while its drain voltage is also equal to VDD. The transistor is thus in saturation, drawing a current of ID1 from the capacitor. As Vout decreases, at a certain point, Vout reaches VDD-VTH, steering M1 into the triode region. However, the device carries on discharging CH until Vout nears zero. We observe that when Vout is much smaller than 2(VDD-VTH), the transistor can be regarded as a resistor with a value of Ron.\n\nNow, let's consider the scenario in Fig. 13.10(b), where Vin is +1V, Vout at t0 is 0V, and VDD is 3V. Here, the terminal of M1 connected to CH acts as the source, and the transistor turns on with a VGS of +3V, but VDS is +1V. Thus, M1 operates in the triode region, charging CH until Vout nears +1V. When Vout is approximately +1V, M1 demonstrates an on-resistance of Ron.\n\nThese observations highlight two significant points. Firstly, a MOS switch can conduct current in either direction by merely swapping the roles of its source and drain terminals. Secondly, as shown in Fig. 13.11, when the switch is on, Vout follows Vin, and when the switch is off, Vout remains constant. Hence, the circuit \"tracks\" the signal when CK is high and \"freezes\" the instantaneous value of Vin across CH when CK goes low.\n\n#### Example 13.2\n\nIn the circuit of Fig. 13.10(a), calculate Vout as a function of time, assuming that =0.\n\n#### Solution\n\nBefore Vout drops below VDD-VTH, M1 is saturated, and we have:\n\nVout(t) = VDD - (ID1 * t) / CH\n        = VDD - (1/2) * n * Cox * (W/L) * (VDD-VTH)^2 * t / CH\n\nimage_name:(a)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout, D: Vin, G: High}\nname: C_H, type: Capacitor, value: C_H, ports: {Np: Vout, Nn: GND}\n'name': 'R', 'type': 'Resistor', 'value': 'R', 'ports': {'N1': 'Vin', 'N2': 'Vout'}\n'name': 'C_H', 'type: 'Capacitor', 'value': 'C_H', 'ports': {'N1': 'Vout', 'N2': 'Vout'}\n]\nextrainfo:The circuit is a track and hold sampling circuit. The NMOS transistor M1 is used as a switch controlled by the input voltage Vin. When the switch is closed, the capacitor CH charges to the input voltage. The resistor R is used to control the charging time constant.\n\nimage_name:(b)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout, D: Vin, G: High}\nname: C_H, type: Capacitor, value: C_H, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit is a track and hold sampling circuit with an NMOS transistor, a resistor, and a capacitor. The NMOS transistor is controlled by a 'Low' signal, and the output voltage is sampled across the capacitor CH.\n\nFigure 13.11 Track and hold capabilities of a sampling circuit.\n\nAfter t1 = (2 * VTH * CH) / (n * Cox * (W/L) * (VDD-VTH)^2), M1 enters the triode region, resulting in a time-dependent current. Therefore, we write:\n\nCH * dVout/dt = -ID1\n              = -(1/2) * n * Cox * (W/L) * [2(VDD-VTH) * Vout - Vout^2] for t > t1\n\nRearranging the equation, we get:\n\ndVout / [(2(VDD-VTH) - Vout) * Vout] = -(1/2) * n * Cox / CH * (W/L) * dt\n\nwhich, upon separation into partial fractions, is written as:\n\n[1/Vout + 1/(2(VDD-VTH) - Vout)] * dVout / (VDD-VTH) = -n * Cox / CH * (W/L) * dt\n\nThus:\n\nln Vout - ln[2(VDD-VTH) - Vout] = -(VDD-VTH) * n * Cox / CH * (W/L) * (t-t1)\n\nwhich simplifies to:\n\nln(Vout / [2(VDD-VTH) - Vout]) = -(VDD-VTH) * n * Cox / CH * (W/L) * (t-t1)\n\nTaking the exponential of both sides and solving for Vout, we obtain:\n\nVout = [2(VDD-VTH) * exp[-(VDD-VTH) * n * Cox / CH * (W/L) * (t-t1)]] / [1 + exp[-(VDD-VTH) * n * Cox / CH * (W/L) * (t-t1)]]\n\nimage_name:Figure 13.12 Maximum output level in an NMOS sampler\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout, D: VDD, G: CK}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit is an NMOS sampler with an input voltage Vin set to VDD. The NMOS transistor M1 is controlled by a clock signal CK. The output voltage Vout changes over time as shown in the graph, reaching a maximum of VDD - VTH.\n\nimage_name:Vout vs time\ndescription:The graph titled \"Vout vs time\" is a time-domain waveform representing the output voltage Vout of an NMOS sampler circuit over time.\n\n**Axes Labels and Units:**\n- The horizontal axis represents time t, but no specific units are provided. It is implied to be in seconds or a subunit thereof.\n- The vertical axis represents the output voltage Vout in volts.\n\n**Overall Behavior and Trends:**\n- The graph illustrates an exponential rise in the output voltage Vout as time progresses.\n- Initially, Vout starts at 0 volts and increases toward VDD - VTH as t increases.\n- The shape of the curve is characteristic of a charging capacitor in an RC circuit, where the voltage asymptotically approaches its maximum value.\n\n**Key Features and Technical Details:**\n- The curve starts at the origin (0,0), indicating that Vout is zero at t=0.\n- As time progresses, the curve rises sharply initially and then gradually flattens out as it approaches the voltage level VDD - VTH, indicating saturation.\n- The curve does not reach VDD entirely, due to the threshold voltage VTH of the transistor.\n\n**Annotations and Specific Data Points:**\n- A step input Vin = VDD is applied at the beginning of the time axis, which is reflected in the waveform.\n- The graph does not provide specific numerical values for VDD or VTH, but the trend and behavior are clearly illustrated.\n\nThis graph provides insight into the transient response of the NMOS sampler circuit when a step voltage VDD is applied, showing how Vout evolves over time until it stabilizes at VDD - VTH.\n\nFigure 13.12 Maximum output level in an NMOS sampler.\n\nIn the circuit of Fig. 13.10(b), we assumed that Vin=+1V (Fig. 13.12). Now suppose Vin=VDD. How does Vout vary with time? Since the gate and drain of M1 are at the same potential, the transistor is saturated, and we have:\n\nCH * dVout/dt = ID1\n              = (1/2) * n * Cox * (W/L) * (VDD-Vout-VTH)^2\n\nwhere channel-length modulation is neglected. It follows that:\n\ndVout / (VDD-Vout-VTH)^2 = (1/2) * n * Cox / CH * (W/L) * dt\n\nand hence:\n\n[1/(VDD-Vout-VTH)]|_0^Vout = (1/2) * n * Cox / CH * (W/L) * t|_0^t\n\nwhere body effect is neglected and Vout(t=0) is assumed zero. Thus:\n\nVout = VDD-VTH - 1 / [(1/2) * n * Cox / CH * (W/L) * t + 1/(VDD-VTH)]\n\nEquation (13.21) implies that as t  , Vout  VDD-VTH. This is because as Vout approaches VDD-VTH, the overdrive voltage of M1 vanishes, reducing the current available for charging CH to negligible values. Of course, even for Vout=VDD-VTH, the transistor conducts some subthreshold current and, given enough time, eventually brings Vout to VDD. Nonetheless, as mentioned in Chapter 3, for typical operation speeds, it is reasonable to assume that Vout does not exceed VDD-VTH.\n\nThe analysis presented demonstrates a significant limitation of MOS switches: if the input signal level is close to VDD, then the output provided by an NMOS switch cannot track the input. From another point of view, the on-resistance of the switch increases considerably as the input and output voltages approach VDD-VTH. We may then ask: What is the maximum input level that the switch can pass to the output reliably? In Fig. 13.12, for Vout  Vin, the transistor must operate in the deep triode region, and hence the upper bound of Vin equals VDD-VTH. As explained later, in practice, Vin must be quite lower than this value.\n\n#### Example 13.3\n\nIn the circuit of Fig. 13.13, calculate the minimum and maximum on-resistance of M1. Assume that n * Cox = 50 A/V^2, W/L=10/1, VTH=0.7V, VDD=3V, and =0.\n\nimage_name:f_{in} = 10 MHz\ndescription:The graph depicted is a time-domain waveform representing the input and output voltages of a circuit involving a transistor M1 and a capacitor CH. The input signal, labeled f_{in} = 10 MHz, is shown on the left side of the diagram. It is a sinusoidal waveform with a frequency of 10 MHz and an amplitude of 0.5 V. The horizontal axis represents time t, and the vertical axis represents voltage in volts.\n\nThe output signal, Vout, is displayed on the right side of the diagram. It mirrors the input waveform, indicating that Vout tracks Vin closely. This correspondence suggests that the transistor M1 is operating in a region where it allows the output to follow the input with minimal phase shift or amplitude distortion.\n\nThe circuit schematic in the center shows a transistor M1 connected to a 3 V supply and a 1 pF capacitor CH. The gate of the transistor is driven by the input voltage, and the source is connected to the output node Vout. The configuration suggests that M1 is acting as a pass transistor, allowing the input signal to pass through to the output while the capacitor CH likely serves to stabilize or filter the output signal.\n\nOverall, the graph indicates that the design achieves a high-fidelity transmission of the input signal to the output, appropriate for the given frequency and amplitude, and confirms the transistor's operation in the desired region, as described in the context.\n\nimage_name:Figure 13.13\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout, D: Vin, G: 3V}\nname: CH, type: Capacitor, value: 1 pF, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit consists of an NMOS transistor M1 and a capacitor CH. The NMOS operates in the triode region to allow Vout to track Vin with a negligible phase shift. The input frequency is 10 MHz, and the input and output signals have a peak of +0.5 V.\n\nimage_name:\ndescription:The diagram consists of a circuit schematic and two time-domain waveforms. The circuit features a MOSFET labeled as M1, with its gate connected to a +3 V supply, and its source connected to the output voltage, V_out. A capacitor, C_H, with a capacitance of 1 pF, is connected to V_out and grounded.\n\nOn either side of the circuit, there are two identical sinusoidal waveforms representing input and output voltages over time. Both waveforms have an amplitude of +0.5 V and a frequency of 10 MHz, as indicated by the label 'f_in = 10 MHz'. The waveforms are plotted against time (t) on the horizontal axis. The vertical axis represents voltage, although it is not explicitly labeled.\n\nThe waveforms suggest that the input and output signals are sinusoidal with no visible phase shift, indicating that V_out closely tracks V_in. This behavior is consistent with the operation of M1 in the triode region, where the on-resistance is low, allowing the output to follow the input with minimal distortion or delay.\n\n#### Solution\n\nWe note that in the steady state, M1 remains in the triode region because the gate voltage is higher than both Vin and Vout by a value greater than VTH. If fin=10 MHz, we predict that Vout tracks Vin with a negligible phase shift due to the on-resistance of M1 and CH. Assuming that Vout  Vin, we need not distinguish between the source and drain terminals, obtaining:\n\nRon1 = 1 / (n * Cox * (W/L) * (VDD-Vin-VTH))\n\nThus, Ron1,max  1.11 k and Ron1,min  870 . By contrast, if the maximum input level is raised to 1.5 V, then Ron1,max = 2.5 k.\n\nMOS devices operating in the deep triode region are sometimes called \"zero-offset\" switches to emphasize that they exhibit no dc shift between the input and output voltages of the simple sampling circuit of Fig. 13.9(b). This is evident from the examples of Fig. 13.10, where the output eventually becomes equal to the input. Nonexistent in bipolar technology, the zero-offset property proves crucial in precise sampling of analog signals.\n\nWe have thus far considered only NMOS switches. The reader can verify that the foregoing principles apply to PMOS switches as well. In particular, as shown in Fig. 13.14, a PMOS transistor fails to operate as a switch if its gate is grounded and its drain terminal senses an input voltage of |VTHP| or less. In other words, the on-resistance of the device rises rapidly as the input and output levels drop to |VTHP| above ground.\n\nimage_name:Figure 13.14 Sampling circuit using PMOS switch\ndescription:\n[\nname: M1, type: PMOS, ports: {S: Vout, D: Vin, G: CK}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit is a sampling circuit using a PMOS switch. The PMOS transistor M1 is controlled by the clock signal CK. When CK is low, M1 is on, allowing the capacitor CH to charge to VDD. The output voltage Vout decreases over time as the capacitor discharges. The diagram also shows the timing diagram for CK and Vout, illustrating the switching behavior and the effect on Vout.\n\nimage_name:Figure 13.14 Sampling circuit using PMOS switch.\ndescription:The graph in Figure 13.14 is a time-domain waveform illustrating the definition of speed in a sampling circuit. It consists of two waveforms plotted against time (t), with the x-axis labeled as time (t) and no specific units provided. The y-axis represents voltage levels, with two distinct traces: one for the clock (CK) signal and one for the output voltage (V_out).\n\n1. **Clock Signal (CK):**\n- The CK signal is shown as a step waveform. It starts at a high voltage level, labeled as V_DD, and then abruptly transitions to a low voltage level (ground, 0). This transition represents the activation of the sampling process.\n\n2. **Output Voltage (V_out):**\n- The V_out waveform begins at the same high voltage level, V_DD, and exhibits an exponential decay towards a lower voltage level. This decay continues until it approaches a threshold voltage level, labeled as |V_THP|, indicating the point where the PMOS switch fails to effectively conduct.\n\n3. **Overall Behavior and Trends:**\n- The graph illustrates the time it takes for the output voltage to transition from the initial high level (V_DD) to the threshold level (|V_THP|). This transition time is a measure of the speed of the sampling circuit.\n- The exponential nature of the decay in V_out suggests the presence of capacitive discharge, likely influenced by the parasitic capacitance in the circuit.\n\n4. **Key Features and Technical Details:**\n- The critical transition in the CK signal is marked by a sharp drop from V_DD to 0, indicating the moment when the sampling begins.\n- The V_out decay curve is smooth and exponential, highlighting the gradual discharge process.\n- The threshold level |V_THP| is crucial as it marks the limit below which the PMOS switch's resistance becomes too high for effective operation.\n\n5. **Annotations and Specific Data Points:**\n- The graph does not provide specific numerical values for time or voltage, but the labels V_DD and |V_THP| serve as reference points for understanding the voltage levels involved in the circuit's operation."
},
{
    "text": "What dictates the speed of the sampling circuits in Fig. 13.9? Initially, we need to clarify what we mean by speed here. As depicted in Fig. 13.15, a straightforward measure of speed is the time it takes for the output voltage to transition\n\nimage_name:Figure 13.15 Definition of speed in a sampling circuit\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout, D: Vin, G: CK}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit is a sampling circuit employing an NMOS switch (M1) controlled by the clock (CK). The capacitor (CH) holds the sampled voltage. The graph illustrates the speed of the sampling circuit, showing how the output voltage (Vout) approaches the input voltage (Vin0) over time, settling within a specified error band (V) after a time period (tS).\nimage_name:Figure 13.15 Definition of speed in a sampling circuit\ndescription:The graph in Figure 13.15 is a time-domain waveform that defines the speed in a sampling circuit. The horizontal axis denotes time (t), while the vertical axis represents the output voltage (V_out). The graph shows the evolution of the output voltage over time following the activation of the circuit's switch.\n\nAxes and Units:\n- **Horizontal Axis (Time, t):** No specific units are indicated, but it represents the progression of time.\n- **Vertical Axis (Voltage, V_out):** Indicates the output voltage level, with reference points marked as V_DD and V_in0.\n\nOverall Behavior and Trends:\n- The waveform initiates at zero when time is zero, signifying that the output voltage V_out starts at ground level.\n- Upon switch activation, V_out begins to ascend towards the input voltage level, V_in0.\n- The curve exhibits an exponential rise, starting steeply and gradually flattening as it nears V_in0.\n- V_out does not reach V_in0 instantaneously but requires time to stabilize within a defined error band, V.\n\nKey Features and Technical Details:\n- The rise of V_out is characterized by a settling time, t_S, which is the duration for V_out to reach within a certain percentage (e.g., 0.1%) of the final value V_in0.\n- V denotes the error band around the final value V_in0, indicating the range within which V_out is deemed stable.\n- The waveform approaches V_in0 asymptotically rather than reaching it exactly.\n\nAnnotations and Specific Data Points:\n- V_DD is marked on the vertical axis as a reference for the maximum voltage level.\n- V_in0 is identified as the target level for V_out.\n- The settling time t_S is indicated on the time axis, showing the point where V_out is within V of V_in0.\n\nThis graph effectively demonstrates the concept of speed in a sampling circuit by illustrating how rapidly the output voltage can stabilize to the input voltage level post-switch activation, within an acceptable error margin.\n\nFigure 13.15 Definition of speed in a sampling circuit.\nfrom zero to the maximum input level once the switch is activated. Since $V_{\\text {out }}$ would theoretically take an infinite amount of time to equal $V_{i n 0}$, we consider the output stable when it falls within a specific \"error band,\" $\\Delta V$, around the final value. For instance, we might state that the output stabilizes to $0.1 \\%$ accuracy after $t_{S}$ seconds, meaning that in Fig. 13.15, $\\Delta V / V_{i n 0}=0.1 \\%$. Consequently, the speed specification must be accompanied by an accuracy specification. Note that beyond $t=t_{S}$, we can approximate the source and drain voltages as roughly equal.\n\nFrom the circuit depicted in Fig. 13.15, we infer that the sampling speed is influenced by two primary factors: the on-resistance of the switch and the value of the sampling capacitor. Thus, to enhance speed, a large aspect ratio and a smaller capacitor are necessary. However, as shown in Fig. 13.13, the on-resistance also depends on the input level, resulting in a larger time constant for more positive inputs (in the case of NMOS switches). From Eq. (13.22), we plot the on-resistance of the switch as a function of the input level [Fig. 13.16(a)], noting the sharp increase as $V_{i n}$ approaches $V_{D D}-V_{T H}$. For example, if we limit the variation of $R_{o n}$ to a range of 4 to 1, then the maximum input level is determined by\n\n$$\n\\begin{equation*}\n\\frac{1}{\\mu_{n} C_{o x} \\frac{W}{L}\\left(V_{D D}-V_{i n, \\max }-V_{T H}\\right)}=\\frac{4}{\\mu_{n} C_{o x} \\frac{W}{L}\\left(V_{D D}-V_{T H}\\right)} \\tag{13.23}\n\\end{equation*}\n$$\n\nWhich translates to\n\n$$\n\\begin{equation*}\nV_{i n, \\max }=\\frac{3}{4}\\left(V_{D D}-V_{T H}\\right) \\tag{13.24}\n\\end{equation*}\n$$\n\nThis value is approximately $V_{D D} / 2$, imposing severe limitations on voltage swings. Note that the device threshold voltage directly constrains the voltage swings. ${ }^{3}$\nimage_name:(a)\ndescription:The graph labeled \"(a)\" plots the on-resistance \\( R_{on,N} \\) of an NMOS device as a function of the input voltage \\( V_{in} \\). The graph is a line plot with the following details:\n\n1. **Axes Labels and Units:**\n- The horizontal axis represents the input voltage \\( V_{in} \\), with no specific units indicated, assumed to be volts (V).\n- The vertical axis represents the on-resistance \\( R_{on,N} \\), with no specific units marked, assumed to be ohms ().\n\n2. **Overall Behavior and Trends:**\n- The graph exhibits an increasing trend in the on-resistance \\( R_{on,N} \\) as the input voltage \\( V_{in} \\) rises.\n- The curve starts at a relatively low resistance value when \\( V_{in} \\) is near zero and rises steeply as \\( V_{in} \\) approaches \\( V_{DD} - V_{TH} \\).\n\n3. **Key Features and Technical Details:**\n- There is a notable increase in the on-resistance as the input voltage nears the threshold \\( V_{DD} - V_{TH} \\), indicating a steep rise in resistance.\n- The graph approaches asymptotically near \\( V_{DD} - V_{TH} \\), suggesting a sharp increase in resistance beyond this point.\n- A dashed vertical line is marked at \\( V_{DD} - V_{TH} \\), highlighting this critical threshold voltage.\n\n4. **Annotations and Specific Data Points:**\n- The graph includes a dashed vertical line at \\( V_{DD} - V_{TH} \\) on the \\( V_{in} \\) axis, indicating a key threshold value where the behavior of the NMOS on-resistance changes significantly.\n- No specific numerical values or additional annotations are provided on the graph.\nimage_name:(b)\ndescription:The graph labeled (b) plots the on-resistance \\( R_{on,P} \\) of a PMOS device as a function of the input voltage \\( V_{in} \\).\n\n1. **Type of Graph and Function:**\n- This is a line graph depicting the relationship between the on-resistance of a PMOS transistor and its input voltage.\n\n2. **Axes Labels and Units:**\n- The horizontal axis represents the input voltage \\( V_{in} \\), starting from 0, with units in volts, though not explicitly marked.\n- The vertical axis represents the on-resistance \\( R_{on,P} \\) of the PMOS device, with units in ohms, though not explicitly marked.\n\n3. **Overall Behavior and Trends:**\n- The graph shows a decreasing trend in the on-resistance as the input voltage increases.\n- Initially, when \\( V_{in} \\) is around 0, the on-resistance is high.\n- As \\( V_{in} \\) increases, \\( R_{on,P} \\) decreases rapidly.\n- The curve appears to approach an asymptote, indicating that the resistance levels off at higher input voltages.\n\n4. **Key Features and Technical Details:**\n- A significant point on the graph is marked at \\( |V_{THP}| \\), which is the threshold voltage for the PMOS device.\n- The on-resistance decreases significantly once the input voltage exceeds \\( |V_{THP}| \\).\n\n5. **Annotations and Specific Data Points:**\n- A dashed vertical line at \\( |V_{THP}| \\) indicates the threshold voltage, a critical point where the device behavior changes notably.\n- No specific numerical values are provided for \\( R_{on,P} \\) or \\( V_{in} \\), other than the threshold voltage marker.\n\nFigure 13.16 On-resistance of (a) NMOS and (b) PMOS devices as a function of input voltage.\n\nTo accommodate larger voltage swings in a sampling circuit, we first note that a PMOS switch exhibits an on-resistance that decreases as the input voltage becomes more positive [Fig. 13.16(b)]. It is then logical to use \"complementary\" switches to allow rail-to-tail swings. As shown in Fig. 13.17(a), such a configuration requires complementary clocks, resulting in an equivalent resistance:\n\n$$\n\\begin{aligned}\nR_{o n, e q} & =R_{o n, N} \\| R_{o n, P} \\\\\n& =\\frac{1}{\\mu_{n} C_{o x}(W / L)_{N}\\left(V_{D D}-V_{i n}-V_{T H N}\\right)} \\| \\frac{1}{\\mu_{p} C_{o x}(W / L)_{P}\\left(V_{i n}-\\left|V_{T H P}\\right|\\right)}\n\\end{aligned}\n$$\n\nThis leads to\n\n$$\n\\begin{aligned}\n& R_{o n, e q}= \\\\\n& \\frac{1}{\\mu_{n} C_{o x}(W / L)_{N}\\left(V_{D D}-V_{T H N}\\right)-\\left[\\mu_{n} C_{o x}(W / L)_{N}-\\mu_{p} C_{o x}(W / L)_{P}\\right] V_{i n}-\\mu_{p} C_{o x}(W / L)_{P}\\left|V_{T H P}\\right|}\n\\end{aligned}\n$$\n\nimage_name:Figure 13.17 (a)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vin, D: Vout, G: CK}\nname: M2, type: PMOS, ports: {S: Vout, D: Vin, G: CK_bar}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit diagram shows a complementary switch configuration with NMOS and PMOS transistors controlled by clock signals 'CK' and 'CK_bar', respectively. The output is taken across the capacitor CH connected to Vout and ground.\n\nimage_name:Figure 13.17 (b)\ndescription:The graph in Figure 13.17(b) plots the on-resistance of a complementary switch as a function of the input voltage \\( V_{in} \\). The x-axis represents the input voltage \\( V_{in} \\) and is marked with two significant points: \\( |V_{THP}| \\) and \\( V_{DD} - V_{TH} \\). The y-axis represents the on-resistance, though it is not labeled with specific units.\n\nThe graph displays three curves:\n\n1. **\\( R_{on,P} \\)**: This curve represents the on-resistance of the PMOS transistor. It starts at a higher resistance when \\( V_{in} \\) is less than \\( |V_{THP}| \\) and decreases as \\( V_{in} \\) increases, approaching zero as \\( V_{in} \\) nears \\( V_{DD} - V_{TH} \\).\n\n2. **\\( R_{on,N} \\)**: This curve shows the on-resistance of the NMOS transistor. It begins at a lower resistance when \\( V_{in} \\) is greater than \\( V_{DD} - V_{TH} \\) and increases as \\( V_{in} \\) decreases, moving towards \\( |V_{THP}| \\).\n\n3. **\\( R_{on,eq} \\)**: This is the equivalent on-resistance of the complementary switch, combining the NMOS and PMOS resistances. The curve for \\( R_{on,eq} \\) is relatively flat compared to the individual resistances, indicating less variation across the range of \\( V_{in} \\).\n\nThe overall behavior shows that while \\( R_{on,P} \\) and \\( R_{on,N} \\) vary significantly with \\( V_{in} \\), their combination \\( R_{on,eq} \\) remains more stable, demonstrating the advantage of using a complementary switch configuration to minimize resistance variation with input voltage.\n\nFigure 13.17 (a) Complementary switch; (b) on-resistance of the complementary switch.\nInterestingly, if $\\mu_{n} C_{o x}(W / L)_{N}=\\mu_{p} C_{o x}(W / L)_{P}$, then $R_{o n, e q}$ is independent of the input level. ${ }^{4}$ Figure 13.17(b) plots the behavior of $R_{o n, e q}$ in the general case, showing much less variation than that of each individual switch. We discuss the impact of switch nonlinearity in Chapter 14.\n\nFor high-speed input signals, it is crucial that the NMOS and PMOS switches in Fig. 13.17(a) turn off simultaneously to avoid ambiguity in the sampled value. If, for instance, the NMOS device turns off $\\Delta t$ seconds before the PMOS device, the output voltage tends to follow the input for the remaining $\\Delta t$ seconds, but with a large, input-dependent time constant (Fig. 13.18). This effect leads to distortion in the sampled value. For moderate precision, the simple circuit shown in Fig. 13.19 provides complementary clocks by duplicating the delay of inverter $I_{1}$ through the pass gate $G_{2}$.\n```"
},
{
    "text": "What dictates the speed of the sampling circuits in Fig. 13.9? First, we need to clarify what we mean by speed here. As depicted in Fig. 13.15, a straightforward measure of speed is the time it takes for the output voltage to transition\n\nimage_name:Figure 13.15 Definition of speed in a sampling circuit\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout, D: Vin, G: CK}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit is a sampling circuit employing an NMOS switch (M1) controlled by the clock (CK). The capacitor (CH) holds the sampled voltage. The graph demonstrates the speed of the sampling circuit, showing how the output voltage (Vout) approaches the input voltage (Vin0) over time, stabilizing within a specified error band (V) after a certain time period (tS).\nimage_name:Figure 13.15 Definition of speed in a sampling circuit\ndescription:The graph in Figure 13.15 is a time-domain waveform that illustrates the definition of speed in a sampling circuit. The horizontal axis denotes time (t), while the vertical axis represents the output voltage (V_out). The graph shows how the output voltage evolves over time following the activation of the circuit switch.\n\nAxes and Units:\n- **Horizontal Axis (Time, t):** No specific units are given, but it represents the progression of time.\n- **Vertical Axis (Voltage, V_out):** Indicates the output voltage level, with reference points marked as V_DD and V_in0.\n\nOverall Behavior and Trends:\n- The waveform starts at zero when time is zero, indicating that the output voltage V_out initially is at ground level.\n- Upon switch activation, V_out starts to rise towards the input voltage level, V_in0.\n- The curve exhibits an exponential rise, starting steeply and gradually flattening as it nears V_in0.\n- V_out does not reach V_in0 instantaneously but requires time to stabilize within a specified error band, V.\n\nKey Features and Technical Details:\n- The rise of V_out is characterized by a settling time, t_S, which is the time needed for V_out to reach within a certain percentage (e.g., 0.1%) of the final value V_in0.\n- V denotes the error band around the final value V_in0, indicating the range within which V_out is considered stable.\n- The waveform asymptotically approaches V_in0 without reaching it exactly.\n\nAnnotations and Specific Data Points:\n- V_DD is marked on the vertical axis as a reference for the maximum voltage level.\n- V_in0 is indicated as the target level for V_out.\n- The settling time t_S is noted on the time axis, showing the point where V_out is within V of V_in0.\n\nThis graph effectively illustrates the concept of speed in a sampling circuit by depicting how quickly the output voltage can stabilize to the input voltage level after switch activation, within an acceptable error margin.\n\nFigure 13.15 Definition of speed in a sampling circuit.\nfrom zero to the maximum input level following switch activation. Since $V_{\\text {out }}$ would theoretically take infinite time to equal $V_{i n 0}$, we consider the output stable when it falls within a specific \"error band,\" $\\Delta V$, around the final value. For instance, we might say the output stabilizes to $0.1 \\%$ accuracy after $t_{S}$ seconds, meaning in Fig. 13.15, $\\Delta V / V_{i n 0}=0.1 \\%$. Thus, the speed specification must also include an accuracy specification. Note that post $t=t_{S}$, the source and drain voltages can be regarded as approximately equal.\n\nFrom the circuit in Fig. 13.15, we infer that the sampling speed is influenced by two factors: the on-resistance of the switch and the value of the sampling capacitor. Therefore, to enhance speed, a large aspect ratio and a smaller capacitor are necessary. However, as shown in Fig. 13.13, the on-resistance also depends on the input level, resulting in a greater time constant for more positive inputs (in the case of NMOS switches). From Eq. (13.22), we plot the on-resistance of the switch as a function of the input level [Fig. 13.16(a)], noting the sharp increase as $V_{i n}$ approaches $V_{D D}-V_{T H}$. For example, if we limit the variation of $R_{o n}$ to a range of 4 to 1, then the maximum input level is given by\n\n$$\n\\begin{equation*}\n\\frac{1}{\\mu_{n} C_{o x} \\frac{W}{L}\\left(V_{D D}-V_{i n, \\max }-V_{T H}\\right)}=\\frac{4}{\\mu_{n} C_{o x} \\frac{W}{L}\\left(V_{D D}-V_{T H}\\right)} \\tag{13.23}\n\\end{equation*}\n$$\n\nWhich translates to\n\n$$\n\\begin{equation*}\nV_{i n, \\max }=\\frac{3}{4}\\left(V_{D D}-V_{T H}\\right) \\tag{13.24}\n\\end{equation*}\n$$\n\nThis value is approximately $V_{D D} / 2$, leading to significant swing limitations. Note that the device threshold voltage directly constrains the voltage swings. ${ }^{3}$\nimage_name:(a)\ndescription:The graph labeled \"(a)\" plots the on-resistance \\( R_{on,N} \\) of an NMOS device against the input voltage \\( V_{in} \\). The graph is a line plot with the following details:\n\n1. **Axes Labels and Units:**\n- The horizontal axis represents the input voltage \\( V_{in} \\), with no specific units indicated, assumed to be volts (V).\n- The vertical axis represents the on-resistance \\( R_{on,N} \\), with no specific units marked, assumed to be ohms ().\n\n2. **Overall Behavior and Trends:**\n- The graph shows an increasing trend in the on-resistance \\( R_{on,N} \\) as the input voltage \\( V_{in} \\) rises.\n- The curve starts at a relatively low resistance value when \\( V_{in} \\) is near zero and rises steeply as \\( V_{in} \\) approaches \\( V_{DD} - V_{TH} \\).\n\n3. **Key Features and Technical Details:**\n- There is a notable increase in the on-resistance as the input voltage nears the threshold \\( V_{DD} - V_{TH} \\), indicating a steep rise in resistance.\n- The graph is asymptotic near \\( V_{DD} - V_{TH} \\), suggesting a sharp increase in resistance beyond this point.\n- A dashed vertical line is marked at \\( V_{DD} - V_{TH} \\), highlighting this critical threshold voltage.\n\n4. **Annotations and Specific Data Points:**\n- The graph includes a dashed vertical line at \\( V_{DD} - V_{TH} \\) on the \\( V_{in} \\) axis, indicating a key threshold value where the behavior of the NMOS on-resistance changes significantly.\n- No specific numerical values or additional annotations are provided on the graph.\nimage_name:(b)\ndescription:The graph labeled (b) plots the on-resistance \\( R_{on,P} \\) of a PMOS device as a function of the input voltage \\( V_{in} \\).\n\n1. **Type of Graph and Function:**\n- This is a line graph depicting the relationship between the on-resistance of a PMOS transistor and its input voltage.\n\n2. **Axes Labels and Units:**\n- The horizontal axis represents the input voltage \\( V_{in} \\), with the scale starting from 0. The units are in volts, though not explicitly marked.\n- The vertical axis represents the on-resistance \\( R_{on,P} \\) of the PMOS device. The units are in ohms, though not explicitly indicated.\n\n3. **Overall Behavior and Trends:**\n- The graph shows a decreasing trend in the on-resistance as the input voltage increases.\n- Initially, when \\( V_{in} \\) is around 0, the on-resistance is high.\n- As \\( V_{in} \\) increases, \\( R_{on,P} \\) decreases rapidly.\n- The curve appears to approach an asymptote, indicating that the resistance levels off at higher input voltages.\n\n4. **Key Features and Technical Details:**\n- A significant point on the graph is marked at \\( |V_{THP}| \\), which is the threshold voltage for the PMOS device.\n- The on-resistance decreases significantly once the input voltage exceeds \\( |V_{THP}| \\).\n\n5. **Annotations and Specific Data Points:**\n- The dashed vertical line at \\( |V_{THP}| \\) indicates the threshold voltage, a critical point where the behavior of the device changes notably.\n- No specific numerical values are provided for \\( R_{on,P} \\) or \\( V_{in} \\), other than the threshold voltage marker.\n\nFigure 13.16 On-resistance of (a) NMOS and (b) PMOS devices as a function of input voltage.\n\nTo allow for larger voltage swings in a sampling circuit, we first note that a PMOS switch exhibits an on-resistance that decreases as the input voltage becomes more positive [Fig. 13.16(b)]. It is then logical to use \"complementary\" switches to enable rail-to-tail swings. As shown in Fig. 13.17(a), such a configuration requires complementary clocks, resulting in an equivalent resistance:\n\n$$\n\\begin{aligned}\nR_{o n, e q} & =R_{o n, N} \\| R_{o n, P} \\\\\n& =\\frac{1}{\\mu_{n} C_{o x}(W / L)_{N}\\left(V_{D D}-V_{i n}-V_{T H N}\\right)} \\| \\frac{1}{\\mu_{p} C_{o x}(W / L)_{P}\\left(V_{i n}-\\left|V_{T H P}\\right|\\right)}\n\\end{aligned}\n$$\n\nLeading to\n\n$$\n\\begin{aligned}\n& R_{o n, e q}= \\\\\n& \\frac{1}{\\mu_{n} C_{o x}(W / L)_{N}\\left(V_{D D}-V_{T H N}\\right)-\\left[\\mu_{n} C_{o x}(W / L)_{N}-\\mu_{p} C_{o x}(W / L)_{P}\\right] V_{i n}-\\mu_{p} C_{o x}(W / L)_{P}\\left|V_{T H P}\\right|}\n\\end{aligned}\n$$\n\nimage_name:Figure 13.17 (a)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vin, D: Vout, G: CK}\nname: M2, type: PMOS, ports: {S: Vout, D: Vin, G: CK_bar}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit diagram shows a complementary switch with NMOS and PMOS transistors controlled by a clock signal 'CK'. The output is taken across the capacitor CH connected to Vout and ground.\n\nimage_name:Figure 13.17 (b)\ndescription:The graph in Figure 13.17(b) plots the on-resistance of a complementary switch as a function of the input voltage \\( V_{in} \\). The x-axis represents the input voltage \\( V_{in} \\) and is marked with two significant points: \\( |V_{THP}| \\) and \\( V_{DD} - V_{TH} \\). The y-axis represents the on-resistance, though it is not labeled with specific units.\n\nThe graph displays three curves:\n\n1. **\\( R_{on,P} \\)**: This curve represents the on-resistance of the PMOS transistor. It starts at a higher resistance when \\( V_{in} \\) is less than \\( |V_{THP}| \\) and decreases as \\( V_{in} \\) increases, approaching zero as \\( V_{in} \\) nears \\( V_{DD} - V_{TH} \\).\n\n2. **\\( R_{on,N} \\)**: This curve shows the on-resistance of the NMOS transistor. It begins at a lower resistance when \\( V_{in} \\) is greater than \\( V_{DD} - V_{TH} \\) and increases as \\( V_{in} \\) decreases, moving towards \\( |V_{THP}| \\).\n\n3. **\\( R_{on,eq} \\)**: This is the equivalent on-resistance of the complementary switch, which is a combination of the NMOS and PMOS resistances. The curve for \\( R_{on,eq} \\) is relatively flat compared to the individual resistances, indicating less variation across the range of \\( V_{in} \\).\n\nThe overall behavior shows that while \\( R_{on,P} \\) and \\( R_{on,N} \\) vary significantly with \\( V_{in} \\), their combination \\( R_{on,eq} \\) remains more stable, demonstrating the advantage of using a complementary switch configuration to minimize resistance variation with input voltage.\n\nFigure 13.17 (a) Complementary switch; (b) on-resistance of the complementary switch.\nInterestingly, if $\\mu_{n} C_{o x}(W / L)_{N}=\\mu_{p} C_{o x}(W / L)_{P}$, then $R_{o n, e q}$ is independent of the input level. ${ }^{4}$ Figure 13.17(b) plots the behavior of $R_{o n, e q}$ in the general case, revealing much less variation than that corresponding to each switch alone. We discuss the impact of switch nonlinearity in Chapter 14.\n\nFor high-speed input signals, it is crucial that the NMOS and PMOS switches in Fig. 13.17(a) turn off simultaneously to avoid ambiguity in the sampled value. If, for instance, the NMOS device turns off $\\Delta t$ seconds before the PMOS device, the output voltage tends to follow the input for the remaining $\\Delta t$ seconds, but with a large, input-dependent time constant (Fig. 13.18). This effect leads to distortion in the sampled value. For moderate precision, the simple circuit shown in Fig. 13.19 provides complementary clocks by duplicating the delay of inverter $I_{1}$ through the pass gate $G_{2}$.\n```"
},
{
    "text": "What factors influence the speed of the sampling circuits depicted in Fig. 13.9? Initially, we need to clarify what we mean by speed in this context. As illustrated in Fig. 13.15, a straightforward measure of speed is the time it takes for the output voltage to transition from zero to the maximum input level once the switch is activated. The circuit shown in Fig. 13.15 is a sampling circuit that employs an NMOS switch (M1) controlled by a clock signal (CK), with a capacitor (CH) storing the sampled voltage. The graph in Fig. 13.15 demonstrates the speed of the sampling circuit by depicting how the output voltage (Vout) approaches the input voltage (Vin0) over time, settling within a specified error band (V) after a certain time period (tS).\n\nThe graph in Fig. 13.15 is a time-domain waveform that defines the speed of a sampling circuit. The horizontal axis represents time (t), while the vertical axis represents the output voltage (V_out). It illustrates the changes in output voltage over time following the activation of the circuit switch.\n\nAxes and Units:\n- **Horizontal Axis (Time, t):** No specific units are provided, but it is understood to represent the progression of time.\n- **Vertical Axis (Voltage, V_out):** Represents the output voltage level, with reference points labeled as V_DD and V_in0.\n\nOverall Behavior and Trends:\n- The waveform initiates at zero when time is zero, indicating that the output voltage V_out starts at ground level.\n- Upon switch activation, V_out begins to rise towards the input voltage level, V_in0.\n- The curve exhibits an exponential rise, starting steeply and gradually leveling off as it approaches V_in0.\n- The output voltage does not reach V_in0 instantaneously but requires time to settle within a specified error band, V.\n\nKey Features and Technical Details:\n- The rise of V_out is characterized by a settling time, t_S, which is the time required for V_out to reach within a certain percentage (e.g., 0.1%) of the final value V_in0.\n- V represents the error band around the final value V_in0, indicating the range within which V_out is considered settled.\n- The waveform approaches V_in0 asymptotically rather than reaching it exactly.\n\nAnnotations and Specific Data Points:\n- V_DD is marked on the vertical axis as a reference for the maximum voltage level.\n- V_in0 is indicated as the target level for V_out.\n- The settling time t_S is marked on the time axis, showing the point where V_out is within V of V_in0.\n\nThis graph effectively illustrates the concept of speed in a sampling circuit by showing how quickly the output voltage can settle to the input voltage level after switch activation, within an acceptable error margin.\n\nIn Fig. 13.15, the speed is defined as the time it takes for the output voltage to go from zero to the maximum input level after the switch turns on. Since V_out would theoretically take infinite time to equal Vin0, we consider the output settled when it falls within a certain \"error band,\" V, around the final value. For instance, we might say the output settles to 0.1% accuracy after t_S seconds, meaning in Fig. 13.15, V/V_in0 = 0.1%. Therefore, the speed specification must be accompanied by an accuracy specification. Note that after t = t_S, the source and drain voltages can be considered approximately equal.\n\nFrom the circuit in Fig. 13.15, we deduce that the sampling speed is determined by two main factors: the on-resistance of the switch and the value of the sampling capacitor. To achieve higher speed, a large aspect ratio and a small capacitor are necessary. However, as shown in Fig. 13.13, the on-resistance also depends on the input level, resulting in a greater time constant for more positive inputs (in the case of NMOS switches). From Eq. (13.22), we plot the on-resistance of the switch as a function of the input level [Fig. 13.16(a)], noting the sharp rise as Vin approaches V_DD - V_TH. For example, if we limit the variation of R_on to a range of 4 to 1, then the maximum input level is given by\n\n$$\n\\begin{equation*}\n\\frac{1}{\\mu_n C_{ox} \\frac{W}{L}(V_{DD} - V_{in, \\max} - V_{TH})} = \\frac{4}{\\mu_n C_{ox} \\frac{W}{L}(V_{DD} - V_{TH})} \\tag{13.23}\n\\end{equation*}\n$$\n\nThus,\n\n$$\n\\begin{equation*}\nV_{in, \\max} = \\frac{3}{4}(V_{DD} - V_{TH}) \\tag{13.24}\n\\end{equation*}\n$$\n\nThis value is approximately V_DD/2, leading to significant swing limitations. Note that the device threshold voltage directly limits the voltage swings.\n\nThe graph labeled \"(a)\" in Fig. 13.16 is a plot of the on-resistance R_on,N of an NMOS device as a function of the input voltage Vin. The graph is a line plot with the following details:\n\n1. **Axes Labels and Units:**\n- The horizontal axis represents the input voltage Vin, with no specific units marked, assuming volts (V).\n- The vertical axis represents the on-resistance R_on,N, with no specific units marked, assuming ohms ().\n\n2. **Overall Behavior and Trends:**\n- The graph shows an increasing trend in the on-resistance R_on,N as the input voltage Vin increases.\n- The curve starts at a relatively low resistance value when Vin is close to zero and rises steeply as Vin approaches V_DD - V_TH.\n\n3. **Key Features and Technical Details:**\n- There is a significant increase in the on-resistance as the input voltage approaches the threshold V_DD - V_TH, indicating a steep rise in resistance.\n- The graph is asymptotic near V_DD - V_TH, suggesting a sharp increase in resistance beyond this point.\n- A dashed vertical line is marked at V_DD - V_TH, highlighting this critical threshold voltage.\n\n4. **Annotations and Specific Data Points:**\n- The graph includes a dashed vertical line at V_DD - V_TH on the Vin axis, indicating a key threshold value where the behavior of the NMOS on-resistance changes significantly.\n- No specific numerical values or additional annotations are provided on the graph.\n\nThe graph labeled (b) in Fig. 13.16 is a plot of the on-resistance R_on,P of a PMOS device as a function of the input voltage Vin.\n\n1. **Type of Graph and Function:**\n- This is a line graph showing the relationship between the on-resistance of a PMOS transistor and its input voltage.\n\n2. **Axes Labels and Units:**\n- The horizontal axis represents the input voltage Vin, with the scale starting from 0. The units are in volts, although not explicitly marked.\n- The vertical axis represents the on-resistance R_on,P of the PMOS device. The units are in ohms, though not explicitly marked.\n\n3. **Overall Behavior and Trends:**\n- The graph shows a decreasing trend of the on-resistance as the input voltage increases.\n- Initially, when Vin is around 0, the on-resistance is high.\n- As Vin increases, R_on,P decreases rapidly.\n- The curve appears to approach an asymptote, indicating that the resistance levels off at higher input voltages.\n\n4. **Key Features and Technical Details:**\n- A significant point on the graph is marked at |V_{THP}|, which is the threshold voltage for the PMOS device.\n- The on-resistance decreases significantly after the input voltage surpasses |V_{THP}|.\n\n5. **Annotations and Specific Data Points:**\n- The dashed vertical line at |V_{THP}| indicates the threshold voltage, a critical point where the behavior of the device changes notably.\n- No specific numerical values are provided for R_on,P or Vin, other than the threshold voltage marker.\n\nFigure 13.16 shows the on-resistance of (a) NMOS and (b) PMOS devices as a function of input voltage.\n\nTo accommodate greater voltage swings in a sampling circuit, we first note that a PMOS switch exhibits an on-resistance that decreases as the input voltage becomes more positive [Fig. 13.16(b)]. It is then feasible to use \"complementary\" switches to allow rail-to-tail swings. As shown in Fig. 13.17(a), such a combination requires complementary clocks, producing an equivalent resistance:\n\n$$\n\\begin{aligned}\nR_{on,eq} & = R_{on,N} \\| R_{on,P} \\\\\n& = \\frac{1}{\\mu_n C_{ox} (W/L)_N (V_{DD} - Vin - V_{THN})} \\| \\frac{1}{\\mu_p C_{ox} (W/L)_P (Vin - |V_{THP}|)}\n\\end{aligned}\n$$\n\nThis leads to\n\n$$\n\\begin{aligned}\nR_{on,eq} & = \\\\\n& \\frac{1}{\\mu_n C_{ox} (W/L)_N (V_{DD} - V_{THN}) - [\\mu_n C_{ox} (W/L)_N - \\mu_p C_{ox} (W/L)_P] Vin - \\mu_p C_{ox} (W/L)_P |V_{THP}|}\n\\end{aligned}\n$$\n\nFigure 13.17(a) depicts a complementary switch circuit with NMOS and PMOS transistors controlled by a clock signal 'CK'. The output is taken across the capacitor CH connected to Vout and ground.\n\nThe graph in Fig. 13.17(b) plots the on-resistance of a complementary switch as a function of the input voltage Vin. The x-axis represents the input voltage Vin and is marked with two significant points: |V_{THP}| and V_{DD} - V_{TH}. The y-axis represents the on-resistance, although it is not labeled with specific units.\n\nThe graph displays three curves:\n\n1. **R_{on,P}**: This curve represents the on-resistance of the PMOS transistor. It starts at a higher resistance when Vin is less than |V_{THP}| and decreases as Vin increases, approaching zero as Vin nears V_{DD} - V_{TH}.\n\n2. **R_{on,N}**: This curve shows the on-resistance of the NMOS transistor. It begins at a lower resistance when Vin is greater than V_{DD} - V_{TH} and increases as Vin decreases, moving towards |V_{THP}|.\n\n3. **R_{on,eq}**: This is the equivalent on-resistance of the complementary switch, which is a combination of the NMOS and PMOS resistances. The curve for R_{on,eq} is relatively flat compared to the individual resistances, indicating less variation across the range of Vin.\n\nThe overall behavior shows that while R_{on,P} and R_{on,N} vary significantly with Vin, their combination R_{on,eq} remains more stable, demonstrating the advantage of using a complementary switch configuration to minimize resistance variation with input voltage.\n\nFigure 13.17(a) shows a complementary switch; (b) plots the on-resistance of the complementary switch.\nInterestingly, if _n C_{ox} (W/L)_N = _p C_{ox} (W/L)_P, then R_{on,eq} is independent of the input level. Figure 13.17(b) plots the behavior of R_{on,eq} in the general case, revealing much less variation than that corresponding to each switch alone. We quantify the effect of switch nonlinearity in Chapter 14.\n\nFor high-speed input signals, it is crucial that the NMOS and PMOS switches in Fig. 13.17(a) turn off simultaneously to avoid ambiguity in the sampled value. If, for instance, the NMOS device turns off t seconds earlier than the PMOS device, the output voltage tends to track the input for the remaining t seconds, but with a large, input-dependent time constant (Fig. 13.18). This effect leads to distortion in the sampled value. For moderate precision, the simple circuit shown in Fig. 13.19 provides complementary clocks by duplicating the delay of inverter I1 through the pass gate G2."
},
{
    "text": "What influences the speed of the sampling circuits shown in Fig. 13.9? To begin, we need to clarify what we mean by speed here. As depicted in Fig. 13.15, a straightforward measure of speed is the time it takes for the output voltage to rise\n\nimage_name:Figure 13.15 Definition of speed in a sampling circuit\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout, D: Vin, G: CK}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit is a sampling circuit utilizing an NMOS switch (M1) controlled by the clock (CK). The capacitor (CH) holds the sampled voltage. The graph illustrates the speed of the sampling circuit, showing how the output voltage (Vout) approaches the input voltage (Vin0) over time, stabilizing within a specified error band (V) after a time period (tS).\nimage_name:Figure 13.15 Definition of speed in a sampling circuit\ndescription:The graph in Figure 13.15 is a time-domain waveform that defines speed in a sampling circuit. The horizontal axis denotes time (t), while the vertical axis represents the output voltage (V_out). The graph shows the evolution of the output voltage over time following the activation of the circuit switch.\n\nAxes and Units:\n- **Horizontal Axis (Time, t):** No specific units are indicated, but it signifies the progression of time.\n- **Vertical Axis (Voltage, V_out):** Indicates the output voltage level, with reference points marked as V_DD and V_in0.\n\nOverall Behavior and Trends:\n- The waveform initiates at zero when time is zero, indicating that the output voltage V_out starts at ground level.\n- Upon switch activation, V_out starts to increase towards the input voltage level, V_in0.\n- The curve exhibits an exponential rise, initially steep and then gradually flattening as it nears V_in0.\n- V_out does not reach V_in0 instantaneously but requires time to stabilize within a specified error band, V.\n\nKey Features and Technical Details:\n- The rise of V_out is characterized by a settling time, t_S, which is the duration for V_out to reach within a certain percentage (e.g., 0.1%) of the final value V_in0.\n- V signifies the error band around the final value V_in0, denoting the range within which V_out is deemed stable.\n- The waveform approaches V_in0 asymptotically rather than reaching it exactly.\n\nAnnotations and Specific Data Points:\n- V_DD is marked on the vertical axis as a reference for the maximum voltage level.\n- V_in0 is identified as the target level for V_out.\n- The settling time t_S is indicated on the time axis, showing the point where V_out is within V of V_in0.\n\nThis graph effectively demonstrates the concept of speed in a sampling circuit by depicting how rapidly the output voltage can stabilize to the input voltage level post-switch activation, within an acceptable error margin.\n\nFigure 13.15 Definition of speed in a sampling circuit.\nfrom zero to the maximum input level once the switch is activated. Since $V_{\\text {out }}$ would theoretically take an infinite amount of time to equal $V_{i n 0}$, we consider the output stable when it falls within a specific \"error band,\" $\\Delta V$, around the final value. For instance, we might say the output stabilizes to $0.1 \\%$ accuracy after $t_{S}$ seconds, meaning that in Fig. 13.15, $\\Delta V / V_{i n 0}=0.1 \\%$. Thus, the speed specification must be paired with an accuracy specification. Note that post $t=t_{S}$, the source and drain voltages can be considered approximately equal.\n\nFrom the circuit in Fig. 13.15, we deduce that the sampling speed is governed by two factors: the on-resistance of the switch and the value of the sampling capacitor. Therefore, to enhance speed, a large aspect ratio and a smaller capacitor are necessary. However, as shown in Fig. 13.13, the on-resistance also varies with the input level, resulting in a larger time constant for more positive inputs (in the case of NMOS switches). From Eq. (13.22), we plot the on-resistance of the switch as a function of the input level [Fig. 13.16(a)], noting the sharp increase as $V_{i n}$ approaches $V_{D D}-V_{T H}$. For example, if we limit the variation of $R_{o n}$ to a range of 4 to 1, then the maximum input level is given by\n\n$$\n\\begin{equation*}\n\\frac{1}{\\mu_{n} C_{o x} \\frac{W}{L}\\left(V_{D D}-V_{i n, \\max }-V_{T H}\\right)}=\\frac{4}{\\mu_{n} C_{o x} \\frac{W}{L}\\left(V_{D D}-V_{T H}\\right)} \\tag{13.23}\n\\end{equation*}\n$$\n\nWhich translates to\n\n$$\n\\begin{equation*}\nV_{i n, \\max }=\\frac{3}{4}\\left(V_{D D}-V_{T H}\\right) \\tag{13.24}\n\\end{equation*}\n$$\n\nThis value is approximately $V_{D D} / 2$, imposing severe limitations on voltage swings. Note that the device threshold voltage directly constrains the voltage swings. ${ }^{3}$\nimage_name:(a)\ndescription:The graph labeled \"(a)\" plots the on-resistance \\( R_{on,N} \\) of an NMOS device as a function of the input voltage \\( V_{in} \\). The graph is a line plot with the following details:\n\n1. **Axes Labels and Units:**\n- The horizontal axis represents the input voltage \\( V_{in} \\), with no specific units indicated, assumed to be volts (V).\n- The vertical axis represents the on-resistance \\( R_{on,N} \\), with no specific units marked, assumed to be ohms ().\n\n2. **Overall Behavior and Trends:**\n- The graph exhibits an increasing trend in the on-resistance \\( R_{on,N} \\) as the input voltage \\( V_{in} \\) rises.\n- The curve starts at a relatively low resistance when \\( V_{in} \\) is near zero and increases steeply as \\( V_{in} \\) approaches \\( V_{DD} - V_{TH} \\).\n\n3. **Key Features and Technical Details:**\n- There is a notable increase in the on-resistance as the input voltage nears the threshold \\( V_{DD} - V_{TH} \\), indicating a steep rise in resistance.\n- The graph is asymptotic near \\( V_{DD} - V_{TH} \\), suggesting a sharp resistance increase beyond this point.\n- A dashed vertical line is marked at \\( V_{DD} - V_{TH} \\), highlighting this critical threshold voltage.\n\n4. **Annotations and Specific Data Points:**\n- The graph includes a dashed vertical line at \\( V_{DD} - V_{TH} \\) on the \\( V_{in} \\) axis, indicating a key threshold where the NMOS on-resistance behavior changes significantly.\n- No specific numerical values or additional annotations are provided on the graph.\nimage_name:(b)\ndescription:The graph labeled (b) plots the on-resistance \\( R_{on,P} \\) of a PMOS device as a function of the input voltage \\( V_{in} \\).\n\n1. **Type of Graph and Function:**\n- This is a line graph showing the relationship between the on-resistance of a PMOS transistor and its input voltage.\n\n2. **Axes Labels and Units:**\n- The horizontal axis represents the input voltage \\( V_{in} \\), starting from 0, with units in volts, though not explicitly marked.\n- The vertical axis represents the on-resistance \\( R_{on,P} \\) of the PMOS device, with units in ohms, though not explicitly marked.\n\n3. **Overall Behavior and Trends:**\n- The graph shows a decreasing trend in the on-resistance as the input voltage increases.\n- Initially, when \\( V_{in} \\) is around 0, the on-resistance is high.\n- As \\( V_{in} \\) increases, \\( R_{on,P} \\) decreases rapidly.\n- The curve approaches an asymptote, indicating that the resistance stabilizes at higher input voltages.\n\n4. **Key Features and Technical Details:**\n- A significant point on the graph is marked at \\( |V_{THP}| \\), which is the threshold voltage for the PMOS device.\n- The on-resistance decreases notably once the input voltage exceeds \\( |V_{THP}| \\).\n\n5. **Annotations and Specific Data Points:**\n- A dashed vertical line at \\( |V_{THP}| \\) indicates the threshold voltage, a critical point where the device behavior changes notably.\n- No specific numerical values are provided for \\( R_{on,P} \\) or \\( V_{in} \\), other than the threshold voltage marker.\n\nFigure 13.16 On-resistance of (a) NMOS and (b) PMOS devices as a function of input voltage.\n\nTo allow for larger voltage swings in a sampling circuit, we first note that a PMOS switch exhibits an on-resistance that decreases as the input voltage becomes more positive [Fig. 13.16(b)]. It is then logical to use \"complementary\" switches to enable rail-to-tail swings. As shown in Fig. 13.17(a), such a configuration requires complementary clocks, resulting in an equivalent resistance:\n\n$$\n\\begin{aligned}\nR_{o n, e q} & =R_{o n, N} \\| R_{o n, P} \\\\\n& =\\frac{1}{\\mu_{n} C_{o x}(W / L)_{N}\\left(V_{D D}-V_{i n}-V_{T H N}\\right)} \\| \\frac{1}{\\mu_{p} C_{o x}(W / L)_{P}\\left(V_{i n}-\\left|V_{T H P}\\right|\\right)}\n\\end{aligned}\n$$\n\nLeading to\n\n$$\n\\begin{aligned}\n& R_{o n, e q}= \\\\\n& \\frac{1}{\\mu_{n} C_{o x}(W / L)_{N}\\left(V_{D D}-V_{T H N}\\right)-\\left[\\mu_{n} C_{o x}(W / L)_{N}-\\mu_{p} C_{o x}(W / L)_{P}\\right] V_{i n}-\\mu_{p} C_{o x}(W / L)_{P}\\left|V_{T H P}\\right|}\n\\end{aligned}\n$$\n\nimage_name:Figure 13.17 (a)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vin, D: Vout, G: CK}\nname: M2, type: PMOS, ports: {S: Vout, D: Vin, G: CK_bar}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit diagram shows a complementary switch with NMOS and PMOS transistors controlled by a clock signal 'CK'. The output is taken across the capacitor CH connected to Vout and ground.\n\nimage_name:Figure 13.17 (b)\ndescription:The graph in Figure 13.17(b) plots the on-resistance of a complementary switch as a function of the input voltage \\( V_{in} \\). The x-axis represents the input voltage \\( V_{in} \\) and is marked with two significant points: \\( |V_{THP}| \\) and \\( V_{DD} - V_{TH} \\). The y-axis represents the on-resistance, though it is not labeled with specific units.\n\nThe graph displays three curves:\n\n1. **\\( R_{on,P} \\)**: This curve represents the on-resistance of the PMOS transistor. It starts at a higher resistance when \\( V_{in} \\) is less than \\( |V_{THP}| \\) and decreases as \\( V_{in} \\) increases, approaching zero as \\( V_{in} \\) nears \\( V_{DD} - V_{TH} \\).\n\n2. **\\( R_{on,N} \\)**: This curve shows the on-resistance of the NMOS transistor. It begins at a lower resistance when \\( V_{in} \\) is greater than \\( V_{DD} - V_{TH} \\) and increases as \\( V_{in} \\) decreases, moving towards \\( |V_{THP}| \\).\n\n3. **\\( R_{on,eq} \\)**: This is the equivalent on-resistance of the complementary switch, combining the NMOS and PMOS resistances. The curve for \\( R_{on,eq} \\) is relatively flat compared to the individual resistances, indicating less variation across the range of \\( V_{in} \\).\n\nThe overall behavior shows that while \\( R_{on,P} \\) and \\( R_{on,N} \\) vary significantly with \\( V_{in} \\), their combination \\( R_{on,eq} \\) remains more stable, demonstrating the advantage of using a complementary switch configuration to minimize resistance variation with input voltage.\n\nFigure 13.17 (a) Complementary switch; (b) on-resistance of the complementary switch.\nInterestingly, if $\\mu_{n} C_{o x}(W / L)_{N}=\\mu_{p} C_{o x}(W / L)_{P}$, then $R_{o n, e q}$ is independent of the input level. ${ }^{4}$ Figure 13.17(b) plots the behavior of $R_{o n, e q}$ in the general case, revealing much less variation than that of each switch alone. We will quantify the impact of switch nonlinearity in Chapter 14.\n\nFor high-speed input signals, it is crucial that the NMOS and PMOS switches in Fig. 13.17(a) turn off simultaneously to avoid ambiguity in the sampled value. If, for instance, the NMOS device turns off $\\Delta t$ seconds before the PMOS device, the output voltage tends to follow the input for the remaining $\\Delta t$ seconds, but with a large, input-dependent time constant (Fig. 13.18). This effect leads to distortion in the sampled value. For moderate precision, the simple circuit shown in Fig. 13.19 provides complementary clocks by duplicating the delay of inverter $I_{1}$ through the pass gate $G_{2}$.\n```"
},
{
    "text": "What factors influence the speed of the sampling circuits shown in Fig. 13.9? Initially, we need to clarify what we mean by speed in this context. As depicted in Fig. 13.15, a straightforward measure of speed is the time it takes for the output voltage to transition from zero to the maximum input level once the switch is activated. The circuit in Fig. 13.15 is a sampling circuit that employs an NMOS switch (M1) controlled by a clock (CK), with a capacitor (CH) storing the sampled voltage. The graph in this figure illustrates the speed of the sampling circuit by showing how the output voltage (Vout) approaches the input voltage (Vin0) over time, settling within a specified error band (V) after a time period (tS).\n\nThe graph in Fig. 13.15 is a time-domain waveform that defines speed in a sampling circuit. The horizontal axis represents time (t), while the vertical axis represents the output voltage (V_out). It shows how the output voltage evolves over time after the circuit's switch is activated.\n\nAxes and Units:\n- **Horizontal Axis (Time, t):** No specific units are provided, but it represents the progression of time.\n- **Vertical Axis (Voltage, V_out):** Represents the output voltage level, with reference points marked as V_DD and V_in0.\n\nOverall Behavior and Trends:\n- The waveform starts at zero when time is zero, indicating that the output voltage V_out initially is at ground level.\n- Upon switch activation, V_out begins to rise towards the input voltage level, V_in0.\n- The curve exhibits an exponential rise, starting steeply and gradually leveling off as it approaches V_in0.\n- The output voltage does not reach V_in0 instantaneously but takes time to settle within a specified error band, V.\n\nKey Features and Technical Details:\n- The rise of V_out is characterized by a settling time, t_S, which is the time required for V_out to reach within a certain percentage (e.g., 0.1%) of the final value V_in0.\n- V represents the error band around the final value V_in0, indicating the range within which V_out is considered settled.\n- The waveform approaches V_in0 asymptotically rather than reaching it exactly.\n\nAnnotations and Specific Data Points:\n- V_DD is marked on the vertical axis as a reference for the maximum voltage level.\n- V_in0 is indicated as the target level for V_out.\n- The settling time t_S is marked on the time axis, showing the point where V_out is within V of V_in0.\n\nThis graph effectively illustrates the concept of speed in a sampling circuit by depicting how quickly the output voltage can settle to the input voltage level after switch activation, within an acceptable error margin.\n\nFigure 13.15 Definition of speed in a sampling circuit.\nSince V_out would theoretically take infinite time to equal Vin0, we consider the output settled when it falls within a specific \"error band,\" V, around the final value. For instance, we might say the output settles to 0.1% accuracy after t_S seconds, meaning in Fig. 13.15, V/V_in0 = 0.1%. Therefore, the speed specification must be accompanied by an accuracy specification. Note that after t = t_S, the source and drain voltages can be considered approximately equal.\n\nFrom the circuit in Fig. 13.15, we deduce that the sampling speed is determined by two factors: the on-resistance of the switch and the value of the sampling capacitor. To achieve higher speed, a large aspect ratio and a small capacitor are necessary. However, as shown in Fig. 13.13, the on-resistance also depends on the input level, resulting in a greater time constant for more positive inputs (in the case of NMOS switches). From Eq. (13.22), we plot the on-resistance of the switch as a function of the input level [Fig. 13.16(a)], noting the sharp rise as Vin approaches V_DD - V_TH. For example, if we limit the variation of R_on to a range of 4 to 1, then the maximum input level is given by\n\n$$\n\\begin{equation*}\n\\frac{1}{\\mu_n C_{ox} \\frac{W}{L}\\left(V_{DD} - V_{in, \\max} - V_{TH}\\right)} = \\frac{4}{\\mu_n C_{ox} \\frac{W}{L}\\left(V_{DD} - V_{TH}\\right)} \\tag{13.23}\n\\end{equation*}\n$$\n\nThus,\n\n$$\n\\begin{equation*}\nV_{in, \\max} = \\frac{3}{4}\\left(V_{DD} - V_{TH}\\right) \\tag{13.24}\n\\end{equation*}\n$$\n\nThis value is approximately V_DD/2, imposing severe limitations on voltage swings. Note that the device threshold voltage directly limits the voltage swings. ${}^{3}$\n\nThe graph labeled \"(a)\" in Fig. 13.16 plots the on-resistance R_on,N of an NMOS device as a function of the input voltage Vin. The graph is a line plot with the following details:\n\n1. **Axes Labels and Units:**\n- The horizontal axis represents the input voltage Vin, with no specific units marked, assumed to be volts (V).\n- The vertical axis represents the on-resistance R_on,N, with no specific units marked, assumed to be ohms ().\n\n2. **Overall Behavior and Trends:**\n- The graph shows an increasing trend in the on-resistance R_on,N as the input voltage Vin increases.\n- The curve starts at a relatively low resistance value when Vin is near zero and rises steeply as Vin approaches V_DD - V_TH.\n\n3. **Key Features and Technical Details:**\n- There is a significant increase in the on-resistance as the input voltage approaches the threshold V_DD - V_TH, indicating a steep rise in resistance.\n- The graph is asymptotic near V_DD - V_TH, suggesting a sharp increase in resistance beyond this point.\n- A dashed vertical line is marked at V_DD - V_TH, highlighting this critical threshold voltage.\n\n4. **Annotations and Specific Data Points:**\n- The graph includes a dashed vertical line at V_DD - V_TH on the Vin axis, indicating a key threshold value where the behavior of the NMOS on-resistance changes significantly.\n- No specific numerical values or additional annotations are provided on the graph.\n\nThe graph labeled (b) in Fig. 13.16 plots the on-resistance R_on,P of a PMOS device as a function of the input voltage Vin.\n\n1. **Type of Graph and Function:**\n- This is a line graph showing the relationship between the on-resistance of a PMOS transistor and its input voltage.\n\n2. **Axes Labels and Units:**\n- The horizontal axis represents the input voltage Vin, with the scale starting from 0. The units are in volts, though not explicitly marked.\n- The vertical axis represents the on-resistance R_on,P of the PMOS device. The units are in ohms, though not explicitly marked.\n\n3. **Overall Behavior and Trends:**\n- The graph shows a decreasing trend in the on-resistance as the input voltage increases.\n- Initially, when Vin is around 0, the on-resistance is high.\n- As Vin increases, R_on,P decreases rapidly.\n- The curve appears to approach an asymptote, indicating that the resistance levels off at higher input voltages.\n\n4. **Key Features and Technical Details:**\n- A significant point on the graph is marked at |V_{THP}|, which is the threshold voltage for the PMOS device.\n- The on-resistance decreases significantly after the input voltage surpasses |V_{THP}|.\n\n5. **Annotations and Specific Data Points:**\n- The dashed vertical line at |V_{THP}| indicates the threshold voltage, a critical point where the behavior of the device changes notably.\n- No specific numerical values are provided for R_on,P or Vin, other than the threshold voltage marker.\n\nFigure 13.16 On-resistance of (a) NMOS and (b) PMOS devices as a function of input voltage.\n\nTo accommodate larger voltage swings in a sampling circuit, we first note that a PMOS switch exhibits an on-resistance that decreases as the input voltage becomes more positive [Fig. 13.16(b)]. It is then feasible to use \"complementary\" switches to allow rail-to-tail swings. As shown in Fig. 13.17(a), such a combination requires complementary clocks, resulting in an equivalent resistance:\n\n$$\n\\begin{aligned}\nR_{on,eq} & = R_{on,N} \\| R_{on,P} \\\\\n& = \\frac{1}{\\mu_n C_{ox} (W/L)_N \\left(V_{DD} - Vin - V_{THN}\\right)} \\| \\frac{1}{\\mu_p C_{ox} (W/L)_P \\left(Vin - |V_{THP}|\\right)}\n\\end{aligned}\n$$\n\nThis leads to\n\n$$\n\\begin{aligned}\nR_{on,eq} & = \\\\\n& \\frac{1}{\\mu_n C_{ox} (W/L)_N \\left(V_{DD} - V_{THN}\\right) - \\left[\\mu_n C_{ox} (W/L)_N - \\mu_p C_{ox} (W/L)_P\\right] Vin - \\mu_p C_{ox} (W/L)_P |V_{THP}|}\n\\end{aligned}\n$$\n\nFigure 13.17(a) illustrates a complementary switch with NMOS and PMOS transistors controlled by a clock signal 'CK'. The output is taken across the capacitor CH connected to Vout and ground.\n\nThe graph in Fig. 13.17(b) plots the on-resistance of a complementary switch as a function of the input voltage Vin. The x-axis represents the input voltage Vin and is marked with two significant points: |V_{THP}| and V_{DD} - V_{TH}. The y-axis represents the on-resistance, though it is not labeled with specific units.\n\nThe graph displays three curves:\n\n1. **R_on,P**: This curve represents the on-resistance of the PMOS transistor. It starts at a higher resistance when Vin is less than |V_{THP}| and decreases as Vin increases, approaching zero as Vin nears V_{DD} - V_{TH}.\n\n2. **R_on,N**: This curve shows the on-resistance of the NMOS transistor. It begins at a lower resistance when Vin is greater than V_{DD} - V_{TH} and increases as Vin decreases, moving towards |V_{THP}|.\n\n3. **R_on,eq**: This is the equivalent on-resistance of the complementary switch, which is a combination of the NMOS and PMOS resistances. The curve for R_on,eq is relatively flat compared to the individual resistances, indicating less variation across the range of Vin.\n\nThe overall behavior shows that while R_on,P and R_on,N vary significantly with Vin, their combination R_on,eq remains more stable, demonstrating the advantage of using a complementary switch configuration to minimize resistance variation with input voltage.\n\nFigure 13.17 (a) Complementary switch; (b) on-resistance of the complementary switch.\nInterestingly, if _n C_{ox} (W/L)_N = _p C_{ox} (W/L)_P, then R_on,eq is independent of the input level. ${}^{4}$ Figure 13.17(b) plots the behavior of R_on,eq in the general case, revealing much less variation than that corresponding to each switch alone. We quantify the effect of switch nonlinearity in Chapter 14.\n\nFor high-speed input signals, it is crucial that the NMOS and PMOS switches in Fig. 13.17(a) turn off simultaneously to avoid ambiguity in the sampled value. If, for instance, the NMOS device turns off t seconds earlier than the PMOS device, the output voltage tends to track the input for the remaining t seconds, but with a large, input-dependent time constant (Fig. 13.18). This effect leads to distortion in the sampled value. For moderate precision, the simple circuit shown in Fig. 13.19 provides complementary clocks by duplicating the delay of inverter I_1 through the pass gate G_2."
},
{
    "text": "What factors influence the speed of the sampling circuits depicted in Fig. 13.9? To address this, we must first clarify what we mean by \"speed.\" As illustrated in Fig. 13.15, a straightforward measure of speed is the time it takes for the output voltage to transition from zero to the maximum input level once the switch is activated. The circuit in Fig. 13.15 is a sampling circuit that employs an NMOS switch (M1) controlled by a clock signal (CK), with a capacitor (CH) storing the sampled voltage. The graph in this figure demonstrates the speed of the sampling circuit by showing how the output voltage (Vout) approaches the input voltage (Vin0) over time, settling within a specified error band (V) after a certain period (tS).\n\nThe graph in Fig. 13.15 is a time-domain waveform that defines speed in a sampling circuit. The horizontal axis represents time (t), while the vertical axis represents the output voltage (V_out). It illustrates how the output voltage changes over time after the circuit's switch is activated.\n\nAxes and Units:\n- **Horizontal Axis (Time, t):** No specific units are provided, but it represents time progression.\n- **Vertical Axis (Voltage, V_out):** Represents the output voltage level, with reference points labeled as V_DD and V_in0.\n\nOverall Behavior and Trends:\n- Initially, at time zero, the waveform starts at zero, indicating that the output voltage V_out is at ground level.\n- Upon switch activation, V_out begins to rise towards the input voltage level, V_in0.\n- The curve exhibits an exponential rise, starting steeply and gradually leveling off as it approaches V_in0.\n- V_out does not reach V_in0 instantaneously but takes time to settle within a specified error band, V.\n\nKey Features and Technical Details:\n- The rise of V_out is marked by a settling time, t_S, which is the time required for V_out to reach within a certain percentage (e.g., 0.1%) of the final value V_in0.\n- V represents the error band around the final value V_in0, indicating the range within which V_out is considered settled.\n- The waveform approaches V_in0 asymptotically rather than reaching it exactly.\n\nAnnotations and Specific Data Points:\n- V_DD is marked on the vertical axis as a reference for the maximum voltage level.\n- V_in0 is indicated as the target level for V_out.\n- The settling time t_S is marked on the time axis, showing the point where V_out is within V of V_in0.\n\nThis graph effectively illustrates the concept of speed in a sampling circuit by showing how quickly the output voltage can settle to the input voltage level after switch activation, within an acceptable error margin.\n\nFigure 13.15 Definition of speed in a sampling circuit.\nfrom zero to the maximum input level after the switch turns on. Since $V_{\\text {out }}$ would take infinite time to become equal to $V_{i n 0}$, we consider the output settled when it is within a certain \"error band,\" $\\Delta V$, around the final value. For instance, we say the output settles to $0.1 \\%$ accuracy after $t_{S}$ seconds, meaning that in Fig. 13.15, $\\Delta V / V_{i n 0}=0.1 \\%$. Thus, the speed specification must be accompanied by an accuracy specification. Note that after $t=t_{S}$, we can consider the source and drain voltages to be approximately equal.\n\nFrom the circuit in Fig. 13.15, we deduce that the sampling speed is determined by two factors: the on-resistance of the switch and the value of the sampling capacitor. To achieve higher speed, a large aspect ratio and a small capacitor are necessary. However, as shown in Fig. 13.13, the on-resistance also depends on the input level, resulting in a greater time constant for more positive inputs (in the case of NMOS switches). From Eq. (13.22), we plot the on-resistance of the switch as a function of the input level [Fig. 13.16(a)], noting the sharp rise as $V_{i n}$ approaches $V_{D D}-V_{T H}$. For example, if we limit the variation of $R_{o n}$ to a range of 4 to 1, then the maximum input level is given by\n\n$$\n\\begin{equation*}\n\\frac{1}{\\mu_{n} C_{o x} \\frac{W}{L}\\left(V_{D D}-V_{i n, \\max }-V_{T H}\\right)}=\\frac{4}{\\mu_{n} C_{o x} \\frac{W}{L}\\left(V_{D D}-V_{T H}\\right)} \\tag{13.23}\n\\end{equation*}\n$$\n\nThat is\n\n$$\n\\begin{equation*}\nV_{i n, \\max }=\\frac{3}{4}\\left(V_{D D}-V_{T H}\\right) \\tag{13.24}\n\\end{equation*}\n$$\n\nThis value is around $V_{D D} / 2$, leading to significant swing limitations. Note that the device threshold voltage directly limits the voltage swings. ${ }^{3}$\n\nThe graph labeled \"(a)\" in Fig. 13.16 is a plot of the on-resistance \\( R_{on,N} \\) of an NMOS device as a function of the input voltage \\( V_{in} \\). The graph is a line plot with the following details:\n\n1. **Axes Labels and Units:**\n- The horizontal axis represents the input voltage \\( V_{in} \\), with no specific units marked, assuming volts (V).\n- The vertical axis represents the on-resistance \\( R_{on,N} \\), with no specific units marked, assuming ohms ().\n\n2. **Overall Behavior and Trends:**\n- The graph shows an increasing trend in the on-resistance \\( R_{on,N} \\) as the input voltage \\( V_{in} \\) increases.\n- The curve starts at a relatively low resistance value when \\( V_{in} \\) is near zero and rises steeply as \\( V_{in} \\) approaches \\( V_{DD} - V_{TH} \\).\n\n3. **Key Features and Technical Details:**\n- There is a significant increase in the on-resistance as the input voltage approaches the threshold \\( V_{DD} - V_{TH} \\), indicating a steep rise in resistance.\n- The graph is asymptotic near \\( V_{DD} - V_{TH} \\), suggesting a sharp increase in resistance beyond this point.\n- A dashed vertical line is marked at \\( V_{DD} - V_{TH} \\), highlighting this critical threshold voltage.\n\n4. **Annotations and Specific Data Points:**\n- The graph includes a dashed vertical line at \\( V_{DD} - V_{TH} \\) on the \\( V_{in} \\) axis, indicating a key threshold value where the behavior of the NMOS on-resistance changes significantly.\n- There are no specific numerical values or additional annotations provided on the graph.\n\nThe graph labeled (b) in Fig. 13.16 is a plot of the on-resistance \\( R_{on,P} \\) of a PMOS device as a function of the input voltage \\( V_{in} \\).\n\n1. **Type of Graph and Function:**\n- This is a line graph showing the relationship between the on-resistance of a PMOS transistor and its input voltage.\n\n2. **Axes Labels and Units:**\n- The horizontal axis represents the input voltage \\( V_{in} \\), with the scale starting from 0. The units are in volts, although not explicitly marked.\n- The vertical axis represents the on-resistance \\( R_{on,P} \\) of the PMOS device. The units are in ohms, though not explicitly marked.\n\n3. **Overall Behavior and Trends:**\n- The graph shows a decreasing trend in the on-resistance as the input voltage increases.\n- Initially, when \\( V_{in} \\) is around 0, the on-resistance is high.\n- As \\( V_{in} \\) increases, \\( R_{on,P} \\) decreases rapidly.\n- The curve appears to approach an asymptote, indicating that the resistance levels off at higher input voltages.\n\n4. **Key Features and Technical Details:**\n- A significant point on the graph is marked at \\( |V_{THP}| \\), which is the threshold voltage for the PMOS device.\n- The on-resistance decreases significantly after the input voltage surpasses \\( |V_{THP}| \\).\n\n5. **Annotations and Specific Data Points:**\n- The dashed vertical line at \\( |V_{THP}| \\) indicates the threshold voltage, a critical point where the behavior of the device changes notably.\n- No specific numerical values are provided for \\( R_{on,P} \\) or \\( V_{in} \\), other than the threshold voltage marker.\n\nFigure 13.16 On-resistance of (a) NMOS and (b) PMOS devices as a function of input voltage.\n\nTo allow for greater voltage swings in a sampling circuit, we first note that a PMOS switch exhibits an on-resistance that decreases as the input voltage becomes more positive [Fig. 13.16(b)]. It is then feasible to use \"complementary\" switches to enable rail-to-tail swings. As shown in Fig. 13.17(a), such a combination requires complementary clocks, resulting in an equivalent resistance:\n\n$$\n\\begin{aligned}\nR_{o n, e q} & =R_{o n, N} \\| R_{o n, P} \\\\\n& =\\frac{1}{\\mu_{n} C_{o x}(W / L)_{N}\\left(V_{D D}-V_{i n}-V_{T H N}\\right)} \\| \\frac{1}{\\mu_{p} C_{o x}(W / L)_{P}\\left(V_{i n}-\\left|V_{T H P}\\right|\\right)}\n\\end{aligned}\n$$\n\nIt follows that\n\n$$\n\\begin{aligned}\n& R_{o n, e q}= \\\\\n& \\frac{1}{\\mu_{n} C_{o x}(W / L)_{N}\\left(V_{D D}-V_{T H N}\\right)-\\left[\\mu_{n} C_{o x}(W / L)_{N}-\\mu_{p} C_{o x}(W / L)_{P}\\right] V_{i n}-\\mu_{p} C_{o x}(W / L)_{P}\\left|V_{T H P}\\right|}\n\\end{aligned}\n$$\n\nThe circuit diagram in Fig. 13.17(a) represents a complementary switch with NMOS and PMOS transistors controlled by a clock signal 'CK'. The output is taken across the capacitor CH connected to Vout and ground.\n\nThe graph in Fig. 13.17(b) plots the on-resistance of a complementary switch as a function of the input voltage \\( V_{in} \\). The x-axis represents the input voltage \\( V_{in} \\) and is marked with two significant points: \\( |V_{THP}| \\) and \\( V_{DD} - V_{TH} \\). The y-axis represents the on-resistance, though it is not labeled with specific units.\n\nThe graph displays three curves:\n\n1. **\\( R_{on,P} \\)**: This curve represents the on-resistance of the PMOS transistor. It starts at a higher resistance when \\( V_{in} \\) is less than \\( |V_{THP}| \\) and decreases as \\( V_{in} \\) increases, approaching zero as \\( V_{in} \\) nears \\( V_{DD} - V_{TH} \\).\n\n2. **\\( R_{on,N} \\)**: This curve shows the on-resistance of the NMOS transistor. It begins at a lower resistance when \\( V_{in} \\) is greater than \\( V_{DD} - V_{TH} \\) and increases as \\( V_{in} \\) decreases, moving towards \\( |V_{THP}| \\).\n\n3. **\\( R_{on,eq} \\)**: This is the equivalent on-resistance of the complementary switch, which is a combination of the NMOS and PMOS resistances. The curve for \\( R_{on,eq} \\) is relatively flat compared to the individual resistances, indicating less variation across the range of \\( V_{in} \\).\n\nThe overall behavior shows that while \\( R_{on,P} \\) and \\( R_{on,N} \\) vary significantly with \\( V_{in} \\), their combination \\( R_{on,eq} \\) remains more stable, demonstrating the advantage of using a complementary switch configuration to minimize resistance variation with input voltage.\n\nFigure 13.17 (a) Complementary switch; (b) on-resistance of the complementary switch.\nInterestingly, if $\\mu_{n} C_{o x}(W / L)_{N}=\\mu_{p} C_{o x}(W / L)_{P}$, then $R_{o n, e q}$ is independent of the input level. ${ }^{4}$ Figure 13.17(b) plots the behavior of $R_{o n, e q}$ in the general case, revealing much less variation than that corresponding to each switch alone. We quantify the effect of switch nonlinearity in Chapter 14.\n\nFor high-speed input signals, it is crucial that the NMOS and PMOS switches in Fig. 13.17(a) turn off simultaneously to avoid ambiguity in the sampled value. If, for example, the NMOS device turns off $\\Delta t$ seconds earlier than the PMOS device, then the output voltage tends to track the input for the remaining $\\Delta t$ seconds, but with a large, input-dependent time constant (Fig. 13.18). This effect leads to distortion in the sampled value. For moderate precision, the simple circuit shown in Fig. 13.19 provides complementary clocks by duplicating the delay of inverter $I_{1}$ through the pass gate $G_{2}$."
},
{
    "text": "What factors influence the speed of the sampling circuits depicted in Fig. 13.9? Initially, we need to clarify what we mean by speed in this context. As shown in Fig. 13.15, a straightforward measure of speed is the time it takes for the output voltage to transition from zero to the maximum input level once the switch is activated. The circuit in Fig. 13.15 is a sampling circuit utilizing an NMOS switch (M1) controlled by a clock signal (CK), with a capacitor (CH) storing the sampled voltage. The graph in this figure illustrates the speed of the sampling circuit by depicting how the output voltage (Vout) approaches the input voltage (Vin0) over time, settling within a specified error band (V) after a certain time period (tS).\n\nThe graph in Fig. 13.15 is a time-domain waveform that defines speed in a sampling circuit. The horizontal axis represents time (t), while the vertical axis represents the output voltage (V_out). It shows how the output voltage evolves over time after the circuit's switch is activated.\n\nAxes and Units:\n- **Horizontal Axis (Time, t):** No specific units are given, but it represents the progression of time.\n- **Vertical Axis (Voltage, V_out):** Represents the output voltage level, with reference points labeled as V_DD and V_in0.\n\nOverall Behavior and Trends:\n- The waveform starts at zero when time is zero, indicating that the output voltage V_out initially is at ground level.\n- Upon switch activation, V_out begins to rise towards the input voltage level, V_in0.\n- The curve exhibits an exponential rise, starting steeply and gradually leveling off as it nears V_in0.\n- The output voltage does not reach V_in0 instantaneously but takes time to settle within a specified error band, V.\n\nKey Features and Technical Details:\n- The rise of V_out is marked by a settling time, t_S, which is the time required for V_out to reach within a certain percentage (e.g., 0.1%) of the final value V_in0.\n- V represents the error band around the final value V_in0, indicating the range within which V_out is considered settled.\n- The waveform approaches V_in0 asymptotically rather than reaching it exactly.\n\nAnnotations and Specific Data Points:\n- V_DD is marked on the vertical axis as a reference for the maximum voltage level.\n- V_in0 is indicated as the target level for V_out.\n- The settling time t_S is marked on the time axis, showing the point where V_out is within V of V_in0.\n\nThis graph effectively illustrates the concept of speed in a sampling circuit by showing how quickly the output voltage can settle to the input voltage level after the switch is activated, within an acceptable error margin.\n\nIn Fig. 13.15, the speed of the sampling circuit is defined as the time it takes for the output voltage to go from zero to the maximum input level after the switch turns on. Since V_out would theoretically take infinite time to equal Vin0, we consider the output settled when it falls within a certain \"error band,\" V, around the final value. For instance, we might say the output settles to 0.1% accuracy after t_S seconds, meaning that in Fig. 13.15, V/V_in0 = 0.1%. Therefore, the speed specification must also include an accuracy specification. Note that after t = t_S, we can consider the source and drain voltages to be approximately equal.\n\nFrom the circuit in Fig. 13.15, we deduce that the sampling speed is determined by two main factors: the on-resistance of the switch and the value of the sampling capacitor. To achieve higher speed, a large aspect ratio and a small capacitor are necessary. However, as shown in Fig. 13.13, the on-resistance also depends on the input level, resulting in a greater time constant for more positive inputs (in the case of NMOS switches). From Eq. (13.22), we plot the on-resistance of the switch as a function of the input level [Fig. 13.16(a)], noting the sharp rise as Vin approaches V_DD - V_TH. For example, if we limit the variation of R_on to a range of 4 to 1, then the maximum input level is given by\n\n$$\n\\begin{equation*}\n\\frac{1}{\\mu_n C_{ox} \\frac{W}{L}\\left(V_{DD} - V_{in,\\max} - V_{TH}\\right)} = \\frac{4}{\\mu_n C_{ox} \\frac{W}{L}\\left(V_{DD} - V_{TH}\\right)} \\tag{13.23}\n\\end{equation*}\n$$\n\nThus,\n\n$$\n\\begin{equation*}\nV_{in,\\max} = \\frac{3}{4}\\left(V_{DD} - V_{TH}\\right) \\tag{13.24}\n\\end{equation*}\n$$\n\nThis value is approximately V_DD/2, imposing severe limitations on voltage swings. Note that the device threshold voltage directly limits the voltage swings.\n\nThe graph labeled \"(a)\" in Fig. 13.16 plots the on-resistance R_on,N of an NMOS device as a function of the input voltage Vin. The graph is a line plot with the following details:\n\n1. **Axes Labels and Units:**\n- The horizontal axis represents the input voltage Vin, with no specific units marked, assuming volts (V).\n- The vertical axis represents the on-resistance R_on,N, with no specific units marked, assuming ohms ().\n\n2. **Overall Behavior and Trends:**\n- The graph shows an increasing trend in the on-resistance R_on,N as the input voltage Vin increases.\n- The curve starts at a relatively low resistance value when Vin is close to zero and rises steeply as Vin approaches V_DD - V_TH.\n\n3. **Key Features and Technical Details:**\n- There is a significant increase in the on-resistance as the input voltage approaches the threshold V_DD - V_TH, indicating a steep rise in resistance.\n- The graph is asymptotic near V_DD - V_TH, suggesting a sharp increase in resistance beyond this point.\n- A dashed vertical line is marked at V_DD - V_TH, highlighting this critical threshold voltage.\n\n4. **Annotations and Specific Data Points:**\n- The graph includes a dashed vertical line at V_DD - V_TH on the Vin axis, indicating a key threshold value where the behavior of the NMOS on-resistance changes significantly.\n- No specific numerical values or additional annotations are provided on the graph.\n\nThe graph labeled (b) in Fig. 13.16 plots the on-resistance R_on,P of a PMOS device as a function of the input voltage Vin.\n\n1. **Type of Graph and Function:**\n- This is a line graph showing the relationship between the on-resistance of a PMOS transistor and its input voltage.\n\n2. **Axes Labels and Units:**\n- The horizontal axis represents the input voltage Vin, with the scale starting from 0. The units are in volts, although not explicitly marked.\n- The vertical axis represents the on-resistance R_on,P of the PMOS device. The units are in ohms, though not explicitly marked.\n\n3. **Overall Behavior and Trends:**\n- The graph shows a decreasing trend of the on-resistance as the input voltage increases.\n- Initially, when Vin is around 0, the on-resistance is high.\n- As Vin increases, R_on,P decreases rapidly.\n- The curve appears to approach an asymptote, indicating that the resistance levels off at higher input voltages.\n\n4. **Key Features and Technical Details:**\n- A significant point on the graph is marked at |V_THP|, which is the threshold voltage for the PMOS device.\n- The on-resistance decreases significantly after the input voltage surpasses |V_THP|.\n\n5. **Annotations and Specific Data Points:**\n- The dashed vertical line at |V_THP| indicates the threshold voltage, a critical point where the behavior of the device changes notably.\n- No specific numerical values are provided for R_on,P or Vin, other than the threshold voltage marker.\n\nFigure 13.16 shows the on-resistance of (a) NMOS and (b) PMOS devices as a function of input voltage.\n\nTo accommodate greater voltage swings in a sampling circuit, we first note that a PMOS switch exhibits an on-resistance that decreases as the input voltage becomes more positive [Fig. 13.16(b)]. It is then feasible to use \"complementary\" switches to allow rail-to-tail swings. As shown in Fig. 13.17(a), such a combination requires complementary clocks, resulting in an equivalent resistance:\n\n$$\n\\begin{aligned}\nR_{on,eq} & = R_{on,N} \\| R_{on,P} \\\\\n& = \\frac{1}{\\mu_n C_{ox} (W/L)_N \\left(V_{DD} - V_{in} - V_{THN}\\right)} \\| \\frac{1}{\\mu_p C_{ox} (W/L)_P \\left(V_{in} - |V_{THP}|\\right)}\n\\end{aligned}\n$$\n\nThis leads to\n\n$$\n\\begin{aligned}\nR_{on,eq} & = \\\\\n& \\frac{1}{\\mu_n C_{ox} (W/L)_N \\left(V_{DD} - V_{THN}\\right) - \\left[\\mu_n C_{ox} (W/L)_N - \\mu_p C_{ox} (W/L)_P\\right] V_{in} - \\mu_p C_{ox} (W/L)_P |V_{THP}|}\n\\end{aligned}\n$$\n\nFigure 13.17(a) depicts a complementary switch with NMOS and PMOS transistors controlled by a clock signal 'CK'. The output is taken across the capacitor CH connected to Vout and ground.\n\nThe graph in Fig. 13.17(b) plots the on-resistance of a complementary switch as a function of the input voltage Vin. The x-axis represents the input voltage Vin and is marked with two significant points: |V_THP| and V_DD - V_TH. The y-axis represents the on-resistance, although it is not labeled with specific units.\n\nThe graph displays three curves:\n\n1. **R_on,P**: This curve represents the on-resistance of the PMOS transistor. It starts at a higher resistance when Vin is less than |V_THP| and decreases as Vin increases, approaching zero as Vin nears V_DD - V_TH.\n\n2. **R_on,N**: This curve shows the on-resistance of the NMOS transistor. It begins at a lower resistance when Vin is greater than V_DD - V_TH and increases as Vin decreases, moving towards |V_THP|.\n\n3. **R_on,eq**: This is the equivalent on-resistance of the complementary switch, which is a combination of the NMOS and PMOS resistances. The curve for R_on,eq is relatively flat compared to the individual resistances, indicating less variation across the range of Vin.\n\nThe overall behavior shows that while R_on,P and R_on,N vary significantly with Vin, their combination R_on,eq remains more stable, demonstrating the advantage of using a complementary switch configuration to minimize resistance variation with input voltage.\n\nFigure 13.17(a) shows a complementary switch; (b) plots the on-resistance of the complementary switch.\nInterestingly, if _n C_{ox} (W/L)_N = _p C_{ox} (W/L)_P, then R_on,eq is independent of the input level. Figure 13.17(b) plots the behavior of R_on,eq in the general case, revealing much less variation than that corresponding to each switch alone. We quantify the effect of switch nonlinearity in Chapter 14.\n\nFor high-speed input signals, it is crucial that the NMOS and PMOS switches in Fig. 13.17(a) turn off simultaneously to avoid ambiguity in the sampled value. If, for example, the NMOS device turns off t seconds earlier than the PMOS device, the output voltage tends to track the input for the remaining t seconds, but with a large, input-dependent time constant (Fig. 13.18). This effect leads to distortion in the sampled value. For moderate precision, the simple circuit shown in Fig. 13.19 provides complementary clocks by duplicating the delay of inverter I1 through the pass gate G2."
},
{
    "text": "What factors influence the speed of the sampling circuits depicted in Fig. 13.9? Initially, we need to clarify what we mean by speed in this context. As illustrated in Fig. 13.15, a straightforward measure of speed is the time it takes for the output voltage to transition from zero to the maximum input level once the switch is activated. The circuit shown in Fig. 13.15 is a sampling circuit that employs an NMOS switch (M1) controlled by a clock (CK), with a capacitor (CH) storing the sampled voltage. The graph in Fig. 13.15 demonstrates the speed of the sampling circuit by depicting how the output voltage (Vout) approaches the input voltage (Vin0) over time, settling within a specified error band (V) after a certain period (tS).\n\nThe graph in Fig. 13.15 is a time-domain waveform that defines speed in a sampling circuit. The horizontal axis represents time (t), while the vertical axis represents the output voltage (V_out). It illustrates the changes in output voltage over time following the activation of the circuit switch.\n\nAxes and Units:\n- **Horizontal Axis (Time, t):** No specific units are provided, but it represents time progression.\n- **Vertical Axis (Voltage, V_out):** Represents the output voltage level, with reference points labeled as V_DD and V_in0.\n\nOverall Behavior and Trends:\n- The waveform starts at zero when time is zero, indicating that the output voltage V_out initially is at ground level.\n- Upon switch activation, V_out begins to rise towards the input voltage level, V_in0.\n- The curve exhibits an exponential rise, starting steep and gradually leveling off as it approaches V_in0.\n- The output voltage does not reach V_in0 instantaneously but takes time to settle within a specified error band, V.\n\nKey Features and Technical Details:\n- The rise of V_out is marked by a settling time, t_S, which is the time it takes for V_out to reach within a certain percentage (e.g., 0.1%) of the final value V_in0.\n- V represents the error band around the final value V_in0, indicating the range within which V_out is considered settled.\n- The waveform approaches V_in0 asymptotically rather than reaching it exactly.\n\nAnnotations and Specific Data Points:\n- V_DD is marked on the vertical axis as a reference for the maximum voltage level.\n- V_in0 is indicated as the target level for V_out.\n- The settling time t_S is marked on the time axis, showing the point where V_out is within V of V_in0.\n\nThis graph effectively illustrates the concept of speed in a sampling circuit by showing how quickly the output voltage can settle to the input voltage level after the switch is activated, within an acceptable error margin.\n\nFigure 13.15 Definition of speed in a sampling circuit.\nfrom zero to the maximum input level after the switch turns on. Since $V_{\\text {out }}$ would take infinite time to become equal to $V_{i n 0}$, we consider the output settled when it is within a certain \"error band,\" $\\Delta V$, around the final value. For instance, we say the output settles to $0.1 \\%$ accuracy after $t_{S}$ seconds, meaning that in Fig. 13.15, $\\Delta V / V_{i n 0}=0.1 \\%$. Therefore, the speed specification must be accompanied by an accuracy specification. Note that after $t=t_{S}$, we can consider the source and drain voltages to be approximately equal.\n\nFrom the circuit in Fig. 13.15, we deduce that the sampling speed is influenced by two main factors: the on-resistance of the switch and the value of the sampling capacitor. Thus, to enhance speed, a large aspect ratio and a small capacitor are required. However, as shown in Fig. 13.13, the on-resistance also depends on the input level, resulting in a greater time constant for more positive inputs (in the case of NMOS switches). From Eq. (13.22), we plot the on-resistance of the switch as a function of the input level [Fig. 13.16(a)], noting the sharp rise as $V_{i n}$ approaches $V_{D D}-V_{T H}$. For example, if we limit the variation of $R_{o n}$ to a range of 4 to 1, then the maximum input level is given by\n\n$$\n\\begin{equation*}\n\\frac{1}{\\mu_{n} C_{o x} \\frac{W}{L}\\left(V_{D D}-V_{i n, \\max }-V_{T H}\\right)}=\\frac{4}{\\mu_{n} C_{o x} \\frac{W}{L}\\left(V_{D D}-V_{T H}\\right)} \\tag{13.23}\n\\end{equation*}\n$$\n\nThat is\n\n$$\n\\begin{equation*}\nV_{i n, \\max }=\\frac{3}{4}\\left(V_{D D}-V_{T H}\\right) \\tag{13.24}\n\\end{equation*}\n$$\n\nThis value is approximately $V_{D D} / 2$, imposing severe limitations on voltage swings. Note that the device threshold voltage directly limits the voltage swings. ${ }^{3}$\n\nThe graph labeled \"(a)\" in Fig. 13.16 is a plot of the on-resistance \\( R_{on,N} \\) of an NMOS device as a function of the input voltage \\( V_{in} \\). The graph is a line plot with the following details:\n\n1. **Axes Labels and Units:**\n- The horizontal axis represents the input voltage \\( V_{in} \\), with no specific units marked, assuming volts (V).\n- The vertical axis represents the on-resistance \\( R_{on,N} \\), with no specific units marked, assuming ohms ().\n\n2. **Overall Behavior and Trends:**\n- The graph shows an increasing trend in the on-resistance \\( R_{on,N} \\) as the input voltage \\( V_{in} \\) increases.\n- The curve starts at a relatively low resistance value when \\( V_{in} \\) is near zero and rises steeply as \\( V_{in} \\) approaches \\( V_{DD} - V_{TH} \\).\n\n3. **Key Features and Technical Details:**\n- There is a significant increase in the on-resistance as the input voltage approaches the threshold \\( V_{DD} - V_{TH} \\), indicating a steep rise in resistance.\n- The graph is asymptotic near \\( V_{DD} - V_{TH} \\), suggesting a sharp increase in resistance beyond this point.\n- A dashed vertical line is marked at \\( V_{DD} - V_{TH} \\), highlighting this critical threshold voltage.\n\n4. **Annotations and Specific Data Points:**\n- The graph includes a dashed vertical line at \\( V_{DD} - V_{TH} \\) on the \\( V_{in} \\) axis, indicating a key threshold value where the behavior of the NMOS on-resistance changes significantly.\n- There are no specific numerical values or additional annotations provided on the graph.\n\nThe graph labeled (b) in Fig. 13.16 is a plot of the on-resistance \\( R_{on,P} \\) of a PMOS device as a function of the input voltage \\( V_{in} \\).\n\n1. **Type of Graph and Function:**\n- This is a line graph showing the relationship between the on-resistance of a PMOS transistor and its input voltage.\n\n2. **Axes Labels and Units:**\n- The horizontal axis represents the input voltage \\( V_{in} \\), with the scale starting from 0. The units are in volts, although not explicitly marked.\n- The vertical axis represents the on-resistance \\( R_{on,P} \\) of the PMOS device. The units are in ohms, though not explicitly marked.\n\n3. **Overall Behavior and Trends:**\n- The graph shows a decreasing trend of the on-resistance as the input voltage increases.\n- Initially, when \\( V_{in} \\) is around 0, the on-resistance is high.\n- As \\( V_{in} \\) increases, \\( R_{on,P} \\) decreases rapidly.\n- The curve appears to approach an asymptote, indicating that the resistance levels off at higher input voltages.\n\n4. **Key Features and Technical Details:**\n- A significant point on the graph is marked at \\( |V_{THP}| \\), which is the threshold voltage for the PMOS device.\n- The on-resistance decreases significantly after the input voltage surpasses \\( |V_{THP}| \\).\n\n5. **Annotations and Specific Data Points:**\n- The dashed vertical line at \\( |V_{THP}| \\) indicates the threshold voltage, a critical point where the behavior of the device changes notably.\n- No specific numerical values are provided for \\( R_{on,P} \\) or \\( V_{in} \\), other than the threshold voltage marker.\n\nFigure 13.16 On-resistance of (a) NMOS and (b) PMOS devices as a function of input voltage.\n\nTo accommodate larger voltage swings in a sampling circuit, we first note that a PMOS switch exhibits an on-resistance that decreases as the input voltage becomes more positive [Fig. 13.16(b)]. It is then feasible to use \"complementary\" switches to allow rail-to-tail swings. As shown in Fig. 13.17(a), such a combination requires complementary clocks, resulting in an equivalent resistance:\n\n$$\n\\begin{aligned}\nR_{o n, e q} & =R_{o n, N} \\| R_{o n, P} \\\\\n& =\\frac{1}{\\mu_{n} C_{o x}(W / L)_{N}\\left(V_{D D}-V_{i n}-V_{T H N}\\right)} \\| \\frac{1}{\\mu_{p} C_{o x}(W / L)_{P}\\left(V_{i n}-\\left|V_{T H P}\\right|\\right)}\n\\end{aligned}\n$$\n\nIt follows that\n\n$$\n\\begin{aligned}\n& R_{o n, e q}= \\\\\n& \\frac{1}{\\mu_{n} C_{o x}(W / L)_{N}\\left(V_{D D}-V_{T H N}\\right)-\\left[\\mu_{n} C_{o x}(W / L)_{N}-\\mu_{p} C_{o x}(W / L)_{P}\\right] V_{i n}-\\mu_{p} C_{o x}(W / L)_{P}\\left|V_{T H P}\\right|}\n\\end{aligned}\n$$\n\nThe circuit diagram in Fig. 13.17(a) represents a complementary switch with NMOS and PMOS transistors controlled by a clock signal 'CK'. The output is taken across the capacitor CH connected to Vout and ground.\n\nThe graph in Fig. 13.17(b) plots the on-resistance of a complementary switch as a function of the input voltage \\( V_{in} \\). The x-axis represents the input voltage \\( V_{in} \\) and is marked with two significant points: \\( |V_{THP}| \\) and \\( V_{DD} - V_{TH} \\). The y-axis represents the on-resistance, although it is not labeled with specific units.\n\nThe graph displays three curves:\n\n1. **\\( R_{on,P} \\)**: This curve represents the on-resistance of the PMOS transistor. It starts at a higher resistance when \\( V_{in} \\) is less than \\( |V_{THP}| \\) and decreases as \\( V_{in} \\) increases, approaching zero as \\( V_{in} \\) nears \\( V_{DD} - V_{TH} \\).\n\n2. **\\( R_{on,N} \\)**: This curve shows the on-resistance of the NMOS transistor. It begins at a lower resistance when \\( V_{in} \\) is greater than \\( V_{DD} - V_{TH} \\) and increases as \\( V_{in} \\) decreases, moving towards \\( |V_{THP}| \\).\n\n3. **\\( R_{on,eq} \\)**: This is the equivalent on-resistance of the complementary switch, which is a combination of the NMOS and PMOS resistances. The curve for \\( R_{on,eq} \\) is relatively flat compared to the individual resistances, indicating less variation across the range of \\( V_{in} \\).\n\nThe overall behavior shows that while \\( R_{on,P} \\) and \\( R_{on,N} \\) vary significantly with \\( V_{in} \\), their combination \\( R_{on,eq} \\) remains more stable, demonstrating the advantage of using a complementary switch configuration to minimize resistance variation with input voltage.\n\nFigure 13.17 (a) Complementary switch; (b) on-resistance of the complementary switch.\nInterestingly, if $\\mu_{n} C_{o x}(W / L)_{N}=\\mu_{p} C_{o x}(W / L)_{P}$, then $R_{o n, e q}$ is independent of the input level. ${ }^{4}$ Figure 13.17(b) plots the behavior of $R_{o n, e q}$ in the general case, revealing much less variation than that corresponding to each switch alone. We quantify the effect of switch nonlinearity in Chapter 14.\n\nFor high-speed input signals, it is crucial that the NMOS and PMOS switches in Fig. 13.17(a) turn off simultaneously to avoid ambiguity in the sampled value. If, for instance, the NMOS device turns off $\\Delta t$ seconds earlier than the PMOS device, then the output voltage tends to track the input for the remaining $\\Delta t$ seconds, but with a large, input-dependent time constant (Fig. 13.18). This effect leads to distortion in the sampled value. For moderate precision, the simple circuit shown in Fig. 13.19 provides complementary clocks by duplicating the delay of inverter $I_{1}$ through the pass gate $G_{2}$."
},
{
    "text": "Our prior research on MOS switches reveals that an increased $W / L$ ratio or a reduced sampling capacitor size leads to higher speed. However, this section will demonstrate that these speed-enhancing methods compromise the accuracy of signal sampling.\n\nThree mechanisms in MOS transistor operation introduce error at the moment the switch is turned off. We will examine each of these effects individually.\n\nThe graph in Figure 13.18 consists of two main parts, illustrating the distortion generated when complementary switches do not turn off simultaneously.\n\n1. **Type of Graph and Function:**\n- The graph is a time-domain waveform, showing the behavior of complementary clock signals and their effect on input and output voltages.\n\n2. **Axes Labels and Units:**\n- The horizontal axis represents time (denoted as 't'), though no specific units are provided.\n- The vertical axis is not explicitly labeled but represents voltage levels for the clock signals and input/output voltages.\n\n3. **Overall Behavior and Trends:**\n- The first part of the graph shows two complementary clock signals, CK and \\(\\overline{CK}\\), crossing each other with a small time difference \\(\\Delta t\\). This indicates that the switches do not turn off at the exact same time, leading to a timing mismatch.\n- The second part of the graph shows the input voltage \\(V_{in}\\) as a sinusoidal waveform and the output voltage \\(V_{out}\\) following a similar pattern but with noticeable distortion. The output voltage deviates from an ideal value, which is indicated by a dashed line.\n\n4. **Key Features and Technical Details:**\n- The key feature here is the timing mismatch \\(\\Delta t\\) between the complementary clock signals, which is crucial in understanding the distortion at the output.\n- The distortion in \\(V_{out}\\) is depicted as a deviation from the ideal value, highlighting the impact of non-simultaneous switch-off on signal integrity.\n\n5. **Annotations and Specific Data Points:**\n- \\(\\Delta t\\) is annotated on the clock signal graph, emphasizing the timing difference.\n- The ideal value of \\(V_{out}\\) is marked as a dashed line, showing the expected behavior without distortion.\n\nFigure 13.18 Distortion generated when complementary switches do not turn off simultaneously.\n\nThe circuit in Figure 13.19 is designed to generate complementary clock signals CK and CK_bar from the input clock CKin using an NMOS transistor and an inverter.\n\nFigure 13.19 Simple circuit generating complementary clocks.\n\nChannel Charge Injection Consider the sampling circuit of Fig. 13.20, and recall that for a MOSFET to be on, a channel must exist at the oxide-silicon interface. Assuming that $V_{\\text {in }} \\approx V_{\\text {out }}$, we use our derivations in Chapter 2 to express the total charge in the inversion layer as\n\n$$\n\\begin{equation*}\nQ_{c h}=W L C_{o x}\\left(V_{D D}-V_{i n}-V_{T H}\\right) \\tag{13.25}\n\\end{equation*}\n$$\n\nwhere $L$ denotes the effective channel length. When the switch turns off, $Q_{c h}$ exits through the source and drain terminals, a phenomenon called \"channel charge injection.\"\n\nFigure 13.20 Charge injection when a switch turns off.\n\nThe charge injected to the left side of Fig. 13.20 is absorbed by the input source, creating no error. On the other hand, the charge injected to the right side is deposited on $C_{H}$, introducing an error in the voltage stored on the capacitor. For example, if half of $Q_{c h}$ is injected onto $C_{H}$, the resulting error equals\n\n$$\n\\begin{equation*}\n\\Delta V=\\frac{W L C_{o x}\\left(V_{D D}-V_{i n}-V_{T H}\\right)}{2 C_{H}} \\tag{13.26}\n\\end{equation*}\n$$\n\nFigure 13.21 illustrates the effect of charge injection in a circuit using an NMOS switch. The diagram is composed of three main parts:\n\n1. **Input Waveform (Left Side):**\n- The left side of the figure shows an input sinusoidal waveform labeled as $V_{in}$. This waveform represents the input voltage to the circuit. The sinusoidal shape indicates a periodic oscillation, typical of alternating current (AC) signals.\n\n2. **Circuit Diagram (Center):**\n- At the center of the figure, there is a schematic of a simple circuit involving an NMOS transistor labeled as $M_1$. The gate of the transistor is controlled by a clock signal labeled \"CK,\" represented by a square waveform. This suggests that the transistor is being switched on and off periodically.\n- The source of the transistor is connected to the input voltage $V_{in}$, and the drain is connected to the output $V_{out}$.\n- A capacitor labeled $C_{H}$ is connected between the output $V_{out}$ and ground (GND), which stores charge when the transistor is conducting.\n\n3. **Output Waveform (Right Side):**\n- The right side of the figure shows the output waveform $V_{out}$, which is a sinusoidal wave similar to the input but with a noticeable negative \"pedestal\" or dip, labeled as $\\Delta V$. This indicates the error introduced by charge injection when the transistor switches.\n- The dip in the waveform corresponds to the moment when the transistor turns off, and part of the channel charge is injected onto the capacitor $C_{H}$, leading to a temporary voltage drop.\n\nOverall, the figure demonstrates how charge injection from the NMOS switch affects the output voltage, creating a negative voltage error (pedestal) at the output. This error is proportional to the dimensions of the transistor ($WL$) and the oxide capacitance ($C_{ox}$), and inversely proportional to the holding capacitance ($C_{H}$), as described by the equation provided in the context.\n\nAn important question that arises now is-Why did we assume in arriving at (13.26) that exactly half of the channel charge is injected onto $C_{H}$ ? In reality, the fraction of charge that exits through the source and drain terminals is a relatively complex function of various parameters, such as the impedance seen at each terminal to ground and the transition time of the clock [1, 2]. Investigations of this effect have not yielded any rule of thumb that can predict the charge splitting in terms of such parameters. Furthermore, in many cases, these parameters, e.g., the clock transition time, are poorly controlled. Also, most circuit simulation programs model charge injection quite inaccurately. As a worst-case estimate, we can assume that the entire channel charge is injected onto the sampling capacitor.\n\nHow does charge injection affect the precision? Assuming that all of the charge is deposited on the capacitor, we express the sampled output voltage as\n\n$$\n\\begin{equation*}\nV_{\\text {out }} \\approx V_{\\text {in }}-\\frac{W L C_{o x}\\left(V_{D D}-V_{\\text {in }}-V_{T H}\\right)}{C_{H}} \\tag{13.27}\n\\end{equation*}\n$$\n\nwhere the phase shift between the input and the output is neglected. Thus,\n\n$$\n\\begin{equation*}\nV_{o u t}=V_{i n}\\left(1+\\frac{W L C_{o x}}{C_{H}}\\right)-\\frac{W L C_{o x}}{C_{H}}\\left(V_{D D}-V_{T H}\\right) \\tag{13.28}\n\\end{equation*}\n$$\n\nsuggesting that the output deviates from the ideal value through two effects: a nonunity gain equal to $1+W L C_{o x} / C_{H},{ }^{5}$ and a constant offset voltage $-W L C_{o x}\\left(V_{D D}-V_{T H}\\right) / C_{H}$ (Fig. 13.22). In other words, since we have assumed that channel charge is a linear function of the input voltage, the circuit exhibits only gain error and dc offset.\n\nFigure 13.22 Input/output characteristic of sampling circuit in the presence of charge injection.\n\nIn the foregoing discussion, we tacitly assumed that $V_{T H}$ is constant. However, for NMOS switches (in an $n$-well technology), body effect must be taken into account. ${ }^{6}$ Since $V_{T H}=V_{T H 0}+\\gamma\\left(\\sqrt{2 \\phi_{B}+V_{S B}}-\\sqrt{2 \\phi_{B}}\\right)$,\n\n[^96]and $V_{B S} \\approx-V_{i n}$, we have\n\\$\\$\n\n$$\n\\begin{align*}\nV_{o u t}= & V_{i n}-\\frac{W L C_{o x}}{C_{H}}\\left(V_{D D}-V_{i n}-V_{T H 0}-\\gamma \\sqrt{2 \\phi_{B}+V_{i n}}+\\gamma \\sqrt{2 \\phi_{B}}\\right)  \\tag{13.29}\\\\\n= & V_{i n}\\left(1+\\frac{W L C_{o x}}{C_{H}}\\right)+\\gamma \\frac{W L C_{o x}}{C_{H}} \\sqrt{2 \\phi_{B}+V_{i n}} \\\\\n& -\\frac{W L C_{o x}}{C_{H}}\\left(V_{D D}-V_{T H 0}+\\gamma \\sqrt{2 \\phi_{B}}\\right) \\tag{13.30}\n\\end{align*}\n$$\n\n\\$\\$\n\nIt follows that the nonlinear dependence of $V_{T H}$ upon $V_{i n}$ introduces nonlinearity in the input/output characteristic.\n\nIn summary, charge injection contributes three types of errors in MOS sampling circuits: gain error, dc offsets, and nonlinearity. In many applications, the first two can be tolerated or corrected whereas the last cannot.\n\nIt is instructive to consider the speed-precision trade-off resulting from charge injection. Representing the speed by a simple time constant $\\tau$ and the precision by the error $\\Delta V$ due to charge injection, we define a figure of merit as $F=(\\tau \\Delta V)^{-1}$. Writing\n\n$$\n\\begin{align*}\n\\tau & =R_{o n} C_{H}  \\tag{13.31}\\\\\n& =\\frac{1}{\\mu_{n} C_{o x}(W / L)\\left(V_{D D}-V_{i n}-V_{T H}\\right)} C_{H} \\tag{13.32}\n\\end{align*}\n$$\n\nand\n\n$$\n\\begin{equation*}\n\\Delta V=\\frac{W L C_{o x}}{C_{H}}\\left(V_{D D}-V_{i n}-V_{T H}\\right) \\tag{13.33}\n\\end{equation*}\n$$\n\nwe have\n\n$$\n\\begin{equation*}\nF=\\frac{\\mu_{n}}{L^{2}} \\tag{13.34}\n\\end{equation*}\n$$\n\nThus, to the first order, the trade-off is independent of the switch width and the sampling capacitor.\n\nClock Feedthrough In addition to channel charge injection, a MOS switch couples the clock transitions to the sampling capacitor through its gate-drain or gate-source overlap capacitance. Depicted in Fig. 13.23, the effect introduces an error in the sampled output voltage. Assuming the overlap capacitance is constant, we express the error as\n\n$$\n\\begin{equation*}\n\\Delta V=V_{C K} \\frac{W C_{o v}}{W C_{o v}+C_{H}} \\tag{13.35}\n\\end{equation*}\n$$\n\nFigure 13.23 Clock feedthrough in a sampling circuit.\n\nThe error $\\Delta V$ is independent of the input level, manifesting itself as a constant offset in the input/output characteristic. As with charge injection, clock feedthrough leads to a trade-off between speed and precision as well.\n\n$\\boldsymbol{k T} / \\mathbf{C}$ Noise Recall from Example 7.3 that a resistor charging a capacitor gives rise to a total rms noise voltage of $\\sqrt{k T / C}$. As shown in Fig. 13.24, a similar effect occurs in sampling circuits. The on-resistance of the switch introduces thermal noise at the output and, when the switch turns off, this noise is stored on the capacitor along with the instantaneous value of the input voltage. It can be proved that the rms voltage of the sampled noise in this case is still approximately equal to $\\sqrt{k T / C}[3,4]$.\n\nFigure 13.24 Thermal noise in a sampling circuit.\n\nThe problem of $k T / C$ noise limits the performance in many high-precision applications. In order to achieve low noise, the sampling capacitor must be sufficiently large, thus loading other circuits and degrading the speed."
},
{
    "text": "Our initial investigation into MOS switches revealed that an increased $W / L$ ratio or a reduced sampling capacitor size leads to a faster operation. However, this section will demonstrate that these speed-enhancing techniques compromise the accuracy of signal sampling.\n\nThere are three primary mechanisms during MOS transistor operation that introduce error at the moment the switch is deactivated. We will examine each of these effects separately.\n\n[Figure 13.18 Description Rephrased]\nFigure 13.18 displays a graph illustrating the distortion that occurs when complementary switches do not shut off at the same time. The graph is divided into two main sections: the first part showcases the distortion in timing when complementary clock signals CK and \\(\\overline{CK}\\) do not align perfectly, and the second part compares the input voltage \\(V_{in}\\) as a sinusoidal waveform to the distorted output voltage \\(V_{out}\\), which deviates from the ideal dashed line representation.\n\n[Figure 13.19 Description Rephrased]\nFigure 13.19 depicts a simple circuit designed to produce complementary clock signals CK and CK_bar from the input clock CKin using an NMOS transistor and an inverter.\n\n[Charge Injection Description Rephrased]\nConsidering the sampling circuit in Figure 13.20, we must remember that for a MOSFET to operate, a channel is required at the oxide-silicon interface. Assuming \\(V_{\\text {in }} \\approx V_{\\text {out }}\\), we use our derivations from Chapter 2 to represent the total charge in the inversion layer as given by Equation (13.25). When the switch is turned off, this charge \\(Q_{c h}\\) exits through the source and drain, a process known as \"channel charge injection.\"\n\n[Figure 13.20 and 13.21 Description Rephrased]\nFigure 13.20 illustrates charge injection when a switch is turned off, affecting the voltage across the capacitor CH. In Figure 13.21, the graph shows the effect of charge injection in a circuit using an NMOS switch. It is composed of three sections: the input waveform on the left, the circuit diagram in the center involving an NMOS transistor \\(M_1\\) controlled by the clock signal CK, and the output waveform on the right, which shows a sinusoidal wave with a noticeable\nCertainly, here is the rephrased text:\n\nOur initial research into MOS switches indicates that an increased $W / L$ ratio or a reduced sampling capacitor size results in a faster operation. However, this section will demonstrate that these speed-enhancing techniques compromise the accuracy of signal sampling.\n\nThere are three primary mechanisms during MOS transistor operation that introduce error at the moment the switch is deactivated. We will examine each of these effects separately.\n\n[Figure 13.18 Description Rephrased]\nFigure 13.18 displays a graph illustrating the distortion that occurs when complementary switches do not shut off at the same time. The graph is divided into two main sections: the first part showcases the distortion in timing when complementary clock signals CK and \\(\\overline{CK}\\) do not align perfectly, and the second part compares the input voltage \\(V_{in}\\) as a sinusoidal waveform to the distorted output voltage \\(V_{out}\\), which deviates from the ideal dashed line representation.\n\n[Figure 13.19 Description Rephrased]\nFigure 13.19 depicts a simple circuit designed to produce complementary clock signals CK and CK_bar from the input clock CKin using an NMOS transistor and an inverter.\n\n[Charge Injection Description Rephrased]\nConsidering the sampling circuit in Figure 13.20, we must remember that for a MOSFET to operate, a channel is required at the oxide-silicon interface. Assuming \\(V_{\\text {in }} \\approx V_{\\text {out }}\\), we use our derivations from Chapter 2 to represent the total charge in the inversion layer as given by Equation (13.25). When the switch is turned off, this charge \\(Q_{c h}\\) exits through the source and drain, a process known as \"channel charge injection.\"\n\n[Figure 13.20 and 13.21 Description Rephrased]\nFigure 13.20 illustrates charge injection when a switch is turned off, affecting the voltage across the capacitor CH. In Figure 13.21, the graph shows the effect of charge injection in a circuit using an NMOS switch. It is composed of three sections: the input waveform on the left, the circuit diagram in the center involving an NMOS transistor \\(M_1\\) controlled by the clock signal CK, and the output waveform on the right, which shows a sinusoidal wave with a noticeable negative \"pedestal\" or dip, indicating the error introduced by charge injection when the transistor switches.\n\n[Input/Output Characteristic Description Rephrased]\nFigure 13.22 shows the input/output characteristic of a sampling circuit when charge injection is present. The graph is a linear plot with two primary lines: one labeled \"Ideal\" and the other labeled \"With Charge Injection.\" The x-axis represents the input voltage \\(V_{in}\\), while the y-axis represents the sampled output voltage \\(V_{out}\\). Both axes are likely in volts, although specific units are not provided.\n\nThe \"Ideal\" line is a dashed line that passes through the origin, illustrating a direct proportional relationship between \\(V_{in}\\) and \\(V_{out}\\) with no offset or gain error. This line represents the expected behavior of the circuit without any charge injection.\n\nThe solid line labeled \"With Charge Injection\" deviates from the ideal line, indicating a gain error and a DC offset. The line is shifted downward, starting from a negative offset on the y-axis, labeled \"Offset,\" and has a slope greater than the ideal line, indicating a non-unity gain. This represents the effect of charge injection, which introduces both a constant offset voltage and a gain error in the output.\n\n[Clock Feedthrough Description Rephrased]\nIn addition to channel charge injection, a MOS switch couples the clock transitions to the sampling capacitor through its gate-drain or gate-source overlap capacitance. As depicted in Figure 13.23, this effect introduces an error in the sampled output voltage. Assuming the overlap capacitance is constant, we express the error as given by Equation (13.35).\n\n$\\boldsymbol{k T} / \\mathbf{C}$ Noise [Rephrased]\nRecall from Example 7.3 that a resistor charging a capacitor gives rise to a total rms noise voltage of $\\sqrt{k T / C}$. As shown in Figure 13.24, a similar effect occurs in sampling circuits. The on-resistance of the switch introduces thermal noise at the output, and when the switch turns off, this noise is stored on the capacitor along with the instantaneous value of the input voltage. It can be proved that the rms voltage of the sampled noise in this case is still approximately equal to $\\sqrt{k T / C}$."
},
{
    "text": "Our prior research on MOS switches suggests that an increased $W / L$ ratio or a reduced sampling capacitor can enhance speed. However, this section demonstrates that these speed-boosting methods come at the cost of signal sampling precision.\n\nThree mechanisms in MOS transistor operation introduce errors at the moment the switch is turned off. We examine each of these effects separately.\n\n[Figure 13.18]\nThe graph in Figure 13.18 is divided into two main sections, illustrating the distortion that occurs when complementary switches do not turn off simultaneously.\n\n1. **Graph Type and Function:**\n   - The graph is a time-domain waveform, depicting the behavior of complementary clock signals and their impact on input and output voltages.\n\n2. **Axes Labels and Units:**\n   - The horizontal axis represents time (denoted as 't'), with no specific units provided.\n   - The vertical axis, unlabeled, represents voltage levels for the clock signals and input/output voltages.\n\n3. **Overall Behavior and Trends:**\n   - The first section of the graph shows two complementary clock signals, CK and \\(\\overline{CK}\\), crossing each other with a small time difference \\(\\Delta t\\). This indicates that the switches do not turn off at the exact same time, leading to a timing mismatch.\n   - The second section of the graph shows the input voltage \\(V_{in}\\) as a sinusoidal waveform and the output voltage \\(V_{out}\\) following a similar pattern but with noticeable distortion. The output voltage deviates from an ideal value, indicated by a dashed line.\n\n4. **Key Features and Technical Details:**\n   - The key feature here is the timing mismatch \\(\\Delta t\\) between the complementary clock signals, which is crucial in understanding the distortion at the output.\n   - The distortion in \\(V_{out}\\) is depicted as a deviation from the ideal value, highlighting the impact of non-simultaneous switch-off on signal integrity.\n\n5. **Annotations and Specific Data Points:**\n   - \\(\\Delta t\\) is annotated on the clock signal graph, emphasizing the timing difference.\n   - The ideal value of \\(V_{out}\\) is marked as a dashed line, showing the expected behavior without distortion.\n\n[Figure 13.18]\nThe figure consists of two main parts: the top part illustrates complementary clock signals, and the bottom part depicts a comparison between input and output waveforms.\n\n1. **Graph Type and Function:**\n   - The top graph is a timing diagram showing the relationship between two complementary clock signals, labeled as CK and \\( \\overline{CK} \\).\n   - The bottom graph is a time-domain waveform comparison, showing input (\\( V_{in} \\)) and output (\\( V_{out} \\)) voltages over time.\n\n2. **Axes Labels and Units:**\n   - The horizontal axis in both graphs represents time (t), with no specific units provided.\n   - The vertical axis in the top graph represents the logic levels of the clock signals CK and \\( \\overline{CK} \\).\n   - The vertical axis in the bottom graph represents voltage levels for \\( V_{in} \\) and \\( V_{out} \\), with no specific voltage units provided.\n\n3. **Overall Behavior and Trends:**\n   - In the top graph, CK and \\( \\overline{CK} \\) are complementary signals with a crossover point, indicating a non-zero delay (\\( \\Delta t \\)) between their transitions.\n   - In the bottom graph, \\( V_{in} \\) is a sinusoidal waveform, while \\( V_{out} \\) follows a similar shape but is slightly distorted, with a noticeable deviation from the ideal value at certain points.\n\n4. **Key Features and Technical Details:**\n   - The top graph highlights the delay \\( \\Delta t \\) between the falling edge of CK and the rising edge of \\( \\overline{CK} \\), which is a critical parameter in timing analysis.\n   - The bottom graph shows that \\( V_{out} \\) does not perfectly follow \\( V_{in} \\), indicating some form of distortion or error introduced in the signal processing.\n   - The ideal value for \\( V_{out} \\) is marked with a dashed line, showing where the output should ideally align with the input.\n\n5. **Annotations and Specific Data Points:**\n   - The top graph includes an annotation for \\( \\Delta t \\), emphasizing the timing mismatch between the complementary clocks.\n   - The bottom graph includes an annotation for the \"Ideal Value\" of \\( V_{out} \\), highlighting the discrepancy between the actual and expected output.\n\nFigure 13.18 illustrates the distortion generated when complementary switches do not turn off simultaneously.\n\n[Figure 13.19]\nThe circuit is designed to generate complementary clock signals CK and CK_bar from the input clock CKin using an NMOS transistor and an inverter.\n\nFigure 13.19 depicts a simple circuit generating complementary clocks.\n\nChannel Charge Injection Consider the sampling circuit of Fig. 13.20, and recall that for a MOSFET to be on, a channel must exist at the oxide-silicon interface. Assuming that $V_{\\text {in }} \\approx V_{\\text {out }}$, we use our derivations in Chapter 2 to express the total charge in the inversion layer as\n\n$$\n\\begin{equation*}\nQ_{c h}=W L C_{o x}\\left(V_{D D}-V_{i n}-V_{T H}\\right) \\tag{13.25}\n\\end{equation*}\n$$\n\nwhere $L$ denotes the effective channel length. When the switch turns off, $Q_{c h}$ exits through the source and drain terminals, a phenomenon called \"channel charge injection.\"\n\n[Figure 13.20]\nThe circuit illustrates charge injection in a switch when it turns off, affecting the voltage across the capacitor CH. The NMOS transistor M1 is controlled by the clock signal CK, allowing charge to flow from Vin to Vout when on. When M1 turns off, charge injection occurs, potentially causing an error voltage on CH.\n\nThe charge injected to the left side of Fig. 13.20 is absorbed by the input source, creating no error. On the other hand, the charge injected to the right side is deposited on $C_{H}$, introducing an error in the voltage stored on the capacitor. For example, if half of $Q_{c h}$ is injected onto $C_{H}$, the resulting error equals\n\n$$\n\\begin{equation*}\n\\Delta V=\\frac{W L C_{o x}\\left(V_{D D}-V_{i n}-V_{T H}\\right)}{2 C_{H}} \\tag{13.26}\n\\end{equation*}\n$$\n\n[Figure 13.21]\nThe graph in Figure 13.21 illustrates the effect of charge injection in a circuit using an NMOS switch. The diagram is composed of three main parts:\n\n1. **Input Waveform (Left Side):**\n   - The left side of the figure shows an input sinusoidal waveform labeled as $V_{in}$. This waveform represents the input voltage to the circuit. The sinusoidal shape indicates a periodic oscillation, typical of alternating current (AC) signals.\n\n2. **Circuit Diagram (Center):**\n   - At the center of the figure, there is a schematic of a simple circuit involving an NMOS transistor labeled as $M_1$. The gate of the transistor is controlled by a clock signal labeled \"CK,\" represented by a square waveform. This suggests that the transistor is being switched on and off periodically.\n   - The source of the transistor is connected to the input voltage $V_{in}$, and the drain is connected to the output $V_{out}$.\n   - A capacitor labeled $C_{H}$ is connected between the output $V_{out}$ and ground (GND), which stores charge when the transistor is conducting.\n\n3. **Output Waveform (Right Side):**\n   - The right side of the figure shows the output waveform $V_{out}$, which is a sinusoidal wave similar to the input but with a noticeable negative \"pedestal\" or dip, labeled as $\\Delta V$. This indicates the error introduced by charge injection when the transistor switches.\n   - The dip in the waveform corresponds to the moment when the transistor turns off, and part of the channel charge is injected onto the capacitor $C_{H}$, leading to a temporary voltage drop.\n\nOverall, the figure demonstrates how charge injection from the NMOS switch affects the output voltage, creating a negative voltage error (pedestal) at the output. This error is proportional to the dimensions of the transistor ($WL$) and the oxide capacitance ($C_{ox}$), and inversely proportional to the holding capacitance ($C_{H}$), as described by the equation provided in the context.\n\nAn important question that arises now is-Why did we assume in arriving at (13.26) that exactly half of the channel charge is injected onto $C_{H}$ ? In reality, the fraction of charge that exits through the source and drain terminals is a relatively complex function of various parameters, such as the impedance seen at each terminal to ground and the transition time of the clock [1, 2]. Investigations of this effect have not yielded any rule of thumb that can predict the charge splitting in terms of such parameters. Furthermore, in many cases, these parameters, e.g., the clock transition time, are poorly controlled. Also, most circuit simulation programs model charge injection quite inaccurately. As a worst-case estimate, we can assume that the entire channel charge is injected onto the sampling capacitor.\n\nHow does charge injection affect the precision? Assuming that all of the charge is deposited on the capacitor, we express the sampled output voltage as\n\n$$\n\\begin{equation*}\nV_{\\text {out }} \\approx V_{\\text {in }}-\\frac{W L C_{o x}\\left(V_{D D}-V_{\\text {in }}-V_{T H}\\right)}{C_{H}} \\tag{13.27}\n\\end{equation*}\n$$\n\nwhere the phase shift between the input and the output is neglected. Thus,\n\n$$\n\\begin{equation*}\nV_{o u t}=V_{i n}\\left(1+\\frac{W L C_{o x}}{C_{H}}\\right)-\\frac{W L C_{o x}}{C_{H}}\\left(V_{D D}-V_{T H}\\right) \\tag{13.28}\n\\end{equation*}\n$$\n\nsuggesting that the output deviates from the ideal value through two effects: a nonunity gain equal to $1+W L C_{o x} / C_{H},{ }^{5}$ and a constant offset voltage $-W L C_{o x}\\left(V_{D D}-V_{T H}\\right) / C_{H}$ (Fig. 13.22). In other words, since we have assumed that channel charge is a linear function of the input voltage, the circuit exhibits only gain error and dc offset.\n\n[Figure 13.22]\nFigure 13.22 shows the input/output characteristic of a sampling circuit when charge injection is present. The graph is a linear plot with two primary lines: one labeled \"Ideal\" and the other labeled \"With Charge Injection.\" The x-axis represents the input voltage $V_{in}$, while the y-axis represents the sampled output voltage $V_{out}$. Both axes are likely in volts, although specific units are not provided.\n\nThe \"Ideal\" line is a dashed line that passes through the origin, illustrating a direct proportional relationship between $V_{in}$ and $V_{out}$ with no offset or gain error. This line represents the expected behavior of the circuit without any charge injection.\n\nThe solid line labeled \"With Charge Injection\" deviates from the ideal line, indicating a gain error and a DC offset. The line is shifted downward, starting from a negative offset on the y-axis, labeled \"Offset,\" and has a slope greater than the ideal line, indicating a non-unity gain. This represents the effect of charge injection, which introduces both a constant offset voltage and a gain error in the output.\n\nOverall, the graph highlights the impact of charge injection on the circuit's performance, showing how the actual output deviates from the ideal linear relationship due to these effects.\n\nFigure 13.22 depicts the input/output characteristic of a sampling circuit in the presence of charge injection.\n\nIn the foregoing discussion, we tacitly assumed that $V_{T H}$ is constant. However, for NMOS switches (in an $n$-well technology), body effect must be taken into account. ${ }^{6}$ Since $V_{T H}=V_{T H 0}+\\gamma\\left(\\sqrt{2 \\phi_{B}+V_{S B}}-\\sqrt{2 \\phi_{B}}\\right)$,\n\n[^96]and $V_{B S} \\approx-V_{i n}$, we have\n\\$\\$\n\n$$\n\\begin{align*}\nV_{o u t}= & V_{i n}-\\frac{W L C_{o x}}{C_{H}}\\left(V_{D D}-V_{i n}-V_{T H 0}-\\gamma \\sqrt{2 \\phi_{B}+V_{i n}}+\\gamma \\sqrt{2 \\phi_{B}}\\right)  \\tag{13.29}\\\\\n= & V_{i n}\\left(1+\\frac{W L C_{o x}}{C_{H}}\\right)+\\gamma \\frac{W L C_{o x}}{C_{H}} \\sqrt{2 \\phi_{B}+V_{i n}} \\\\\n& -\\frac{W L C_{o x}}{C_{H}}\\left(V_{D D}-V_{T H 0}+\\gamma \\sqrt{2 \\phi_{B}}\\right) \\tag{13.30}\n\\end{align*}\n$$\n\n\\$\\$\n\nIt follows that the nonlinear dependence of $V_{T H}$ upon $V_{i n}$ introduces nonlinearity in the input/output characteristic.\n\nIn summary, charge injection contributes three types of errors in MOS sampling circuits: gain error, dc offsets, and nonlinearity. In many applications, the first two can be tolerated or corrected whereas the last cannot.\n\nIt is instructive to consider the speed-precision trade-off resulting from charge injection. Representing the speed by a simple time constant $\\tau$ and the precision by the error $\\Delta V$ due to charge injection, we define a figure of merit as $F=(\\tau \\Delta V)^{-1}$. Writing\n\n$$\n\\begin{align*}\n\\tau & =R_{o n} C_{H}  \\tag{13.31}\\\\\n& =\\frac{1}{\\mu_{n} C_{o x}(W / L)\\left(V_{D D}-V_{i n}-V_{T H}\\right)} C_{H} \\tag{13.32}\n\\end{align*}\n$$\n\nand\n\n$$\n\\begin{equation*}\n\\Delta V=\\frac{W L C_{o x}}{C_{H}}\\left(V_{D D}-V_{i n}-V_{T H}\\right) \\tag{13.33}\n\\end{equation*}\n$$\n\nwe have\n\n$$\n\\begin{equation*}\nF=\\frac{\\mu_{n}}{L^{2}} \\tag{13.34}\n\\end{equation*}\n$$\n\nThus, to the first order, the trade-off is independent of the switch width and the sampling capacitor.\n\nClock Feedthrough In addition to channel charge injection, a MOS switch couples the clock transitions to the sampling capacitor through its gate-drain or gate-source overlap capacitance. Depicted in Fig. 13.23, the effect introduces an error in the sampled output voltage. Assuming the overlap capacitance is constant, we express the error as\n\n$$\n\\begin{equation*}\n\\Delta V=V_{C K} \\frac{W C_{o v}}{W C_{o v}+C_{H}} \\tag{13.35}\n\\end{equation*}\n$$\n\n[Figure 13.23]\nThe circuit demonstrates clock feedthrough in a sampling circuit, where the NMOS transistor M1 introduces an error in the sampled output voltage due to overlap capacitance.\n\nFigure 13.23 illustrates clock feedthrough in a sampling circuit.\n\n$k T / C$ Noise Recall from Example 7.3 that a resistor charging a capacitor gives rise to a total rms noise voltage of $\\sqrt{k T / C}$. As shown in Fig. 13.24, a similar effect occurs in sampling circuits. The on-resistance of the switch introduces thermal noise at the output and, when the switch turns off, this noise is stored on the capacitor along with the instantaneous value of the input voltage. It can be proved that the rms voltage of the sampled noise in this case is still approximately equal to $\\sqrt{k T / C}[3,4]$.\n\n[Figure 13.24]\nThe circuit diagram shows a sampling circuit with thermal noise. The resistor Ron charges the capacitor CH, and when the switch is open, the resistor Ropen is introduced, leading to a noise voltage Vn added to the input voltage Vin at the output.\n\nFigure 13.24 depicts thermal noise in a sampling circuit.\n\nThe issue of $k T / C$ noise limits the performance in many high-precision applications. In order to achieve low noise, the sampling capacitor must be sufficiently large, thus loading other circuits and degrading the speed."
},
{
    "text": "The analysis of MOS switches in our previous research reveals that an increased $W / L$ ratio or a decreased sampling capacitor size leads to enhanced speed. This section will demonstrate that these speed-enhancing methods compromise the accuracy of signal sampling.\n\nWe examine three primary mechanisms during MOS transistor operation that contribute to errors at the moment the switch is turned off, analyzing each effect separately.\n\n[Figure 13.18] illustrates the distortion that occurs when complementary switches do not deactivate simultaneously. The figure is segmented into two main sections: the first part demonstrates the distortion created by the asynchronous deactivation of complementary switches, and the second part compares input and output waveforms.\n\nThe graph in the first section is a time-domain waveform depicting the behavior of complementary clock signals and their impact on input and output voltages. The horizontal axis represents time ('t'), without specified units, and the vertical axis, though not labeled, indicates voltage levels for the clock signals and input/output voltages.\n\nThe first part of the graph illustrates two complementary clock signals, CK and \\(\\overline{CK}\\), intersecting with a slight time difference \\(\\Delta t\\). This indicates that the switches do not turn off at precisely the same moment, resulting in a timing discrepancy. The second part of the graph displays the input voltage \\(V_{in}\\) as a sinusoidal waveform and the output voltage \\(V_{out}\\) following a similar pattern but with evident distortion. The output voltage deviates from the ideal value, indicated by a dashed line.\n\nKey aspects and technical details include the timing mismatch \\(\\Delta t\\) between the complementary clock signals, which is critical for understanding the output distortion. The distortion in \\(V_{out}\\) is represented as a deviation from the ideal value, emphasizing the impact of asynchronous switch-off on signal integrity. Annotations and specific data points highlight \\(\\Delta t\\) on the clock signal graph, emphasizing the timing discrepancy, and the ideal value of \\(V_{out}\\) is marked as a dashed line, depicting the expected behavior without distortion.\n\n[Figure 13.18] also consists of two main parts: the top part illustrates complementary clock signals, and the bottom part depicts a comparison between input and output waveforms.\n\nThe top graph is a timing diagram showing the relationship between two complementary clock signals, labeled as CK and \\( \\overline{CK} \\). The bottom graph is a time-domain waveform comparison, showing input (\\( V_{in} \\)) and output (\\( V_{out} \\)) voltages over time.\n\nThe horizontal axis in both graphs represents time (t), without specific units. The vertical axis in the top graph represents the logic levels of the clock signals CK and \\( \\overline{CK} \\). The vertical axis in the bottom graph represents voltage levels for \\( V_{in} \\) and \\( V_{out} \\), without specific voltage units.\n\nIn the top graph, CK and \\( \\overline{CK} \\) are complementary signals with a crossover point, indicating a non-zero delay (\\( \\Delta t \\)) between their transitions. In the bottom graph, \\( V_{in} \\) is a sinusoidal waveform, while \\( V_{out} \\) follows a similar shape but is slightly distorted, with a noticeable deviation from the ideal value at certain points.\n\nKey features and technical details include the delay \\( \\Delta t \\) between the falling edge of CK and the rising edge of \\( \\overline{CK} \\), which is crucial in timing analysis. The bottom graph shows that \\( V_{out} \\) does not perfectly follow \\( V_{in} \\), indicating some form of distortion or error introduced in the signal processing. The ideal value for \\( V_{out} \\) is marked with a dashed line, showing where the output should ideally align with the input.\n\n[Figure 13.19] shows a simple circuit designed to generate complementary clock signals CK and CK_bar from the input clock CKin using an NMOS transistor and an inverter.\n\nChannel Charge Injection: Considering the sampling circuit of [Figure 13.20], and recalling that for a MOSFET to be on, a channel must exist at the oxide-silicon interface. Assuming that $V_{\\text {in }} \\approx V_{\\text {out }}$, we use our derivations in Chapter 2 to express the total charge in the inversion layer as:\n\n$$\nQ_{c h}=W L C_{o x}\\left(V_{D D}-V_{i n}-V_{T H}\\right)\n$$\n\nwhere $L$ denotes the effective channel length. When the switch turns off, $Q_{c h}$ exits through the source and drain terminals, a phenomenon called \"channel charge injection.\"\n\n[Figure 13.20] illustrates charge injection when a switch turns off, affecting the voltage across the capacitor CH. The NMOS transistor M1 is controlled by the clock signal CK, allowing charge to flow from Vin to Vout when on. When M1 turns off, charge injection occurs, potentially causing an error voltage on CH.\n\nThe charge injected to the left side of [Figure 13.20] is absorbed by the input source, creating no error. On the other hand, the charge injected to the right side is deposited on $C_{H}$, introducing an error in the voltage stored on the capacitor. For example, if half of $Q_{c h}$ is injected onto $C_{H}$, the resulting error equals:\n\n$$\n\\Delta V=\\frac{W L C_{o x}\\left(V_{D D}-V_{i n}-V_{T H}\\right)}{2 C_{H}}\n$$\n\n[Figure 13.21] illustrates the effect of charge injection in a circuit using an NMOS switch. The diagram is composed of three main parts:\n\n1. Input Waveform (Left Side): The left side of the figure shows an input sinusoidal waveform labeled as $V_{in}$. This waveform represents the input voltage to the circuit. The sinusoidal shape indicates a periodic oscillation, typical of alternating current (AC) signals.\n\n2. Circuit Diagram (Center): At the center of the figure, there is a schematic of a simple circuit involving an NMOS transistor labeled as $M_1$. The gate of the transistor is controlled by a clock signal labeled \"CK,\" represented by a square waveform. This suggests that the transistor is being switched on and off periodically. The source of the transistor is connected to the input voltage $V_{in}$, and the drain is connected to the output $V_{out}$. A capacitor labeled $C_{H}$ is connected between the output $V_{out}$ and ground (GND), which stores charge when the transistor is conducting.\n\n3. Output Waveform (Right Side): The right side of the figure shows the output waveform $V_{out}$, which is a sinusoidal wave similar to the input but with a noticeable negative \"pedestal\" or dip, labeled as $\\Delta V$. This indicates the error introduced by charge injection when the transistor switches. The dip in the waveform corresponds to the moment when the transistor turns off, and part of the channel charge is injected onto the capacitor $C_{H}$, leading to a temporary voltage drop.\n\nOverall, the figure demonstrates how charge injection from the NMOS switch affects the output voltage, creating a negative voltage error (pedestal) at the output. This error is proportional to the dimensions of the transistor ($WL$) and the oxide capacitance ($C_{ox}$), and inversely proportional to the holding capacitance ($C_{H}$), as described by the equation provided in the context.\n\nAn important question arises: Why did we assume in arriving at the equation that exactly half of the channel charge is injected onto $C_{H}$? In reality, the fraction of charge that exits through the source and drain terminals is a relatively complex function of various parameters, such as the impedance seen at each terminal to ground and the transition time of the clock. Investigations of this effect have not yielded any rule of thumb that can predict the charge splitting in terms of such parameters. Furthermore, in many cases, these parameters, e.g., the clock transition time, are poorly controlled. Also, most circuit simulation programs model charge injection quite inaccurately. As a worst-case estimate, we can assume that the entire channel charge is injected onto the sampling capacitor.\n\nHow does charge injection affect the precision? Assuming that all of the charge is deposited on the capacitor, we express the sampled output voltage as:\n\n$$\nV_{\\text {out }} \\approx V_{\\text {in }}-\\frac{W L C_{o x}\\left(V_{D D}-V_{\\text {in }}-V_{T H}\\right)}{C_{H}}\n$$\n\nwhere the phase shift between the input and the output is neglected. Thus:\n\n$$\nV_{o u t}=V_{i n}\\left(1+\\frac{W L C_{o x}}{C_{H}}\\right)-\\frac{W L C_{o x}}{C_{H}}\\left(V_{D D}-V_{T H}\\right)\n$$\n\nsuggesting that the output deviates from the ideal value through two effects: a nonunity gain equal to $1+W L C_{o x} / C_{H}$ and a constant offset voltage $-W L C_{o x}\\left(V_{D D}-V_{T H}\\right) / C_{H}$ ([Figure 13.22]). In other words, since we have assumed that channel charge is a linear function of the input voltage, the circuit exhibits only gain error and dc offset.\n\n[Figure 13.22] shows the input/output characteristic of a sampling circuit when charge injection is present. The graph is a linear plot with two primary lines: one labeled \"Ideal\" and the other labeled \"With Charge Injection.\" The x-axis represents the input voltage $V_{in}$, while the y-axis represents the sampled output voltage $V_{out}$. Both axes are likely in volts, although specific units are not provided.\n\nThe \"Ideal\" line is a dashed line that passes through the origin, illustrating a direct proportional relationship between $V_{in}$ and $V_{out}$ with no offset or gain error. This line represents the expected behavior of the circuit without any charge injection.\n\nThe solid line labeled \"With Charge Injection\" deviates from the ideal line, indicating a gain error and a DC offset. The line is shifted downward, starting from a negative offset on the y-axis, labeled \"Offset,\" and has a slope greater than the ideal line, indicating a non-unity gain. This represents the effect of charge injection, which introduces both a constant offset voltage and a gain error in the output.\n\nOverall, the graph highlights the impact of charge injection on the circuit's performance, showing how the actual output deviates from the ideal linear relationship due to these effects.\n\nIn the foregoing discussion, we tacitly assumed that $V_{T H}$ is constant. However, for NMOS switches (in an $n$-well technology), body effect must be taken into account. Since $V_{T H}=V_{T H 0}+\\gamma\\left(\\sqrt{2 \\phi_{B}+V_{S B}}-\\sqrt{2 \\phi_{B}}\\right)$,\n\nand $V_{B S} \\approx-V_{i n}$, we have:\n\n$$\nV_{o u t}= V_{i n}-\\frac{W L C_{o x}}{C_{H}}\\left(V_{D D}-V_{i n}-V_{T H 0}-\\gamma \\sqrt{2 \\phi_{B}+V_{i n}}+\\gamma \\sqrt{2 \\phi_{B}}\\right)\n$$\n\n$$\n= V_{i n}\\left(1+\\frac{W L C_{o x}}{C_{H}}\\right)+\\gamma \\frac{W L C_{o x}}{C_{H}} \\sqrt{2 \\phi_{B}+V_{i n}} -\\frac{W L C_{o x}}{C_{H}}\\left(V_{D D}-V_{T H 0}+\\gamma \\sqrt{2 \\phi_{B}}\\right)\n$$\n\nIt follows that the nonlinear dependence of $V_{T H}$ upon $V_{i n}$ introduces nonlinearity in the input/output characteristic.\n\nIn summary, charge injection contributes three types of errors in MOS sampling circuits: gain error, dc offsets, and nonlinearity. In many applications, the first two can be tolerated or corrected whereas the last cannot.\n\nIt is instructive to consider the speed-precision trade-off resulting from charge injection. Representing the speed by a simple time constant \\(\\tau\\) and the precision by the error \\(\\Delta V\\) due to charge injection, we define a figure of merit as \\(F=(\\tau \\Delta V)^{-1}\\). Writing:\n\n$$\n\\tau =R_{o n} C_{H}\n$$\n\n$$\n= \\frac{1}{\\mu_{n} C_{o x}(W / L)\\left(V_{D D}-V_{i n}-V_{T H}\\right)} C_{H}\n$$\n\nand\n\n$$\n\\Delta V=\\frac{W L C_{o x}}{C_{H}}\\left(V_{D D}-V_{i n}-V_{T H}\\right)\n$$\n\nwe have:\n\n$$\nF=\\frac{\\mu_{n}}{L^{2}}\n$$\n\nThus, to the first order, the trade-off is independent of the switch width and the sampling capacitor.\n\nClock Feedthrough: In addition to channel charge injection, a MOS switch couples the clock transitions to the sampling capacitor through its gate-drain or gate-source overlap capacitance. Depicted in [Figure 13.23], the effect introduces an error in the sampled output voltage. Assuming the overlap capacitance is constant, we express the error as:\n\n$$\n\\Delta V=V_{C K} \\frac{W C_{o v}}{W C_{o v}+C_{H}}\n$$\n\n[Figure 13.23] demonstrates clock feedthrough in a sampling circuit, where the NMOS transistor M1 introduces an error in the sampled output voltage due to overlap capacitance.\n\nThe error \\(\\Delta V\\) is independent of the input level, manifesting itself as a constant offset in the input/output characteristic. As with charge injection, clock feedthrough leads to a trade-off between speed and precision as well.\n\n$\\boldsymbol{k T} / \\mathbf{C}$ Noise: Recall from Example 7.3 that a resistor charging a capacitor gives rise to a total rms noise voltage of \\(\\sqrt{k T / C}\\). As shown in [Figure 13.24], a similar effect occurs in sampling circuits. The on-resistance of the switch introduces thermal noise at the output, and when the switch turns off, this noise is stored on the capacitor along with the instantaneous value of the input voltage. It can be proved that the rms voltage of the sampled noise in this case is still approximately equal to \\(\\sqrt{k T / C}\\).\n\n[Figure 13.24] shows a sampling circuit with thermal noise. The resistor Ron charges the capacitor CH, and when the switch is open, the resistor Ropen is introduced, leading to a noise voltage Vn added to the input voltage Vin at the output.\n\nThe problem of $k T / C$ noise limits the performance in many high-precision applications. In order to achieve low noise, the sampling capacitor must be sufficiently large, thus loading other circuits and degrading the speed."
},
{
    "text": "The analysis of Metal-Oxide-Semiconductor (MOS) switches from our previous research reveals that an increase in the ratio of channel width to length ($W/L$) or a reduction in the sampling capacitor size leads to a higher operational speed. However, this section will demonstrate that these speed-enhancing methods come at the cost of decreased sampling precision.\n\nOur investigation identifies three primary mechanisms during MOS transistor operation that introduce sampling errors when the switch is turned off. We will examine each of these effects separately.\n\nFigure 13.18 visually represents the distortion that occurs when complementary switches do not shut off at the same time. The figure is divided into two main sections: the first part displays a time-domain waveform illustrating the behavior of complementary clock signals and their impact on input and output voltages, and the second part compares the input voltage ($V_{in}$) as a sinusoidal waveform to the distorted output voltage ($V_{out}$).\n\nKey observations include the timing mismatch ($\\Delta t$) between the complementary clock signals CK and $\\overline{CK}$, which leads to a distorted output voltage that deviates from the ideal value indicated by a dashed line.\n\nFigure 13.19 shows a simple circuit designed to generate complementary clock signals CK and CK_bar from the input clock CKin using an NMOS transistor and an inverter.\n\nConsidering the sampling circuit in Figure 13.20, we must remember that for a MOSFET to be in an 'on' state, a channel must exist at the oxide-silicon interface. Assuming $V_{in} \\approx V_{out}$, we utilize our derivations from Chapter 2 to express the total charge in the inversion layer as $Q_{ch} = WLC_{ox}(V_{DD} - V_{in} - V_{TH})$.\n\nWhen the switch is turned off, $Q_{ch}$ exits through the source and drain terminals, a phenomenon known as \"channel charge injection.\" The charge injected to the left side of Figure 13.20 is absorbed by the input source, causing no error. However, the charge injected to the right side is deposited on $C_{H}$, introducing an error in the voltage stored on the capacitor.\n\nFor instance, if half of $Q_{ch}$ is injected onto $C_{H}$, the resulting error is $\\Delta V = \\frac{WLC_{ox}(V_{DD} - V_{in} - V_{TH})}{2C_{H}}$. Figure 13.21 illustrates the effect of charge injection, showing an error for an NMOS switch as a negative \"pedestal\" at the output. This error is directly proportional to $WLC_{ox}$ and inversely proportional to $C_{H}$.\n\nThe assumption that exactly half of the channel charge is injected onto $C_{H}$ is discussed, with the recognition that the fraction\nThe analysis from our previous study on MOS switches indicates that an increase in the $W/L$ ratio or a decrease in the sampling capacitor size results in higher speed. However, this section will demonstrate that these methods of increasing speed come at the cost of decreased sampling precision.\n\nWe will examine three primary mechanisms during MOS transistor operation that introduce sampling errors when the switch is turned off. Each of these effects will be studied separately.\n\nFigure 13.18 visually represents the distortion that occurs when complementary switches do not shut off at the same time. The figure is divided into two main sections: the first part displays a time-domain waveform illustrating the behavior of complementary clock signals and their impact on input and output voltages, and the second part compares the input voltage ($V_{in}$) as a sinusoidal waveform to the distorted output voltage ($V_{out}$).\n\nKey observations include the timing mismatch ($\\Delta t$) between the complementary clock signals CK and $\\overline{CK}$, which leads to a distorted output voltage that deviates from the ideal value indicated by a dashed line.\n\nFigure 13.19 shows a simple circuit designed to generate complementary clock signals CK and CK_bar from the input clock CKin using an NMOS transistor and an inverter.\n\nConsidering the sampling circuit in Figure 13.20, we must remember that for a MOSFET to be in an 'on' state, a channel must exist at the oxide-silicon interface. Assuming $V_{in} \\approx V_{out}$, we utilize our derivations from Chapter 2 to express the total charge in the inversion layer as $Q_{ch} = WLC_{ox}(V_{DD} - V_{in} - V_{TH})$.\n\nWhen the switch is turned off, $Q_{ch}$ exits through the source and drain terminals, a phenomenon known as \"channel charge injection.\" The charge injected to the left side of Figure 13.20 is absorbed by the input source, causing no error. However, the charge injected to the right side is deposited on $C_{H}$, introducing an error in the voltage stored on the capacitor.\n\nFor instance, if half of $Q_{ch}$ is injected onto $C_{H}$, the resulting error is $\\Delta V = \\frac{WLC_{ox}(V_{DD} - V_{in} - V_{TH})}{2C_{H}}$. Figure 13.21 illustrates the effect of charge injection, showing an error for an NMOS switch as a negative \"pedestal\" at the output. This error is directly proportional to $WLC_{ox}$ and inversely proportional to $C_{H}$.\n\nThe assumption that exactly half of the channel charge is injected onto $C_{H}$ is discussed, with the recognition that the"
},
{
    "text": "Our prior research on MOS switches suggests that increasing the $W/L$ ratio or decreasing the sampling capacitor size leads to higher speed. However, this section demonstrates that these speed-increasing methods compromise the precision of the signal sampling.\n\nThere are three mechanisms in MOS transistor operation that introduce error at the moment the switch is turned off. We examine each of these effects separately.\n\nFigure 13.18 depicts a graph with two main sections, illustrating the distortion that occurs when complementary switches do not turn off simultaneously.\n\n1. **Graph Type and Function:**\n   - The graph is a time-domain waveform, depicting the behavior of complementary clock signals and their impact on input and output voltages.\n\n2. **Axes Labels and Units:**\n   - The horizontal axis represents time (denoted as 't'), with no specific units provided.\n   - The vertical axis, though not explicitly labeled, represents voltage levels for the clock signals and input/output voltages.\n\n3. **Overall Behavior and Trends:**\n   - The first section of the graph shows two complementary clock signals, CK and \\(\\overline{CK}\\), crossing each other with a small time difference \\(\\Delta t\\). This indicates that the switches do not turn off at the exact same time, resulting in a timing mismatch.\n   - The second section of the graph shows the input voltage \\(V_{in}\\) as a sinusoidal waveform and the output voltage \\(V_{out}\\) following a similar pattern but with noticeable distortion. The output voltage deviates from an ideal value, indicated by a dashed line.\n\n4. **Key Features and Technical Details:**\n   - The key feature is the timing mismatch \\(\\Delta t\\) between the complementary clock signals, which is crucial for understanding the distortion at the output.\n   - The distortion in \\(V_{out}\\) is depicted as a deviation from the ideal value, highlighting the impact of non-simultaneous switch-off on signal integrity.\n\n5. **Annotations and Specific Data Points:**\n   - \\(\\Delta t\\) is annotated on the clock signal graph, emphasizing the timing difference.\n   - The ideal value of \\(V_{out}\\) is marked as a dashed line, showing the expected behavior without distortion.\n\nFigure 13.18 illustrates the distortion generated if complementary switches do not turn off simultaneously.\n\nFigure 13.19 shows a simple circuit designed to generate complementary clock signals CK and CK_bar from the input clock CKin using an NMOS transistor and an inverter.\n\nConsider the sampling circuit in Figure 13.20, and recall that for a MOSFET to be on, a channel must exist at the oxide-silicon interface. Assuming that $V_{\\text {in }} \\approx V_{\\text {out }}$, we use our derivations in Chapter 2 to express the total charge in the inversion layer as\n\n$$\n\\begin{equation*}\nQ_{c h}=W L C_{o x}\\left(V_{D D}-V_{i n}-V_{T H}\\right) \\tag{13.25}\n\\end{equation*}\n$$\n\nwhere $L$ denotes the effective channel length. When the switch turns off, $Q_{c h}$ exits through the source and drain terminals, a phenomenon called \"channel charge injection.\"\n\nFigure 13.20 illustrates charge injection when a switch turns off, affecting the voltage across the capacitor CH. The NMOS transistor M1 is controlled by the clock signal CK, allowing charge to flow from Vin to Vout when on. When M1 turns off, charge injection occurs, potentially causing an error voltage on CH.\n\nThe charge injected to the left side of Figure 13.20 is absorbed by the input source, creating no error. On the other hand, the charge injected to the right side is deposited on $C_{H}$, introducing an error in the voltage stored on the capacitor. For example, if half of $Q_{c h}$ is injected onto $C_{H}$, the resulting error equals\n\n$$\n\\begin{equation*}\n\\Delta V=\\frac{W L C_{o x}\\left(V_{D D}-V_{i n}-V_{T H}\\right)}{2 C_{H}} \\tag{13.26}\n\\end{equation*}\n$$\n\nFigure 13.21 illustrates the effect of charge injection. The graph shows the effect of charge injection in a circuit using an NMOS switch. The diagram is composed of three main parts:\n\n1. **Input Waveform (Left Side):**\n   - The left side of the figure shows an input sinusoidal waveform labeled as $V_{in}$. This waveform represents the input voltage to the circuit. The sinusoidal shape indicates a periodic oscillation, typical of alternating current (AC) signals.\n\n2. **Circuit Diagram (Center):**\n   - At the center of the figure, there is a schematic of a simple circuit involving an NMOS transistor labeled as $M_1$. The gate of the transistor is controlled by a clock signal labeled \"CK,\" represented by a square waveform. This suggests that the transistor is being switched on and off periodically.\n   - The source of the transistor is connected to the input voltage $V_{in}$, and the drain is connected to the output $V_{out}$.\n   - A capacitor labeled $C_{H}$ is connected between the output $V_{out}$ and ground (GND), which stores charge when the transistor is conducting.\n\n3. **Output Waveform (Right Side):**\n   - The right side of the figure shows the output waveform $V_{out}$, which is a sinusoidal wave similar to the input but with a noticeable negative \"pedestal\" or dip, labeled as $\\Delta V$. This indicates the error introduced by charge injection when the transistor switches.\n   - The dip in the waveform corresponds to the moment when the transistor turns off, and part of the channel charge is injected onto the capacitor $C_{H}$, leading to a temporary voltage drop.\n\nOverall, the figure demonstrates how charge injection from the NMOS switch affects the output voltage, creating a negative voltage error (pedestal) at the output. This error is proportional to the dimensions of the transistor ($WL$) and the oxide capacitance ($C_{ox}$), and inversely proportional to the holding capacitance ($C_{H}$), as described by the equation provided in the context.\n\nAn important question that arises now is-Why did we assume in arriving at (13.26) that exactly half of the channel charge is injected onto $C_{H}$ ? In reality, the fraction of charge that exits through the source and drain terminals is a relatively complex function of various parameters, such as the impedance seen at each terminal to ground and the transition time of the clock [1, 2]. Investigations of this effect have not yielded any rule of thumb that can predict the charge splitting in terms of such parameters. Furthermore, in many cases, these parameters, e.g., the clock transition time, are poorly controlled. Also, most circuit simulation programs model charge injection quite inaccurately. As a worst-case estimate, we can assume that the entire channel charge is injected onto the sampling capacitor.\n\nHow does charge injection affect the precision? Assuming that all of the charge is deposited on the capacitor, we express the sampled output voltage as\n\n$$\n\\begin{equation*}\nV_{\\text {out }} \\approx V_{\\text {in }}-\\frac{W L C_{o x}\\left(V_{D D}-V_{\\text {in }}-V_{T H}\\right)}{C_{H}} \\tag{13.27}\n\\end{equation*}\n$$\n\nwhere the phase shift between the input and the output is neglected. Thus,\n\n$$\n\\begin{equation*}\nV_{o u t}=V_{i n}\\left(1+\\frac{W L C_{o x}}{C_{H}}\\right)-\\frac{W L C_{o x}}{C_{H}}\\left(V_{D D}-V_{T H}\\right) \\tag{13.28}\n\\end{equation*}\n$$\n\nsuggesting that the output deviates from the ideal value through two effects: a nonunity gain equal to $1+W L C_{o x} / C_{H},{ }^{5}$ and a constant offset voltage $-W L C_{o x}\\left(V_{D D}-V_{T H}\\right) / C_{H}$ (Figure 13.22). In other words, since we have assumed that channel charge is a linear function of the input voltage, the circuit exhibits only gain error and dc offset.\n\nFigure 13.22 shows the input/output characteristic of a sampling circuit when charge injection is present. The graph is a linear plot with two primary lines: one labeled \"Ideal\" and the other labeled \"With Charge Injection.\" The x-axis represents the input voltage $V_{in}$, while the y-axis represents the sampled output voltage $V_{out}$. Both axes are likely in volts, although specific units are not provided.\n\nThe \"Ideal\" line is a dashed line that passes through the origin, illustrating a direct proportional relationship between $V_{in}$ and $V_{out}$ with no offset or gain error. This line represents the expected behavior of the circuit without any charge injection.\n\nThe solid line labeled \"With Charge Injection\" deviates from the ideal line, indicating a gain error and a DC offset. The line is shifted downward, starting from a negative offset on the y-axis, labeled \"Offset,\" and has a slope greater than the ideal line, indicating a non-unity gain. This represents the effect of charge injection, which introduces both a constant offset voltage and a gain error in the output.\n\nOverall, the graph highlights the impact of charge injection on the circuit's performance, showing how the actual output deviates from the ideal linear relationship due to these effects.\n\nIn the foregoing discussion, we tacitly assumed that $V_{T H}$ is constant. However, for NMOS switches (in an $n$-well technology), body effect must be taken into account. ${ }^{6}$ Since $V_{T H}=V_{T H 0}+\\gamma\\left(\\sqrt{2 \\phi_{B}+V_{S B}}-\\sqrt{2 \\phi_{B}}\\right)$,\n\n[^96]and $V_{B S} \\approx-V_{i n}$, we have\n\\$\\$\n\n$$\n\\begin{align*}\nV_{o u t}= & V_{i n}-\\frac{W L C_{o x}}{C_{H}}\\left(V_{D D}-V_{i n}-V_{T H 0}-\\gamma \\sqrt{2 \\phi_{B}+V_{i n}}+\\gamma \\sqrt{2 \\phi_{B}}\\right)  \\tag{13.29}\\\\\n= & V_{i n}\\left(1+\\frac{W L C_{o x}}{C_{H}}\\right)+\\gamma \\frac{W L C_{o x}}{C_{H}} \\sqrt{2 \\phi_{B}+V_{i n}} \\\\\n& -\\frac{W L C_{o x}}{C_{H}}\\left(V_{D D}-V_{T H 0}+\\gamma \\sqrt{2 \\phi_{B}}\\right) \\tag{13.30}\n\\end{align*}\n$$\n\n\\$\\$\n\nIt follows that the nonlinear dependence of $V_{T H}$ upon $V_{i n}$ introduces nonlinearity in the input/output characteristic.\n\nIn summary, charge injection contributes three types of errors in MOS sampling circuits: gain error, dc offsets, and nonlinearity. In many applications, the first two can be tolerated or corrected whereas the last cannot.\n\nIt is instructive to consider the speed-precision trade-off resulting from charge injection. Representing the speed by a simple time constant $\\tau$ and the precision by the error $\\Delta V$ due to charge injection, we define a figure of merit as $F=(\\tau \\Delta V)^{-1}$. Writing\n\n$$\n\\begin{align*}\n\\tau & =R_{o n} C_{H}  \\tag{13.31}\\\\\n& =\\frac{1}{\\mu_{n} C_{o x}(W / L)\\left(V_{D D}-V_{i n}-V_{T H}\\right)} C_{H} \\tag{13.32}\n\\end{align*}\n$$\n\nand\n\n$$\n\\begin{equation*}\n\\Delta V=\\frac{W L C_{o x}}{C_{H}}\\left(V_{D D}-V_{i n}-V_{T H}\\right) \\tag{13.33}\n\\end{equation*}\n$$\n\nwe have\n\n$$\n\\begin{equation*}\nF=\\frac{\\mu_{n}}{L^{2}} \\tag{13.34}\n\\end{equation*}\n$$\n\nThus, to the first order, the trade-off is independent of the switch width and the sampling capacitor.\n\nIn addition to channel charge injection, a MOS switch couples the clock transitions to the sampling capacitor through its gate-drain or gate-source overlap capacitance. Depicted in Figure 13.23, this effect introduces an error in the sampled output voltage. Assuming the overlap capacitance is constant, we express the error as\n\n$$\n\\begin{equation*}\n\\Delta V=V_{C K} \\frac{W C_{o v}}{W C_{o v}+C_{H}} \\tag{13.35}\n\\end{equation*}\n$$\n\nFigure 13.23 illustrates clock feedthrough in a sampling circuit. The circuit demonstrates clock feedthrough in a sampling circuit, where the NMOS transistor M1 introduces an error in the sampled output voltage due to overlap capacitance.\n\nFigure 13.23 shows clock feedthrough in a sampling circuit.\nwhere $C_{o v}$ is the overlap capacitance per unit width. The error $\\Delta V$ is independent of the input level, manifesting itself as a constant offset in the input/output characteristic. As with charge injection, clock feedthrough leads to a trade-off between speed and precision as well.\n\nRecall from Example 7.3 that a resistor charging a capacitor gives rise to a total rms noise voltage of $\\sqrt{k T / C}$. As shown in Figure 13.24, a similar effect occurs in sampling circuits. The on-resistance of the switch introduces thermal noise at the output, and when the switch turns off, this noise is stored on the capacitor along with the instantaneous value of the input voltage. It can be proved that the rms voltage of the sampled noise in this case is still approximately equal to $\\sqrt{k T / C}[3,4]$.\n\nFigure 13.24 illustrates thermal noise in a sampling circuit. The circuit diagram shows a sampling circuit with thermal noise. The resistor Ron charges the capacitor CH, and when the switch is open, the resistor Ropen is introduced, leading to a noise voltage Vn added to the input voltage Vin at the output.\n\nFigure 13.24 shows thermal noise in a sampling circuit.\nThe problem of $k T / C$ noise limits the performance in many high-precision applications. In order to achieve low noise, the sampling capacitor must be sufficiently large, thus loading other circuits and degrading the speed."
},
{
    "text": "Our initial analysis of MOS switches suggests that a higher speed can be achieved through an increased $W / L$ ratio or a reduced sampling capacitor size. However, this section reveals that these speed-increasing methods come at the cost of sampling precision.\n\nThere are three primary mechanisms during MOS transistor operation that introduce error when the switch is turned off. We examine each of these effects separately.\n\nThe graph in Figure 13.18, which is divided into two main sections, illustrates the distortion that occurs when complementary switches do not deactivate simultaneously.\n\n1. **Graph Type and Function:**\n   - The graph represents a time-domain waveform, depicting the behavior of complementary clock signals and their impact on input and output voltages.\n\n2. **Axes Labels and Units:**\n   - The horizontal axis indicates time ('t'), with no specific units given.\n   - The vertical axis, unlabeled, represents voltage levels for the clock signals and input/output voltages.\n\n3. **Overall Behavior and Trends:**\n   - The first section of the graph shows two complementary clock signals, CK and \\(\\overline{CK}\\), intersecting with a small time difference \\(\\Delta t\\). This indicates that the switches do not turn off at precisely the same moment, resulting in a timing mismatch.\n   - The second section of the graph displays the input voltage \\(V_{in}\\) as a sinusoidal waveform and the output voltage \\(V_{out}\\) following a similar pattern but with evident distortion. The output voltage deviates from the ideal value, indicated by a dashed line.\n\n4. **Key Features and Technical Details:**\n   - The key feature here is the timing mismatch \\(\\Delta t\\) between the complementary clock signals, which is crucial for understanding the distortion at the output.\n   - The distortion in \\(V_{out}\\) is shown as a deviation from the ideal value, highlighting the impact of non-simultaneous switch-off on signal integrity.\n\n5. **Annotations and Specific Data Points:**\n   - \\(\\Delta t\\) is annotated on the clock signal graph, emphasizing the timing difference.\n   - The ideal value of \\(V_{out}\\) is marked as a dashed line, showing the expected behavior without distortion.\n\nFigure 13.18 also consists of two main parts: the top part illustrates complementary clock signals, and the bottom part depicts a comparison between input and output waveforms.\n\n1. **Type of Graph and Function:**\n   - The top graph is a timing diagram depicting the relationship between two complementary clock signals, labeled as CK and \\( \\overline{CK} \\).\n   - The bottom graph is a time-domain waveform comparison, showing input (\\( V_{in} \\)) and output (\\( V_{out} \\)) voltages over time.\n\n2. **Axes Labels and Units:**\n   - The horizontal axis in both graphs represents time (t), with no specific units given.\n   - The vertical axis in the top graph represents the logic levels of the clock signals CK and \\( \\overline{CK} \\).\n   - The vertical axis in the bottom graph represents voltage levels for \\( V_{in} \\) and \\( V_{out} \\), with no specific voltage units given.\n\n3. **Overall Behavior and Trends:**\n   - In the top graph, CK and \\( \\overline{CK} \\) are complementary signals with a crossover point, indicating a non-zero delay (\\( \\Delta t \\)) between their transitions.\n   - In the bottom graph, \\( V_{in} \\) is a sinusoidal waveform, while \\( V_{out} \\) follows a similar shape but is slightly distorted, with a noticeable deviation from the ideal value at certain points.\n\n4. **Key Features and Technical Details:**\n   - The top graph highlights the delay \\( \\Delta t \\) between the falling edge of CK and the rising edge of \\( \\overline{CK} \\), which is a critical parameter in timing analysis.\n   - The bottom graph shows that \\( V_{out} \\) does not perfectly follow \\( V_{in} \\), indicating some form of distortion or error introduced in the signal processing.\n   - The ideal value for \\( V_{out} \\) is marked with a dashed line, showing where the output should ideally align with the input.\n\n5. **Annotations and Specific Data Points:**\n   - The top graph includes an annotation for \\( \\Delta t \\), emphasizing the timing mismatch between the complementary clocks.\n   - The bottom graph includes an annotation for the \"Ideal Value\" of \\( V_{out} \\), highlighting the discrepancy between the actual and expected output.\n\nFigure 13.18 illustrates the distortion generated when complementary switches do not turn off simultaneously.\n\nFigure 13.19 shows a simple circuit designed to generate complementary clock signals CK and CK_bar from the input clock CKin using an NMOS transistor and an inverter.\n\nConsider the sampling circuit in Figure 13.20, and recall that for a MOSFET to be on, a channel must exist at the oxide-silicon interface. Assuming that $V_{\\text {in }} \\approx V_{\\text {out }}$, we use our derivations in Chapter 2 to express the total charge in the inversion layer as:\n\n$$\nQ_{c h}=W L C_{o x}\\left(V_{D D}-V_{i n}-V_{T H}\\right)\n$$\n\nwhere $L$ denotes the effective channel length. When the switch turns off, $Q_{c h}$ exits through the source and drain terminals, a phenomenon called \"channel charge injection.\"\n\nThe circuit in Figure 13.20 illustrates charge injection when a switch turns off, affecting the voltage across the capacitor CH. The NMOS transistor M1 is controlled by the clock signal CK, allowing charge to flow from Vin to Vout when on. When M1 turns off, charge injection occurs, potentially causing an error voltage on CH.\n\nThe charge injected to the left side of Figure 13.20 is absorbed by the input source, creating no error. On the other hand, the charge injected to the right side is deposited on $C_{H}$, introducing an error in the voltage stored on the capacitor. For example, if half of $Q_{c h}$ is injected onto $C_{H}$, the resulting error equals:\n\n$$\n\\Delta V=\\frac{W L C_{o x}\\left(V_{D D}-V_{i n}-V_{T H}\\right)}{2 C_{H}}\n$$\n\nIllustrated in Figure 13.21, the error for an NMOS switch appears as a negative \"pedestal\" at the output. Note that the error is directly proportional to $W L C_{o x}$ and inversely proportional to $C_{H}$.\n\nFigure 13.21 depicts the effect of charge injection. The graph shows the input/output characteristic of a sampling circuit when charge injection is present. The graph is a linear plot with two primary lines: one labeled \"Ideal\" and the other labeled \"With Charge Injection.\" The x-axis represents the input voltage $V_{in}$, while the y-axis represents the sampled output voltage $V_{out}$. Both axes are likely in volts, although specific units are not provided.\n\nThe \"Ideal\" line is a dashed line that passes through the origin, illustrating a direct proportional relationship between $V_{in}$ and $V_{out}$ with no offset or gain error. This line represents the expected behavior of the circuit without any charge injection.\n\nThe solid line labeled \"With Charge Injection\" deviates from the ideal line, indicating a gain error and a DC offset. The line is shifted downward, starting from a negative offset on the y-axis, labeled \"Offset,\" and has a slope greater than the ideal line, indicating a non-unity gain. This represents the effect of charge injection, which introduces both a constant offset voltage and a gain error in the output.\n\nOverall, the graph highlights the impact of charge injection on the circuit's performance, showing how the actual output deviates from the ideal linear relationship due to these effects.\n\nIn the preceding discussion, we tacitly assumed that $V_{T H}$ is constant. However, for NMOS switches (in an $n$-well technology), body effect must be taken into account. Since $V_{T H}=V_{T H 0}+\\gamma\\left(\\sqrt{2 \\phi_{B}+V_{S B}}-\\sqrt{2 \\phi_{B}}\\right)$,\n\nand $V_{B S} \\approx-V_{i n}$, we have:\n\n$$\nV_{o u t}=V_{i n}-\\frac{W L C_{o x}}{C_{H}}\\left(V_{D D}-V_{i n}-V_{T H 0}-\\gamma \\sqrt{2 \\phi_{B}+V_{i n}}+\\gamma \\sqrt{2 \\phi_{B}}\\right)\n$$\n\nIt follows that the nonlinear dependence of $V_{T H}$ upon $V_{i n}$ introduces nonlinearity in the input/output characteristic.\n\nIn summary, charge injection contributes three types of errors in MOS sampling circuits: gain error, dc offsets, and nonlinearity. In many applications, the first two can be tolerated or corrected, whereas the last cannot.\n\nIt is instructive to consider the speed-precision trade-off resulting from charge injection. Representing the speed by a simple time constant \\(\\tau\\) and the precision by the error \\(\\Delta V\\) due to charge injection, we define a figure of merit as \\(F=(\\tau \\Delta V)^{-1}\\). Writing:\n\n$$\n\\tau =R_{o n} C_{H}\n$$\n\nand\n\n$$\n\\Delta V=\\frac{W L C_{o x}}{C_{H}}\\left(V_{D D}-V_{i n}-V_{T H}\\right)\n$$\n\nwe have:\n\n$$\nF=\\frac{\\mu_{n}}{L^{2}}\n$$\n\nThus, to the first order, the trade-off is independent of the switch width and the sampling capacitor.\n\nIn addition to channel charge injection, a MOS switch couples the clock transitions to the sampling capacitor through its gate-drain or gate-source overlap capacitance. Depicted in Figure 13.23, the effect introduces an error in the sampled output voltage. Assuming the overlap capacitance is constant, we express the error as:\n\n$$\n\\Delta V=V_{C K} \\frac{W C_{o v}}{W C_{o v}+C_{H}}\n$$\n\nThe circuit in Figure 13.23 demonstrates clock feedthrough in a sampling circuit, where the NMOS transistor M1 introduces an error in the sampled output voltage due to overlap capacitance.\n\nFigure 13.23 shows clock feedthrough in a sampling circuit.\n\nRecall from Example 7.3 that a resistor charging a capacitor gives rise to a total rms noise voltage of \\(\\sqrt{k T / C}\\). As shown in Figure 13.24, a similar effect occurs in sampling circuits. The on-resistance of the switch introduces thermal noise at the output, and when the switch turns off, this noise is stored on the capacitor along with the instantaneous value of the input voltage. It can be proved that the rms voltage of the sampled noise in this case is still approximately equal to \\(\\sqrt{k T / C}\\).\n\nThe circuit diagram in Figure 13.24 shows a sampling circuit with thermal noise. The resistor Ron charges the capacitor CH, and when the switch is open, the resistor Ropen is introduced, leading to a noise voltage Vn added to the input voltage Vin at the output.\n\nFigure 13.24 illustrates thermal noise in a sampling circuit.\n\nThe problem of $k T / C$ noise limits the performance in many high-precision applications. To achieve low noise, the sampling capacitor must be sufficiently large, thus loading other circuits and degrading the speed."
},
{
    "text": "Our previous research on MOS switches suggests that an increased width-to-length ratio ($W/L$) or a reduced sampling capacitor size leads to enhanced speed. However, this section demonstrates that these speed-increasing methods come at the cost of reduced sampling precision.\n\nThere are three primary mechanisms during MOS transistor operation that introduce error when the switch is turned off. We examine each of these effects separately.\n\nFigure 13.18 presents a graphical representation highlighting the distortion that occurs when complementary switches do not deactivate concurrently. The figure is divided into two sections: the first part exhibits the timing diagram of complementary clock signals, CK the second part illustrates the comparison between input and output waveforms.\n\nIn the timing diagram, the complementary\nOur previous research on MOS switches indicates that increasing increased width-to-length ratio ($W/L$) or a reduced sampling capacitor size leads to enhanced speed. However, this section demonstrates that these speed-increasing methods come at the cost of reduced sampling precision.\n\nThere are three primary mechanisms during MOS transistor operation that introduce error when the switch is turned off. We examine each of these effects separately.\n\nFigure 13.18 presents a graphical representation highlighting the distortion that occurs when complementary switches do not deactivate concurrently. The figure is divided into two sections: the first part exhibits the timing diagram of complementary clock signals, and the second part illustrates the comparison between input and output waveforms.\n\nIn the timing diagram, the complementary clock signals CK and \\(\\overline{CK}\\) are depicted, showing a slight time difference \\(\\Delta t\\) between their transitions, indicating that the switches do not turn off at the exact same moment, leading to a timing mismatch.\n\nThe waveform comparison section displays the input voltage \\(V_{in}\\) as a sinusoidal waveform and the output voltage \\(V_{out}\\) following a similar pattern but with noticeable distortion. The output voltage deviates from the ideal value, which is indicated by a dashed line, showcasing the impact of non-simultaneous switch-off on signal integrity.\n\nFigure 13.19 illustrates a simple circuit designed to generate complementary clock signals CK and CK_bar from the input clock CKin using an NMOS transistor and an inverter.\n\nIn the context of channel charge injection, we consider the sampling circuit of Figure 13.20. For a MOSFET to be in an 'on' state, a channel must exist at the oxide-silicon interface. Assuming that \\(V_{\\text {in }} \\approx V_{\\text {out }}\\), we use our derivations in Chapter 2 to express the total charge in the inversion layer as:\n\n$$\nQ_{c h}=W L C_{o x}\\left(V_{D D}-V_{i n}-V_{T H}\\right)\n$$\n\nWhen the switch turns off, \\(Q_{c h}\\) exits through the source and drain terminals, a phenomenon referred to as \"channel charge injection.\"\n\nFigure 13.20 illustrates the charge injection when a switch turns off, affecting the voltage across the capacitor CH. The NMOS transistor M1 is controlled by the clock signal CK, allowing charge to flow from Vin to Vout when active. When M1 deactivates, charge injection occurs, potentially causing an error voltage on CH.\n\nThe charge injected to the left side of Figure 13.20 is absorbed by the input source, creating no error. On the other hand, the charge injected to the right side is deposited on \\(C_{H}\\), introducing an error in the voltage stored on the capacitor. For example, if half of \\(Q_{c h}\\) is injected onto \\(C_{H}\\), the resulting error equals:\n\n$$\n\\Delta V=\\frac{W L C_{o x}\\left(V_{D D}-V_{i n}-V_{T H}\\right)}{2 C_{H}}\n$$\n\nFigure 13.21 illustrates the effect of charge injection in a circuit using an NMOS switch. The diagram is composed of three main parts: the input waveform, the circuit diagram, and the output waveform.\n\nThe input waveform (left side) shows an input sinusoidal waveform labeled as \\(V_{in}\\), representing the input voltage to the circuit. The circuit diagram (center) depicts a simple circuit involving an NMOS transistor labeled as \\(M_1\\), controlled by a clock signal labeled \"CK.\" The output waveform (right side) shows the output waveform \\(V_{out}\\), which is a sinusoidal wave similar to the input but with a noticeable negative \"pedestal\" or dip, labeled as \\(\\Delta V\\), indicating the error introduced by charge injection when the transistor switches.\n\nAn important consideration is why we assumed that exactly half of the channel charge is injected onto \\(C_{H}\\) in deriving Equation (13.26). In reality, the fraction of charge that exits through the source and drain terminals is a relatively complex function of various parameters, such as the impedance seen at each terminal to ground and the transition time of the clock. Investigations of this effect have not yielded any rule of thumb that can predict the charge splitting in terms of such parameters. Furthermore, in many cases, these parameters, e.g., the clock transition time, are poorly controlled. Also, most circuit simulation programs model charge injection quite inaccurately. As a worst-case estimate, we can assume that the entire channel charge is injected onto the sampling capacitor.\n\nThe impact of charge injection on precision is considered, assuming that all of the charge is deposited on the capacitor. The sampled output voltage is expressed as:\n\n$$\nV_{\\text {out }} \\approx V_{\\text {in }}-\\frac{W L C_{o x}\\left(V_{D D}-V_{\\text {in }}-V_{T H}\\right)}{C_{H}}\n$$\n\nNeglecting the phase shift between the input and the output, we have:\n\n$$\nV_{o u t}=V_{i n}\\left(1+\\frac{W L C_{o x}}{C_{H}}\\right)-\\frac{W L C_{o x}}{C_{H}}\\left(V_{D D}-V_{T H}\\right)\n$$\n\nThis suggests that the output deviates from the ideal value through two effects: a nonunity gain equal to \\(1+W L C_{o x} / C_{H}\\) and a constant offset voltage \\(-W L C_{o x}\\left(V_{D D}-V_{T H}\\right) / C_{H}\\) (Figure 13.22).\n\nFigure 13.22 shows the input/output characteristic of a sampling circuit when charge injection is present. The graph is a linear plot with two primary lines: one labeled \"Ideal\" and the other labeled \"With Charge Injection.\" The x-axis represents the input voltage \\(V_{in}\\), while the y-axis represents the sampled output voltage \\(V_{out}\\). The \"Ideal\" line is a dashed line that passes through the origin, illustrating a direct proportional relationship between \\(V_{in}\\) and \\(V_{out}\\) with no offset or gain error. The solid line labeled \"With Charge Injection\" deviates from the ideal line, indicating a gain error and a DC offset.\n\nIn the foregoing discussion, we tacitly assumed that \\(V_{T H}\\) is constant. However, for NMOS switches (in an \\(n\\)-well technology), body effect must be taken into account. Since \\(V_{T H}=V_{T H 0}+\\gamma\\left(\\sqrt{2 \\phi_{B}+V_{S B}}-\\sqrt{2 \\phi_{B}}\\right)\\) and \\(V_{B S} \\approx-V_{i n}\\), we have:\n\n$$\nV_{o u t}=V_{i n}-\\frac{W L C_{o x}}{C_{H}}\\left(V_{D D}-V_{i n}-V_{T H 0}-\\gamma \\sqrt{2 \\phi_{B}+V_{i n}}+\\gamma \\sqrt{2 \\phi_{B}}\\right)\n$$\n\n$$\nV_{o u t}=V_{i n}\\left(1+\\frac{W L C_{o x}}{C_{H}}\\right)+\\gamma \\frac{W L C_{o x}}{C_{H}} \\sqrt{2 \\phi_{B}+V_{i n}} -\\frac{W L C_{o x}}{C_{H}}\\left(V_{D D}-V_{T H 0}+\\gamma \\sqrt{2 \\phi_{B}}\\right)\n$$\n\nIt follows that the nonlinear dependence of \\(V_{T H}\\) upon \\(V_{i n}\\) introduces nonlinearity in the input/output characteristic.\n\nIn summary, charge injection contributes three types of errors in MOS sampling circuits: gain error, DC offsets, and nonlinearity. In many applications, the first two can be tolerated or corrected, whereas the last cannot.\n\nThe speed-precision trade-off resulting from charge injection is considered. Representing the speed by a simple time constant \\(\\tau\\) and the precision by the error \\(\\Delta V\\) due to charge injection, we define a figure of merit as \\(F=(\\tau \\Delta V)^{-1}\\). Writing:\n\n$$\n\\tau =R_{o n} C_{H}\n$$\n\n$$\n\\tau =\\frac{1}{\\mu_{n} C_{o x}(W / L)\\left(V_{D D}-V_{i n}-V_{T H}\\right)} C_{H}\n$$\n\n$$\n\\Delta V=\\frac{W L C_{o x}}{C_{H}}\\left(V_{D D}-V_{i n}-V_{T H}\\right)\n$$\n\nwe have:\n\n$$\nF=\\frac{\\mu_{n}}{L^{2}}\n$$\n\nThus, to the first order, the trade-off is independent of the switch width and the sampling capacitor.\n\nClock feedthrough is another phenomenon where a MOS switch couples the clock transitions to the sampling capacitor through its gate-drain or gate-source overlap capacitance. This effect introduces an error in the sampled output voltage. Assuming the overlap capacitance is constant, we express the error as:\n\n$$\n\\Delta V=V_{C K} \\frac{W C_{o v}}{W C_{o v}+C_{H}}\n$$\n\nFigure 13.23 demonstrates clock feedthrough in a sampling circuit, where the NMOS transistor M1 introduces an error in the sampled output voltage due to overlap capacitance.\n\nIn addition to channel charge injection, a MOS switch couples the clock transitions to the sampling capacitor through its gate-drain or gate-source overlap capacitance. This effect, depicted in Figure 13.23, introduces an error in the sampled output voltage. Assuming the overlap capacitance is constant, we express the error as:\n\n$$\n\\Delta V=V_{C K} \\frac{W C_{o v}}{W C_{o v}+C_{H}}\n$$\n\nwhere \\(C_{o v}\\) is the overlap capacitance per unit width. The error \\(\\Delta V\\) is independent of the input level, manifesting itself as a constant offset in the input/output characteristic. As with charge injection, clock feedthrough leads to a trade-off between speed and precision as well.\n\nRecall from Example 7.3 that a resistor charging a capacitor gives rise to a total rms noise voltage of \\(\\sqrt{k T / C}\\). As shown in Figure 13.24, a similar effect occurs in sampling circuits. The on-resistance of the switch introduces thermal noise at the output, and when the switch turns off, this noise is stored on the capacitor along with the instantaneous value of the input voltage. It can be demonstrated that the rms voltage of the sampled noise in this case is still approximately equal to \\(\\sqrt{k T / C}\\).\n\nFigure 13.24 illustrates the thermal noise in a sampling circuit. The circuit diagram shows a sampling circuit with thermal noise. The resistor Ron charges the capacitor CH, and when the switch is open, the resistor Ropen is introduced, leading to a noise voltage Vn added to the input voltage Vin at the output.\n\nThe issue of \\(k T / C\\) noise limits the performance in many high-precision applications. In order to achieve low noise, the sampling capacitor must be sufficiently large, thus loading other circuits and degrading the speed."
},
{
    "text": "The reliance of charge injection on the input level and the compromise described by (13.34) necessitate the exploration of methods to counteract the effects of charge injection to enhance $F$. Here, we examine several such techniques.\n\nTo develop the initial technique, we propose that the charge introduced by the primary transistor can be neutralized by a secondary transistor. As depicted in Fig. 13.25, a \"dummy\" switch, $M_{2}$, activated by $\\overline{C K}$, is incorporated into the circuit so that when $M_{1}$ deactivates and $M_{2}$ activates, the channel charge deposited by $M_{1}$ on $C_{H}$ is absorbed by $M_{2}$ to form a channel. Note that both the source and drain of $M_{2}$ are linked to the output node.\nimage_name:Figure 13.25\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout, D: Vin, G: CK}\nname: M2, type: NMOS, ports: {S: Vout, D: Vout, G: CK_bar}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit employs a dummy NMOS transistor M2 to absorb the charge injected by the main NMOS transistor M1, thereby reducing charge injection and clock feedthrough effects. The charge injected by M1, q1, is counterbalanced by the charge absorbed by M2, q2.\n\nFigure 13.25 Incorporation of a dummy device to mitigate charge injection and clock feedthrough.\n\nHow can we ensure that the charge injected by $M_{1}, \\Delta q_{1}$, matches that absorbed by $M_{2}, \\Delta q_{2}$? Assume that half of $M_{1}$'s channel charge is injected onto $C_{H}$, i.e.,\n\n$$\n\\begin{equation*}\n\\Delta q_{1}=\\frac{W_{1} L_{1} C_{o x}}{2}\\left(V_{C K}-V_{i n}-V_{T H 1}\\right) \\tag{13.36}\n\\end{equation*}\n$$\n\nGiven that $\\Delta q_{2}=W_{2} L_{2} C_{o x}\\left(V_{C K}-V_{i n}-V_{T H 2}\\right)$, selecting $W_{2}=0.5 W_{1}$ and $L_{2}=L_{1}$ results in $\\Delta q_{2}=\\Delta q_{1}$. However, the assumption of equal charge distribution between source and drain is generally incorrect, rendering this method less appealing.\n\nRemarkably, with $W_{2}=0.5 W_{1}$ and $L_{2}=L_{1}$, the impact of clock feedthrough is diminished. As illustrated in Fig. 13.26, the total charge in $V_{\\text {out }}$ is zero due to\n\n$$\n\\begin{equation*}\n-V_{C K} \\frac{W_{1} C_{o v}}{W_{1} C_{o v}+C_{H}+2 W_{2} C_{o v}}+V_{C K} \\frac{2 W_{2} C_{o v}}{W_{1} C_{o v}+C_{H}+2 W_{2} C_{o v}}=0 \\tag{13.37}\n\\end{equation*}\n$$\n\nimage_name:Figure 13.26\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout, D: Vin, G: CK}\nname: M2, type: NMOS, ports: {S: Vout, D: Vout, G: Ck_bar}\nname: Cgs1, type: Capacitor, value: Cgs1, ports: {Np: CK, Nn: Vout}\nname: Cgd2, type: Capacitor, value: Cgd2, ports: {Np: Ck_bar, Nn: Vout}\nname: Cgs2, type: Capacitor, value: Cgs2, ports: {Np: Ck_bar, Nn: Vout}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit employs a charge injection cancellation method using NMOS transistors M1 and M2, along with capacitors to suppress clock feedthrough. This configuration ensures that the total charge at Vout is zero under the specified conditions.\nimage_name:Figure 13.26\ndescription:\n[\nname: W1Cov, type: Capacitor, value: W1Cov, ports: {Np: Ck, Nn: Vout}\nname: 2W2Cov, type: Capacitor, value: 2W2Cov, ports: {Np: Ck_bar, Nn: Vout}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit in Figure 13.26 is designed to suppress clock feedthrough using a dummy switch configuration. It utilizes NMOS transistors M1 and M2, along with capacitors, to achieve charge cancellation. The effect of clock feedthrough is minimized by balancing the charge injection from the transistors. The right side of the diagram shows the equivalent circuit with capacitors W1Cov and 2W2Cov, which further assist in charge cancellation.\n\nFigure 13.26 Suppression of clock feedthrough using a dummy switch.\nAn alternative approach to reducing charge injection involves using both PMOS and NMOS devices so that the opposing charge packets injected by each cancel each other out (Fig. 13.27). For $\\Delta q_{1}$ to neutralize $\\Delta q_{2}$, we must have $W_{1} L_{1} C_{o x}\\left(V_{C K}-V_{i n}-V_{T H N}\\right)=W_{2} L_{2} C_{o x}\\left(V_{i n}-\\left|V_{T H P}\\right|\\right)$. Thus, cancellation occurs only for a single input level. Even for clock feedthrough, the circuit does not achieve complete cancellation because the gate-drain overlap capacitance of NFETs differs from that of PFETs.\nimage_name:Figure 13.27\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vin, D: Vout, G: CK}\nname: M2, type: PMOS, ports: {S: Vout, D: Vin, G: CK_bar}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit employs complementary switches (M1 and M2) to mitigate charge injection. M1 injects electrons, while M2 injects holes, aiming to cancel each other's charge injection effects. The capacitor CH is connected between the output node Vout and ground.\n\nFigure 13.27 Utilization of complementary switches to mitigate charge injection.\n\nOur understanding of the benefits of differential circuits suggests that the issue of charge injection can be alleviated through differential operation. As shown in Fig. 13.28, we hypothesize that charge injection manifests as a common-mode disturbance. However, writing $\\Delta q_{1}=W L C_{o x}\\left(V_{C K}-V_{i n 1}-V_{T H 1}\\right)$ and $\\Delta q_{2}=$ $W L C_{o x}\\left(V_{C K}-V_{i n 2}-V_{T H 2}\\right)$, we realize that $\\Delta q_{1}=\\Delta q_{2}$ only if $V_{i n 1}=V_{i n 2}$. In other words, the overall error is not suppressed for differential signals. Nonetheless, this technique both eliminates the\n\nimage_name:Figure 13.28 Differential sampling circuit\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout1, D: Vin1, G: CK}\nname: M2, type: NMOS, ports: {S: Vout2, D: CK, G: Vin2}\nname: CH1, type: Capacitor, value: CH, ports: {Np: Vout1, Nn: GND}\nname: CH2, type: Capacitor, value: CH, ports: {Np: Vout2, Nn: GND}\n]\nextrainfo:The circuit is a differential sampling circuit using NMOS transistors M1 and M2, controlled by the clock signal CK. Each transistor's drain is connected to the clock, and sources are connected to separate output nodes Vout1 and Vout2. Capacitors CH are used to sample and hold the output voltages.\n\nFigure 13.28 Differential sampling circuit.\nconstant offset and reduces the nonlinear component. This can be understood by writing\n\n$$\n\\begin{align*}\n\\Delta q_{1}-\\Delta q_{2} & =W L C_{o x}\\left[\\left(V_{i n 2}-V_{i n 1}\\right)+\\left(V_{T H 2}-V_{T H 1}\\right)\\right]  \\tag{13.38}\\\\\n& =W L C_{o x}\\left[V_{i n 2}-V_{i n 1}+\\gamma\\left(\\sqrt{2 \\phi_{F}+V_{i n 2}}-\\sqrt{2 \\phi_{F}+V_{i n 1}}\\right)\\right] \\tag{13.39}\n\\end{align*}\n$$\n\nSince for $V_{i n 1}=V_{i n 2}, \\Delta q_{1}-\\Delta q_{2}=0$, the characteristic exhibits no offset. Additionally, the nonlinearity due to the body effect now appears in both square-root terms of (13.39), resulting in only odd-order distortion (Chapter 14).\n\nThe issue of charge injection continues to constrain the speed-precision balance in sampled-data systems. Numerous cancellation techniques have been proposed, each introducing its own trade-offs. One such technique, known as \"bottom-plate sampling,\" is widely employed in switched-capacitor circuits and is discussed later in this chapter."
},
{
    "text": "The reliance of charge injection on the input level and the trade-off described by (13.34) necessitates the exploration of methods to counteract the effects of charge injection to enhance $F$. Here, we examine several such techniques.\n\nFor the first technique, we propose that the charge injected by the primary transistor can be neutralized using a secondary transistor. As illustrated in Fig. 13.25, a \"dummy\" switch, $M_{2}$, activated by $\\overline{C K}$, is incorporated into the circuit. This ensures that once $M_{1}$ deactivates and $M_{2}$ activates, the channel charge deposited by $M_{1}$ on $C_{H}$ is absorbed by $M_{2}$ to form a channel. Note that both the source and drain of $M_{2}$ are linked to the output node.\nimage_name:Figure 13.25\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout, D: Vin, G: CK}\nname: M2, type: NMOS, ports: {S: Vout, D: Vout, G: CK_bar}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit employs a dummy NMOS transistor M2 to absorb the charge injected by the main NMOS transistor M1, thereby reducing charge injection and clock feedthrough effects. The charge injected by M1, q1, is offset by the charge absorbed by M2, q2.\n\nFigure 13.25 Incorporation of a dummy device to mitigate charge injection and clock feedthrough.\n\nHow can we ensure that the charge injected by $M_{1}, \\Delta q_{1}$, equals that absorbed by $M_{2}, \\Delta q_{2}$? Assuming half of $M_{1}$'s channel charge is injected onto $C_{H}$, i.e.,\n\n$$\n\\begin{equation*}\n\\Delta q_{1}=\\frac{W_{1} L_{1} C_{o x}}{2}\\left(V_{C K}-V_{i n}-V_{T H 1}\\right) \\tag{13.36}\n\\end{equation*}\n$$\n\nGiven that $\\Delta q_{2}=W_{2} L_{2} C_{o x}\\left(V_{C K}-V_{i n}-V_{T H 2}\\right)$, if we select $W_{2}=0.5 W_{1}$ and $L_{2}=L_{1}$, then $\\Delta q_{2}=\\Delta q_{1}$. However, the assumption of equal charge distribution between source and drain is typically invalid, making this method less appealing.\n\nInterestingly, with $W_{2}=0.5 W_{1}$ and $L_{2}=L_{1}$, the impact of clock feedthrough is mitigated. As shown in Fig. 13.26, the total charge in $V_{\\text {out }}$ is zero due to\n\n$$\n\\begin{equation*}\n-V_{C K} \\frac{W_{1} C_{o v}}{W_{1} C_{o v}+C_{H}+2 W_{2} C_{o v}}+V_{C K} \\frac{2 W_{2} C_{o v}}{W_{1} C_{o v}+C_{H}+2 W_{2} C_{o v}}=0 \\tag{13.37}\n\\end{equation*}\n$$\n\nimage_name:Figure 13.26\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout, D: Vin, G: CK}\nname: M2, type: NMOS, ports: {S: Vout, D: Vout, G: Ck_bar}\nname: Cgs1, type: Capacitor, value: Cgs1, ports: {Np: CK, Nn: Vout}\nname: Cgd2, type: Capacitor, value: Cgd2, ports: {Np: Ck_bar, Nn: Vout}\nname: Cgs2, type: Capacitor, value: Cgs2, ports: {Np: Ck_bar, Nn: Vout}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit employs a charge injection cancellation method using NMOS transistors M1 and M2, and capacitors to suppress clock feedthrough. This setup ensures that the total charge at Vout is zero under the specified conditions.\nimage_name:Figure 13.26\ndescription:\n[\nname: W1Cov, type: Capacitor, value: W1Cov, ports: {Np: Ck, Nn: Vout}\nname: 2W2Cov, type: Capacitor, value: 2W2Cov, ports: {Np: Ck_bar, Nn: Vout}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit in Figure 13.26 is designed to suppress clock feedthrough using a dummy switch configuration. It utilizes NMOS transistors M1 and M2 along with capacitors to achieve charge cancellation. The effect of clock feedthrough is minimized by balancing the charge injection from the transistors. The right side of the diagram shows the equivalent circuit with capacitors W1Cov and 2W2Cov, which further aid in charge cancellation.\n\nFigure 13.26 Suppression of clock feedthrough using a dummy switch.\nAnother method to reduce the impact of charge injection involves using both PMOS and NMOS devices so that the opposing charge packets injected by each cancel each other out (Fig. 13.27). For $\\Delta q_{1}$ to cancel $\\Delta q_{2}$, we need $W_{1} L_{1} C_{o x}\\left(V_{C K}-V_{i n}-V_{T H N}\\right)=W_{2} L_{2} C_{o x}\\left(V_{i n}-\\left|V_{T H P}\\right|\\right)$. Thus, cancellation occurs only for a single input level. Even for clock feedthrough, the circuit does not achieve complete cancellation due to the unequal gate-drain overlap capacitance of NFETs and PFETs.\nimage_name:Figure 13.27\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vin, D: Vout, G: CK}\nname: M2, type: PMOS, ports: {S: Vout, D: Vin, G: CK_bar}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit employs complementary switches (M1 and M2) to reduce charge injection. M1 injects electrons and M2 injects holes, aiming to cancel each other's charge injection effects. The capacitor CH is connected between the output node Vout and ground.\n\nFigure 13.27 Reduction of charge injection using complementary switches.\n\nOur understanding of the benefits of differential circuits suggests that the issue of charge injection can be mitigated through differential operation. As depicted in Fig. 13.28, we hypothesize that charge injection manifests as a common-mode disturbance. However, writing $\\Delta q_{1}=W L C_{o x}\\left(V_{C K}-V_{i n 1}-V_{T H 1}\\right)$ and $\\Delta q_{2}=$ $W L C_{o x}\\left(V_{C K}-V_{i n 2}-V_{T H 2}\\right)$, we see that $\\Delta q_{1}=\\Delta q_{2}$ only if $V_{i n 1}=V_{i n 2}$. In other words, the overall error is not suppressed for differential signals. Nonetheless, this technique both eliminates the\n\nimage_name:Figure 13.28 Differential sampling circuit\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout1, D: Vin1, G: CK}\nname: M2, type: NMOS, ports: {S: Vout2, D: CK, G: Vin2}\nname: CH1, type: Capacitor, value: CH, ports: {Np: Vout1, Nn: GND}\nname: CH2, type: Capacitor, value: CH, ports: {Np: Vout2, Nn: GND}\n]\nextrainfo:The circuit is a differential sampling circuit using NMOS transistors M1 and M2, controlled by the clock signal CK. Each transistor's drain is connected to the clock, and sources are connected to separate output nodes Vout1 and Vout2. Capacitors CH are used to sample and hold the output voltages.\n\nFigure 13.28 Differential sampling circuit.\nconstant offset and reduces the nonlinear component. This can be understood by writing\n\n$$\n\\begin{align*}\n\\Delta q_{1}-\\Delta q_{2} & =W L C_{o x}\\left[\\left(V_{i n 2}-V_{i n 1}\\right)+\\left(V_{T H 2}-V_{T H 1}\\right)\\right]  \\tag{13.38}\\\\\n& =W L C_{o x}\\left[V_{i n 2}-V_{i n 1}+\\gamma\\left(\\sqrt{2 \\phi_{F}+V_{i n 2}}-\\sqrt{2 \\phi_{F}+V_{i n 1}}\\right)\\right] \\tag{13.39}\n\\end{align*}\n$$\n\nSince for $V_{i n 1}=V_{i n 2}, \\Delta q_{1}-\\Delta q_{2}=0$, the characteristic shows no offset. Additionally, the nonlinearity due to the body effect now appears in both square-root terms of (13.39), resulting in only odd-order distortion (Chapter 14).\n\nThe challenge of charge injection continues to constrain the speed-precision balance in sampled-data systems. Numerous cancellation techniques have been proposed, each introducing its own trade-offs. One such technique, known as \"bottom-plate sampling,\" is widely employed in switched-capacitor circuits and is discussed later in this chapter."
},
{
    "text": "The reliance of charge injection on the input level and the trade-off described by (13.34) necessitates the exploration of methods to counteract the impact of charge injection to enhance $F$. Here, we examine several such techniques.\n\nThe first technique is based on the hypothesis that the charge injected by the primary transistor can be neutralized by a secondary transistor. As illustrated in Fig. 13.25, a \"dummy\" switch, $M_{2}$, controlled by $\\overline{C K}$, is incorporated into the circuit. This ensures that once $M_{1}$ switches off and $M_{2}$ activates, the channel charge deposited by $M_{1}$ on $C_{H}$ is absorbed by $M_{2}$ to form a channel. Note that both the source and drain of $M_{2}$ are linked to the output node.\nimage_name:Figure 13.25\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout, D: Vin, G: CK}\nname: M2, type: NMOS, ports: {S: Vout, D: Vout, G: CK_bar}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit employs a dummy NMOS transistor M2 to absorb the charge injected by the main NMOS transistor M1, thereby reducing charge injection and clock feedthrough effects. The charge injected by M1, q1, is counterbalanced by the charge absorbed by M2, q2.\n\nFigure 13.25 Incorporation of a dummy device to mitigate charge injection and clock feedthrough.\n\nHow can we ensure that the charge injected by $M_{1}, \\Delta q_{1}$, matches that absorbed by $M_{2}, \\Delta q_{2}$? Assume that half of $M_{1}$'s channel charge is injected onto $C_{H}$, i.e.,\n\n$$\n\\begin{equation*}\n\\Delta q_{1}=\\frac{W_{1} L_{1} C_{o x}}{2}\\left(V_{C K}-V_{i n}-V_{T H 1}\\right) \\tag{13.36}\n\\end{equation*}\n$$\n\nGiven that $\\Delta q_{2}=W_{2} L_{2} C_{o x}\\left(V_{C K}-V_{i n}-V_{T H 2}\\right)$, selecting $W_{2}=0.5 W_{1}$ and $L_{2}=L_{1}$ results in $\\Delta q_{2}=\\Delta q_{1}$. However, the assumption of equal charge distribution between source and drain is generally incorrect, making this method less appealing.\n\nInterestingly, with the dimensions $W_{2}=0.5 W_{1}$ and $L_{2}=L_{1}$, the impact of clock feedthrough is diminished. As shown in Fig. 13.26, the total charge at $V_{\\text {out }}$ is zero due to\n\n$$\n\\begin{equation*}\n-V_{C K} \\frac{W_{1} C_{o v}}{W_{1} C_{o v}+C_{H}+2 W_{2} C_{o v}}+V_{C K} \\frac{2 W_{2} C_{o v}}{W_{1} C_{o v}+C_{H}+2 W_{2} C_{o v}}=0 \\tag{13.37}\n\\end{equation*}\n$$\n\nimage_name:Figure 13.26\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout, D: Vin, G: CK}\nname: M2, type: NMOS, ports: {S: Vout, D: Vout, G: Ck_bar}\nname: Cgs1, type: Capacitor, value: Cgs1, ports: {Np: CK, Nn: Vout}\nname: Cgd2, type: Capacitor, value: Cgd2, ports: {Np: Ck_bar, Nn: Vout}\nname: Cgs2, type: Capacitor, value: Cgs2, ports: {Np: Ck_bar, Nn: Vout}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit employs a charge injection cancellation method using NMOS transistors M1 and M2, along with capacitors to suppress clock feedthrough. This setup ensures that the total charge at Vout is zero under the specified conditions.\nimage_name:Figure 13.26\ndescription:\n[\nname: W1Cov, type: Capacitor, value: W1Cov, ports: {Np: Ck, Nn: Vout}\nname: 2W2Cov, type: Capacitor, value: 2W2Cov, ports: {Np: Ck_bar, Nn: Vout}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit in Figure 13.26 is designed to suppress clock feedthrough using a dummy switch configuration. It utilizes NMOS transistors M1 and M2, along with capacitors, to achieve charge cancellation. The effect of clock feedthrough is minimized by balancing the charge injection from the transistors. The right side of the diagram shows the equivalent circuit with capacitors W1Cov and 2W2Cov, which further aid in charge cancellation.\n\nFigure 13.26 Suppression of clock feedthrough using a dummy switch.\nAnother method to reduce the impact of charge injection involves using both PMOS and NMOS devices so that the opposing charge packets injected by each cancel each other out (Fig. 13.27). For $\\Delta q_{1}$ to cancel $\\Delta q_{2}$, it is required that $W_{1} L_{1} C_{o x}\\left(V_{C K}-V_{i n}-V_{T H N}\\right)=W_{2} L_{2} C_{o x}\\left(V_{i n}-\\left|V_{T H P}\\right|\\right)$. Thus, cancellation occurs only for a single input level. Even for clock feedthrough, the circuit does not achieve complete cancellation due to the inequality of gate-drain overlap capacitance between NFETs and PFETs.\nimage_name:Figure 13.27\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vin, D: Vout, G: CK}\nname: M2, type: PMOS, ports: {S: Vout, D: Vin, G: CK_bar}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit employs complementary switches (M1 and M2) to mitigate charge injection. M1 injects electrons, while M2 injects holes, aiming to cancel each other's charge injection effects. The capacitor CH is connected between the output node Vout and ground.\n\nFigure 13.27 Utilization of complementary switches to mitigate charge injection.\n\nOur understanding of the benefits of differential circuits suggests that the issue of charge injection can be alleviated through differential operation. As depicted in Fig. 13.28, we hypothesize that charge injection manifests as a common-mode disturbance. However, writing $\\Delta q_{1}=W L C_{o x}\\left(V_{C K}-V_{i n 1}-V_{T H 1}\\right)$ and $\\Delta q_{2}=$ $W L C_{o x}\\left(V_{C K}-V_{i n 2}-V_{T H 2}\\right)$, we see that $\\Delta q_{1}=\\Delta q_{2}$ only if $V_{i n 1}=V_{i n 2}$. In other words, the overall error is not suppressed for differential signals. Nevertheless, this technique both eliminates the\n\nimage_name:Figure 13.28 Differential sampling circuit\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout1, D: Vin1, G: CK}\nname: M2, type: NMOS, ports: {S: Vout2, D: CK, G: Vin2}\nname: CH1, type: Capacitor, value: CH, ports: {Np: Vout1, Nn: GND}\nname: CH2, type: Capacitor, value: CH, ports: {Np: Vout2, Nn: GND}\n]\nextrainfo:The circuit is a differential sampling circuit using NMOS transistors M1 and M2, controlled by the clock signal CK. Each transistor's drain is connected to the clock, and sources are connected to separate output nodes Vout1 and Vout2. Capacitors CH are used to sample and hold the output voltages.\n\nFigure 13.28 Differential sampling circuit.\nconstant offset and reduces the nonlinear component. This can be understood by writing\n\n$$\n\\begin{align*}\n\\Delta q_{1}-\\Delta q_{2} & =W L C_{o x}\\left[\\left(V_{i n 2}-V_{i n 1}\\right)+\\left(V_{T H 2}-V_{T H 1}\\right)\\right]  \\tag{13.38}\\\\\n& =W L C_{o x}\\left[V_{i n 2}-V_{i n 1}+\\gamma\\left(\\sqrt{2 \\phi_{F}+V_{i n 2}}-\\sqrt{2 \\phi_{F}+V_{i n 1}}\\right)\\right] \\tag{13.39}\n\\end{align*}\n$$\n\nSince for $V_{i n 1}=V_{i n 2}, \\Delta q_{1}-\\Delta q_{2}=0$, the characteristic shows no offset. Additionally, the nonlinearity due to the body effect now appears in both square-root terms of (13.39), resulting in only odd-order distortion (Chapter 14).\n\nThe challenge of charge injection continues to constrain the speed-precision balance in sampled-data systems. Numerous cancellation techniques have been proposed, each introducing its own trade-offs. One such technique, known as \"bottom-plate sampling,\" is widely employed in switched-capacitor circuits and is discussed later in this chapter."
},
{
    "text": "The reliance of charge injection on the input level and the trade-off described by (13.34) necessitate methods to counteract charge injection effects to enhance $F$. We explore several such techniques here.\n\nThe first technique posits that the charge injected by the primary transistor can be neutralized by a secondary transistor. As depicted in Fig. 13.25, a \"dummy\" switch, $M_{2}$, activated by $\\overline{C K}$, is introduced into the circuit. This ensures that once $M_{1}$ deactivates and $M_{2}$ activates, the channel charge deposited by $M_{1}$ on $C_{H}$ is absorbed by $M_{2}$ to form a channel. Note that both the source and drain of $M_{2}$ are linked to the output node.\nimage_name:Figure 13.25\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout, D: Vin, G: CK}\nname: M2, type: NMOS, ports: {S: Vout, D: Vout, G: CK_bar}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit employs a dummy NMOS transistor M2 to absorb the charge injected by the main NMOS transistor M1, thereby reducing charge injection and clock feedthrough effects. The charge injected by M1, q1, is counterbalanced by the charge absorbed by M2, q2.\n\nFigure 13.25 Incorporation of a dummy device to mitigate charge injection and clock feedthrough.\n\nHow can we ensure that the charge injected by $M_{1}, \\Delta q_{1}$, equals the charge absorbed by $M_{2}, \\Delta q_{2}$? Assuming half of $M_{1}$'s channel charge is injected onto $C_{H}$, i.e.,\n\n$$\n\\begin{equation*}\n\\Delta q_{1}=\\frac{W_{1} L_{1} C_{o x}}{2}\\left(V_{C K}-V_{i n}-V_{T H 1}\\right) \\tag{13.36}\n\\end{equation*}\n$$\n\nGiven $\\Delta q_{2}=W_{2} L_{2} C_{o x}\\left(V_{C K}-V_{i n}-V_{T H 2}\\right)$, if we select $W_{2}=0.5 W_{1}$ and $L_{2}=L_{1}$, then $\\Delta q_{2}=\\Delta q_{1}$. However, the assumption of equal charge distribution between source and drain is generally invalid, reducing the appeal of this method.\n\nInterestingly, with $W_{2}=0.5 W_{1}$ and $L_{2}=L_{1}$, clock feedthrough effects are mitigated. As shown in Fig. 13.26, the total charge at $V_{\\text {out }}$ is zero due to\n\n$$\n\\begin{equation*}\n-V_{C K} \\frac{W_{1} C_{o v}}{W_{1} C_{o v}+C_{H}+2 W_{2} C_{o v}}+V_{C K} \\frac{2 W_{2} C_{o v}}{W_{1} C_{o v}+C_{H}+2 W_{2} C_{o v}}=0 \\tag{13.37}\n\\end{equation*}\n$$\n\nimage_name:Figure 13.26\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout, D: Vin, G: CK}\nname: M2, type: NMOS, ports: {S: Vout, D: Vout, G: Ck_bar}\nname: Cgs1, type: Capacitor, value: Cgs1, ports: {Np: CK, Nn: Vout}\nname: Cgd2, type: Capacitor, value: Cgd2, ports: {Np: Ck_bar, Nn: Vout}\nname: Cgs2, type: Capacitor, value: Cgs2, ports: {Np: Ck_bar, Nn: Vout}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit employs a charge injection cancellation method using NMOS transistors M1 and M2, along with capacitors, to suppress clock feedthrough. This setup ensures that the total charge at Vout is zero under the specified conditions.\nimage_name:Figure 13.26\ndescription:\n[\nname: W1Cov, type: Capacitor, value: W1Cov, ports: {Np: Ck, Nn: Vout}\nname: 2W2Cov, type: Capacitor, value: 2W2Cov, ports: {Np: Ck_bar, Nn: Vout}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit in Figure 13.26 is designed to suppress clock feedthrough using a dummy switch configuration. It utilizes NMOS transistors M1 and M2, along with capacitors, to achieve charge cancellation. The clock feedthrough effect is minimized by balancing the charge injection from the transistors. The right side of the diagram illustrates the equivalent circuit with capacitors W1Cov and 2W2Cov, further aiding in charge cancellation.\n\nFigure 13.26 Suppression of clock feedthrough using a dummy switch.\nAnother method to reduce charge injection involves using both PMOS and NMOS devices so that the opposing charge packets injected by each cancel each other out (Fig. 13.27). For $\\Delta q_{1}$ to cancel $\\Delta q_{2}$, we need $W_{1} L_{1} C_{o x}\\left(V_{C K}-V_{i n}-V_{T H N}\\right)=W_{2} L_{2} C_{o x}\\left(V_{i n}-\\left|V_{T H P}\\right|\\right)$. Thus, cancellation occurs only at a single input level. Even for clock feedthrough, the circuit does not achieve complete cancellation due to the unequal gate-drain overlap capacitance of NFETs and PFETs.\nimage_name:Figure 13.27\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vin, D: Vout, G: CK}\nname: M2, type: PMOS, ports: {S: Vout, D: Vin, G: CK_bar}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit utilizes complementary switches (M1 and M2) to mitigate charge injection. M1 injects electrons, while M2 injects holes, aiming to cancel each other's charge injection effects. The capacitor CH is connected between the output node Vout and ground.\n\nFigure 13.27 Utilization of complementary switches to mitigate charge injection.\n\nOur understanding of the benefits of differential circuits suggests that the issue of charge injection can be alleviated through differential operation. As illustrated in Fig. 13.28, we hypothesize that charge injection manifests as a common-mode disturbance. However, by writing $\\Delta q_{1}=W L C_{o x}\\left(V_{C K}-V_{i n 1}-V_{T H 1}\\right)$ and $\\Delta q_{2}=$ $W L C_{o x}\\left(V_{C K}-V_{i n 2}-V_{T H 2}\\right)$, we see that $\\Delta q_{1}=\\Delta q_{2}$ only if $V_{i n 1}=V_{i n 2}$. In other words, the overall error is not suppressed for differential signals. Nonetheless, this technique both eliminates the\n\nimage_name:Figure 13.28 Differential sampling circuit\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout1, D: Vin1, G: CK}\nname: M2, type: NMOS, ports: {S: Vout2, D: CK, G: Vin2}\nname: CH1, type: Capacitor, value: CH, ports: {Np: Vout1, Nn: GND}\nname: CH2, type: Capacitor, value: CH, ports: {Np: Vout2, Nn: GND}\n]\nextrainfo:The circuit is a differential sampling circuit employing NMOS transistors M1 and M2, controlled by the clock signal CK. Each transistor's drain is connected to the clock, and sources are connected to separate output nodes Vout1 and Vout2. Capacitors CH are used to sample and hold the output voltages.\n\nFigure 13.28 Differential sampling circuit.\nconstant offset and reduces the nonlinear component. This can be understood by writing\n\n$$\n\\begin{align*}\n\\Delta q_{1}-\\Delta q_{2} & =W L C_{o x}\\left[\\left(V_{i n 2}-V_{i n 1}\\right)+\\left(V_{T H 2}-V_{T H 1}\\right)\\right]  \\tag{13.38}\\\\\n& =W L C_{o x}\\left[V_{i n 2}-V_{i n 1}+\\gamma\\left(\\sqrt{2 \\phi_{F}+V_{i n 2}}-\\sqrt{2 \\phi_{F}+V_{i n 1}}\\right)\\right] \\tag{13.39}\n\\end{align*}\n$$\n\nSince for $V_{i n 1}=V_{i n 2}, \\Delta q_{1}-\\Delta q_{2}=0$, the characteristic shows no offset. Additionally, the nonlinearity due to the body effect now appears in both square-root terms of (13.39), resulting in only odd-order distortion (Chapter 14).\n\nThe issue of charge injection continues to constrain the speed-precision balance in sampled-data systems. Numerous cancellation techniques have been proposed, each introducing its own trade-offs. One such technique, known as \"bottom-plate sampling,\" is widely employed in switched-capacitor circuits and is discussed later in this chapter."
},
{
    "text": "The reliance of charge injection on the input level and the compromise depicted by (13.34) necessitate the exploration of methods to counteract the impact of charge injection, thereby enhancing $F$. We examine several such techniques here.\n\nTo introduce the first technique, we propose that the charge injected by the primary transistor can be neutralized using a secondary transistor. As illustrated in Fig. 13.25, a \"dummy\" switch, $M_{2}$, activated by $\\overline{C K}$, is incorporated into the circuit so that once $M_{1}$ deactivates and $M_{2}$ activates, the channel charge deposited by $M_{1}$ on $C_{H}$ is absorbed by $M_{2}$ to form a channel. Note that both the source and drain of $M_{2}$ are linked to the output node.\nimage_name:Figure 13.25\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout, D: Vin, G: CK}\nname: M2, type: NMOS, ports: {S: Vout, D: Vout, G: CK_bar}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit employs a dummy NMOS transistor M2 to absorb the charge injected by the main NMOS transistor M1, thereby reducing charge injection and clock feedthrough effects. The charge injected by M1, q1, is counterbalanced by the charge absorbed by M2, q2.\n\nFigure 13.25 Incorporation of dummy device to mitigate charge injection and clock feedthrough.\n\nHow can we ensure that the charge injected by $M_{1}, \\Delta q_{1}$, equals that absorbed by $M_{2}, \\Delta q_{2}$? Assume that half of $M_{1}$'s channel charge is injected onto $C_{H}$, i.e.,\n\n$$\n\\begin{equation*}\n\\Delta q_{1}=\\frac{W_{1} L_{1} C_{o x}}{2}\\left(V_{C K}-V_{i n}-V_{T H 1}\\right) \\tag{13.36}\n\\end{equation*}\n$$\n\nGiven that $\\Delta q_{2}=W_{2} L_{2} C_{o x}\\left(V_{C K}-V_{i n}-V_{T H 2}\\right)$, if we select $W_{2}=0.5 W_{1}$ and $L_{2}=L_{1}$, then $\\Delta q_{2}=\\Delta q_{1}$. However, the assumption of equal charge distribution between source and drain is generally inaccurate, making this method less appealing.\n\nInterestingly, with the choice $W_{2}=0.5 W_{1}$ and $L_{2}=L_{1}$, the impact of clock feedthrough is mitigated. As shown in Fig. 13.26, the total charge in $V_{\\text {out }}$ is zero because\n\n$$\n\\begin{equation*}\n-V_{C K} \\frac{W_{1} C_{o v}}{W_{1} C_{o v}+C_{H}+2 W_{2} C_{o v}}+V_{C K} \\frac{2 W_{2} C_{o v}}{W_{1} C_{o v}+C_{H}+2 W_{2} C_{o v}}=0 \\tag{13.37}\n\\end{equation*}\n$$\n\nimage_name:Figure 13.26\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout, D: Vin, G: CK}\nname: M2, type: NMOS, ports: {S: Vout, D: Vout, G: Ck_bar}\nname: Cgs1, type: Capacitor, value: Cgs1, ports: {Np: CK, Nn: Vout}\nname: Cgd2, type: Capacitor, value: Cgd2, ports: {Np: Ck_bar, Nn: Vout}\nname: Cgs2, type: Capacitor, value: Cgs2, ports: {Np: Ck_bar, Nn: Vout}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit employs a charge injection cancellation method using NMOS transistors M1 and M2, along with capacitors, to suppress clock feedthrough. This configuration ensures that the total charge at Vout is zero under the specified conditions.\nimage_name:Figure 13.26\ndescription:\n[\nname: W1Cov, type: Capacitor, value: W1Cov, ports: {Np: Ck, Nn: Vout}\nname: 2W2Cov, type: Capacitor, value: 2W2Cov, ports: {Np: Ck_bar, Nn: Vout}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit in Figure 13.26 is designed to suppress clock feedthrough using a dummy switch configuration. It utilizes NMOS transistors M1 and M2, along with capacitors, to achieve charge cancellation. The effect of clock feedthrough is minimized by balancing the charge injection from the transistors. The right side of the diagram shows the equivalent circuit with capacitors W1Cov and 2W2Cov, which further aid in charge cancellation.\n\nFigure 13.26 Suppression of clock feedthrough using a dummy switch.\nAnother method to reduce the impact of charge injection involves using both PMOS and NMOS devices so that the opposing charge packets injected by each cancel each other out (Fig. 13.27). For $\\Delta q_{1}$ to cancel $\\Delta q_{2}$, we must have $W_{1} L_{1} C_{o x}\\left(V_{C K}-V_{i n}-V_{T H N}\\right)=W_{2} L_{2} C_{o x}\\left(V_{i n}-\\left|V_{T H P}\\right|\\right)$. Thus, cancellation occurs only for a single input level. Even for clock feedthrough, the circuit does not achieve complete cancellation because the gate-drain overlap capacitance of NFETs differs from that of PFETs.\nimage_name:Figure 13.27\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vin, D: Vout, G: CK}\nname: M2, type: PMOS, ports: {S: Vout, D: Vin, G: CK_bar}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit utilizes complementary switches (M1 and M2) to reduce charge injection. M1 injects electrons, while M2 injects holes, aiming to cancel each other's charge injection effects. The capacitor CH is connected between the output node Vout and ground.\n\nFigure 13.27 Utilization of complementary switches to mitigate charge injection.\n\nOur understanding of the benefits of differential circuits suggests that the issue of charge injection can be alleviated through differential operation. As depicted in Fig. 13.28, we hypothesize that charge injection manifests as a common-mode disturbance. However, by writing $\\Delta q_{1}=W L C_{o x}\\left(V_{C K}-V_{i n 1}-V_{T H 1}\\right)$ and $\\Delta q_{2}=$ $W L C_{o x}\\left(V_{C K}-V_{i n 2}-V_{T H 2}\\right)$, we realize that $\\Delta q_{1}=\\Delta q_{2}$ only if $V_{i n 1}=V_{i n 2}$. In other words, the overall error is not suppressed for differential signals. Nevertheless, this technique both eliminates the\n\nimage_name:Figure 13.28 Differential sampling circuit\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout1, D: Vin1, G: CK}\nname: M2, type: NMOS, ports: {S: Vout2, D: CK, G: Vin2}\nname: CH1, type: Capacitor, value: CH, ports: {Np: Vout1, Nn: GND}\nname: CH2, type: Capacitor, value: CH, ports: {Np: Vout2, Nn: GND}\n]\nextrainfo:The circuit is a differential sampling circuit using NMOS transistors M1 and M2, controlled by the clock signal CK. Each transistor's drain is connected to the clock, and sources are connected to separate output nodes Vout1 and Vout2. Capacitors CH are used to sample and hold the output voltages.\n\nFigure 13.28 Differential sampling circuit.\nconstant offset and reduces the nonlinear component. This can be understood by writing\n\n$$\n\\begin{align*}\n\\Delta q_{1}-\\Delta q_{2} & =W L C_{o x}\\left[\\left(V_{i n 2}-V_{i n 1}\\right)+\\left(V_{T H 2}-V_{T H 1}\\right)\\right]  \\tag{13.38}\\\\\n& =W L C_{o x}\\left[V_{i n 2}-V_{i n 1}+\\gamma\\left(\\sqrt{2 \\phi_{F}+V_{i n 2}}-\\sqrt{2 \\phi_{F}+V_{i n 1}}\\right)\\right] \\tag{13.39}\n\\end{align*}\n$$\n\nSince for $V_{i n 1}=V_{i n 2}, \\Delta q_{1}-\\Delta q_{2}=0$, the characteristic exhibits no offset. Additionally, the nonlinearity due to the body effect now appears in both square-root terms of (13.39), resulting in only odd-order distortion (Chapter 14).\n\nThe challenge of charge injection continues to constrain the speed-precision balance in sampled-data systems. Numerous cancellation techniques have been proposed, each introducing its own trade-offs. One such technique, known as \"bottom-plate sampling,\" is extensively used in switched-capacitor circuits and is discussed later in this chapter."
},
{
    "text": "The reliance of charge injection on the input level and the trade-off described by (13.34) necessitate the exploration of methods to counteract charge injection effects to enhance $F$. We examine several such techniques here.\n\nThe first technique posits that the charge introduced by the primary transistor can be neutralized using a secondary transistor. As depicted in Fig. 13.25, a \"dummy\" switch, $M_{2}$, activated by $\\overline{C K}$, is incorporated into the circuit. Following the deactivation of $M_{1}$ and the activation of $M_{2}$, the channel charge deposited by $M_{1}$ on $C_{H}$ is absorbed by $M_{2}$ to form a channel. Note that both the source and drain of $M_{2}$ are linked to the output node.\nimage_name:Figure 13.25\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout, D: Vin, G: CK}\nname: M2, type: NMOS, ports: {S: Vout, D: Vout, G: CK_bar}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit employs a dummy NMOS transistor M2 to absorb the charge injected by the main NMOS transistor M1, thereby reducing charge injection and clock feedthrough effects. The charge injected by M1, q1, is counterbalanced by the charge absorbed by M2, q2.\n\nFigure 13.25 Incorporation of a dummy device to mitigate charge injection and clock feedthrough.\n\nHow can we ensure that the charge injected by $M_{1}, \\Delta q_{1}$, equals the charge absorbed by $M_{2}, \\Delta q_{2}$? Assuming half of $M_{1}$'s channel charge is injected onto $C_{H}$, i.e.,\n\n$$\n\\begin{equation*}\n\\Delta q_{1}=\\frac{W_{1} L_{1} C_{o x}}{2}\\left(V_{C K}-V_{i n}-V_{T H 1}\\right) \\tag{13.36}\n\\end{equation*}\n$$\n\nGiven that $\\Delta q_{2}=W_{2} L_{2} C_{o x}\\left(V_{C K}-V_{i n}-V_{T H 2}\\right)$, selecting $W_{2}=0.5 W_{1}$ and $L_{2}=L_{1}$ results in $\\Delta q_{2}=\\Delta q_{1}$. However, the assumption of equal charge distribution between source and drain is generally invalid, diminishing the appeal of this approach.\n\nInterestingly, with $W_{2}=0.5 W_{1}$ and $L_{2}=L_{1}$, clock feedthrough effects are mitigated. As illustrated in Fig. 13.26, the total charge at $V_{\\text {out }}$ is zero due to\n\n$$\n\\begin{equation*}\n-V_{C K} \\frac{W_{1} C_{o v}}{W_{1} C_{o v}+C_{H}+2 W_{2} C_{o v}}+V_{C K} \\frac{2 W_{2} C_{o v}}{W_{1} C_{o v}+C_{H}+2 W_{2} C_{o v}}=0 \\tag{13.37}\n\\end{equation*}\n$$\n\nimage_name:Figure 13.26\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout, D: Vin, G: CK}\nname: M2, type: NMOS, ports: {S: Vout, D: Vout, G: Ck_bar}\nname: Cgs1, type: Capacitor, value: Cgs1, ports: {Np: CK, Nn: Vout}\nname: Cgd2, type: Capacitor, value: Cgd2, ports: {Np: Ck_bar, Nn: Vout}\nname: Cgs2, type: Capacitor, value: Cgs2, ports: {Np: Ck_bar, Nn: Vout}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit employs a charge injection cancellation method using NMOS transistors M1 and M2, along with capacitors, to suppress clock feedthrough. This configuration ensures that the total charge at Vout is zero under the specified conditions.\nimage_name:Figure 13.26\ndescription:\n[\nname: W1Cov, type: Capacitor, value: W1Cov, ports: {Np: Ck, Nn: Vout}\nname: 2W2Cov, type: Capacitor, value: 2W2Cov, ports: {Np: Ck_bar, Nn: Vout}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit in Figure 13.26 is designed to suppress clock feedthrough using a dummy switch configuration. It utilizes NMOS transistors M1 and M2, along with capacitors, to achieve charge cancellation. The effect of clock feedthrough is minimized by balancing the charge injection from the transistors. The right side of the diagram shows the equivalent circuit with capacitors W1Cov and 2W2Cov, further aiding in charge cancellation.\n\nFigure 13.26 Suppression of clock feedthrough using a dummy switch.\nAnother method to reduce charge injection involves using both PMOS and NMOS devices so that the opposing charge packets injected by each cancel each other out (Fig. 13.27). For $\\Delta q_{1}$ to cancel $\\Delta q_{2}$, it must hold that $W_{1} L_{1} C_{o x}\\left(V_{C K}-V_{i n}-V_{T H N}\\right)=W_{2} L_{2} C_{o x}\\left(V_{i n}-\\left|V_{T H P}\\right|\\right)$. Thus, cancellation occurs only for a single input level. Even for clock feedthrough, the circuit does not achieve complete cancellation due to the unequal gate-drain overlap capacitance of NFETs and PFETs.\nimage_name:Figure 13.27\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vin, D: Vout, G: CK}\nname: M2, type: PMOS, ports: {S: Vout, D: Vin, G: CK_bar}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit utilizes complementary switches (M1 and M2) to reduce charge injection. M1 injects electrons, while M2 injects holes, aiming to cancel each other's charge injection effects. The capacitor CH is connected between the output node Vout and ground.\n\nFigure 13.27 Reduction of charge injection using complementary switches.\n\nOur understanding of the benefits of differential circuits suggests that the issue of charge injection can be mitigated through differential operation. As shown in Fig. 13.28, we hypothesize that charge injection manifests as a common-mode disturbance. However, writing $\\Delta q_{1}=W L C_{o x}\\left(V_{C K}-V_{i n 1}-V_{T H 1}\\right)$ and $\\Delta q_{2}=$ $W L C_{o x}\\left(V_{C K}-V_{i n 2}-V_{T H 2}\\right)$, we see that $\\Delta q_{1}=\\Delta q_{2}$ only if $V_{i n 1}=V_{i n 2}$. In other words, the overall error is not eliminated for differential signals. Nevertheless, this technique both eliminates the\n\nimage_name:Figure 13.28 Differential sampling circuit\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout1, D: Vin1, G: CK}\nname: M2, type: NMOS, ports: {S: Vout2, D: CK, G: Vin2}\nname: CH1, type: Capacitor, value: CH, ports: {Np: Vout1, Nn: GND}\nname: CH2, type: Capacitor, value: CH, ports: {Np: Vout2, Nn: GND}\n]\nextrainfo:The circuit is a differential sampling circuit employing NMOS transistors M1 and M2, controlled by the clock signal CK. Each transistor's drain is connected to the clock, and their sources are connected to separate output nodes Vout1 and Vout2. Capacitors CH are used to sample and hold the output voltages.\n\nFigure 13.28 Differential sampling circuit.\nconstant offset and reduces the nonlinear component. This can be understood by writing\n\n$$\n\\begin{align*}\n\\Delta q_{1}-\\Delta q_{2} & =W L C_{o x}\\left[\\left(V_{i n 2}-V_{i n 1}\\right)+\\left(V_{T H 2}-V_{T H 1}\\right)\\right]  \\tag{13.38}\\\\\n& =W L C_{o x}\\left[V_{i n 2}-V_{i n 1}+\\gamma\\left(\\sqrt{2 \\phi_{F}+V_{i n 2}}-\\sqrt{2 \\phi_{F}+V_{i n 1}}\\right)\\right] \\tag{13.39}\n\\end{align*}\n$$\n\nSince for $V_{i n 1}=V_{i n 2}, \\Delta q_{1}-\\Delta q_{2}=0$, the characteristic shows no offset. Additionally, the nonlinearity due to the body effect now appears in both square-root terms of (13.39), resulting in only odd-order distortion (Chapter 14).\n\nThe challenge of charge injection continues to constrain the speed-precision balance in sampled-data systems. Numerous cancellation techniques have been proposed, each introducing its own trade-offs. One such technique, known as \"bottom-plate sampling,\" is widely employed in switched-capacitor circuits and is discussed later in this chapter."
},
{
    "text": "The reliance of charge injection on the input level and the compromise depicted by (13.34) necessitate the exploration of methods to counteract charge injection effects to enhance $F$. We examine several such techniques herein.\n\nTo introduce the first technique, we propose that the charge injected by the primary transistor can be neutralized using a secondary transistor. As depicted in Fig. 13.25, a \"dummy\" switch, $M_{2}$, activated by $\\overline{C K}$, is incorporated into the circuit so that once $M_{1}$ deactivates and $M_{2}$ activates, the channel charge deposited by $M_{1}$ on $C_{H}$ is absorbed by $M_{2}$ to form a channel. Note that both the source and drain of $M_{2}$ are linked to the output node.\nimage_name:Figure 13.25\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout, D: Vin, G: CK}\nname: M2, type: NMOS, ports: {S: Vout, D: Vout, G: CK_bar}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit employs a dummy NMOS transistor M2 to absorb the charge injected by the main NMOS transistor M1, thereby reducing charge injection and clock feedthrough effects. The charge injected by M1, q1, is counterbalanced by the charge absorbed by M2, q2.\n\nFigure 13.25 Incorporation of a dummy device to mitigate charge injection and clock feedthrough.\n\nHow can we ensure that the charge injected by $M_{1}, \\Delta q_{1}$, matches that absorbed by $M_{2}, \\Delta q_{2}$? Assume that half of $M_{1}$'s channel charge is injected onto $C_{H}$, i.e.,\n\n$$\n\\begin{equation*}\n\\Delta q_{1}=\\frac{W_{1} L_{1} C_{o x}}{2}\\left(V_{C K}-V_{i n}-V_{T H 1}\\right) \\tag{13.36}\n\\end{equation*}\n$$\n\nGiven that $\\Delta q_{2}=W_{2} L_{2} C_{o x}\\left(V_{C K}-V_{i n}-V_{T H 2}\\right)$, if we select $W_{2}=0.5 W_{1}$ and $L_{2}=L_{1}$, then $\\Delta q_{2}=\\Delta q_{1}$. However, the assumption of equal charge distribution between source and drain is typically invalid, rendering this method less appealing.\n\nInterestingly, with the choice $W_{2}=0.5 W_{1}$ and $L_{2}=L_{1}$, the impact of clock feedthrough is diminished. As illustrated in Fig. 13.26, the total charge in $V_{\\text {out }}$ is zero because\n\n$$\n\\begin{equation*}\n-V_{C K} \\frac{W_{1} C_{o v}}{W_{1} C_{o v}+C_{H}+2 W_{2} C_{o v}}+V_{C K} \\frac{2 W_{2} C_{o v}}{W_{1} C_{o v}+C_{H}+2 W_{2} C_{o v}}=0 \\tag{13.37}\n\\end{equation*}\n$$\n\nimage_name:Figure 13.26\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout, D: Vin, G: CK}\nname: M2, type: NMOS, ports: {S: Vout, D: Vout, G: Ck_bar}\nname: Cgs1, type: Capacitor, value: Cgs1, ports: {Np: CK, Nn: Vout}\nname: Cgd2, type: Capacitor, value: Cgd2, ports: {Np: Ck_bar, Nn: Vout}\nname: Cgs2, type: Capacitor, value: Cgs2, ports: {Np: Ck_bar, Nn: Vout}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit employs a charge injection cancellation method using NMOS transistors M1 and M2, along with capacitors to suppress clock feedthrough. This setup ensures that the total charge at Vout is zero under the specified conditions.\nimage_name:Figure 13.26\ndescription:\n[\nname: W1Cov, type: Capacitor, value: W1Cov, ports: {Np: Ck, Nn: Vout}\nname: 2W2Cov, type: Capacitor, value: 2W2Cov, ports: {Np: Ck_bar, Nn: Vout}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit in Figure 13.26 is designed to suppress clock feedthrough using a dummy switch configuration. It utilizes NMOS transistors M1 and M2, along with capacitors, to achieve charge cancellation. The effect of clock feedthrough is minimized by balancing the charge injection from the transistors. The right side of the diagram shows the equivalent circuit with capacitors W1Cov and 2W2Cov, which further aid in charge cancellation.\n\nFigure 13.26 Suppression of clock feedthrough using a dummy switch.\nAnother method to reduce charge injection involves using both PMOS and NMOS devices so that the opposing charge packets injected by each cancel each other out (Fig. 13.27). For $\\Delta q_{1}$ to cancel $\\Delta q_{2}$, we must have $W_{1} L_{1} C_{o x}\\left(V_{C K}-V_{i n}-V_{T H N}\\right)=W_{2} L_{2} C_{o x}\\left(V_{i n}-\\left|V_{T H P}\\right|\\right)$. Thus, cancellation occurs only for a single input level. Even for clock feedthrough, the circuit does not achieve complete cancellation due to the unequal gate-drain overlap capacitance of NFETs and PFETs.\nimage_name:Figure 13.27\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vin, D: Vout, G: CK}\nname: M2, type: PMOS, ports: {S: Vout, D: Vin, G: CK_bar}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit employs complementary switches (M1 and M2) to mitigate charge injection. M1 injects electrons, while M2 injects holes, aiming to cancel each other's charge injection effects. The capacitor CH is connected between the output node Vout and ground.\n\nFigure 13.27 Utilization of complementary switches to mitigate charge injection.\n\nOur understanding of the benefits of differential circuits suggests that the issue of charge injection can be alleviated through differential operation. As shown in Fig. 13.28, we hypothesize that charge injection manifests as a common-mode disturbance. However, writing $\\Delta q_{1}=W L C_{o x}\\left(V_{C K}-V_{i n 1}-V_{T H 1}\\right)$ and $\\Delta q_{2}=$ $W L C_{o x}\\left(V_{C K}-V_{i n 2}-V_{T H 2}\\right)$, we realize that $\\Delta q_{1}=\\Delta q_{2}$ only if $V_{i n 1}=V_{i n 2}$. In other words, the overall error is not eliminated for differential signals. Nevertheless, this technique both eliminates the\n\nimage_name:Figure 13.28 Differential sampling circuit\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout1, D: Vin1, G: CK}\nname: M2, type: NMOS, ports: {S: Vout2, D: CK, G: Vin2}\nname: CH1, type: Capacitor, value: CH, ports: {Np: Vout1, Nn: GND}\nname: CH2, type: Capacitor, value: CH, ports: {Np: Vout2, Nn: GND}\n]\nextrainfo:The circuit is a differential sampling circuit using NMOS transistors M1 and M2, controlled by the clock signal CK. Each transistor's drain is connected to the clock, and sources are connected to separate output nodes Vout1 and Vout2. Capacitors CH are used to sample and hold the output voltages.\n\nFigure 13.28 Differential sampling circuit.\nconstant offset and reduces the nonlinear component. This can be understood by writing\n\n$$\n\\begin{align*}\n\\Delta q_{1}-\\Delta q_{2} & =W L C_{o x}\\left[\\left(V_{i n 2}-V_{i n 1}\\right)+\\left(V_{T H 2}-V_{T H 1}\\right)\\right]  \\tag{13.38}\\\\\n& =W L C_{o x}\\left[V_{i n 2}-V_{i n 1}+\\gamma\\left(\\sqrt{2 \\phi_{F}+V_{i n 2}}-\\sqrt{2 \\phi_{F}+V_{i n 1}}\\right)\\right] \\tag{13.39}\n\\end{align*}\n$$\n\nSince for $V_{i n 1}=V_{i n 2}, \\Delta q_{1}-\\Delta q_{2}=0$, the characteristic shows no offset. Additionally, the nonlinearity due to the body effect now appears in both square-root terms of (13.39), resulting in only odd-order distortion (Chapter 14).\n\nThe issue of charge injection continues to constrain the speed-precision balance in sampled-data systems. Numerous cancellation techniques have been proposed, but each introduces its own trade-offs. One such technique, known as \"bottom-plate sampling,\" is widely employed in switched-capacitor circuits and is discussed later in this chapter."
},
{
    "text": "The reliance of charge injection on the input level and the trade-off outlined by (13.34) necessitate methods to counteract charge injection effects to enhance $F$. We explore several such techniques here.\n\nTo introduce the first technique, we propose that the charge injected by the primary transistor can be neutralized using a secondary transistor. As depicted in Fig. 13.25, a \"dummy\" switch, $M_{2}$, activated by $\\overline{C K}$, is incorporated into the circuit so that once $M_{1}$ deactivates and $M_{2}$ activates, the channel charge deposited by $M_{1}$ on $C_{H}$ is absorbed by $M_{2}$ to form a channel. Note that both the source and drain of $M_{2}$ are linked to the output node.\nimage_name:Figure 13.25\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout, D: Vin, G: CK}\nname: M2, type: NMOS, ports: {S: Vout, D: Vout, G: CK_bar}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit employs a dummy NMOS transistor M2 to absorb the charge injected by the main NMOS transistor M1, thereby reducing charge injection and clock feedthrough effects. The charge injected by M1, q1, is counterbalanced by the charge absorbed by M2, q2.\n\nFigure 13.25 Incorporation of dummy device to mitigate charge injection and clock feedthrough.\n\nHow can we ensure that the charge injected by $M_{1}, \\Delta q_{1}$, equals that absorbed by $M_{2}, \\Delta q_{2}$? Assume half of $M_{1}$'s channel charge is injected onto $C_{H}$, i.e.,\n\n$$\n\\begin{equation*}\n\\Delta q_{1}=\\frac{W_{1} L_{1} C_{o x}}{2}\\left(V_{C K}-V_{i n}-V_{T H 1}\\right) \\tag{13.36}\n\\end{equation*}\n$$\n\nGiven $\\Delta q_{2}=W_{2} L_{2} C_{o x}\\left(V_{C K}-V_{i n}-V_{T H 2}\\right)$, if we select $W_{2}=0.5 W_{1}$ and $L_{2}=L_{1}$, then $\\Delta q_{2}=\\Delta q_{1}$. However, the assumption of equal charge distribution between source and drain is generally inaccurate, making this method less appealing.\n\nInterestingly, with the selection $W_{2}=0.5 W_{1}$ and $L_{2}=L_{1}$, the impact of clock feedthrough is diminished. As illustrated in Fig. 13.26, the total charge in $V_{\\text {out }}$ is zero because\n\n$$\n\\begin{equation*}\n-V_{C K} \\frac{W_{1} C_{o v}}{W_{1} C_{o v}+C_{H}+2 W_{2} C_{o v}}+V_{C K} \\frac{2 W_{2} C_{o v}}{W_{1} C_{o v}+C_{H}+2 W_{2} C_{o v}}=0 \\tag{13.37}\n\\end{equation*}\n$$\n\nimage_name:Figure 13.26\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout, D: Vin, G: CK}\nname: M2, type: NMOS, ports: {S: Vout, D: Vout, G: Ck_bar}\nname: Cgs1, type: Capacitor, value: Cgs1, ports: {Np: CK, Nn: Vout}\nname: Cgd2, type: Capacitor, value: Cgd2, ports: {Np: Ck_bar, Nn: Vout}\nname: Cgs2, type: Capacitor, value: Cgs2, ports: {Np: Ck_bar, Nn: Vout}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit employs a charge injection cancellation method using NMOS transistors M1 and M2, along with capacitors, to suppress clock feedthrough. This setup ensures that the total charge at Vout is zero under the specified conditions.\nimage_name:Figure 13.26\ndescription:\n[\nname: W1Cov, type: Capacitor, value: W1Cov, ports: {Np: Ck, Nn: Vout}\nname: 2W2Cov, type: Capacitor, value: 2W2Cov, ports: {Np: Ck_bar, Nn: Vout}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit in Figure 13.26 is designed to suppress clock feedthrough using a dummy switch configuration. It utilizes NMOS transistors M1 and M2, along with capacitors, to achieve charge cancellation. The effect of clock feedthrough is minimized by balancing the charge injection from the transistors. The right side of the diagram shows the equivalent circuit with capacitors W1Cov and 2W2Cov, further aiding in charge cancellation.\n\nFigure 13.26 Suppression of clock feedthrough using a dummy switch.\nAnother method to reduce charge injection involves using both PMOS and NMOS devices so that the opposing charge packets injected by each cancel each other out (Fig. 13.27). For $\\Delta q_{1}$ to cancel $\\Delta q_{2}$, we must have $W_{1} L_{1} C_{o x}\\left(V_{C K}-V_{i n}-V_{T H N}\\right)=W_{2} L_{2} C_{o x}\\left(V_{i n}-\\left|V_{T H P}\\right|\\right)$. Thus, cancellation occurs only at a single input level. Even for clock feedthrough, the circuit does not achieve complete cancellation due to the unequal gate-drain overlap capacitance of NFETs and PFETs.\nimage_name:Figure 13.27\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vin, D: Vout, G: CK}\nname: M2, type: PMOS, ports: {S: Vout, D: Vin, G: CK_bar}\nname: CH, type: Capacitor, value: CH, ports: {Np: Vout, Nn: GND}\n]\nextrainfo:The circuit employs complementary switches (M1 and M2) to mitigate charge injection. M1 injects electrons, while M2 injects holes, aiming to cancel each other's charge injection effects. The capacitor CH is connected between the output node Vout and ground.\n\nFigure 13.27 Utilization of complementary switches to mitigate charge injection.\n\nOur understanding of the benefits of differential circuits suggests that the issue of charge injection can be alleviated through differential operation. As shown in Fig. 13.28, we hypothesize that charge injection manifests as a common-mode disturbance. However, writing $\\Delta q_{1}=W L C_{o x}\\left(V_{C K}-V_{i n 1}-V_{T H 1}\\right)$ and $\\Delta q_{2}=$ $W L C_{o x}\\left(V_{C K}-V_{i n 2}-V_{T H 2}\\right)$, we realize that $\\Delta q_{1}=\\Delta q_{2}$ only if $V_{i n 1}=V_{i n 2}$. In other words, the overall error is not suppressed for differential signals. Nevertheless, this technique both eliminates the\n\nimage_name:Figure 13.28 Differential sampling circuit\ndescription:\n[\nname: M1, type: NMOS, ports: {S: Vout1, D: Vin1, G: CK}\nname: M2, type: NMOS, ports: {S: Vout2, D: CK, G: Vin2}\nname: CH1, type: Capacitor, value: CH, ports: {Np: Vout1, Nn: GND}\nname: CH2, type: Capacitor, value: CH, ports: {Np: Vout2, Nn: GND}\n]\nextrainfo:The circuit is a differential sampling circuit using NMOS transistors M1 and M2, controlled by the clock signal CK. Each transistor's drain is connected to the clock, and sources are connected to separate output nodes Vout1 and Vout2. Capacitors CH are used to sample and hold the output voltages.\n\nFigure 13.28 Differential sampling circuit.\nconstant offset and reduces the nonlinear component. This can be understood by writing\n\n$$\n\\begin{align*}\n\\Delta q_{1}-\\Delta q_{2} & =W L C_{o x}\\left[\\left(V_{i n 2}-V_{i n 1}\\right)+\\left(V_{T H 2}-V_{T H 1}\\right)\\right]  \\tag{13.38}\\\\\n& =W L C_{o x}\\left[V_{i n 2}-V_{i n 1}+\\gamma\\left(\\sqrt{2 \\phi_{F}+V_{i n 2}}-\\sqrt{2 \\phi_{F}+V_{i n 1}}\\right)\\right] \\tag{13.39}\n\\end{align*}\n$$\n\nSince for $V_{i n 1}=V_{i n 2}, \\Delta q_{1}-\\Delta q_{2}=0$, the characteristic shows no offset. Additionally, the nonlinearity due to the body effect now appears in both square-root terms of (13.39), resulting in only odd-order distortion (Chapter 14).\n\nThe issue of charge injection continues to constrain the speed-precision balance in sampled-data systems. Numerous cancellation techniques have been proposed, each introducing its own trade-offs. One such technique, known as \"bottom-plate sampling,\" is widely employed in switched-capacitor circuits and is discussed later in this chapter."
}
]