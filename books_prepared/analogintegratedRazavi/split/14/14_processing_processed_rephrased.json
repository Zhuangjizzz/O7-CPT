[

{
    "text": "A basic oscillator generates a periodic output, typically in the form of voltage. This circuit maintains its output indefinitely without any input. How does a circuit achieve oscillation? Refer to Chapter 10, which explains that negative-feedback systems can oscillate, meaning an oscillator is essentially a poorly-designed feedback amplifier! ${ }^{1}$ Consider the unity-gain negative-feedback circuit illustrated in Fig. 15.1, where\n\n$$\n\\begin{equation*}\n\\frac{V_{\\text {out }}}{V_{\\text {in }}}(s)=\\frac{H(s)}{1+H(s)} \\tag{15.1}\n\\end{equation*}\n$$\n\nAs discussed in Chapter 10, if the amplifier undergoes significant phase shift at high frequencies, causing the overall feedback to become positive, oscillation may ensue. Specifically, if for $s=j \\omega_{0}, H\\left(j \\omega_{0}\\right)=-1$, the closed-loop gain approaches infinity at $\\omega_{0}$. Under this condition, the circuit continuously amplifies its noise components at $\\omega_{0}$. As depicted conceptually in Fig. 15.2, a noise component at $\\omega_{0}$ undergoes a total gain of unity and a phase shift of $180^{\\circ}$, returning to the subtractor as a negative version of the input. This results in a larger difference between the input and feedback signals, allowing the component at $\\omega_{0}$ to grow through continuous \"regeneration.\"\n\nimage_name:Figure 15.1 Feedback system\ndescription:The feedback system in Figure 15.1 features a fundamental closed-loop configuration comprising:\n\n1. **Adder/Subtractor (Summing Junction):** This block accepts two inputs and produces one output, subtracting the feedback signal from the input signal \\( V_{in} \\). The output is the difference between \\( V_{in} \\) and the feedback signal.\n\n2. **Amplifier Block \\( H(s) \\):** Representing the system's transfer function, this block amplifies the signal from the summing junction. The gain and phase characteristics are defined by \\( H(s) \\), a function of the complex frequency variable \\( s \\).\n\n3. **Feedback Path:** The output \\( V_{out} \\) is routed back to the summing junction, providing negative feedback.\n\n**Flow of Information:**\n- The input signal \\( V_{in} \\) enters the summing junction, where it is combined with the feedback signal.\n- The resulting difference signal is amplified by \\( H(s) \\).\n- The amplified output \\( V_{out} \\) is then fed back to the subtractor, forming a closed-loop.\n\n**Overall System Function:**\n- This feedback system aims to control \\( V_{out} \\) by adjusting \\( V_{in} \\) and the feedback loop. Negative feedback stabilizes the system, mitigating disturbances and maintaining the desired output. The loop gain and phase characteristics are vital for stability and performance, particularly in preventing oscillations and ensuring the desired response.\n\nimage_name:Evolution of oscillatory system with time.\ndescription:The feedback system in Figure 15.1 is designed to regulate an output voltage \\( V_{out} \\) using a feedback loop. It comprises repeating blocks that stabilize and control the output.\n\n1. **Main Components:**\n- **Input Signal \\( V_0 \\):** The system initiates with an input signal \\( V_0 \\), subject to control and feedback.\n- **Summing Junctions:** Represented by circles with plus and minus signs, these combine the input with the feedback signal.\n- **Amplifiers \\( H(s) \\):** Each block includes an amplifier labeled \\( H(s) \\), processing the signal from the summing junction. \\( H(s) \\) indicates the system's transfer function in the Laplace domain, signifying frequency domain operation.\n- **Feedback Loops:** Each block feeds the amplifier's output back to the summing junction, creating a closed-loop.\n\n2. **Flow of Information or Control:**\n- The input signal \\( V_0 \\) enters the first summing junction, combined with the feedback signal.\n- The resulting signal is amplified by \\( H(s) \\) and fed to the next stage.\n- This process repeats through multiple stages, each with a summing junction and amplifier, and feedback loop.\n- The signal progresses sequentially from left to right, with feedback loops ensuring stability and control.\n\n3. **Labels, Annotations, and Key Indicators:**\n- \\( H(s) \\) denotes the transfer function of each amplifier, indicating frequency domain analysis.\n- Plus and minus signs at summing junctions signify the combination of positive input signals with negative feedback.\n\n4. **Overall System Function:**\n- The primary function is to control \\( V_{out} \\) by adjusting \\( V_{in} \\) and the feedback loop. Negative feedback stabilizes the system, reduces disturbances, and maintains the desired output. Loop gain and phase characteristics are crucial for stability and performance, particularly in preventing oscillations and ensuring the desired response. The design allows for dynamic control, suitable for precise output regulation applications.\n\nFigure 15.2 Evolution of oscillatory system with time.\n\nFor oscillation to initiate, a loop gain of unity or higher is essential. This can be observed by tracing the signal around the loop over multiple cycles and expressing the subtractor's output amplitude in Fig. 15.2 as a geometric series (if $\\angle H\\left(j \\omega_{0}\\right)=180^{\\circ}$ ):\n\n$$\n\\begin{equation*}\nV_{X}=V_{0}+\\left|H\\left(j \\omega_{0}\\right)\\right| V_{0}+\\left|H\\left(j \\omega_{0}\\right)\\right|^{2} V_{0}+\\left|H\\left(j \\omega_{0}\\right)\\right|^{3} V_{0}+\\cdots \\tag{15.2}\n\\end{equation*}\n$$\n\nIf $\\left|H\\left(j \\omega_{0}\\right)\\right|>1$, the series diverges, whereas if $\\left|H\\left(j \\omega_{0}\\right)\\right|<1$, then\n\n$$\n\\begin{equation*}\nV_{X}=\\frac{V_{0}}{1-\\left|H\\left(j \\omega_{0}\\right)\\right|}<\\infty \\tag{15.3}\n\\end{equation*}\n$$\n\nIn summary, if a negative-feedback circuit has a loop gain meeting two conditions:\n\n$$\n\\begin{align*}\n\\left|H\\left(j \\omega_{0}\\right)\\right| & \\geq 1  \\tag{15.4}\\\\\n\\angle H\\left(j \\omega_{0}\\right) & =180^{\\circ} \\tag{15.5}\n\\end{align*}\n$$\n\nthe circuit may oscillate at $\\omega_{0}$. These conditions, known as \"Barkhausen criteria,\" are necessary but not sufficient [1]. ${ }^{2}$ To ensure oscillation despite temperature and process variations, the loop gain is typically chosen to be at least twice or thrice the required value.\n\nThe second Barkhausen criterion can be stated as $\\angle H(j \\omega)=180^{\\circ}$, or a total phase shift of $360^{\\circ}$. This should not be confusing: if the system is designed for low-frequency negative feedback, it already produces $180^{\\circ}$ of phase shift in the signal loop (as shown by the subtractor in Fig. 15.1), and $\\angle H(j \\omega)=180^{\\circ}$ denotes an additional frequency-dependent phase shift that, as shown in Fig. 15.2, ensures the feedback signal reinforces the original signal. Thus, the three cases in Fig. 15.3 are equivalent in terms of the second criterion. We say that the system in Fig. 15.3(a) exhibits a frequency-dependent phase shift of $180^{\\circ}$ (indicated by the arrow) and a DC phase shift of $180^{\\circ}$. The difference between Figs. 15.3(b) and (c) is that the open-loop amplifier in (b) includes enough stages with proper polarities to provide a total phase shift of $360^{\\circ}$ at $\\omega_{0}$, whereas in (c), it produces no phase shift at $\\omega_{0}$. Examples of these topologies are discussed later in this chapter.\n\nimage_name:(a)\ndescription:The block diagram labeled \"(a)\" represents an oscillatory feedback system with a frequency-dependent phase shift and a DC phase shift of 180 degrees. It includes:\n\n1. **Main Components:**\n- **Summing Junction:** Depicted as a circle with a plus sign, it combines input signals, having two inputs (positive and negative).\n- **Amplifier Block:** Represented by a triangle labeled \\( H(j\\omega) \\), it processes the input signal, introducing a phase shift.\n\n2. **Flow of Information or Control:**\n- The input signal enters the summing junction.\n- The output is fed into the amplifier \\( H(j\\omega) \\), which modifies the signal.\n- The amplified signal is fed back to the negative input of the summing junction, forming a feedback loop.\n\n3. **Labels, Annotations, and Key Indicators:**\n- An arrow labeled \"180°\" indicates a frequency-dependent phase shift of 180 degrees in the feedback path.\n- Plus and minus signs at the summing junction indicate input polarities.\n\n4. **Overall System Function:**\n- The primary function is to create oscillations through feedback. The phase shift introduced by the amplifier and feedback loop is critical for sustained oscillations. The total phase shift around the loop must be 360 degrees, facilitated by the 180-degree phase shift in the feedback path and the amplifier's phase characteristics.\n\nimage_name:(b)\ndescription:The block diagram labeled \"(b)\" represents an oscillatory feedback system designed to generate sustained oscillations, consisting of:\n\n1. **Amplifier Block (H(jω))**: This block introduces a specific phase shift and gain to the signal, crucial for achieving the required total phase shift for oscillation.\n\n2. **Summing Junction:** Depicted as a circle with a plus sign, it combines the input signal with the feedback signal, essential for creating oscillation conditions.\n\n3. **Feedback Path:** This path loops back from the amplifier's output to the summing junction, introducing a 360-degree phase shift, including a 180-degree inherent phase shift and additional phase shift from the amplifier.\n\n**Flow of Information:**\n- The signal flows from the summing junction to the amplifier, where it is amplified and phase-shifted.\n- The output is fed back to the summing junction through the feedback path.\n- The feedback loop maintains oscillations by ensuring continuous signal recycling.\n\n**Overall System Function:**\nThe system generates oscillations by maintaining a total phase shift of 360 degrees around the loop, achieved through the amplifier's phase characteristics and feedback path. This design sustains oscillations, critical for applications like ring oscillators in CMOS technology.\n\nimage_name:Figure 15.3(c)\ndescription:The block diagram in Figure 15.3(c) represents an oscillatory feedback system designed to generate oscillations with a total phase shift of 360 degrees around the loop. It includes:\n\n1. **Summation Block (+):** This block combines the input and feedback signals, depicted as a circle with a plus sign.\n\n2. **Amplifier Block (H(jω)):** This block amplifies and phase-shifts the combined signal, crucial for achieving the total 360-degree phase shift required for oscillation.\n\n3. **Feedback Path:** The amplifier's output is fed back to the summation block, depicted with an arrow indicating a 0-degree phase shift.\n\n**Flow of Information:**\n- The input signal enters the summation block, combined with the feedback signal.\n- The resultant signal is amplified by \\( H(jω) \\).\n- The output is fed back through the feedback path to the summation block, completing the loop.\n\n**Overall System Function:**\nThe system sustains oscillations by ensuring phase and gain conditions for oscillation are met. The amplifier provides necessary gain and phase shift, while the feedback loop ensures a total phase shift of 360 degrees. This configuration is typical in ring oscillators, especially in CMOS technology, for generating clock signals and periodic waveforms.\n\nFigure 15.3 Various views of oscillatory feedback system.\nCMOS oscillators in modern technology are commonly implemented as \"ring oscillators\" or \"LC oscillators.\" Each type is explored in the following sections."
},
{
    "text": "A basic oscillator generates a periodic output, typically in the form of voltage. This circuit operates without an input while maintaining the output indefinitely. How does a circuit achieve oscillation? Refer to Chapter 10, which explains that negative-feedback systems can oscillate, essentially making an oscillator a poorly-designed feedback amplifier! ${ }^{1}$ Consider the unity-gain negative-feedback circuit illustrated in Fig. 15.1, where\n\n$$\n\\begin{equation*}\n\\frac{V_{\\text {out }}}{V_{\\text {in }}}(s)=\\frac{H(s)}{1+H(s)} \\tag{15.1}\n\\end{equation*}\n$$\n\nAs discussed in Chapter 10, if the amplifier undergoes significant phase shift at high frequencies, causing the overall feedback to become positive, oscillation may result. More precisely, if for $s=j \\omega_{0}, H\\left(j \\omega_{0}\\right)=-1$, the closed-loop gain approaches infinity at $\\omega_{0}$. Under this condition, the circuit continuously amplifies its noise components at $\\omega_{0}$. As depicted conceptually in Fig. 15.2, a noise component at $\\omega_{0}$ undergoes a total gain of unity and a phase shift of $180^{\\circ}$, returning to the subtractor as a negative version of the input. This subtraction results in a larger difference, allowing the component at $\\omega_{0}$ to grow through continuous \"regeneration.\"\n\nimage_name:Figure 15.1 Feedback system\ndescription:Figure 15.1 depicts a feedback system with a basic closed-loop configuration comprising the following key components:\n\n1. **Adder/Subtractor (Summing Junction):** This block has two inputs and one output, tasked with subtracting the feedback signal from the input signal \\( V_{in} \\). The output is the difference between \\( V_{in} \\) and the feedback signal.\n\n2. **Amplifier Block \\( H(s) \\):** Representing the system's transfer function, this block amplifies the signal from the summing junction. The gain and phase characteristics are defined by \\( H(s) \\), a function of the complex frequency variable \\( s \\).\n\n3. **Feedback Path:** The output \\( V_{out} \\) is routed back to the summing junction, providing negative feedback.\n\n**Flow of Information:**\n- The input signal \\( V_{in} \\) enters the summing junction, where it is reduced by the feedback signal.\n- The resulting difference signal is amplified by \\( H(s) \\).\n- The amplified output \\( V_{out} \\) is then fed back to the subtractor, forming a closed-loop.\n\n**Overall System Function:**\n- The system aims to control \\( V_{out} \\) by adjusting \\( V_{in} \\) and the feedback loop, with negative feedback stabilizing the system, mitigating disturbances, and maintaining the desired output. The loop gain and phase characteristics are vital for stability and performance, particularly in preventing oscillations and ensuring the desired response.\n\nimage_name:Evolution of oscillatory system with time.\ndescription:Figure 15.1's feedback system is designed to control output voltage \\( V_{out} \\) via a feedback loop. It consists of repeating blocks that stabilize and control the output.\n\n1. **Main Components:**\n- **Input Signal \\( V_0 \\):** The system initiates with \\( V_0 \\), subject to control and feedback.\n- **Summing Junctions:** These circles combine input and feedback signals, with the positive input and negative feedback.\n- **Amplifiers \\( H(s) \\):** Each block contains an amplifier labeled \\( H(s) \\), processing signals in the frequency domain.\n- **Feedback Loops:** Each block feeds the amplifier's output back to the summing junction, forming a closed-loop.\n\n2. **Flow of Information or Control:**\n- \\( V_0 \\) enters the first summing junction, combined with feedback.\n- The signal is amplified by \\( H(s) \\) and fed to the next stage.\n- This process repeats through multiple stages, ensuring stability and control.\n\n3. **Labels, Annotations, and Key Indicators:**\n- \\( H(s) \\) indicates the transfer function, analyzing behavior in the frequency domain.\n- Summing junctions show input and feedback combination.\n\n4. **Overall System Function:**\n- The system controls \\( V_{out} \\) by adjusting \\( V_{in} \\) and feedback, stabilizing output and reducing disturbances. Loop gain and phase characteristics are crucial for stability and performance, making it suitable for precise output regulation.\n\nFigure 15.2 Evolution of oscillatory system with time.\n\nFor oscillation to initiate, a loop gain of unity or higher is essential. This is evident by tracing the signal through multiple cycles in Fig. 15.2 and expressing the subtractor's output amplitude as a geometric series (if $\\angle H\\left(j \\omega_{0}\\right)=180^{\\circ}$ ):\n\n$$\n\\begin{equation*}\nV_{X}=V_{0}+\\left|H\\left(j \\omega_{0}\\right)\\right| V_{0}+\\left|H\\left(j \\omega_{0}\\right)\\right|^{2} V_{0}+\\left|H\\left(j \\omega_{0}\\right)\\right|^{3} V_{0}+\\cdots \\tag{15.2}\n\\end{equation*}\n$$\n\nIf $\\left|H\\left(j \\omega_{0}\\right)\\right|>1$, the series diverges, but if $\\left|H\\left(j \\omega_{0}\\right)\\right|<1$, then\n\n$$\n\\begin{equation*}\nV_{X}=\\frac{V_{0}}{1-\\left|H\\left(j \\omega_{0}\\right)\\right|}<\\infty \\tag{15.3}\n\\end{equation*}\n$$\n\nIn summary, if a negative-feedback circuit's loop gain meets two conditions:\n\n$$\n\\begin{align*}\n\\left|H\\left(j \\omega_{0}\\right)\\right| & \\geq 1  \\tag{15.4}\\\\\n\\angle H\\left(j \\omega_{0}\\right) & =180^{\\circ} \\tag{15.5}\n\\end{align*}\n$$\n\nthe circuit may oscillate at $\\omega_{0}$. These conditions, known as \"Barkhausen criteria,\" are necessary but not sufficient [1]. ${ }^{2}$ To ensure oscillation despite temperature and process variations, the loop gain is often set to at least twice or thrice the required value.\n\nThe second Barkhausen criterion can be stated as $\\angle H(j \\omega)=180^{\\circ}$, equivalent to a total phase shift of $360^{\\circ}$. This should not be confusing: if the system is designed for low-frequency negative feedback, it already introduces $180^{\\circ}$ of phase shift in the loop (as shown by the subtractor in Fig. 15.1), and $\\angle H(j \\omega)=180^{\\circ}$ indicates an additional frequency-dependent phase shift, ensuring the feedback signal reinforces the original signal, as illustrated in Fig. 15.2. Thus, the three cases in Fig. 15.3 are equivalent regarding the second criterion. We say that Fig. 15.3(a) exhibits a frequency-dependent phase shift of $180^{\\circ}$ (indicated by the arrow) and a dc phase shift of $180^{\\circ}$. The difference between Figs. 15.3(b) and (c) is that the former's open-loop amplifier includes enough stages to provide a total phase shift of $360^{\\circ}$ at $\\omega_{0}$, while the latter produces no phase shift at $\\omega_{0}$. Examples of these configurations are discussed later in this chapter.\n\nimage_name:(a)\ndescription:The block diagram labeled (a) represents an oscillatory feedback system with a frequency-dependent phase shift and a DC phase shift of 180 degrees. It includes:\n\n1. **Main Components:**\n- **Summing Junction:** A circular block with a plus sign, combining input signals.\n- **Amplifier Block:** A triangular symbol labeled \\( H(j\\omega) \\), introducing a frequency-dependent phase shift.\n\n2. **Flow of Information or Control:**\n- The input signal enters the summing junction.\n- The output is amplified by \\( H(j\\omega) \\), introducing a phase shift.\n- The feedback loop returns the output to the negative input of the summing junction.\n\n3. **Labels, Annotations, and Key Indicators:**\n- An arrow labeled \"180°\" indicates the frequency-dependent phase shift.\n- Plus and minus signs show input polarities.\n\n4. **Overall System Function:**\n- The system creates oscillations through feedback, with the phase shift and feedback loop crucial for sustained oscillations. The total phase shift must be 360 degrees, facilitated by the 180-degree phase shift in the feedback path and the amplifier's phase characteristics.\n\nimage_name:(b)\ndescription:The block diagram labeled \"(a)\" represents an oscillatory feedback system designed for sustained oscillations, comprising:\n\n1. **Amplifier Block (H(jω))**: This block introduces a specific phase shift and gain, crucial for achieving the required total phase shift for oscillation.\n\n2. **Summing Junction:** A circle with a plus sign, combining input and feedback signals.\n\n3. **Feedback Path**: This path loops back from the amplifier's output to the summing junction, introducing a 360-degree phase shift, including a 180-degree inherent phase shift and additional phase shift from the amplifier.\n\n**Flow of Information:**\n- The signal flows from the summing junction to the amplifier, undergoes amplification and phase shift, and is fed back through the feedback path.\n\n**Overall System Function:**\nThe system generates oscillations by maintaining a 360-degree phase shift around the loop, achieved through the amplifier's phase characteristics and feedback path. This configuration is typical in ring oscillators, especially in CMOS technology.\n\nimage_name:Figure 15.3(c)\ndescription:Figure 15.3(c) shows an oscillatory feedback system designed to sustain oscillations with a 360-degree phase shift around the loop. It includes:\n\n1. **Summation Block (+):** A circle with a plus sign, combining input and feedback signals.\n\n2. **Amplifier Block (H(jω)):** This block amplifies and phase-shifts the combined signal, crucial for achieving the required phase shift for oscillation.\n\n3. **Feedback Path:** The amplifier's output is fed back to the summation block, depicted with an arrow indicating a 0-degree phase shift.\n\n**Flow of Information:**\n- The input signal combines with the feedback signal at the summation block.\n- The resultant signal is amplified by \\( H(j\\omega) \\).\n- The output is fed back through the feedback path, completing the loop.\n\n**Overall System Function:**\nThe system sustains oscillations by ensuring the phase and gain conditions for oscillation are met. The amplifier provides the necessary gain and phase shift, while the feedback loop ensures a 360-degree total phase shift, typical in ring oscillators in CMOS technology.\n\nFigure 15.3 Various views of oscillatory feedback system.\nCMOS oscillators in modern technology are commonly implemented as \"ring oscillators\" or \"LC oscillators.\" These types are explored in the following sections."
},
{
    "text": "A basic oscillator generates a periodic output, typically in the form of voltage. Consequently, the circuit operates without an input while maintaining the output indefinitely. How does a circuit achieve oscillation? Refer to Chapter 10, which explains that negative-feedback systems can oscillate, meaning an oscillator is essentially a poorly-designed feedback amplifier! ${ }^{1}$ Consider the unity-gain negative-feedback circuit illustrated in Fig. 15.1, where\n\n$$\n\\begin{equation*}\n\\frac{V_{\\text {out }}}{V_{\\text {in }}}(s)=\\frac{H(s)}{1+H(s)} \\tag{15.1}\n\\end{equation*}\n$$\n\nAs discussed in Chapter 10, if the amplifier undergoes significant phase shift at high frequencies, causing the overall feedback to become positive, oscillation may ensue. More precisely, if for $s=j \\omega_{0}, H\\left(j \\omega_{0}\\right)=-1$, the closed-loop gain tends to infinity at $\\omega_{0}$. Under this scenario, the circuit perpetually amplifies its noise components at $\\omega_{0}$. In essence, as depicted conceptually in Fig. 15.2, a noise component at $\\omega_{0}$ undergoes a total gain of unity and a phase shift of $180^{\\circ}$, returning to the subtractor as a negative version of the input. This results in a larger difference upon subtraction, allowing the circuit to \"regenerate\" and enabling the component at $\\omega_{0}$ to amplify.\n\nimage_name:Figure 15.1 Feedback system\ndescription:The feedback system shown in Figure 15.1 comprises a fundamental closed-loop configuration with the following key components:\n\n1. **Adder/Subtractor (Summing Junction):** This block features two inputs and one output. It receives the input signal \\( V_{in} \\) and subtracts the feedback signal from it, producing the difference as its output.\n\n2. **Amplifier Block \\( H(s) \\):** This block represents the system's transfer function and amplifies the signal received from the summing junction. The gain and phase characteristics of this block are determined by \\( H(s) \\), which is a function of the complex frequency variable \\( s \\).\n\n3. **Feedback Path:** The output \\( V_{out} \\) is routed back to the summing junction, forming a negative feedback loop.\n\n**Flow of Information:**\n- The input signal \\( V_{in} \\) enters the summing junction, where it is combined with the feedback signal.\n- The resulting difference signal is then processed by the amplifier \\( H(s) \\), which amplifies it according to the transfer function.\n- The amplified output \\( V_{out} \\) is subsequently fed back to the subtractor, creating a closed-loop system.\n\n**Overall System Function:**\n- The main function of this feedback system is to regulate the output \\( V_{out} \\) by adjusting the input \\( V_{in} \\) and the feedback loop. The negative feedback aims to stabilize the system by mitigating the impact of disturbances and maintaining the desired output level. The loop gain and phase characteristics are critical in determining the system's stability and performance, particularly in preventing oscillations and ensuring the desired response.\n\nimage_name:Evolution of oscillatory system with time.\ndescription:The feedback system in Figure 15.1 is designed to control the output voltage \\( V_{out} \\) using a feedback loop. It consists of several key components arranged in a series of repeating blocks, each performing a similar function to stabilize and control the output.\n\n1. **Main Components:**\n- **Input Signal \\( V_0 \\):** The system initiates with an input signal \\( V_0 \\), which is subject to control and feedback.\n- **Summing Junctions:** Represented by circles with plus and minus signs, these junctions combine the input signal with the feedback signal. The positive input is the incoming signal, while the negative input is the feedback.\n- **Amplifiers \\( H(s) \\):** Each block contains an amplifier labeled \\( H(s) \\), which processes the signal from the summing junction. The function \\( H(s) \\) represents the system's transfer function in the Laplace domain, indicating frequency domain operation.\n- **Feedback Loops:** Each block includes a feedback loop that routes the amplifier's output back to the summing junction, forming a closed-loop system.\n\n2. **Flow of Information or Control:**\n- The input signal \\( V_0 \\) is introduced at the first summing junction, where it is combined with the feedback signal.\n- The resultant signal is amplified by the first amplifier \\( H(s) \\), and the output is fed into the next stage.\n- This process repeats through multiple stages, each comprising a summing junction and an amplifier with a feedback loop.\n- The signal flows sequentially from left to right through the system, with feedback loops in each stage ensuring stability and control.\n\n3. **Labels, Annotations, and Key Indicators:**\n- The notation \\( H(s) \\) indicates the transfer function of each amplifier, suggesting frequency domain analysis.\n- The plus and minus signs at the summing junctions denote the combination of positive input signals with negative feedback.\n\n4. **Overall System Function:**\n- The primary function of this feedback system is to control the output \\( V_{out} \\) by adjusting the input \\( V_{in} \\) and the feedback loop. The negative feedback aims to stabilize the system by reducing the effect of disturbances and maintaining the desired output level. The loop gain and phase characteristics are crucial in determining the stability and performance of the system, particularly in preventing oscillations and ensuring the desired response. The system’s design allows for dynamic control, making it suitable for applications requiring precise output regulation.\n\nFigure 15.2 Evolution of oscillatory system with time.\n\nFor oscillation to initiate, a loop gain of unity or greater is essential. This can be observed by tracing the signal around the loop over multiple cycles and expressing the amplitude of the subtractor's output in Fig. 15.2 as a geometric series (if $\\angle H\\left(j \\omega_{0}\\right)=180^{\\circ}$ ):\n\n$$\n\\begin{equation*}\nV_{X}=V_{0}+\\left|H\\left(j \\omega_{0}\\right)\\right| V_{0}+\\left|H\\left(j \\omega_{0}\\right)\\right|^{2} V_{0}+\\left|H\\left(j \\omega_{0}\\right)\\right|^{3} V_{0}+\\cdots \\tag{15.2}\n\\end{equation*}\n$$\n\nIf $\\left|H\\left(j \\omega_{0}\\right)\\right|>1$, the above series diverges, whereas if $\\left|H\\left(j \\omega_{0}\\right)\\right|<1$, then\n\n$$\n\\begin{equation*}\nV_{X}=\\frac{V_{0}}{1-\\left|H\\left(j \\omega_{0}\\right)\\right|}<\\infty \\tag{15.3}\n\\end{equation*}\n$$\n\nIn summary, if a negative-feedback circuit has a loop gain that meets two conditions:\n\n$$\n\\begin{align*}\n\\left|H\\left(j \\omega_{0}\\right)\\right| & \\geq 1  \\tag{15.4}\\\\\n\\angle H\\left(j \\omega_{0}\\right) & =180^{\\circ} \\tag{15.5}\n\\end{align*}\n$$\n\nthen the circuit may oscillate at $\\omega_{0}$. These conditions, known as \"Barkhausen criteria,\" are necessary but not sufficient [1]. ${ }^{2}$ To ensure oscillation despite temperature and process variations, the loop gain is typically chosen to be at least twice or three times the required value.\n\nThe second Barkhausen criterion can be stated as $\\angle H(j \\omega)=180^{\\circ}$ or a total phase shift of $360^{\\circ}$. This should not be confusing: if the system is designed for low-frequency negative feedback, it already introduces $180^{\\circ}$ of phase shift in the signal traveling around the loop (as depicted by the subtractor in Fig. 15.1), and $\\angle H(j \\omega)=180^{\\circ}$ denotes an additional frequency-dependent phase shift that, as shown in Fig. 15.2, ensures the feedback signal reinforces the original signal. Thus, the three cases illustrated in Fig. 15.3 are equivalent in terms of the second criterion. We say that the system in Fig. 15.3(a) exhibits a frequency-dependent phase shift of $180^{\\circ}$ (indicated by the arrow) and a DC phase shift of $180^{\\circ}$. The difference between Figs. 15.3(b) and (c) is that the open-loop amplifier in the former includes enough stages with proper polarities to provide a total phase shift of $360^{\\circ}$ at $\\omega_{0}$, whereas the latter produces no phase shift at $\\omega_{0}$. Examples of these topologies are presented later in this chapter.\n\nimage_name:(a)\ndescription:The block diagram labeled as (a) represents an oscillatory feedback system characterized by a frequency-dependent phase shift and a DC phase shift of 180 degrees. The main components include a summing junction and an amplifier block denoted by \\( H(j\\omega) \\).\n\n1. **Main Components:**\n- **Summing Junction:** Depicted as a circular block with a plus sign, it combines input signals, featuring two inputs: one positive and one negative.\n- **Amplifier Block:** Represented by a triangular symbol labeled \\( H(j\\omega) \\), it processes the input signal and provides amplification, introducing a frequency-dependent phase shift.\n\n2. **Flow of Information or Control:**\n- The input signal enters the system at the left side of the summing junction.\n- The output from the summing junction is fed into the amplifier block \\( H(j\\omega) \\).\n- The amplifier modifies the signal, introducing a phase shift, and the output is then fed back into the negative input of the summing junction, forming a feedback loop.\n\n3. **Labels, Annotations, and Key Indicators:**\n- The arrow labeled \"180°\" indicates a frequency-dependent phase shift of 180 degrees in the feedback path.\n- The plus and minus signs at the summing junction indicate the polarities of the inputs.\n\n4. **Overall System Function:**\n- The primary function of this system is to create oscillations through feedback. The phase shift introduced by the amplifier and the feedback loop is critical for achieving the conditions necessary for sustained oscillations. The total phase shift around the loop must be 360 degrees (or a multiple thereof) for oscillation to occur, facilitated by the 180-degree phase shift in the feedback path and the inherent phase characteristics of the amplifier \\( H(j\\omega) \\).\n\nimage_name:(b)\ndescription:The block diagram labeled as \"(a)\" represents an oscillatory feedback system designed to generate sustained oscillations. It consists of the following main components:\n\n1. **Amplifier Block (H(jω))**: This block represents the amplifier in the system, introducing a specific phase shift and gain to the signal. The amplifier's phase characteristics are crucial for achieving the total required phase shift for oscillation.\n\n2. **Summing Junction**: Depicted as a circle with a plus sign inside, it combines the input signal with the feedback signal. This summing action is essential for creating the conditions necessary for oscillation by ensuring the feedback signal is appropriately added to the input.\n\n3. **Feedback Path**: The feedback path loops back from the amplifier's output to the summing junction, introducing a 360-degree phase shift, which includes a 180-degree phase shift inherent in the feedback path itself, and the remaining phase shift is provided by the amplifier.\n\n**Flow of Information:**\n- The signal flows from the summing junction to the amplifier, where it is amplified and phase-shifted.\n- The output of the amplifier is fed back into the summing junction through the feedback path.\n- The feedback loop is crucial for maintaining oscillations by ensuring the signal is continually recycled through the system.\n\n**Overall System Function:**\nThe primary function of this system is to generate oscillations by maintaining a total phase shift of 360 degrees around the loop. This is achieved through the combination of the amplifier's phase characteristics and the feedback path. The system is designed to sustain oscillations by ensuring the phase and gain conditions for oscillation are met, which is critical for applications such as ring oscillators in CMOS technology.\n\nimage_name:Figure 15.3(c)\ndescription:The block diagram in Figure 15.3 represents an oscillatory feedback system designed to generate oscillations by maintaining a total phase shift of 360 degrees around the loop. The system consists of the following main components:\n\n1. **Summation Block (+):** This block combines the input signal with the feedback signal, depicted as a circle with a plus sign inside, indicating an addition operation. The input and feedback signals are combined here to form the input to the next stage.\n\n2. **Amplifier Block (H(jω)):** Following the summation block, the combined signal is fed into an amplifier, represented by a triangle labeled H(jω). This amplifier provides the necessary gain and phase shift to sustain oscillations. The phase shift introduced by this block is crucial for achieving the total 360-degree phase shift required for oscillation.\n\n3. **Feedback Path:** The output of the amplifier is fed back to the summation block through a feedback path, depicted with an arrow indicating a 0-degree phase shift, suggesting in-phase feedback at this point in the loop.\n\n**Flow of Information:**\n- The input signal enters the summation block, where it is combined with the feedback signal.\n- The resultant signal is then amplified by the amplifier block H(jω).\n- The output of the amplifier is sent back through the feedback path to the summation block, completing the loop.\n\n**Overall System Function:**\nThe primary function of this system is to sustain oscillations by ensuring the phase and gain conditions for oscillation are met. The amplifier provides the necessary gain and phase shift, while the feedback loop ensures the total phase shift around the loop is 360 degrees. This configuration is typical in ring oscillators, particularly in CMOS technology, where such systems are used to generate clock signals and other periodic waveforms.\n\nFigure 15.3 Various views of oscillatory feedback system.\nCMOS oscillators in today's technology are typically implemented as \"ring oscillators\" or \"LC oscillators.\" We study each type in the following sections."
},
{
    "text": "A basic oscillator generates a periodic output, typically in the form of voltage. This circuit operates without an input while maintaining the output indefinitely. How does such a circuit oscillate? Refer to Chapter 10, which explains that negative-feedback systems can oscillate; essentially, an oscillator is a poorly-designed feedback amplifier! ${ }^{1}$ Consider the unity-gain negative-feedback circuit illustrated in Fig. 15.1, where\n\n$$\n\\begin{equation*}\n\\frac{V_{\\text {out }}}{V_{\\text {in }}}(s)=\\frac{H(s)}{1+H(s)} \\tag{15.1}\n\\end{equation*}\n$$\n\nAs discussed in Chapter 10, if the amplifier undergoes significant phase shift at high frequencies, causing the overall feedback to become positive, oscillation may result. Specifically, if for $s=j \\omega_{0}, H\\left(j \\omega_{0}\\right)=-1$, the closed-loop gain tends to infinity at $\\omega_{0}$. Under this scenario, the circuit indefinitely amplifies its own noise components at $\\omega_{0}$. In fact, as shown conceptually in Fig. 15.2, a noise component at $\\omega_{0}$ undergoes a total gain of unity and a phase shift of $180^{\\circ}$, returning to the subtractor as a negative version of the input. Upon subtraction, the input and feedback signals produce a larger difference. Thus, the circuit \"regenerates,\" allowing the component at $\\omega_{0}$ to increase.\n\nimage_name:Figure 15.1 Feedback system\ndescription:The feedback system in Figure 15.1 comprises a basic closed-loop configuration with the following key components:\n\n1. **Adder/Subtractor (Summing Junction):** This block has two inputs and one output. It receives the input signal \\( V_{in} \\) and subtracts the feedback signal from it. The output is the difference between \\( V_{in} \\) and the feedback signal.\n\n2. **Amplifier Block \\( H(s) \\):** This block represents the system's transfer function and amplifies the signal from the summing junction. The gain and phase characteristics are defined by \\( H(s) \\), a function of the complex frequency variable \\( s \\).\n\n3. **Feedback Path:** The output \\( V_{out} \\) is returned to the summing junction. The feedback loop includes a direct connection from the output to the subtractor input, providing negative feedback.\n\n**Flow of Information:**\n- The input signal \\( V_{in} \\) enters the summing junction, where the feedback signal is subtracted.\n- The resulting difference signal is then amplified by \\( H(s) \\).\n- The amplified output \\( V_{out} \\) is fed back into the subtractor, forming a closed-loop system.\n\n**Overall System Function:**\n- The main function of this feedback system is to control \\( V_{out} \\) by adjusting \\( V_{in} \\) and the feedback loop. The negative feedback aims to stabilize the system by minimizing disturbances and maintaining the desired output. The loop gain and phase characteristics are crucial for stability and performance, particularly in preventing oscillations and ensuring the desired response.\n\nimage_name:Evolution of oscillatory system with time.\ndescription:The feedback system in Figure 15.1 is designed to control the output voltage \\( V_{out} \\) using a feedback loop. It consists of several key components arranged in repeating blocks to stabilize and control the output.\n\n1. **Main Components:**\n- **Input Signal \\( V_0 \\):** The system starts with an input signal \\( V_0 \\), subject to control and feedback.\n- **Summing Junctions:** Represented by circles with plus and minus signs, these combine the input signal with the feedback signal. The positive input is the incoming signal, while the negative input is the feedback.\n- **Amplifiers \\( H(s) \\):** Each block contains an amplifier labeled \\( H(s) \\), processing the signal from the summing junction. \\( H(s) \\) represents the system's transfer function in the Laplace domain, indicating frequency domain operation.\n- **Feedback Loops:** Each block has a feedback loop that returns the amplifier's output to the summing junction, creating a closed-loop system.\n\n2. **Flow of Information or Control:**\n- The input signal \\( V_0 \\) enters the first summing junction, combined with the feedback signal.\n- The resulting signal is amplified by the first \\( H(s) \\), and the output is fed to the next stage.\n- This process repeats through multiple stages, each with a summing junction and an amplifier with feedback.\n- The signal flows sequentially from left to right, with feedback loops in each stage ensuring stability and control.\n\n3. **Labels, Annotations, and Key Indicators:**\n- The notation \\( H(s) \\) indicates the transfer function of each amplifier, suggesting frequency domain analysis.\n- The plus and minus signs at the summing junctions indicate the combination of positive input signals with negative feedback.\n\n4. **Overall System Function:**\n- The primary function is to control \\( V_{out} \\) by adjusting \\( V_{in} \\) and the feedback loop. Negative feedback stabilizes the system by reducing disturbances and maintaining the desired output. The loop gain and phase characteristics are crucial for stability and performance, particularly in preventing oscillations and ensuring the desired response. The design allows for dynamic control, suitable for precise output regulation applications.\n\nFigure 15.2 Evolution of oscillatory system with time.\n\nFor oscillation to initiate, a loop gain of unity or greater is essential. This can be observed by tracing the signal around the loop over multiple cycles and expressing the amplitude of the subtractor's output in Fig. 15.2 as a geometric series (if $\\angle H\\left(j \\omega_{0}\\right)=180^{\\circ}$ ):\n\n$$\n\\begin{equation*}\nV_{X}=V_{0}+\\left|H\\left(j \\omega_{0}\\right)\\right| V_{0}+\\left|H\\left(j \\omega_{0}\\right)\\right|^{2} V_{0}+\\left|H\\left(j \\omega_{0}\\right)\\right|^{3} V_{0}+\\cdots \\tag{15.2}\n\\end{equation*}\n$$\n\nIf $\\left|H\\left(j \\omega_{0}\\right)\\right|>1$, the series diverges, whereas if $\\left|H\\left(j \\omega_{0}\\right)\\right|<1$, then\n\n$$\n\\begin{equation*}\nV_{X}=\\frac{V_{0}}{1-\\left|H\\left(j \\omega_{0}\\right)\\right|}<\\infty \\tag{15.3}\n\\end{equation*}\n$$\n\nIn summary, if a negative-feedback circuit has a loop gain that meets two conditions:\n\n$$\n\\begin{align*}\n\\left|H\\left(j \\omega_{0}\\right)\\right| & \\geq 1  \\tag{15.4}\\\\\n\\angle H\\left(j \\omega_{0}\\right) & =180^{\\circ} \\tag{15.5}\n\\end{align*}\n$$\n\nthe circuit may oscillate at $\\omega_{0}$. These conditions, known as \"Barkhausen criteria,\" are necessary but not sufficient [1]. ${ }^{2}$ To ensure oscillation despite temperature and process variations, the loop gain is typically chosen to be at least twice or thrice the required value.\n\nThe second Barkhausen criterion can be stated as $\\angle H(j \\omega)=180^{\\circ}$ or a total phase shift of $360^{\\circ}$. This should not be confusing: if the system is designed for low-frequency negative feedback, it already produces $180^{\\circ}$ of phase shift in the signal traveling around the loop (as shown by the subtractor in Fig. 15.1), and $\\angle H(j \\omega)=180^{\\circ}$ denotes an additional frequency-dependent phase shift that, as depicted in Fig. 15.2, ensures the feedback signal reinforces the original signal. Thus, the three cases in Fig. 15.3 are equivalent in terms of the second criterion. We say that the system in Fig. 15.3(a) exhibits a frequency-dependent phase shift of $180^{\\circ}$ (indicated by the arrow) and a dc phase shift of $180^{\\circ}$. The difference between Figs. 15.3(b) and (c) is that the open-loop amplifier in (b) includes enough stages with proper polarities to provide a total phase shift of $360^{\\circ}$ at $\\omega_{0}$, whereas in (c), the amplifier produces no phase shift at $\\omega_{0}$. Examples of these configurations are discussed later in this chapter.\n\nimage_name:(a)\ndescription:The block diagram labeled (a) represents an oscillatory feedback system characterized by a frequency-dependent phase shift and a DC phase shift of 180 degrees. The main components include a summing junction and an amplifier block denoted by \\( H(j\\omega) \\).\n\n1. **Main Components:**\n- **Summing Junction:** Depicted as a circle with a plus sign, it combines input signals. It has two inputs: one positive and one negative.\n- **Amplifier Block:** Represented by a triangle labeled \\( H(j\\omega) \\), it processes the input signal and provides amplification. This block introduces a frequency-dependent phase shift.\n\n2. **Flow of Information or Control:**\n- The input signal enters the summing junction.\n- The output from the summing junction is fed into the amplifier block \\( H(j\\omega) \\).\n- The amplifier modifies the signal, introducing a phase shift, and the output is fed back into the negative input of the summing junction, forming a feedback loop.\n\n3. **Labels, Annotations, and Key Indicators:**\n- The arrow labeled \"180°\" indicates a frequency-dependent phase shift of 180 degrees in the feedback path.\n- The plus and minus signs at the summing junction indicate input polarities.\n\n4. **Overall System Function:**\n- The primary function is to create oscillations through feedback. The phase shift introduced by the amplifier and the feedback loop is crucial for achieving the conditions necessary for sustained oscillations. The total phase shift around the loop must be 360 degrees for oscillation to occur, facilitated by the 180-degree phase shift in the feedback path and the amplifier's phase characteristics.\n\nimage_name:(b)\ndescription:The block diagram labeled (b) represents an oscillatory feedback system designed to generate sustained oscillations. It includes the following main components:\n\n1. **Amplifier Block (H(jω))**: This block represents the amplifier in the system, introducing a specific phase shift and gain to the signal. The phase characteristics of the amplifier are crucial for achieving the required total phase shift for oscillation.\n\n2. **Summing Junction**: Depicted as a circle with a plus sign, it combines the input signal with the feedback signal. This summing action is essential for creating the conditions necessary for oscillation.\n\n3. **Feedback Path**: The output of the amplifier is fed back to the summing junction through this path, introducing a 360-degree phase shift, including a 180-degree phase shift inherent in the feedback path and the remaining phase shift provided by the amplifier.\n\n**Flow of Information:**\n- The signal flows from the summing junction to the amplifier, where it is amplified and phase-shifted.\n- The output of the amplifier is fed back to the summing junction through the feedback path.\n- The feedback loop is crucial for maintaining oscillations by ensuring the signal is continually recycled through the system.\n\n**Overall System Function:**\nThe primary function is to generate oscillations by maintaining a total phase shift of 360 degrees around the loop. This is achieved through the combination of the amplifier's phase characteristics and the feedback path. The system is designed to sustain oscillations by meeting the phase and gain conditions for oscillation, critical for applications like ring oscillators in CMOS technology.\n\nimage_name:Figure 15.3(c)\ndescription:The block diagram in Figure 15.3(c) represents an oscillatory feedback system designed to generate oscillations by maintaining a total phase shift of 360 degrees around the loop. The system includes the following main components:\n\n1. **Summation Block (+):** This block combines the input signal with the feedback signal, depicted as a circle with a plus sign inside, indicating an addition operation.\n\n2. **Amplifier Block (H(jω)):** The combined signal is fed into this amplifier, represented by a triangle labeled \\( H(j\\omega) \\). This amplifier provides the necessary gain and phase shift to sustain oscillations.\n\n3. **Feedback Path:** The output of the amplifier is fed back to the summation block through this path, depicted with an arrow indicating a 0-degree phase shift, suggesting the feedback is in phase with the input at this point in the loop.\n\n**Flow of Information:**\n- The input signal enters the summation block, combined with the feedback signal.\n- The resultant signal is amplified by the amplifier block \\( H(j\\omega) \\).\n- The output of the amplifier is sent back through the feedback path to the summation block, completing the loop.\n\n**Overall System Function:**\nThe primary function is to sustain oscillations by ensuring the phase and gain conditions for oscillation are met. The amplifier provides the necessary gain and phase shift, while the feedback loop ensures the total phase shift around the loop is 360 degrees. This configuration is typical in ring oscillators, particularly in CMOS technology, used for generating clock signals and other periodic waveforms.\n\nFigure 15.3 Various views of oscillatory feedback system.\nCMOS oscillators in today's technology are typically implemented as \"ring oscillators\" or \"LC oscillators.\" We study each type in the following sections."
},
{
    "text": "A basic oscillator generates a periodic output, typically in the form of voltage. Consequently, the circuit operates without an input while maintaining the output indefinitely. How does a circuit achieve oscillation? Refer to Chapter 10, which explains that negative-feedback systems can oscillate; essentially, an oscillator is a poorly-designed feedback amplifier! ${ }^{1}$ Consider the unity-gain negative-feedback circuit illustrated in Fig. 15.1, where\n\n$$\n\\begin{equation*}\n\\frac{V_{\\text {out }}}{V_{\\text {in }}}(s)=\\frac{H(s)}{1+H(s)} \\tag{15.1}\n\\end{equation*}\n$$\n\nAs discussed in Chapter 10, if the amplifier undergoes significant phase shift at high frequencies, causing the overall feedback to become positive, oscillation may result. More precisely, if for $s=j \\omega_{0}, H\\left(j \\omega_{0}\\right)=-1$, then the closed-loop gain tends to infinity at $\\omega_{0}$. Under this condition, the circuit continuously amplifies its noise components at $\\omega_{0}$. As conceptually shown in Fig. 15.2, a noise component at $\\omega_{0}$ undergoes a total gain of unity and a phase shift of $180^{\\circ}$, returning to the subtractor as a negative version of the input. This subtraction results in a larger difference, allowing the component at $\\omega_{0}$ to grow through continuous \"regeneration.\"\n\nimage_name:Figure 15.1 Feedback system\ndescription:The feedback system in Figure 15.1 comprises a basic closed-loop configuration with the following key components:\n\n1. **Adder/Subtractor (Summing Junction):** This block has two inputs and one output, subtracting the feedback signal from the input signal \\( V_{in} \\). The output is the difference between \\( V_{in} \\) and the feedback signal.\n\n2. **Amplifier Block \\( H(s) \\):** Representing the system's transfer function, this block amplifies the signal from the summing junction. The gain and phase characteristics are defined by \\( H(s) \\), a function of the complex frequency variable \\( s \\).\n\n3. **Feedback Path:** The output \\( V_{out} \\) is fed back to the summing junction, providing negative feedback through a direct connection.\n\n**Flow of Information:**\n- The input signal \\( V_{in} \\) enters the summing junction, where the feedback signal is subtracted.\n- The resulting difference signal is amplified by \\( H(s) \\).\n- The amplified output \\( V_{out} \\) is then fed back to the subtractor, forming a closed-loop system.\n\n**Overall System Function:**\n- The system controls the output \\( V_{out} \\) by adjusting \\( V_{in} \\) and the feedback loop. Negative feedback stabilizes the system, reduces disturbances, and maintains the desired output level. Loop gain and phase characteristics are vital for stability and performance, particularly in preventing oscillations and ensuring the desired response.\n\nimage_name:Evolution of oscillatory system with time.\ndescription:The feedback system in Figure 15.1 is designed to control the output voltage \\( V_{out} \\) using a feedback loop. It consists of several repeating blocks, each performing a similar function to stabilize and control the output.\n\n1. **Main Components:**\n- **Input Signal \\( V_0 \\):** The system starts with an input signal \\( V_0 \\) subject to control and feedback.\n- **Summing Junctions:** These circles with plus and minus signs combine the input signal with the feedback signal.\n- **Amplifiers \\( H(s) \\):** Each block contains an amplifier labeled \\( H(s) \\), processing the signal from the summing junction. \\( H(s) \\) represents the system's transfer function in the Laplace domain, indicating frequency domain operation.\n- **Feedback Loops:** Each block has a feedback loop that feeds the amplifier's output back to the summing junction, creating a closed-loop system.\n\n2. **Flow of Information or Control:**\n- The input signal \\( V_0 \\) enters the first summing junction, combined with the feedback signal.\n- The resulting signal is amplified by the first \\( H(s) \\) and fed to the next stage.\n- This process repeats through multiple stages, each with a summing junction and an amplifier with feedback.\n- The signal flows sequentially from left to right, with feedback loops ensuring stability and control.\n\n3. **Labels, Annotations, and Key Indicators:**\n- \\( H(s) \\) indicates the transfer function of each amplifier, suggesting frequency domain analysis.\n- Plus and minus signs at summing junctions indicate the combination of positive input signals with negative feedback.\n\n4. **Overall System Function:**\n- The system controls \\( V_{out} \\) by adjusting \\( V_{in} \\) and the feedback loop. Negative feedback stabilizes the system, reduces disturbances, and maintains the desired output level. Loop gain and phase characteristics are crucial for stability and performance, particularly in preventing oscillations and ensuring the desired response. The design allows for dynamic control, suitable for precise output regulation applications.\n\nFigure 15.2 Evolution of oscillatory system with time.\n\nFor oscillation to initiate, a loop gain of unity or greater is essential. This can be observed by tracing the signal around the loop over multiple cycles and expressing the subtractor's output amplitude in Fig. 15.2 as a geometric series (if $\\angle H\\left(j \\omega_{0}\\right)=180^{\\circ}$ ):\n\n$$\n\\begin{equation*}\nV_{X}=V_{0}+\\left|H\\left(j \\omega_{0}\\right)\\right| V_{0}+\\left|H\\left(j \\omega_{0}\\right)\\right|^{2} V_{0}+\\left|H\\left(j \\omega_{0}\\right)\\right|^{3} V_{0}+\\cdots \\tag{15.2}\n\\end{equation*}\n$$\n\nIf $\\left|H\\left(j \\omega_{0}\\right)\\right|>1$, the series diverges, whereas if $\\left|H\\left(j \\omega_{0}\\right)\\right|<1$, then\n\n$$\n\\begin{equation*}\nV_{X}=\\frac{V_{0}}{1-\\left|H\\left(j \\omega_{0}\\right)\\right|}<\\infty \\tag{15.3}\n\\end{equation*}\n$$\n\nIn summary, if a negative-feedback circuit has a loop gain satisfying two conditions:\n\n$$\n\\begin{align*}\n\\left|H\\left(j \\omega_{0}\\right)\\right| & \\geq 1  \\tag{15.4}\\\\\n\\angle H\\left(j \\omega_{0}\\right) & =180^{\\circ} \\tag{15.5}\n\\end{align*}\n$$\n\nthe circuit may oscillate at $\\omega_{0}$. These conditions, known as \"Barkhausen criteria,\" are necessary but not sufficient [1]. ${ }^{2}$ To ensure oscillation despite temperature and process variations, the loop gain is typically chosen to be at least twice or three times the required value.\n\nThe second Barkhausen criterion can be stated as $\\angle H(j \\omega)=180^{\\circ}$ or a total phase shift of $360^{\\circ}$. This should not be confusing: if the system is designed for low-frequency negative feedback, it already produces $180^{\\circ}$ of phase shift in the signal traveling around the loop (as depicted by the subtractor in Fig. 15.1), and $\\angle H(j \\omega)=180^{\\circ}$ denotes an additional frequency-dependent phase shift that, as shown in Fig. 15.2, ensures the feedback signal enhances the original signal. Thus, the three cases in Fig. 15.3 are equivalent in terms of the second criterion. We say that the system in Fig. 15.3(a) exhibits a frequency-dependent phase shift of $180^{\\circ}$ (indicated by the arrow) and a DC phase shift of $180^{\\circ}$. The difference between Figs. 15.3(b) and (c) is that the open-loop amplifier in (b) includes enough stages with proper polarities to provide a total phase shift of $360^{\\circ}$ at $\\omega_{0}$, whereas in (c), the amplifier produces no phase shift at $\\omega_{0}$. Examples of these topologies are presented later in this chapter.\n\nimage_name:(a)\ndescription:The block diagram labeled \"(a)\" represents an oscillatory feedback system with a frequency-dependent phase shift and a DC phase shift of 180 degrees. The main components include a summing junction and an amplifier block denoted by \\( H(j\\omega) \\).\n\n1. **Main Components:**\n- **Summing Junction:** Depicted as a circle with a plus sign, it combines input signals, having two inputs (one positive, one negative).\n- **Amplifier Block:** Represented by a triangle labeled \\( H(j\\omega) \\), it processes the input signal, introducing a phase shift.\n\n2. **Flow of Information or Control:**\n- The input signal enters the summing junction on the left.\n- The output from the summing junction is fed into the amplifier block \\( H(j\\omega) \\).\n- The amplifier modifies the signal, introducing a phase shift, and the output is fed back to the negative input of the summing junction, forming a feedback loop.\n\n3. **Labels, Annotations, and Key Indicators:**\n- The arrow labeled \"180°\" indicates a frequency-dependent phase shift of 180 degrees in the feedback path.\n- Plus and minus signs at the summing junction indicate input polarities.\n\n4. **Overall System Function:**\n- The system creates oscillations through feedback. The phase shift introduced by the amplifier and feedback loop is crucial for achieving the conditions necessary for sustained oscillations. The total phase shift around the loop must be 360 degrees for oscillation to occur, facilitated by the 180-degree phase shift in the feedback path and the amplifier's phase characteristics.\n\nimage_name:(b)\ndescription:The block diagram labeled \"(b)\" represents an oscillatory feedback system designed to generate sustained oscillations. It includes the following main components:\n\n1. **Amplifier Block (H(jω))**: This block represents the amplifier, introducing a specific phase shift and gain. The phase characteristics are crucial for achieving the total required phase shift for oscillation.\n\n2. **Summing Junction**: Depicted as a circle with a plus sign, it combines the input signal with the feedback signal, essential for creating oscillation conditions.\n\n3. **Feedback Path**: The feedback path loops from the amplifier's output back to the summing junction, introducing a 360-degree phase shift, including a 180-degree phase shift inherent in the feedback path and the remaining phase shift provided by the amplifier.\n\n**Flow of Information:**\n- The signal flows from the summing junction to the amplifier, where it is amplified and phase-shifted.\n- The output is fed back to the summing junction through the feedback path.\n- The feedback loop is crucial for maintaining oscillations by continually recycling the signal through the system.\n\n**Overall System Function:**\nThe system generates oscillations by maintaining a total phase shift of 360 degrees around the loop, achieved through the amplifier's phase characteristics and the feedback path. This configuration is typical in ring oscillators, especially in CMOS technology, for generating clock signals and other periodic waveforms.\n\nimage_name:Figure 15.3(c)\ndescription:The block diagram in Figure 15.3(c) represents an oscillatory feedback system designed to generate oscillations by maintaining a total phase shift of 360 degrees around the loop. It consists of the following main components:\n\n1. **Summation Block (+):** This block combines the input signal with the feedback signal, depicted as a circle with a plus sign, indicating an addition operation.\n\n2. **Amplifier Block (H(jω)):** Following the summation block, the combined signal is fed into an amplifier, represented by a triangle labeled H(jω). This amplifier provides the necessary gain and phase shift for sustained oscillations.\n\n3. **Feedback Path:** The amplifier's output is fed back to the summation block through this path, depicted with an arrow indicating a 0-degree phase shift, suggesting in-phase feedback.\n\n**Flow of Information:**\n- The input signal enters the summation block, combined with the feedback signal.\n- The resultant signal is amplified by the amplifier block H(jω).\n- The output is sent back through the feedback path to the summation block, completing the loop.\n\n**Overall System Function:**\nThe system sustains oscillations by ensuring the phase and gain conditions for oscillation are met. The amplifier provides the necessary gain and phase shift, while the feedback loop ensures a total phase shift of 360 degrees around the loop. This configuration is typical in ring oscillators, particularly in CMOS technology, for generating clock signals and other periodic waveforms.\n\nFigure 15.3 Various views of oscillatory feedback system.\nCMOS oscillators in today's technology are typically implemented as \"ring oscillators\" or \"LC oscillators.\" We study each type in the following sections."
},
{
    "text": "A basic oscillator generates a periodic output, typically in the form of voltage. Consequently, the circuit operates without an input while maintaining the output indefinitely. How does a circuit achieve oscillation? Refer to Chapter 10, which explains that negative-feedback systems can oscillate; essentially, an oscillator is a poorly-designed feedback amplifier! ${ }^{1}$ Consider the unity-gain negative-feedback circuit illustrated in Fig. 15.1, where\n\n$$\n\\begin{equation*}\n\\frac{V_{\\text {out }}}{V_{\\text {in }}}(s)=\\frac{H(s)}{1+H(s)} \\tag{15.1}\n\\end{equation*}\n$$\n\nAs discussed in Chapter 10, if the amplifier undergoes significant phase shift at high frequencies, causing the overall feedback to become positive, oscillation may result. More precisely, if for $s=j \\omega_{0}, H\\left(j \\omega_{0}\\right)=-1$, then the closed-loop gain tends to infinity at $\\omega_{0}$. Under this scenario, the circuit continuously amplifies its noise components at $\\omega_{0}$. As conceptually shown in Fig. 15.2, a noise component at $\\omega_{0}$ undergoes a total gain of unity and a phase shift of $180^{\\circ}$, returning to the subtractor as a negative version of the input. This subtraction results in a larger difference, allowing the component at $\\omega_{0}$ to grow through \"regeneration.\"\n\nimage_name:Figure 15.1 Feedback system\ndescription:The feedback system shown in Figure 15.1 comprises a fundamental closed-loop configuration with the following key components:\n\n1. **Adder/Subtractor (Summing Junction):** This block has two inputs and one output, subtracting the feedback signal from the input signal \\( V_{in} \\). The output is the difference between \\( V_{in} \\) and the feedback signal.\n\n2. **Amplifier Block \\( H(s) \\):** Representing the system's transfer function, this block amplifies the signal from the summing junction. The gain and phase characteristics are defined by \\( H(s) \\), a function of the complex frequency variable \\( s \\).\n\n3. **Feedback Path:** The output \\( V_{out} \\) is fed back to the summing junction, providing negative feedback through a direct connection.\n\n**Flow of Information:**\n- The input signal \\( V_{in} \\) enters the summing junction, where it is combined with the feedback signal.\n- The resulting difference signal is amplified by \\( H(s) \\).\n- The amplified output \\( V_{out} \\) is then fed back to the subtractor, forming a closed-loop.\n\n**Overall System Function:**\n- The system aims to control \\( V_{out} \\) by adjusting \\( V_{in} \\) and the feedback loop. Negative feedback stabilizes the system, reducing disturbances and maintaining the desired output. Loop gain and phase characteristics are vital for stability and performance, preventing oscillations and ensuring the desired response.\n\nimage_name:Evolution of oscillatory system with time.\ndescription:The feedback system in Figure 15.1 is designed to control the output voltage \\( V_{out} \\) using a feedback loop. It consists of several repeating blocks, each contributing to stability and control.\n\n1. **Main Components:**\n- **Input Signal \\( V_0 \\):** The system starts with \\( V_0 \\), subject to control and feedback.\n- **Summing Junctions:** Circles with plus and minus signs combine input and feedback signals.\n- **Amplifiers \\( H(s) \\):** Each block contains an amplifier \\( H(s) \\), processing signals in the frequency domain.\n- **Feedback Loops:** Each block feeds the output back to the summing junction, creating a closed-loop.\n\n2. **Flow of Information or Control:**\n- \\( V_0 \\) enters the first summing junction, combined with feedback.\n- The signal is amplified by \\( H(s) \\) and fed to the next stage.\n- This process repeats through multiple stages, ensuring stability and control.\n\n3. **Labels, Annotations, and Key Indicators:**\n- \\( H(s) \\) indicates the transfer function, analyzed in the frequency domain.\n- Plus and minus signs at summing junctions denote signal combination.\n\n4. **Overall System Function:**\n- The system controls \\( V_{out} \\) by adjusting \\( V_{in} \\) and feedback, aiming for stability and desired output. Loop gain and phase characteristics are crucial for performance, particularly in dynamic control applications.\n\nFigure 15.2 Evolution of oscillatory system with time.\n\nFor oscillation to initiate, a loop gain of unity or higher is essential. This can be observed by tracing the signal around the loop over multiple cycles and expressing the subtractor's output amplitude in Fig. 15.2 as a geometric series (if $\\angle H\\left(j \\omega_{0}\\right)=180^{\\circ}$ ):\n\n$$\n\\begin{equation*}\nV_{X}=V_{0}+\\left|H\\left(j \\omega_{0}\\right)\\right| V_{0}+\\left|H\\left(j \\omega_{0}\\right)\\right|^{2} V_{0}+\\left|H\\left(j \\omega_{0}\\right)\\right|^{3} V_{0}+\\cdots \\tag{15.2}\n\\end{equation*}\n$$\n\nIf $\\left|H\\left(j \\omega_{0}\\right)\\right|>1$, the series diverges, whereas if $\\left|H\\left(j \\omega_{0}\\right)\\right|<1$, then\n\n$$\n\\begin{equation*}\nV_{X}=\\frac{V_{0}}{1-\\left|H\\left(j \\omega_{0}\\right)\\right|}<\\infty \\tag{15.3}\n\\end{equation*}\n$$\n\nIn summary, if a negative-feedback circuit has a loop gain satisfying two conditions:\n\n$$\n\\begin{align*}\n\\left|H\\left(j \\omega_{0}\\right)\\right| & \\geq 1  \\tag{15.4}\\\\\n\\angle H\\left(j \\omega_{0}\\right) & =180^{\\circ} \\tag{15.5}\n\\end{align*}\n$$\n\nthe circuit may oscillate at $\\omega_{0}$. These conditions, known as \"Barkhausen criteria,\" are necessary but not sufficient [1]. ${ }^{2}$ To ensure oscillation despite temperature and process variations, the loop gain is often chosen to be at least twice or thrice the required value.\n\nThe second Barkhausen criterion can be stated as $\\angle H(j \\omega)=180^{\\circ}$, or a total phase shift of $360^{\\circ}$. This should not be confusing: if the system is designed for low-frequency negative feedback, it already produces $180^{\\circ}$ of phase shift in the loop (as shown by the subtractor in Fig. 15.1), and $\\angle H(j \\omega)=180^{\\circ}$ indicates an additional frequency-dependent phase shift that, as depicted in Fig. 15.2, ensures the feedback signal reinforces the original signal. Thus, the three cases in Fig. 15.3 are equivalent in terms of the second criterion. We say that Fig. 15.3(a) exhibits a frequency-dependent phase shift of $180^{\\circ}$ (denoted by the arrow) and a DC phase shift of $180^{\\circ}$. The difference between Figs. 15.3(b) and (c) is that the open-loop amplifier in (b) includes enough stages with proper polarities to provide a total phase shift of $360^{\\circ}$ at $\\omega_{0}$, while that in (c) produces no phase shift at $\\omega_{0}$. Examples of these topologies are discussed later in this chapter.\n\nimage_name:(a)\ndescription:The block diagram labeled as (a) represents an oscillatory feedback system with a frequency-dependent phase shift and a DC phase shift of 180 degrees. Key components include a summing junction and an amplifier block \\( H(j\\omega) \\).\n\n1. **Main Components:**\n- **Summing Junction:** A circular block with a plus sign, combining input signals.\n- **Amplifier Block:** A triangular symbol labeled \\( H(j\\omega) \\), introducing phase shift.\n\n2. **Flow of Information or Control:**\n- The input signal enters the summing junction.\n- The output is amplified by \\( H(j\\omega) \\) and fed back to the negative input of the summing junction.\n\n3. **Labels, Annotations, and Key Indicators:**\n- An arrow labeled \"180°\" indicates a frequency-dependent phase shift.\n- Plus and minus signs denote input polarities.\n\n4. **Overall System Function:**\n- The system creates oscillations through feedback, with phase shifts crucial for sustained oscillations. The total phase shift must be 360 degrees, facilitated by the feedback path and amplifier \\( H(j\\omega) \\).\n\nimage_name:(b)\ndescription:The block diagram labeled as \"(a)\" represents an oscillatory feedback system designed for sustained oscillations. It includes:\n\n1. **Amplifier Block (H(jω))**: This block introduces phase shift and gain.\n2. **Summing Junction**: A circle with a plus sign, combining input and feedback signals.\n3. **Feedback Path**: Loops back from the amplifier to the summing junction, introducing a 360-degree phase shift.\n\n**Flow of Information:**\n- The signal flows from the summing junction to the amplifier, then back through the feedback path.\n\n**Overall System Function:**\nThe system generates oscillations by maintaining a 360-degree phase shift, crucial for applications like ring oscillators in CMOS technology.\n\nimage_name:Figure 15.3(c)\ndescription:The block diagram in Figure 15.3 represents an oscillatory feedback system designed to sustain oscillations with a 360-degree phase shift. Components include:\n\n1. **Summation Block (+):** Combines input and feedback signals.\n2. **Amplifier Block (H(jω))**: Provides gain and phase shift.\n3. **Feedback Path**: Feeds the amplifier output back to the summation block with a 0-degree phase shift.\n\n**Flow of Information:**\n- The input signal combines with feedback at the summation block.\n- The signal is amplified and fed back, completing the loop.\n\n**Overall System Function:**\nThe system sustains oscillations by ensuring phase and gain conditions are met, typical in ring oscillators for generating clock signals.\n\nFigure 15.3 Various views of oscillatory feedback system.\nCMOS oscillators in modern technology are often implemented as \"ring oscillators\" or \"LC oscillators.\" These types are explored in the following sections."
},
{
    "text": "A basic oscillator generates a periodic output, typically in the form of voltage. This circuit sustains its output indefinitely without any input. How can a circuit oscillate? Refer to Chapter 10, which explains that negative-feedback systems can oscillate, meaning an oscillator is essentially a poorly-designed feedback amplifier! ${ }^{1}$ Consider the unity-gain negative-feedback circuit illustrated in Fig. 15.1, where\n\n$$\n\\begin{equation*}\n\\frac{V_{\\text {out }}}{V_{\\text {in }}}(s)=\\frac{H(s)}{1+H(s)} \\tag{15.1}\n\\end{equation*}\n$$\n\nAs discussed in Chapter 10, if the amplifier undergoes significant phase shift at high frequencies, causing the overall feedback to become positive, oscillation may result. More precisely, if for $s=j \\omega_{0}, H\\left(j \\omega_{0}\\right)=-1$, the closed-loop gain approaches infinity at $\\omega_{0}$. Under this condition, the circuit indefinitely amplifies its own noise components at $\\omega_{0}$. In fact, as shown conceptually in Fig. 15.2, a noise component at $\\omega_{0}$ undergoes a total gain of unity and a phase shift of $180^{\\circ}$, returning to the subtractor as a negative version of the input. Upon subtraction, the input and feedback signals create a larger difference. Thus, the circuit \"regenerates,\" allowing the component at $\\omega_{0}$ to grow.\n\nimage_name:Figure 15.1 Feedback system\ndescription:The feedback system in Figure 15.1 features a basic closed-loop configuration with the following main components:\n\n1. **Adder/Subtractor (Summing Junction):** This block has two inputs and one output, subtracting the feedback signal from the input signal \\( V_{in} \\). The output is the difference between \\( V_{in} \\) and the feedback signal.\n\n2. **Amplifier Block \\( H(s) \\):** This block represents the system's transfer function and amplifies the signal from the summing junction. The gain and phase characteristics are defined by \\( H(s) \\), a function of the complex frequency variable \\( s \\).\n\n3. **Feedback Path:** The output \\( V_{out} \\) is fed back into the summing junction, providing negative feedback through a direct connection.\n\n**Flow of Information:**\n- The input signal \\( V_{in} \\) enters the summing junction, where the feedback signal is subtracted.\n- The resulting difference signal is amplified by \\( H(s) \\).\n- The amplified output \\( V_{out} \\) is fed back to the subtractor, forming a closed-loop system.\n\n**Overall System Function:**\n- The system controls the output \\( V_{out} \\) by adjusting the input \\( V_{in} \\) and the feedback loop. Negative feedback stabilizes the system, reducing disturbances and maintaining the desired output level. Loop gain and phase characteristics are crucial for stability and performance, preventing oscillations and ensuring the desired response.\n\nimage_name:Evolution of oscillatory system with time.\ndescription:The feedback system in Figure 15.1 is designed to control the output voltage \\( V_{out} \\) using a feedback loop. It consists of key components arranged in repeating blocks to stabilize and control the output.\n\n1. **Main Components:**\n- **Input Signal \\( V_0 \\):** The system starts with an input signal \\( V_0 \\) subject to control and feedback.\n- **Summing Junctions:** Represented by circles with plus and minus signs, these combine the input signal with the feedback signal.\n- **Amplifiers \\( H(s) \\):** Each block contains an amplifier labeled \\( H(s) \\), processing the signal from the summing junction. \\( H(s) \\) represents the system's transfer function in the Laplace domain.\n- **Feedback Loops:** Each block has a feedback loop feeding the amplifier output back to the summing junction.\n\n2. **Flow of Information or Control:**\n- The input signal \\( V_0 \\) enters the first summing junction, combined with the feedback signal.\n- The resulting signal is amplified by the first \\( H(s) \\) and fed to the next stage.\n- This process repeats through multiple stages, each with a summing junction and amplifier with feedback.\n- The signal flows sequentially from left to right, with feedback loops ensuring stability and control.\n\n3. **Labels, Annotations, and Key Indicators:**\n- \\( H(s) \\) indicates the transfer function of each amplifier, suggesting frequency domain analysis.\n- Plus and minus signs at summing junctions indicate the combination of positive input signals with negative feedback.\n\n4. **Overall System Function:**\n- The system controls the output \\( V_{out} \\) by adjusting the input \\( V_{in} \\) and the feedback loop. Negative feedback stabilizes the system, reducing disturbances and maintaining the desired output level. Loop gain and phase characteristics are crucial for stability and performance, particularly in preventing oscillations and ensuring the desired response. The design allows for dynamic control, suitable for precise output regulation applications.\n\nFigure 15.2 Evolution of oscillatory system with time.\n\nFor oscillation to initiate, a loop gain of unity or greater is required. This can be observed by tracing the signal around the loop over multiple cycles and expressing the amplitude of the subtractor's output in Fig. 15.2 as a geometric series (if $\\angle H\\left(j \\omega_{0}\\right)=180^{\\circ}$ ):\n\n$$\n\\begin{equation*}\nV_{X}=V_{0}+\\left|H\\left(j \\omega_{0}\\right)\\right| V_{0}+\\left|H\\left(j \\omega_{0}\\right)\\right|^{2} V_{0}+\\left|H\\left(j \\omega_{0}\\right)\\right|^{3} V_{0}+\\cdots \\tag{15.2}\n\\end{equation*}\n$$\n\nIf $\\left|H\\left(j \\omega_{0}\\right)\\right|>1$, the series diverges, whereas if $\\left|H\\left(j \\omega_{0}\\right)\\right|<1$, then\n\n$$\n\\begin{equation*}\nV_{X}=\\frac{V_{0}}{1-\\left|H\\left(j \\omega_{0}\\right)\\right|}<\\infty \\tag{15.3}\n\\end{equation*}\n$$\n\nIn summary, if a negative-feedback circuit has a loop gain that meets two conditions:\n\n$$\n\\begin{align*}\n\\left|H\\left(j \\omega_{0}\\right)\\right| & \\geq 1  \\tag{15.4}\\\\\n\\angle H\\left(j \\omega_{0}\\right) & =180^{\\circ} \\tag{15.5}\n\\end{align*}\n$$\n\nthe circuit may oscillate at $\\omega_{0}$. These conditions, known as \"Barkhausen criteria,\" are necessary but not sufficient [1]. ${ }^{2}$ To ensure oscillation despite temperature and process variations, the loop gain is typically chosen to be at least twice or three times the required value.\n\nThe second Barkhausen criterion can be stated as $\\angle H(j \\omega)=180^{\\circ}$, or a total phase shift of $360^{\\circ}$. This should not be confusing: if the system is designed for low-frequency negative feedback, it already produces $180^{\\circ}$ of phase shift in the signal traveling around the loop (as represented by the subtractor in Fig. 15.1), and $\\angle H(j \\omega)=180^{\\circ}$ denotes an additional frequency-dependent phase shift that, as shown in Fig. 15.2, ensures the feedback signal enhances the original signal. Thus, the three cases in Fig. 15.3 are equivalent in terms of the second criterion. We say that the system in Fig. 15.3(a) exhibits a frequency-dependent phase shift of $180^{\\circ}$ (indicated by the arrow) and a dc phase shift of $180^{\\circ}$. The difference between Figs. 15.3(b) and (c) is that the open-loop amplifier in the former includes enough stages with proper polarities to provide a total phase shift of $360^{\\circ}$ at $\\omega_{0}$, whereas the latter produces no phase shift at $\\omega_{0}$. Examples of these topologies are presented later in this chapter.\n\nimage_name:(a)\ndescription:The system block diagram labeled as (a) represents an oscillatory feedback system characterized by a frequency-dependent phase shift and a DC phase shift of 180 degrees. The main components include a summing junction and an amplifier block denoted by \\( H(j\\omega) \\).\n\n1. **Main Components:**\n- **Summing Junction:** Depicted as a circle with a plus sign, it combines input signals, having two inputs (one positive and one negative).\n- **Amplifier Block:** Represented by a triangle labeled \\( H(j\\omega) \\), it processes the input signal, introducing a phase shift.\n\n2. **Flow of Information or Control:**\n- The input signal enters the summing junction.\n- The output from the summing junction is fed into the amplifier block \\( H(j\\omega) \\).\n- The amplifier modifies the signal, introducing a phase shift, and the output is fed back to the negative input of the summing junction, forming a feedback loop.\n\n3. **Labels, Annotations, and Key Indicators:**\n- An arrow labeled \"180°\" indicates a frequency-dependent phase shift of 180 degrees in the feedback path.\n- Plus and minus signs at the summing junction indicate input polarities.\n\n4. **Overall System Function:**\n- The system creates oscillations through feedback, with the phase shift introduced by the amplifier and feedback loop critical for sustained oscillations. The total phase shift around the loop must be 360 degrees, facilitated by the 180-degree phase shift in the feedback path and the amplifier's phase characteristics.\n\nimage_name:(b)\ndescription:The system block diagram labeled as \"(a)\" represents an oscillatory feedback system designed to generate sustained oscillations. It includes the following main components:\n\n1. **Amplifier Block (H(jω))**: This block represents the amplifier, introducing a specific phase shift and gain to the signal. The amplifier's phase characteristics are crucial for achieving the required total phase shift for oscillation.\n\n2. **Summing Junction**: Depicted as a circle with a plus sign, it combines the input signal with the feedback signal, essential for creating oscillation conditions.\n\n3. **Feedback Path**: The feedback path loops from the amplifier output back to the summing junction, introducing a 360-degree phase shift, including a 180-degree phase shift inherent in the feedback path and the remaining phase shift provided by the amplifier.\n\n**Flow of Information:**\n- The signal flows from the summing junction to the amplifier, where it is amplified and phase-shifted.\n- The amplifier output is fed back to the summing junction through the feedback path.\n- The feedback loop maintains oscillations by continually recycling the signal through the system.\n\n**Overall System Function:**\nThe system generates oscillations by maintaining a total phase shift of 360 degrees around the loop, achieved through the amplifier's phase characteristics and the feedback path. This configuration is typical in ring oscillators in CMOS technology, used for generating clock signals and other periodic waveforms.\n\nimage_name:Figure 15.3(c)\ndescription:The block diagram in Figure 15.3 represents an oscillatory feedback system designed to generate oscillations by maintaining a total phase shift of 360 degrees around the loop. It consists of the following main components:\n\n1. **Summation Block (+):** This block combines the input signal with the feedback signal, depicted as a circle with a plus sign, indicating an addition operation.\n\n2. **Amplifier Block (H(jω)):** Following the summation block, the combined signal is fed into an amplifier, represented by a triangle labeled H(jω). This amplifier provides the necessary gain and phase shift for sustained oscillations.\n\n3. **Feedback Path:** The amplifier output is fed back to the summation block through a feedback path, depicted with an arrow indicating a 0-degree phase shift, suggesting in-phase feedback.\n\n**Flow of Information:**\n- The input signal enters the summation block, combined with the feedback signal.\n- The resultant signal is amplified by the amplifier block H(jω).\n- The amplifier output is sent back through the feedback path to the summation block, completing the loop.\n\n**Overall System Function:**\nThe system sustains oscillations by ensuring the phase and gain conditions for oscillation are met. The amplifier provides the necessary gain and phase shift, while the feedback loop ensures a total phase shift of 360 degrees around the loop. This configuration is typical in ring oscillators, especially in CMOS technology, used for generating clock signals and other periodic waveforms.\n\nFigure 15.3 Various views of oscillatory feedback system.\nCMOS oscillators in today's technology are typically implemented as \"ring oscillators\" or \"LC oscillators.\" We study each type in the following sections."
},
{
    "text": "A basic oscillator generates a periodic output, typically in the form of voltage. Consequently, the circuit operates without an input while maintaining the output indefinitely. How does a circuit achieve oscillation? Refer to Chapter 10, which explains that negative-feedback systems can oscillate, meaning an oscillator is essentially a poorly-designed feedback amplifier! ${ }^{1}$ Examine the unity-gain negative-feedback circuit illustrated in Fig. 15.1, where\n\n$$\n\\begin{equation*}\n\\frac{V_{\\text {out }}}{V_{\\text {in }}}(s)=\\frac{H(s)}{1+H(s)} \\tag{15.1}\n\\end{equation*}\n$$\n\nAs discussed in Chapter 10, if the amplifier undergoes significant phase shift at high frequencies, causing the overall feedback to become positive, oscillation may ensue. More precisely, if for $s=j \\omega_{0}, H\\left(j \\omega_{0}\\right)=-1$, the closed-loop gain approaches infinity at $\\omega_{0}$. Under this scenario, the circuit indefinitely amplifies its own noise components at $\\omega_{0}$. In fact, as conceptually shown in Fig. 15.2, a noise component at $\\omega_{0}$ undergoes a total gain of unity and a phase shift of $180^{\\circ}$, returning to the subtractor as a negative version of the input. During subtraction, the input and feedback signals produce a larger difference. Thus, the circuit \"regenerates,\" allowing the component at $\\omega_{0}$ to increase.\n\nimage_name:Figure 15.1 Feedback system\ndescription:The feedback system in Figure 15.1 features a basic closed-loop configuration with the following key components:\n\n1. **Adder/Subtractor (Summing Junction):** This block has two inputs and one output, subtracting the feedback signal from the input signal \\( V_{in} \\). The output is the difference between \\( V_{in} \\) and the feedback signal.\n\n2. **Amplifier Block \\( H(s) \\):** This block represents the system's transfer function, amplifying the signal from the summing junction. The gain and phase characteristics are defined by \\( H(s) \\), a function of the complex frequency variable \\( s \\).\n\n3. **Feedback Path:** The output \\( V_{out} \\) is fed back into the summing junction, providing negative feedback through a direct connection.\n\n**Flow of Information:**\n- The input signal \\( V_{in} \\) enters the summing junction, where the feedback signal is subtracted.\n- The resulting difference signal is amplified by \\( H(s) \\).\n- The amplified output \\( V_{out} \\) is then fed back to the subtractor, forming a closed-loop system.\n\n**Overall System Function:**\n- The primary function is to control \\( V_{out} \\) by adjusting \\( V_{in} \\) and the feedback loop. Negative feedback stabilizes the system, reducing disturbances and maintaining the desired output. Loop gain and phase characteristics are crucial for stability and performance, preventing oscillations and ensuring the desired response.\n\nimage_name:Evolution of oscillatory system with time.\ndescription:The feedback system in Figure 15.1 is designed to control the output voltage \\( V_{out} \\) using a feedback loop. It comprises several repeating blocks that stabilize and control the output.\n\n1. **Main Components:**\n- **Input Signal \\( V_0 \\):** The system starts with \\( V_0 \\), subject to control and feedback.\n- **Summing Junctions:** These circles combine the input signal with the feedback signal, with the positive input being the incoming signal and the negative input being the feedback.\n- **Amplifiers \\( H(s) \\):** Each block contains an amplifier labeled \\( H(s) \\), processing the signal from the summing junction. \\( H(s) \\) represents the system's transfer function in the Laplace domain, indicating frequency domain operation.\n- **Feedback Loops:** Each block feeds the amplifier's output back to the summing junction, creating a closed-loop system.\n\n2. **Flow of Information or Control:**\n- \\( V_0 \\) enters the first summing junction, combined with the feedback signal.\n- The resulting signal is amplified by \\( H(s) \\) and fed to the next stage.\n- This process repeats through multiple stages, each with a summing junction and an amplifier with feedback.\n- The signal flows sequentially from left to right, with feedback loops ensuring stability and control.\n\n3. **Labels, Annotations, and Key Indicators:**\n- \\( H(s) \\) indicates the transfer function of each amplifier, suggesting frequency domain analysis.\n- Plus and minus signs at summing junctions indicate the combination of positive input signals with negative feedback.\n\n4. **Overall System Function:**\n- The primary function is to control \\( V_{out} \\) by adjusting \\( V_{in} \\) and the feedback loop. Negative feedback stabilizes the system, reducing disturbances and maintaining the desired output. Loop gain and phase characteristics are crucial for stability and performance, particularly in preventing oscillations and ensuring the desired response. The design allows for dynamic control, suitable for precise output regulation applications.\n\nFigure 15.2 Evolution of oscillatory system with time.\n\nFor oscillation to initiate, a loop gain of unity or higher is required. This can be observed by tracing the signal around the loop over multiple cycles and expressing the subtractor's output amplitude in Fig. 15.2 as a geometric series (if $\\angle H\\left(j \\omega_{0}\\right)=180^{\\circ}$ ):\n\n$$\n\\begin{equation*}\nV_{X}=V_{0}+\\left|H\\left(j \\omega_{0}\\right)\\right| V_{0}+\\left|H\\left(j \\omega_{0}\\right)\\right|^{2} V_{0}+\\left|H\\left(j \\omega_{0}\\right)\\right|^{3} V_{0}+\\cdots \\tag{15.2}\n\\end{equation*}\n$$\n\nIf $\\left|H\\left(j \\omega_{0}\\right)\\right|>1$, the series diverges, whereas if $\\left|H\\left(j \\omega_{0}\\right)\\right|<1$, then\n\n$$\n\\begin{equation*}\nV_{X}=\\frac{V_{0}}{1-\\left|H\\left(j \\omega_{0}\\right)\\right|}<\\infty \\tag{15.3}\n\\end{equation*}\n$$\n\nIn summary, if a negative-feedback circuit has a loop gain satisfying two conditions:\n\n$$\n\\begin{align*}\n\\left|H\\left(j \\omega_{0}\\right)\\right| & \\geq 1  \\tag{15.4}\\\\\n\\angle H\\left(j \\omega_{0}\\right) & =180^{\\circ} \\tag{15.5}\n\\end{align*}\n$$\n\nthe circuit may oscillate at $\\omega_{0}$. These conditions, known as \"Barkhausen criteria,\" are necessary but not sufficient [1]. ${ }^{2}$ To ensure oscillation despite temperature and process variations, the loop gain is typically chosen to be at least twice or three times the required value.\n\nThe second Barkhausen criterion can be stated as $\\angle H(j \\omega)=180^{\\circ}$ or a total phase shift of $360^{\\circ}$. This should not be confusing: if the system is designed for low-frequency negative feedback, it already produces $180^{\\circ}$ of phase shift in the signal traveling around the loop (as depicted by the subtractor in Fig. 15.1), and $\\angle H(j \\omega)=180^{\\circ}$ denotes an additional frequency-dependent phase shift that, as shown in Fig. 15.2, ensures the feedback signal enhances the original signal. Thus, the three cases in Fig. 15.3 are equivalent in terms of the second criterion. We say that the system in Fig. 15.3(a) exhibits a frequency-dependent phase shift of $180^{\\circ}$ (indicated by the arrow) and a DC phase shift of $180^{\\circ}$. The difference between Figs. 15.3(b) and (c) is that the open-loop amplifier in the former has enough stages with proper polarities to provide a total phase shift of $360^{\\circ}$ at $\\omega_{0}$, whereas the latter produces no phase shift at $\\omega_{0}$. Examples of these topologies are discussed later in this chapter.\n\nimage_name:(a)\ndescription:The block diagram labeled \"(a)\" represents an oscillatory feedback system with a frequency-dependent phase shift and a DC phase shift of 180 degrees. It includes:\n\n1. **Main Components:**\n- **Summing Junction:** A circular block with a plus sign, combining input signals.\n- **Amplifier Block:** A triangular symbol labeled \\( H(j\\omega) \\), processing the input signal and introducing a phase shift.\n\n2. **Flow of Information or Control:**\n- The input signal enters the summing junction.\n- The output is fed into the amplifier \\( H(j\\omega) \\).\n- The amplified signal is fed back to the negative input of the summing junction, forming a feedback loop.\n\n3. **Labels, Annotations, and Key Indicators:**\n- An arrow labeled \"180°\" indicates a frequency-dependent phase shift.\n- Plus and minus signs at the summing junction indicate input polarities.\n\n4. **Overall System Function:**\n- The primary function is to create oscillations through feedback. The phase shift introduced by the amplifier and feedback loop is critical for sustained oscillations. The total phase shift around the loop must be 360 degrees, facilitated by the 180-degree phase shift in the feedback path and the amplifier's phase characteristics.\n\nimage_name:(b)\ndescription:The block diagram labeled \"(a)\" represents an oscillatory feedback system designed for sustained oscillations. It includes:\n\n1. **Amplifier Block (H(jω))**: This block introduces a specific phase shift and gain.\n2. **Summing Junction**: A circle with a plus sign, combining the input and feedback signals.\n3. **Feedback Path**: A loop from the amplifier output to the summing junction, introducing a 360-degree phase shift, including a 180-degree inherent phase shift and the amplifier's phase shift.\n\n**Flow of Information:**\n- The signal flows from the summing junction to the amplifier, undergoes phase shift and amplification, and is fed back to the summing junction.\n\n**Overall System Function:**\nThe primary function is to generate oscillations by maintaining a 360-degree phase shift around the loop, achieved through the amplifier's phase characteristics and the feedback path. This configuration is typical in ring oscillators in CMOS technology.\n\nimage_name:Figure 15.3(c)\ndescription:The block diagram in Figure 15.3 represents an oscillatory feedback system designed to sustain oscillations with a 360-degree phase shift around the loop. It includes:\n\n1. **Summation Block (+):** A circle with a plus sign, combining the input and feedback signals.\n2. **Amplifier Block (H(jω)):** Amplifies and phase-shifts the combined signal.\n3. **Feedback Path:** Feeds the amplifier output back to the summation block, depicted with an arrow indicating a 0-degree phase shift.\n\n**Flow of Information:**\n- The input signal combines with the feedback signal at the summation block.\n- The resultant signal is amplified and phase-shifted by \\( H(jω) \\).\n- The output is fed back to the summation block, completing the loop.\n\n**Overall System Function:**\nThe primary function is to sustain oscillations by ensuring the phase and gain conditions for oscillation are met. The amplifier provides the necessary gain and phase shift, while the feedback loop ensures a 360-degree phase shift around the loop. This configuration is common in ring oscillators in CMOS technology.\n\nFigure 15.3 Various views of oscillatory feedback system.\nCMOS oscillators in modern technology are typically implemented as \"ring oscillators\" or \"LC oscillators.\" Each type is examined in the following sections."
},
{
    "text": "A ring oscillator is constructed from a series of gain stages arranged in a loop. To achieve practical oscillation, we start by attempting to make a single-stage feedback circuit oscillate.\n\nExample 15.1\nWhy doesn't a single common-source stage oscillate when placed in a unity-gain loop?\n\n#### Solution\n\nAs depicted in Fig. 15.4, the open-loop circuit has only one pole, leading to a maximum frequency-dependent phase shift of $90^{\\circ}$ (at a frequency of infinity). Given that the common-source stage introduces a dc phase shift of $180^{\\circ}$ due to signal inversion from gate to drain, the maximum total phase shift is $270^{\\circ}$. Consequently, the loop is unable to sustain oscillation growth.\nimage_name:Figure 15.4\ndescription:\n[\nname: RD, type: Resistor, ports: {N1: VDD, N2: Vout}\nname: CL, type: Capacitor, ports: {Np: Vout, Nn: GND}\nname: M1, type: NMOS, ports: {S: GND, D: Vout, G: Vout}\nname: VDD, type: VoltageSource, ports: {Np: VDD, Nn: GND}\n]\nextrainfo:The circuit is a common-source amplifier with a resistive load and capacitive load, using an NMOS transistor. The output is taken across the capacitor CL.\n\nFigure 15.4\n\nThis example suggests that oscillation may occur if the circuit has multiple stages and thus multiple poles. However, such a topology was considered undesirable in Chapter 10 because it led to inadequate phase margin in op amps. Therefore, we hypothesize that if the circuit of Fig. 15.4 is modified as shown in Fig. 15.5, two significant poles will appear in the signal path, allowing the frequency-dependent\nimage_name:Figure 15.5\ndescription:\n[\nname: M1, type: NMOS, ports: {S: GND, D: E, G: Vout}\nname: M2, type: NMOS, ports: {S: GND, D: F(Vout), G: E}\nname: RD1, type: Resistor, value: RD, ports: {N1: VDD, N2: E}\nname: RD2, type: Resistor, value: RD, ports: {N1: VDD, N2: F}\nname: CL1, type: Capacitor, value: CL, ports: {Np: E, Nn: GND}\nname: CL2, type: Capacitor, value: CL, ports: {Np: F, Nn: GND}\n]\nextrainfo:The circuit is a two-stage feedback system with two NMOS transistors, two resistors, and two capacitors. It is prone to latch-up due to positive feedback near zero frequency.\n\nFigure 15.5 Two-pole feedback system.\nphase shift to approach $180^{\\circ}$. Unfortunately, this circuit exhibits positive feedback near zero frequency due to the signal inversion through each common-source stage. As a result, it simply \"latches up\" rather than oscillates. That is, if $V_{E}$ rises, $V_{F}$ falls, thereby turning $M_{1}$ off and allowing $V_{E}$ to rise further. This may continue until $V_{E}$ reaches $V_{D D}$ and $V_{F}$ drops to near zero, a state that will remain indefinitely.\n\nTo gain more insight into the oscillation conditions, let us assume that an ideal inverting stage (with zero phase shift at all frequencies) is inserted in the loop of Fig. 15.5, providing negative feedback near zero frequency and eliminating the problem of latch-up (Fig. 15.6). Does this circuit oscillate? We note that the loop contains only two poles: one at $E$ and another at $F$. The frequency-dependent phase shift can therefore reach $180^{\\circ}$, but at a frequency of infinity. Since the loop gain vanishes at very high frequencies, we observe that the circuit does not satisfy both of Barkhausen's criteria at the same frequency (Fig. 15.7), and thus fails to oscillate.\nimage_name:Figure 15.6\ndescription:\n[\nname: M1, type: NMOS, ports: {S: GND, D: E, G: Vout}\nname: M2, type: NMOS, ports: {S: GND, D: F, G: E}\nname: RD, type: Resistor, value: RD, ports: {N1: VDD, N2: E}\nname: RD, type: Resistor, value: RD, ports: {N1: VDD, N2: F}\nname: CL, type: Capacitor, value: CL, ports: {Np: E, Nn: GND}\nname: CL, type: Capacitor, value: CL, ports: {Np: F, Nn: GND}\nname: VDD, type: VoltageSource, value: VDD, ports: {Np: VDD, Nn: GND}\nname: Ideal, type: OpAmp, value: -1, ports: {InP: F, InN: GND, Out: Vout}\n]\nextrainfo:The circuit is a two-pole feedback system with an additional signal inversion using an ideal op-amp. It includes two NMOS transistors (M1 and M2) with capacitive loads CL and resistive loads RD. The circuit does not oscillate as it does not meet Barkhausen's criteria at the same frequency.\n\nFigure 15.6 Two-pole feedback system with additional signal inversion.\nimage_name:Figure 15.7 Loop gain characteristics of a two-pole system\ndescription:The graph titled \"Figure 15.7 Loop gain characteristics of a two-pole system\" is a Bode plot comprising two subplots: one for magnitude and one for phase, both plotted against frequency on a logarithmic scale.\n\n1. **Magnitude Plot**:\n- **Y-Axis (Vertical)**: Represents 20log|H(ω)|, which is the magnitude of the loop gain in decibels (dB).\n- **X-Axis (Horizontal)**: Represents frequency (ω) on a logarithmic scale.\n- **Behavior**: The magnitude remains constant at 0 dB up to a certain frequency, denoted as ωp,E = ωp,F. Beyond this point, the magnitude decreases linearly at a rate of -40 dB per decade. This indicates the presence of two poles contributing to the roll-off.\n\n2. **Phase Plot**:\n- **Y-Axis (Vertical)**: Represents the phase of the loop gain, /H(ω), in degrees.\n- **X-Axis (Horizontal)**: Also represents frequency (ω) on a logarithmic scale.\n- **Behavior**: The phase starts at 0 degrees and decreases, passing through -90 degrees and approaching -180 degrees as frequency increases. This suggests a cumulative phase shift introduced by the poles in the system.\n\n3. **Key Features**:\n- The dashed vertical line at ωp,E = ωp,F marks the pole frequency where the behavior of the magnitude plot changes.\n- The magnitude plot's slope of -40 dB/decade is characteristic of a two-pole system.\n- The phase plot's progression towards -180 degrees highlights the potential for instability if additional phase shift occurs, as discussed in the context of the two-pole feedback system with signal inversion.\n\nFigure 15.7 Loop gain characteristics of a two-pole system.\nThe preceding discussion suggests the need for greater phase shift around the loop, indicating that oscillation might be possible if the third inverting stage in Fig. 15.6 contains a pole that contributes significant phase. This leads us to the topology depicted in Fig. 15.8. If the three stages are identical, the total phase shift around the loop, $\\phi$, reaches $-135^{\\circ}$ at $\\omega=\\omega_{p, E}\\left(=\\omega_{p, F}=\\omega_{p, G}\\right)$ and $-270^{\\circ}$ at $\\omega=\\infty$. Consequently, $\\phi$ equals $-180^{\\circ}$ at $\\omega<\\infty$, where the loop gain can still be greater than or equal to unity. This circuit indeed oscillates if the loop gain is sufficient and it is an example of a ring oscillator.\n\nIt is instructive to calculate the minimum voltage gain per stage in Fig. 15.8 that is necessary for oscillation. Neglecting the effect of the gate-drain overlap capacitance and denoting the transfer function of each stage by $-A_{0} /\\left(1+s / \\omega_{0}\\right)$, we have for the loop gain\n\n$$\n\\begin{equation*}\nH(s)=-\\frac{A_{0}^{3}}{\\left(1+\\frac{s}{\\omega_{0}}\\right)^{3}} \\tag{15.6}\n\\end{equation*}\n$$\n\nimage_name:Figure 15.8 Three-stage ring oscillator\ndescription:\n[\nname: M1, type: NMOS, ports: {S: GND, D: E, G: F}\nname: M2, type: NMOS, ports: {S: GND, D: F, G: G(Vout)}\nname: M3, type: NMOS, ports: {S: GND, D: G(Vout), G: Vout}\nname: RD, type: Resistor, value: RD, ports: {N1: VDD, N2: E}\nname: RD, type: Resistor, value: RD, ports: {N1: VDD, N2: F}\nname: RD, type: Resistor, value: RD, ports: {N1: VDD, N2: G(Vout)}\nname: CL, type: Capacitor, value: CL, ports: {Np: E, Nn: GND}\nname: CL, type: Capacitor, value: CL, ports: {Np: F, Nn: GND}\nname: CL, type: Capacitor, value: CL, ports: {Np: G(Vout), Nn: GND}\n]\nextrainfo:The circuit is a three-stage ring oscillator using NMOS transistors, each stage comprising an NMOS, a resistor, and a capacitor. The feedback loop is established to create oscillations.\n\nFigure 15.8 Three-stage ring oscillator.\n\nThe circuit oscillates only if the frequency-dependent phase shift equals $180^{\\circ}$, i.e., if each stage contributes $60^{\\circ}$. The frequency at which this occurs is given by\n\n$$\n\\begin{equation*}\n\\tan ^{-1} \\frac{\\omega_{\\text {osc }}}{\\omega_{0}}=60^{\\circ} \\tag{15.7}\n\\end{equation*}\n$$\n\nand hence\n\n$$\n\\begin{equation*}\n\\omega_{o s c}=\\sqrt{3} \\omega_{0} \\tag{15.8}\n\\end{equation*}\n$$\n\nThe minimum voltage gain per stage must be such that the magnitude of the loop gain at $\\omega_{o s c}$ is equal to unity:\n\n$$\n\\begin{equation*}\n\\frac{A_{0}^{3}}{\\left[\\sqrt{1+\\left(\\frac{\\omega_{\\text {osc }}}{\\omega_{0}}\\right)^{2}}\\right]^{3}}=1 \\tag{15.9}\n\\end{equation*}\n$$\n\nIt follows from (15.8) and (15.9) that\n\n$$\n\\begin{equation*}\nA_{0}=2 \\tag{15.10}\n\\end{equation*}\n$$\n\nIn summary, a three-stage ring oscillator requires a low-frequency gain of 2 per stage, and it oscillates at a frequency of $\\sqrt{3} \\omega_{0}$, where $\\omega_{0}$ is the $3-\\mathrm{dB}$ bandwidth of each stage.\n\nLet us now examine the waveforms at the three nodes of the oscillator of Fig. 15.8. Since each stage contributes a frequency-dependent phase shift of $60^{\\circ}$ as well as a low-frequency signal inversion, the waveform at each node is $240^{\\circ}$ (or $120^{\\circ}$ ) out of phase with respect to its neighboring nodes (Fig. 15.9). The ability to generate multiple phases is a very useful property of ring oscillators.\nimage_name:Figure 15.9 Waveforms of a threestage ring oscillator\ndescription:The graph in Figure 15.9 illustrates the waveforms of a three-stage ring oscillator. It is a time-domain waveform graph, showing the voltage at three different nodes of the oscillator over time. The horizontal axis represents time \\( t \\), while the vertical axis indicates voltage, with three separate waveforms labeled \\( V_E \\), \\( V_F \\), and \\( V_G \\).\n\nEach waveform is sinusoidal, indicating periodic oscillations. The three waveforms are out of phase with each other, specifically showing a phase difference of 120 degrees between each waveform, consistent with the description of a three-stage ring oscillator. This phase difference is a critical characteristic of the oscillator, contributing to its ability to generate multiple phases.\n\nThe amplitude of each waveform appears consistent, with no significant increase or decrease over time, indicating stable oscillation. There are no visible annotations or markers indicating specific data points or values on the graph, focusing instead on the qualitative behavior of the waveforms.\n\nOverall, the graph effectively demonstrates the phase relationship and stability of the oscillations in a three-stage ring oscillator, highlighting its capability to maintain consistent out-of-phase waveforms across its nodes.\n\nimage_name:Figure 15.10 Linear model of three-stage ring oscillator\ndescription:The diagram labeled \"Figure 15.10 Linear model of three-stage ring oscillator\" illustrates a linear feedback system designed to model a three-stage ring oscillator. The primary components and their functions are as follows:\n\n1. **Main Components:**\n- **Three Amplifiers:** The central part of the system is a series of three amplifiers arranged in a ring configuration. Each amplifier is represented as a triangle, indicating the direction of signal flow.\n- **Summing Junction:** At the input, there is a summing junction where the input voltage \\( V_{in} \\) and the feedback voltage are combined. This is depicted by a circle with a plus sign, indicating positive feedback.\n- **Feedback Path:** The output \\( V_{out} \\) is fed back to the input through a feedback loop, completing the ring structure.\n\n2. **Flow of Information or Control:**\n- The input signal \\( V_{in} \\) is first added to the feedback signal at the summing junction. The resulting signal then passes sequentially through the three amplifiers.\n- Each amplifier processes the signal, with the output of one serving as the input to the next, maintaining the direction of flow through the system.\n- The final output \\( V_{out} \\) is taken from the last amplifier and fed back to the summing junction, creating a positive feedback loop.\n\n3. **Labels, Annotations, and Key Indicators:**\n- The transfer function of the system is labeled as \\( \\frac{-A_0^3}{(1 + \\frac{s}{\\omega_0})^3} \\), indicating the gain and frequency response characteristics of the oscillator.\n- The negative sign in the transfer function suggests inversion, typical of oscillatory systems to maintain phase shift conditions conducive to oscillation.\n\n4. **Overall System Function:**\n- The primary function of this system is to model the behavior of a three-stage ring oscillator. The positive feedback loop ensures that the signal is continuously reinforced, allowing the system to sustain oscillations.\n- The arrangement of the amplifiers and the feedback loop is crucial in maintaining the phase conditions necessary for stable oscillation, as suggested by the Barkhausen criterion, which requires the loop gain to be equal to one and the total phase shift around the loop to be 0 or 360 degrees.\n\nThis linear model helps in understanding how variations in the gain \\( A_0 \\) can affect the oscillation conditions, particularly highlighting the impact if \\( A_0 \\) is not equal to 2, as discussed in the context.\n\nFigure 15.10 Linear model of three-stage ring oscillator.\n\nAmplitude Limiting The natural question at this point is-What happens if in the three-stage ring of Fig. 15.8, $A_{0} \\neq 2$ ? We know from Barkhausen's criteria that if $A_{0}<2$, the circuit fails to oscillate, but what if $A_{0}>2$ ? To answer this question, we first model the oscillator by a linear feedback system, as depicted in Fig. 15.10. Note that the feedback is positive (i.e., $V_{\\text {out }}$ is added to $V_{i n}$ ) because $H(s)$ in Eq. (15.6) already includes the negative polarity resulting from three inversions in the signal path. The closed-loop transfer function is\n\n$$\n\\begin{align*}\n\\frac{V_{\\text {out }}(s)}{V_{\\text {in }}(s)} & =\\frac{\\frac{-A_{0}^{3}}{\\left(1+s / \\omega_{0}\\right)^{3}}}{1+\\frac{A_{0}^{3}}{\\left(1+s / \\omega_{0}\\right)^{3}}}  \\tag{15.11}\\\\\n& =\\frac{-A_{0}^{3}}{\\left(1+s / \\omega_{0}\\right)^{3}+A_{0}^{3}} \\tag{15.12}\n\\end{align*}\n$$\n\nThe denominator of (15.12) can be expanded as\n\n$$\n\\begin{equation*}\n\\left(1+\\frac{s}{\\omega_{0}}\\right)^{3}+A_{0}^{3}=\\left(1+\\frac{s}{\\omega_{0}}+A_{0}\\right)\\left[\\left(1+\\frac{s}{\\omega_{0}}\\right)^{2}-\\left(1+\\frac{s}{\\omega_{0}}\\right) A_{0}+A_{0}^{2}\\right] \\tag{15.13}\n\\end{equation*}\n$$\n\nThus, the closed-loop system exhibits three poles:\n\n$$\n\\begin{align*}\ns_{1} & =\\left(-A_{0}-1\\right) \\omega_{0}  \\tag{15.14}\\\\\ns_{2,3} & =\\left[\\frac{A_{0}(1 \\pm j \\sqrt{3})}{2}-1\\right] \\omega_{0} \\tag{15.15}\n\\end{align*}\n$$\n\nSince $A_{0}$ itself is positive, the first pole leads to a decaying exponential term: $\\exp \\left[\\left(-A_{0}-1\\right) \\omega_{0} t\\right]"
},
{
    "text": "A ring oscillator comprises several gain stages connected in a loop. We initiate the practical realization by attempting to make a single-stage feedback circuit oscillate.\n\nExample 15.1\nDiscuss why a single common-source stage does not oscillate when placed in a unity-gain loop.\n\n#### Solution\n\nReferring to Fig. 15.4, we observe that the open-loop circuit contains only one pole, resulting in a maximum frequency-dependent phase shift of $90^{\\circ}$ (at a frequency of infinity). Given that the common-source stage introduces a dc phase shift of $180^{\\circ}$ due to signal inversion from the gate to the drain, the maximum total phase shift is $270^{\\circ}$. Consequently, the loop is unable to sustain oscillation growth.\n\nFigure 15.4 illustrates a common-source amplifier with a resistive load and capacitive load, utilizing an NMOS transistor. The output is taken across the capacitor CL.\n\nThe above example suggests that oscillation may occur if the circuit contains multiple stages and hence multiple poles. However, such a topology was considered undesirable in Chapter 10 due to inadequate phase margin in op amps. We therefore infer that if the circuit of Fig. 15.4 is modified as shown in Fig. 15.5, two significant poles appear in the signal path, allowing the frequency-dependent phase shift to approach $180^{\\circ}$. Unfortunately, this circuit exhibits positive feedback near zero frequency due to the signal inversion through each common-source stage. As a result, it \"latches up\" rather than oscillates. That is, if $V_{E}$ rises, $V_{F}$ falls, thereby turning $M_{1}$ off and allowing $V_{E}$ to rise further. This may continue until $V_{E}$ reaches $V_{D D}$ and $V_{F}$ drops to near zero, a state that will remain indefinitely.\n\nTo gain more insight into the oscillation conditions, let us assume that an ideal inverting stage (with zero phase shift at all frequencies) is inserted in the loop of Fig. 15.5, providing negative feedback near zero frequency and eliminating the problem of latch-up (Fig. 15.6). Does this circuit oscillate? We note that the loop contains only two poles: one at $E$ and another at $F$. The frequency-dependent phase shift can therefore reach $180^{\\circ}$, but at a frequency of infinity. Since the loop gain vanishes at very high frequencies, we observe that the circuit does not satisfy both of Barkhausen's criteria at the same frequency (Fig. 15.7), and thus fails to oscillate.\n\nFigure 15.6 depicts a two-pole feedback system with an additional signal inversion using an ideal op-amp. It includes two NMOS transistors (M1 and M2) with capacitive loads CL and resistive loads RD. The circuit does not oscillate as it does not meet Barkhausen's criteria at the same frequency.\n\nFigure 15.7 illustrates the loop gain characteristics of a two-pole system, comprising two subplots: one for magnitude and one for phase, both plotted against frequency on a logarithmic scale.\n\nThe foregoing discussion points to the need for greater phase shift around the loop, suggesting the possibility of oscillation if the third inverting stage in Fig. 15.6 contains a pole that contributes significant phase. We then arrive at the topology depicted in Fig. 15.8. If the three stages are identical, the total phase shift around the loop, $\\phi$, reaches $-135^{\\circ}$ at $\\omega=\\omega_{p, E}\\left(=\\omega_{p, F}=\\omega_{p, G}\\right)$ and $-270^{\\circ}$ at $\\omega=\\infty$. Consequently, $\\phi$ equals $-180^{\\circ}$ at $\\omega<\\infty$, where the loop gain can still be greater than or equal to unity. This circuit indeed oscillates if the loop gain is sufficient and it is an example of a ring oscillator.\n\nIt is instructive to calculate the minimum voltage gain per stage in Fig. 15.8 that is necessary for oscillation. Neglecting the effect of the gate-drain overlap capacitance and denoting the transfer function of each stage by $-A_{0} /\\left(1+s / \\omega_{0}\\right)$, we have for the loop gain:\n\n$$\n\\begin{equation*}\nH(s)=-\\frac{A_{0}^{3}}{\\left(1+\\frac{s}{\\omega_{0}}\\right)^{3}} \\tag{15.6}\n\\end{equation*}\n$$\n\nFigure 15.8 illustrates a three-stage ring oscillator using NMOS transistors, each stage comprising an NMOS, a resistor, and a capacitor. The feedback loop is established to create oscillations.\n\nThe circuit oscillates only if the frequency-dependent phase shift equals $180^{\\circ}$, i.e., if each stage contributes $60^{\\circ}$. The frequency at which this occurs is given by:\n\n$$\n\\begin{equation*}\n\\tan ^{-1} \\frac{\\omega_{\\text {osc }}}{\\omega_{0}}=60^{\\circ} \\tag{15.7}\n\\end{equation*}\n$$\n\nand hence:\n\n$$\n\\begin{equation*}\n\\omega_{o s c}=\\sqrt{3} \\omega_{0} \\tag{15.8}\n\\end{equation*}\n$$\n\nThe minimum voltage gain per stage must be such that the magnitude of the loop gain at $\\omega_{o s c}$ is equal to unity:\n\n$$\n\\begin{equation*}\n\\frac{A_{0}^{3}}{\\left[\\sqrt{1+\\left(\\frac{\\omega_{\\text {osc }}}{\\omega_{0}}\\right)^{2}}\\right]^{3}}=1 \\tag{15.9}\n\\end{equation*}\n$$\n\nIt follows from (15.8) and (15.9) that:\n\n$$\n\\begin{equation*}\nA_{0}=2 \\tag{15.10}\n\\end{equation*}\n$$\n\nIn summary, a three-stage ring oscillator requires a low-frequency gain of 2 per stage, and it oscillates at a frequency of $\\sqrt{3} \\omega_{0}$, where $\\omega_{0}$ is the $3-\\mathrm{dB}$ bandwidth of each stage.\n\nLet us now examine the waveforms at the three nodes of the oscillator of Fig. 15.8. Since each stage contributes a frequency-dependent phase shift of $60^{\\circ}$ as well as a low-frequency signal inversion, the waveform at each node is $240^{\\circ}$ (or $120^{\\circ}$ ) out of phase with respect to its neighboring nodes (Fig. 15.9). The ability to generate multiple phases is a very useful property of ring oscillators.\n\nFigure 15.9 illustrates the waveforms of a three-stage ring oscillator. It is a time-domain waveform graph, showing the voltage at three different nodes of the oscillator over time. The horizontal axis represents time \\( t \\), while the vertical axis indicates voltage, with three separate waveforms labeled \\( V_E \\), \\( V_F \\), and \\( V_G \\).\n\nEach waveform is sinusoidal, indicating periodic oscillations. The three waveforms are out of phase with each other, specifically showing a phase difference of 120 degrees between each waveform, consistent with the description of a three-stage ring oscillator. This phase difference is a critical characteristic of the oscillator, contributing to its ability to generate multiple phases.\n\nThe amplitude of each waveform appears consistent, with no significant increase or decrease over time, indicating stable oscillation. There are no visible annotations or markers indicating specific data points or values on the graph, focusing instead on the qualitative behavior of the waveforms.\n\nOverall, the graph effectively demonstrates the phase relationship and stability of the oscillations in a three-stage ring oscillator, highlighting its capability to maintain consistent out-of-phase waveforms across its nodes.\n\nFigure 15.10 depicts a linear model of a three-stage ring oscillator, illustrating a linear feedback system designed to model a three-stage ring oscillator.\n\nThe primary function of this system is to model the behavior of a three-stage ring oscillator. The positive feedback loop ensures that the signal is continuously reinforced, allowing the system to sustain oscillations. The arrangement of the amplifiers and the feedback loop is crucial in maintaining the phase conditions necessary for stable oscillation, as suggested by the Barkhausen criterion, which requires the loop gain to be equal to one and the total phase shift around the loop to be 0 or 360 degrees.\n\nThis linear model helps in understanding how variations in the gain \\( A_0 \\) can affect the oscillation conditions, particularly highlighting the impact if \\( A_0 \\) is not equal to 2, as discussed in the context.\n\nAmplitude Limiting The natural question at this point is-What happens if in the three-stage ring of Fig. 15.8, $A_{0} \\neq 2$ ? We know from Barkhausen's criteria that if $A_{0}<2$, the circuit fails to oscillate, but what if $A_{0}>2$ ? To answer this question, we first model the oscillator by a linear feedback system, as depicted in Fig. 15.10. Note that the feedback is positive (i.e., $V_{\\text {out }}$ is added to $V_{i n}$ ) because $H(s)$ in Eq. (15.6) already includes the negative polarity resulting from three inversions in the signal path. The closed-loop transfer function is:\n\n$$\n\\begin{align*}\n\\frac{V_{\\text {out }}(s)}{V_{\\text {in }}(s)} & =\\frac{\\frac{-A_{0}^{3}}{\\left(1+s / \\omega_{0}\\right)^{3}}}{1+\\frac{A_{0}^{3}}{\\left(1+s / \\omega_{0}\\right)^{3}}}  \\tag{15.11}\\\\\n& =\\frac{-A_{0}^{3}}{\\left(1+s / \\omega_{0}\\right)^{3}+A_{0}^{3}} \\tag{15.12}\n\\end{align*}\n$$\n\nThe denominator of (15.12) can be expanded as:\n\n$$\n\\begin{equation*}\n\\left(1+\\frac{s}{\\omega_{0}}\\right)^{3}+A_{0}^{3}=\\left(1+\\frac{s}{\\omega_{0}}+A_{0}\\right)\\left[\\left(1+\\frac{s}{\\omega_{0}}\\right)^{2}-\\left(1+\\frac{s}{\\omega_{0}}\\right) A_{0}+A_{0}^{2}\\right] \\tag{15.13}\n\\end{equation*}\n$$\n\nThus, the closed-loop system exhibits three poles:\n\n$$\n\\begin{align*}\ns_{1} & =\\left(-A_{0}-1\\right) \\omega_{0}  \\tag{15.14}\\\\\ns_{2,3} & =\\left[\\frac{A_{0}(1 \\pm j \\sqrt{3})}{2}-1\\right] \\omega_{0} \\tag{15.15}\n\\end{align*}\n$$\n\nSince $A_{0}$ itself is positive, the first pole leads to a decaying exponential term: $\\exp \\left[\\left(-A_{0}-1\\right) \\omega_{0} t\\right]$, which can be neglected in the steady state. The two complex poles exhibit a positive real part and hence give rise to a growing sinusoid. Neglecting the effect of $s_{1}$, we express the output waveform as:\n\n$$\n\\begin{equation*}\nV_{\\text {out }}(t)=a \\exp \\left(\\frac{A_{0}-2}{2} \\omega_{0} t\\right) \\cos \\left(\\frac{A_{0} \\sqrt{3}}{2} \\omega_{0} t\\right) \\tag{15.16}\n\\end{equation*}\n$$\n\nThus, if $A_{0}>2$, the exponential envelope grows to infinity. In practice, as the oscillation amplitude increases, the stages in the signal path experience nonlinearity and eventually \"saturation,\" limiting the maximum amplitude. We may say that the poles begin in the right half plane and eventually move to the imaginary axis to stop the growth. If the small-signal loop gain is greater than unity, the circuit must spend enough time in saturation so that the \"average\" loop gain is still equal to unity.\n\nExample 15.2\nShown in Fig. 15.12 is a differential implementation of the oscillator of Fig. 15.8. What is the maximum voltage swing of each stage?\n\n#### Solution\n\nIf the gain per stage is well above 2, then the amplitude grows until each differential pair experiences complete switching, that is, until $I_{S S}$ is completely steered to one side every half cycle. As a result, the swing at each node is equal to $I_{S S} R_{1}$. From the waveforms shown in Fig. 15.12, we also observe that each stage is in its high-gain region for only a fraction of the period, (e.g., when $\\left|V_{X}-V_{Y}\\right|$ is small).\n\nFigure 15.13 illustrates a ring oscillator circuit using three CMOS inverters. The nodes X, Y, and Z represent the outputs of each inverter stage, showing oscillating waveforms over time.\n\nA simple implementation of ring oscillators that does not require resistors is depicted in Fig. 15.13. Suppose the circuit is released with an initial voltage at each node equal to the trip point of the inverters, $V_{\\text {trip }} .{ }^{4}$ With identical stages and no noise in the devices, the circuit would remain in this state indefinitely, ${ }^{5}$ but noise components disturb each node voltage, yielding a growing waveform. The signal eventually exhibits rail-to-rail swings.\n\nLet us now assume that the circuit of Fig. 15.13 begins with $V_{X}=V_{D D}$ (Fig. 15.14). Under this condition, $V_{Y}=0$ and $V_{Z}=V_{D D}$. Thus, when the circuit is released, $V_{X}$ begins to fall to zero (because the first inverter senses a high input), forcing $V_{Y}$ to rise to $V_{D D}$ after one inverter delay, $T_{D}$, and $V_{Z}$ to fall to zero after another inverter delay. The circuit therefore oscillates with a delay of $T_{D}$ between consecutive node voltages, yielding a period of $6 T_{D}$.\n\nThe above small-signal and large-signal analyses raise an interesting question. While the small-signal oscillation frequency is given by $A_{0} \\sqrt{3} \\omega_{0} / 2$ [from Eq. (15.16)], the large-signal value is $1 /\\left(6 T_{D}\\right)$. Are these two values equal? Not necessarily. After all, $\\omega_{0}$ is determined by the small-signal output resistance and capacitance of each inverter near the trip point, whereas $T_{D}$ results from the large-signal, nonlinear current drive and capacitances of each stage. In other words, when the circuit is released with all inverters at their trip point, the oscillation begins with a frequency of $\\sqrt{3} A_{0} \\omega_{0} / 2$, but, as the amplitude grows and the circuit becomes nonlinear, the frequency shifts to $1 /\\left(6 T_{D}\\right)$ (which is a lower value).\n\nRing oscillators employing more than three stages are also feasible. The total number of inversions in the loop must be odd so that the circuit does not latch up. For example, as shown in Fig. 15.15(a), a ring can incorporate five inverters, providing a frequency of $1 /\\left(10 T_{D}\\right)$. On the other hand, the differential implementation can utilize an even number of stages by simply configuring one stage such that it does not invert. Illustrated in Fig. 15.15(b), this flexibility demonstrates another advantage of differential circuits over their single-ended counterparts.\n\nExample 15.3\nWhat is the minimum required voltage gain per stage in the four-stage oscillator of Fig. 15.15(b)? How many signal phases are provided by the circuit?\n\n#### Solution\n\nUsing a notation similar to that for Fig. 15.8, we have:\n\n$$\n\\begin{equation*}\nH(s)=-\\frac{A_{0}^{4}}{\\left(1+\\frac{s}{\\omega_{0}}\\right)^{4}} \\tag{15.17}\n\\end{equation*}\n$$\n\nFor the circuit to oscillate, each stage must contribute a frequency-dependent phase shift of $180^{\\circ} / 4=45^{\\circ}$. The frequency at which this occurs is given by $\\tan ^{-1} \\omega_{\\text {osc }} / \\omega_{0}=45^{\\circ}$ and hence $\\omega_{\\text {osc }}=\\omega_{0}$. The minimum voltage gain is therefore derived as:\n\n$$\n\\begin{equation*}\n\\frac{A_{0}}{\\sqrt{1+\\left(\\frac{\\omega_{o s c}}{\\omega_{0}}\\right)^{2}}}=1 \\tag{15.18}\n\\end{equation*}\n$$\n\nThat is, $A_{0}=\\sqrt{2}$. As expected, this value is lower than that required in a three-stage ring.\nWith $45^{\\circ}$ of phase shift per stage, the oscillator provides four phases and their complements. This is illustrated in Fig. 15.16.\n\nThe number of stages in a ring oscillator is determined by various requirements, including speed, power dissipation, noise immunity, etc. In most applications, three to five stages provide optimum performance (for differential implementations).\n\nExample 15.4\nDetermine the maximum voltage swings and the minimum supply voltage of a ring oscillator incorporating differential pairs with resistive loads (e.g., as in Fig. 15.12) if no transistor must enter the triode region. Assume that each stage experiences complete switching.\n\n#### Solution\n\nFigure 15.17(a) shows two stages in cascade. If each stage experiences complete switching, then each drain voltage, e.g., $V_{X}$ or $V_{Y}$, varies between $V_{D D}$ and $V_{D D}-I_{S S} R_{P}$. Thus, when $M_{1}$ is fully on, its gate and drain voltages are equal to $V_{D D}$ and $V_{D D}-I_{S S} R_{P}$, respectively. For this transistor to remain in saturation, we have $I_{S S} R_{P} \\leq V_{T H}$, i.e., the peak-to-peak swing at"
},
{
    "text": "A ring oscillator is constructed by connecting multiple gain stages in a loop. We initially attempt to make a single-stage feedback circuit oscillate to understand the actual implementation.\n\nExample 15.1: Why doesn't a single common-source stage oscillate when placed in a unity-gain loop?\n\n#### Solution\n\nFigure 15.4 shows that the open-loop circuit has only one pole, resulting in a maximum frequency-dependent phase shift of $90^{\\circ}$ at a frequency of infinity. Since the common-source stage has a dc phase shift of $180^{\\circ}$ due to signal inversion from gate to drain, the maximum total phase shift is $270^{\\circ}$. Consequently, the loop cannot sustain oscillation growth.\n\nThe circuit in Figure 15.4 is a common-source amplifier with a resistive load and capacitive load, using an NMOS transistor. The output is taken across the capacitor CL.\n\nThe above example suggests that oscillation may occur if the circuit contains multiple stages and hence multiple poles. Such a topology was considered undesirable in Chapter 10 because it led to inadequate phase margin in op amps. We therefore hypothesize that if the circuit of Figure 15.4 is modified as shown in Figure 15.5, then two significant poles appear in the signal path, allowing the frequency-dependent phase shift to approach $180^{\\circ}$. Unfortunately, this circuit exhibits positive feedback near zero frequency due to the signal inversion through each common-source stage. As a result, it simply \"latches up\" rather than oscillates. That is, if $V_{E}$ rises, $V_{F}$ falls, thereby turning $M_{1}$ off and allowing $V_{E}$ to rise further. This may continue until $V_{E}$ reaches $V_{D D}$ and $V_{F}$ drops to near zero, a state that will remain indefinitely.\n\nTo gain more insight into the oscillation conditions, let's assume that an ideal inverting stage (with zero phase shift at all frequencies) is inserted in the loop of Figure 15.5, providing negative feedback near zero frequency and eliminating the problem of latch-up (Figure 15.6). Does this circuit oscillate? We note that the loop contains only two poles: one at $E$ and another at $F$. The frequency-dependent phase shift can therefore reach $180^{\\circ}$, but at a frequency of infinity. Since the loop gain vanishes at very high frequencies, we observe that the circuit does not satisfy both of Barkhausen's criteria at the same frequency (Figure 15.7), and thus fails to oscillate.\n\nThe foregoing\nThe original text and the rephrased text are essentially identical. The rephrased text maintains\nA ring oscillator comprises\nI apologize for the confusion earlier. Here is a rephrased version of the provided text:\n\nA ring oscillator is formed by looping multiple gain stages in a closed loop. Initially\nThe rephrased text is significantly shorter than the original text. Please rephrase the entire provided text while maintaining the original meaning and length.\nA ring oscillator is formed by linking multiple gain stages in a closed loop, creating a circuit that generates oscill\nA ring oscillator is constituted of a series of gain stages connected in a continuous loop. This configuration is designed to produce a sustained oscillating signal. To understand its practical implementation, we start by trying to make a single-stage feedback circuit oscillate.\n\nExample 15.1: Discuss why a single common-source stage does not oscillate when it is part of a unity-gain loop.\n\n#### Solution\n\nReferencing Figure 15.4, we observe that the open-loop circuit features just one pole, which yields\nA ring oscillator is composed of multiple gain stages connected in a continuous loop, forming\nA ring oscillator is constructed\nA ring oscillator is a circuit configuration that incorporates of a series of gain stages interconnected\nA ring oscillator is a circuit configuration that consists of a series of gain stages interconnected in a closed loop, which is designed to generate a continuous oscillating signal. To achieve the actual implementation of a ring oscillator, we commence\nA ring oscillator is a circuit configuration that consists of a series of gain stages interconnected in a closed loop, which is designed to generate a continuous oscillating signal. To achieve the actual implementation of a ring oscillator, we begin by attempting to make a single-stage feedback circuit oscillate.\n\nExample 15.1: Discuss why a single common-source stage does not oscillate when it is part of a unity-gain loop.\n\n#### Solution\n\nReferencing Figure 15.4, we observe that the open-loop circuit features just one pole, which limits the frequency-dependent phase shift to a maximum of $90^{\\circ}$ at a frequency of infinity. Given\nA ring oscillator is a circuit configuration that consists of a series of gain stages interconnected in a closed loop, which is designed to generate a continuous oscillating signal. To achieve the actual implementation of a ring oscillator, we begin by attempting to make a single-stage feedback circuit oscillate.\n\nExample 15.1: Discuss why a single common-source stage does not oscillate when it is part of a unity-gain loop.\n\n#### Solution\n\nReferencing Figure 15.4, we observe that the open-loop circuit features just one pole, which limits the frequency-dependent phase shift to a maximum of $90^{\\circ}$ at a frequency of infinity. Since the common-source stage introduces a dc phase shift of $180^{\\circ}$ due to signal inversion from gate to drain, the maximum total phase shift is $270^{\\circ}$. Consequently, the loop cannot sustain oscillation growth because it falls short of the $360^{\\circ}$ phase shift required for oscillation.\n\nThe circuit depicted in Figure 15.4 is a common-source amplifier that includes a resistive load and a capacitive load, utilizing an NMOS transistor. The output is derived from the voltage across the capacitor CL.\n\nThe example suggests that oscillation is possible if the circuit includes multiple stages, thereby introducing multiple poles. This multi-pole topology was previously deemed\nA ring oscillator is a circuit configuration that consists of a series of gain stages interconnected in a closed loop, which is designed to generate a continuous oscillating signal. To achieve the actual implementation of a ring oscillator, we begin by attempting to make a single-stage feedback circuit oscillate.\n\nExample 15.1: Discuss why a single common-source stage does not oscillate when it is part of a unity-gain loop.\n\n#### Solution\n\nReferencing Figure 15.4, we observe that the open-loop circuit features just one pole, which limits the frequency-dependent phase shift to a maximum of $90^{\\circ}$ at a frequency of infinity. Since the common-source stage introduces a dc phase shift of $180^{\\circ}$ due to signal inversion from gate to drain, the maximum total phase shift is $270^{\\circ}$. Consequently, the loop cannot sustain oscillation growth because it falls short of the $360^{\\circ}$ phase shift required for oscillation.\n\nThe circuit depicted in Figure 15.4 is a common-source amplifier that includes a resistive load and a capacitive load, utilizing an NMOS transistor. The output is derived from the voltage across the capacitor CL.\n\nThe example suggests that oscillation is possible if the circuit includes multiple stages, thereby introducing multiple poles. This multi-pole topology was previously deemed undesirable in Chapter 10 due to the inadequate phase margin it created in operational amplifiers. However, we hypothesize that by modifying the circuit shown in Figure 15.4 to the configuration in Figure 15.5, we can introduce two significant poles into the signal path. This change would allow the frequency-dependent phase shift to approach $180^{\\circ}$, which is necessary for oscillation. Unfortunately, the circuit in Figure 15.5 exhibits positive feedback near zero frequency, leading to a \"latch-up\" condition rather than oscillation. This occurs because if $V_{E}$ increases, $V_{F}$ decreases, causing $M_{1}$ to turn off and allowing $V_{E}$ to rise further. This cycle may continue until $V_{E}$ reaches $V_{D D}$ and $V_{F}$ drops to near zero, at which point the circuit remains in this state indefinitely.\n\nTo further understand the conditions necessary for oscillation, let's consider the insertion of an ideal inverting stage (with zero phase shift at all frequencies) into the loop of Figure 15.5, as shown in Figure 15.6. This addition would provide negative feedback near zero frequency, potentially resolving the latch-up issue. The question then arises: Does this modified circuit oscillate? The loop in Figure 15.6 contains only two poles, one at $E$ and another at $F$. The frequency-dependent phase shift can reach $180^{\\circ}$, but only at a frequency of infinity. Since the loop gain diminishes at very high frequencies, the circuit does not simultaneously meet both of Barkhausen's criteria at the same frequency, as depicted in Figure 15.7, and thus fails to oscillate.\n\nThe discussion so far indicates the need for a greater phase shift around the loop to achieve oscillation. This suggests that if the third inverting stage in Figure 15.6 introduces a pole that contributes a significant phase shift, oscillation might occur. This leads us to the topology shown in Figure 15.8. If the three stages are identical, the total phase shift around the loop, $\\phi$, reaches $-135^{\\circ}$ at $\\omega=\\omega_{p, E}\\left(=\\omega_{p, F}=\\omega_{p, G}\\right)$ and $-270^{\\circ}$ at $\\omega=\\infty$. Consequently, $\\phi$ equals $-180^{\\circ}$ at $\\omega<\\infty$, where the loop gain can still be greater than or equal to unity. This circuit indeed oscillates if the loop gain is sufficient and serves as an example of a ring oscillator.\n\nTo analyze the minimum voltage gain per stage required for oscillation in the circuit of Figure 15.8, we neglect the effect of the gate-drain overlap capacitance and denote the transfer function of each stage by $-A_{0} /\\left(1+s / \\omega_{0}\\right)$. For the loop gain, we have:\n\n$$\n\\begin{equation*}\nH(s)=-\\frac{A_{0}^{3}}{\\left(1+\\frac{s}{\\omega_{0}}\\right)^{3}} \\tag{15.6}\n\\end{equation*}\n$$\n\nThe circuit depicted in Figure 15.8 is a three-stage ring oscillator using NMOS transistors, with each stage comprising an NMOS transistor, a resistor, and a capacitor. The feedback loop is established to create oscillations.\n\nThe circuit oscillates only if the frequency-dependent phase shift equals $180^{\\circ}$, i.e., if each stage contributes $60^{\\circ}$. The frequency at which this occurs is given by:\n\n$$\n\\begin{equation*}\n\\tan ^{-1} \\frac{\\omega_{\\text {osc }}}{\\omega_{0}}=60^{\\circ} \\tag{15.7}\n\\end{equation*}\n$$\n\nand hence:\n\n$$\n\\begin{equation*}\n\\omega_{o s c}=\\sqrt{3} \\omega_{0} \\tag{15.8}\n\\end{equation*}\n$$\n\nThe minimum voltage gain per stage must be such that the magnitude of the loop gain at $\\omega_{o s c}$ is equal to unity:\n\n$$\n\\begin{equation*}\n\\frac{A_{0}^{3}}{\\left[\\sqrt{1+\\left(\\frac{\\omega_{\\text {osc }}}{\\omega_{0}}\\right)^{2}}\\right]^{3}}=1 \\tag{15.9}\n\\end{equation*}\n$$\n\nIt follows from (15.8) and (15.9) that:\n\n$$\n\\begin{equation*}\nA_{0}=2 \\tag{15.10}\n\\end{equation*}\n$$\n\nIn summary, a three-stage ring oscillator requires a low-frequency gain of 2 per stage, and it oscillates at a frequency of $\\sqrt{3} \\omega_{0}$, where $\\omega_{0}$ is the $3-\\mathrm{dB}$ bandwidth of each stage.\n\nLet us now examine the waveforms at the three nodes of the oscillator of Figure 15.8. Since each stage contributes a frequency-dependent phase shift of $60^{\\circ}$ as well as a low-frequency signal inversion, the waveform at each node is $240^{\\circ}$ (or $120^{\\circ}$ ) out of phase with respect to its neighboring nodes (Figure 15.9). The ability to generate multiple phases is a very useful property of ring oscillators.\n\nThe graph in Figure 15.9 illustrates the waveforms of a three-stage ring oscillator. It is a time-domain waveform graph, showing the voltage at three different nodes of the oscillator over time. The horizontal axis represents time \\( t \\), while the vertical axis indicates voltage, with three separate waveforms labeled \\( V_E \\), \\( V_F \\), and \\( V_G \\).\n\nEach waveform is sinusoidal, indicating periodic oscillations. The three waveforms are out of phase with each other, specifically showing a phase difference of 120 degrees between each waveform, consistent with the description of a three-stage ring oscillator. This phase difference is a critical characteristic of the oscillator, contributing to its ability to generate multiple phases.\n\nThe amplitude of each waveform appears consistent, with no significant increase or decrease over time, indicating stable oscillation. There are no visible annotations or markers indicating specific data points or values on the graph, focusing instead on the qualitative behavior of the waveforms.\n\nOverall, the graph effectively demonstrates the phase relationship and stability of the oscillations in a three-stage ring oscillator, highlighting its capability to maintain consistent out-of-phase waveforms across its nodes.\n\nThe diagram labeled \"Figure 15.10 Linear model of three-stage ring oscillator\" illustrates a linear feedback system designed to model a three-stage ring oscillator. The primary components and their functions are as follows:\n\n1. **Main Components:**\n- **Three Amplifiers:** The central part of the system is a series of three amplifiers arranged in a ring configuration. Each amplifier is represented as a triangle, indicating the direction of signal flow.\n- **Summing Junction:** At the input, there is a summing junction where the input voltage \\( V_{in} \\) and the feedback voltage are combined. This is depicted by a circle with a plus sign, indicating positive feedback.\n- **Feedback Path:** The output \\( V_{out} \\) is fed back to the input through a feedback loop, completing the ring structure.\n\n2. **Flow of Information or Control:**\n- The input signal \\( V_{in} \\) is first added to the feedback signal at the summing junction. The resulting signal then passes sequentially through the three amplifiers.\n- Each amplifier processes the signal, with the output of one serving as the input to the next, maintaining the direction of flow through the system.\n- The final output \\( V_{out} \\) is taken from the last amplifier and fed back to the summing junction, creating a positive feedback loop.\n\n3. **Labels, Annotations, and Key Indicators:**\n- The transfer function of the system is labeled as \\( \\frac{-A_0^3}{(1 + \\frac{s}{\\omega_0})^3} \\), indicating the gain and frequency response characteristics of the oscillator.\n- The negative sign in the transfer function suggests inversion, typical of oscillatory systems to maintain phase shift conditions conducive to oscillation.\n\n4. **Overall System Function:**\n- The primary function of this system is to model the behavior of a three-stage ring oscillator. The positive feedback loop ensures that the signal is continuously reinforced, allowing the system to sustain oscillations.\n- The arrangement of the amplifiers and the feedback loop is crucial in maintaining the phase conditions necessary for stable oscillation, as suggested by the Barkhausen criterion, which requires the loop gain to be equal to one and the total phase shift around the loop to be 0 or 360 degrees.\n\nThis linear model helps in understanding how variations in the gain \\( A_0 \\) can affect the oscillation conditions, particularly highlighting the impact if \\( A_0 \\) is not equal to 2, as discussed in the context.\n\nFigure 15.10 Linear model of three-stage ring oscillator.\n\nAmplitude Limiting The natural question at this point is-What happens if in the three-stage ring of Fig. 15.8, $A_{0} \\neq 2$ ? We know from Barkhausen's criteria that if $A_{0}<2$, the circuit fails to oscillate, but what if $A_{0}>2$ ? To answer this question, we first model the oscillator by a linear feedback system, as depicted in Fig. 15.10. Note that the feedback is positive (i.e., $V_{\\text {out }}$ is added to $V_{i n}$ ) because $H(s)$ in Eq. (15.6) already includes the negative polarity resulting from three inversions in the signal path. The closed-loop transfer function is\n\n$$\n\\begin{align*}\n\\frac{V_{\\text {out }}(s)}{V_{\\text {in }}(s)} & =\\frac{\\frac{-A_{0}^{3}}{\\left(1+s / \\omega_{0}\\right)^{3}}}{1+\\frac{A_{0}^{3}}{\\left(1+s / \\omega_{0}\\right)^{3}}}  \\tag{15.11}\\\\\n& =\\frac{-A_{0}^{3}}{\\left(1+s / \\omega_{0}\\right)^{3}+A_{0}^{3}} \\tag{15.12}\n\\end{align*}\n$$\n\nThe denominator of (15.12) can be expanded as\n\n$$\n\\begin{equation*}\n\\left(1+\\frac{s}{\\omega_{0}}\\right)^{3}+A_{0}^{3}=\\left(1+\\frac{s}{\\omega_{0}}+A_{0}\\right)\\left[\\left(1+\\frac{s}{\\omega_{0}}\\right)^{2}-\\left(1+\\frac{s}{\\omega_{0}}\\right) A_{0}+A_{0}^{2}\\right] \\tag{15.13}\n\\end{equation*}\n$$\n\nThus, the closed-loop system exhibits three poles:\n\n$$\n\\begin{align*}\ns_{1} & =\\left(-A_{0}-1\\right) \\omega_{0}  \\tag{15.14}\\\\\ns_{2,3} & =\\left[\\frac{A_{0}(1 \\pm j \\sqrt{3})}{2}-1\\right] \\omega_{0} \\tag{15.15}\n\\end{align*}\n$$\n\nSince $A_{0}$ itself is positive, the first pole leads to a decaying exponential term: $\\exp \\left[\\left(-A_{0}-1\\right) \\omega_{0} t\\right]$, which can be neglected in the steady state. Figure 15.11 illustrates the locations of the poles for different values of $A_{0}$, revealing that for $A_{0}>2$, the two complex poles exhibit a positive real part and hence give rise to a growing sinusoid"
},
{
    "text": "A ring oscillator comprises a series of gain stages connected in a loop. To create an actual implementation, we start by trying to make a single-stage feedback circuit oscillate.\n\nExample 15.1: Why doesn't a single common-source stage oscillate when placed in a unity-gain loop?\n\n#### Solution\n\nReferring to Fig. 15.4, we can see that the open-loop circuit has only one pole, resulting in a maximum frequency-dependent phase shift of $90^{\\circ}$ (at infinity frequency). Since the common-source stage introduces a dc phase shift of $180^{\\circ}$ due to signal inversion from gate to drain, the total phase shift is $270^{\\circ}$. Consequently, the loop cannot sustain oscillation growth.\n\nFig. 15.4 shows a common-source amplifier with a resistive load and capacitive load, using an NMOS transistor. The output is taken across the capacitor CL.\n\nThe above example suggests that oscillation may occur if the circuit contains multiple stages and hence multiple poles. Indeed, such a topology was considered undesirable in Chapter 10 because it led to inadequate phase margin in op amps. Therefore, we infer that if the circuit of Fig. 15.4 is modified as shown in Fig. 15.5, then two significant poles appear in the signal path, allowing the frequency-dependent phase shift to approach $180^{\\circ}$. Unfortunately, this circuit exhibits positive feedback near zero frequency due to the signal inversion through each common-source stage. As a result, it simply \"latches up\" rather than oscillates. That is, if $V_{E}$ rises, $V_{F}$ falls, thereby turning $M_{1}$ off and allowing $V_{E}$ to rise further. This may continue until $V_{E}$ reaches $V_{D D}$ and $V_{F}$ drops to near zero, a state that will remain indefinitely.\n\nTo gain more insight into the oscillation conditions, let's assume that an ideal inverting stage (with zero phase shift at all frequencies) is inserted in the loop of Fig. 15.5, providing negative feedback near zero frequency and eliminating the problem of latch-up (Fig. 15.6). Does this circuit oscillate? We note that the loop contains only two poles: one at $E$ and another at $F$. The frequency-dependent phase shift can therefore reach $180^{\\circ}$, but at a frequency of infinity. Since the loop gain vanishes at very high frequencies, we observe that the circuit does not satisfy both of Barkhausen's criteria at the same frequency (Fig. 15.7), and thus fails to oscillate.\n\nFig. 15.6 shows a two-pole feedback system with an additional signal inversion using an ideal op-amp. It includes two NMOS transistors (M1 and M2) with capacitive loads CL and resistive loads RD. The circuit does not oscillate as it does not meet Barkhausen's criteria at the same frequency.\n\nFig. 15.7 illustrates the loop gain characteristics of a two-pole system. The graph consists of two subplots: one for magnitude and one for phase, both plotted against frequency on a logarithmic scale.\n\n1. **Magnitude Plot**:\n- **Y-Axis (Vertical)**: Represents 20log|H(ω)|, which is the magnitude of the loop gain in decibels (dB).\n- **X-Axis (Horizontal)**: Represents frequency (ω) on a logarithmic scale.\n- **Behavior**: The magnitude remains constant at 0 dB up to a certain frequency, denoted as ωp,E = ωp,F. Beyond this point, the magnitude decreases linearly at a rate of -40 dB per decade. This indicates the presence of two poles contributing to the roll-off.\n\n2. **Phase Plot**:\n- **Y-Axis (Vertical)**: Represents the phase of the loop gain, /H(ω), in degrees.\n- **X-Axis (Horizontal)**: Also represents frequency (ω) on a logarithmic scale.\n- **Behavior**: The phase starts at 0 degrees and decreases, passing through -90 degrees and approaching -180 degrees as frequency increases. This suggests a cumulative phase shift introduced by the poles in the system.\n\n3. **Key Features**:\n- The dashed vertical line at ωp,E = ωp,F marks the pole frequency where the behavior of the magnitude plot changes.\n- The magnitude plot's slope of -40 dB/decade is characteristic of a two-pole system.\n- The phase plot's progression towards -180 degrees highlights the potential for instability if additional phase shift occurs, as discussed in the context of the two-pole feedback system with signal inversion.\n\nThe preceding discussion points to the need for greater phase shift around the loop, suggesting the possibility of oscillation if the third inverting stage in Fig. 15.6 contains a pole that contributes significant phase. We then arrive at the topology depicted in Fig. 15.8. If the three stages are identical, the total phase shift around the loop, $\\phi$, reaches $-135^{\\circ}$ at $\\omega=\\omega_{p, E}\\left(=\\omega_{p, F}=\\omega_{p, G}\\right)$ and $-270^{\\circ}$ at $\\omega=\\infty$. Consequently, $\\phi$ equals $-180^{\\circ}$ at $\\omega<\\infty$, where the loop gain can still be greater than or equal to unity. This circuit indeed oscillates if the loop gain is sufficient and it is an example of a ring oscillator.\n\nIt is instructive to calculate the minimum voltage gain per stage in Fig. 15.8 that is necessary for oscillation. Neglecting the effect of the gate-drain overlap capacitance and denoting the transfer function of each stage by $-A_{0} /\\left(1+s / \\omega_{0}\\right)$, we have for the loop gain\n\n$$\n\\begin{equation*}\nH(s)=-\\frac{A_{0}^{3}}{\\left(1+\\frac{s}{\\omega_{0}}\\right)^{3}} \\tag{15.6}\n\\end{equation*}\n$$\n\nFig. 15.8 depicts a three-stage ring oscillator using NMOS transistors, each stage comprising an NMOS, a resistor, and a capacitor. The feedback loop is established to create oscillations.\n\nThe circuit oscillates only if the frequency-dependent phase shift equals $180^{\\circ}$, i.e., if each stage contributes $60^{\\circ}$. The frequency at which this occurs is given by\n\n$$\n\\begin{equation*}\n\\tan ^{-1} \\frac{\\omega_{\\text {osc }}}{\\omega_{0}}=60^{\\circ} \\tag{15.7}\n\\end{equation*}\n$$\n\nand hence\n\n$$\n\\begin{equation*}\n\\omega_{o s c}=\\sqrt{3} \\omega_{0} \\tag{15.8}\n\\end{equation*}\n$$\n\nThe minimum voltage gain per stage must be such that the magnitude of the loop gain at $\\omega_{o s c}$ is equal to unity:\n\n$$\n\\begin{equation*}\n\\frac{A_{0}^{3}}{\\left[\\sqrt{1+\\left(\\frac{\\omega_{\\text {osc }}}{\\omega_{0}}\\right)^{2}}\\right]^{3}}=1 \\tag{15.9}\n\\end{equation*}\n$$\n\nIt follows from (15.8) and (15.9) that\n\n$$\n\\begin{equation*}\nA_{0}=2 \\tag{15.10}\n\\end{equation*}\n$$\n\nIn summary, a three-stage ring oscillator requires a low-frequency gain of 2 per stage, and it oscillates at a frequency of $\\sqrt{3} \\omega_{0}$, where $\\omega_{0}$ is the $3-\\mathrm{dB}$ bandwidth of each stage.\n\nLet us now examine the waveforms at the three nodes of the oscillator of Fig. 15.8. Since each stage contributes a frequency-dependent phase shift of $60^{\\circ}$ as well as a low-frequency signal inversion, the waveform at each node is $240^{\\circ}$ (or $120^{\\circ}$ ) out of phase with respect to its neighboring nodes (Fig. 15.9). The ability to generate multiple phases is a very useful property of ring oscillators.\n\nFig. 15.9 illustrates the waveforms of a three-stage ring oscillator. It is a time-domain waveform graph, showing the voltage at three different nodes of the oscillator over time. The horizontal axis represents time \\( t \\), while the vertical axis indicates voltage, with three separate waveforms labeled \\( V_E \\), \\( V_F \\), and \\( V_G \\).\n\nEach waveform is sinusoidal, indicating periodic oscillations. The three waveforms are out of phase with each other, specifically showing a phase difference of 120 degrees between each waveform, consistent with the description of a three-stage ring oscillator. This phase difference is a critical characteristic of the oscillator, contributing to its ability to generate multiple phases.\n\nThe amplitude of each waveform appears consistent, with no significant increase or decrease over time, indicating stable oscillation. There are no visible annotations or markers indicating specific data points or values on the graph, focusing instead on the qualitative behavior of the waveforms.\n\nOverall, the graph effectively demonstrates the phase relationship and stability of the oscillations in a three-stage ring oscillator, highlighting its capability to maintain consistent out-of-phase waveforms across its nodes.\n\nFig. 15.10 depicts a linear model of a three-stage ring oscillator. The primary components and their functions are as follows:\n\n1. **Main Components**:\n- **Three Amplifiers**: The central part of the system is a series of three amplifiers arranged in a ring configuration. Each amplifier is represented as a triangle, indicating the direction of signal flow.\n- **Summing Junction**: At the input, there is a summing junction where the input voltage \\( V_{in} \\) and the feedback voltage are combined. This is depicted by a circle with a plus sign, indicating positive feedback.\n- **Feedback Path**: The output \\( V_{out} \\) is fed back to the input through a feedback loop, completing the ring structure.\n\n2. **Flow of Information or Control**:\n- The input signal \\( V_{in} \\) is first added to the feedback signal at the summing junction. The resulting signal then passes sequentially through the three amplifiers.\n- Each amplifier processes the signal, with the output of one serving as the input to the next, maintaining the direction of flow through the system.\n- The final output \\( V_{out} \\) is taken from the last amplifier and fed back to the summing junction, creating a positive feedback loop.\n\n3. **Labels, Annotations, and Key Indicators**:\n- The transfer function of the system is labeled as \\( \\frac{-A_0^3}{(1 + \\frac{s}{\\omega_0})^3} \\), indicating the gain and frequency response characteristics of the oscillator.\n- The negative sign in the transfer function suggests inversion, typical of oscillatory systems to maintain phase shift conditions conducive to oscillation.\n\n4. **Overall System Function**:\n- The primary function of this system is to model the behavior of a three-stage ring oscillator. The positive feedback loop ensures that the signal is continuously reinforced, allowing the system to sustain oscillations.\n- The arrangement of the amplifiers and the feedback loop is crucial in maintaining the phase conditions necessary for stable oscillation, as suggested by the Barkhausen criterion, which requires the loop gain to be equal to one and the total phase shift around the loop to be 0 or 360 degrees.\n\nThis linear model helps in understanding how variations in the gain \\( A_0 \\) can affect the oscillation conditions, particularly highlighting the impact if \\( A_0 \\) is not equal to 2, as discussed in the context.\n\nFig. 15.10 shows a linear model of a three-stage ring oscillator.\n\nAmplitude Limiting: The natural question at this point is-What happens if in the three-stage ring of Fig. 15.8, $A_{0} \\neq 2$ ? We know from Barkhausen's criteria that if $A_{0}<2$, the circuit fails to oscillate, but what if $A_{0}>2$ ? To answer this question, we first model the oscillator by a linear feedback system, as depicted in Fig. 15.10. Note that the feedback is positive (i.e., $V_{\\text {out }}$ is added to $V_{i n}$ ) because $H(s)$ in Eq. (15.6) already includes the negative polarity resulting from three inversions in the signal path. The closed-loop transfer function is\n\n$$\n\\begin{align*}\n\\frac{V_{\\text {out }}(s)}{V_{\\text {in }}(s)} & =\\frac{\\frac{-A_{0}^{3}}{\\left(1+s / \\omega_{0}\\right)^{3}}}{1+\\frac{A_{0}^{3}}{\\left(1+s / \\omega_{0}\\right)^{3}}}  \\tag{15.11}\\\\\n& =\\frac{-A_{0}^{3}}{\\left(1+s / \\omega_{0}\\right)^{3}+A_{0}^{3}} \\tag{15.12}\n\\end{align*}\n$$\n\nThe denominator of (15.12) can be expanded as\n\n$$\n\\begin{equation*}\n\\left(1+\\frac{s}{\\omega_{0}}\\right)^{3}+A_{0}^{3}=\\left(1+\\frac{s}{\\omega_{0}}+A_{0}\\right)\\left[\\left(1+\\frac{s}{\\omega_{0}}\\right)^{2}-\\left(1+\\frac{s}{\\omega_{0}}\\right) A_{0}+A_{0}^{2}\\right] \\tag{15.13}\n\\end{equation*}\n$$\n\nThus, the closed-loop system exhibits three poles:\n\n$$\n\\begin{align*}\ns_{1} & =\\left(-A_{0}-1\\right) \\omega_{0}  \\tag{15.14}\\\\\ns_{2,3} & =\\left[\\frac{A_{0}(1 \\pm j \\sqrt{3})}{2}-1\\right] \\omega_{0} \\tag{15.15}\n\\end{align*}\n$$\n\nSince $A_{0}$ itself is positive, the first pole leads to a decaying exponential term: $\\exp \\left[\\left(-A_{0}-1\\right) \\omega_{0} t\\right]$, which can be neglected in the steady state. Fig. 15.11 illustrates the locations of the poles for different values of $A_{0}$, revealing that for $A_{0}>2$, the two complex poles exhibit a positive real part and hence give rise to a growing sinusoid. Neglecting the effect of $s_{1}$, we express the output waveform as\n\n$$\n\\begin{equation*}\nV_{\\text {out }}(t)=a \\exp \\left(\\frac{A_{0}-2}{2} \\omega_{0} t\\right) \\cos \\left(\\frac{A_{0} \\sqrt{3}}{2} \\omega_{0} t\\right) \\tag{15.16}\n\\end{equation*}\n$$\n\nThus, if $A_{0}>2$, the exponential envelope grows to infinity.\nIn practice, as the oscillation amplitude increases, the stages in the signal path experience nonlinearity and eventually \"saturation,\" limiting the maximum amplitude. We may say that the poles begin in the right half plane and eventually move to the imaginary axis to stop the growth. If the small-signal loop\nimage_name:0 < A_0 < 2\ndescription:The graph presented is a pole-zero plot for a three-stage ring oscillator, illustrating the position of poles for different values of the gain parameter $A_0$. The graph is divided into three separate plots, each corresponding to a specific range of $A_0$: $0 < A_0 < 2$, $A_0 = 2$, and $A_0 > 2$.\n\n1. **Type of Graph and Function**:\n- This is a pole-zero plot, which is commonly used in control systems and signal processing to represent the poles and zeros of a transfer function in the complex plane.\n\n2. **Axes Labels and Units**:\n- The horizontal axis is labeled with the real part of the complex frequency, denoted as $\\sigma$.\n- The vertical axis is labeled with the imaginary part of the complex frequency, denoted as $j\\omega$.\n- The axes do not specify units explicitly, but they are typically in radians per second for frequency.\n\n3. **Overall Behavior and Trends**:\n- **For $0 < A_0 < 2$**: The poles are located in the left half of the complex plane, indicating a stable system. The poles are positioned at a negative real value, specifically around $-3\\omega_0$.\n- **For $A_0 = 2$**: The poles lie on the imaginary axis at $-3\\omega_0$, suggesting a marginally stable system.\n- **For $A_0 > 2$**: The poles move into the right half of the complex plane, indicating an unstable system where the exponential envelope grows to infinity.\n\n4. **Key Features and Technical Details**:\n- The transition of poles from the left half to the right half of the complex plane as $A_0$ increases past 2 is critical. It signifies the onset of instability in the oscillator.\n- The pole positions are symmetrically distributed about the real axis, which is typical for oscillatory systems.\n\n5. **Annotations and Specific Data Points**:\n- The plot includes markers at $-3\\omega_0$ on the real axis for reference.\n- The poles are marked with crosses, indicating their positions in the complex plane.\n\nThis pole-zero plot effectively illustrates the stability characteristics of the oscillator for different values of the gain parameter, highlighting the critical transition at $A_0 = 2$. The movement of poles from stable to unstable regions as $A_0$ increases is a key feature of this analysis.\nimage_name:A_0 = 2\ndescription:The graph consists of three separate plots, each representing the pole-zero configuration of a three-stage ring oscillator for different values of the gain parameter $A_0$. The plots are drawn on the complex plane with the horizontal axis labeled as $\\sigma$ (real part) and the vertical axis labeled as $j\\omega$ (imaginary part). The key features and behavior of each plot are as follows:\n\n1. **Plot for $0 < A_0 < 2$**:\n- There are three poles depicted as crosses, all located in the left half of the complex plane.\n- The poles are positioned such that their real parts are negative, indicating a stable system.\n- The horizontal axis is marked at $-3\\omega_0$, suggesting a reference point for the real parts of the poles.\n\n2. **Plot for $A_0 = 2$**:\n- The poles are located exactly on the imaginary axis, indicating marginal stability"
},
{
    "text": "A ring oscillator is constructed from a series of gain stages connected in a loop. To create a practical implementation, we start by trying to make a single-stage feedback circuit oscillate.\n\nExample 15.1\nWhy doesn't a single common-source stage oscillate when placed in a unity-gain loop?\n\n#### Solution\n\nReferring to Fig. 15.4, it's evident that the open-loop circuit has only one pole, resulting in a maximum frequency-dependent phase shift of $90^{\\circ}$ (at a frequency of infinity). Given that the common-source stage introduces a dc phase shift of $180^{\\circ}$ due to signal inversion from gate to drain, the total phase shift is $270^{\\circ}$. Consequently, the loop cannot sustain oscillation growth.\n\nFigure 15.4\n\nThe above example suggests that oscillation might occur if the circuit has multiple stages and hence multiple poles. Indeed, such a topology was considered undesirable in Chapter 10 because it led to inadequate phase margin in op amps. Therefore, we can infer that if the circuit in Fig. 15.4 is modified as shown in Fig. 15.5, then two significant poles appear in the signal path, allowing the frequency-dependent phase shift to approach $180^{\\circ}$. Unfortunately, this circuit exhibits positive feedback near zero frequency due to the signal inversion through each common-source stage. As a result, it simply \"latches up\" rather than oscillates. That is, if $V_{E}$ rises, $V_{F}$ falls, thereby turning $M_{1}$ off and allowing $V_{E}$ to rise further. This may continue until $V_{E}$ reaches $V_{D D}$ and $V_{F}$ drops to near zero, a state that will remain indefinitely.\n\nTo gain more insight into the oscillation conditions, let's assume that an ideal inverting stage (with zero phase shift at all frequencies) is inserted in the loop of Fig. 15.5, providing negative feedback near zero frequency and eliminating the problem of latch-up (Fig. 15.6). Does this circuit oscillate? We note that the loop contains only two poles: one at $E$ and another at $F$. The frequency-dependent phase shift can therefore reach $180^{\\circ}$, but at a frequency of infinity. Since the loop gain vanishes at very high frequencies, we observe that the circuit does not satisfy both of Barkhausen's criteria at the same frequency (Fig. 15.7), and thus fails to oscillate.\n\nFigure 15.6\n\nFigure 15.7 Loop gain characteristics of a two-pole system\n\nThe foregoing discussion points to the need for greater phase shift around the loop, suggesting the possibility of oscillation if the third inverting stage in Fig. 15.6 contains a pole that contributes significant phase. We then arrive at the topology depicted in Fig. 15.8. If the three stages are identical, the total phase shift around the loop, $\\phi$, reaches $-135^{\\circ}$ at $\\omega=\\omega_{p, E}\\left(=\\omega_{p, F}=\\omega_{p, G}\\right)$ and $-270^{\\circ}$ at $\\omega=\\infty$. Consequently, $\\phi$ equals $-180^{\\circ}$ at $\\omega<\\infty$, where the loop gain can still be greater than or equal to unity. This circuit indeed oscillates if the loop gain is sufficient and it is an example of a ring oscillator.\n\nIt is instructive to calculate the minimum voltage gain per stage in Fig. 15.8 that is necessary for oscillation. Neglecting the effect of the gate-drain overlap capacitance and denoting the transfer function of each stage by $-A_{0} /\\left(1+s / \\omega_{0}\\right)$, we have for the loop gain\n\n$$\n\\begin{equation*}\nH(s)=-\\frac{A_{0}^{3}}{\\left(1+\\frac{s}{\\omega_{0}}\\right)^{3}} \\tag{15.6}\n\\end{equation*}\n$$\n\nFigure 15.8 Three-stage ring oscillator\n\nThe circuit oscillates only if the frequency-dependent phase shift equals $180^{\\circ}$, i.e., if each stage contributes $60^{\\circ}$. The frequency at which this occurs is given by\n\n$$\n\\begin{equation*}\n\\tan ^{-1} \\frac{\\omega_{\\text {osc }}}{\\omega_{0}}=60^{\\circ} \\tag{15.7}\n\\end{equation*}\n$$\n\nand hence\n\n$$\n\\begin{equation*}\n\\omega_{o s c}=\\sqrt{3} \\omega_{0} \\tag{15.8}\n\\end{equation*}\n$$\n\nThe minimum voltage gain per stage must be such that the magnitude of the loop gain at $\\omega_{o s c}$ is equal to unity:\n\n$$\n\\begin{equation*}\n\\frac{A_{0}^{3}}{\\left[\\sqrt{1+\\left(\\frac{\\omega_{\\text {osc }}}{\\omega_{0}}\\right)^{2}}\\right]^{3}}=1 \\tag{15.9}\n\\end{equation*}\n$$\n\nIt follows from (15.8) and (15.9) that\n\n$$\n\\begin{equation*}\nA_{0}=2 \\tag{15.10}\n\\end{equation*}\n$$\n\nIn summary, a three-stage ring oscillator requires a low-frequency gain of 2 per stage, and it oscillates at a frequency of $\\sqrt{3} \\omega_{0}$, where $\\omega_{0}$ is the $3-\\mathrm{dB}$ bandwidth of each stage.\n\nLet us now examine the waveforms at the three nodes of the oscillator of Fig. 15.8. Since each stage contributes a frequency-dependent phase shift of $60^{\\circ}$ as well as a low-frequency signal inversion, the waveform at each node is $240^{\\circ}$ (or $120^{\\circ}$ ) out of phase with respect to its neighboring nodes (Fig. 15.9). The ability to generate multiple phases is a very useful property of ring oscillators.\n\nFigure 15.9 Waveforms of a three-stage ring oscillator\n\nFigure 15.10 Linear model of three-stage ring oscillator\n\nAmplitude Limiting The natural question at this point is-What happens if in the three-stage ring of Fig. 15.8, $A_{0} \\neq 2$ ? We know from Barkhausen's criteria that if $A_{0}<2$, the circuit fails to oscillate, but what if $A_{0}>2$ ? To answer this question, we first model the oscillator by a linear feedback system, as depicted in Fig. 15.10. Note that the feedback is positive (i.e., $V_{\\text {out }}$ is added to $V_{i n}$ ) because $H(s)$ in Eq. (15.6) already includes the negative polarity resulting from three inversions in the signal path. The closed-loop transfer function is\n\n$$\n\\begin{align*}\n\\frac{V_{\\text {out }}(s)}{V_{\\text {in }}(s)} & =\\frac{\\frac{-A_{0}^{3}}{\\left(1+s / \\omega_{0}\\right)^{3}}}{1+\\frac{A_{0}^{3}}{\\left(1+s / \\omega_{0}\\right)^{3}}}  \\tag{15.11}\\\\\n& =\\frac{-A_{0}^{3}}{\\left(1+s / \\omega_{0}\\right)^{3}+A_{0}^{3}} \\tag{15.12}\n\\end{align*}\n$$\n\nThe denominator of (15.12) can be expanded as\n\n$$\n\\begin{equation*}\n\\left(1+\\frac{s}{\\omega_{0}}\\right)^{3}+A_{0}^{3}=\\left(1+\\frac{s}{\\omega_{0}}+A_{0}\\right)\\left[\\left(1+\\frac{s}{\\omega_{0}}\\right)^{2}-\\left(1+\\frac{s}{\\omega_{0}}\\right) A_{0}+A_{0}^{2}\\right] \\tag{15.13}\n\\end{equation*}\n$$\n\nThus, the closed-loop system exhibits three poles:\n\n$$\n\\begin{align*}\ns_{1} & =\\left(-A_{0}-1\\right) \\omega_{0}  \\tag{15.14}\\\\\ns_{2,3} & =\\left[\\frac{A_{0}(1 \\pm j \\sqrt{3})}{2}-1\\right] \\omega_{0} \\tag{15.15}\n\\end{align*}\n$$\n\nSince $A_{0}$ itself is positive, the first pole leads to a decaying exponential term: $\\exp \\left[\\left(-A_{0}-1\\right) \\omega_{0} t\\right]$, which can be neglected in the steady state. Figure 15.11 illustrates the locations of the poles for different values of $A_{0}$, revealing that for $A_{0}>2$, the two complex poles exhibit a positive real part and hence give rise to a growing sinusoid. Neglecting the effect of $s_{1}$, we express the output waveform as\n\n$$\n\\begin{equation*}\nV_{\\text {out }}(t)=a \\exp \\left(\\frac{A_{0}-2}{2} \\omega_{0} t\\right) \\cos \\left(\\frac{A_{0} \\sqrt{3}}{2} \\omega_{0} t\\right) \\tag{15.16}\n\\end{equation*}\n$$\n\nThus, if $A_{0}>2$, the exponential envelope grows to infinity.\nIn practice, as the oscillation amplitude increases, the stages in the signal path experience nonlinearity and eventually \"saturation,\" limiting the maximum amplitude. We may say that the poles begin in the right half plane and eventually move to the imaginary axis to stop the growth. If the small-signal loop gain is greater than unity, the circuit must spend enough time in saturation so that the \"average\" loop gain is still equal to unity. ${ }^{3}$\n\n#### Example 15.2\n\nShown in Fig. 15.12 is a differential implementation of the oscillator of Fig. 15.8. What is the maximum voltage swing of each stage?\n\n#### Solution\n\nIf the gain per stage is well above 2, then the amplitude grows until each differential pair experiences complete switching, that is, until $I_{S S}$ is completely steered to one side every half cycle. As a result, the swing at each node is equal to $I_{S S} R_{1}$. From the waveforms shown in Fig. 15.12, we also observe that each stage is in its high-gain region for only a fraction of the period, (e.g., when $\\left|V_{X}-V_{Y}\\right|$ is small).\n\nimage_name:Figure 15.13\ndescription:This is a ring oscillator circuit using three CMOS inverters. The nodes X, Y, and Z represent the outputs of each inverter stage, showing oscillating waveforms over time.\n\nFigure 15.13 Ring oscillator using CMOS inverters.\n\nA simple implementation of ring oscillators that does not require resistors is depicted in Fig. 15.13. Suppose the circuit is released with an initial voltage at each node equal to the trip point of the inverters, $V_{\\text {trip }} .{ }^{4}$ With identical stages and no noise in the devices, the circuit would remain in this state indefinitely, ${ }^{5}$ but noise components disturb each node voltage, yielding a growing waveform. The signal eventually exhibits rail-to-rail swings.\n\nimage_name:Figure 15.14\ndescription:Figure 15.14 depicts the time-domain waveforms of a ring oscillator circuit with three nodes labeled as $V_X$, $V_Y$, and $V_Z$. The x-axis represents time ($t$), and the y-axis represents voltage levels, specifically between 0 and $V_{DD}$, with no specific units or scale markers shown.\n\nFigure 15.14 Waveforms of ring oscillator when one node is initialized at $V_{D D}$.\n\nLet us now assume that the circuit of Fig. 15.13 begins with $V_{X}=V_{D D}$ (Fig. 15.14). Under this condition, $V_{Y}=0$ and $V_{Z}=V_{D D}$. Thus, when the circuit is released, $V_{X}$ begins to fall to zero (because the first inverter senses a high input), forcing $V_{Y}$ to rise to $V_{D D}$ after one inverter delay, $T_{D}$, and $V_{Z}$ to fall to zero after another inverter delay. The circuit therefore oscillates with a delay of $T_{D}$ between consecutive node voltages, yielding a period of $6 T_{D}$.\n\nThe above small-signal and large-signal analyses raise an interesting question. While the small-signal oscillation frequency is given by $A_{0} \\sqrt{3} \\omega_{0} / 2$ [from Eq. (15.16)], the large-signal value is $1 /\\left(6 T_{D}\\right)$. Are these two values equal? Not necessarily. After all, $\\omega_{0}$ is determined by the small-signal output resistance and capacitance of each inverter near the trip point, whereas $T_{D}$ results from the large-signal, nonlinear current drive and capacitances of each stage. In other words, when the circuit is released with all inverters at their trip point, the oscillation begins with a frequency of $\\sqrt{3} A_{0} \\omega_{0} / 2$, but, as the amplitude grows and the circuit becomes nonlinear, the frequency shifts to $1 /\\left(6 T_{D}\\right)$ (which is a lower value).\n\nRing oscillators employing more than three stages are also feasible. The total number of inversions in the loop must be odd so that the circuit does not latch up. For example, as shown in Fig. 15.15(a), a ring can incorporate five inverters, providing a frequency of $1 /\\left(10 T_{D}\\right)$. On the other hand, the differential implementation can utilize an even number of stages by simply configuring one stage such that it does not invert. Illustrated in Fig. 15.15(b), this flexibility demonstrates another advantage of differential circuits over their single-ended counterparts.\n\n#### Example 15.3\n\nWhat is the minimum required voltage gain per stage in the four-stage oscillator of Fig. 15.15(b)? How many signal phases are provided by the circuit?\n\n#### Solution\n\nUsing a notation similar to that for Fig. 15.8, we have\n\n$$\n\\begin{equation*}\nH(s)=-\\frac{A_{0}^{4}}{\\left(1+\\frac{s}{\\omega_{0}}\\right)^{4}} \\tag{15.17}\n\\end{equation*}\n$$\n\nFor the circuit to oscillate, each stage must contribute a frequency-dependent phase shift of $180^{\\circ} / 4=45^{\\circ}$. The frequency at which this occurs is given by $\\tan ^{-1} \\omega_{\\text {osc }} / \\omega_{0}=45^{\\circ}$ and hence $\\omega_{\\text {osc }}=\\omega_{0}$. The minimum voltage gain is therefore derived as\n\n$$\n\\begin{equation*}\n\\frac{A_{0}}{\\sqrt{1+\\left(\\frac{\\omega_{o s c}}{\\omega_{0}}\\right)^{2}}}=1 \\tag{15.18}\n\\end{equation*}\n$$\n\nThat is, $A_{0}=\\sqrt{2}$. As expected, this value is lower than that required in a three-stage ring.\nWith $45^{\\circ}$ of phase shift per stage, the oscillator provides four phases and their complements. This is illustrated in Fig. 15.16.\n\nFigure 15.16\n\nThe number of stages in a ring oscillator is determined by various requirements, including speed, power dissipation, noise immunity, etc. In most applications, three to five stages provide optimum performance (for differential implementations).\n#### Example 15.4\n\nDetermine the maximum voltage swings and the minimum supply voltage of a ring oscillator incorporating differential pairs with resistive loads (e.g., as in Fig. 15.12) if no transistor must enter the triode region. Assume that each stage experiences complete switching.\n\n#### Solution\n\nFigure 15.17(a) shows two stages in cascade. If each stage experiences complete switching, then each drain voltage, e.g., $V_{X}$ or $V_{Y}$, varies between $V_{D D}$ and $V_{D D}-I_{S S} R_{P}$. Thus, when $M_{1}$ is fully on, its gate and drain voltages are equal to $V_{D D}$ and $V_{D D}-I_{S S} R_{P}$, respectively. For this transistor to remain in saturation, we have $I_{S S} R_{P} \\leq V_{T H}$, i.e., the peak-to-peak swing at each drain must not exceed $V_{T H}$.\n\nimage_name:(a)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: P, D: d1, G: Y}\nname: M2, type: NMOS, ports: {S: P, D: d2, G: X}\nname: M3, type: NMOS, ports: {S: P1, D: X, G: Vip}\nname: M4, type: NMOS, ports: {S: P1, D: Y, G: Vin}\nname: M5, type: NMOS, ports: {S: GND, D: P1, G: Vb}\nname: M6, type: NMOS, ports: {S: GND, D: P, G: Vb}\nname: RP, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: RP, type: Resistor, value: RP, ports: {N1: VDD, N2: d1}\nname: RP, type: Resistor, value: RP, ports: {N1: VDD, N2: d2}\n]\nextrainfo:The circuit in Figure 15.17(a) is a differential amplifier with NMOS transistors M1 to M6 and load resistors RP. The circuit is biased with a current ISS and uses a voltage Vb for biasing the gates of M5"
},
{
    "text": "A ring oscillator is constructed by connecting several gain stages in a loop. To understand its practical realization, we start by attempting to make a single-stage feedback circuit oscillate.\n\nExample 15.1\nDiscuss why a single common-source stage does not oscillate when placed in a unity-gain loop.\n\n#### Solution\n\nReferring to Fig. 15.4, we observe that the open-loop circuit has only one pole, resulting in a maximum frequency-dependent phase shift of $90^{\\circ}$ (at a frequency of infinity). Given that the common-source stage introduces a dc phase shift of $180^{\\circ}$ due to signal inversion from the gate to the drain, the total phase shift is $270^{\\circ}$. Consequently, the loop is unable to sustain oscillation growth.\nFigure 15.4\n\nThis example suggests that oscillation may occur if the circuit contains multiple stages, introducing multiple poles. However, such a topology was considered undesirable in Chapter 10 due to the inadequate phase margin in op amps. Therefore, we hypothesize that modifying the circuit of Fig. 15.4 as shown in Fig. 15.5 would result in two significant poles in the signal path, allowing the frequency-dependent phase shift to approach $180^{\\circ}$. Unfortunately, this circuit exhibits positive feedback near zero frequency due to the signal inversion through each common-source stage. As a result, it \"latches up\" instead of oscillating. That is, if $V_{E}$ rises, $V_{F}$ falls, turning off $M_{1}$ and allowing $V_{E}$ to rise further. This process may continue until $V_{E}$ reaches $V_{D D}$ and $V_{F}$ drops to near zero, a state that will persist indefinitely.\n\nTo gain a deeper understanding of the oscillation conditions, let us assume that an ideal inverting stage (with zero phase shift at all frequencies) is inserted in the loop of Fig. 15.5, providing negative feedback near zero frequency and eliminating the problem of latch-up (Fig. 15.6). Does this circuit oscillate? We note that the loop contains only two poles: one at $E$ and another at $F$. The frequency-dependent phase shift can therefore reach $180^{\\circ}$, but only at a frequency of infinity. Since the loop gain vanishes at very high frequencies, we observe that the circuit does not satisfy both of Barkhausen's criteria at the same frequency (Fig. 15.7), and thus fails to oscillate.\nFigure 15.6\n\nFigure 15.7\n\nThis discussion highlights the need for a greater phase shift around the loop, suggesting the possibility of oscillation if the third inverting stage in Fig. 15.6 contains a pole that contributes significant phase. We then arrive at the topology depicted in Fig. 15.8. If the three stages are identical, the total phase shift around the loop, $\\phi$, reaches $-135^{\\circ}$ at $\\omega=\\omega_{p, E}\\left(=\\omega_{p, F}=\\omega_{p, G}\\right)$ and $-270^{\\circ}$ at $\\omega=\\infty$. Consequently, $\\phi$ equals $-180^{\\circ}$ at $\\omega<\\infty$, where the loop gain can still be greater than or equal to unity. This circuit indeed oscillates if the loop gain is sufficient and it is an example of a ring oscillator.\n\nTo calculate the minimum voltage gain per stage in Fig. 15.8 that is necessary for oscillation, neglecting the effect of the gate-drain overlap capacitance and denoting the transfer function of each stage by $-A_{0} /\\left(1+s / \\omega_{0}\\right)$, we have for the loop gain\n\n$$\n\\begin{equation*}\nH(s)=-\\frac{A_{0}^{3}}{\\left(1+\\frac{s}{\\omega_{0}}\\right)^{3}} \\tag{15.6}\n\\end{equation*}\n$$\n\nFigure 15.8\n\nThe circuit oscillates only if the frequency-dependent phase shift equals $180^{\\circ}$, i.e., if each stage contributes $60^{\\circ}$. The frequency at which this occurs is given by\n\n$$\n\\begin{equation*}\n\\tan ^{-1} \\frac{\\omega_{\\text {osc }}}{\\omega_{0}}=60^{\\circ} \\tag{15.7}\n\\end{equation*}\n$$\n\nand hence\n\n$$\n\\begin{equation*}\n\\omega_{o s c}=\\sqrt{3} \\omega_{0} \\tag{15.8}\n\\end{equation*}\n$$\n\nThe minimum voltage gain per stage must be such that the magnitude of the loop gain at $\\omega_{o s c}$ is equal to unity:\n\n$$\n\\begin{equation*}\n\\frac{A_{0}^{3}}{\\left[\\sqrt{1+\\left(\\frac{\\omega_{\\text {osc }}}{\\omega_{0}}\\right)^{2}}\\right]^{3}}=1 \\tag{15.9}\n\\end{equation*}\n$$\n\nIt follows from (15.8) and (15.9) that\n\n$$\n\\begin{equation*}\nA_{0}=2 \\tag{15.10}\n\\end{equation*}\n$$\n\nIn summary, a three-stage ring oscillator requires a low-frequency gain of 2 per stage, and it oscillates at a frequency of $\\sqrt{3} \\omega_{0}$, where $\\omega_{0}$ is the $3-\\mathrm{dB}$ bandwidth of each stage.\n\nNow, let us examine the waveforms at the three nodes of the oscillator of Fig. 15.8. Since each stage contributes a frequency-dependent phase shift of $60^{\\circ}$ as well as a low-frequency signal inversion, the waveform at each node is $240^{\\circ}$ (or $120^{\\circ}$ ) out of phase with respect to its neighboring nodes (Fig. 15.9). The ability to generate multiple phases is a very useful property of ring oscillators.\nFigure 15.9\n\nFigure 15.10\n\nAmplitude Limiting The natural question at this point is-What happens if in the three-stage ring of Fig. 15.8, $A_{0} \\neq 2$ ? We know from Barkhausen's criteria that if $A_{0}<2$, the circuit fails to oscillate, but what if $A_{0}>2$ ? To answer this question, we first model the oscillator by a linear feedback system, as depicted in Fig. 15.10. Note that the feedback is positive (i.e., $V_{\\text {out }}$ is added to $V_{i n}$ ) because $H(s)$ in Eq. (15.6) already includes the negative polarity resulting from three inversions in the signal path. The closed-loop transfer function is\n\n$$\n\\begin{align*}\n\\frac{V_{\\text {out }}(s)}{V_{\\text {in }}(s)} & =\\frac{\\frac{-A_{0}^{3}}{\\left(1+s / \\omega_{0}\\right)^{3}}}{1+\\frac{A_{0}^{3}}{\\left(1+s / \\omega_{0}\\right)^{3}}}  \\tag{15.11}\\\\\n& =\\frac{-A_{0}^{3}}{\\left(1+s / \\omega_{0}\\right)^{3}+A_{0}^{3}} \\tag{15.12}\n\\end{align*}\n$$\n\nThe denominator of (15.12) can be expanded as\n\n$$\n\\begin{equation*}\n\\left(1+\\frac{s}{\\omega_{0}}\\right)^{3}+A_{0}^{3}=\\left(1+\\frac{s}{\\omega_{0}}+A_{0}\\right)\\left[\\left(1+\\frac{s}{\\omega_{0}}\\right)^{2}-\\left(1+\\frac{s}{\\omega_{0}}\\right) A_{0}+A_{0}^{2}\\right] \\tag{15.13}\n\\end{equation*}\n$$\n\nThus, the closed-loop system exhibits three poles:\n\n$$\n\\begin{align*}\ns_{1} & =\\left(-A_{0}-1\\right) \\omega_{0}  \\tag{15.14}\\\\\ns_{2,3} & =\\left[\\frac{A_{0}(1 \\pm j \\sqrt{3})}{2}-1\\right] \\omega_{0} \\tag{15.15}\n\\end{align*}\n$$\n\nSince $A_{0}$ itself is positive, the first pole leads to a decaying exponential term: $\\exp \\left[\\left(-A_{0}-1\\right) \\omega_{0} t\\right]$, which can be neglected in the steady state. Figure 15.11 illustrates the locations of the poles for different values of $A_{0}$, revealing that for $A_{0}>2$, the two complex poles exhibit a positive real part and hence give rise to a growing sinusoid. Neglecting the effect of $s_{1}$, we express the output waveform as\n\n$$\n\\begin{equation*}\nV_{\\text {out }}(t)=a \\exp \\left(\\frac{A_{0}-2}{2} \\omega_{0} t\\right) \\cos \\left(\\frac{A_{0} \\sqrt{3}}{2} \\omega_{0} t\\right) \\tag{15.16}\n\\end{equation*}\n$$\n\nThus, if $A_{0}>2$, the exponential envelope grows to infinity.\nIn practice, as the oscillation amplitude increases, the stages in the signal path experience nonlinearity and eventually \"saturation,\" limiting the maximum amplitude. We may say that the poles begin in the right half plane and eventually move to the imaginary axis to stop the growth. If the small-signal loop\nimage_name:0 < A_0 < 2\ndescription:The graph presented is a pole-zero plot for a three-stage ring oscillator, illustrating the position of poles for different values of the gain parameter $A_0$. The graph is divided into three separate plots, each corresponding to a specific range of $A_0$: $0 < A_0 < 2$, $A_0 = 2$, and $A_0 > 2$.\n\n1. **Type of Graph and Function:**\n- This is a pole-zero plot, which is commonly used in control systems and signal processing to represent the poles and zeros of a transfer function in the complex plane.\n\n2. **Axes Labels and Units:**\n- The horizontal axis is labeled with the real part of the complex frequency, denoted as $\\sigma$.\n- The vertical axis is labeled with the imaginary part of the complex frequency, denoted as $j\\omega$.\n- The axes do not specify units explicitly, but they are typically in radians per second for frequency.\n\n3. **Overall Behavior and Trends:**\n- **For $0 < A_0 < 2$:** The poles are located in the left half of the complex plane, indicating a stable system. The poles are positioned at a negative real value, specifically around $-3\\omega_0$.\n- **For $A_0 = 2$:** The poles lie on the imaginary axis at $-3\\omega_0$, suggesting a marginally stable system.\n- **For $A_0 > 2$:** The poles move into the right half of the complex plane, indicating an unstable system where the exponential envelope grows to infinity.\n\n4. **Key Features and Technical Details:**\n- The transition of poles from the left half to the right half of the complex plane as $A_0$ increases past 2 is critical. It signifies the onset of instability in the oscillator.\n- The pole positions are symmetrically distributed about the real axis, which is typical for oscillatory systems.\n\n5. **Annotations and Specific Data Points:**\n- The plot includes markers at $-3\\omega_0$ on the real axis for reference.\n- The poles are marked with crosses, indicating their positions in the complex plane.\n\nThis pole-zero plot effectively illustrates the stability characteristics of the oscillator for different values of the gain parameter, highlighting the critical transition at $A_0 = 2$. The movement of poles from stable to unstable regions as $A_0$ increases is a key feature of this analysis.\nimage_name:A_0 = 2\ndescription:The graph consists of three separate plots, each representing the pole-zero configuration of a three-stage ring oscillator for different values of the gain parameter $A_0$. The plots are drawn on the complex plane with the horizontal axis labeled as $\\sigma$ (real part) and the vertical axis labeled as $j\\omega$ (imaginary part). The key features and behavior of each plot are as follows:\n\n1. **Plot for $0 < A_0 < 2$:**\n- There are three poles depicted as crosses, all located in the left half of the complex plane.\n- The poles are positioned such that their real parts are negative, indicating a stable system.\n- The horizontal axis is marked at $-3\\omega_0$, suggesting a reference point for the real parts of the poles.\n\n2. **Plot for $A_0 = 2$:**\n- The poles are located exactly on the imaginary axis, indicating marginal stability. This suggests that the system is at the brink of oscillation.\n- This configuration suggests that the system is at the brink of oscillation.\n- The poles are positioned symmetrically along the imaginary axis, with no real part.\n\n3. **Plot for $A_0 > 2$:**\n- The poles have shifted into the right half of the complex plane, indicating an unstable system.\n- The presence of poles with positive real parts suggests that the system will exhibit growing oscillations.\n- This configuration is consistent with the context stating that an exponential envelope grows to infinity when $A_0 > 2$.\n\nOverall, the graph illustrates how the pole positions move from a stable configuration to an unstable one as the gain $A_0$ increases, highlighting the transition from stability to oscillation and then to instability in the ring oscillator system.\nimage_name:A_0 > 2\ndescription:The graph is a pole-zero plot for a three-stage ring oscillator depicted in three different scenarios based on the parameter \\( A_0 \\). Each scenario is represented on a separate plot, showing the movement of poles as \\( A_0 \\) changes.\n\nType of Graph:\n- This is a pole-zero plot, commonly used in control systems and signal processing to analyze the stability and behavior of systems.\n\nAxes Labels and Units:\n- The horizontal axis represents the real part of the complex frequency, denoted as \\( \\sigma \\).\n- The vertical axis represents the imaginary part of the complex frequency, denoted as \\( j\\omega \\).\n- Units are typically in radians per second, although not explicitly labeled.\n\nOverall Behavior and Trends:\n- **For \\( 0 < A_0 < 2 \\):**\n- The poles are located in the left half of the complex plane, indicating a stable system. The poles are positioned at approximately \\( -3\\omega_0 \\) on the real axis and have imaginary components, suggesting oscillatory behavior with damping.\n- **For \\( A_0 = 2 \\):**\n- The poles lie on the imaginary axis, indicating marginal stability. This suggests that the system is at the brink of oscillation without decay or growth.\n- **For \\( A_0 > 2 \\):**\n- The poles move to the right half of the complex plane, indicating an unstable system. This suggests that the oscillations will grow without bound unless saturation or non-linear effects intervene.\n\nKey Features and Technical Details:\n- The poles' movement from the left to the right half-plane as \\( A_0 \\) increases demonstrates the transition from stability to instability.\n- The critical value \\( A_0 = 2 \\) serves as a threshold where the system transitions from stable to marginally stable.\n- The position \\( -3\\omega_0 \\) on the real axis is a reference point for the poles in the stable and marginally stable scenarios.\n\nAnnotations and Specific Data Points:\n- The plots are annotated with the conditions \\( 0 < A_0 < 2 \\), \\( A_0 = 2 \\), and \\( A_0 > 2 \\) to indicate the different scenarios.\n- The point \\( -3\\omega_0 \\) is marked on the real axis as a reference for the pole locations in each scenario.\n\nFigure 15.11 Poles of three-stage ring oscillator for various values of gain.\ngain is greater than unity, the circuit must spend enough time in saturation so that the \"average\" loop gain is still equal to unity. ${ }^{3}$\n\n#### Example 15.2\n\nShown in Fig. 15.12 is a differential implementation of the oscillator of Fig. 15.8. What is the maximum voltage swing of each stage?\nimage_name:Figure 15.12\ndescription:\n[\nname: R1, type: Resistor, value: R1, ports: {N1: VDD, N2: X}\nname: R1, type: Resistor, value: R1, ports: {N1: VDD, N2: Y}\nname: R1, type: Resistor, value: R1, ports: {N1: VDD, N2: X1}\nname: R1, type: Resistor, value: R1, ports: {N1: VDD, N2: Y1}\nname: R1, type: Resistor, value: R1, ports: {N1: VDD, N2: X2}\nname: R1, type: Resistor, value: R1, ports: {N1: VDD, N2: Y2}\nname: M1, type: NMOS, ports: {S: P12, D: X, G: X2}\nname: M2, type: NMOS, ports: {S: P12, D: Y, G: Y2}\nname: M3, type: NMOS, ports: {S: P34, D: X1, G: Y}\nname: M4, type: NMOS, ports: {S: P34, D: Y1, G: X}\nname: M5, type: NMOS, ports: {S: P56, D: X2, G: Y1}\nname: M6, type: NMOS, ports: {S: P56, D: Y2, G: X1}\nname: Iss, type: CurrentSource, ports: {Np: P12, Nn: GND}\nname: Iss, type: CurrentSource, ports: {Np: P34, Nn: GND}\nname: Iss, type: CurrentSource, ports: {Np: P56, Nn: GND}\n]\nextrainfo:The circuit is a differential three-stage ring oscillator with each stage consisting of a differential pair of NMOS transistors and resistors connected to VDD. The current sources Iss provide biasing for each stage"
},
{
    "text": "A ring oscillator is constructed from a series of gain stages connected in a loop. To implement the oscillator, we start by attempting to make a single-stage feedback circuit oscillate.\n\nExample 15.1\nExplain why a single common-source stage does not oscillate when placed in a unity-gain loop.\n\n#### Solution\n\nFrom Fig. 15.4, we can see that the open-loop circuit has only one pole, resulting in a maximum frequency-dependent phase shift of $90^{\\circ}$ (at a frequency of infinity). Since the common-source stage introduces a dc phase shift of $180^{\\circ}$ due to signal inversion from the gate to the drain, the total phase shift is $270^{\\circ}$. Thus, the loop cannot sustain oscillation growth.\n\nThe circuit in Fig. 15.4 is a common-source amplifier with a resistive and capacitive load, using an NMOS transistor. The output is taken across the capacitor CL.\n\nFigure 15.4\n\nThis example suggests that oscillation may occur if the circuit contains multiple stages and hence multiple poles. Indeed, such a topology was considered undesirable in Chapter 10 because it led to inadequate phase margin in op amps. We therefore infer that if the circuit of Fig. 15.4 is modified as shown in Fig. 15.5, then two significant poles appear in the signal path, allowing the frequency-dependent\nimage_name:Figure 15.5\ndescription:\n[\nname: M1, type: NMOS, ports: {S: GND, D: E, G: Vout}\nname: M2, type: NMOS, ports: {S: GND, D: F(Vout), G: E}\nname: RD1, type: Resistor, value: RD, ports: {N1: VDD, N2: E}\nname: RD2, type: Resistor, value: RD, ports: {N1: VDD, N2: F}\nname: CL1, type: Capacitor, value: CL, ports: {Np: E, Nn: GND}\nname: CL2, type: Capacitor, value: CL, ports: {Np: F, Nn: GND}\n]\nextrainfo:The circuit is a two-stage feedback system with two NMOS transistors, two resistors, and two capacitors. It is prone to latch-up due to positive feedback near zero frequency.\n\nFigure 15.5 Two-pole feedback system.\nphase shift to approach $180^{\\circ}$. Unfortunately, this circuit exhibits positive feedback near zero frequency due to the signal inversion through each common-source stage. As a result, it simply \"latches up\" rather than oscillates. That is, if $V_{E}$ rises, $V_{F}$ falls, thereby turning $M_{1}$ off and allowing $V_{E}$ to rise further. This may continue until $V_{E}$ reaches $V_{D D}$ and $V_{F}$ drops to near zero, a state that will remain indefinitely.\n\nTo gain more insight into the oscillation conditions, let us assume that an ideal inverting stage (with zero phase shift at all frequencies) is inserted in the loop of Fig. 15.5, providing negative feedback near zero frequency and eliminating the problem of latch-up (Fig. 15.6). Does this circuit oscillate? We note that the loop contains only two poles: one at $E$ and another at $F$. The frequency-dependent phase shift can therefore reach $180^{\\circ}$, but at a frequency of infinity. Since the loop gain vanishes at very high frequencies, we observe that the circuit does not satisfy both of Barkhausen's criteria at the same frequency (Fig. 15.7), and thus fails to oscillate.\nimage_name:Figure 15.6\ndescription:\n[\nname: M1, type: NMOS, ports: {S: GND, D: E, G: Vout}\nname: M2, type: NMOS, ports: {S: GND, D: F, G: E}\nname: RD, type: Resistor, value: RD, ports: {N1: VDD, N2: E}\nname: RD, type: Resistor, value: RD, ports: {N1: VDD, N2: F}\nname: CL, type: Capacitor, value: CL, ports: {Np: E, Nn: GND}\nname: CL, type: Capacitor, value: CL, ports: {Np: F, Nn: GND}\nname: VDD, type: VoltageSource, value: VDD, ports: {Np: VDD, Nn: GND}\nname: Ideal, type: OpAmp, value: -1, ports: {InP: F, InN: GND, Out: Vout}\n]\nextrainfo:The circuit is a two-pole feedback system with an additional signal inversion using an ideal op-amp. It includes two NMOS transistors (M1 and M2) with capacitive loads CL and resistive loads RD. The circuit does not oscillate as it does not meet Barkhausen's criteria at the same frequency.\n\nFigure 15.6 Two-pole feedback system with additional signal inversion.\nimage_name:Figure 15.7 Loop gain characteristics of a two-pole system\ndescription:The graph titled \"Figure 15.7 Loop gain characteristics of a two-pole system\" is a Bode plot comprising two subplots: one for magnitude and one for phase, both plotted against frequency on a logarithmic scale.\n\n1. **Magnitude Plot**:\n- **Y-Axis (Vertical)**: Represents 20log|H(ω)|, which is the magnitude of the loop gain in decibels (dB).\n- **X-Axis (Horizontal)**: Represents frequency (ω) on a logarithmic scale.\n- **Behavior**: The magnitude remains constant at 0 dB up to a certain frequency, denoted as ωp,E = ωp,F. Beyond this point, the magnitude decreases linearly at a rate of -40 dB per decade. This indicates the presence of two poles contributing to the roll-off.\n\n2. **Phase Plot**:\n- **Y-Axis (Vertical)**: Represents the phase of the loop gain, /H(ω), in degrees.\n- **X-Axis (Horizontal)**: Also represents frequency (ω) on a logarithmic scale.\n- **Behavior**: The phase starts at 0 degrees and decreases, passing through -90 degrees and approaching -180 degrees as frequency increases. This suggests a cumulative phase shift introduced by the poles in the system.\n\n3. **Key Features**:\n- The dashed vertical line at ωp,E = ωp,F marks the pole frequency where the behavior of the magnitude plot changes.\n- The magnitude plot's slope of -40 dB/decade is characteristic of a two-pole system.\n- The phase plot's progression towards -180 degrees highlights the potential for instability if additional phase shift occurs, as discussed in the context of the two-pole feedback system with signal inversion.\n\nFigure 15.7 Loop gain characteristics of a two-pole system.\nThe foregoing discussion points to the need for greater phase shift around the loop, suggesting the possibility of oscillation if the third inverting stage in Fig. 15.6 contains a pole that contributes significant phase. We then arrive at the topology depicted in Fig. 15.8. If the three stages are identical, the total phase shift around the loop, $\\phi$, reaches $-135^{\\circ}$ at $\\omega=\\omega_{p, E}\\left(=\\omega_{p, F}=\\omega_{p, G}\\right)$ and $-270^{\\circ}$ at $\\omega=\\infty$. Consequently, $\\phi$ equals $-180^{\\circ}$ at $\\omega<\\infty$, where the loop gain can still be greater than or equal to unity. This circuit indeed oscillates if the loop gain is sufficient and it is an example of a ring oscillator.\n\nIt is instructive to calculate the minimum voltage gain per stage in Fig. 15.8 that is necessary for oscillation. Neglecting the effect of the gate-drain overlap capacitance and denoting the transfer function of each stage by $-A_{0} /\\left(1+s / \\omega_{0}\\right)$, we have for the loop gain\n\n$$\n\\begin{equation*}\nH(s)=-\\frac{A_{0}^{3}}{\\left(1+\\frac{s}{\\omega_{0}}\\right)^{3}} \\tag{15.6}\n\\end{equation*}\n$$\n\nimage_name:Figure 15.8 Three-stage ring oscillator\ndescription:\n[\nname: M1, type: NMOS, ports: {S: GND, D: E, G: F}\nname: M2, type: NMOS, ports: {S: GND, D: F, G: G(Vout)}\nname: M3, type: NMOS, ports: {S: GND, D: G(Vout), G: Vout}\nname: RD, type: Resistor, value: RD, ports: {N1: VDD, N2: E}\nname: RD, type: Resistor, value: RD, ports: {N1: VDD, N2: F}\nname: RD, type: Resistor, value: RD, ports: {N1: VDD, N2: G(Vout)}\nname: CL, type: Capacitor, value: CL, ports: {Np: E, Nn: GND}\nname: CL, type: Capacitor, value: CL, ports: {Np: F, Nn: GND}\nname: CL, type: Capacitor, value: CL, ports: {Np: G(Vout), Nn: GND}\n]\nextrainfo:The circuit is a three-stage ring oscillator using NMOS transistors, each stage comprising an NMOS, a resistor, and a capacitor. The feedback loop is established to create oscillations.\n\nFigure 15.8 Three-stage ring oscillator.\n\nThe circuit oscillates only if the frequency-dependent phase shift equals $180^{\\circ}$, i.e., if each stage contributes $60^{\\circ}$. The frequency at which this occurs is given by\n\n$$\n\\begin{equation*}\n\\tan ^{-1} \\frac{\\omega_{\\text {osc }}}{\\omega_{0}}=60^{\\circ} \\tag{15.7}\n\\end{equation*}\n$$\n\nand hence\n\n$$\n\\begin{equation*}\n\\omega_{o s c}=\\sqrt{3} \\omega_{0} \\tag{15.8}\n\\end{equation*}\n$$\n\nThe minimum voltage gain per stage must be such that the magnitude of the loop gain at $\\omega_{o s c}$ is equal to unity:\n\n$$\n\\begin{equation*}\n\\frac{A_{0}^{3}}{\\left[\\sqrt{1+\\left(\\frac{\\omega_{\\text {osc }}}{\\omega_{0}}\\right)^{2}}\\right]^{3}}=1 \\tag{15.9}\n\\end{equation*}\n$$\n\nIt follows from (15.8) and (15.9) that\n\n$$\n\\begin{equation*}\nA_{0}=2 \\tag{15.10}\n\\end{equation*}\n$$\n\nIn summary, a three-stage ring oscillator requires a low-frequency gain of 2 per stage, and it oscillates at a frequency of $\\sqrt{3} \\omega_{0}$, where $\\omega_{0}$ is the $3-\\mathrm{dB}$ bandwidth of each stage.\n\nLet us now examine the waveforms at the three nodes of the oscillator of Fig. 15.8. Since each stage contributes a frequency-dependent phase shift of $60^{\\circ}$ as well as a low-frequency signal inversion, the waveform at each node is $240^{\\circ}$ (or $120^{\\circ}$ ) out of phase with respect to its neighboring nodes (Fig. 15.9). The ability to generate multiple phases is a very useful property of ring oscillators.\nimage_name:Figure 15.9 Waveforms of a threestage ring oscillator\ndescription:The graph in Figure 15.9 illustrates the waveforms of a three-stage ring oscillator. It is a time-domain waveform graph, showing the voltage at three different nodes of the oscillator over time. The horizontal axis represents time \\( t \\), while the vertical axis indicates voltage, with three separate waveforms labeled \\( V_E \\), \\( V_F \\), and \\( V_G \\).\n\nEach waveform is sinusoidal, indicating periodic oscillations. The three waveforms are out of phase with each other, specifically showing a phase difference of 120 degrees between each waveform, consistent with the description of a three-stage ring oscillator. This phase difference is a critical characteristic of the oscillator, contributing to its ability to generate multiple phases.\n\nThe amplitude of each waveform appears consistent, with no significant increase or decrease over time, indicating stable oscillation. There are no visible annotations or markers indicating specific data points or values on the graph, focusing instead on the qualitative behavior of the waveforms.\n\nOverall, the graph effectively demonstrates the phase relationship and stability of the oscillations in a three-stage ring oscillator, highlighting its capability to maintain consistent out-of-phase waveforms across its nodes.\n\nimage_name:Figure 15.10 Linear model of three-stage ring oscillator\ndescription:The diagram labeled \"Figure 15.10 Linear model of three-stage ring oscillator\" illustrates a linear feedback system designed to model a three-stage ring oscillator. The primary components and their functions are as follows:\n\n1. **Main Components:**\n- **Three Amplifiers:** The central part of the system is a series of three amplifiers arranged in a ring configuration. Each amplifier is represented as a triangle, indicating the direction of signal flow.\n- **Summing Junction:** At the input, there is a summing junction where the input voltage \\( V_{in} \\) and the feedback voltage are combined. This is depicted by a circle with a plus sign, indicating positive feedback.\n- **Feedback Path:** The output \\( V_{out} \\) is fed back to the input through a feedback loop, completing the ring structure.\n\n2. **Flow of Information or Control:**\n- The input signal \\( V_{in} \\) is first added to the feedback signal at the summing junction. The resulting signal then passes sequentially through the three amplifiers.\n- Each amplifier processes the signal, with the output of one serving as the input to the next, maintaining the direction of flow through the system.\n- The final output \\( V_{out} \\) is taken from the last amplifier and fed back to the summing junction, creating a positive feedback loop.\n\n3. **Labels, Annotations, and Key Indicators:**\n- The transfer function of the system is labeled as \\( \\frac{-A_0^3}{(1 + \\frac{s}{\\omega_0})^3} \\), indicating the gain and frequency response characteristics of the oscillator.\n- The negative sign in the transfer function suggests inversion, typical of oscillatory systems to maintain phase shift conditions conducive to oscillation.\n\n4. **Overall System Function:**\n- The primary function of this system is to model the behavior of a three-stage ring oscillator. The positive feedback loop ensures that the signal is continuously reinforced, allowing the system to sustain oscillations.\n- The arrangement of the amplifiers and the feedback loop is crucial in maintaining the phase conditions necessary for stable oscillation, as suggested by the Barkhausen criterion, which requires the loop gain to be equal to one and the total phase shift around the loop to be 0 or 360 degrees.\n\nThis linear model helps in understanding how variations in the gain \\( A_0 \\) can affect the oscillation conditions, particularly highlighting the impact if \\( A_0 \\) is not equal to 2, as discussed in the context.\n\nFigure 15.10 Linear model of three-stage ring oscillator.\n\nAmplitude Limiting The natural question at this point is-What happens if in the three-stage ring of Fig. 15.8, $A_{0} \\neq 2$ ? We know from Barkhausen's criteria that if $A_{0}<2$, the circuit fails to oscillate, but what if $A_{0}>2$ ? To answer this question, we first model the oscillator by a linear feedback system, as depicted in Fig. 15.10. Note that the feedback is positive (i.e., $V_{\\text {out }}$ is added to $V_{i n}$ ) because $H(s)$ in Eq. (15.6) already includes the negative polarity resulting from three inversions in the signal path. The closed-loop transfer function is\n\n$$\n\\begin{align*}\n\\frac{V_{\\text {out }}(s)}{V_{\\text {in }}(s)} & =\\frac{\\frac{-A_{0}^{3}}{\\left(1+s / \\omega_{0}\\right)^{3}}}{1+\\frac{A_{0}^{3}}{\\left(1+s / \\omega_{0}\\right)^{3}}}  \\tag{15.11}\\\\\n& =\\frac{-A_{0}^{3}}{\\left(1+s / \\omega_{0}\\right)^{3}+A_{0}^{3}} \\tag{15.12}\n\\end{align*}\n$$\n\nThe denominator of (15.12) can be expanded as\n\n$$\n\\begin{equation*}\n\\left(1+\\frac{s}{\\omega_{0}}\\right)^{3}+A_{0}^{3}=\\left(1+\\frac{s}{\\omega_{0}}+A_{0}\\right)\\left[\\left(1+\\frac{s}{\\omega_{0}}\\right)^{2}-\\left(1+\\frac{s}{\\omega_{0}}\\right) A_{0}+A_{0}^{2}\\right] \\tag{15.13}\n\\end{equation*}\n$$\n\nThus, the closed-loop system exhibits three poles:\n\n$$\n\\begin{align*}\ns_{1} & =\\left(-A_{0}-1\\right) \\omega_{0}  \\tag{15.14}\\\\\ns_{2,3} & =\\left[\\frac{A_{0}(1 \\pm j \\sqrt{3})}{2}-1\\right] \\omega_{0} \\tag{15.15}\n\\end{align*}\n$$\n\nSince $A_{0}$ itself is positive, the first pole leads to a decaying exponential term: $\\exp \\left[\\left(-A_{0}-1\\right) \\omega_{0} t\\right]$, which can be neglected in the steady state. Figure 15.11 illustrates the locations of the poles for different values of $A_{0}$, revealing that for $A_{0}>2$, the two complex poles exhibit a positive real part and hence give rise to a growing sinusoid. Neglecting the effect of $s_{1}$, we express the output waveform as\n\n$$\n\\begin{equation*}\nV_{\\text {out }}(t)=a \\exp \\left(\\frac{A_{0}-2}{"
},
{
    "text": "A ring oscillator is constructed by connecting a series of gain stages in a loop. We start by attempting to make a single-stage feedback circuit oscillate to understand the actual implementation.\n\nExample 15.1: Why doesn't a single common-source stage oscillate when placed in a unity-gain loop?\n\n#### Solution\n\nFrom Fig. 15.4, we observe that the open-loop circuit has only one pole, resulting in a maximum frequency-dependent phase shift of $90^{\\circ}$ (at a frequency of infinity). Since the common-source stage introduces a dc phase shift of $180^{\\circ}$ due to signal inversion from the gate to the drain, the total phase shift is $270^{\\circ}$. Consequently, the loop cannot sustain oscillation growth.\n\nFig. 15.4 shows a common-source amplifier with a resistive load and capacitive load, using an NMOS transistor. The output is taken across the capacitor CL.\n\nThe above example suggests that oscillation may occur if the circuit contains multiple stages and hence multiple poles. Indeed, such a topology was considered undesirable in Chapter 10 because it led to inadequate phase margin in op amps. We therefore surmise that if the circuit of Fig. 15.4 is modified as shown in Fig. 15.5, then two significant poles appear in the signal path, allowing the frequency-dependent phase shift to approach $180^{\\circ}$. Unfortunately, this circuit exhibits positive feedback near zero frequency due to the signal inversion through each common-source stage. As a result, it simply \"latches up\" rather than oscillates. That is, if $V_{E}$ rises, $V_{F}$ falls, thereby turning $M_{1}$ off and allowing $V_{E}$ to rise further. This may continue until $V_{E}$ reaches $V_{D D}$ and $V_{F}$ drops to near zero, a state that will remain indefinitely.\n\nTo gain more insight into the oscillation conditions, let us assume that an ideal inverting stage (with zero phase shift at all frequencies) is inserted in the loop of Fig. 15.5, providing negative feedback near zero frequency and eliminating the problem of latch-up (Fig. 15.6). Does this circuit oscillate? We note that the loop contains only two poles: one at $E$ and another at $F$. The frequency-dependent phase shift can therefore reach $180^{\\circ}$, but at a frequency of infinity. Since the loop gain vanishes at very high frequencies, we observe that the circuit does not satisfy both of Barkhausen's criteria at the same frequency (Fig. 15.7), and thus fails to oscillate.\n\nFig. 15.6 shows a two-pole feedback system with an additional signal inversion using an ideal op-amp. It includes two NMOS transistors (M1 and M2) with capacitive loads CL and resistive loads RD. The circuit does not oscillate as it does not meet Barkhausen's criteria at the same frequency.\n\nFig. 15.7 shows the loop gain characteristics of a two-pole system. The graph comprises two subplots: one for magnitude and one for phase, both plotted against frequency on a logarithmic scale.\n\nThe foregoing discussion points to the need for greater phase shift around the loop, suggesting the possibility of oscillation if the third inverting stage in Fig. 15.6 contains a pole that contributes significant phase. We then arrive at the topology depicted in Fig. 15.8. If the three stages are identical, the total phase shift around the loop, $\\phi$, reaches $-135^{\\circ}$ at $\\omega=\\omega_{p, E}\\left(=\\omega_{p, F}=\\omega_{p, G}\\right)$ and $-270^{\\circ}$ at $\\omega=\\infty$. Consequently, $\\phi$ equals $-180^{\\circ}$ at $\\omega<\\infty$, where the loop gain can still be greater than or equal to unity. This circuit indeed oscillates if the loop gain is sufficient and it is an example of a ring oscillator.\n\nIt is instructive to calculate the minimum voltage gain per stage in Fig. 15.8 that is necessary for oscillation. Neglecting the effect of the gate-drain overlap capacitance and denoting the transfer function of each stage by $-A_{0} /\\left(1+s / \\omega_{0}\\right)$, we have for the loop gain\n\n$$\n\\begin{equation*}\nH(s)=-\\frac{A_{0}^{3}}{\\left(1+\\frac{s}{\\omega_{0}}\\right)^{3}} \\tag{15.6}\n\\end{equation*}\n$$\n\nFig. 15.8 shows a three-stage ring oscillator using NMOS transistors, each stage comprising an NMOS, a resistor, and a capacitor. The feedback loop is established to create oscillations.\n\nThe circuit oscillates only if the frequency-dependent phase shift equals $180^{\\circ}$, i.e., if each stage contributes $60^{\\circ}$. The frequency at which this occurs is given by\n\n$$\n\\begin{equation*}\n\\tan ^{-1} \\frac{\\omega_{\\text {osc }}}{\\omega_{0}}=60^{\\circ} \\tag{15.7}\n\\end{equation*}\n$$\n\nand hence\n\n$$\n\\begin{equation*}\n\\omega_{o s c}=\\sqrt{3} \\omega_{0} \\tag{15.8}\n\\end{equation*}\n$$\n\nThe minimum voltage gain per stage must be such that the magnitude of the loop gain at $\\omega_{o s c}$ is equal to unity:\n\n$$\n\\begin{equation*}\n\\frac{A_{0}^{3}}{\\left[\\sqrt{1+\\left(\\frac{\\omega_{\\text {osc }}}{\\omega_{0}}\\right)^{2}}\\right]^{3}}=1 \\tag{15.9}\n\\end{equation*}\n$$\n\nIt follows from (15.8) and (15.9) that\n\n$$\n\\begin{equation*}\nA_{0}=2 \\tag{15.10}\n\\end{equation*}\n$$\n\nIn summary, a three-stage ring oscillator requires a low-frequency gain of 2 per stage, and it oscillates at a frequency of $\\sqrt{3} \\omega_{0}$, where $\\omega_{0}$ is the $3-\\mathrm{dB}$ bandwidth of each stage.\n\nLet us now examine the waveforms at the three nodes of the oscillator of Fig. 15.8. Since each stage contributes a frequency-dependent phase shift of $60^{\\circ}$ as well as a low-frequency signal inversion, the waveform at each node is $240^{\\circ}$ (or $120^{\\circ}$ ) out of phase with respect to its neighboring nodes (Fig. 15.9). The ability to generate multiple phases is a very useful property of ring oscillators.\n\nFig. 15.9 illustrates the waveforms of a three-stage ring oscillator. It is a time-domain waveform graph, showing the voltage at three different nodes of the oscillator over time. The horizontal axis represents time \\( t \\), while the vertical axis indicates voltage, with three separate waveforms labeled \\( V_E \\), \\( V_F \\), and \\( V_G \\).\n\nEach waveform is sinusoidal, indicating periodic oscillations. The three waveforms are out of phase with each other, specifically showing a phase difference of 120 degrees between each waveform, consistent with the description of a three-stage ring oscillator. This phase difference is a critical characteristic of the oscillator, contributing to its ability to generate multiple phases.\n\nThe amplitude of each waveform appears consistent, with no significant increase or decrease over time, indicating stable oscillation. There are no visible annotations or markers indicating specific data points or values on the graph, focusing instead on the qualitative behavior of the waveforms.\n\nOverall, the graph effectively demonstrates the phase relationship and stability of the oscillations in a three-stage ring oscillator, highlighting its capability to maintain consistent out-of-phase waveforms across its nodes.\n\nFig. 15.10 shows a linear model of a three-stage ring oscillator. The diagram illustrates a linear feedback system designed to model a three-stage ring oscillator. The primary components and their functions are as follows:\n\n1. **Main Components:**\n- **Three Amplifiers:** The central part of the system is a series of three amplifiers arranged in a ring configuration. Each amplifier is represented as a triangle, indicating the direction of signal flow.\n- **Summing Junction:** At the input, there is a summing junction where the input voltage \\( V_{in} \\) and the feedback voltage are combined. This is depicted by a circle with a plus sign, indicating positive feedback.\n- **Feedback Path:** The output \\( V_{out} \\) is fed back to the input through a feedback loop, completing the ring structure.\n\n2. **Flow of Information or Control:**\n- The input signal \\( V_{in} \\) is first added to the feedback signal at the summing junction. The resulting signal then passes sequentially through the three amplifiers.\n- Each amplifier processes the signal, with the output of one serving as the input to the next, maintaining the direction of flow through the system.\n- The final output \\( V_{out} \\) is taken from the last amplifier and fed back to the summing junction, creating a positive feedback loop.\n\n3. **Labels, Annotations, and Key Indicators:**\n- The transfer function of the system is labeled as \\( \\frac{-A_0^3}{(1 + \\frac{s}{\\omega_0})^3} \\), indicating the gain and frequency response characteristics of the oscillator.\n- The negative sign in the transfer function suggests inversion, typical of oscillatory systems to maintain phase shift conditions conducive to oscillation.\n\n4. **Overall System Function:**\n- The primary function of this system is to model the behavior of a three-stage ring oscillator. The positive feedback loop ensures that the signal is continuously reinforced, allowing the system to sustain oscillations.\n- The arrangement of the amplifiers and the feedback loop is crucial in maintaining the phase conditions necessary for stable oscillation, as suggested by the Barkhausen criterion, which requires the loop gain to be equal to one and the total phase shift around the loop to be 0 or 360 degrees.\n\nThis linear model helps in understanding how variations in the gain \\( A_0 \\) can affect the oscillation conditions, particularly highlighting the impact if \\( A_0 \\) is not equal to 2, as discussed in the context.\n\nAmplitude Limiting: The natural question at this point is-What happens if in the three-stage ring of Fig. 15.8, $A_{0} \\neq 2$ ? We know from Barkhausen's criteria that if $A_{0}<2$, the circuit fails to oscillate, but what if $A_{0}>2$ ? To answer this question, we first model the oscillator by a linear feedback system, as depicted in Fig. 15.10. Note that the feedback is positive (i.e., $V_{\\text {out }}$ is added to $V_{i n}$ ) because $H(s)$ in Eq. (15.6) already includes the negative polarity resulting from three inversions in the signal path. The closed-loop transfer function is\n\n$$\n\\begin{align*}\n\\frac{V_{\\text {out }}(s)}{V_{\\text {in }}(s)} & =\\frac{\\frac{-A_{0}^{3}}{\\left(1+s / \\omega_{0}\\right)^{3}}}{1+\\frac{A_{0}^{3}}{\\left(1+s / \\omega_{0}\\right)^{3}}}  \\tag{15.11}\\\\\n& =\\frac{-A_{0}^{3}}{\\left(1+s / \\omega_{0}\\right)^{3}+A_{0}^{3}} \\tag{15.12}\n\\end{align*}\n$$\n\nThe denominator of (15.12) can be expanded as\n\n$$\n\\begin{equation*}\n\\left(1+\\frac{s}{\\omega_{0}}\\right)^{3}+A_{0}^{3}=\\left(1+\\frac{s}{\\omega_{0}}+A_{0}\\right)\\left[\\left(1+\\frac{s}{\\omega_{0}}\\right)^{2}-\\left(1+\\frac{s}{\\omega_{0}}\\right) A_{0}+A_{0}^{2}\\right] \\tag{15.13}\n\\end{equation*}\n$$\n\nThus, the closed-loop system exhibits three poles:\n\n$$\n\\begin{align*}\ns_{1} & =\\left(-A_{0}-1\\right) \\omega_{0}  \\tag{15.14}\\\\\ns_{2,3} & =\\left[\\frac{A_{0}(1 \\pm j \\sqrt{3})}{2}-1\\right] \\omega_{0} \\tag{15.15}\n\\end{align*}\n$$\n\nSince $A_{0}$ itself is positive, the first pole leads to a decaying exponential term: $\\exp \\left[\\left(-A_{0}-1\\right) \\omega_{0} t\\right]$, which can be neglected in the steady state. Fig. 15.11 illustrates the locations of the poles for different values of $A_{0}$, revealing that for $A_{0}>2$, the two complex poles exhibit a positive real part and hence give rise to a growing sinusoid. Neglecting the effect of $s_{1}$, we express the output waveform as\n\n$$\n\\begin{equation*}\nV_{\\text {out }}(t)=a \\exp \\left(\\frac{A_{0}-2}{2} \\omega_{0} t\\right) \\cos \\left(\\frac{A_{0} \\sqrt{3}}{2} \\omega_{0} t\\right) \\tag{15.16}\n\\end{equation*}\n$$\n\nThus, if $A_{0}>2$, the exponential envelope grows to infinity.\nIn practice, as the oscillation amplitude increases, the stages in the signal path experience nonlinearity and eventually \"saturation,\" limiting the maximum amplitude. We may say that the poles begin in the right half plane and eventually move to the imaginary axis to stop the growth. If the small-signal loop gain is greater than unity, the circuit must spend enough time in saturation so that the \"average\" loop gain is still equal to unity.\n\n#### Example 15.2\n\nShown in Fig. 15.12 is a differential implementation of the oscillator of Fig. 15.8. What is the maximum voltage swing of each stage?\n\n#### Solution\n\nIf the gain per stage is well above 2, then the amplitude grows until each differential pair experiences complete switching, that is, until $I_{S S}$ is completely steered to one side every half cycle. As a result, the swing at each node is equal to $I_{S S} R_{1}$. From the waveforms shown in Fig. 15.12, we also observe that each stage is in its high-gain region for only a fraction of the period, (e.g., when $\\left|V_{X}-V_{Y}\\right|$ is small).\n\nFig. 15.13 shows a ring oscillator circuit using three CMOS inverters. The nodes X, Y, and Z represent the outputs of each inverter stage, showing oscillating waveforms over time.\n\nA simple implementation of ring oscillators that does not require resistors is depicted in Fig. 15.13. Suppose the circuit is released with an initial voltage at each node equal to the trip point of the inverters, $V_{\\text {trip }} .{ }^{4}$ With identical stages and no noise in the devices, the circuit would remain in this state indefinitely, ${ }^{5}$ but noise components disturb each node voltage, yielding a growing waveform. The signal eventually exhibits rail-to-rail swings.\n\nFig. 15.14 shows the time-domain waveforms of a ring oscillator circuit with three nodes labeled as $V_X$, $V_Y$, and $V_Z$. The x-axis represents time ($t$), and the y-axis represents voltage levels, specifically between 0 and $V_{DD}$, with no specific units or scale markers shown.\n\nLet us now assume that the circuit of Fig. 15.13 begins with $V_{X}=V_{D D}$ (Fig. 15.14). Under this condition, $V_{Y}=0$ and $V_{Z}=V_{D D}$. Thus, when the circuit is released, $V_{X}$ begins to fall to zero (because the first inverter senses a high input), forcing $V_{Y}$ to rise to $V_{D D}$ after one inverter delay, $T_{D}$, and $V_{Z}$ to fall to zero after another inverter delay. The circuit therefore oscillates with a delay of $T_{D}$ between consecutive node voltages, yielding a period of $6 T_{D}$.\n\nThe above small-signal and large-signal analyses raise an interesting question. While the small-signal oscillation frequency is given by $A_{0} \\sqrt{3} \\omega_{0} / 2$ [from Eq. (15.16)], the large-signal value is $1 /\\left(6 T_{D}\\right)$. Are these two values equal? Not necessarily. After all, $\\omega_{0}$ is determined by the small-signal output resistance and capacitance of each inverter near the trip point, whereas $T_{D}$ results from the large-signal, nonlinear current drive and capacitances of each stage. In other words, when the circuit is released with all inverters at their trip point, the oscillation begins with a frequency of $\\sqrt{3} A_{0} \\omega_{0} / 2$, but, as the amplitude grows and the circuit becomes nonlinear, the frequency shifts to $1 /\\left(6 T_{D}\\right)$ (which is a lower value).\n\nRing oscillators employing more than three stages are also feasible. The total number of inversions in the loop must be odd so that the circuit does not latch up. For example, as shown in Fig. 15.15(a), a ring can incorporate five inverters, providing a frequency of $1 /\\left(10 T_{D}\\right)$. On the other hand, the differential implementation can utilize an even number of stages by simply configuring one stage such that it does not invert. Illustrated in Fig. 15.15(b), this flexibility demonstrates another advantage of differential circuits over their single-ended counterparts.\n\n#### Example 15.3\n\nWhat is the minimum required voltage gain per stage in the four-stage oscillator of Fig. 15.15(b)? How many signal phases are provided by the circuit?\n\n#### Solution\n\nUsing a notation similar to that for Fig. 15.8, we have\n\n$$\n\\begin{equation*}\nH(s)=-\\frac{A_{0}^{4}}{\\left(1+\\frac{s}{\\omega_{0}}\\right)^{4}} \\tag{15.17}\n\\end{equation*}\n$$\n\nFor the circuit to oscillate, each"
},
{
    "text": "Fig. 15.19(a) depicts an inductor \\( L_{1} \\) in parallel with a capacitor \\( C_{1} \\) resonating at a frequency \\( \\omega_{\\text{res}} = \\frac{1}{\\sqrt{L_{1} C_{1}}} \\). At this frequency, the inductor's impedance \\( j L_{1} \\omega_{\\text{res}} \\) and the capacitor's impedance \\( \\frac{1}{j C_{1} \\omega_{\\text{res}}} \\) are equal and opposite, resulting in an infinite impedance. This indicates an infinite quality factor \\( Q \\) for the circuit. However, practical inductors and capacitors have resistive components. For instance, the series resistance of the metal wire in the inductor can be modeled as shown in Fig. 15.19(b). The quality factor \\( Q \\) of the inductor is defined as \\( \\frac{L_{1} \\omega}{R_{S}} \\). For this circuit, the equivalent impedance is given by:\n\n\\[\nZ_{\\text{eq}}(s) = \\frac{R_{S} + L_{1} s}{1 + L_{1} C_{1} s^{2} + R_{S} C_{1} s} \\tag{15.27}\n\\]\n\nThe circuit in diagram (a) is an ideal LC tank circuit with an inductor \\( L_{1} \\) and a capacitor \\( C_{1} \\) connected in parallel between nodes X and Y. The circuit diagram (b) represents a realistic LC tank with a series resistor \\( R_{S} \\) modeling the series resistance of the inductor \\( L_{1} \\). The circuit is connected between nodes Y and X.\n\nHence,\n\n\\[\n\\left|Z_{\\text{eq}}(s = j \\omega)\\right|^{2} = \\frac{R_{S}^{2} + L_{1}^{2} \\omega^{2}}{\\left(1 - L_{1} C_{1} \\omega^{2}\\right)^{2} + R_{S}^{2} C_{1}^{2} \\omega^{2}} \\tag{15.28}\n\\]\n\nThis shows that the impedance does not go to infinity at any \\( s = j \\omega \\). We say that the circuit has a finite \\( Q \\). The magnitude of \\( Z_{\\text{eq}} \\) in (15.28) reaches a peak near \\( \\omega = \\frac{1}{\\sqrt{L_{1} C_{1}}} \\), but the actual resonance frequency is somewhat dependent on \\( R_{S} \\).\n\nThe circuit of Fig. 15.19(b) can be transformed into an equivalent topology that is easier to analyze and design. We first consider the series combination shown in Fig. 15.20(a). For a narrow frequency range, it is possible to convert the circuit to the parallel configuration of Fig. 15.20(b).\n\nThe circuit diagram (a) shows a series combination of an inductor \\( L_{1} \\), a resistor \\( r_{L} \\), and another resistor \\( R_{S} \\). The nodes X and Y are the input and output nodes of the circuit. The circuit in diagram (b) is a parallel LC circuit with an inductor \\( L_{P} \\) and a resistor \\( R_{P} \\) connected between nodes X and Y. This circuit is equivalent to the series circuit in diagram (a) for a narrow frequency range.\n\nFor the two impedances to be equivalent,\n\n\\[\nL_{1} s + R_{S} = \\frac{R_{P} L_{P} s}{R_{P} + L_{P} s} \\tag{15.29}\n\\]\n\nAssuming \\( s = j \\omega \\) for the steady-state response, we rewrite (15.29) as\n\n\\[\n\\left(L_{1} R_{P} + L_{P} R_{S}\\right) j \\omega + R_{S} R_{P} - L_{1} L_{P} \\omega^{2} = R_{P} L_{P} j \\omega \\tag{15.30}\n\\]\n\nThis relationship must hold for all values of \\( \\omega \\) (in a narrow range), dictating that\n\n\\[\n\\begin{align*}\nL_{1} R_{P} + L_{P} R_{S} & = R_{P} L_{P}  \\tag{15.31}\\\\\nR_{S} R_{P} - L_{1} L_{P} \\omega^{2} & = 0 \\tag{15.32}\n\\end{align*}\n\\]\n\nCalculating \\( R_{P} \\) from the latter and substituting in the former, we get\n\n\\[\nL_{P} = L_{1}\\left(1 + \\frac{R_{S}^{2}}{L_{1}^{2} \\omega^{2}}\\right) \\tag{15.33}\n\\]\n\nRecall that \\( \\frac{L_{1} \\omega}{R_{S}} = Q \\), a value typically greater than 3 for monolithic inductors. Thus,\n\n\\[\nL_{P} \\approx L_{1} \\tag{15.34}\n\\]\n\nand\n\n\\[\n\\begin{align*}\nR_{P} & \\approx \\frac{L_{1}^{2} \\omega^{2}}{R_{S}}  \\tag{15.35}\\\\\n& \\approx Q^{2} R_{S} \\tag{15.36}\n\\end{align*}\n\\]\n\nIn other words, the parallel network has the same reactance but a resistance \\( Q^{2} \\) times the series resistance. This concept is also valid for a first-order RC network if the \\( Q \\) of the series combination is defined as \\( \\frac{1}{(C \\omega) / R_{S}} \\).\n\nThe circuit diagram illustrates the conversion of a series LC tank circuit with a resistor into an equivalent parallel LC tank circuit with a resistor. The left side shows the series configuration with \\( L_{1} \\), \\( C_{1} \\), \\( R_{S} \\), and \\( r_{L} \\), while the right side shows the parallel configuration with \\( L_{P} \\), \\( C_{P} \\), and \\( R_{P} \\). This transformation is used to simplify the analysis of the circuit at its resonance frequency.\n\nThe above transformation allows the conversion illustrated in Fig. 15.21, where \\( C_{P} = C_{1} \\). The equivalence, of course, breaks down as \\( \\omega \\) departs substantially from the resonance frequency. The insight gained from the parallel combination is that at \\( \\omega_{1} = \\frac{1}{\\sqrt{L_{p} C_{p}}} \\), the tank reduces to a simple resistor; i.e., the phase difference between the voltage and current of the tank drops to zero. Plotting the magnitude of the tank impedance versus frequency [Fig. 15.22(a)], we note that the behavior is inductive for \\( \\omega < \\omega_{1} \\) and capacitive for \\( \\omega > \\omega_{1} \\). We then surmise that the phase of the impedance is positive for \\( \\omega < \\omega_{1} \\) and negative for \\( \\omega > \\omega_{1} \\) [Fig. 15.22(b)]. These observations are useful in studying LC oscillators.\n\nThe graph labeled (a) represents the magnitude of the impedance \\( |Z| \\) of an LC tank circuit as a function of frequency \\( \\omega \\). The x-axis is labeled with angular frequency \\( \\omega \\), and the y-axis represents the magnitude of the impedance. The graph shows a peak at a specific frequency, \\( \\omega_{1} \\), indicating resonance. The magnitude increases sharply as it approaches \\( \\omega_{1} \\) from both sides and reaches a maximum at \\( \\omega_{1} \\), then decreases symmetrically. Below \\( \\omega_{1} \\), the behavior is inductive, and above \\( \\omega_{1} \\), it is capacitive, as inferred from the context.\n\nThe graph labeled (b) depicts the phase angle of the impedance \\( \\angle Z \\) versus frequency \\( \\omega \\). The x-axis again represents the frequency, while the y-axis shows the phase angle in degrees. The phase angle starts at \\( +90^{\\circ} \\) at very low frequencies, indicating inductive behavior. As the frequency increases towards \\( \\omega_{1} \\), the phase angle decreases, crossing zero at \\( \\omega_{1} \\), where the impedance is purely resistive. Beyond \\( \\omega_{1} \\), the phase angle continues to decrease, approaching \\( -90^{\\circ} \\) at very high frequencies, indicating capacitive behavior. This transition from \\( +90^{\\circ} \\) to \\( -90^{\\circ} \\) is smooth and continuous, reflecting the change from inductive to capacitive nature of the impedance as frequency increases.\n\nLet us now consider the \"tuned\" stage of Fig. 15.23(a), where an LC tank operates as the load. At resonance, \\( j L_{p} \\omega = \\frac{1}{j C_{p} \\omega} \\) and the voltage gain equals \\( -g_{m1} R_{P} \\). (Note that the gain of the circuit is very small at frequencies near zero.) Does this circuit oscillate if the output is connected to the input [Fig. 15.23(b)]? At resonance, the total phase shift around the loop is equal to \\( 180^{\\circ} \\) (rather than \\( 360^{\\circ} \\)). Also, from Fig. 15.22(b), the frequency-dependent phase shift of the tank never reaches \\( 180^{\\circ} \\). Thus, the circuit does not oscillate.\n\nThe circuit is a tuned gain stage with an NMOS transistor \\( M_{1} \\), a parallel LC tank circuit (\\( L_{P} \\) and \\( C_{P} \\)), and a resistor \\( R_{P} \\). The output node is \\( V_{\\text{out}} \\). The circuit is powered by a voltage source \\( V_{\\text{DD}} \\).\n\nBefore modifying the circuit for oscillatory behavior, let us observe another interesting property of the gain stage of Fig. 15.23(a) that distinguishes it from a common-source topology using a resistive load. Suppose, as shown in Fig. 15.24, the stage is biased at a drain current \\( I_{1} \\). If the series resistance of \\( L_{p} \\) is small, the dc level of \\( V_{\\text{out}} \\) is close to \\( V_{\\text{DD}} \\). How does \\( V_{\\text{out}} \\) vary if a small sinusoidal voltage at the resonance frequency is applied to the input? We expect \\( V_{\\text{out}} \\) to be an inverted sinusoid with an average value near \\( V_{\\text{DD}} \\) because the inductor cannot sustain a large dc drop. In other words, if the average value of \\( V_{\\text{out}} \\) deviates significantly from \\( V_{\\text{DD}} \\), then the inductor series resistance must carry an average current greater than \\( I_{1} \\). Thus, the peak output level in fact exceeds the supply voltage, an important and often useful attribute of the LC load. For example, with proper design, the output peak-to-peak swing can be larger than \\( V_{\\text{DD}} \\).\n\nThe graph in Figure 15.24 illustrates the output signal levels in a tuned stage of an LC oscillator. The diagram is composed of two parts: a schematic on the left and a waveform on the right.\n\nThe graph on the right is a time-domain waveform representing the output voltage, \\( V_{\\text{out}} \\), of the LC circuit.\n\nThe waveform is sinusoidal, indicating oscillatory behavior typical of an LC circuit. The sinusoid oscillates above and below the DC supply voltage, \\( V_{\\text{DD}} \\), suggesting that the peak-to-peak amplitude of the output exceeds \\( V_{\\text{DD}} \\). This behavior highlights the ability of the LC circuit to generate output voltages larger than the supply voltage due to resonance and energy storage in the inductor and capacitor.\n\nThe waveform shows a consistent oscillation with no visible distortion, indicating stable operation at resonance. The average value of the waveform is close to \\( V_{\\text{DD}} \\), which is typical as the inductor cannot sustain a large DC drop. The peak and trough of the waveform exceed \\( V_{\\text{DD}} \\), demonstrating the circuit's capability to achieve a peak-to-peak swing larger than the supply voltage.\n\nWe now study two types of LC oscillators."
},
{
    "text": "Figure 15.19(a) depicts an ideal LC tank circuit, which includes an inductor \\( L_1 \\) and a capacitor \\( C_1 \\) connected in parallel between nodes X and Y. This configuration resonates at a frequency \\( \\omega_{\\text{res}} = \\frac{1}{\\sqrt{L_1 C_1}} \\). At resonance, the inductor's impedance \\( j L_1 \\omega_{\\text{res}} \\) and the capacitor's impedance \\( \\frac{1}{j C_1 \\omega_{\\text{res}}} \\) are equal in magnitude but opposite in sign, resulting in an infinite overall impedance. This is indicative of an infinite quality factor, \\( Q \\).\n\nIn real-world scenarios, however, both inductors and capacitors have inherent resistive elements. For instance, the series resistance of the wire used in the inductor can be modeled as shown in Figure 15.19(b). The quality factor of the inductor is defined as \\( \\frac{L_1 \\omega}{R_S} \\). For the circuit in Figure 15.19(b), the equivalent impedance can be expressed as:\n\n\\[\nZ_{\\text{eq}}(s) = \\frac{R_S + L_1 s}{1 + L_1 C_1 s^2 + R_S C_1 s} \\tag{15.27}\n\\]\n\nThe circuit in Figure 15.19(b) can be transformed into an equivalent topology that is more conducive to analysis and design. Initially, we consider the series combination shown in Figure 15.20(a). Within a narrow frequency range, this circuit can be converted to the parallel configuration shown in Figure 15.20(b).\n\nFor the two impedances to be equivalent, the following relationship must hold:\n\n\\[\nL_1 s + R_S = \\frac{R_P L_P s}{R_P + L_P s} \\tag{15.29}\n\\]\n\nAssuming \\( s = j \\omega \\) for the steady-state response, we can rewrite equation (15.29) as:\n\n\\[\n(L_1 R_P + L_P R_S) j \\omega + R_S R_P - L_1 L_P \\omega^2 = R_P L_P j \\omega \\tag{15.30}\n\\]\n\nThis relationship must hold for all values of \\( \\omega \\) within a narrow range, leading to:\n\n\\[\n\\begin{align*}\nL_1 R_P + L_P R_S &= R_P L_P \\tag{15.31} \\\\\nR_S R_P - L_1 L_P \\omega^2 &= 0 \\tag{15.32}\n\\end{align*}\n\\]\n\nSolving for \\( R_P \\) from equation (15.32) and substituting it into equation (15.31), we obtain:\n\n\\[\nL_P = L_1 \\left(1 + \\frac{R_S^2}{L_1^2 \\omega^2}\\right) \\tag{15.33}\n\\]\n\nGiven that \\( \\frac{L_1 \\omega}{R_S} = Q \\), which is typically greater than 3 for monolithic inductors, we can approximate:\n\n\\[\nL_P \\approx L_1 \\tag{15.34}\n\\]\n\nand\n\n\\[\n\\begin{align*}\nR_P &\\approx \\frac{L_1^2 \\omega^2}{R_S} \\tag{15.35} \\\\\n&\\approx Q^2 R_S \\tag{15.36}\n\\end{align*}\n\\]\n\nThus, the parallel network has the same reactance but a resistance \\( Q^2 \\) times the series resistance. This concept is also applicable to a first-order RC network if the \\( Q \\) of the series combination is defined as \\( \\frac{1}{(C \\omega) / R_S} \\).\n\nFigure 15.21 illustrates the conversion of a series LC tank circuit with a resistor into an equivalent parallel LC tank circuit with a resistor. The left side shows the series configuration with \\( L_1 \\), \\( C_1 \\), \\( R_S \\), and \\( r_L \\), while the right side shows the parallel configuration with \\( L_P \\), \\( C_P \\), and \\( R_P \\). This transformation simplifies the analysis of the circuit at its resonance frequency.\n\nThe equivalence holds true as long as \\( \\omega \\) remains close to the resonance frequency. At \\( \\omega_1 = \\frac{1}{\\sqrt{L_P C_P}} \\), the tank circuit behaves as a simple resistor, with the phase difference between the voltage and current dropping to zero. The magnitude of the tank impedance versus frequency, as shown in Figure 15.22(a), exhibits inductive behavior for \\( \\omega < \\omega_1 \\) and capacitive behavior for \\( \\omega > \\omega_1 \\). The phase of the impedance, as depicted in Figure 15.22(b), is positive for \\( \\omega < \\omega_1 \\) and negative for \\( \\omega > \\omega_1 \\). These observations are crucial for studying LC oscillators.\n\nFigure 15.23(a) shows an LC tank operating as the load in a tuned gain stage. At resonance, \\( j L_P \\omega = \\frac{1}{j C_P \\omega} \\), and the voltage gain equals \\( -g_{m1} R_P \\). If the output is connected to the input, as in Figure 15.23(b), the circuit does not oscillate because the total phase shift around the loop is \\( 180^\\circ \\) at resonance, rather than \\( 360^\\circ \\). Additionally, the frequency-dependent phase shift of the tank never reaches \\( 180^\\circ \\).\n\nIn the gain stage of Figure 15.23(a), if biased at a drain current \\( I_1 \\) and if the series resistance of \\( L_P \\) is small, the DC level of \\( V_{\\text{out}} \\) is close to \\( V_{DD} \\). Applying a small sinusoidal voltage at the resonance frequency to the input results in an inverted sinusoid \\( V_{\\text{out}} \\) with an average value near \\( V_{DD} \\). This is because the inductor cannot sustain a large DC drop. If the average value of \\( V_{\\text{out}} \\) deviates significantly from \\( V_{DD} \\), the inductor series resistance must carry an average current greater than \\( I_1 \\). Consequently, the peak output level can exceed the supply voltage, which is an important and often useful attribute of the LC load.\n\nFigure 15.24 shows the output signal levels in a tuned stage of an LC oscillator. The waveform on the right represents the output voltage \\( V_{\\text{out}} \\) of the LC circuit. The waveform is sinusoidal, indicating oscillatory behavior typical of an LC circuit. The sinusoid oscillates above and below the DC supply voltage \\( V_{DD} \\), suggesting that the peak-to-peak amplitude of the output exceeds \\( V_{DD} \\). This behavior highlights the ability of the LC circuit to generate output voltages larger than the supply voltage due to resonance and energy storage in the inductor and capacitor.\n\nWe now proceed to study two types of LC oscillators."
},
{
    "text": "Figure 15.19(a) depicts an inductor, \\(L_1\\), in parallel with a capacitor, \\(C_1\\), resonating at a frequency \\(\\omega_{\\text{res}} = \\frac{1}{\\sqrt{L_1 C_1}}\\). At this frequency, the inductor's impedance, \\(j L_1 \\omega_{\\text{res}}\\), and the capacitor's impedance, \\(\\frac{1}{(j C_1 \\omega_{\\text{res}})}\\), are equal in magnitude but opposite in sign, resulting in an overall infinite impedance. This is indicative of an infinite quality factor, \\(Q\\). In reality, both inductors and capacitors have inherent resistive elements. For instance, the resistance of the wire used in the inductor can be modeled as shown in Figure 15.19(b). The quality factor of the inductor is defined as \\(Q = \\frac{L_1 \\omega}{R_S}\\). For this circuit, the equivalent impedance can be expressed as:\n\n\\[\nZ_{eq}(s) = \\frac{R_S + L_1 s}{1 + L_1 C_1 s^2 + R_S C_1 s} \\tag{15.27}\n\\]\n\nThe circuits in diagrams (a) and (b) are described as follows:\n\n- **(a)**: An ideal LC tank circuit with an inductor \\(L_1\\) and a capacitor \\(C_1\\) connected in parallel between nodes X and Y.\n- **(b)**: A realistic LC tank circuit with a series resistor \\(R_S\\) modeling the series resistance of the inductor \\(L_1\\), connected between nodes Y and X.\n\nFigure 15.19 illustrates ideal and realistic LC tank circuits.\n\nHence, the squared magnitude of the equivalent impedance is given by:\n\n\\[\n|Z_{eq}(s=j \\omega)|^2 = \\frac{R_S^2 + L_1^2 \\omega^2}{(1 - L_1 C_1 \\omega^2)^2 + R_S^2 C_1^2 \\omega^2} \\tag{15.28}\n\\]\n\nThis shows that the impedance does not approach infinity for any \\(s=j \\omega\\). The circuit has a finite \\(Q\\). The magnitude of \\(Z_{eq}\\) peaks near \\(\\omega = \\frac{1}{\\sqrt{L_1 C_1}}\\), but the actual resonance frequency is influenced by \\(R_S\\).\n\nThe circuit of Figure 15.19(b) can be transformed into an equivalent topology that simplifies analysis and design. We first consider the series combination shown in Figure 15.20(a). For a narrow frequency range, this circuit can be converted to the parallel configuration of Figure 15.20(b).\n\n- **(a)**: A series combination of an inductor \\(L_1\\), a resistor \\(r_L\\), and another resistor \\(R_S\\), with nodes X and Y as the input and output.\n- **(b)**: A parallel LC circuit with an inductor \\(L_P\\) and a resistor \\(R_P\\) connected between nodes X and Y, equivalent to the series circuit in (a) for a narrow frequency range.\n\nFigure 15.20 illustrates the conversion of a series combination to a parallel combination.\n\nFor the two impedances to be equivalent:\n\n\\[\nL_1 s + R_S = \\frac{R_P L_P s}{R_P + L_P s} \\tag{15.29}\n\\]\n\nAssuming a steady-state response with \\(s = j \\omega\\), equation (15.29) becomes:\n\n\\[\n(L_1 R_P + L_P R_S) j \\omega + R_S R_P - L_1 L_P \\omega^2 = R_P L_P j \\omega \\tag{15.30}\n\\]\n\nThis relationship must hold for all \\(\\omega\\) within a narrow range, leading to:\n\n\\[\n\\begin{align*}\nL_1 R_P + L_P R_S &= R_P L_P  \\tag{15.31}\\\\\nR_S R_P - L_1 L_P \\omega^2 &= 0 \\tag{15.32}\n\\end{align*}\n\\]\n\nSolving for \\(R_P\\) and substituting into the former equation yields:\n\n\\[\nL_P = L_1\\left(1 + \\frac{R_S^2}{L_1^2 \\omega^2}\\right) \\tag{15.33}\n\\]\n\nRecall that \\(Q = \\frac{L_1 \\omega}{R_S}\\), a value typically greater than 3 for monolithic inductors. Thus:\n\n\\[\nL_P \\approx L_1 \\tag{15.34}\n\\]\n\nand\n\n\\[\n\\begin{align*}\nR_P &\\approx \\frac{L_1^2 \\omega^2}{R_S}  \\tag{15.35}\\\\\n&\\approx Q^2 R_S \\tag{15.36}\n\\end{align*}\n\\]\n\nIn essence, the parallel network exhibits the same reactance but a resistance \\(Q^2\\) times the series resistance. This concept is also applicable to a first-order RC network if the \\(Q\\) of the series combination is defined as \\(\\frac{1}{(C \\omega) / R_S}\\).\n\nFigure 15.21 illustrates the conversion of a tank circuit to three parallel components. The equivalence holds for a narrow frequency range around the resonance frequency.\n\nThe transformation allows the conversion shown in Figure 15.21, where \\(C_P = C_1\\). The equivalence breaks down as \\(\\omega\\) deviates significantly from the resonance frequency. The insight gained from the parallel combination is that at \\(\\omega_1 = \\frac{1}{\\sqrt{L_P C_P}}\\), the tank circuit behaves as a simple resistor; i.e., the phase difference between the voltage and current of the tank drops to zero. Plotting the magnitude of the tank impedance versus frequency [Figure 15.22(a)], we observe that the behavior is inductive for \\(\\omega < \\omega_1\\) and capacitive for \\(\\omega > \\omega_1\\). We infer that the phase of the impedance is positive for \\(\\omega < \\omega_1\\) and negative for \\(\\omega > \\omega_1\\) [Figure 15.22(b)]. These observations are crucial in studying LC oscillators.\n\nFigure 15.22(a) and (b) depict the magnitude and phase of the impedance of an LC tank as a function of frequency, respectively.\n\nLet us now consider the \"tuned\" stage of Figure 15.23(a), where an LC tank operates as the load. At resonance, \\(j L_P \\omega = \\frac{1}{(j C_P \\omega)}\\) and the voltage gain equals \\(-g_{m1} R_P\\). (Note that the gain of the circuit is very small at frequencies near zero.) Does this circuit oscillate if the output is connected to the input [Figure 15.23(b)]? At resonance, the total phase shift around the loop is \\(180^\\circ\\) (instead of \\(360^\\circ\\)). Also, from Figure 15.22(b), the frequency-dependent phase shift of the tank never reaches \\(180^\\circ\\). Thus, the circuit does not oscillate.\n\n- **(a)**: A tuned gain stage with an NMOS transistor \\(M1\\), a parallel LC tank circuit (\\(L_P\\) and \\(C_P\\)), and a resistor \\(R_P\\). The output node is \\(V_{out}\\), and the circuit is powered by a voltage source \\(V_{DD}\\).\n- **(b)**: The same stage as in (a) but with the output connected to the input, forming a feedback loop.\n\nFigure 15.23 illustrates a tuned gain stage and its feedback configuration.\n\nBefore modifying the circuit for oscillatory behavior, consider another interesting property of the gain stage of Figure 15.23(a) that sets it apart from a common-source topology using a resistive load. Suppose, as shown in Figure 15.24, the stage is biased at a drain current \\(I_1\\). If the series resistance of \\(L_P\\) is small, the DC level of \\(V_{out}\\) is close to \\(V_{DD}\\). How does \\(V_{out}\\) vary if a small sinusoidal voltage at the resonance frequency is applied to the input? We expect \\(V_{out}\\) to be an inverted sinusoid with an average value near \\(V_{DD}\\) because the inductor cannot sustain a large DC drop. In other words, if the average value of \\(V_{out}\\) deviates significantly from \\(V_{DD}\\), then the inductor series resistance must carry an average current greater than \\(I_1\\). Thus, the peak output level actually exceeds the supply voltage, an important and often useful attribute of the LC load. With proper design, the output peak-to-peak swing can be larger than \\(V_{DD}\\).\n\nFigure 15.24 illustrates the output signal levels in a tuned stage of an LC oscillator.\n\nWe now proceed to study two types of LC oscillators."
},
{
    "text": "As depicted in Fig. 15.19(a), the parallel combination of an inductor \\( L_{1} \\) and a capacitor \\( C_{1} \\) resonates at a frequency \\( \\omega_{\\text{res}} = \\frac{1}{\\sqrt{L_{1} C_{1}}} \\). At this resonance frequency, the inductor's impedance, \\( j L_{1} \\omega_{\\text{res}} \\), and the capacitor's impedance, \\( \\frac{1}{j C_{1} \\omega_{\\text{res}}} \\), are equal in magnitude but opposite in sign, resulting in an overall infinite impedance. This circuit is said to have an infinite quality factor, \\( Q \\). However, real-world inductors and capacitors have inherent resistive components. For instance, the series resistance of the wire used in the inductor can be represented as shown in Fig. 15.19(b). The quality factor \\( Q \\) of the inductor is defined as \\( \\frac{L_{1} \\omega}{R_{S}} \\). For this circuit, the equivalent impedance can be expressed as:\n\n\\[\nZ_{\\text{eq}}(s) = \\frac{R_{S} + L_{1} s}{1 + L_{1} C_{1} s^{2} + R_{S} C_{1} s} \\tag{15.27}\n\\]\n\nThe circuit in diagram (a) is an ideal LC tank circuit with an inductor \\( L_{1} \\) and a capacitor \\( C_{1} \\) connected in parallel between nodes X and Y. The circuit diagram (b) represents a realistic LC tank with a series resistor \\( R_{S} \\) modeling the series resistance of the inductor \\( L_{1} \\), connected between nodes Y and X.\n\nFigures 15.19 (a) and (b) show ideal and realistic LC tank circuits, respectively. Hence,\n\n\\[\n|Z_{\\text{eq}}(s = j \\omega)|^{2} = \\frac{R_{S}^{2} + L_{1}^{2} \\omega^{2}}{(1 - L_{1} C_{1} \\omega^{2})^{2} + R_{S}^{2} C_{1}^{2} \\omega^{2}} \\tag{15.28}\n\\]\n\nThis indicates that the impedance does not approach infinity at any \\( s = j \\omega \\). The circuit is said to have a finite \\( Q \\). The magnitude of \\( Z_{\\text{eq}} \\) in equation (15.28) peaks near \\( \\omega = \\frac{1}{\\sqrt{L_{1} C_{1}}} \\), but the actual resonance frequency is influenced by \\( R_{S} \\).\n\nThe circuit of Fig. 15.19(b) can be transformed into an equivalent topology that simplifies analysis and design. First, we consider the series combination shown in Fig. 15.20(a). Over a narrow frequency range, this circuit can be converted to the parallel configuration of Fig. 15.20(b).\n\nFig\nThe circuit diagrams\nThe provided text describes the behavior and transformations of LC circuits, particularly focusing\nThe provided text discusses the behaviors and transformations of LC circuits, particularly focusing on the resonance characteristics and the quality factor (Q). It starts by explaining the ideal resonance condition for a parallel LC circuit, where the inductive and capacitive reactances cancel each other out, leading to an infinite impedance and an infinite Q factor. However, it then introduces the realistic scenario where resistive components affect the inductor and capacitor, resulting in a finite Q factor.\n\nThe text describes how the series resistance of the inductor can be modeled and how it impacts the equivalent impedance of the circuit. It provides the mathematical expressions for the equivalent impedance and the magnitude squared of the impedance, highlighting that the impedance does not go to infinity due to the resistive components.\n\nFurthermore, the text explores the transformation of a series LC circuit with a resistor into an equivalent parallel LC circuit, which simplifies the analysis, especially at resonance. It details the conditions under which the two impedances are equivalent and derives the relationships between the components of the series and parallel circuits.\n\nThe discussion also includes the conversion of a tank circuit into three parallel components, which is illustrated in Figure 15.21. This transformation is useful for understanding the circuit's behavior at resonance, where the tank circuit acts as a simple resistor, and the phase difference between voltage and current drops to zero.\n\nAdditionally, the text examines the magnitude and phase of the impedance of an LC tank as functions of frequency, as shown in Figure 15.22. It explains the inductive and capacitive behavior of the circuit at frequencies below and above resonance, respectively, and the phase shift characteristics of the impedance.\n\nFinally, the text considers a tuned gain stage with an LC tank operating as the load and analyzes whether the circuit can oscillate when the output is connected to the input. It concludes that the circuit does not oscillate at resonance due to the total phase shift around the loop being equal to 180 degrees, rather than the necessary 360 degrees for oscillation.\n\nThe text also touches upon an interesting property of the gain stage with an LC load, which is the ability to produce output voltages exceeding the supply voltage due to the resonance and energy storage in the inductor and capacitor. This property is illustrated in Figure 15.24.\n\nOverall, the text provides a comprehensive analysis of LC circuits, their resonance characteristics, quality factor, and transformations between series and parallel configurations, as well as their applications in gain stages and oscillators."
},
{
    "text": "In Figure 15.19(a), the parallel combination of an inductor, \\( L_1 \\), and a capacitor, \\( C_1 \\), resonates at a frequency of \\( \\omega_{\\text{res}} = \\frac{1}{\\sqrt{L_1 C_1}} \\). At this resonant frequency, the impedances of the inductor, \\( j L_1 \\omega_{\\text{res}} \\), and the capacitor, \\( \\frac{1}{(j C_1 \\omega_{\\text{res}})} \\), are equal in magnitude but opposite in sign, resulting in an overall infinite impedance. This is indicative of an infinite quality factor, \\( Q \\). However, real inductors and capacitors have inherent resistive components. For instance, the series resistance of the inductor's metal wire can be modeled as shown in Figure 15.19(b). The quality factor of the inductor is defined as \\( \\frac{L_1 \\omega}{R_S} \\). For the given circuit, the equivalent impedance can be expressed as:\n\n\\[\nZ_{\\text{eq}}(s) = \\frac{R_S + L_1 s}{1 + L_1 C_1 s^2 + R_S C_1 s} \\tag{15.27}\n\\]\n\nThe circuit depicted in Figure 15.19(a) is an ideal LC tank circuit, comprising an inductor \\( L1 \\) and a capacitor \\( C1 \\) connected in parallel between nodes X and Y. Figure 15.19(b) represents a more realistic LC tank circuit with a series resistor \\( Rs \\) that models the series resistance of the inductor \\( L1 \\), also connected between nodes Y and X.\n\nAs a result, the magnitude squared of the equivalent impedance is given by:\n\n\\[\n\\left| Z_{\\text{eq}}(s = j \\omega) \\right|^2 = \\frac{R_S^2 + L_1^2 \\omega^2}{(1 - L_1 C_1 \\omega^2)^2 + R_S^2 C_1^2 \\omega^2} \\tag{15.28}\n\\]\n\nThis indicates that the impedance does not approach infinity at any \\( s = j \\omega \\), signifying a finite \\( Q \\). The magnitude of \\( Z_{\\text{eq}} \\) in equation (15.28) peaks near \\( \\omega = \\frac{1}{\\sqrt{L_1 C_1}} \\), but the actual resonance frequency is influenced by \\( R_S \\).\n\nThe circuit in Figure 15.19(b) can be transformed into an equivalent topology that simplifies analysis and design. We first consider the series combination shown in Figure 15.20(a). Within a narrow frequency range, this circuit can be converted to the parallel configuration depicted in Figure 15.20(b).\n\nFor the two impedances to be equivalent, the following relationship must hold:\n\n\\[\nL_1 s + R_S = \\frac{R_P L_P s}{R_P + L_P s} \\tag{15.29}\n\\]\n\nAssuming a steady-state response with \\( s = j \\omega \\), equation (15.29) can be rewritten as:\n\n\\[\n(L_1 R_P + L_P R_S) j \\omega + R_S R_P - L_1 L_P \\omega^2 = R_P L_P j \\omega \\tag{15.30}\n\\]\n\nThis must be true for all values of \\( \\omega \\) within a narrow range, leading to the equations:\n\n\\[\n\\begin{align*}\nL_1 R_P + L_P R_S & = R_P L_P \\tag{15.31}\\\\\nR_S R_P - L_1 L_P \\omega^2 & = 0 \\tag{15.32}\n\\end{align*}\n\\]\n\nSolving for \\( R_P \\) from the second equation and substituting into the first, we obtain:\n\n\\[\nL_P = L_1 \\left(1 + \\frac{R_S^2}{L_1^2 \\omega^2}\\right) \\tag{15.33}\n\\]\n\nRecall that \\( \\frac{L_1 \\omega}{R_S} = Q \\), a value typically greater than 3 for monolithic inductors. Therefore:\n\n\\[\nL_P \\approx L_1 \\tag{15.34}\n\\]\n\nand\n\n\\[\n\\begin{align*}\nR_P & \\approx \\frac{L_1^2 \\omega^2}{R_S} \\tag{15.35}\\\\\n& \\approx Q^2 R_S \\tag{15.36}\n\\end{align*}\n\\]\n\nIn essence, the parallel network exhibits the same reactance but a resistance \\( Q^2 \\) times the series resistance. This concept also applies to a first-order RC network, provided the \\( Q \\) of the series combination is defined as \\( \\frac{1}{(C \\omega) / R_S} \\).\n\nThe transformation depicted in Figure 15.21 allows for the conversion of a series LC tank circuit with a resistor into an equivalent parallel LC tank circuit with a resistor. The left side of the figure shows the series configuration with \\( L1 \\), \\( C1 \\), \\( RS \\), and \\( rL \\), while the right side shows the parallel configuration with \\( LP \\), \\( CP \\), and \\( RP \\). This transformation aids in simplifying the analysis of the circuit at its resonance frequency.\n\nAt \\( \\omega_1 = \\frac{1}{\\sqrt{L_P C_P}} \\), the tank circuit behaves as a simple resistor, with the phase difference between voltage and current dropping to zero. The magnitude of the tank impedance versus frequency, as shown in Figure 15.22(a), exhibits inductive behavior for \\( \\omega < \\omega_1 \\) and capacitive behavior for \\( \\omega > \\omega_1 \\). The phase of the impedance is positive for \\( \\omega < \\omega_1 \\) and negative for \\( \\omega > \\omega_1 \\), as indicated in Figure 15.22(b). These observations are crucial for studying LC oscillators.\n\nConsider the \"tuned\" stage in Figure 15.23(a), where an LC tank operates as the load. At resonance, \\( j L_P \\omega = \\frac{1}{(j C_P \\omega)} \\), and the voltage gain equals \\( -g_{m1} R_P \\). (The gain of the circuit is very small at frequencies near zero.) If the output is connected to the input, as in Figure 15.23(b), the circuit does not oscillate because the total phase shift around the loop is \\( 180^\\circ \\) at resonance, rather than the necessary \\( 360^\\circ \\). Additionally, from Figure 15.22(b), the frequency-dependent phase shift of the tank never reaches \\( 180^\\circ \\).\n\nIn Figure 15.24, if the stage is biased at a drain current \\( I_1 \\) and the series resistance of \\( L_P \\) is small, the DC level of \\( V_{\\text{out}} \\) is close to \\( V_{DD} \\). Applying a small sinusoidal voltage at the resonance frequency to the input results in an inverted sinusoid at \\( V_{\\text{out}} \\) with an average value near \\( V_{DD} \\). If the average value of \\( V_{\\text{out}} \\) deviates significantly from \\( V_{DD} \\), the inductor series resistance must carry an average current greater than \\( I_1 \\). Hence, the peak output level can actually exceed the supply voltage, which is a significant and often beneficial attribute of the LC load. With appropriate design, the output peak-to-peak swing can be larger than \\( V_{DD} \\).\n\nFinally, we will examine two types of LC oscillators."
},
{
    "text": "As depicted in Fig. 15.19(a), the parallel combination of an inductor $L_{1}$ and a capacitor $C_{1}$ achieves resonance at a frequency $\\omega_{\\text {res }}=1 / \\sqrt{L_{1} C_{1}}$. At this specific frequency, the inductor's impedance, $j L_{1} \\omega_{\\text {res }}$, and the capacitor's impedance, $1 /\\left(j C_{1} \\omega_{\\text {res }}\\right)$, are equal in magnitude but opposite in phase, resulting in an overall infinite impedance. This configuration is said to have an infinite quality factor, $Q$. However, real-world inductors and capacitors have inherent resistive elements. For instance, the resistance of the metal wire used in the inductor can be represented as shown in Fig. 15.19(b). The quality factor $Q$ of the inductor is defined as $L_{1} \\omega / R_{S}$. For this circuit, the reader can verify that the equivalent impedance is given by the following equation:\n\n$$\n\\begin{equation*}\nZ_{e q}(s)=\\frac{R_{S}+L_{1} s}{1+L_{1} C_{1} s^{2}+R_{S} C_{1} s} \\tag{15.27}\n\\end{equation*}\n$$\n\nIn practice, the impedance does not reach infinity at any frequency, as indicated by the following equation:\n\n$$\n\\begin{equation*}\n\\left|Z_{e q}(s=j \\omega)\\right|^{2}=\\frac{R_{S}^{2}+L_{1}^{2} \\omega^{2}}{\\left(1-L_{1} C_{1} \\omega^{2}\\right)^{2}+R_{S}^{2} C_{1}^{2} \\omega^{2}} \\tag{15.28}\n\\end{equation*}\n$$\n\nThis implies that the circuit has a finite $Q$. The magnitude of $Z_{e q}$ in (15.28) peaks near $\\omega=1 / \\sqrt{L_{1} C_{1}}$, although the actual resonance frequency is somewhat influenced by $R_{S}$.\n\nThe circuit in Fig. 15.19(b) can be transformed into an equivalent topology that simplifies analysis and design. To achieve this, we first examine the series combination in Fig. 15.20(a). Within a limited frequency range, this circuit can be converted to the parallel configuration in Fig. 15.20(b).\n\nThe equivalence of the two impedances is established by the following equation:\n\n$$\n\\begin{equation*}\nL_{1} s+R_{S}=\\frac{R_{P} L_{P} s}{R_{P}+L_{P} s} \\tag{15.29}\n\\end{equation*}\n$$\n\nAssuming a steady-state response, we set $s=j \\omega$ and rearrange (15.29) as follows:\n\n$$\n\\begin{equation*}\n\\left(L_{1} R_{P}+L_{P} R_{S}\\right) j \\omega+R_{S} R_{P}-L_{1} L_{P} \\omega^{2}=R_{P} L_{P} j \\omega \\tag{15.30}\n\\end{equation*}\n$$\n\nThis relationship must hold for all values of $\\omega$ within a narrow range, leading to the following equations:\n\n$$\n\\begin{align*}\nL_{1} R_{P}+L_{P} R_{S} & =R_{P} L_{P}  \\tag{15.31}\\\\\nR_{S} R_{P}-L_{1} L_{P} \\omega^{2} & =0 \\tag{15.32}\n\\end{align*}\n$$\n\nSolving for $R_{P}$ from the latter equation and substituting it into the former, we obtain:\n\n$$\n\\begin{equation*}\nL_{P}=L_{1}\\left(1+\\frac{R_{S}^{2}}{L_{1}^{2} \\omega^{2}}\\right) \\tag{15.33}\n\\end{equation*}\n$$\n\nRecall that $L_{1} \\omega / R_{S}=Q$, a value typically greater than 3 for monolithic inductors. Thus, we can approximate:\n\n$$\n\\begin{equation*}\nL_{P} \\approx L_{1} \\tag{15.34}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{align*}\nR_{P} & \\approx \\frac{L_{1}^{2} \\omega^{2}}{R_{S}}  \\tag{15.35}\\\\\n& \\approx Q^{2} R_{S} \\tag{15.36}\n\\end{align*}\n$$\n\nThis indicates that the parallel network exhibits the same reactance but a resistance $Q^{2}$ times the series resistance. This principle also applies to a first-order RC network, provided that the $Q$ of the series combination is defined as $1 /(C \\omega) / R_{S}$.\n\nThe transformation described allows for the conversion shown in Fig. 15.21, where $C_{P}=C_{1}$. However, this equivalence is only valid within a narrow frequency range around the resonance frequency. The key insight from the parallel combination is that at $\\omega_{1}=1 / \\sqrt{L_{p} C_{p}}$, the tank circuit behaves as a simple resistor, with the phase difference between the voltage and current dropping to zero. By plotting the magnitude of the tank impedance versus frequency [Fig. 15.22(a)], we observe that the behavior is inductive for $\\omega<\\omega_{1}$ and capacitive for $\\omega>\\omega_{1}$. Consequently, we can infer that the phase of the impedance is positive for $\\omega<\\omega_{1}$ and negative for $\\omega>\\omega_{1}$ [Fig. 15.22(b)]. These observations are valuable in the study of LC oscillators. (Why do we expect the phase shift to approach $+90^{\\circ}$ at very low frequencies and $-90^{\\circ}$ at very high frequencies?)\n\nLet us now consider the \"tuned\" stage of Fig. 15.23(a), where an LC tank operates as the load. At resonance, $j L_{p} \\omega=1 /\\left(j C_{p} \\omega\\right)$ and the voltage gain equals $-g_{m 1} R_{P}$. (Note that the gain of the circuit is very small at frequencies near zero.) Does this circuit oscillate if the output is connected to the input [Fig. 15.23(b)]? At resonance, the total phase shift around the loop is equal to $180^{\\circ}$ (rather than $360^{\\circ}$ ). Also, from Fig. 15.22(b), the frequency-dependent phase shift of the tank never reaches $180^{\\circ}$. Thus, the circuit does not oscillate.\n\nBefore modifying the circuit for oscillatory behavior, let us observe another interesting property of the gain stage of Fig. 15.23(a) that distinguishes it from a common-source topology using a resistive load. Suppose, as shown in Fig. 15.24, the stage is biased at a drain current $I_{1}$. If the series resistance of $L_{p}$ is small, the dc level of $V_{\\text {out }}$ is close to $V_{D D}$. How does $V_{\\text {out }}$ vary if a small sinusoidal voltage at the resonance frequency is applied to the input? We expect $V_{\\text {out }}$ to be an inverted sinusoid with an average value near $V_{D D}$ because the inductor cannot sustain a large dc drop. In other words, if the average value of $V_{\\text {out }}$ deviates significantly from $V_{D D}$, then the inductor series resistance must carry an average current greater than $I_{1}$. Thus, the peak output level in fact exceeds the supply voltage, an important and often useful attribute of the LC load. For example, with proper design, the output peak-to-peak swing can be larger than $V_{D D}$.\n\nWe now study two types of LC oscillators."
},
{
    "text": "The inductor \\( L_1 \\) in parallel with the capacitor \\( C_1 \\) resonates at a frequency \\( \\omega_{\\text{res}} = \\frac{1}{\\sqrt{L_1 C_1}} \\) as depicted in Fig. 15.19(a). At this resonant frequency, the inductor's impedance \\( j L_1 \\omega_{\\text{res}} \\) and the capacitor's impedance \\( \\frac{1}{j C_1 \\omega_{\\text{res}}} \\) are equal in magnitude but opposite in sign, resulting in an overall infinite impedance. This indicates that the circuit possesses an infinite quality factor, \\( Q \\). However, real-world inductors and capacitors have inherent resistive elements. For instance, the resistance of the metal wire used in the inductor can be modeled as shown in Fig. 15.19(b). The quality factor \\( Q \\) of the inductor is defined as \\( \\frac{L_1 \\omega}{R_S} \\). For the circuit in question, the equivalent impedance can be expressed as:\n\n\\[\nZ_{\\text{eq}}(s) = \\frac{R_S + L_1 s}{1 + L_1 C_1 s^2 + R_S C_1 s} \\tag{15.27}\n\\]\n\nThe diagrams in Fig. 15.19(a) and (b) illustrate an ideal LC tank circuit and a realistic one with a series resistor \\( R_S \\) modeling the inductor's series resistance, respectively. Both circuits are connected between nodes X and Y.\n\nFrom the derived equations, it is evident that the impedance does not approach infinity at any \\( s = j \\omega \\), signifying that the circuit has a finite \\( Q \\). The magnitude of \\( Z_{\\text{eq}} \\) in equation (15.28) peaks near \\( \\omega = \\frac{1}{\\sqrt{L_1 C_1}} \\), but the actual resonance frequency is somewhat influenced by \\( R_S \\).\n\nThe circuit in Fig. 15.19(b) can be transformed into an equivalent topology that simplifies analysis and design. Initially, we consider the series combination as shown in Fig. 15.20(a). Over a narrow frequency range, this circuit can be converted into the parallel configuration of Fig. 15.20(b).\n\nFor the two impedances to be equivalent, the relationship in equation (15.29) must hold. Considering only the steady-state response with \\( s = j \\omega \\), equation (15.30) is derived. These equations lead to the conditions in equations (15.31) and (15.32), which must be satisfied for all values of \\( \\omega \\) within a narrow range.\n\nSolving for \\( R_P \\) from equation (15.32) and substituting into equation (15.31), we obtain equation (15.33). Given that \\( \\frac{L_1 \\omega}{R_S} = Q \\) and is typically greater than 3 for monolithic inductors, equations (15.34), (15.35), and (15.36) follow, indicating that the parallel network has the same reactance but a resistance \\( Q^2 \\) times the series resistance.\n\nThis transformation illustrated\nI\nThe parallel provided describes the series\nCertainly text text details\nThe provided text discussesves into the behavior and characteristics of LC circuits, focusing on resonance, impedance, and the quality factor (Q). It starts by explaining the resonance frequency of an LC circuit, which occurs when the inductive reactance equals the capacitive reactance, resulting in an infinite impedance. This ideal scenario assumes no resistive components, leading to an infinite Q factor.\n\nHowever, the text acknowledges that real-world inductors and capacitors have resistive elements, which affect the resonance and Q factor. It models the series resistance of the inductor and defines the Q factor in terms of the inductance, frequency, and series resistance.\n\nThe text then presents the equivalent impedance of the circuit, considering the resistive elements, and shows that the impedance does not go to infinity, indicating a finite Q factor. It discusses how the magnitude of the impedance peaks near the resonance frequency but is influenced by the series resistance.\n\nFurthermore, the text explores the transformation of the series LC circuit with a resistor into an equivalent parallel LC circuit, which simplifies analysis and design. It presents the conditions under which the two configurations are equivalent and how the Q factor relates to the resistances in the parallel configuration.\n\nThe text also examines the phase response of the LC circuit as a function of frequency, explaining how the phase shift changes from inductive to capacitive behavior around the resonance frequency. It highlights the importance of understanding this phase response for studying LC oscillators.\n\nFinally, the text introduces the concept of a \"tuned\" stage using an LC tank as the load and discusses the conditions under which the circuit can oscillate. It concludes by mentioning the unique property of the LC load that allows the output peak-to-peak swing to exceed the supply voltage, which is a useful attribute for certain circuit designs."
},
{
    "text": "Figure 15.19(a) displays an inductor \\(L_1\\) in parallel with a capacitor \\(C_1\\), which resonates at a frequency \\(\\omega_{\\text{res}} = \\frac{1}{\\sqrt{L_1 C_1}}\\). At this resonance frequency, the inductor's impedance, \\(j L_1 \\omega_{\\text{res}}\\), and the capacitor's impedance, \\(\\frac{1}{j C_1 \\omega_{\\text{res}}}\\), are equal in magnitude but opposite in sign, resulting in an overall infinite impedance. This circuit is said to possess an infinite quality factor, \\(Q\\). However, practical inductors and capacitors are subject to resistive losses. As depicted in Figure 15.19(b), the series resistance of the inductor's metal wire can be modeled. The quality factor \\(Q\\) of the inductor is defined as \\(L_1 \\omega / R_S\\). For the given circuit, the equivalent impedance can be expressed as:\n\n\\[\nZ_{eq}(s) = \\frac{R_S + L_1 s}{1 + L_1 C_1 s^2 + R_S C_1 s} \\tag{15.27}\n\\]\n\nThe descriptions of the images provide a detailed account of the components and their interconnections in both the ideal and realistic LC tank circuits.\n\nSubsequently, the impedance squared is derived as:\n\n\\[\n\\left|Z_{eq}(s=j \\omega)\\right|^2 = \\frac{R_S^2 + L_1^2 \\omega^2}{\\left(1 - L_1 C_1 \\omega^2\\right)^2 + R_S^2 C_1^2 \\omega^2} \\tag{15.28}\n\\]\n\nThis expression indicates that the impedance does not reach infinity for any \\(s=j \\omega\\), implying a finite \\(Q\\). The magnitude of \\(Z_{eq}\\) peaks around \\(\\omega = \\frac{1}{\\sqrt{L_1 C_1}}\\), but the actual resonance frequency is influenced by \\(R_S\\).\n\nThe circuit in Figure 15.19(b) can be transformed into an equivalent topology that simplifies analysis and design. Considering the series combination in Figure 15.20(a), it is feasible to convert the circuit into the parallel configuration shown in Figure 15.20(b) over a narrow frequency range.\n\nTo ensure impedance equivalence, the relationship must hold:\n\n\\[\nL_1 s + R_S = \\frac{R_P L_P s}{R_P + L_P s} \\tag{15.29}\n\\]\n\nAssuming a steady-state response with \\(s=j \\omega\\), the equation is rewritten as:\n\n\\[\n\\left(L_1 R_P + L_P R_S\\right) j \\omega + R_S R_P - L_1 L_P \\omega^2 = R_P L_P j \\omega \\tag{15.30}\n\\]\n\nThis must be valid for all \\(\\omega\\) within a narrow range, leading to the equations:\n\n\\[\nL_1 R_P + L_P R_S = R_P L_P \\tag{15.31}\n\\]\n\\[\nR_S R_P - L_1 L_P \\omega^2 = 0 \\tag{15.32}\n\\]\n\nSolving for \\(R_P\\) and substituting into the previous equation yields:\n\n\\[\nL_P = L_1 \\left(1 + \\frac{R_S^2}{L_1^2 \\omega^2}\\right) \\tag{15.33}\n\\]\n\nGiven that \\(L_1 \\omega / R_S = Q\\), typically greater than 3 for monolithic inductors, it follows that:\n\n\\[\nL_P \\approx L_1 \\tag{15.34}\n\\]\n\nand\n\n\\[\nR_P \\approx \\frac{L_1^2 \\omega^2}{R_S} \\approx Q^2 R_S \\tag{15.35}\n\\]\n\nIn essence, the parallel network exhibits the same reactance but a resistance \\(Q^2\\) times the series resistance. This principle also applies to a first-order RC network if the \\(Q\\) of the series combination is defined as \\(1/(C \\omega) / R_S\\).\n\nFigure 15.21 illustrates the conversion of a series LC tank circuit with a resistor into an equivalent parallel LC tank circuit with a resistor. The transformation simplifies the analysis of the circuit at its resonance frequency.\n\nThe transformation allows for the conversion shown in Figure 15.21, where \\(C_P = C_1\\). However, the equivalence is only valid near the resonance frequency. The parallel combination reveals that at \\(\\omega_1 = \\frac{1}{\\sqrt{L_P C_P}}\\), the tank behaves as a simple resistor, with zero phase difference between voltage and current. The magnitude of the tank impedance versus frequency, as shown in Figure 15.22(a), exhibits inductive behavior for \\(\\omega < \\omega_1\\) and capacitive behavior for \\(\\omega > \\omega_1\\). Consequently, the phase of the impedance is positive for \\(\\omega < \\omega_1\\) and negative for \\(\\omega > \\omega_1\\), as depicted in Figure 15.22(b). These insights are valuable in studying LC oscillators.\n\nIn Figure 15.23(a), the \"tuned\" stage operates with an LC tank as the load. At resonance, the voltage gain equals \\(-g_{m1} R_P\\). If the output is connected to the input, as in Figure 15.23(b), the circuit does not oscillate because the total phase shift around the loop is \\(180^\\circ\\) rather than \\(360^\\circ\\), and the frequency-dependent phase shift of the tank never reaches \\(180^\\circ\\).\n\nIn Figure 15.24, if a small sinusoidal voltage at the resonance frequency is applied to the input, the output voltage \\(V_{\\text{out}}\\) becomes an inverted sinusoid with an average value near \\(V_{DD}\\). This is due to the inductor's inability to sustain a large DC drop. If the average \\(V_{\\text{out}}\\) deviates significantly from \\(V_{DD}\\), the inductor series resistance must carry an average current greater than \\(I_1\\). Thus, the peak output level can exceed the supply voltage, a significant attribute of the LC load.\n\nFinally, the text concludes by noting that the circuit's output peak-to-peak swing can be larger than \\(V_{DD}\\) with proper design, and the discussion transitions to studying two types of LC oscillators."
},
{
    "text": "In Figure 15.19(a), an inductor \\( L_{1} \\) in parallel with a capacitor \\( C_{1} \\) resonates at a frequency \\( \\omega_{\\text{res}} = \\frac{1}{\\sqrt{L_{1} C_{1}}} \\). At this resonance frequency, the impedances of the inductor, \\( j L_{1} \\omega_{\\text{res}} \\), and the capacitor, \\( \\frac{1}{(j C_{1} \\omega_{\\text{res}})} \\), are equal and opposite, resulting in an infinite impedance. This circuit is said to have an infinite quality factor, \\( Q \\). However, in reality, inductors (and capacitors) have resistive components. For instance, the series resistance of the metal wire in the inductor can be modeled as shown in Figure 15.19(b). We define the \\( Q \\) of the inductor as \\( \\frac{L_{1} \\omega}{R_{S}} \\). For this circuit, the equivalent impedance is given by\n\n\\[\nZ_{e q}(s) = \\frac{R_{S} + L_{1} s}{1 + L_{1} C_{1} s^{2} + R_{S} C_{1} s} \\tag{15.27}\n\\]\n\nFigure 15.19(a) shows an ideal LC tank circuit with an inductor \\( L_{1} \\) and a capacitor \\( C_{1} \\) connected in parallel between nodes X and Y. Figure 15.19(b) represents a realistic LC tank circuit with a series resistor \\( R_{S} \\) modeling the series resistance of the inductor \\( L_{1} \\). The circuit is connected between nodes Y and X.\n\nFrom equation (15.28), we can see that the impedance does not go to infinity at any \\( s = j \\omega \\). We say that the circuit has a finite \\( Q \\). The magnitude of \\( Z_{e q} \\) in equation (15.28) reaches a peak near \\( \\omega = \\frac{1}{\\sqrt{L_{1} C_{1}}} \\), but the actual resonance frequency depends on \\( R_{S} \\).\n\nThe circuit in Figure 15.19(b) can be transformed into an equivalent topology that is easier to analyze and design. First, we consider the series combination shown in Figure 15.20(a). For a narrow frequency range, it is possible to convert the circuit to the parallel configuration in Figure 15.20(b).\n\nFigure 15.20(a) shows a series combination of an inductor \\( L_{1} \\), a resistor \\( r_{L} \\), and another resistor \\( R_{S} \\). The nodes X and Y are the input and output nodes of the circuit. Figure 15.20(b) is a parallel LC circuit with an inductor \\( L_{P} \\) and a resistor \\( R_{P} \\) connected between nodes X and Y. This circuit is equivalent to the series circuit in Figure 15.20(a) for a narrow frequency range.\n\nFor the two impedances to be equivalent,\n\n\\[\nL_{1} s + R_{S} = \\frac{R_{P} L_{P} s}{R_{P} + L_{P} s} \\tag{15.29}\n\\]\n\nConsidering only the steady-state response, we assume \\( s = j \\omega \\) and rewrite equation (15.29) as\n\n\\[\n\\left(L_{1} R_{P} + L_{P} R_{S}\\right) j \\omega + R_{S} R_{P} - L_{1} L_{P} \\omega^{2} = R_{P} L_{P} j \\omega \\tag{15.30}\n\\]\n\nThis relationship must hold for all values of \\( \\omega \\) (in a narrow range), dictating that\n\n\\[\n\\begin{align*}\nL_{1} R_{P} + L_{P} R_{S} & = R_{P} L_{P} \\tag{15.31}\\\\\nR_{S} R_{P} - L_{1} L_{P} \\omega^{2} & = 0 \\tag{15.32}\n\\end{align*}\n\\]\n\nCalculating \\( R_{P} \\) from the latter and substituting in the former, we have\n\n\\[\nL_{P} = L_{1}\\left(1 + \\frac{R_{S}^{2}}{L_{1}^{2} \\omega^{2}}\\right) \\tag{15.33}\n\\]\n\nRecall that \\( \\frac{L_{1} \\omega}{R_{S}} = Q \\), a value typically greater than 3 for monolithic inductors. Thus,\n\n\\[\nL_{P} \\approx L_{1} \\tag{15.34}\n\\]\n\nand\n\n\\[\n\\begin{align*}\nR_{P} & \\approx \\frac{L_{1}^{2} \\omega^{2}}{R_{S}} \\tag{15.35}\\\\\n& \\approx Q^{2} R_{S} \\tag{15.36}\n\\end{align*}\n\\]\n\nIn other words, the parallel network has the same reactance but a resistance \\( Q^{2} \\) times the series resistance. This concept also holds for a first-order RC network if the \\( Q \\) of the series combination is defined as \\( \\frac{1}{(C \\omega) / R_{S}} \\).\n\nFigure 15.21 illustrates the conversion of a series LC tank circuit with a resistor into an equivalent parallel LC tank circuit with a resistor. The left side shows the series configuration with \\( L_{1} \\), \\( C_{1} \\), \\( R_{S} \\), and \\( r_{L} \\), while the right side shows the parallel configuration with \\( L_{P} \\), \\( C_{P} \\), and \\( R_{P} \\). This transformation is used to simplify the analysis of the circuit at its resonance frequency.\n\nThe above transformation allows the conversion illustrated in Figure 15.21, where \\( C_{P} = C_{1} \\). The equivalence, of course, breaks down as \\( \\omega \\) departs substantially from the resonance frequency. The insight gained from the parallel combination is that at \\( \\omega_{1} = \\frac{1}{\\sqrt{L_{P} C_{P}}} \\), the tank reduces to a simple resistor; i.e., the phase difference between the voltage and current of the tank drops to zero. Plotting the magnitude of the tank impedance versus frequency (Figure 15.22(a)), we note that the behavior is inductive for \\( \\omega < \\omega_{1} \\) and capacitive for \\( \\omega > \\omega_{1} \\). We then surmise that the phase of the impedance is positive for \\( \\omega < \\omega_{1} \\) and negative for \\( \\omega > \\omega_{1} \\) (Figure 15.22(b)). These observations are useful in studying LC oscillators.\n\nFigure 15.22(a) represents the magnitude of the impedance \\( |Z| \\) of an LC tank circuit as a function of frequency \\( \\omega \\). The graph shows a peak at a specific frequency, \\( \\omega_{1} \\), indicating resonance. The magnitude increases sharply as it approaches \\( \\omega_{1} \\) from both sides and reaches a maximum at \\( \\omega_{1} \\), then decreases symmetrically. Below \\( \\omega_{1} \\), the behavior is inductive, and above \\( \\omega_{1} \\), it is capacitive.\n\nThe graph in Figure 15.22(b) depicts the phase angle of the impedance \\( \\angle Z \\) versus frequency \\( \\omega \\). The phase angle starts at \\( +90^{\\circ} \\) at very low frequencies, indicating inductive behavior. As the frequency increases towards \\( \\omega_{1} \\), the phase angle decreases, crossing zero at \\( \\omega_{1} \\), where the impedance is purely resistive. Beyond \\( \\omega_{1} \\), the phase angle continues to decrease, approaching \\( -90^{\\circ} \\) at very high frequencies, indicating capacitive behavior. This transition from \\( +90^{\\circ} \\) to \\( -90^{\\circ} \\) is smooth and continuous, reflecting the change from inductive to capacitive nature of the impedance as frequency increases.\n\nLet us now consider the \"tuned\" stage of Figure 15.23(a), where an LC tank operates as the load. At resonance, \\( j L_{p} \\omega = \\frac{1}{(j C_{p} \\omega)} \\) and the voltage gain equals \\( -g_{m 1} R_{P} \\). (Note that the gain of the circuit is very small at frequencies near zero.) Does this circuit oscillate if the output is connected to the input (Figure 15.23(b))? At resonance, the total phase shift around the loop is equal to \\( 180^{\\circ} \\) (rather than \\( 360^{\\circ} \\)). Also, from Figure 15.22(b), the frequency-dependent phase shift of the tank never reaches \\( 180^{\\circ} \\). Thus, the circuit does not oscillate.\n\nFigure 15.23(a) is a tuned gain stage with an NMOS transistor \\( M_{1} \\), a parallel LC tank circuit (\\( L_{P} \\) and \\( C_{P} \\)), and a resistor \\( R_{P} \\). The output node is \\( V_{\\text{out}} \\). The circuit is powered by a voltage source \\( V_{\\text{DD}} \\).\n\nBefore modifying the circuit for oscillatory behavior, let us observe another interesting property of the gain stage of Figure 15.23(a) that distinguishes it from a common-source topology using a resistive load. Suppose, as shown in Figure 15.24, the stage is biased at a drain current \\( I_{1} \\). If the series resistance of \\( L_{p} \\) is small, the DC level of \\( V_{\\text{out}} \\) is close to \\( V_{\\text{DD}} \\). How does \\( V_{\\text{out}} \\) vary if a small sinusoidal voltage at the resonance frequency is applied to the input? We expect \\( V_{\\text{out}} \\) to be an inverted sinusoid with an average value near \\( V_{\\text{DD}} \\) because the inductor cannot sustain a large DC drop. In other words, if the average value of \\( V_{\\text{out}} \\) deviates significantly from \\( V_{\\text{DD}} \\), then the inductor series resistance must carry an average current greater than \\( I_{1} \\). Thus, the peak output level in fact exceeds the supply voltage, an important and often useful attribute of the LC load. For example, with proper design, the output peak-to-peak swing can be larger than \\( V_{\\text{DD}} \\).\n\nFigure 15.24 illustrates the output signal levels in a tuned stage of an LC oscillator. The diagram is composed of two parts: a schematic on the left and a waveform on the right.\n\nThe waveform is sinusoidal, indicating oscillatory behavior typical of an LC circuit. The sinusoid oscillates above and below the DC supply voltage, \\( V_{\\text{DD}} \\), suggesting that the peak-to-peak amplitude of the output exceeds \\( V_{\\text{DD}} \\). This behavior highlights the ability of the LC circuit to generate output voltages larger than the supply voltage due to resonance and energy storage in the inductor and capacitor.\n\nWe now study two types of LC oscillators."
},
{
    "text": "The inductor \\( L_1 \\) in parallel with the capacitor \\( C_1 \\) exhibits resonance at a frequency \\( \\omega_{\\text{res}} = \\frac{1}{\\sqrt{L_1 C_1}} \\). At this specific frequency, the inductive and capacitive impedances, \\( j L_1 \\omega_{\\text{res}} \\) and \\( \\frac{1}{j C_1 \\omega_{\\text{res}}} \\), respectively, are equal in magnitude but opposite in phase, resulting in an overall infinite impedance. This configuration is characterized by an infinite quality factor, \\( Q \\). However, real-world inductors and capacitors have inherent resistive elements. For instance, the series resistance of the inductor's metal wire can be modeled as shown in Fig. 15.19(b). The quality factor \\( Q \\) of the inductor is defined as \\( \\frac{L_1 \\omega}{R_S} \\). For the given circuit, the equivalent impedance can be expressed as:\n\n$$\nZ_{eq}(s) = \\frac{R_S + L_1 s}{1 + L_1 C_1 s^2 + R_S C_1 s} \\tag{15.27}\n$$\n\nThe circuit in diagram (a) is an ideal LC tank circuit comprising an inductor \\( L_1 \\) and a capacitor \\( C_1 \\) connected in parallel between nodes X and Y. The circuit in diagram (b) represents a more realistic LC tank circuit with a series resistor \\( R_S \\) that models the series resistance of the inductor \\( L_1 \\). This circuit is connected between nodes Y and X.\n\nThe magnitude squared of the equivalent impedance is given by:\n\n$$\n|Z_{eq}(s=j \\omega)|^2 = \\frac{R_S^2 + L_1^2 \\omega^2}{(1 - L_1 C_1 \\omega^2)^2 + R_S^2 C_1^2 \\omega^2} \\tag{15.28}\n$$\n\nThis indicates that the impedance does not approach infinity for any \\( s=j \\omega \\). The circuit is said to have a finite \\( Q \\). The magnitude of \\( Z_{eq} \\) peaks near \\( \\omega = \\frac{1}{\\sqrt{L_1 C_1}} \\), but the actual resonance frequency is influenced by \\( R_S \\).\n\nThe circuit in Fig. 15.19(b) can be transformed into an equivalent topology that simplifies analysis and design. We first consider the series combination shown in Fig. 15.20(a). Within a narrow frequency range, this circuit can be converted to the parallel configuration in Fig. 15.20(b).\n\nFor the two impedances to be equivalent:\n\n$$\nL_1 s + R_S = \\frac{R_P L_P s}{R_P + L_P s} \\tag{15.29}\n$$\n\nAssuming steady-state response with \\( s = j \\omega \\), we rewrite (15.29) as:\n\n$$\n(L_1 R_P + L_P R_S) j \\omega + R_S R_P - L_1 L_P \\omega^2 = R_P L_P j \\omega \\tag{15.30}\n$$\n\nThis relationship must hold for all \\( \\omega \\) within a narrow range, leading to:\n\n$$\n\\begin{align*}\nL_1 R_P + L_P R_S & = R_P L_P \\tag{15.31}\\\\\nR_S R_P - L_1 L_P \\omega^2 & = 0 \\tag{15.32}\n\\end{align*}\n$$\n\nSolving for \\( R_P \\) from the latter and substituting into the former, we get:\n\n$$\nL_P = L_1 \\left(1 + \\frac{R_S^2}{L_1^2 \\omega^2}\\right) \\tag{15.33}\n$$\n\nGiven that \\( \\frac{L_1 \\omega}{R_S} = Q \\), a value typically greater than 3 for monolithic inductors, we have:\n\n$$\nL_P \\approx L_1 \\tag{15.34}\n$$\n\nand\n\n$$\n\\begin{align*}\nR_P & \\approx \\frac{L_1^2 \\omega^2}{R_S} \\tag{15.35}\\\\\n& \\approx Q^2 R_S \\tag{15.36}\n\\end{align*}\n$$\n\nThus, the parallel network exhibits the same reactance but a resistance \\( Q^2 \\) times the series resistance. This principle also applies to a first-order RC network if the \\( Q \\) of the series combination is defined as \\( \\frac{1}{(C \\omega) / R_S} \\).\n\nThe transformation allows for the conversion illustrated in Fig. 15.21, where \\( C_P = C_1 \\). The equivalence holds only within a narrow frequency range around the resonance frequency. The insight gained from the parallel combination is that at \\( \\omega_1 = \\frac{1}{\\sqrt{L_P C_P}} \\), the tank behaves as a simple resistor, with zero phase difference between voltage and current. The magnitude of the tank impedance versus frequency [Fig. 15.22(a)] shows inductive behavior for \\( \\omega < \\omega_1 \\) and capacitive behavior for \\( \\omega > \\omega_1 \\). The phase of the impedance is positive for \\( \\omega < \\omega_1 \\) and negative for \\( \\omega > \\omega_1 \\) [Fig. 15.22(b)]. These observations are crucial for studying LC oscillators.\n\nConsidering the \"tuned\" stage in Fig. 15.23(a), where an LC tank serves as the load, the voltage gain at resonance is \\( -g_{m1} R_P \\). If the output is connected to the input [Fig. 15.23(b)], the circuit does not oscillate because the total phase shift around the loop is \\( 180^\\circ \\) at resonance, and the frequency-dependent phase shift of the tank never reaches \\( 180^\\circ \\).\n\nIn the tuned stage of Fig. 15.23(a), if biased at a drain current \\( I_1 \\) and the series resistance of \\( L_P \\) is small, the DC level of \\( V_{\\text{out}} \\) is close to \\( V_{DD} \\). Applying a small sinusoidal voltage at the resonance frequency to the input results in an inverted sinusoid output with an average value near \\( V_{DD} \\). The peak output level can exceed \\( V_{DD} \\), which is a significant attribute of the LC load."
},
{
    "text": "Figure 15.19(a) depicts a parallel resonant circuit consisting of an inductor \\(L_1\\) and a capacitor \\(C_1\\), which resonate at a frequency \\(\\omega_{\\text{res}} = \\frac{1}{\\sqrt{L_1 C_1}}\\). At this resonant frequency, the inductive and capacitive impedances, \\(j L_1 \\omega_{\\text{res}}\\) and \\(\\frac{1}{j C_1 \\omega_{\\text{res}}}\\), respectively, are equal in magnitude but opposite in phase, resulting in an overall infinite impedance and This is\nAs original provided describes been carefullyphrased to maintain the original meaning and length, and follows. Here\nFigure re provided has been rephrased to maintain the original meaning and length, as requested."
},
{
    "text": "---[Rephrased Text]---\n\nFig. 15.19(a) depicts an LC circuit where an inductor \\(L_1\\) and a capacitor \\(C_1\\) resonate at a frequency \\(\\omega_{\\text{res}} = \\frac{1}{\\sqrt{L_1 C_1}}\\). At this resonance frequency, the inductor's impedance \\(j L_1 \\omega_{\\text{res}}\\) and the capacitor's impedance \\(\\frac{1}{j C_1 \\omega_{\\text{res}}}\\) are equal in magnitude but opposite in phase, resulting in an overall infinite impedance and an infinite quality factor \\(Q\\). In reality, both inductors and capacitors have resistive components; for instance, the resistance of the inductor's wire can be modeled as shown in Fig. 15.19(b). The quality factor \\(Q\\) of the inductor is defined as \\(\\frac{L_1 \\omega}{R_S}\\). For this circuit, the equivalent impedance is given by:\n\n\\[\nZ_{eq}(s) = \\frac{R_S + L_1 s}{1 + L_1 C_1 s^2 + R_S C_1 s} \\tag{15.27}\n\\]\n\nFigures 15.19(a) and (b) represent an ideal and a realistic LC tank circuit, respectively. The impedance does not go to infinity for any \\(s = j \\omega\\), indicating a finite \\(Q\\). The magnitude of \\(Z_{eq}\\) peaks near \\(\\omega = \\frac{1}{\\sqrt{L_1 C_1}}\\), but the actual resonance frequency is influenced by \\(R_S\\).\n\nThe circuit in Fig. 15.19(b) can be transformed into an equivalent topology that is easier to analyze and design. First, we consider the series combination shown in Fig. 15.20(a). For a narrow frequency range, this can be converted to the parallel configuration in Fig. 15.20(b).\n\nFigures 15.20(a) and (b) show the conversion of a series combination to a parallel combination. For the two impedances to be equivalent:\n\n\\[\nL_1 s + R_S = \\frac{R_P L_P s}{R_P + L_P s} \\tag{15.29}\n\\]\n\nAssuming \\(s = j \\omega\\) for the steady-state response, we can rewrite (15.29) as:\n\n\\[\n(L_1 R_P + L_P R_S) j \\omega + R_S R_P - L_1 L_P \\omega^2 = R_P L_P j \\omega \\tag{15.30}\n\\]\n\nThese relationships must hold for all values of \\(\\omega\\) in a narrow range, leading to:\n\n\\[\nL_1 R_P + L_P R_S = R_P L_P \\tag{15.31}\n\\]\n\\[\nR_S R_P - L_1 L_P \\omega^2 = 0 \\tag{15.32}\n\\]\n\nSolving for \\(R_P\\) and substituting it into the previous equation, we get:\n\n\\[\nL_P = L_1 \\left(1 + \\frac{R_S^2}{L_1^2 \\omega^2}\\right) \\tag{15.33}\n\\]\n\nRecall that \\(\\frac{L_1 \\omega}{R_S} = Q\\), which is typically greater than 3 for monolithic inductors. Thus:\n\n\\[\nL_P \\approx L_1 \\tag{15.34}\n\\]\n\\[\nR_P \\approx \\frac{L_1^2 \\omega^2}{R_S} \\approx Q^2 R_S \\tag{15.35}\n\\]\n\nIn other words, the parallel network has the same reactance but a resistance \\(Q^2\\) times the series resistance. This concept also applies to a first-order RC network if the \\(Q\\) of the series combination is defined as \\(\\frac{1}{(C \\omega) / R_S}\\).\n\nFigure 15.21 illustrates the conversion of a series LC tank circuit with a resistor into an equivalent parallel LC tank circuit with a resistor. The equivalence breaks down as \\(\\omega\\) departs significantly from the resonance frequency. At \\(\\omega_1 = \\frac{1}{\\sqrt{L_p C_p}}\\), the tank reduces to a simple resistor, and the phase difference between the voltage and current drops to zero. The magnitude of the tank impedance versus frequency is shown in Fig. 15.22(a), indicating inductive behavior for \\(\\omega < \\omega_1\\) and capacitive behavior for \\(\\omega > \\omega_1\\). The phase of the impedance is positive for \\(\\omega < \\omega_1\\) and negative for \\(\\omega > \\omega_1\\), as shown in Fig. 15.22(b). These observations are useful for studying LC oscillators.\n\nFigures 15.22(a) and (b) represent the magnitude and phase of the impedance of an LC tank as a function of frequency. The phase shift approaches \\(+90^\\circ\\) at very low frequencies and \\(-90^\\circ\\) at very high frequencies, reflecting the change from inductive to capacitive nature as frequency increases.\n\nNow, consider the \"tuned\" stage in Fig. 15.23(a), where an LC tank operates as the load. At resonance, \\(j L_p \\omega = \\frac{1}{j C_p \\omega}\\) and the voltage gain equals \\(-g_{m1} R_P\\). If the output is connected to the input [Fig. 15.23(b)], the circuit does not oscillate because the total phase shift around the loop is \\(180^\\circ\\) and the frequency-dependent phase shift of the tank never reaches \\(180^\\circ\\).\n\nIn the tuned gain stage of Fig. 15.23(a), if biased at a drain current \\(I_1\\) and the series resistance of \\(L_p\\) is small, the DC level of \\(V_{\\text{out}}\\) is close to \\(V_{DD}\\). If a small sinusoidal voltage at the resonance frequency is applied to the input, \\(V_{\\text{out}}\\) will be an inverted sinusoid with an average value near \\(V_{DD}\\). The peak output level can exceed \\(V_{DD}\\), which is an important attribute of the LC load. With proper design, the output peak-to-peak swing can be larger than \\(V_{DD}\\).\n\nFigure 15.24 illustrates the output signal levels in a tuned stage of an LC oscillator. The waveform is sinusoidal, indicating oscillatory behavior, and oscillates above and below the DC supply voltage \\(V_{DD}\\), demonstrating the circuit's capability to achieve a peak-to-peak swing larger than the supply voltage.\n\nWe now proceed to study two types of LC oscillators."
},
{
    "text": "Suppose we arrange two stages from Fig. 15.23(a) in a cascade, as illustrated in Fig. 15.25. Although this setup resembles the topology of Fig. 15.5, it avoids latch-up due to its minimal low-frequency gain. Moreover, at resonance, the overall phase shift around the loop is zero, as each stage introduces no frequency-dependent phase shift. Specifically, if $g_{m 1} R_{P} g_{m 2} R_{P} \\geq 1$, the loop will oscillate. Note that $V_{X}$ and $V_{Y}$ are differential waveforms. (Why?)\nimage_name:Figure 15.25\ndescription:\n[\nname: M1, type: NMOS, ports: {S: GND, D: X, G: Vout}\nname: M2, type: NMOS, ports: {S: GND, D: Y(Vout), G: X}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\nname: VDD, type: VoltageSource, value: VDD, ports: {Np: VDD, Nn: GND}\n]\nextrainfo:The circuit comprises two cascaded tuned amplifier stages using NMOS transistors M1 and M2. Each stage is connected to a parallel LC tank circuit (RP, LP, CP) for tuning. Vout is the output node, and the circuit is powered by VDD. The design aims to prevent latch-up by keeping a low-frequency gain and ensuring zero phase shift at resonance.\n\nFigure 15.25 Two tuned stages in a feedback loop.\n\n#### Example 15.5\n\nSketch the open-loop voltage gain and phase for the circuit in Fig. 15.25, ignoring transistor capacitances.\n\n#### Solution\n\nThe transfer function's magnitude resembles Fig. 15.22(a), but with steeper slopes due to the product of the two stages' responses. The total phase at low frequencies results from signal inversion by each common-source stage plus a $90^{\\circ}$ phase shift from each tank. High frequencies exhibit similar behavior. The gain and phase plots are shown in Fig. 15.26. These plots demonstrate that the circuit cannot oscillate at any other frequency.\nimage_name:|H1|\ndescription:The graph labeled \"|H1|\" is part of a set of Bode plots depicting the magnitude and phase characteristics of a transfer function. The specific graph for \"|H1|\" is a magnitude plot, showing the response of a single stage in the system.\n\n1. **Type of Graph and Function:**\n- This is a Bode plot representing the magnitude of a transfer function, specifically for a single stage labeled as \"|H1|\".\n\n2. **Axes Labels and Units:**\n- The horizontal axis represents angular frequency (ω) in radians per second, marked as ω₁ at the center.\n- The vertical axis represents the magnitude of the transfer function |H1|, likely in decibels (dB), though units are not specified.\n\n3. **Overall Behavior and Trends:**\n- The graph displays a resonant peak at frequency ω₁, indicating a bandpass characteristic.\n- The magnitude rises sharply to a peak at ω₁ and falls symmetrically on either side, suggesting a narrow bandwidth.\n\n4. **Key Features and Technical Details:**\n- The peak at ω₁ is the most significant feature, indicating the frequency of maximum gain.\n- The sharp rise and fall around ω₁ suggest a high Q-factor, typical of resonant circuits.\n\n5. **Annotations and Specific Data Points:**\n- The graph lacks specific numerical annotations, but the symmetry around ω₁ is crucial.\n\nThis description of \"|H1|\" is part of a composite analysis where multiple stages are combined to determine the overall system behavior, as shown in subsequent plots where |H2| and the product |H1 H2| are also analyzed alongside their phase characteristics.\nimage_name:|H2|\ndescription:The graph labeled |H2| is part of a series of plots showing the magnitude and phase characteristics of a two-stage system. The magnitude plot of |H2| is a Bode plot, depicting frequency response with the magnitude |H2| on the vertical axis and angular frequency \\( \\omega \\) on the horizontal axis. Both axes are likely logarithmic, typical for Bode plots. The graph shows a peak at a specific frequency \\( \\omega_1 \\), indicating a resonant frequency with maximum magnitude. This peak is sharp, suggesting a high Q-factor, typical of LC circuits.\n\nIn the phase plot for |H2|, the vertical axis represents phase in degrees, ranging from +90° to -90°, with the horizontal axis showing angular frequency \\( \\omega \\). The phase starts at +90° at low frequencies, transitions through 0° at the resonant frequency \\( \\omega_1 \\), and approaches -90° at high frequencies. This indicates a phase shift characteristic of a bandpass filter centered around \\( \\omega_1 \\).\n\nKey features include:\n- A sharp peak in the magnitude plot at \\( \\omega_1 \\), indicating resonance.\n- A phase shift from +90° to -90° through the resonant frequency \\( \\omega_1 \\).\n\nThe combined magnitude plot |H1H2| shows an even sharper peak at \\( \\omega_1 \\), resulting from the product of two similar resonant responses. The phase plot for the product |H1H2| shows a total phase shift from +180° to -180°, indicating the cumulative effect of the two stages in the system.\nimage_name:|H1H2|\ndescription:The graph includes two main parts: magnitude plots and phase plots for the transfer functions \\(|H_1|\\), \\(|H_2|\\), and their product \\(|H_1H_2|\\).\n\nMagnitude Plots:\n1. **\\(|H_1|\\) and \\(|H_2|\\):**\n- Both plots show a peak at frequency \\(\\omega_1\\), indicating resonance.\n- The shape is bell-like, with a sharp rise and fall around \\(\\omega_1\\), suggesting a narrow bandwidth.\n- The x-axis represents frequency \\(\\omega\\), likely logarithmic due to typical convention, though not explicitly marked.\n\n2. **\\(|H_1H_2|\\):**\n- The product of \\(|H_1|\\) and \\(|H_2|\\) results in a similar bell-shaped curve but with a sharper peak at \\(\\omega_1\\).\n- This indicates a more pronounced resonance at the same frequency due to the combined effect of both stages.\n\nPhase Plots:\n1. **\\(\\angle H_1\\) and \\(\\angle H_2\\):**\n- Both start at +90° at low frequencies and transition to -90° at high frequencies.\n- This indicates a phase shift of 180° across the frequency range, centered around \\(\\omega_1\\).\n\n2. **\\(\\angle H_1H_2\\):**\n- The combined phase plot starts at +180° and shifts to -180° as frequency increases, showing a total phase shift of 360°.\n- The transition is centered around \\(\\omega_1\\), similar to the individual phase plots.\n\nKey Features:\n- The resonance at \\(\\omega_1\\) is critical for both magnitude and phase responses.\n- The sharpness of the peaks in both magnitude and phase plots indicates high selectivity and narrow bandwidth, typical for LC oscillators.\n- The total phase shift of 360° confirms the conditions for sustained oscillations at \\(\\omega_1\\), aligning with the context that the circuit cannot oscillate at other frequencies.\nimage_name:∠H1\ndescription:The graph consists of two main parts, each depicting the characteristics of a transfer function and its phase response. Here is a detailed description of each part:\n\nMagnitude Response:\n1. **Type of Graph:**\n- The top row shows the magnitude response of the transfer functions, represented as Bode plots.\n\n2. **Axes Labels and Units:**\n- The horizontal axis represents angular frequency (ω), typically in radians per second.\n- The vertical axis represents the magnitude of the transfer functions |H₁| and |H₂|, as well as their product |H₁H₂|.\n\n3. **Overall Behavior and Trends:**\n- Each of the individual magnitude plots, |H₁| and |H₂|, shows a peak at a specific frequency ω₁, indicating resonance.\n- The product of the two, |H₁H₂|, also shows a peak at the same frequency ω₁, but with a sharper rise and fall, suggesting a higher Q factor or selectivity.\n- The plots are symmetric around ω₁, showing a bell-shaped curve typical of resonant circuits.\n\n4. **Key Features and Technical Details:**\n- The peak at ω₁ is the most significant feature, where the magnitude is maximized.\n- The symmetry and sharpness of the |H₁H₂| curve indicate the combined effect of the two stages.\n```"
},
{
    "text": "Suppose we connect two stages from Fig. 15.23(a) in a cascaded arrangement, as illustrated in Fig. 15.25. Although this setup resembles the topology of Fig. 15.5, it avoids latch-up due to its minimal low-frequency gain. Moreover, at resonance, the overall phase shift around the loop is zero, as each stage introduces no frequency-dependent phase shift. Specifically, if $g_{m1} R_{P} g_{m2} R_{P} \\geq 1$, the loop will oscillate. Note that $V_{X}$ and $V_{Y}$ are differential waveforms. (Why?)\nimage_name:Figure 15.25\ndescription:\n[\nname: M1, type: NMOS, ports: {S: GND, D: X, G: Vout}\nname: M2, type: NMOS, ports: {S: GND, D: Y(Vout), G: X}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\nname: VDD, type: VoltageSource, value: VDD, ports: {Np: VDD, Nn: GND}\n]\nextrainfo:The circuit comprises two cascaded tuned amplifier stages using NMOS transistors M1 and M2. Each stage is linked to a parallel LC tank circuit (RP, LP, CP) for tuning. Vout serves as the output node, and the circuit is powered by VDD. This design prevents latch-up by keeping a low-frequency gain and ensuring zero phase shift at resonance.\n\nFigure 15.25 Two tuned stages in a feedback loop.\n\n#### Example 15.5\n\nSketch the open-loop voltage gain and phase for the circuit shown in Fig. 15.25,忽略晶体管电容.\n\n#### Solution\n\nThe transfer function's magnitude resembles Fig. 15.22(a), but with steeper rise and fall due to the product of the two stages' responses. The total phase at low frequencies results from signal inversion by each common-source stage plus a $90^{\\circ}$ phase shift from each tank. High frequencies exhibit similar behavior. The gain and phase are depicted in Fig. 15.26. These plots demonstrate that the circuit cannot oscillate at any other frequency.\nimage_name:|H1|\ndescription:The graph labeled \"|H1|\" is part of a Bode plot set, showing the magnitude and phase characteristics of a transfer function. Specifically, \"|H1|\" is a magnitude plot for a single stage.\n\n1. **Graph Type and Function:**\n- This is a Bode plot representing the magnitude of a transfer function, labeled as \"|H1|\".\n\n2. **Axes Labels and Units:**\n- The horizontal axis is angular frequency (ω) in radians per second, with ω₁ at the center.\n- The vertical axis likely represents the magnitude in decibels (dB), though units are not specified.\n\n3. **Behavior and Trends:**\n- The graph exhibits a resonant peak at ω₁, indicating a bandpass characteristic.\n- The magnitude rises sharply to a peak at ω₁ and falls symmetrically, suggesting a narrow bandwidth.\n\n4. **Key Features and Technical Details:**\n- The peak at ω₁ signifies maximum gain.\n- The sharp rise and fall indicate a high Q-factor, typical of resonant circuits.\n\n5. **Annotations and Data Points:**\n- The graph lacks specific annotations but emphasizes symmetry around ω₁.\n\nThis description of \"|H1|\" contributes to a comprehensive analysis where multiple stages' combined effects are assessed, as shown in subsequent plots for |H2| and |H1H2|, including their phase characteristics.\nimage_name:|H2|\ndescription:The graph labeled |H2| is part of a series illustrating the magnitude and phase characteristics of a two-stage system. The magnitude plot for |H2| is a Bode plot, showing frequency response with the magnitude |H2| on the vertical axis and angular frequency \\( \\omega \\) on the horizontal axis. Both axes are likely logarithmic. The graph peaks at \\( \\omega_1 \\), indicating resonance with a high Q-factor.\n\nThe phase plot for |H2| shows phase in degrees (ranging from +90° to -90°) against angular frequency \\( \\omega \\). The phase starts at +90°, passes through 0° at \\( \\omega_1 \\), and approaches -90° at high frequencies, typical of a bandpass filter centered at \\( \\omega_1 \\).\n\nKey features include:\n- A sharp peak in the magnitude plot at \\( \\omega_1 \\), indicating resonance.\n- A phase shift from +90° to -90° through \\( \\omega_1 \\).\n\nThe combined magnitude plot |H1H2| shows a sharper peak at \\( \\omega_1 \\), resulting from the product of two similar resonant responses. The phase plot for |H1H2| shows a total phase shift from +180° to -180°, reflecting the cumulative effect of the two stages.\nimage_name:|H1H2|\ndescription:The graph includes magnitude and phase plots for the transfer functions \\(|H_1|\\), \\(|H_2|\\), and their product \\(|H_1H_2|\\).\n\nMagnitude Plots:\n1. **\\(|H_1|\\) and \\(|H_2|\\):**\n- Both plots peak at \\(\\omega_1\\), indicating resonance.\n- The bell-shaped curve suggests a narrow bandwidth.\n- The x-axis represents frequency \\(\\omega\\), likely logarithmic.\n\n2. **\\(|H_1H_2|\\):**\n- The product results in a sharper peak at \\(\\omega_1\\).\n- This indicates a more pronounced resonance from the combined stages.\n\nPhase Plots:\n1. **\\(\\angle H_1\\) and \\(\\angle H_2\\):**\n- Both start at +90° and transition to -90°, indicating a 180° phase shift centered at \\(\\omega_1\\).\n\n2. **\\(\\angle H_1H_2\\):**\n- The combined phase starts at +180° and shifts to -180°, showing a 360° phase shift centered at \\(\\omega_1\\).\n\nKey Features:\n- Resonance at \\(\\omega_1\\) is critical for both magnitude and phase.\n- The sharp peaks indicate high selectivity and narrow bandwidth.\n- The 360° phase shift confirms the conditions for sustained oscillations at \\(\\omega_1\\), aligning with the circuit's inability to oscillate at other frequencies.\nimage_name:∠H1\ndescription:The graph depicts the characteristics of a transfer function's magnitude and phase response.\n\nMagnitude Response:\n1. **Graph Type:**\n- The top row shows the magnitude response as Bode plots.\n\n2. **Axes Labels and Units:**\n- The horizontal axis is angular frequency (ω).\n- The vertical axis represents the magnitude of the transfer functions |H₁|, |H₂|, and |H₁H₂|.\n\n3. **Behavior and Trends:**\n- Individual plots |H₁| and |H₂| peak at ω₁, indicating resonance.\n- The product |H₁H₂| shows a sharper peak at ω₁, suggesting higher selectivity.\n- The plots are symmetric around ω₁, typical of resonant circuits.\n\n4. **Key Features and Technical Details:**\n- The peak at ω₁ is the most significant, indicating maximum magnitude.\n- The symmetry and sharpness of the |H₁H₂| curve highlight the combined effect of the stages."
},
{
    "text": "Imagine we connect two stages from Fig. 15.23(a) in a cascade, as shown in Fig. 15.25. Although this setup resembles the topology of Fig. 15.5, it avoids latch-up due to its minimal low-frequency gain. Moreover, at resonance, the overall phase shift around the loop is zero, as each stage introduces no frequency-dependent phase shift. Specifically, if $g_{m 1} R_{P} g_{m 2} R_{P} \\geq 1$, the loop will oscillate. Note that $V_{X}$ and $V_{Y}$ are differential waveforms. (Why?)\nimage_name:Figure 15.25\ndescription:\n[\nname: M1, type: NMOS, ports: {S: GND, D: X, G: Vout}\nname: M2, type: NMOS, ports: {S: GND, D: Y(Vout), G: X}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\nname: VDD, type: VoltageSource, value: VDD, ports: {Np: VDD, Nn: GND}\n]\nextrainfo:The circuit comprises two cascaded tuned amplifier stages using NMOS transistors M1 and M2. Each stage is linked to a parallel LC tank circuit (RP, LP, CP) for tuning. Vout serves as the output node, and the circuit is powered by VDD. This design prevents latch-up by keeping a low low-frequency gain and ensuring zero phase shift at resonance.\n\nFigure 15.25 Two tuned stages in a feedback loop.\n\n#### Example 15.5\n\nDraw the open-loop voltage gain and phase for the circuit in Fig. 15.25, ignoring transistor capacitances.\n\n#### Solution\n\nThe transfer function's magnitude resembles Fig. 15.22(a), but with steeper slopes due to the multiplication of the two stages' responses. The total phase at low frequencies results from the inversion by each common-source stage plus a $90^{\\circ}$ shift from each tank. High frequencies exhibit similar behavior. The gain and phase are illustrated in Fig. 15.26. These plots demonstrate that the circuit cannot oscillate at any other frequency.\nimage_name:|H1|\ndescription:The graph labeled \"|H1|\" is part of a set of Bode plots depicting the magnitude and phase characteristics of a transfer function. The specific graph for \"|H1|\" is a magnitude plot, showing the response of a single stage in the system.\n\n1. **Type of Graph and Function:**\n- This is a Bode plot representing the magnitude of a transfer function, specifically for a single stage labeled as \"|H1|\".\n\n2. **Axes Labels and Units:**\n- The horizontal axis represents angular frequency (ω) in radians per second, marked as ω₁ at the center.\n- The vertical axis represents the magnitude of the transfer function |H1|, likely in decibels (dB), though units are not specified.\n\n3. **Overall Behavior and Trends:**\n- The graph exhibits a resonant peak at frequency ω₁, indicating a bandpass characteristic.\n- The magnitude rises sharply to a peak at ω₁ and falls symmetrically on either side, suggesting a narrow bandwidth.\n\n4. **Key Features and Technical Details:**\n- The peak at ω₁ is the most significant feature, indicating the frequency of maximum gain.\n- The sharp rise and fall around ω₁ suggest a high Q-factor, typical of resonant circuits.\n\n5. **Annotations and Specific Data Points:**\n- The graph lacks specific numerical annotations, but the symmetry around ω₁ is crucial.\n\nThis description of \"|H1|\" is part of a composite analysis where multiple stages are combined to determine the overall system behavior, as shown in subsequent plots where |H2| and the product |H1 H2| are also analyzed alongside their phase characteristics.\nimage_name:|H2|\ndescription:The graph labeled |H2| is part of a series of plots illustrating the magnitude and phase characteristics of a two-stage system. The magnitude plot of |H2| is a Bode plot, showing frequency response with the magnitude |H2| on the vertical axis and angular frequency \\( \\omega \\) on the horizontal axis. Both axes are likely logarithmic, typical for Bode plots. The graph shows a peak at a specific frequency \\( \\omega_1 \\), indicating a resonant frequency where the magnitude is maximized. This peak is sharp, suggesting a high Q-factor, typical of LC circuits.\n\nIn the phase plot for |H2|, the vertical axis represents phase in degrees, ranging from +90° to -90°, while the horizontal axis is again the angular frequency \\( \\omega \\). The phase starts at +90° at low frequencies, transitions through 0° at the resonant frequency \\( \\omega_1 \\), and approaches -90° at high frequencies. This indicates a phase shift characteristic of a bandpass filter centered around \\( \\omega_1 \\).\n\nKey features include:\n- A sharp peak in the magnitude plot at \\( \\omega_1 \\), indicating resonance.\n- A phase shift from +90° to -90° through the resonant frequency \\( \\omega_1 \\).\n\nThe combined magnitude plot |H1H2| shows an even sharper peak at \\( \\omega_1 \\), resulting from the product of two similar resonant responses. The phase plot for the product |H1H2| shows a total phase shift from +180° to -180°, indicating the cumulative effect of the two stages in the system.\nimage_name:|H1H2|\ndescription:The graph consists of two main parts: magnitude plots and phase plots for the transfer functions \\(|H_1|\\), \\(|H_2|\\), and their product \\(|H_1H_2|\\).\n\nMagnitude Plots:\n1. **\\(|H_1|\\) and \\(|H_2|\\):**\n- Both plots show a peak at frequency \\(\\omega_1\\), indicating resonance.\n- The shape is bell-like, with a sharp rise and fall around \\(\\omega_1\\), suggesting a narrow bandwidth.\n- The x-axis represents frequency \\(\\omega\\), likely logarithmic due to typical convention, though not explicitly marked.\n\n2. **\\(|H_1H_2|\\):**\n- The product of \\(|H_1|\\) and \\(|H_2|\\) results in a similar bell-shaped curve but with a sharper peak at \\(\\omega_1\\).\n- This indicates a more pronounced resonance at the same frequency due to the combined effect of both stages.\n\nPhase Plots:\n1. **\\(\\angle H_1\\) and \\(\\angle H_2\\):**\n- Both start at +90° at low frequencies and transition to -90° at high frequencies.\n- This indicates a phase shift of 180° across the frequency range, centered around \\(\\omega_1\\).\n\n2. **\\(\\angle H_1H_2\\):**\n- The combined phase plot starts at +180° and shifts to -180° as frequency increases, showing a total phase shift of 360°.\n- The transition is centered around \\(\\omega_1\\), similar to the individual phase plots.\n\nKey Features:\n- Resonance at \\(\\omega_1\\) is critical for both magnitude and phase responses.\n- The sharpness of the peaks indicates high selectivity and narrow bandwidth, typical for LC oscillators.\n- The total phase shift of 360° confirms the conditions for sustained oscillations at \\(\\omega_1\\), aligning with the context that the circuit cannot oscillate at other frequencies.\nimage_name:∠H1\ndescription:The graph consists of two main parts, each depicting the characteristics of a transfer function and its phase response. Here is a detailed description of each part:\n\nMagnitude Response:\n1. **Type of Graph:**\n- The top row shows the magnitude response of the transfer functions, represented as Bode plots.\n\n2. **Axes Labels and Units:**\n- The horizontal axis represents angular frequency (ω), typically in radians per second.\n- The vertical axis represents the magnitude of the transfer functions |H₁| and |H₂|, as well as their product |H₁H₂|.\n\n3. **Overall Behavior and Trends:**\n- Each individual magnitude plot, |H₁| and |H₂|, shows a peak at a specific frequency ω₁, indicating resonance.\n- The product of the two, |H₁H₂|, also peaks at ω₁ but with a sharper rise and fall, suggesting a higher Q factor or selectivity.\n- The plots are symmetric around ω₁, showing a bell-shaped curve typical of resonant circuits.\n\n4. **Key Features and Technical Details:**\n- The peak at ω₁ is the most significant feature, where the magnitude is maximized.\n- The symmetry and sharpness of the |H₁H₂| curve indicate the combined effect of the two stages."
},
{
    "text": "Suppose we arrange two stages from Fig. 15.23(a) in a cascaded configuration, as illustrated in Fig. 15.25. This setup resembles the topology of Fig. 15.5 but avoids latch-up due to its minimal low-frequency gain. Moreover, at resonance, the overall phase shift around the loop is zero, as each stage introduces no frequency-dependent phase shift. Specifically, if $g_{m 1} R_{P} g_{m 2} R_{P} \\geq 1$, the loop will oscillate. Note that $V_{X}$ and $V_{Y}$ are differential waveforms. (Why?)\nimage_name:Figure 15.25\ndescription:\n[\nname: M1, type: NMOS, ports: {S: GND, D: X, G: Vout}\nname: M2, type: NMOS, ports: {S: GND, D: Y(Vout), G: X}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\nname: VDD, type: VoltageSource, value: VDD, ports: {Np: VDD, Nn: GND}\n]\nextrainfo:The circuit comprises two cascaded tuned amplifier stages utilizing NMOS transistors M1 and M2. Each stage is linked to a parallel LC tank circuit (RP, LP, CP) for tuning. Vout serves as the output node, and the circuit is powered by VDD. The design aims to prevent latch-up by keeping a low low-frequency gain and ensuring zero phase shift at resonance.\n\nFigure 15.25 Two tuned stages in a feedback loop.\n\n#### Example 15.5\n\nDraw the open-loop voltage gain and phase characteristics of the circuit shown in Fig. 15.25,忽略晶体管电容.\n\n#### Solution\n\nThe transfer function's magnitude resembles that in Fig. 15.22(a), but with steeper slopes due to the multiplication of the two stages' responses. The total phase at low frequencies results from the inversion by each common-source stage plus a $90^{\\circ}$ shift from each tank. High frequencies exhibit similar behavior. The gain and phase plots are depicted in Fig. 15.26. These plots demonstrate that the circuit cannot oscillate at any other frequency.\nimage_name:|H1|\ndescription:The graph labeled \"|H1|\" is part of a Bode plot set, showing the magnitude and phase traits of a transfer function. Specifically, \"|H1|\" is a magnitude plot for a single stage.\n\n1. **Graph Type and Function:**\n- This is a Bode plot for the magnitude of a transfer function, labeled as \"|H1|\".\n\n2. **Axes Labels and Units:**\n- The horizontal axis is angular frequency (ω) in radians per second, with ω₁ marked at the center.\n- The vertical axis likely represents the magnitude in decibels (dB), though units are not specified.\n\n3. **Behavior and Trends:**\n- The graph exhibits a resonant peak at ω₁, indicating a bandpass nature.\n- The magnitude rises steeply to a peak at ω₁ and falls symmetrically, suggesting a narrow bandwidth.\n\n4. **Key Features and Technical Details:**\n- The peak at ω₁ signifies maximum gain for the stage.\n- The sharp rise and fall indicate a high Q-factor, typical for resonant circuits.\n\n5. **Annotations and Data Points:**\n- The graph lacks specific annotations but emphasizes symmetry around ω₁.\n\nThis \"|H1|\" description contributes to a broader analysis where multiple stages combine to reveal the system's overall behavior, as seen in subsequent plots of |H2| and |H1H2|, including their phase characteristics.\nimage_name:|H2|\ndescription:The graph labeled |H2| is part of a series showing the magnitude and phase characteristics of a two-stage system. The magnitude plot of |H2| is a Bode plot, depicting frequency response with |H2| on the vertical axis and angular frequency \\( \\omega \\) on the horizontal axis. Both axes are likely logarithmic. The graph peaks at \\( \\omega_1 \\), indicating resonance with a high Q-factor.\n\nIn the phase plot for |H2|, the vertical axis shows phase in degrees, ranging from +90° to -90°, with \\( \\omega \\) on the horizontal axis. The phase starts at +90°, passes through 0° at \\( \\omega_1 \\), and ends at -90°, typical of a bandpass filter centered at \\( \\omega_1 \\).\n\nKey features include:\n- A sharp peak in the magnitude plot at \\( \\omega_1 \\), indicating resonance.\n- A phase shift from +90° to -90° through \\( \\omega_1 \\).\n\nThe combined magnitude plot |H1H2| shows a sharper peak at \\( \\omega_1 \\), resulting from the product of two similar resonant responses. The phase plot for |H1H2| shows a total phase shift from +180° to -180°, reflecting the cumulative effect of the two stages.\nimage_name:|H1H2|\ndescription:The graph includes magnitude and phase plots for the transfer functions \\(|H_1|\\), \\(|H_2|\\), and their product \\(|H_1H_2|\\).\n\nMagnitude Plots:\n1. **\\(|H_1|\\) and \\(|H_2|\\):**\n- Both plots peak at \\(\\omega_1\\), indicating resonance.\n- The bell-shaped curve with sharp rise and fall suggests a narrow bandwidth.\n- The x-axis represents frequency \\(\\omega\\), likely logarithmic.\n\n2. **\\(|H_1H_2|\\):**\n- The product plot shows a sharper peak at \\(\\omega_1\\).\n- This indicates a more pronounced resonance due to the combined stages.\n\nPhase Plots:\n1. **\\(\\angle H_1\\) and \\(\\angle H_2\\):**\n- Both start at +90° and end at -90°, indicating a 180° phase shift centered at \\(\\omega_1\\).\n\n2. **\\(\\angle H_1H_2\\):**\n- The combined phase starts at +180° and shifts to -180°, showing a 360° phase shift centered at \\(\\omega_1\\).\n\nKey Features:\n- Resonance at \\(\\omega_1\\) is crucial for both magnitude and phase.\n- Sharp peaks indicate high selectivity and narrow bandwidth.\n- The 360° phase shift confirms the conditions for sustained oscillations at \\(\\omega_1\\), aligning with the circuit's inability to oscillate at other frequencies.\nimage_name:∠H1\ndescription:The graph comprises two main sections, each detailing the characteristics of a transfer function and its phase response:\n\nMagnitude Response:\n1. **Graph Type:**\n- The top section shows the magnitude response of the transfer functions as Bode plots.\n\n2. **Axes Labels and Units:**\n- The horizontal axis represents angular frequency (ω).\n- The vertical axis shows the magnitude of the transfer functions |H₁|, |H₂|, and |H₁H₂|.\n\n3. **Behavior and Trends:**\n- Individual plots |H₁| and |H₂| peak at \\(\\omega_1\\), indicating resonance.\n- The product |H₁H₂| also peaks at \\(\\omega_1\\) but with a sharper profile, suggesting higher Q factor.\n- The plots are symmetric around \\(\\omega_1\\), typical of resonant circuits.\n\n4. **Key Features and Technical Details:**\n- The peak at \\(\\omega_1\\) is the most significant, indicating maximum magnitude.\n- The symmetry and sharpness of the |H₁H₂| curve highlight the combined effect of the stages.\n```"
},
{
    "text": "Suppose we cascade two stages from Fig. 15.23(a), as illustrated in Fig. 15.25. Although this setup resembles the topology of Fig. 15.5, it avoids latch-up due to its minimal low-frequency gain. Moreover, at resonance, the overall phase shift around the loop is zero, as each stage introduces no frequency-dependent phase shift. Specifically, if $g_{m1} R_{P} g_{m2} R_{P} \\geq 1$, the loop will oscillate. Note that $V_{X}$ and $V_{Y}$ are differential waveforms. (Why?)\nimage_name:Figure 15.25\ndescription:\n[\nname: M1, type: NMOS, ports: {S: GND, D: X, G: Vout}\nname: M2, type: NMOS, ports: {S: GND, D: Y(Vout), G: X}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\nname: VDD, type: VoltageSource, value: VDD, ports: {Np: VDD, Nn: GND}\n]\nextrainfo:The circuit comprises two cascaded tuned amplifier stages using NMOS transistors M1 and M2. Each stage is connected to a parallel LC tank circuit (RP, LP, CP) for tuning. Vout is the output node, and the circuit is powered by VDD. This design prevents latch-up by keeping a low-frequency gain and ensuring zero phase shift at resonance.\n\nFigure 15.25 Two tuned stages in a feedback loop.\n\n#### Example 15.5\n\nSketch the open-loop voltage gain and phase for the circuit in Fig. 15.25, ignoring transistor capacitances.\n\n#### Solution\n\nThe transfer function's magnitude resembles Fig. 15.22(a), but with steeper rise and fall due to the multiplication of the two stages' responses. The total phase at low frequencies results from the inversion by each common-source stage plus a $90^{\\circ}$ phase shift from each tank. High frequencies exhibit similar behavior. The gain and phase are depicted in Fig. 15.26. These plots demonstrate that the circuit cannot oscillate at any other frequency.\nimage_name:|H1|\ndescription:The graph labeled \"|H1|\" is part of a Bode plot set, showing the magnitude and phase characteristics of a transfer function. Specifically, \"|H1|\" is a magnitude plot for a single stage.\n\n1. **Graph Type and Function:**\n- This is a Bode plot for the magnitude of a transfer function, labeled as \"|H1|\".\n\n2. **Axes Labels and Units:**\n- The horizontal axis is angular frequency (ω) in radians per second, with ω₁ at the center.\n- The vertical axis likely represents the magnitude in decibels (dB), though units are not specified.\n\n3. **Behavior and Trends:**\n- The graph exhibits a resonant peak at ω₁, indicating a bandpass characteristic.\n- The magnitude increases sharply to a peak at ω₁ and decreases symmetrically, suggesting a narrow bandwidth.\n\n4. **Key Features and Technical Details:**\n- The peak at ω₁ signifies maximum gain.\n- The sharp rise and fall indicate a high Q-factor, typical of resonant circuits.\n\n5. **Annotations and Data Points:**\n- The graph lacks specific annotations, but symmetry around ω₁ is crucial.\n\nThis description of \"|H1|\" contributes to a composite analysis where multiple stages' responses are combined to understand the overall system behavior, as shown in subsequent plots for |H2| and the product |H1 H2|, along with their phase characteristics.\nimage_name:|H2|\ndescription:The graph labeled |H2| is part of a series showing the magnitude and phase characteristics of a two-stage system. The magnitude plot of |H2| is a Bode plot, depicting frequency response with the magnitude |H2| on the vertical axis and angular frequency \\( \\omega \\) on the horizontal axis. Both axes are likely logarithmic. The graph peaks at \\( \\omega_1 \\), indicating resonance with a high Q-factor.\n\nIn the phase plot for |H2|, the vertical axis shows phase in degrees, ranging from +90° to -90°, with the horizontal axis representing angular frequency \\( \\omega \\). The phase starts at +90°, passes through 0° at \\( \\omega_1 \\), and approaches -90° at high frequencies, typical of a bandpass filter.\n\nKey features include:\n- A sharp peak in the magnitude plot at \\( \\omega_1 \\).\n- A phase shift from +90° to -90° through \\( \\omega_1 \\).\n\nThe combined magnitude plot |H1H2| shows a sharper peak at \\( \\omega_1 \\), resulting from the product of two resonant responses. The phase plot for |H1H2| shows a total phase shift from +180° to -180°, indicating the cumulative effect of the two stages.\nimage_name:|H1H2|\ndescription:The graph includes magnitude and phase plots for the transfer functions \\(|H_1|\\), \\(|H_2|\\), and their product \\(|H_1H_2|\\).\n\nMagnitude Plots:\n1. **\\(|H_1|\\) and \\(|H_2|\\):**\n- Both plots peak at \\(\\omega_1\\), indicating resonance.\n- The bell-shaped curves suggest a narrow bandwidth.\n- The x-axis is frequency \\(\\omega\\), likely logarithmic.\n\n2. **\\(|H_1H_2|\\):**\n- The product plot shows a sharper peak at \\(\\omega_1\\).\n- This indicates a more pronounced resonance from the combined stages.\n\nPhase Plots:\n1. **\\(\\angle H_1\\) and \\(\\angle H_2\\):**\n- Both start at +90° and transition to -90°, indicating a 180° phase shift centered around \\(\\omega_1\\).\n\n2. **\\(\\angle H_1H_2\\):**\n- The combined phase plot starts at +180° and shifts to -180°, showing a 360° phase shift centered around \\(\\omega_1\\).\n\nKey Features:\n- Resonance at \\(\\omega_1\\) is critical for magnitude and phase responses.\n- Sharp peaks indicate high selectivity and narrow bandwidth.\n- The 360° phase shift confirms conditions for sustained oscillations at \\(\\omega_1\\), aligning with the circuit's inability to oscillate at other frequencies.\nimage_name:∠H1\ndescription:The graph depicts the characteristics of a transfer function and its phase response in two main parts:\n\nMagnitude Response:\n1. **Graph Type:**\n- The top row shows the magnitude response of the transfer functions as Bode plots.\n\n2. **Axes Labels and Units:**\n- The horizontal axis is angular frequency (ω).\n- The vertical axis represents the magnitude of |H₁|, |H₂|, and |H₁H₂|.\n\n3. **Behavior and Trends:**\n- Individual magnitude plots for |H₁| and |H₂| peak at \\(\\omega_1\\), indicating resonance.\n- The product |H₁H₂| also peaks at \\(\\omega_1\\) but with a sharper curve, suggesting higher selectivity.\n- The plots are symmetric around \\(\\omega_1\\), typical of resonant circuits.\n\n4. **Key Features and Technical Details:**\n- The peak at \\(\\omega_1\\) is the most significant, indicating maximum magnitude.\n- The symmetry and sharpness of the |H₁H₂| curve reflect the combined effect of the two stages."
},
{
    "text": "Imagine we connect two stages from Fig. 15.23(a) in a cascade, as illustrated in Fig. 15.25. Although this setup resembles the topology of Fig. 15.5, it avoids latch-up due to its minimal low-frequency gain. Moreover, at resonance, the overall phase shift around the loop is zero because each stage introduces no frequency-dependent phase shift. Specifically, if $g_{m 1} R_{P} g_{m 2} R_{P} \\geq 1$, the loop will oscillate. Note that $V_{X}$ and $V_{Y}$ are differential waveforms. (Why?)\nimage_name:Figure 15.25\ndescription:\n[\nname: M1, type: NMOS, ports: {S: GND, D: X, G: Vout}\nname: M2, type: NMOS, ports: {S: GND, D: Y(Vout), G: X}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\nname: VDD, type: VoltageSource, value: VDD, ports: {Np: VDD, Nn: GND}\n]\nextrainfo:The circuit comprises two cascaded tuned amplifier stages using NMOS transistors M1 and M2. Each stage is linked to a parallel LC tank circuit (RP, LP, CP) for tuning. Vout serves as the output node, and the circuit is powered by VDD. The design aims to prevent latch-up by keeping a low low-frequency gain and ensuring zero phase shift at resonance.\n\nFigure 15.25 Two tuned stages in a feedback loop.\n\n#### Example 15.5\n\nSketch the open-loop voltage gain and phase for the circuit shown in Fig. 15.25,忽略晶体管电容.\n\n#### Solution\n\nThe transfer function's magnitude resembles that in Fig. 15.22(a), but with steeper slopes due to the multiplication of the two stages' characteristics. The total phase at low frequencies results from signal inversion by each common-source stage plus a $90^{\\circ}$ phase shift from each tank. High frequencies exhibit similar behavior. The gain and phase plots are depicted in Fig. 15.26. These plots demonstrate that the circuit cannot oscillate at any other frequency.\nimage_name:|H1|\ndescription:The graph labeled \"|H1|\" is part of a set of Bode plots showing the magnitude and phase characteristics of a transfer function. The |H1| graph specifically depicts the magnitude response of a single stage.\n\n1. **Graph Type and Function:**\n- This is a Bode plot representing the magnitude of a transfer function, labeled as \"|H1|\".\n\n2. **Axes Labels and Units:**\n- The horizontal axis denotes angular frequency (ω) in radians per second, with ω₁ marked at the center.\n- The vertical axis represents the magnitude of the transfer function |H1|, presumably in decibels (dB), though units are not specified.\n\n3. **Behavior and Trends:**\n- The graph exhibits a resonant peak at ω₁, indicating a bandpass nature.\n- Magnitude rises sharply to a peak at ω₁ and falls symmetrically, suggesting a narrow bandwidth.\n\n4. **Key Features and Technical Details:**\n- The peak at ω₁ signifies the frequency of maximum gain.\n- The sharp rise and fall indicate a high Q-factor, typical for resonant circuits.\n\n5. **Annotations and Data Points:**\n- The graph lacks specific numerical annotations but emphasizes symmetry around ω₁.\n\nThis |H1| description contributes to a comprehensive analysis where multiple stages combine to determine overall system behavior, as shown in subsequent plots analyzing |H2| and the product |H1 H2| alongside their phase characteristics.\nimage_name:|H2|\ndescription:The |H2| graph is part of a series illustrating the magnitude and phase characteristics of a two-stage system. The magnitude plot of |H2| is a Bode plot, showing frequency response with the magnitude |H2| on the vertical axis and angular frequency \\( \\omega \\) on the horizontal axis. Both axes are likely logarithmic, typical for Bode plots. The graph peaks at \\( \\omega_1 \\), indicating resonance where magnitude is maximized. This peak is sharp, suggesting a high Q-factor, typical of LC circuits.\n\nIn the phase plot for |H2|, the vertical axis represents phase in degrees, ranging from +90° to -90°, with the horizontal axis showing angular frequency \\( \\omega \\). The phase starts at +90° at low frequencies, passes through 0° at \\( \\omega_1 \\), and approaches -90° at high frequencies, characteristic of a bandpass filter centered at \\( \\omega_1 \\).\n\nKey features include:\n- A sharp peak in the magnitude plot at \\( \\omega_1 \\), indicating resonance.\n- A phase shift from +90° to -90° through \\( \\omega_1 \\).\n\nThe combined magnitude plot |H1H2| shows an even sharper peak at \\( \\omega_1 \\), resulting from the product of two similar resonant responses. The phase plot for |H1H2| shows a total phase shift from +180° to -180°, reflecting the cumulative effect of the two stages.\nimage_name:|H1H2|\ndescription:The graph includes magnitude and phase plots for the transfer functions \\(|H_1|\\), \\(|H_2|\\), and their product \\(|H_1H_2|\\).\n\nMagnitude Plots:\n1. **\\(|H_1|\\) and \\(|H_2|\\):**\n- Both plots peak at \\( \\omega_1 \\), indicating resonance.\n- The bell-shaped curve with a sharp rise and fall suggests a narrow bandwidth.\n- The x-axis represents frequency \\( \\omega \\), likely logarithmic due to typical conventions.\n\n2. **\\(|H_1H_2|\\):**\n- The product results in a similar bell-shaped curve but with a sharper peak at \\( \\omega_1 \\).\n- This indicates a more pronounced resonance from the combined stages.\n\nPhase Plots:\n1. **\\(\\angle H_1\\) and \\(\\angle H_2\\):**\n- Both start at +90° at low frequencies and transition to -90° at high frequencies.\n- This indicates a 180° phase shift centered around \\( \\omega_1 \\).\n\n2. **\\(\\angle H_1H_2\\):**\n- The combined phase plot starts at +180° and shifts to -180°, showing a total phase shift of 360°.\n- The transition is centered around \\( \\omega_1 \\).\n\nKey Features:\n- Resonance at \\( \\omega_1 \\) is critical for both magnitude and phase responses.\n- The sharp peaks indicate high selectivity and narrow bandwidth, typical for LC oscillators.\n- The 360° phase shift confirms the conditions for sustained oscillations at \\( \\omega_1 \\), aligning with the context that the circuit cannot oscillate at other frequencies.\nimage_name:∠H1\ndescription:The graph depicts the characteristics of a transfer function and its phase response in two main parts:\n\nMagnitude Response:\n1. **Graph Type:**\n- The top row shows the magnitude response of the transfer functions as Bode plots.\n\n2. **Axes Labels and Units:**\n- The horizontal axis represents angular frequency (ω) in radians per second.\n- The vertical axis shows the magnitude of the transfer functions |H₁|, |H₂|, and |H₁H₂|.\n\n3. **Behavior and Trends:**\n- Individual magnitude plots |H₁| and |H₂| peak at \\( \\omega_1 \\), indicating resonance.\n- The product |H₁H₂| also peaks at \\( \\omega_1 \\) but with a sharper rise and fall, suggesting higher Q factor or selectivity.\n- The plots are symmetric around \\( \\omega_1 \\), typical of resonant circuits.\n\n4. **Key Features and Technical Details:**\n- The peak at \\( \\omega_1 \\) is the most significant, indicating maximum magnitude.\n- The symmetry and sharpness of the |H₁H₂| curve highlight the combined effect of the two stages."
},
{
    "text": "Consider positioning two stages from Fig. 15.23(a) in a cascade, as illustrated in Fig. 15.25. Although this setup resembles the topology of Fig. 15.5, it avoids latch-up due to its minimal low-frequency gain. Moreover, at resonance, the overall phase shift around the loop is zero, as each stage introduces no frequency-dependent phase shift. Specifically, if $g_{m 1} R_{P} g_{m 2} R_{P} \\geq 1$, the loop will oscillate. Note that $V_{X}$ and $V_{Y}$ are differential waveforms. (Why?)\nimage_name:Figure 15.25\ndescription:\n[\nname: M1, type: NMOS, ports: {S: GND, D: X, G: Vout}\nname: M2, type: NMOS, ports: {S: GND, D: Y(Vout), G: X}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\nname: VDD, type: VoltageSource, value: VDD, ports: {Np: VDD, Nn: GND}\n]\nextrainfo:The circuit comprises two cascaded tuned amplifier stages utilizing NMOS transistors M1 and M2. Each stage is linked to a parallel LC tank circuit (RP, LP, CP) for tuning. Vout serves as the output node, and the circuit is powered by VDD. This design prevents latch-up by keeping a low low-frequency gain and ensuring zero phase shift at resonance.\n\nFigure 15.25 Two tuned stages in a feedback loop.\n\n#### Example 15.5\n\nSketch the open-loop voltage gain and phase for the circuit in Fig. 15.25, ignoring transistor capacitances.\n\n#### Solution\n\nThe transfer function's magnitude resembles Fig. 15.22(a), but with steeper slopes due to the multiplication of the two stages' responses. The total phase at low frequencies results from the inversion by each common-source stage plus a $90^{\\circ}$ phase shift from each tank. High frequencies exhibit similar behavior. The gain and phase are depicted in Fig. 15.26. These plots demonstrate that the circuit cannot oscillate at any other frequency.\nimage_name:|H1|\ndescription:The graph labeled \"|H1|\" is part of a Bode plot set, showing the magnitude and phase characteristics of a transfer function. Specifically, \"|H1|\" is a magnitude plot for a single stage.\n\n1. **Graph Type and Function:**\n- This is a Bode plot representing the magnitude of a transfer function, labeled as \"|H1|\".\n\n2. **Axes Labels and Units:**\n- The horizontal axis is angular frequency (ω) in radians per second, with ω₁ at the center.\n- The vertical axis likely represents the magnitude in decibels (dB), though units are not specified.\n\n3. **Behavior and Trends:**\n- The graph exhibits a resonant peak at ω₁, indicating a bandpass characteristic.\n- The magnitude rises sharply to a peak at ω₁ and falls symmetrically, suggesting a narrow bandwidth.\n\n4. **Key Features and Technical Details:**\n- The peak at ω₁ is the most notable, indicating maximum gain.\n- The sharp rise and fall indicate a high Q-factor, typical of resonant circuits.\n\n5. **Annotations and Data Points:**\n- The graph lacks specific numerical annotations but emphasizes symmetry around ω₁.\n\nThis description of \"|H1|\" contributes to a comprehensive analysis where multiple stages combine to determine overall system behavior, as shown in subsequent plots of |H2| and |H1H2|, along with their phase characteristics.\nimage_name:|H2|\ndescription:The graph labeled |H2| is part of a series showing the magnitude and phase characteristics of a two-stage system. The magnitude plot of |H2| is a Bode plot, displaying frequency response with the magnitude |H2| on the vertical axis and angular frequency \\( \\omega \\) on the horizontal axis. Both axes are likely logarithmic, typical for Bode plots. The graph peaks at \\( \\omega_1 \\), indicating resonance where the magnitude is maximized. This peak is sharp, suggesting a high Q-factor, typical of LC circuits.\n\nIn the phase plot for |H2|, the vertical axis represents phase in degrees, ranging from +90° to -90°, with the horizontal axis as angular frequency \\( \\omega \\). The phase starts at +90° at low frequencies, passes through 0° at \\( \\omega_1 \\), and approaches -90° at high frequencies, characteristic of a bandpass filter centered at \\( \\omega_1 \\).\n\nKey features include:\n- A sharp peak in the magnitude plot at \\( \\omega_1 \\), indicating resonance.\n- A phase shift from +90° to -90° through \\( \\omega_1 \\).\n\nThe combined magnitude plot |H1H2| shows a sharper peak at \\( \\omega_1 \\), resulting from the product of two resonant responses. The phase plot for |H1H2| shows a total phase shift from +180° to -180°, indicating the cumulative effect of the two stages.\nimage_name:|H1H2|\ndescription:The graph includes magnitude and phase plots for the transfer functions \\(|H_1|\\), \\(|H_2|\\), and their product \\(|H_1H_2|\\).\n\nMagnitude Plots:\n1. **\\(|H_1|\\) and \\(|H_2|\\):**\n- Both plots peak at \\(\\omega_1\\), indicating resonance.\n- The bell-shaped curve with a sharp rise and fall suggests a narrow bandwidth.\n- The x-axis represents frequency \\(\\omega\\), likely on a logarithmic scale.\n\n2. **\\(|H_1H_2|\\):**\n- The product results in a similar bell-shaped curve but with a sharper peak at \\(\\omega_1\\).\n- This indicates a more pronounced resonance from the combined stages.\n\nPhase Plots:\n1. **\\(\\angle H_1\\) and \\(\\angle H_2\\):**\n- Both start at +90° at low frequencies and transition to -90° at high frequencies.\n- This indicates a 180° phase shift centered around \\(\\omega_1\\).\n\n2. **\\(\\angle H_1H_2\\):**\n- The combined phase plot starts at +180° and shifts to -180°, showing a 360° phase shift.\n- The transition is centered around \\(\\omega_1\\).\n\nKey Features:\n- Resonance at \\(\\omega_1\\) is critical for both magnitude and phase responses.\n- The sharp peaks indicate high selectivity and narrow bandwidth, typical for LC oscillators.\n- The 360° phase shift confirms the conditions for sustained oscillations at \\(\\omega_1\\), aligning with the circuit's inability to oscillate at other frequencies.\nimage_name:∠H1\ndescription:The graph comprises two main sections, each depicting the characteristics of a transfer function and its phase response.\n\nMagnitude Response:\n1. **Graph Type:**\n- The top section shows the magnitude response of the transfer functions as Bode plots.\n\n2. **Axes Labels and Units:**\n- The horizontal axis is angular frequency (ω), typically in radians per second.\n- The vertical axis represents the magnitude of the transfer functions |H₁|, |H₂|, and |H₁H₂|.\n\n3. **Behavior and Trends:**\n- Individual magnitude plots, |H₁| and |H₂|, peak at ω₁, indicating resonance.\n- The product, |H₁H₂|, also peaks at ω₁ but with a sharper rise and fall, suggesting higher selectivity.\n- The plots are symmetric around ω₁, typical of resonant circuits.\n\n4. **Key Features and Technical Details:**\n- The peak at ω₁ is the most significant, indicating maximum magnitude.\n- The symmetry and sharpness of the |H₁H₂| curve highlight the combined effect of the two stages."
},
{
    "text": "Suppose we cascade two stages from Fig. 15.23(a), as shown in Fig. 15.25. Although this setup resembles the topology of Fig. 15.5, it avoids latch-up due to its minimal low-frequency gain. Moreover, at resonance, the overall phase shift around the loop is zero, as each stage introduces no frequency-dependent phase shift. Specifically, if $g_{m 1} R_{P} g_{m 2} R_{P} \\geq 1$, the loop will oscillate. Note that $V_{X}$ and $V_{Y}$ are differential waveforms. (Why?)\nimage_name:Figure 15.25\ndescription:\n[\nname: M1, type: NMOS, ports: {S: GND, D: X, G: Vout}\nname: M2, type: NMOS, ports: {S: GND, D: Y(Vout), G: X}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\nname: VDD, type: VoltageSource, value: VDD, ports: {Np: VDD, Nn: GND}\n]\nextrainfo:The circuit comprises two cascaded tuned amplifier stages using NMOS transistors M1 and M2. Each stage is connected to a parallel LC tank circuit (RP, LP, CP) for tuning. Vout is the output node, and the circuit is powered by VDD. The design prevents latch-up by maintaining a low low-frequency gain and ensuring zero phase shift at resonance.\n\nFigure 15.25 Two tuned stages in a feedback loop.\n\n#### Example 15.5\n\nSketch the open-loop voltage gain and phase for the circuit in Fig. 15.25, ignoring transistor capacitances.\n\n#### Solution\n\nThe transfer function's magnitude resembles Fig. 15.22(a), but with steeper rise and fall due to the product of the two stages' responses. The total phase at low frequencies results from signal inversion by each common-source stage plus a $90^{\\circ}$ phase shift from each tank. High frequencies exhibit similar behavior. The gain and phase are illustrated in Fig. 15.26. These plots demonstrate that the circuit cannot oscillate at any other frequency.\nimage_name:|H1|\ndescription:The graph labeled \"|H1|\" is part of a set of Bode plots showing the magnitude and phase characteristics of a transfer function. Specifically, \"|H1|\" is a magnitude plot for a single stage.\n\n1. **Graph Type and Function:**\n- This is a Bode plot representing the magnitude of a transfer function, labeled as \"|H1|\".\n\n2. **Axes Labels and Units:**\n- The horizontal axis is angular frequency (ω) in radians per second, with ω₁ marked at the center.\n- The vertical axis likely represents the magnitude in decibels (dB), though units are not specified.\n\n3. **Behavior and Trends:**\n- The graph exhibits a resonant peak at ω₁, indicating a bandpass characteristic.\n- The magnitude rises sharply to a peak at ω₁ and symmetrically declines, suggesting a narrow bandwidth.\n\n4. **Key Features and Technical Details:**\n- The peak at ω₁ signifies maximum gain.\n- The sharp rise and fall indicate a high Q-factor, typical of resonant circuits.\n\n5. **Annotations and Data Points:**\n- The graph lacks specific numerical annotations but highlights symmetry around ω₁.\n\nThis description of \"|H1|\" contributes to a comprehensive analysis where multiple stages' responses are combined to understand the overall system behavior, as shown in subsequent plots for |H2| and |H1H2|, along with their phase characteristics.\nimage_name:|H2|\ndescription:The graph labeled |H2| is part of a series showing the magnitude and phase characteristics of a two-stage system. The magnitude plot for |H2| is a Bode plot, depicting frequency response with magnitude |H2| on the vertical axis and angular frequency \\( \\omega \\) on the horizontal axis. Both axes are likely logarithmic, typical for Bode plots. The graph peaks at \\( \\omega_1 \\), indicating resonance where magnitude is maximized. This peak is sharp, suggesting a high Q-factor typical of LC circuits.\n\nIn the phase plot for |H2|, the vertical axis represents phase in degrees, ranging from +90° to -90°, with the horizontal axis showing angular frequency \\( \\omega \\). The phase starts at +90° at low frequencies, passes through 0° at \\( \\omega_1 \\), and approaches -90° at high frequencies, characteristic of a bandpass filter centered at \\( \\omega_1 \\).\n\nKey features include:\n- A sharp peak in the magnitude plot at \\( \\omega_1 \\), indicating resonance.\n- A phase shift from +90° to -90° through \\( \\omega_1 \\).\n\nThe combined magnitude plot |H1H2| shows a sharper peak at \\( \\omega_1 \\), resulting from the product of two similar resonant responses. The phase plot for |H1H2| shows a total phase shift from +180° to -180°, reflecting the cumulative effect of the two stages.\nimage_name:|H1H2|\ndescription:The graph includes magnitude and phase plots for the transfer functions \\(|H_1|\\), \\(|H_2|\\), and their product \\(|H_1H_2|\\).\n\nMagnitude Plots:\n1. **\\(|H_1|\\) and \\(|H_2|\\):**\n- Both plots peak at \\( \\omega_1 \\), indicating resonance.\n- The bell-shaped curve with a sharp rise and fall suggests a narrow bandwidth.\n- The x-axis represents frequency \\( \\omega \\), likely on a logarithmic scale.\n\n2. **\\(|H_1H_2|\\):**\n- The product plot shows a similar bell shape but with a sharper peak at \\( \\omega_1 \\).\n- This indicates a more pronounced resonance from the combined stages.\n\nPhase Plots:\n1. **\\(\\angle H_1\\) and \\(\\angle H_2\\):**\n- Both start at +90° at low frequencies and transition to -90° at high frequencies.\n- This indicates a 180° phase shift centered around \\( \\omega_1 \\).\n\n2. **\\(\\angle H_1H_2\\):**\n- The combined phase plot ranges from +180° to -180°, showing a total phase shift of 360°.\n- The transition is centered at \\( \\omega_1 \\), similar to the individual phase plots.\n\nKey Features:\n- Resonance at \\( \\omega_1 \\) is critical for both magnitude and phase responses.\n- The sharp peaks indicate high selectivity and narrow bandwidth, typical for LC oscillators.\n- The 360° phase shift confirms the conditions for sustained oscillations at \\( \\omega_1 \\), aligning with the circuit's inability to oscillate at other frequencies.\nimage_name:∠H1\ndescription:The graph features two main parts, each depicting the characteristics of a transfer function and its phase response. Here's a detailed description:\n\nMagnitude Response:\n1. **Graph Type:**\n- The top row shows the magnitude response of the transfer functions as Bode plots.\n\n2. **Axes Labels and Units:**\n- The horizontal axis represents angular frequency (ω), typically in radians per second.\n- The vertical axis shows the magnitude of the transfer functions |H₁|, |H₂|, and |H₁H₂|.\n\n3. **Behavior and Trends:**\n- Individual plots |H₁| and |H₂| peak at \\( \\omega_1 \\), indicating resonance.\n- The product |H₁H₂| also peaks at \\( \\omega_1 \\), but with a steeper rise and fall, suggesting higher selectivity.\n- The plots are symmetric around \\( \\omega_1 \\), typical of resonant circuits.\n\n4. **Key Features and Technical Details:**\n- The peak at \\( \\omega_1 \\) is the most significant, indicating maximum magnitude.\n- The symmetry and sharpness of the |H₁H₂| curve reflect the combined effect of the two stages."
},
{
    "text": "1. **Graph Type:**\n- The bottom row illustrates the phase response of the transfer functions, also depicted as Bode plots.\n\n2. **Axes Labels and Units:**\n- The horizontal axis again denotes angular frequency (ω).\n- The vertical axis represents the phase angle in degrees.\n\n3. **General Behavior and Trends:**\n- Each individual phase plot, ∠H₁ and ∠H₂, initiates at +90° at low frequencies and transitions to -90° at high frequencies, crossing 0° at ω₁.\n- The combined phase response, ∠H₁H₂, starts at +180° and shifts to -180° through ω₁, maintaining a similar transition shape but with a doubled phase shift due to the multiplication of the two functions.\n\n4. **Key Features and Technical Aspects:**\n- The 0° crossing (for ∠H₁ and ∠H₂) and the 180° crossing (for ∠H₁H₂) at ω₁ are critical, indicating the phase shift at resonance.\n- The phase response illustrates the inversion and phase shift introduced by each stage and their combined effect.\n\n5. **Annotations and Specific Data Points:**\n- The frequency ω₁ is marked as a critical point for both magnitude and phase responses, signifying the resonance point and maximum phase shift.\nimage_name:∠H2\ndescription:The graph titled \"∠H2\" is part of a series of plots depicting the loop gain characteristics of a circuit. It is a Bode plot focusing on the phase response of the transfer function.\n\n1. **Graph Type and Function:**\n- This is a Bode plot, specifically illustrating the phase response of a transfer function.\n\n2. **Axes Labels and Units:**\n- The horizontal axis represents angular frequency (ω), typically measured in radians per second.\n- The vertical axis depicts the phase angle in degrees.\n\n3. **General Behavior and Trends:**\n- The plot shows a phase response starting at +90 degrees at low frequencies.\n- As the frequency increases, the phase decreases, passing through 0 degrees at a specific point, and continues to decrease to -90 degrees at high frequencies.\n\n4. **Key Features and Technical Aspects:**\n- The phase shift begins at +90 degrees and transitions smoothly to -90 degrees.\n- This behavior is typical for a second-order system, where each stage contributes a +90 to -90 degree phase shift.\n- The transition occurs around the resonant frequency ω1, which is marked on the plot.\n- The total phase shift at resonance is 180 degrees, indicating that the circuit meets the phase condition for oscillation at this frequency.\n\n5. **Annotations and Specific Data Points:**\n- The critical frequency ω1 is marked as the point where the phase shift changes rapidly.\n- The plot does not explicitly show numerical values for ω1 but indicates its position relative to the phase shift.\n- The sum of the phase contributions from two stages (each contributing a phase shift similar to ∠H2) results in a total phase shift of +180 degrees at low frequencies and -180 degrees at high frequencies, as shown in the combined plot ∠H1H2.\n\nThis phase response is essential for understanding the stability and oscillation conditions of the circuit, as it demonstrates that the circuit can only oscillate at the designated frequency ω1 due to the specific phase shift behavior.\nimage_name:∠H1H2\ndescription:The graph titled \"∠H1H2\" is a Bode plot, comprising two main sections: magnitude and phase response, each with multiple subplots.\n\n1. **Magnitude Response**:\n- **Graph Type**: The magnitude plots are presented as frequency response curves.\n- **Axes Labels and Units**: The horizontal axis represents frequency (ω), likely in a logarithmic scale, though not explicitly marked. The vertical axis shows the magnitude of the transfer functions |H1|, |H2|, and their product |H1H2|.\n- **General Behavior and Trends**:\n- Each individual magnitude plot, |H1| and |H2|, exhibits a peak at a specific frequency ω1, indicating resonance. These plots are symmetrical and bell-shaped, typical of a bandpass filter.\n- The product |H1H2| also displays a similar bell-shaped curve with a sharper peak at ω1, due to the multiplication of the two responses.\n- **Key Features and Technical Aspects**: The peak at ω1 signifies the frequency of maximum gain, and the sharpness of the peak in |H1H2| indicates a narrow bandwidth.\n\n2. **Phase Response**:\n- **Graph Type**: The phase plots are depicted as phase shift curves.\n- **Axes Labels and Units**: The horizontal axis is the same as the magnitude plots, representing frequency (ω). The vertical axis denotes the phase shift in degrees.\n- **General Behavior and Trends**:\n- The phase plots for ∠H1 and ∠H2 each start at +90° and decrease to -90° as frequency increases, with a smooth transition around ω1.\n- The combined phase plot ∠H1H2 starts at +180° and decreases to -180°, showing a similar smooth transition around ω1.\n- **Key Features and Technical Aspects**: The phase plots indicate a total phase shift of 360° (from +180° to -180°) across the frequency range, crucial for determining the system's stability and oscillation conditions.\n\n3. **Annotations and Specific Data Points**:\n- The plots are marked with the resonant frequency ω1, highlighting the frequency of interest.\n- The phase shift values are explicitly marked at +90°, -90°, +180°, and -180°, providing clear reference points for analysis.\n\nOverall, the graph depicts the combined magnitude and phase response of a system characterized by two stages, each contributing to the overall behavior observed in the product response |H1H2| and ∠H1H2|. The sharp peaks and phase shifts are indicative of the system's selective frequency amplification and phase characteristics, crucial for understanding the circuit's oscillation conditions.\n\nFigure 15.26 Loop gain characteristics of the circuit shown in Fig. 15.25.\n\nThe circuit in Fig. 15.25 serves as the core for many LC oscillators and is sometimes depicted as in Fig. 15.27(a) or (b). However, the drain currents of $M_{1}$ and $M_{2}$, and thus the output swings, heavily rely on the supply voltage. Since the waveforms at $X$ and $Y$ are differential, Fig. 15.27(b) suggests that $M_{1}$ and $M_{2}$ can be converted to a differential pair as shown in Fig. 15.27(c), where the total bias current is defined by $I_{S S}$.\n\n#### Example 15.6\n\nFor the circuit in Fig. 15.27(c), plot $V_{X}$, $V_{Y}$, $I_{D 1}$, and $I_{D 2}$ as the oscillation begins.\nimage_name:(a)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: GND, D: X, G: Y}\nname: M2, type: NMOS, ports: {S: GND, D: Y, G: X}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\n]\nextrainfo:The circuit is a differential oscillator with two NMOS transistors M1 and M2, forming a cross-coupled pair. Capacitors CP, resistors RP, and inductors LP form the resonant tank circuits connected to VDD. Nodes X and Y are the differential outputs, grounded at the source of both transistors.\n\nimage_name:(b)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: GND, D: X, G: Y}\nname: M2, type: NMOS, ports: {S: GND, D: Y, G: X}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\n]\nextrainfo:The circuit is a differential oscillator with two NMOS transistors M1 and M2, forming a cross-coupled pair. Capacitors CP, resistors RP, and inductors LP form the resonant tank circuits connected to VDD. Nodes X and Y are the differential outputs, grounded at the source of both transistors.\n\nimage_name:(c)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: P, D: X, G: Y}\nname: M2, type: NMOS, ports: {S: P, D: Y, G: X}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\nname: ISS, type: CurrentSource, value: ISS, ports: {Np: P, Nn: GND}\n]\nextrainfo:The circuit is a differential oscillator with two NMOS transistors M1 and M2, forming a cross-coupled pair. Capacitors CP, resistors RP, and inductors LP form the resonant tank circuits connected to VDD. Nodes X and Y are the differential outputs, grounded at the source of both transistors. The tail current source ISS is used to reduce supply sensitivity.\n\nFigure 15.27 (a) Redrawing of the oscillator shown in Fig. 15.25; (b) another redrawing of the circuit; (c) addition of tail current source to reduce supply sensitivity.\n\n#### Solution\n\nIf the circuit starts with no difference between $V_{X}$ and $V_{Y}$, then $V_{X}=V_{Y} \\approx V_{D D}$. The two transistors equally share the tail current. If $\\left(g_{m 1,2} R_{P}\\right)^{2} \\geq 1$, where $R_{P}$ is the equivalent parallel resistance of the tank at resonance, noise components at the resonant frequency are amplified by $M_{1}$ and $M_{2}$, allowing the oscillation to grow. The drain currents of $M_{1}$ and $M_{2}$ vary based on the instantaneous value of $V_{X}-V_{Y}$ (as in a differential pair).\n\nAs shown in Fig. 15.28, the oscillation amplitude increases until the loop gain decreases at the peaks. In fact, if $g_{m 1,2} R_{P}$ is sufficiently large, the difference between $V_{X}-V_{Y}$ reaches a level that directs the entire tail current to one transistor, turning the other off. Thus, in the steady state, $I_{D 1}$ and $I_{D 2}$ vary between zero and $I_{S S}$.\nimage_name:Figure 15.28\ndescription:The graph in Figure 15.28 illustrates the time-domain waveforms of voltages $V_X$ and $V_Y$, and drain currents $I_{D1}$ and $I_{D2}$ over time. The horizontal axis represents time ($t$), while the vertical axis is used for both voltage and current, though not explicitly labeled with units.\n\n1. **Graph Type and Function**: This is a time-domain waveform graph showing oscillations in voltages and currents.\n\n2. **Axes Labels and Units**: The horizontal axis is labeled with time ($t$), with no specific time units provided. The vertical axis has two references: $V_{DD}$ for voltages $V_X$ and $V_Y$, and $I_{SS}/2$ for currents $I_{D1}$ and $I_{D2}$. The units for voltage and current are not specified but are likely in volts and amperes, respectively.\n\n3. **General Behavior and Trends**: The graph shows that both $V_X$ and $V_Y$ start with small oscillations around $V_{DD}$ and increase in amplitude over time. Similarly, $I_{D1}$ and $I_{D2}$ oscillate around $I_{SS}/2$ with increasing amplitude. The oscillations for both voltage and current appear sinusoidal and symmetric, indicating stable oscillatory behavior as time progresses.\n\n4. **Key Features and Technical Aspects**: The key feature is the increasing amplitude of oscillations for both voltage and current over time, suggesting a growing oscillation amplitude until a steady state is reached, characteristic of an oscillator circuit as described. The oscillations reach a point where the loop gain decreases at the peaks, stabilizing the amplitude.\n\n5. **Annotations and Specific Data Points**: The diagram includes annotations for $V_X$, $V_Y$, $I_{D1}$, and $I_{D2}$, with reference lines at $V_{DD}$ and $I_{SS}/2$. These reference lines help visualize the oscillations around these central values. No specific numerical values or markers are provided for peaks or troughs.\n\nFigure 15.28\n\nThe oscillator in Fig. 15.27(c) is designed in a fully differential form. However, the circuit's supply sensitivity is nonzero even with perfect symmetry. This is due to the variation of the drain junction capacitances of $M_{1}$ and $M_{2}$ with the supply voltage. We address this issue further in Example 15.9."
},
{
    "text": "1. **Graph Type:**\n- The lower row displays the phase response of the transfer functions, also depicted as Bode plots.\n\n2. **Axes Labels and Units:**\n- The horizontal axis represents angular frequency (ω).\n- The vertical axis indicates phase angle in degrees.\n\n3. **Overall Behavior and Trends:**\n- Each individual phase plot, ∠H₁ and ∠H₂, begins at +90° at low frequencies and transitions to -90° at high frequencies, crossing 0° at ω₁.\n- The combined phase response, ∠H₁H₂, starts at +180° and shifts to -180° through ω₁, maintaining a similar transition shape but with a doubled phase shift due to the multiplication of the two functions.\n\n4. **Key Features and Technical Details:**\n- The crossing at 0° (for ∠H₁ and ∠H₂) and at 180° (for ∠H₁H₂) at ω₁ is crucial, indicating the phase shift at resonance.\n- The phase response shows the inversion and phase shift introduced by each stage and their cumulative effect.\n\n5. **Annotations and Specific Data Points:**\n- The frequency ω₁ is marked as a critical point for both magnitude and phase responses, signifying the resonance point and maximum phase shift.\nimage_name:∠H2\ndescription:The graph titled \"∠H2\" is part of a series of plots depicting the loop gain characteristics of a circuit. It is a Bode plot focusing on the phase response of the transfer function.\n\n1. **Graph Type and Function:**\n- This is a Bode plot, specifically illustrating the phase response of a transfer function.\n\n2. **Axes Labels and Units:**\n- The horizontal axis represents angular frequency (ω), typically measured in radians per second.\n- The vertical axis indicates phase angle, measured in degrees.\n\n3. **Overall Behavior and Trends:**\n- The plot shows a phase response starting at +90 degrees at low frequencies.\n- As frequency increases, the phase decreases, passing through 0 degrees at a specific point, and continues to decrease to -90 degrees at high frequencies.\n\n4. **Key Features and Technical Details:**\n- The phase shift starts at +90 degrees and transitions smoothly to -90 degrees.\n- This behavior is typical for a second-order system, where each stage contributes a +90 to -90 degree phase shift.\n- The transition occurs around the resonant frequency ω1, which is marked on the plot.\n- The total phase shift at resonance is 180 degrees, indicating the circuit meets the phase condition for oscillation at this frequency.\n\n5. **Annotations and Specific Data Points:**\n- The critical frequency ω1 is marked as the point where the phase shift changes rapidly.\n- The plot does not explicitly show numerical values for ω1 but indicates its position relative to the phase shift.\n- The combined phase contributions from two stages (each similar to ∠H2) result in a total phase shift of +180 degrees at low frequencies and -180 degrees at high frequencies, as shown in the combined plot ∠H1H2.\n\nThis phase response is essential for understanding the stability and oscillation conditions of the circuit, demonstrating that the circuit can only oscillate at the designated frequency ω1 due to the specific phase shift behavior.\nimage_name:∠H1H2\ndescription:The graph titled \"∠H1H2\" is a Bode plot, consisting of two main sections: magnitude and phase response, each with multiple subplots.\n\n1. **Magnitude Response**:\n- **Graph Type**: The magnitude plots are shown as frequency response curves.\n- **Axes Labels and Units**: The horizontal axis represents frequency (ω), likely in a logarithmic scale, though not explicitly marked. The vertical axis represents the magnitude of the transfer functions |H1|, |H2|, and their product |H1H2|.\n- **Overall Behavior and Trends**:\n- Each individual magnitude plot, |H1| and |H2|, shows a peak at a specific frequency ω1, indicating a resonant frequency. These plots are symmetrical and bell-shaped, typical of a bandpass filter.\n- The product |H1H2| also shows a similar bell-shaped curve with a sharper peak at the same frequency ω1, due to the multiplication of the two responses.\n- **Key Features and Technical Details**: The peak at ω1 signifies the frequency at which the system has maximum gain, and the sharpness of the peak in |H1H2| indicates a narrow bandwidth.\n\n2. **Phase Response**:\n- **Graph Type**: The phase plots are shown as phase shift curves.\n- **Axes Labels and Units**: The horizontal axis is the same as the magnitude plots, representing frequency (ω). The vertical axis represents phase shift in degrees.\n- **Overall Behavior and Trends**:\n- The phase plots for ∠H1 and ∠H2 each start at +90° and decrease to -90° as frequency increases, with a smooth transition around ω1.\n- The combined phase plot ∠H1H2 starts at +180° and decreases to -180°, showing a similar smooth transition around ω1.\n- **Key Features and Technical Details**: The phase plots indicate a total phase shift of 360° (from +180° to -180°) across the frequency range, critical for determining the stability and oscillation conditions of the system.\n\n3. **Annotations and Specific Data Points**:\n- The plots are marked with the resonant frequency ω1, highlighting the frequency of interest.\n- The phase shift values are explicitly marked at +90°, -90°, +180°, and -180°, providing clear reference points for analysis.\n\nOverall, the graph illustrates the combined magnitude and phase response of a system characterized by two stages, each contributing to the overall behavior observed in the product response |H1H2| and ∠H1H2. The sharp peaks and phase shifts are indicative of the system's selective frequency amplification and phase characteristics, crucial for understanding the oscillation conditions of the circuit in question.\n\nFigure 15.26 Loop gain characteristics of the circuit shown in Fig. 15.25.\n\nThe circuit of Fig. 15.25 serves as the core of many LC oscillators and is sometimes drawn as in Fig. 15.27(a) or (b). However, the drain currents of $M_{1}$ and $M_{2}$, and hence the output swings, heavily depend on the supply voltage. Since the waveforms at $X$ and $Y$ are differential, the drawing in Fig. 15.27(b) suggests that $M_{1}$ and $M_{2}$ can be converted to a differential pair as depicted in Fig. 15.27(c), where the total bias current is defined by $I_{S S}$.\n\n#### Example 15.6\n\nFor the circuit of Fig. 15.27(c), plot $V_{X}$ and $V_{Y}$ and $I_{D 1}$ and $I_{D 2}$ as the oscillation begins.\nimage_name:(a)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: GND, D: X, G: Y}\nname: M2, type: NMOS, ports: {S: GND, D: Y, G: X}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\n]\nextrainfo:The circuit is a differential oscillator with two NMOS transistors M1 and M2, each forming a cross-coupled pair. The capacitors CP, resistors RP, and inductors LP are used to form the resonant tank circuits connected to VDD. The nodes X and Y are the differential outputs, and the circuit is grounded at the source of both transistors.\n\nimage_name:(b)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: GND, D: X, G: Y}\nname: M2, type: NMOS, ports: {S: GND, D: Y, G: X}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\n]\nextrainfo:The circuit is a differential oscillator with two NMOS transistors M1 and M2, forming a cross-coupled pair. Capacitors CP, resistors RP, and inductors LP form the resonant tank circuits connected to VDD. Nodes X and Y are the differential outputs, grounded at the source of both transistors.\n\nimage_name:(c)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: P, D: X, G: Y}\nname: M2, type: NMOS, ports: {S: P, D: Y, G: X}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\nname: ISS, type: CurrentSource, value: ISS, ports: {Np: P, Nn: GND}\n]\nextrainfo:The circuit is a differential oscillator with two NMOS transistors M1 and M2, forming a cross-coupled pair. Capacitors CP, resistors RP, and inductors LP form the resonant tank circuits connected to VDD. Nodes X and Y are the differential outputs, grounded at the source of both transistors. The tail current source ISS is used to lower supply sensitivity.\n\nFigure 15.27 (a) Redrawing of the oscillator shown in Fig. 15.25; (b) another redrawing of the circuit; (c) addition of tail current source to lower supply sensitivity.\n\n#### Solution\n\nIf the circuit starts with zero difference between $V_{X}$ and $V_{Y}$, then $V_{X}=V_{Y} \\approx V_{D D}$. The two transistors share the tail current equally. If $\\left(g_{m 1,2} R_{P}\\right)^{2} \\geq 1$, where $R_{P}$ is the equivalent parallel resistance of the tank at resonance, then noise components at the resonance frequency are amplified by $M_{1}$ and $M_{2}$, allowing the oscillation to grow. The drain currents of $M_{1}$ and $M_{2}$ vary according to the instantaneous value of $V_{X}-V_{Y}$ (as in a differential pair).\n\nAs shown in Fig. 15.28, the oscillation amplitude increases until the loop gain decreases at the peaks. In fact, if $g_{m 1,2} R_{P}$ is large enough, the difference between $V_{X}-V_{Y}$ reaches a level that directs the entire tail current to one transistor, turning the other off. Thus, in the steady state, $I_{D 1}$ and $I_{D 2}$ vary between zero and $I_{S S}$.\nimage_name:Figure 15.28\ndescription:The graph in Figure 15.28 is a time-domain waveform illustrating the behavior of voltages $V_X$ and $V_Y$, and drain currents $I_{D1}$ and $I_{D2}$ over time. The horizontal axis represents time ($t$), while the vertical axis is used for both voltage and current, though not explicitly labeled with units.\n\n1. **Graph Type and Function**: This is a time-domain waveform graph showing oscillations in voltages and currents.\n\n2. **Axes Labels and Units**: The horizontal axis is labeled with time ($t$), but no specific time units are provided. The vertical axis has two references: $V_{DD}$ for the voltages $V_X$ and $V_Y$, and $I_{SS}/2$ for the currents $I_{D1}$ and $I_{D2}$. The units for voltage and current are not specified but are likely in volts and amperes, respectively.\n\n3. **Overall Behavior and Trends**: The graph shows that both $V_X$ and $V_Y$ start with small oscillations around $V_{DD}$ and grow in amplitude over time. Similarly, $I_{D1}$ and $I_{D2}$ oscillate around $I_{SS}/2$ with increasing amplitude. The oscillations for both voltage and current appear sinusoidal and symmetric, indicating a stable oscillatory behavior as time progresses.\n\n4. **Key Features and Technical Details**: The key feature is the increasing amplitude of oscillations for both voltage and current over time. This suggests a growing oscillation amplitude until a steady state is reached, which is characteristic of an oscillator circuit as described in the context. The oscillations reach a point where the loop gain drops at the peaks, stabilizing the amplitude.\n\n5. **Annotations and Specific Data Points**: The diagram includes annotations for $V_X$, $V_Y$, $I_{D1}$, and $I_{D2}$, with reference lines at $V_{DD}$ and $I_{SS}/2$. These reference lines help in visualizing the oscillations around these central values. No specific numerical values or markers are provided for peaks or troughs.\n\nFigure 15.28\n\nThe oscillator of Fig. 15.27(c) is constructed in fully differential form. The supply sensitivity of the circuit, however, is nonzero even with perfect symmetry. This is because the drain junction capacitances of $M_{1}$ and $M_{2}$ vary with the supply voltage. We return to this issue in Example 15.9."
},
{
    "text": "1. **Graph Type:**\n- The bottom row illustrates the phase response of the transfer functions, depicted as Bode plots.\n\n2. **Axes Labels and Units:**\n- The horizontal axis represents angular frequency (ω).\n- The vertical axis measures phase angle in degrees.\n\n3. **Behavior and Trends:**\n- Individual phase plots, ∠H₁ and ∠H₂, transition from +90° at low frequencies to -90° at high frequencies, crossing 0° at ω₁.\n- The combined phase response, ∠H₁H₂, shifts from +180° to -180° through ω₁, exhibiting a similar transition but with doubled phase shift due to function multiplication.\n\n4. **Key Features and Technical Details:**\n- The 0° crossing (for ∠H₁ and ∠H₂) and 180° crossing (for ∠H₁H₂) at ω₁ are critical, indicating resonance phase shift.\n- The phase response shows the inversion and cumulative phase shift introduced by each stage.\n\n5. **Annotations and Specific Data Points:**\n- ω₁ is marked as a critical frequency for both magnitude and phase responses, signifying resonance and maximum phase shift.\nimage_name:∠H2\ndescription:The graph titled \"∠H2\" is part of a series illustrating loop gain characteristics of a circuit. It is a Bode plot focusing on the phase response of the transfer function.\n\n1. **Graph Type and Function:**\n- This Bode plot shows the phase response of a transfer function.\n\n2. **Axes Labels and Units:**\n- The horizontal axis measures angular frequency (ω), typically in radians per second.\n- The vertical axis measures phase angle in degrees.\n\n3. **Behavior and Trends:**\n- The phase response starts at +90 degrees at low frequencies.\n- As frequency increases, the phase decreases, passes through 0 degrees, and continues to -90 degrees at high frequencies.\n\n4. **Key Features and Technical Details:**\n- The phase shift transitions from +90 to -90 degrees.\n- This behavior is typical for a second-order system, with each stage contributing a +90 to -90 degree phase shift.\n- The transition occurs around the resonant frequency ω1, marked on the plot.\n- At resonance, the total phase shift is 180 degrees, indicating the phase condition for oscillation.\n\n5. **Annotations and Specific Data Points:**\n- ω1 is marked as the point of rapid phase shift transition.\n- The plot indicates ω1's position relative to the phase shift without explicit numerical values.\n- The combined phase shift from two similar stages results in +180 degrees at low frequencies and -180 degrees at high frequencies, as shown in ∠H1H2.\n\nThis phase response is essential for understanding the circuit's stability and oscillation conditions, demonstrating oscillation only at ω1 due to specific phase shift behavior.\nimage_name:∠H1H2\ndescription:The graph titled \"∠H1H2\" is a Bode plot with sections for magnitude and phase response, each comprising multiple subplots.\n\n1. **Magnitude Response**:\n- **Graph Type**: Frequency response curves depict the magnitude plots.\n- **Axes Labels and Units**: The horizontal axis represents frequency (ω), likely logarithmic but not explicitly marked. The vertical axis shows the magnitude of transfer functions |H1|, |H2|, and their product |H1H2|.\n- **Behavior and Trends**:\n- Individual magnitude plots |H1| and |H2| peak at ω1, indicating resonance, with symmetrical, bell-shaped curves typical of bandpass filters.\n- The product |H1H2| shows a similar bell-shaped curve with a sharper peak at ω1 due to response multiplication.\n- **Key Features and Technical Details**: The peak at ω1 signifies maximum gain, with the sharpness in |H1H2| indicating narrow bandwidth.\n\n2. **Phase Response**:\n- **Graph Type**: Phase shift curves represent the phase plots.\n- **Axes Labels and Units**: The horizontal axis is the same as the magnitude plots, showing frequency (ω). The vertical axis measures phase shift in degrees.\n- **Behavior and Trends**:\n- ∠H1 and ∠H2 plots start at +90° and decrease to -90° with increasing frequency, smoothly transitioning around ω1.\n- The combined ∠H1H2 plot starts at +180° and decreases to -180°, showing a similar transition around ω1.\n- **Key Features and Technical Details**: The phase plots indicate a 360° total phase shift (from +180° to -180°), critical for determining stability and oscillation conditions.\n\n3. **Annotations and Specific Data Points**:\n- ω1 is marked, highlighting the frequency of interest.\n- Phase shift values are marked at +90°, -90°, +180°, and -180° for clear reference.\n\nOverall, the graph shows the combined magnitude and phase response of a two-stage system, with sharp peaks and phase shifts indicating selective frequency amplification and phase characteristics, crucial for understanding oscillation conditions.\n\nFigure 15.26 Loop gain characteristics of the circuit in Fig. 15.25.\n\nThe Fig. 15.25 circuit is central to many LC oscillators and is sometimes redrawn as in Fig. 15.27(a) or (b). However, the drain currents of $M_{1}$ and $M_{2}$, and thus the output swings, depend significantly on the supply voltage. Since the waveforms at $X$ and $Y$ are differential, Fig. 15.27(b) suggests converting $M_{1}$ and $M_{2}$ to a differential pair as in Fig. 15.27(c), where $I_{S S}$ defines the total bias current.\n\n#### Example 15.6\n\nFor the Fig. 15.27(c) circuit, plot $V_{X}$, $V_{Y}$, $I_{D 1}$, and $I_{D 2}$ as oscillation begins.\nimage_name:(a)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: GND, D: X, G: Y}\nname: M2, type: NMOS, ports: {S: GND, D: Y, G: X}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\n]\nextrainfo:This differential oscillator features two NMOS transistors, M1 and M2, in a cross-coupled pair. Capacitors CP, resistors RP, and inductors LP form resonant tank circuits connected to VDD. Nodes X and Y are the differential outputs, grounded at the source of both transistors.\n\nimage_name:(b)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: GND, D: X, G: Y}\nname: M2, type: NMOS, ports: {S: GND, D: Y, G: X}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\n]\nextrainfo:This differential oscillator includes two NMOS transistors, M1 and M2, in a cross-coupled configuration. Capacitors CP, resistors RP, and inductors LP create resonant tank circuits connected to VDD. Nodes X and Y serve as differential outputs, grounded at the source of both transistors.\n\nimage_name:(c)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: P, D: X, G: Y}\nname: M2, type: NMOS, ports: {S: P, D: Y, G: X}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\nname: ISS, type: CurrentSource, value: ISS, ports: {Np: P, Nn: GND}\n]\nextrainfo:This differential oscillator consists of two NMOS transistors, M1 and M2, in a cross-coupled pair. Capacitors CP, resistors RP, and inductors LP form resonant tank circuits connected to VDD. Nodes X and Y are the differential outputs, grounded at the source of both transistors. The tail current source ISS is included to reduce supply sensitivity.\n\nFigure 15.27 (a) Redrawn oscillator from Fig. 15.25; (b) alternative redrawing; (c) addition of tail current source for reduced supply sensitivity.\n\n#### Solution\n\nIf the circuit starts with no difference between $V_{X}$ and $V_{Y}$, then $V_{X}=V_{Y} \\approx V_{D D}$. Both transistors equally share the tail current. If $\\left(g_{m 1,2} R_{P}\\right)^{2} \\geq 1$, where $R_{P}$ is the parallel resistance of the tank at resonance, noise components at resonance frequency are amplified by M1 and M2, allowing oscillation to grow. The drain currents of M1 and M2 vary with $V_{X}-V_{Y}$ (as in a differential pair).\n\nAs shown in Fig. 15.28, oscillation amplitude increases until the loop gain drops at peaks. If $g_{m 1,2} R_{P}$ is sufficiently large, $V_{X}-V_{Y}$ reaches a level steering the entire tail current to one transistor, turning the other off. Thus, in steady state, $I_{D 1}$ and $I_{D 2}$ vary between zero and $I_{S S}$.\nimage_name:Figure 15.28\ndescription:The graph in Figure 15.28 displays time-domain waveforms of voltages $V_X$ and $V_Y$, and drain currents $I_{D1}$ and $I_{D2}$ over time. The horizontal axis represents time ($t$), while the vertical axis is used for both voltage and current, though units are not explicitly labeled.\n\n1. **Graph Type and Function**: This time-domain waveform graph illustrates oscillations in voltages and currents.\n\n2. **Axes Labels and Units**: The horizontal axis is time ($t$), with no specific units provided. The vertical axis references $V_{DD}$ for voltages and $I_{SS}/2$ for currents, with units likely in volts and amperes, respectively.\n\n3. **Behavior and Trends**: The graph shows $V_X$ and $V_Y$ starting with small oscillations around $V_{DD}$ and increasing in amplitude over time. Similarly, $I_{D1}$ and $I_{D2}$ oscillate around $I_{SS}/2$ with growing amplitude. The oscillations appear sinusoidal and symmetric, indicating stable oscillatory behavior over time.\n\n4. **Key Features and Technical Details**: The primary feature is the increasing amplitude of oscillations for both voltage and current, suggesting a growing oscillation amplitude until a steady state is reached, typical of oscillator circuits. The oscillations stabilize when the loop gain drops at peaks.\n\n5. **Annotations and Specific Data Points**: The diagram includes annotations for $V_X$, $V_Y$, $I_{D1}$, and $I_{D2}$, with reference lines at $V_{DD}$ and $I_{SS}/2$. These lines help visualize the oscillations around these central values, with no specific numerical values or markers for peaks or troughs.\n\nFigure 15.28\n\nThe Fig. 15.27(c) oscillator is fully differential. Despite perfect symmetry, the circuit's supply sensitivity is nonzero. This is due to the drain junction capacitances of M1 and M2 varying with the supply voltage. This issue is revisited in Example 15.9."
},
{
    "text": "1. **Graph Type:**\n- The bottom row illustrates the phase response of the transfer functions, also depicted as Bode plots.\n\n2. **Axes Labels and Units:**\n- The horizontal axis again denotes angular frequency (ω).\n- The vertical axis signifies phase angle in degrees.\n\n3. **General Behavior and Trends:**\n- Each individual phase plot, ∠H₁ and ∠H₂, initiates at +90° at low frequencies and transitions to -90° at high frequencies, crossing 0° at ω₁.\n- The combined phase response, ∠H₁H₂, begins at +180° and shifts to -180° through ω₁, maintaining a similar transition shape but with a doubled phase shift due to the multiplication of the two functions.\n\n4. **Key Characteristics and Technical Aspects:**\n- The intersection at 0° (for ∠H₁ and ∠H₂) and at 180° (for ∠H₁H₂) at ω₁ is a pivotal point, indicating the phase shift at resonance.\n- The phase response illustrates the inversion and phase shift introduced by each stage and their cumulative effect.\n\n5. **Annotations and Specific Data Points:**\n- The frequency ω₁ is highlighted as a critical frequency for both magnitude and phase responses, marking the resonance point and maximum phase shift.\nimage_name:∠H2\ndescription:The graph titled \"∠H2\" is part of a series of plots depicting the loop gain characteristics of a circuit. It is a Bode plot focusing on the phase response of the transfer function.\n\n1. **Graph Type and Function:**\n- This is a Bode plot, specifically showcasing the phase response of a transfer function.\n\n2. **Axes Labels and Units:**\n- The horizontal axis represents angular frequency (ω), typically measured in radians per second.\n- The vertical axis denotes phase angle, measured in degrees.\n\n3. **General Behavior and Trends:**\n- The plot displays a phase response starting at +90 degrees at low frequencies.\n- As the frequency rises, the phase decreases, passing through 0 degrees at a specific point, and continues to decline to -90 degrees at high frequencies.\n\n4. **Key Characteristics and Technical Aspects:**\n- The phase shift initiates at +90 degrees and transitions smoothly to -90 degrees.\n- This behavior is typical for a second-order system where each stage contributes a +90 to -90 degree phase shift.\n- The transition occurs around the resonant frequency ω1, which is marked on the plot.\n- The total phase shift at resonance is 180 degrees, indicating that the circuit meets the phase condition for oscillation at this frequency.\n\n5. **Annotations and Specific Data Points:**\n- The critical frequency ω1 is marked as the point where the phase shift transitions rapidly.\n- The plot does not explicitly show numerical values for ω1 but indicates its position relative to the phase shift.\n- The sum of the phase contributions from two stages (each contributing a phase shift similar to ∠H2) results in a total phase shift of +180 degrees at low frequencies and -180 degrees at high frequencies, as shown in the combined plot ∠H1H2.\n\nThis phase response is essential for understanding the stability and oscillation conditions of the circuit, as it demonstrates that the circuit can only oscillate at the designated frequency ω1 due to the specific phase shift behavior.\nimage_name:∠H1H2\ndescription:The graph titled \"∠H1H2\" is a Bode plot, comprising two main sections: magnitude and phase response, each consisting of multiple subplots.\n\n1. **Magnitude Response**:\n- **Graph Type**: The magnitude plots are depicted as frequency response curves.\n- **Axes Labels and Units**: The horizontal axis represents frequency (ω), likely in a logarithmic scale, though not explicitly marked. The vertical axis represents the magnitude of the transfer functions |H1|, |H2|, and their product |H1H2|.\n- **General Behavior and Trends**:\n- Each individual magnitude plot, |H1| and |H2|, exhibits a peak at a specific frequency ω1, indicating a resonant frequency. These plots are symmetrical and bell-shaped, characteristic of a bandpass filter.\n- The product |H1H2| also displays a similar bell-shaped curve with a sharper peak at the same frequency ω1, due to the multiplication of the two responses.\n- **Key Characteristics and Technical Aspects**: The peak at ω1 signifies the frequency at which the system achieves maximum gain, and the sharpness of the peak in |H1H2| indicates a narrow bandwidth.\n\n2. **Phase Response**:\n- **Graph Type**: The phase plots are depicted as phase shift curves.\n- **Axes Labels and Units**: The horizontal axis is the same as the magnitude plots, representing frequency (ω). The vertical axis denotes phase shift in degrees.\n- **General Behavior and Trends**:\n- The phase plots for ∠H1 and ∠H2 each start at +90° and decrease to -90° as frequency increases, with a smooth transition around ω1.\n- The combined phase plot ∠H1H2 starts at +180° and decreases to -180°, showing a similar smooth transition around ω1.\n- **Key Characteristics and Technical Aspects**: The phase plots indicate a total phase shift of 360° (from +180° to -180°) across the frequency range, which is critical in determining the stability and oscillation conditions of the system.\n\n3. **Annotations and Specific Data Points**:\n- The plots are marked with the resonant frequency ω1, highlighting the frequency of interest.\n- The phase shift values are explicitly marked at +90°, -90°, +180°, and -180°, providing clear reference points for analysis.\n\nOverall, the graph illustrates the combined magnitude and phase response of a system characterized by two stages, each contributing to the overall behavior observed in the product response |H1H2| and ∠H1H2|. The sharp peaks and phase shifts are indicative of the system's selective frequency amplification and phase characteristics, crucial for understanding the oscillation conditions of the circuit in question.\n\nFigure 15.26 Loop gain characteristics of the circuit shown in Fig. 15.25.\n\nThe circuit of Fig. 15.25 serves as the core of many LC oscillators and is sometimes depicted as in Fig. 15.27(a) or (b). However, the drain currents of $M_{1}$ and $M_{2}$, and thus the output swings, heavily depend on the supply voltage. Since the waveforms at $X$ and $Y$ are differential, the drawing in Fig. 15.27(b) suggests that $M_{1}$ and $M_{2}$ can be converted to a differential pair as shown in Fig. 15.27(c), where the total bias current is defined by $I_{S S}$.\n\n#### Example 15.6\n\nFor the circuit of Fig. 15.27(c), plot $V_{X}$ and $V_{Y}$ and $I_{D 1}$ and $I_{D 2}$ as the oscillation begins.\nimage_name:(a)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: GND, D: X, G: Y}\nname: M2, type: NMOS, ports: {S: GND, D: Y, G: X}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\n]\nextrainfo:The circuit is a differential oscillator with two NMOS transistors M1 and M2, each forming a cross-coupled pair. The capacitors CP, resistors RP, and inductors LP are used to form the resonant tank circuits connected to VDD. The nodes X and Y are the differential outputs, and the circuit is grounded at the source of both transistors.\n\nimage_name:(b)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: GND, D: X, G: Y}\nname: M2, type: NMOS, ports: {S: GND, D: Y, G: X}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\n]\nextrainfo:The circuit is a differential oscillator with two NMOS transistors M1 and M2, forming a cross-coupled pair. Capacitors CP, resistors RP, and inductors LP form the resonant tank circuits connected to VDD. Nodes X and Y are the differential outputs, grounded at the source of both transistors.\n\nimage_name:(c)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: P, D: X, G: Y}\nname: M2, type: NMOS, ports: {S: P, D: Y, G: X}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\nname: ISS, type: CurrentSource, value: ISS, ports: {Np: P, Nn: GND}\n]\nextrainfo:The circuit is a differential oscillator with two NMOS transistors M1 and M2, forming a cross-coupled pair. Capacitors CP, resistors RP, and inductors LP form the resonant tank circuits connected to VDD. Nodes X and Y are the differential outputs, grounded at the source of both transistors. The tail current source ISS is used to lower supply sensitivity.\n\nFigure 15.27 (a) Redrawing of the oscillator shown in Fig. 15.25; (b) another redrawing of the circuit; (c) addition of tail current source to reduce supply sensitivity.\n\n#### Solution\n\nIf the circuit starts with no difference between $V_{X}$ and $V_{Y}$, then $V_{X}=V_{Y} \\approx V_{D D}$. The two transistors equally share the tail current. If $\\left(g_{m 1,2} R_{P}\\right)^{2} \\geq 1$, where $R_{P}$ is the equivalent parallel resistance of the tank at resonance, then noise components at the resonance frequency are amplified by $M_{1}$ and $M_{2}$, allowing the oscillation to grow. The drain currents of $M_{1}$ and $M_{2}$ vary according to the instantaneous value of $V_{X}-V_{Y}$ (as in a differential pair).\n\nAs depicted in Fig. 15.28, the oscillation amplitude increases until the loop gain decreases at the peaks. In fact, if $g_{m 1,2} R_{P}$ is sufficiently large, the difference between $V_{X}-V_{Y}$ reaches a level that directs the entire tail current to one transistor, turning the other off. Thus, in the steady state, $I_{D 1}$ and $I_{D 2}$ fluctuate between zero and $I_{S S}$.\nimage_name:Figure 15.28\ndescription:The graph in Figure 15.28 is a time-domain waveform illustrating the behavior of voltages $V_X$ and $V_Y$, and drain currents $I_{D1}$ and $I_{D2}$ over time. The horizontal axis represents time ($t$), while the vertical axis is used for both voltage and current, though not explicitly labeled with units.\n\n1. **Graph Type and Function**: This is a time-domain waveform graph showing oscillations in voltages and currents.\n\n2. **Axes Labels and Units**: The horizontal axis is labeled with time ($t$), but no specific time units are provided. The vertical axis has two references: $V_{DD}$ for the voltages $V_X$ and $V_Y$, and $I_{SS}/2$ for the currents $I_{D1}$ and $I_{D2}$. The units for voltage and current are not specified but are likely in volts and amperes, respectively.\n\n3. **General Behavior and Trends**: The graph shows that both $V_X$ and $V_Y$ start with small oscillations around $V_{DD}$ and grow in amplitude over time. Similarly, $I_{D1}$ and $I_{D2}$ oscillate around $I_{SS}/2$ with increasing amplitude. The oscillations for both voltage and current appear sinusoidal and symmetric, indicating a stable oscillatory behavior as time progresses.\n\n4. **Key Features and Technical Details**: The key feature is the increasing amplitude of oscillations for both voltage and current over time. This suggests a growing oscillation amplitude until a steady state is reached, which is characteristic of an oscillator circuit as described in the context. The oscillations reach a point where the loop gain drops at the peaks, stabilizing the amplitude.\n\n5. **Annotations and Specific Data Points**: The diagram includes annotations for $V_X$, $V_Y$, $I_{D1}$, and $I_{D2}$, with reference lines at $V_{DD}$ and $I_{SS}/2$. These reference lines help in visualizing the oscillations around these central values. No specific numerical values or markers are provided for peaks or troughs.\n\nFigure 15.28\n\nThe oscillator of Fig. 15.27(c) is constructed in a fully differential form. The supply sensitivity of the circuit, however, is nonzero even with perfect symmetry. This is because the drain junction capacitances of $M_{1}$ and $M_{2}$ vary with the supply voltage. We return to this issue in Example 15.9."
},
{
    "text": "1. **Graph Type:**\n- The bottom row illustrates the phase response of the transfer functions, depicted as Bode plots.\n\n2. **Axes Labels and Units:**\n- The horizontal axis represents angular frequency (ω).\n- The vertical axis denotes the phase angle in degrees.\n\n3. **Behavior and Trends:**\n- Individual phase plots, ∠H₁ and ∠H₂, initiate at +90° at low frequencies and shift to -90° at high frequencies, crossing 0° at ω₁.\n- The combined phase response, ∠H₁H₂, starts at +180° and transitions to -180° through ω₁, exhibiting a similar transition shape but with doubled phase shift due to function multiplication.\n\n4. **Key Features and Technical Aspects:**\n- The 0° crossing (for ∠H₁ and ∠H₂) and 180° crossing (for ∠H₁H₂) at ω₁ are critical, indicating phase shift at resonance.\n- The phase response reveals the inversion and phase shift introduced by each stage and their cumulative effect.\n\n5. **Annotations and Specific Data Points:**\n- ω₁ is marked as a critical frequency for both magnitude and phase responses, signifying the resonance point and maximum phase shift.\nimage_name:∠H2\ndescription:The \"∠H2\" graph is part of a series illustrating the loop gain characteristics of a circuit. It is a Bode plot focusing on the phase response of the transfer function.\n\n1. **Graph Type and Function:**\n- This is a Bode plot showing the phase response of a transfer function.\n\n2. **Axes Labels and Units:**\n- The horizontal axis represents angular frequency (ω), typically in radians per second.\n- The vertical axis shows the phase angle in degrees.\n\n3. **Behavior and Trends:**\n- The plot displays a phase response starting at +90 degrees at low frequencies.\n- As frequency increases, the phase decreases, passes through 0 degrees, and continues to -90 degrees at high frequencies.\n\n4. **Key Features and Technical Aspects:**\n- The phase shift transitions from +90 to -90 degrees.\n- This behavior is typical for a second-order system, with each stage contributing a +90 to -90 degree phase shift.\n- The transition occurs around the resonant frequency ω1, marked on the plot.\n- At resonance, the total phase shift is 180 degrees, indicating the circuit meets the phase condition for oscillation.\n\n5. **Annotations and Specific Data Points:**\n- ω1 is marked as the point of rapid phase shift transition.\n- The plot indicates ω1's position relative to the phase shift without explicit numerical values.\n- The combined phase shift from two similar stages results in +180 degrees at low frequencies and -180 degrees at high frequencies, as shown in ∠H1H2.\n\nThis phase response is essential for understanding the circuit's stability and oscillation conditions, demonstrating oscillation only at ω1 due to specific phase shift behavior.\nimage_name:∠H1H2\ndescription:The \"∠H1H2\" graph is a Bode plot comprising two main sections: magnitude and phase response, each with multiple subplots.\n\n1. **Magnitude Response**:\n- **Graph Type**: Frequency response curves represent the magnitude plots.\n- **Axes Labels and Units**: The horizontal axis shows frequency (ω), likely on a logarithmic scale. The vertical axis represents the magnitude of transfer functions |H1|, |H2|, and their product |H1H2|.\n- **Behavior and Trends**:\n- Individual magnitude plots, |H1| and |H2|, peak at ω1, indicating resonance. These plots are symmetrical and bell-shaped, typical of bandpass filters.\n- The product |H1H2| also shows a bell-shaped curve with a sharper peak at ω1 due to response multiplication.\n- **Key Features and Technical Aspects**: The peak at ω1 signifies maximum gain, with the sharpness in |H1H2| indicating narrow bandwidth.\n\n2. **Phase Response**:\n- **Graph Type**: Phase shift curves represent the phase plots.\n- **Axes Labels and Units**: The horizontal axis is the same as the magnitude plots, showing frequency (ω). The vertical axis represents phase shift in degrees.\n- **Behavior and Trends**:\n- ∠H1 and ∠H2 phase plots start at +90° and decrease to -90° with increasing frequency, transitioning smoothly around ω1.\n- The combined phase plot ∠H1H2 starts at +180° and decreases to -180°, showing a similar transition around ω1.\n- **Key Features and Technical Aspects**: The phase plots indicate a 360° total phase shift (from +180° to -180°), crucial for determining stability and oscillation conditions.\n\n3. **Annotations and Specific Data Points**:\n- ω1 is marked, highlighting the frequency of interest.\n- Phase shift values are marked at +90°, -90°, +180°, and -180°, providing clear reference points.\n\nOverall, the graph shows the combined magnitude and phase response of a two-stage system, with sharp peaks and phase shifts indicating selective frequency amplification and phase characteristics, crucial for understanding oscillation conditions.\n\nFigure 15.26 Loop gain characteristics of the circuit shown in Fig. 15.25.\n\nThe Fig. 15.25 circuit forms the core of many LC oscillators and can be redrawn as in Fig. 15.27(a) or (b). However, the drain currents of $M_{1}$ and $M_{2}$, and thus output swings, depend significantly on the supply voltage. Since $X$ and $Y$ waveforms are differential, Fig. 15.27(b) suggests converting $M_{1}$ and $M_{2}$ to a differential pair as in Fig. 15.27(c), where $I_{S S}$ defines the total bias current.\n\n#### Example 15.6\n\nFor the Fig. 15.27(c) circuit, plot $V_{X}$, $V_{Y}$, $I_{D 1}$, and $I_{D 2}$ as oscillation begins.\nimage_name:(a)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: GND, D: X, G: Y}\nname: M2, type: NMOS, ports: {S: GND, D: Y, G: X}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\n]\nextrainfo:This differential oscillator features two NMOS transistors, M1 and M2, in a cross-coupled pair. Capacitors CP, resistors RP, and inductors LP form resonant tank circuits connected to VDD. Nodes X and Y are differential outputs, grounded at the source of both transistors.\n\nimage_name:(b)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: GND, D: X, G: Y}\nname: M2, type: NMOS, ports: {S: GND, D: Y, G: X}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\n]\nextrainfo:This differential oscillator consists of two NMOS transistors, M1 and M2, in a cross-coupled pair. Capacitors CP, resistors RP, and inductors LP form resonant tank circuits connected to VDD. Nodes X and Y are differential outputs, grounded at the source of both transistors.\n\nimage_name:(c)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: P, D: X, G: Y}\nname: M2, type: NMOS, ports: {S: P, D: Y, G: X}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\nname: ISS, type: CurrentSource, value: ISS, ports: {Np: P, Nn: GND}\n]\nextrainfo:This differential oscillator features two NMOS transistors, M1 and M2, in a cross-coupled pair. Capacitors CP, resistors RP, and inductors LP form resonant tank circuits connected to VDD. Nodes X and Y are differential outputs, grounded at the source of both transistors. The tail current source ISS is added to reduce supply sensitivity.\n\nFigure 15.27 (a) Redrawn oscillator from Fig. 15.25; (b) alternative redrawing; (c) addition of tail current source for reduced supply sensitivity.\n\n#### Solution\n\nIf the circuit starts with no difference between $V_{X}$ and $V_{Y}$, then $V_{X}=V_{Y} \\approx V_{D D}$. Both transistors equally share the tail current. If $\\left(g_{m 1,2} R_{P}\\right)^{2} \\geq 1$, where $R_{P}$ is the parallel resistance of the tank at resonance, noise components at resonance frequency are amplified by M1 and M2, allowing oscillation to grow. The drain currents of M1 and M2 vary based on the instantaneous $V_{X}-V_{Y}$ (as in a differential pair).\n\nAs shown in Fig. 15.28, oscillation amplitude increases until loop gain decreases at peaks. If $g_{m 1,2} R_{P}$ is sufficiently large, $V_{X}-V_{Y}$ reaches a level steering the entire tail current to one transistor, turning the other off. Thus, in steady state, $I_{D 1}$ and $I_{D 2}$ vary between zero and $I_{S S}$.\nimage_name:Figure 15.28\ndescription:The graph in Figure 15.28 depicts time-domain waveforms of voltages $V_X$ and $V_Y$, and drain currents $I_{D1}$ and $I_{D2}$ over time. The horizontal axis represents time ($t$), while the vertical axis is used for both voltage and current, though units are not explicitly labeled.\n\n1. **Graph Type and Function**: This is a time-domain waveform graph showing oscillations in voltages and currents.\n\n2. **Axes Labels and Units**: The horizontal axis is labeled with time ($t$) without specific units. The vertical axis references $V_{DD}$ for voltages and $I_{SS}/2$ for currents, with units implied as volts and amperes.\n\n3. **Behavior and Trends**: The graph shows $V_X$ and $V_Y$ starting with small oscillations around $V_{DD}$, growing in amplitude over time. Similarly, $I_{D1}$ and $I_{D2}$ oscillate around $I_{SS}/2$ with increasing amplitude. The oscillations are sinusoidal and symmetric, indicating stable oscillatory behavior.\n\n4. **Key Features and Technical Aspects**: The increasing amplitude of oscillations for both voltage and current suggests growing oscillation until a steady state is reached, typical of oscillator circuits. The oscillations stabilize when the loop gain drops at peaks.\n\n5. **Annotations and Specific Data Points**: The diagram annotates $V_X$, $V_Y$, $I_{D1}$, and $I_{D2}$, with reference lines at $V_{DD}$ and $I_{SS}/2$. These lines help visualize oscillations around these values, with no specific numerical values or markers for peaks or troughs.\n\nFigure 15.28\n\nThe Fig. 15.27(c) oscillator is fully differential. Despite perfect symmetry, the circuit's supply sensitivity is nonzero. This is due to the drain junction capacitances of M1 and M2 varying with the supply voltage. This issue is revisited in Example 15.9."
},
{
    "text": "1. **Graph Type:**\n- The lowest row displays the phase response of the transfer functions, also depicted as Bode plots.\n\n2. **Axes Labels and Units:**\n- The horizontal axis again denotes angular frequency (ω).\n- The vertical axis indicates phase angle in degrees.\n\n3. **General Behavior and Trends:**\n- Each individual phase plot, ∠H₁ and ∠H₂, initiates at +90° at low frequencies and transitions to -90° at high frequencies, crossing 0° at ω₁.\n- The combined phase response, ∠H₁H₂, begins at +180° and shifts to -180° through ω₁, maintaining a similar transition pattern but with a doubled phase shift due to the multiplication of the two functions.\n\n4. **Key Features and Technical Aspects:**\n- The crossing at 0° (for ∠H₁ and ∠H₂) and at 180° (for ∠H₁H₂) at ω₁ is a pivotal point, signifying the phase shift at resonance.\n- The phase response illustrates the inversion and phase shift introduced by each stage and their collective effect.\n\n5. **Annotations and Specific Data Points:**\n- The frequency ω₁ is designated as a critical frequency for both magnitude and phase responses, marking the resonance point and maximum phase shift.\nimage_name:∠H2\ndescription:The graph labeled \"∠H2\" is part of a series of plots depicting the loop gain characteristics of a circuit. It is a Bode plot focusing on the phase response of the transfer function.\n\n1. **Graph Type and Function:**\n- This is a Bode plot, specifically illustrating the phase response of a transfer function.\n\n2. **Axes Labels and Units:**\n- The horizontal axis represents angular frequency (ω), typically measured in radians per second.\n- The vertical axis denotes phase angle, measured in degrees.\n\n3. **General Behavior and Trends:**\n- The plot exhibits a phase response that starts at +90 degrees at low frequencies.\n- As the frequency rises, the phase decreases, passing through 0 degrees at a specific point, and continues to decline to -90 degrees at high frequencies.\n\n4. **Key Features and Technical Aspects:**\n- The phase shift initiates at +90 degrees and transitions smoothly to -90 degrees.\n- This behavior is typical for a second-order system where each stage contributes a +90 to -90 degree phase shift.\n- The transition occurs around the resonant frequency ω1, which is marked on the plot.\n- The total phase shift at resonance is 180 degrees, indicating that the circuit meets the phase condition for oscillation at this frequency.\n\n5. **Annotations and Specific Data Points:**\n- The critical frequency ω1 is marked as the point where the phase shift changes rapidly.\n- The plot does not explicitly show numerical values for ω1 but indicates its position relative to the phase shift.\n- The sum of the phase contributions from two stages (each contributing a phase shift similar to ∠H2) results in a total phase shift of +180 degrees at low frequencies and -180 degrees at high frequencies, as depicted in the combined plot ∠H1H2.\n\nThis phase response is essential for understanding the stability and oscillation conditions of the circuit, as it demonstrates that the circuit can only oscillate at the designated frequency ω1 due to the specific phase shift behavior.\nimage_name:∠H1H2\ndescription:The graph titled \"∠H1H2\" is a Bode plot, comprising two main sections: magnitude and phase response, each consisting of multiple subplots.\n\n1. **Magnitude Response**:\n- **Graph Type**: The magnitude plots are presented as frequency response curves.\n- **Axes Labels and Units**: The horizontal axis represents frequency (ω), likely in a logarithmic scale, though not explicitly marked. The vertical axis represents the magnitude of the transfer functions |H1|, |H2|, and their product |H1H2|.\n- **General Behavior and Trends**:\n- Each individual magnitude plot, |H1| and |H2|, exhibits a peak at a specific frequency ω1, indicating a resonant frequency. These plots are symmetrical and bell-shaped, characteristic of a bandpass filter.\n- The product |H1H2| also displays a similar bell-shaped curve with a sharper peak at the same frequency ω1, due to the multiplication of the two responses.\n- **Key Features and Technical Aspects**: The peak at ω1 signifies the frequency at which the system achieves maximum gain, and the sharpness of the peak in |H1H2| indicates a narrow bandwidth.\n\n2. **Phase Response**:\n- **Graph Type**: The phase plots are depicted as phase shift curves.\n- **Axes Labels and Units**: The horizontal axis is the same as the magnitude plots, representing frequency (ω). The vertical axis indicates phase shift in degrees.\n- **General Behavior and Trends**:\n- The phase plots for ∠H1 and ∠H2 each start at +90° and decrease to -90° as frequency increases, with a smooth transition around ω1.\n- The combined phase plot ∠H1H2 starts at +180° and decreases to -180°, showing a similar smooth transition around ω1.\n- **Key Features and Technical Aspects**: The phase plots indicate a total phase shift of 360° (from +180° to -180°) across the frequency range, which is crucial for determining the stability and oscillation conditions of the system.\n\n3. **Annotations and Specific Data Points**:\n- The plots are marked with the resonant frequency ω1, highlighting the frequency of interest.\n- The phase shift values are explicitly marked at +90°, -90°, +180°, and -180°, providing clear reference points for analysis.\n\nOverall, the graph illustrates the combined magnitude and phase response of a system characterized by two stages, each contributing to the overall behavior observed in the product response |H1H2| and ∠H1H2|. The sharp peaks and phase shifts are indicative of the system's selective frequency amplification and phase characteristics, crucial for understanding the oscillation conditions of the circuit in question.\n\nFigure 15.26 Loop gain characteristics of the circuit shown in Fig. 15.25.\n\nThe circuit of Fig. 15.25 serves as the core of many LC oscillators and is sometimes depicted as in Fig. 15.27(a) or (b). However, the drain currents of $M_{1}$ and $M_{2}$, and hence the output swings, heavily rely on the supply voltage. Since the waveforms at $X$ and $Y$ are differential, the drawing in Fig. 15.27(b) suggests that $M_{1}$ and $M_{2}$ can be converted to a differential pair as shown in Fig. 15.27(c), where the total bias current is defined by $I_{S S}$.\n\n#### Example 15.6\n\nFor the circuit of Fig. 15.27(c), plot $V_{X}$ and $V_{Y}$ and $I_{D 1}$ and $I_{D 2}$ as the oscillation begins.\nimage_name:(a)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: GND, D: X, G: Y}\nname: M2, type: NMOS, ports: {S: GND, D: Y, G: X}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\n]\nextrainfo:The circuit is a differential oscillator with two NMOS transistors M1 and M2, each forming a cross-coupled pair. The capacitors CP, resistors RP, and inductors LP are used to form the resonant tank circuits connected to VDD. The nodes X and Y are the differential outputs, and the circuit is grounded at the source of both transistors.\n\nimage_name:(b)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: GND, D: X, G: Y}\nname: M2, type: NMOS, ports: {S: GND, D: Y, G: X}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\n]\nextrainfo:The circuit is a differential oscillator with two NMOS transistors M1 and M2, forming a cross-coupled pair. Capacitors CP, resistors RP, and inductors LP form the resonant tank circuits connected to VDD. Nodes X and Y are the differential outputs, grounded at the source of both transistors.\n\nimage_name:(c)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: P, D: X, G: Y}\nname: M2, type: NMOS, ports: {S: P, D: Y, G: X}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\nname: ISS, type: CurrentSource, value: ISS, ports: {Np: P, Nn: GND}\n]\nextrainfo:The circuit is a differential oscillator with two NMOS transistors M1 and M2, forming a cross-coupled pair. Capacitors CP, resistors RP, and inductors LP form the resonant tank circuits connected to VDD. Nodes X and Y are the differential outputs, grounded at the source of both transistors. The tail current source ISS is used to lower supply sensitivity.\n\nFigure 15.27 (a) Redrawing of the oscillator shown in Fig. 15.25; (b) another redrawing of the circuit; (c) addition of tail current source to lower supply sensitivity.\n\n#### Solution\n\nIf the circuit starts with no difference between $V_{X}$ and $V_{Y}$, then $V_{X}=V_{Y} \\approx V_{D D}$. The two transistors equally share the tail current. If $\\left(g_{m 1,2} R_{P}\\right)^{2} \\geq 1$, where $R_{P}$ is the equivalent parallel resistance of the tank at resonance, then noise components at the resonance frequency are amplified by $M_{1}$ and $M_{2}$, allowing the oscillation to grow. The drain currents of $M_{1}$ and $M_{2}$ vary according to the instantaneous value of $V_{X}-V_{Y}$ (as in a differential pair).\n\nAs depicted in Fig. 15.28, the oscillation amplitude increases until the loop gain decreases at the peaks. In fact, if $g_{m 1,2} R_{P}$ is sufficiently large, the difference between $V_{X}-V_{Y}$ reaches a level that directs the entire tail current to one transistor, turning the other off. Thus, in the steady state, $I_{D 1}$ and $I_{D 2}$ vary between zero and $I_{S S}$.\nimage_name:Figure 15.28\ndescription:The graph in Figure 15.28 is a time-domain waveform illustrating the behavior of voltages $V_X$ and $V_Y$, and drain currents $I_{D1}$ and $I_{D2}$ over time. The horizontal axis represents time ($t$), while the vertical axis is used for both voltage and current, though not explicitly labeled with units.\n\n1. **Graph Type and Function**: This is a time-domain waveform graph showing oscillations in voltages and currents.\n\n2. **Axes Labels and Units**: The horizontal axis is labeled with time ($t$), but no specific time units are provided. The vertical axis has two references: $V_{DD}$ for the voltages $V_X$ and $V_Y$, and $I_{SS}/2$ for the currents $I_{D1}$ and $I_{D2}$. The units for voltage and current are not specified but are likely in volts and amperes, respectively.\n\n3. **General Behavior and Trends**: The graph shows that both $V_X$ and $V_Y$ start with small oscillations around $V_{DD}$ and grow in amplitude over time. Similarly, $I_{D1}$ and $I_{D2}$ oscillate around $I_{SS}/2$ with increasing amplitude. The oscillations for both voltage and current appear sinusoidal and symmetric, indicating a stable oscillatory behavior as time progresses.\n\n4. **Key Features and Technical Aspects**: The key feature is the increasing amplitude of oscillations for both voltage and current over time. This suggests a growing oscillation amplitude until a steady state is reached, which is characteristic of an oscillator circuit as described in the context. The oscillations reach a point where the loop gain drops at the peaks, stabilizing the amplitude.\n\n5. **Annotations and Specific Data Points**: The diagram includes annotations for $V_X$, $V_Y$, $I_{D1}$, and $I_{D2}$, with reference lines at $V_{DD}$ and $I_{SS}/2$. These reference lines help in visualizing the oscillations around these central values. No specific numerical values or markers are provided for peaks or troughs.\n\nFigure 15.28\n\nThe oscillator of Fig. 15.27(c) is constructed in fully differential form. The supply sensitivity of the circuit, however, is nonzero even with perfect symmetry. This is because the drain junction capacitances of $M_{1}$ and $M_{2}$ vary with the supply voltage. We return to this issue in Example 15.9."
},
{
    "text": "1. **Graph Type:**\n- The lower row displays the phase response of the transfer functions, also depicted as Bode plots.\n\n2. **Axes Labels and Units:**\n- The horizontal axis again denotes angular frequency (ω).\n- The vertical axis signifies phase angle in degrees.\n\n3. **General Behavior and Trends:**\n- Each individual phase plot, ∠H₁ and ∠H₂, initiates at +90° at low frequencies and transitions to -90° at high frequencies, crossing 0° at ω₁.\n- The combined phase response, ∠H₁H₂, begins at +180° and shifts to -180° through ω₁, maintaining a similar transition pattern but with a doubled phase shift due to the multiplication of the two functions.\n\n4. **Key Features and Technical Aspects:**\n- The intersection at 0° (for ∠H₁ and ∠H₂) and at 180° (for ∠H₁H₂) at ω₁ is a pivotal point, indicating the phase shift at resonance.\n- The phase response highlights the inversion and phase shift introduced by each stage and their collective impact.\n\n5. **Annotations and Specific Data Points:**\n- The frequency ω₁ is designated as a critical frequency for both magnitude and phase responses, marking the resonance point and maximum phase shift.\nimage_name:∠H2\ndescription:The graph labeled \"∠H2\" is part of a series of plots depicting the loop gain characteristics of a circuit. It is a Bode plot focusing on the phase response of the transfer function.\n\n1. **Graph Type and Function:**\n- This is a Bode plot, specifically illustrating the phase response of a transfer function.\n\n2. **Axes Labels and Units:**\n- The horizontal axis represents angular frequency (ω), typically measured in radians per second.\n- The vertical axis denotes phase angle, measured in degrees.\n\n3. **General Behavior and Trends:**\n- The plot exhibits a phase response that starts at +90 degrees at low frequencies.\n- As the frequency rises, the phase decreases, passing through 0 degrees at a specific point, and continues to decline to -90 degrees at high frequencies.\n\n4. **Key Features and Technical Aspects:**\n- The phase shift initiates at +90 degrees and transitions smoothly to -90 degrees.\n- This behavior is typical for a second-order system where each stage contributes a +90 to -90 degree phase shift.\n- The transition occurs around the resonant frequency ω1, which is marked on the plot.\n- The total phase shift at resonance is 180 degrees, indicating that the circuit meets the phase condition for oscillation at this frequency.\n\n5. **Annotations and Specific Data Points:**\n- The critical frequency ω1 is marked as the point where the phase shift transitions rapidly.\n- The plot does not explicitly show numerical values for ω1 but indicates its position relative to the phase shift.\n- The sum of the phase contributions from two stages (each contributing a phase shift similar to ∠H2) results in a total phase shift of +180 degrees at low frequencies and -180 degrees at high frequencies, as depicted in the combined plot ∠H1H2.\n\nThis phase response is essential for understanding the stability and oscillation conditions of the circuit, as it demonstrates that the circuit can only oscillate at the designated frequency ω1 due to the specific phase shift behavior.\nimage_name:∠H1H2\ndescription:The graph titled \"∠H1H2\" is a Bode plot, comprising two main sections: magnitude and phase response, each consisting of multiple subplots.\n\n1. **Magnitude Response**:\n- **Graph Type**: The magnitude plots are depicted as frequency response curves.\n- **Axes Labels and Units**: The horizontal axis represents frequency (ω), likely on a logarithmic scale, though not explicitly marked. The vertical axis represents the magnitude of the transfer functions |H1|, |H2|, and their product |H1H2|.\n- **General Behavior and Trends**:\n- Each individual magnitude plot, |H1| and |H2|, exhibits a peak at a specific frequency ω1, indicating a resonant frequency. These plots are symmetrical and bell-shaped, characteristic of a bandpass filter.\n- The product |H1H2| also displays a similar bell-shaped curve with a sharper peak at the same frequency ω1, due to the multiplication of the two responses.\n- **Key Features and Technical Aspects**: The peak at ω1 signifies the frequency at which the system achieves maximum gain, and the sharpness of the peak in |H1H2| indicates a narrow bandwidth.\n\n2. **Phase Response**:\n- **Graph Type**: The phase plots are depicted as phase shift curves.\n- **Axes Labels and Units**: The horizontal axis is the same as the magnitude plots, representing frequency (ω). The vertical axis denotes phase shift in degrees.\n- **General Behavior and Trends**:\n- The phase plots for ∠H1 and ∠H2 each start at +90° and decrease to -90° as frequency increases, with a smooth transition around ω1.\n- The combined phase plot ∠H1H2 starts at +180° and decreases to -180°, showing a similar smooth transition around ω1.\n- **Key Features and Technical Aspects**: The phase plots indicate a total phase shift of 360° (from +180° to -180°) across the frequency range, which is critical in determining the stability and oscillation conditions of the system.\n\n3. **Annotations and Specific Data Points**:\n- The plots are marked with the resonant frequency ω1, highlighting the frequency of interest.\n- The phase shift values are explicitly marked at +90°, -90°, +180°, and -180°, providing clear reference points for analysis.\n\nOverall, the graph illustrates the combined magnitude and phase response of a system characterized by two stages, each contributing to the overall behavior observed in the product response |H1H2| and ∠H1H2. The sharp peaks and phase shifts are indicative of the system's selective frequency amplification and phase characteristics, crucial for understanding the oscillation conditions of the circuit in question.\n\nFigure 15.26 Loop gain characteristics of the circuit shown in Fig. 15.25.\n\nThe circuit of Fig. 15.25 serves as the core of many LC oscillators and is sometimes depicted as in Fig. 15.27(a) or (b). However, the drain currents of $M_{1}$ and $M_{2}$, and hence the output swings, heavily depend on the supply voltage. Since the waveforms at $X$ and $Y$ are differential, the drawing in Fig. 15.27(b) suggests that $M_{1}$ and $M_{2}$ can be converted to a differential pair as shown in Fig. 15.27(c), where the total bias current is defined by $I_{S S}$.\n\n#### Example 15.6\n\nFor the circuit of Fig. 15.27(c), plot $V_{X}$ and $V_{Y}$ and $I_{D 1}$ and $I_{D 2}$ as the oscillation begins.\nimage_name:(a)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: GND, D: X, G: Y}\nname: M2, type: NMOS, ports: {S: GND, D: Y, G: X}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\n]\nextrainfo:The circuit is a differential oscillator with two NMOS transistors M1 and M2, each forming a cross-coupled pair. The capacitors CP, resistors RP, and inductors LP are used to form the resonant tank circuits connected to VDD. The nodes X and Y are the differential outputs, and the circuit is grounded at the source of both transistors.\n\nimage_name:(b)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: GND, D: X, G: Y}\nname: M2, type: NMOS, ports: {S: GND, D: Y, G: X}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\n]\nextrainfo:The circuit is a differential oscillator with two NMOS transistors M1 and M2, forming a cross-coupled pair. Capacitors CP, resistors RP, and inductors LP form the resonant tank circuits connected to VDD. Nodes X and Y are the differential outputs, grounded at the source of both transistors.\n\nimage_name:(c)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: P, D: X, G: Y}\nname: M2, type: NMOS, ports: {S: P, D: Y, G: X}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\nname: ISS, type: CurrentSource, value: ISS, ports: {Np: P, Nn: GND}\n]\nextrainfo:The circuit is a differential oscillator with two NMOS transistors M1 and M2, forming a cross-coupled pair. Capacitors CP, resistors RP, and inductors LP form the resonant tank circuits connected to VDD. Nodes X and Y are the differential outputs, grounded at the source of both transistors. The tail current source ISS is used to lower supply sensitivity.\n\nFigure 15.27 (a) Redrawing of the oscillator shown in Fig. 15.25; (b) another redrawing of the circuit; (c) addition of tail current source to lower supply sensitivity.\n\n#### Solution\n\nIf the circuit starts with zero difference between $V_{X}$ and $V_{Y}$, then $V_{X}=V_{Y} \\approx V_{D D}$. The two transistors share the tail current equally. If $\\left(g_{m 1,2} R_{P}\\right)^{2} \\geq 1$, where $R_{P}$ is the equivalent parallel resistance of the tank at resonance, then noise components at the resonance frequency are amplified by $M_{1}$ and $M_{2}$, allowing the oscillation to grow. The drain currents of $M_{1}$ and $M_{2}$ vary according to the instantaneous value of $V_{X}-V_{Y}$ (as in a differential pair).\n\nAs depicted in Fig. 15.28, the oscillation amplitude increases until the loop gain decreases at the peaks. In fact, if $g_{m 1,2} R_{P}$ is sufficiently large, the difference between $V_{X}-V_{Y}$ reaches a level that directs the entire tail current to one transistor, turning the other off. Thus, in the steady state, $I_{D 1}$ and $I_{D 2}$ vary between zero and $I_{S S}$.\nimage_name:Figure 15.28\ndescription:The graph in Figure 15.28 is a time-domain waveform illustrating the behavior of voltages $V_X$ and $V_Y$, and drain currents $I_{D1}$ and $I_{D2}$ over time. The horizontal axis represents time ($t$), while the vertical axis is used for both voltage and current, though not explicitly labeled with units.\n\n1. **Graph Type and Function**: This is a time-domain waveform graph showing oscillations in voltages and currents.\n\n2. **Axes Labels and Units**: The horizontal axis is labeled with time ($t$), but no specific time units are provided. The vertical axis has two references: $V_{DD}$ for the voltages $V_X$ and $V_Y$, and $I_{SS}/2$ for the currents $I_{D1}$ and $I_{D2}$. The units for voltage and current are not specified but are likely in volts and amperes, respectively.\n\n3. **General Behavior and Trends**: The graph shows that both $V_X$ and $V_Y$ start with small oscillations around $V_{DD}$ and grow in amplitude over time. Similarly, $I_{D1}$ and $I_{D2}$ oscillate around $I_{SS}/2$ with increasing amplitude. The oscillations for both voltage and current appear sinusoidal and symmetric, indicating a stable oscillatory behavior as time progresses.\n\n4. **Key Features and Technical Aspects**: The key feature is the increasing amplitude of oscillations for both voltage and current over time. This suggests a growing oscillation amplitude until a steady state is reached, which is characteristic of an oscillator circuit as described in the context. The oscillations reach a point where the loop gain drops at the peaks, stabilizing the amplitude.\n\n5. **Annotations and Specific Data Points**: The diagram includes annotations for $V_X$, $V_Y$, $I_{D1}$, and $I_{D2}$, with reference lines at $V_{DD}$ and $I_{SS}/2$. These reference lines help in visualizing the oscillations around these central values. No specific numerical values or markers are provided for peaks or troughs.\n\nFigure 15.28\n\nThe oscillator of Fig. 15.27(c) is constructed in fully differential form. The supply sensitivity of the circuit, however, is nonzero even with perfect symmetry. This is because the drain junction capacitances of $M_{1}$ and $M_{2}$ vary with the supply voltage. We return to this issue in Example 15.9."
},
{
    "text": "1. **Graph Type:**\n- The bottom row illustrates the phase response of the transfer functions, also depicted as Bode plots.\n\n2. **Axes Labels and Units:**\n- The horizontal axis represents angular frequency (ω).\n- The vertical axis denotes the phase angle in degrees.\n\n3. **Behavior and Trends:**\n- Each individual phase plot, ∠H₁ and ∠H₂, initiates at +90° at low frequencies and transitions to -90° at high frequencies, crossing 0° at ω₁.\n- The combined phase response, ∠H₁H₂, starts at +180° and shifts to -180° through ω₁, maintaining a similar transition pattern but with a doubled phase shift due to the multiplication of the two functions.\n\n4. **Key Features and Technical Aspects:**\n- The crossing at 0° (for ∠H₁ and ∠H₂) and at 180° (for ∠H₁H₂) at ω₁ is crucial, indicating the phase shift at resonance.\n- The phase response reflects the inversion and phase shift introduced by each stage and their cumulative effect.\n\n5. **Annotations and Specific Data Points:**\n- The frequency ω₁ is marked as a critical point for both magnitude and phase responses, signifying the resonance point and maximum phase shift.\nimage_name:∠H2\ndescription:The graph labeled \"∠H2\" is part of a series of plots depicting the loop gain characteristics of a circuit. It is a Bode plot focusing on the phase response of the transfer function.\n\n1. **Graph Type and Function:**\n- This is a Bode plot, specifically displaying the phase response of a transfer function.\n\n2. **Axes Labels and Units:**\n- The horizontal axis represents angular frequency (ω), typically in radians per second.\n- The vertical axis measures phase angle in degrees.\n\n3. **Behavior and Trends:**\n- The plot shows a phase response starting at +90 degrees at low frequencies.\n- As frequency increases, the phase decreases, passing through 0 degrees at a specific point, and continues to decline to -90 degrees at high frequencies.\n\n4. **Key Features and Technical Details:**\n- The phase shift starts at +90 degrees and smoothly transitions to -90 degrees.\n- This behavior is typical for a second-order system, where each stage contributes a +90 to -90 degree phase shift.\n- The transition occurs around the resonant frequency ω1, which is marked on the plot.\n- The total phase shift at resonance is 180 degrees, indicating the circuit meets the phase condition for oscillation at this frequency.\n\n5. **Annotations and Specific Data Points:**\n- The critical frequency ω1 is marked as the point of rapid phase shift transition.\n- The plot does not explicitly show numerical values for ω1 but indicates its position relative to the phase shift.\n- The combined phase contributions from two stages (each similar to ∠H2) result in a total phase shift of +180 degrees at low frequencies and -180 degrees at high frequencies, as shown in the combined plot ∠H1H2.\n\nThis phase response is essential for understanding the stability and oscillation conditions of the circuit, demonstrating that the circuit can only oscillate at the designated frequency ω1 due to specific phase shift behavior.\nimage_name:∠H1H2\ndescription:The graph titled \"∠H1H2\" is a Bode plot comprising two main sections: magnitude and phase response, each with multiple subplots.\n\n1. **Magnitude Response**:\n- **Graph Type**: The magnitude plots are frequency response curves.\n- **Axes Labels and Units**: The horizontal axis represents frequency (ω), likely on a logarithmic scale, though not explicitly marked. The vertical axis shows the magnitude of the transfer functions |H1|, |H2|, and their product |H1H2|.\n- **Behavior and Trends**:\n- Each individual magnitude plot, |H1| and |H2|, exhibits a peak at a specific frequency ω1, indicating resonance. These plots are symmetrical and bell-shaped, typical of a bandpass filter.\n- The product |H1H2| also shows a similar bell-shaped curve with a sharper peak at ω1, due to the multiplication of the two responses.\n- **Key Features and Technical Details**: The peak at ω1 signifies the frequency of maximum gain, and the sharpness of the peak in |H1H2| indicates a narrow bandwidth.\n\n2. **Phase Response**:\n- **Graph Type**: The phase plots are phase shift curves.\n- **Axes Labels and Units**: The horizontal axis, like the magnitude plots, represents frequency (ω). The vertical axis measures phase shift in degrees.\n- **Behavior and Trends**:\n- The phase plots for ∠H1 and ∠H2 start at +90° and decrease to -90° with increasing frequency, transitioning smoothly around ω1.\n- The combined phase plot ∠H1H2 starts at +180° and decreases to -180°, showing a similar smooth transition around ω1.\n- **Key Features and Technical Details**: The phase plots indicate a total phase shift of 360° (from +180° to -180°) across the frequency range, critical for determining system stability and oscillation conditions.\n\n3. **Annotations and Specific Data Points**:\n- The plots mark the resonant frequency ω1, highlighting the frequency of interest.\n- Phase shift values are explicitly marked at +90°, -90°, +180°, and -180°, providing clear reference points for analysis.\n\nOverall, the graph depicts the combined magnitude and phase response of a system characterized by two stages, each contributing to the overall behavior observed in the product response |H1H2| and ∠H1H2|. The sharp peaks and phase shifts indicate the system's selective frequency amplification and phase characteristics, crucial for understanding the circuit's oscillation conditions.\n\nFigure 15.26 Loop gain characteristics of the circuit shown in Fig. 15.25.\n\nThe circuit in Fig. 15.25 forms the core of many LC oscillators and is sometimes depicted as in Fig. 15.27(a) or (b). However, the drain currents of $M_{1}$ and $M_{2}$, and thus the output swings, heavily depend on the supply voltage. Since the waveforms at $X$ and $Y$ are differential, Fig. 15.27(b) suggests that $M_{1}$ and $M_{2}$ can be converted to a differential pair as shown in Fig. 15.27(c), where the total bias current is defined by $I_{S S}$.\n\n#### Example 15.6\n\nFor the circuit in Fig. 15.27(c), plot $V_{X}$, $V_{Y}$, $I_{D 1}$, and $I_{D 2}$ as the oscillation begins.\nimage_name:(a)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: GND, D: X, G: Y}\nname: M2, type: NMOS, ports: {S: GND, D: Y, G: X}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\n]\nextrainfo:The circuit is a differential oscillator with two NMOS transistors M1 and M2, forming a cross-coupled pair. Capacitors CP, resistors RP, and inductors LP form the resonant tank circuits connected to VDD. Nodes X and Y are the differential outputs, grounded at the source of both transistors.\n\nimage_name:(b)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: GND, D: X, G: Y}\nname: M2, type: NMOS, ports: {S: GND, D: Y, G: X}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\n]\nextrainfo:The circuit is a differential oscillator with two NMOS transistors M1 and M2, forming a cross-coupled pair. Capacitors CP, resistors RP, and inductors LP form the resonant tank circuits connected to VDD. Nodes X and Y are the differential outputs, grounded at the source of both transistors.\n\nimage_name:(c)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: P, D: X, G: Y}\nname: M2, type: NMOS, ports: {S: P, D: Y, G: X}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\nname: ISS, type: CurrentSource, value: ISS, ports: {Np: P, Nn: GND}\n]\nextrainfo:The circuit is a differential oscillator with two NMOS transistors M1 and M2, forming a cross-coupled pair. Capacitors CP, resistors RP, and inductors LP form the resonant tank circuits connected to VDD. Nodes X and Y are the differential outputs, grounded at the source of both transistors. The tail current source ISS is used to reduce supply sensitivity.\n\nFigure 15.27 (a) Redrawn oscillator from Fig. 15.25; (b) another representation of the circuit; (c) addition of tail current source to reduce supply sensitivity.\n\n#### Solution\n\nIf the circuit starts with no difference between $V_{X}$ and $V_{Y}$, then $V_{X}=V_{Y} \\approx V_{D D}$. The two transistors equally share the tail current. If $\\left(g_{m 1,2} R_{P}\\right)^{2} \\geq 1$, where $R_{P}$ is the equivalent parallel resistance of the tank at resonance, noise components at the resonant frequency are amplified by $M_{1}$ and $M_{2}$, allowing the oscillation to grow. The drain currents of $M_{1}$ and $M_{2}$ vary based on the instantaneous value of $V_{X}-V_{Y}$ (as in a differential pair).\n\nAs shown in Fig. 15.28, the oscillation amplitude increases until the loop gain decreases at the peaks. In fact, if $g_{m 1,2} R_{P}$ is sufficiently large, the difference between $V_{X}-V_{Y}$ reaches a level that directs the entire tail current to one transistor, turning the other off. Thus, in steady state, $I_{D 1}$ and $I_{D 2}$ vary between zero and $I_{S S}$.\nimage_name:Figure 15.28\ndescription:The graph in Figure 15.28 shows time-domain waveforms illustrating the behavior of voltages $V_X$ and $V_Y$, and drain currents $I_{D1}$ and $I_{D2}$ over time. The horizontal axis represents time ($t$), while the vertical axis is used for both voltage and current, though units are not explicitly marked.\n\n1. **Graph Type and Function**: This is a time-domain waveform graph depicting oscillations in voltages and currents.\n\n2. **Axes Labels and Units**: The horizontal axis is labeled with time ($t$), with no specific time units provided. The vertical axis has references at $V_{DD}$ for voltages $V_X$ and $V_Y$, and $I_{SS}/2$ for currents $I_{D1}$ and $I_{D2}$. Units for voltage and current are not specified but are likely in volts and amperes, respectively.\n\n3. **Behavior and Trends**: The graph shows $V_X$ and $V_Y$ starting with small oscillations around $V_{DD}$ and increasing in amplitude over time. Similarly, $I_{D1}$ and $I_{D2}$ oscillate around $I_{SS}/2$ with growing amplitude. The oscillations appear sinusoidal and symmetric, indicating stable oscillatory behavior as time progresses.\n\n4. **Key Features and Technical Details**: The main feature is the increasing amplitude of oscillations for both voltage and current over time, suggesting a growing oscillation amplitude until a steady state is reached, typical of an oscillator circuit. The oscillations stabilize when the loop gain decreases at the peaks.\n\n5. **Annotations and Specific Data Points**: The diagram includes annotations for $V_X$, $V_Y$, $I_{D1}$, and $I_{D2}$, with reference lines at $V_{DD}$ and $I_{SS}/2$. These lines help visualize the oscillations around these central values. No specific numerical values or markers are provided for peaks or troughs.\n\nFigure 15.28\n\nThe oscillator in Fig. 15.27(c) is designed in a fully differential configuration. However, the circuit's supply sensitivity is not zero, even with perfect symmetry. This is due to the drain junction capacitances of $M_{1}$ and $M_{2}$ varying with the supply voltage. This issue is revisited in Example 15.9."
},
{
    "text": "1. **Type of Graph:**\n- The bottom row illustrates the phase response of the transfer functions, also depicted as Bode plots.\n\n2. **Axes Labels and Units:**\n- The horizontal axis represents angular frequency (ω).\n- The vertical axis depicts the phase angle in degrees.\n\n3. **Overall Behavior and Trends:**\n- Each individual phase plot, ∠H₁ and ∠H₂, initiates at +90° at low frequencies and transitions to -90° at high frequencies, crossing 0° at ω₁.\n- The combined phase response, ∠H₁H₂, starts at +180° and shifts to -180° through ω₁, maintaining a similar transition pattern but with a doubled phase shift due to the multiplication of the two functions.\n\n4. **Key Features and Technical Details:**\n- The crossing at 0° (for ∠H₁ and ∠H₂) and at 180° (for ∠H₁H₂) at ω₁ is a critical juncture, indicating the phase shift at resonance.\n- The phase response highlights the inversion and phase shift introduced by each stage and their cumulative effect.\n\n5. **Annotations and Specific Data Points:**\n- The frequency ω₁ is designated as a critical frequency for both magnitude and phase responses, marking the point of resonance and maximum phase shift.\nimage_name:∠H2\ndescription:The graph titled \"∠H2\" is part of a series of plots depicting the loop gain characteristics of a circuit. It is a Bode plot focusing on the phase response of the transfer function.\n\n1. **Type of Graph and Function:**\n- This graph is a Bode plot, specifically illustrating the phase response of a transfer function.\n\n2. **Axes Labels and Units:**\n- The horizontal axis denotes angular frequency (ω), typically measured in radians per second.\n- The vertical axis represents the phase angle, measured in degrees.\n\n3. **Overall Behavior and Trends:**\n- The plot depicts a phase response that starts at +90 degrees at low frequencies.\n- As the frequency increases, the phase decreases, passing through 0 degrees at a specific point, and continues to decline to -90 degrees at high frequencies.\n\n4. **Key Features and Technical Details:**\n- The phase shift initiates at +90 degrees and transitions smoothly to -90 degrees.\n- This behavior is typical for a second-order system, where each stage contributes a phase shift from +90 to -90 degrees.\n- The transition occurs around the resonant frequency ω1, which is marked on the plot.\n- The total phase shift at resonance is 180 degrees, indicating that the circuit meets the phase condition for oscillation at this frequency.\n\n5. **Annotations and Specific Data Points:**\n- The critical frequency ω1 is marked as the point where the phase shift changes rapidly.\n- The plot does not explicitly show numerical values for ω1 but indicates its position relative to the phase shift.\n- The combined phase contributions from two stages (each similar to ∠H2) result in a total phase shift of +180 degrees at low frequencies and -180 degrees at high frequencies, as shown in the combined plot ∠H1H2.\n\nThis phase response is essential for understanding the stability and oscillation conditions of the circuit, as it demonstrates that the circuit can only oscillate at the designated frequency ω1 due to the specific phase shift behavior.\nimage_name:∠H1H2\ndescription:The graph titled \"∠H1H2\" is a Bode plot comprising two main sections: magnitude and phase response, each consisting of multiple subplots.\n\n1. **Magnitude Response**:\n- **Type of Graph**: The magnitude plots are presented as frequency response curves.\n- **Axes Labels and Units**: The horizontal axis represents frequency (ω), likely on a logarithmic scale, though not explicitly marked. The vertical axis depicts the magnitude of the transfer functions |H1|, |H2|, and their product |H1H2|.\n- **Overall Behavior and Trends**:\n- Each individual magnitude plot, |H1| and |H2|, exhibits a peak at a specific frequency ω1, indicating a resonant frequency. These plots are symmetrical and bell-shaped, characteristic of a bandpass filter.\n- The product |H1H2| also displays a similar bell-shaped curve with a sharper peak at the same frequency ω1, due to the multiplication of the two responses.\n- **Key Features and Technical Details**: The peak at ω1 signifies the frequency at which the system achieves maximum gain, and the sharpness of the peak in |H1H2| indicates a narrow bandwidth.\n\n2. **Phase Response**:\n- **Type of Graph**: The phase plots are depicted as phase shift curves.\n- **Axes Labels and Units**: The horizontal axis is the same as the magnitude plots, representing frequency (ω). The vertical axis denotes the phase shift in degrees.\n- **Overall Behavior and Trends**:\n- The phase plots for ∠H1 and ∠H2 each start at +90° and decrease to -90° as the frequency increases, with a smooth transition around ω1.\n- The combined phase plot ∠H1H2 starts at +180° and decreases to -180°, showing a similar smooth transition around ω1.\n- **Key Features and Technical Details**: The phase plots indicate a total phase shift of 360° (from +180° to -180°) across the frequency range, which is crucial for determining the stability and oscillation conditions of the system.\n\n3. **Annotations and Specific Data Points**:\n- The plots are marked with the resonant frequency ω1, highlighting the frequency of interest.\n- The phase shift values are explicitly marked at +90°, -90°, +180°, and -180°, providing clear reference points for analysis.\n\nOverall, the graph illustrates the combined magnitude and phase response of a system characterized by two stages, each contributing to the overall behavior observed in the product response |H1H2| and ∠H1H2. The sharp peaks and phase shifts are indicative of the system's selective frequency amplification and phase characteristics, crucial for understanding the oscillation conditions of the circuit in question.\n\nFigure 15.26 Loop gain characteristics of the circuit shown in Fig. 15.25.\n\nThe circuit of Fig. 15.25 serves as the core of many LC oscillators and is sometimes depicted as in Fig. 15.27(a) or (b). However, the drain currents of $M_{1}$ and $M_{2}$, and thus the output swings, heavily depend on the supply voltage. Since the waveforms at $X$ and $Y$ are differential, the drawing in Fig. 15.27(b) suggests that $M_{1}$ and $M_{2}$ can be converted to a differential pair as shown in Fig. 15.27(c), where the total bias current is defined by $I_{S S}$.\n\n#### Example 15.6\n\nFor the circuit of Fig. 15.27(c), plot $V_{X}$ and $V_{Y}$ and $I_{D 1}$ and $I_{D 2}$ as the oscillation begins.\nimage_name:(a)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: GND, D: X, G: Y}\nname: M2, type: NMOS, ports: {S: GND, D: Y, G: X}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\n]\nextrainfo:The circuit is a differential oscillator with two NMOS transistors M1 and M2, each forming a cross-coupled pair. The capacitors CP, resistors RP, and inductors LP are used to form the resonant tank circuits connected to VDD. The nodes X and Y are the differential outputs, and the circuit is grounded at the source of both transistors.\n\nimage_name:(b)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: GND, D: X, G: Y}\nname: M2, type: NMOS, ports: {S: GND, D: Y, G: X}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\n]\nextrainfo:The circuit is a differential oscillator with two NMOS transistors M1 and M2, forming a cross-coupled pair. Capacitors CP, resistors RP, and inductors LP form the resonant tank circuits connected to VDD. Nodes X and Y are the differential outputs, grounded at the source of both transistors.\n\nimage_name:(c)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: P, D: X, G: Y}\nname: M2, type: NMOS, ports: {S: P, D: Y, G: X}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\nname: ISS, type: CurrentSource, value: ISS, ports: {Np: P, Nn: GND}\n]\nextrainfo:The circuit is a differential oscillator with two NMOS transistors M1 and M2, forming a cross-coupled pair. Capacitors CP, resistors RP, and inductors LP form the resonant tank circuits connected to VDD. Nodes X and Y are the differential outputs, grounded at the source of both transistors. The tail current source ISS is used to lower supply sensitivity.\n\nFigure 15.27 (a) Redrawing of the oscillator shown in Fig. 15.25; (b) another redrawing of the circuit; (c) addition of tail current source to lower supply sensitivity.\n\n#### Solution\n\nIf the circuit starts with zero difference between $V_{X}$ and $V_{Y}$, then $V_{X}=V_{Y} \\approx V_{D D}$. The two transistors share the tail current equally. If $\\left(g_{m 1,2} R_{P}\\right)^{2} \\geq 1$, where $R_{P}$ is the equivalent parallel resistance of the tank at resonance, then noise components at the resonance frequency are amplified by $M_{1}$ and $M_{2}$, allowing the oscillation to grow. The drain currents of $M_{1}$ and $M_{2}$ vary according to the instantaneous value of $V_{X}-V_{Y}$ (as in a differential pair).\n\nAs depicted in Fig. 15.28, the oscillation amplitude increases until the loop gain decreases at the peaks. In fact, if $g_{m 1,2} R_{P}$ is sufficiently large, the difference between $V_{X}-V_{Y}$ reaches a level that directs the entire tail current to one transistor, turning the other off. Thus, in the steady state, $I_{D 1}$ and $I_{D 2}$ vary between zero and $I_{S S}$.\nimage_name:Figure 15.28\ndescription:The graph in Figure 15.28 is a time-domain waveform showing the behavior of voltages $V_X$ and $V_Y$, and drain currents $I_{D1}$ and $I_{D2}$ over time. The horizontal axis represents time ($t$), while the vertical axis is used for both voltage and current, though not explicitly labeled with units.\n\n1. **Type of Graph and Function**: This is a time-domain waveform graph depicting oscillations in voltages and currents.\n\n2. **Axes Labels and Units**: The horizontal axis is labeled with time ($t$), with no specific time units provided. The vertical axis has two references: $V_{DD}$ for the voltages $V_X$ and $V_Y$, and $I_{SS}/2$ for the currents $I_{D1}$ and $I_{D2}$. The units for voltage and current are not specified but are likely in volts and amperes, respectively.\n\n3. **Overall Behavior and Trends**: The graph shows that both $V_X$ and $V_Y$ start with small oscillations around $V_{DD}$ and increase in amplitude over time. Similarly, $I_{D1}$ and $I_{D2}$ oscillate around $I_{SS}/2$ with increasing amplitude. The oscillations for both voltage and current appear sinusoidal and symmetric, indicating a stable oscillatory behavior as time progresses.\n\n4. **Key Features and Technical Details**: The key feature is the increasing amplitude of oscillations for both voltage and current over time. This suggests a growing oscillation amplitude until a steady state is reached, which is characteristic of an oscillator circuit as described in the context. The oscillations reach a point where the loop gain decreases at the peaks, stabilizing the amplitude.\n\n5. **Annotations and Specific Data Points**: The diagram includes annotations for $V_X$, $V_Y$, $I_{D1}$, and $I_{D2}$, with reference lines at $V_{DD}$ and $I_{SS}/2$. These reference lines help in visualizing the oscillations around these central values. No specific numerical values or markers are provided for peaks or troughs.\n\nFigure 15.28\n\nThe oscillator of Fig. 15.27(c) is constructed in a fully differential form. However, the supply sensitivity of the circuit is nonzero even with perfect symmetry. This is because the drain junction capacitances of $M_{1}$ and $M_{2}$ vary with the supply voltage. We return to this issue in Example 15.9."
},
{
    "text": "1. **Graph Type:**\n- The lower row displays the phase response of the transfer functions, also depicted as Bode plots.\n\n2. **Axis Labels and Units:**\n- The horizontal axis again denotes angular frequency (ω).\n- The vertical axis indicates phase angle in degrees.\n\n3. **General Behavior and Trends:**\n- Each individual phase plot, ∠H₁ and ∠H₂, initiates at +90° at low frequencies and shifts to -90° at high frequencies, crossing 0° at ω₁.\n- The combined phase response, ∠H₁H₂, begins at +180° and transitions to -180° through ω₁, exhibiting a similar transition shape but with a doubled phase shift due to the multiplication of the two functions.\n\n4. **Key Characteristics and Technical Aspects:**\n- The 0° crossing (for ∠H₁ and ∠H₂) and the 180° crossing (for ∠H₁H₂) at ω₁ are pivotal points, signifying the phase shift at resonance.\n- The phase response illustrates the inversion and phase shift introduced by each stage and their collective impact.\n\n5. **Annotations and Specific Data Points:**\n- The frequency ω₁ is designated as a critical frequency for both magnitude and phase responses, marking the resonance point and maximum phase shift.\nimage_name:∠H2\ndescription:The graph labeled \"∠H2\" is part of a series of plots depicting the loop gain characteristics of a circuit. It is a Bode plot focusing on the phase response of the transfer function.\n\n1. **Graph Type and Function:**\n- This is a Bode plot, specifically illustrating the phase response of a transfer function.\n\n2. **Axis Labels and Units:**\n- The horizontal axis represents angular frequency (ω), typically measured in radians per second.\n- The vertical axis denotes phase angle, measured in degrees.\n\n3. **General Behavior and Trends:**\n- The plot depicts a phase response starting at +90 degrees at low frequencies.\n- As the frequency rises, the phase decreases, passing through 0 degrees at a specific point, and continues to decline to -90 degrees at high frequencies.\n\n4. **Key Characteristics and Technical Aspects:**\n- The phase shift initiates at +90 degrees and smoothly transitions to -90 degrees.\n- This behavior is typical for a second-order system, where each stage contributes a +90 to -90 degree phase shift.\n- The transition occurs around the resonant frequency ω1, which is marked on the plot.\n- The total phase shift at resonance is 180 degrees, indicating the circuit meets the phase condition for oscillation at this frequency.\n\n5. **Annotations and Specific Data Points:**\n- The critical frequency ω1 is marked as the point of rapid phase shift transition.\n- The plot does not explicitly show numerical values for ω1 but indicates its position relative to the phase shift.\n- The combined phase contributions from two stages (each similar to ∠H2) result in a total phase shift of +180 degrees at low frequencies and -180 degrees at high frequencies, as shown in the combined plot ∠H1H2.\n\nThis phase response is essential for understanding the circuit's stability and oscillation conditions, demonstrating that the circuit can only oscillate at the designated frequency ω1 due to the specific phase shift behavior.\nimage_name:∠H1H2\ndescription:The graph titled \"∠H1H2\" is a Bode plot comprising two main sections: magnitude and phase response, each consisting of multiple subplots.\n\n1. **Magnitude Response**:\n- **Graph Type**: The magnitude plots are depicted as frequency response curves.\n- **Axis Labels and Units**: The horizontal axis represents frequency (ω), likely on a logarithmic scale, though not explicitly marked. The vertical axis represents the magnitude of the transfer functions |H1|, |H2|, and their product |H1H2|.\n- **General Behavior and Trends**:\n- Each individual magnitude plot, |H1| and |H2|, exhibits a peak at a specific frequency ω1, indicating a resonant frequency. These plots are symmetrical and bell-shaped, typical of a bandpass filter.\n- The product |H1H2| also shows a similar bell-shaped curve with a sharper peak at the same frequency ω1, due to the multiplication of the two responses.\n- **Key Characteristics and Technical Aspects**: The peak at ω1 signifies the frequency of maximum gain, and the sharpness of the peak in |H1H2| indicates a narrow bandwidth.\n\n2. **Phase Response**:\n- **Graph Type**: The phase plots are depicted as phase shift curves.\n- **Axis Labels and Units**: The horizontal axis is the same as the magnitude plots, representing frequency (ω). The vertical axis denotes phase shift in degrees.\n- **General Behavior and Trends**:\n- The phase plots for ∠H1 and ∠H2 each start at +90° and decrease to -90° as frequency increases, with a smooth transition around ω1.\n- The combined phase plot ∠H1H2 starts at +180° and decreases to -180°, showing a similar smooth transition around ω1.\n- **Key Characteristics and Technical Aspects**: The phase plots indicate a total phase shift of 360° (from +180° to -180°) across the frequency range, critical for determining the system's stability and oscillation conditions.\n\n3. **Annotations and Specific Data Points**:\n- The plots are marked with the resonant frequency ω1, highlighting the frequency of interest.\n- The phase shift values are explicitly marked at +90°, -90°, +180°, and -180°, providing clear reference points for analysis.\n\nOverall, the graph illustrates the combined magnitude and phase response of a system characterized by two stages, each contributing to the overall behavior observed in the product response |H1H2| and ∠H1H2. The sharp peaks and phase shifts are indicative of the system's selective frequency amplification and phase characteristics, crucial for understanding the circuit's oscillation conditions.\n\nFigure 15.26 Loop gain characteristics of the circuit shown in Fig. 15.25.\n\nThe circuit in Fig. 15.25 serves as the core for many LC oscillators and is sometimes depicted as in Fig. 15.27(a) or (b). However, the drain currents of $M_{1}$ and $M_{2}$, and thus the output swings, heavily rely on the supply voltage. Since the waveforms at $X$ and $Y$ are differential, Fig. 15.27(b) suggests that $M_{1}$ and $M_{2}$ can be converted to a differential pair as shown in Fig. 15.27(c), where the total bias current is defined by $I_{S S}$.\n\n#### Example 15.6\n\nFor the circuit in Fig. 15.27(c), plot $V_{X}$, $V_{Y}$, $I_{D 1}$, and $I_{D 2}$ as the oscillation begins.\nimage_name:(a)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: GND, D: X, G: Y}\nname: M2, type: NMOS, ports: {S: GND, D: Y, G: X}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\n]\nextrainfo:The circuit is a differential oscillator with two NMOS transistors M1 and M2, each forming a cross-coupled pair. Capacitors CP, resistors RP, and inductors LP form the resonant tank circuits connected to VDD. Nodes X and Y are the differential outputs, grounded at the source of both transistors.\n\nimage_name:(b)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: GND, D: X, G: Y}\nname: M2, type: NMOS, ports: {S: GND, D: Y, G: X}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\n]\nextrainfo:The circuit is a differential oscillator with two NMOS transistors M1 and M2, forming a cross-coupled pair. Capacitors CP, resistors RP, and inductors LP form the resonant tank circuits connected to VDD. Nodes X and Y are the differential outputs, grounded at the source of both transistors.\n\nimage_name:(c)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: P, D: X, G: Y}\nname: M2, type: NMOS, ports: {S: P, D: Y, G: X}\nname: RP1, type: Resistor, value: RP, ports: {N1: VDD, N2: X}\nname: RP2, type: Resistor, value: RP, ports: {N1: VDD, N2: Y}\nname: CP1, type: Capacitor, value: CP, ports: {Np: VDD, Nn: X}\nname: CP2, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Y}\nname: LP1, type: Inductor, value: LP, ports: {N1: VDD, N2: X}\nname: LP2, type: Inductor, value: LP, ports: {N1: VDD, N2: Y}\nname: ISS, type: CurrentSource, value: ISS, ports: {Np: P, Nn: GND}\n]\nextrainfo:The circuit is a differential oscillator with two NMOS transistors M1 and M2, forming a cross-coupled pair. Capacitors CP, resistors RP, and inductors LP form the resonant tank circuits connected to VDD. Nodes X and Y are the differential outputs, grounded at the source of both transistors. The tail current source ISS is used to reduce supply sensitivity.\n\nFigure 15.27 (a) Redrawing of the oscillator shown in Fig. 15.25; (b) another redrawing of the circuit; (c) addition of tail current source to reduce supply sensitivity.\n\n#### Solution\n\nIf the circuit starts with no difference between $V_{X}$ and $V_{Y}$, then $V_{X}=V_{Y} \\approx V_{D D}$. The two transistors equally share the tail current. If $\\left(g_{m 1,2} R_{P}\\right)^{2} \\geq 1$, where $R_{P}$ is the equivalent parallel resistance of the tank at resonance, noise components at the resonance frequency are amplified by $M_{1}$ and $M_{2}$, allowing the oscillation to grow. The drain currents of $M_{1}$ and $M_{2}$ vary based on the instantaneous value of $V_{X}-V_{Y}$ (as in a differential pair).\n\nAs depicted in Fig. 15.28, the oscillation amplitude increases until the loop gain decreases at the peaks. In fact, if $g_{m 1,2} R_{P}$ is sufficiently large, the difference between $V_{X}-V_{Y}$ reaches a level that directs the entire tail current to one transistor, turning the other off. Thus, in the steady state, $I_{D 1}$ and $I_{D 2}$ fluctuate between zero and $I_{S S}$.\nimage_name:Figure 15.28\ndescription:The graph in Figure 15.28 is a time-domain waveform showing the behavior of voltages $V_X$ and $V_Y$, and drain currents $I_{D1}$ and $I_{D2}$ over time. The horizontal axis represents time ($t$), while the vertical axis is used for both voltage and current, though not explicitly labeled with units.\n\n1. **Graph Type and Function**: This is a time-domain waveform graph depicting oscillations in voltages and currents.\n\n2. **Axis Labels and Units**: The horizontal axis is labeled with time ($t$), without specific time units provided. The vertical axis has two references: $V_{DD}$ for voltages $V_X$ and $V_Y$, and $I_{SS}/2$ for currents $I_{D1}$ and $I_{D2}$. The units for voltage and current are not specified but are likely in volts and amperes, respectively.\n\n3. **General Behavior and Trends**: The graph shows that both $V_X$ and $V_Y$ initiate with small oscillations around $V_{DD}$ and grow in amplitude over time. Similarly, $I_{D1}$ and $I_{D2}$ oscillate around $I_{SS}/2$ with increasing amplitude. The oscillations for both voltage and current appear sinusoidal and symmetric, indicating stable oscillatory behavior as time progresses.\n\n4. **Key Characteristics and Technical Details**: The key feature is the increasing amplitude of oscillations for both voltage and current over time. This suggests a growing oscillation amplitude until a steady state is reached, characteristic of an oscillator circuit as described. The oscillations reach a point where the loop gain decreases at the peaks, stabilizing the amplitude.\n\n5. **Annotations and Specific Data Points**: The diagram includes annotations for $V_X$, $V_Y$, $I_{D1}$, and $I_{D2}$, with reference lines at $V_{DD}$ and $I_{SS}/2$. These reference lines help visualize the oscillations around these central values. No specific numerical values or markers are provided for peaks or troughs.\n\nFigure 15.28\n\nThe oscillator in Fig. 15.27(c) is designed in a fully differential configuration. However, the circuit's supply sensitivity is not zero even with perfect symmetry. This is due to the drain junction capacitances of $M_{1}$ and $M_{2}$ varying with the supply voltage. This issue is revisited in Example 15.9."
},
{
    "text": "An LC oscillator can be implemented using just one transistor in the signal path. Reconsider the gain stage depicted in Fig. 15.23(a) and recall that the drain voltage cannot be applied to the gate because the overall phase shift at resonance is $180^{\\circ}$, not $360^{\\circ}$. Additionally, remember that in a common-gate stage, the phase shift from the source to the drain is zero. We can infer that if, as illustrated in Fig. 15.29(a), the drain voltage is fed back to the source instead of the gate, the circuit might oscillate. The feedback must include a capacitor to prevent disruption of the bias point of $M_{1}$.\n\n**Figure 15.29 (a) Description:**\n- **LP:** Inductor, connected between VDD and Vout\n- **RP:** Resistor, connected between VDD and Vout\n- **CP:** Capacitor, connected between VDD and Vout\n- **M1:** NMOS transistor, with source connected to s1, drain to Vout, and gate to Vb\n- **C2:** Capacitor, connected between Vout and s1\n- **Ib:** Current source, connected between s1 and GND\n- **VDD:** Voltage source, connected between VDD and GND\n\n**Extra Info:** The circuit is a tuned stage with feedback from the drain to the source. It includes an NMOS transistor M1, with feedback provided through capacitor C2 to avoid disturbing the bias point. The circuit is designed for oscillation but does not oscillate due to insufficient loop gain.\n\n**Figure 15.29 (b) Description:**\n- **M1:** NMOS transistor, with source connected to S1, drain to Vout, and gate to Vb\n- **LP:** Inductor, connected between VDD and Vout\n- **RP:** Resistor, connected between VDD and Vout\n- **CP:** Capacitor, connected between VDD and Vout\n- **C2:** Capacitor, connected between Vout and S1\n- **Ib:** Current source, connected between S1 and GND\n- **Iin:** Current source, connected between GND and s1\n- **VDD:** Voltage source, connected between VDD and GND\n\n**Extra Info:** The circuit is a feedback system with insufficient loop gain to oscillate. It includes an NMOS transistor with feedback from the drain to the source, a tank circuit with an inductor, resistor, and capacitor, and a bias current source. An additional input current source is present to calculate the closed-loop gain.\n\n**Figure 15.29 (a):** Tuned stage with feedback applied from drain to source; **(b):** Addition of input current to calculate closed-loop gain.\n\nUnfortunately, due to insufficient loop gain, the circuit in Fig. 15.29(a) does not oscillate. To demonstrate this, we refer to the perspective in Fig. 15.1, where an oscillator is viewed as a feedback system with infinite closed-loop gain. By applying an input current as shown in Fig. 15.29(b) and ignoring transistor parasitics, we derive the closed-loop gain as\n\n$$\n\\begin{equation*}\n\\frac{V_{\\text {out }}}{I_{\\text {in }}}=L_{P} s\\left\\|\\frac{1}{C_{P} S}\\right\\| R_{P} \\tag{15.37}\n\\end{equation*}\n$$\n\nbecause $M_{1}$ and $C_{2}$ directly conduct the input current to the tank. Since the closed-loop gain cannot be infinite at any frequency, the circuit fails to oscillate.\n\n#### Example 15.7\n\nOne might wonder why the input to the feedback system is implemented as a current source applied to the transistor's source rather than a voltage source applied to its gate. Perform the analysis with the latter stimulus.\n\n#### Solution\n\nFrom Fig. 15.30, we observe that with a finite variation in $V_{i n}$, the change in $I_{b}$ remains zero if the bias current source is ideal. Thus, if the source-bulk junction capacitance of $M_{1}$ is neglected, the change in the tank current is zero, resulting in $V_{\\text {out }} / V_{\\text {in }}=0$. Interestingly, $V_{X}$ does vary with $V_{i n}$, but $M_{1}$ generates a small-signal current that cancels that through $C_{2}$. One can show that $V_{X} / V_{i n}=g_{m} /\\left(g_{m}+C_{2} s\\right)$.\n\nThis example highlights two key points. First, to initiate oscillation in a circuit, the stimulus can be applied at various points. (That is, the noise from any device in the loop can start the oscillation.) Second, in Fig. 15.30, $V_{\\text {out }} / V_{\\text {in }}$ is zero because the impedance between the source of $M_{1}$ and ground is infinite. We then add a capacitor from this node to ground as shown in Fig. 15.31(a), seeking oscillation conditions. Note that the capacitor in parallel with $L_{P}$ is removed. The reason will become clear later.\n\n**Figure 15.30 Description:**\n- **Vin:** Voltage source, connected between Vin and GND\n- **Ib:** Current source, connected between X and GND\n- **M1:** NMOS transistor, with source connected to X, drain to Vout, and gate to Vin\n- **RP:** Resistor, connected between Vout and VDD\n- **CP:** Capacitor, connected between Vout and VDD\n- **C2:** Capacitor, connected between Vout and X\n- **LP:** Inductor, connected between VDD and Vout\n\n**Extra Info:** The circuit is an oscillator with an NMOS transistor M1 and a tank circuit consisting of RP, CP, and LP. The input voltage Vin controls the gate of M1, and the current source Ib biases the circuit. The output Vout is taken across the tank circuit.\n\n**Figure 15.30**\n\n**Figure 15.31 (a) Description:**\n- **LP:** Inductor, connected between VDD and Vout\n- **RP:** Resistor, connected between VDD and Vout\n- **M1:** NMOS transistor, with source connected to GND, drain to Vout, and gate to Vb\n- **C2:** Capacitor, connected between Vout and s1\n- **Is:** Current source, connected between s1 and GND\n- **C1:** Capacitor, connected between s1 and GND\n\n**Extra Info:** This circuit is a Colpitts oscillator. The inductor LP and resistor RP form a parallel tank circuit connected to the drain of the NMOS transistor M1. The output Vout is taken across the tank circuit, and the transistor is biased by the voltage source S1 at the gate. Capacitors C1 and C2 are used to provide feedback necessary for oscillation.\n\n**Figure 15.31 (b) Description:**\n- **V1:** Voltage source, connected between GND and x\n- **Iin:** Current source, connected between GND and X\n- **gmV1:** Voltage-controlled current source, connected between Vout and x\n- **C1:** Capacitor, connected between x and GND\n- **C2:** Capacitor, connected between Vout and x\n- **LP:** Inductor, connected between Vout and GND\n- **RP:** Resistor, connected between Vout and GND\n\n**Extra Info:** This circuit is a Colpitts oscillator. The voltage source V1 biases the circuit, while the current source Iin provides input stimulus. The voltage-controlled current source gmV1 models the active device. Capacitors C1 and C2, along with inductor LP and resistor RP, form the feedback network necessary for oscillation. The output is taken across the parallel combination of LP and RP.\n\n**Figure 15.31 (a) Colpitts oscillator; (b) equivalent circuit of (a) with input stimulus.**\n\nBy approximating $M_{1}$ as a single voltage-dependent current source, we construct the equivalent circuit shown in Fig. 15.31(b). Since the current through the parallel combination of $L_{P}$ and $R_{P}$ is given by $V_{\\text {out }} /\\left(L_{P} s\\right)+V_{\\text {out }} / R_{P}$, the total current through $C_{1}$ equals $I_{\\text {in }}-V_{\\text {out }} /\\left(L_{P} s\\right)-V_{\\text {out }} / R_{P}$, yielding\n\n$$\n\\begin{equation*}\nV_{1}=-\\left(I_{\\text {in }}-\\frac{V_{\\text {out }}}{L_{P} S}-\\frac{V_{\\text {out }}}{R_{P}}\\right) \\frac{1}{C_{1} S} \\tag{15.38}\n\\end{equation*}\n$$\n\nExpressing the current through $C_{2}$ as $\\left(V_{\\text {out }}+V_{1}\\right) C_{2} s$, we sum all currents at the output node:\n\n$$\n\\begin{equation*}\n-g_{m}\\left(I_{\\text {in }}-\\frac{V_{\\text {out }}}{L_{P} S}-\\frac{V_{\\text {out }}}{R_{P}}\\right) \\frac{1}{C_{1} s}+\\left[V_{\\text {out }}-\\left(I_{\\text {in }}-\\frac{V_{\\text {out }}}{L_{P} S}-\\frac{V_{\\text {out }}}{R_{P}}\\right) \\frac{1}{C_{1} s}\\right] C_{2} s+\\frac{V_{\\text {out }}}{L_{P} S}+\\frac{V_{\\text {out }}}{R_{P}}=0 \\tag{15.39}\n\\end{equation*}\n$$\n\nFrom this, we obtain\n\n$$\n\\begin{equation*}\n\\frac{V_{\\text {out }}}{I_{\\text {in }}}=\\frac{R_{P} L_{P} s\\left(g_{m}+C_{2} s\\right)}{R_{P} C_{1} C_{2} L_{P} s^{3}+\\left(C_{1}+C_{2}\\right) L_{P} s^{2}+\\left[g_{m} L_{P}+R_{P}\\left(C_{1}+C_{2}\\right)\\right] s+g_{m} R_{P}} \\tag{15.40}\n\\end{equation*}\n$$\n\n[^105]Note that, as expected, (15.40) simplifies to $\\left(L_{P} S \\| R_{P}\\right)$ if $C_{1}=0$. The circuit oscillates if the closed-loop transfer function becomes infinite at an imaginary value of $s, s_{R}=j \\omega_{R}$. Consequently, both the real and imaginary parts of the denominator must be zero at this frequency:\n\n$$\n\\begin{align*}\n& -R_{P} C_{1} C_{2} L_{P} \\omega_{R}^{3}+\\left[g_{m} L_{P}+R_{P}\\left(C_{1}+C_{2}\\right)\\right] \\omega_{R}=0  \\tag{15.41}\\\\\n& -\\left(C_{1}+C_{2}\\right) L_{P} \\omega_{R}^{2}+g_{m} R_{P}=0 \\tag{15.42}\n\\end{align*}\n$$\n\nGiven typical values, $g_{m} L_{P} \\ll R_{P}\\left(C_{1}+C_{2}\\right)$, Eq. (15.41) yields\n\n$$\n\\begin{equation*}\n\\omega_{R}^{2}=\\frac{1}{L_{P} \\frac{C_{1} C_{2}}{C_{1}+C_{2}}} \\tag{15.43}\n\\end{equation*}\n$$\n\nand Eq. (15.42) results in\n\n$$\n\\begin{align*}\ng_{m} R_{P} & =\\frac{\\left(C_{1}+C_{2}\\right)^{2}}{C_{1} C_{2}}  \\tag{15.44}\\\\\n& =\\frac{C_{1}}{C_{2}}\\left(1+\\frac{C_{2}}{C_{1}}\\right)^{2} \\tag{15.45}\n\\end{align*}\n$$\n\nRecognizing that $g_{m} R_{P}$ is the voltage gain from the source of $M_{1}$ to the output (if $g_{m b}=0$), we determine the ratio $C_{1} / C_{2}$ for the minimum required gain. One can show that the minimum occurs for $C_{1} / C_{2}=1$, requiring\n\n$$\n\\begin{equation*}\ng_{m} R_{P} \\geq 4 \\tag{15.46}\n\\end{equation*}\n$$\n\nEquation (15.46) highlights a significant drawback of the Colpitts oscillator compared to the cross-coupled topology of Fig. 15.27(c). The former requires a voltage gain of at least 4 at resonance, while the latter needs only unity. This is crucial if the inductor has a low $Q$ and thus a small $R_{P}$, a common issue in CMOS technologies. As a result, the cross-coupled configuration is more widely used.\n\nThe previous analysis omitted the capacitance that appears in parallel with the inductor. As suggested in Problem 15.10, if this capacitance, $C_{P}$, is included in the equivalent circuit, Eq. (15.43) is modified to\n\n$$\n\\begin{equation*}\n\\omega_{R}^{2}=\\frac{1}{L_{P}\\left(C_{P}+\\frac{C_{1} C_{2}}{C_{1}+C_{2}}\\right)} \\tag{15.47}\n\\end{equation*}\n$$\n\nwhile (15.46) remains unchanged. Thus, $C_{P}$ is simply added in parallel with the series combination of $C_{1}$ and $C_{2}$."
},
{
    "text": "An LC oscillator can be implemented using just a single transistor in the signal path. Revisiting the gain stage depicted in Fig. 15.23(a), recall that the drain voltage cannot be applied to the gate because the overall phase shift at resonance is $180^{\\circ}$, not $360^{\\circ}$. Additionally, remember that in a common-gate configuration, the phase shift from the source to the drain is zero. We can infer that if, as illustrated in Fig. 15.29(a), the drain voltage is fed back to the source instead of the gate, the circuit might oscillate. The feedback must include a capacitor to prevent disturbance of the bias point of $M_{1}$.\n\n**Figure 15.29 (a) Description:**\n- **LP:** Inductor connected between VDD and Vout\n- **RP:** Resistor connected between VDD and Vout\n- **CP:** Capacitor connected between VDD and Vout\n- **M1:** NMOS transistor with source (S) at s1, drain (D) at Vout, and gate (G) at Vb\n- **C2:** Capacitor connected between Vout and s1\n- **Ib:** Current source connected between s1 and GND\n- **VDD:** Voltage source connected between VDD and GND\n\n**Extra Info:** The circuit is a tuned stage with feedback from drain to source, featuring an NMOS transistor M1. Feedback is provided through capacitor C2 to avoid disturbing the bias point. The circuit is designed for oscillation but does not oscillate due to insufficient loop gain.\n\n**Figure 15.29 (b) Description:**\n- **M1:** NMOS transistor with source (S) at S1, drain (D) at Vout, and gate (G) at Vb\n- **LP:** Inductor connected between VDD and Vout\n- **RP:** Resistor connected between VDD and Vout\n- **CP:** Capacitor connected between VDD and Vout\n- **C2:** Capacitor connected between Vout and S1\n- **Ib:** Current source connected between S1 and GND\n- **Iin:** Current source connected between GND and s1\n- **VDD:** Voltage source connected between VDD and GND\n\n**Extra Info:** The circuit is a feedback system with insufficient loop gain to oscillate. It includes an NMOS transistor with feedback from drain to source, a tank circuit (inductor, resistor, and capacitor), and a bias current source. An additional input current source is included to calculate the closed-loop gain.\n\n**Figure 15.29 (a):** Tuned stage with feedback from drain to source; **(b):** Addition of input current to calculate closed-loop gain.\n\nUnfortunately, due to insufficient loop gain, the circuit in Fig. 15.29(a) does not oscillate. To illustrate this, we refer to Fig. 15.1, where an oscillator is viewed as a feedback system with infinite closed-loop gain. By applying an input current as shown in Fig. 15.29(b) and ignoring transistor parasitics, we derive the closed-loop gain as:\n\n$$\n\\begin{equation*}\n\\frac{V_{\\text {out }}}{I_{\\text {in }}}=L_{P} s\\left\\|\\frac{1}{C_{P} S}\\right\\| R_{P} \\tag{15.37}\n\\end{equation*}\n$$\n\nThis is because $M_{1}$ and $C_{2}$ directly conduct the input current to the tank. Since the closed-loop gain cannot be infinite at any frequency, the circuit fails to oscillate.\n\n#### Example 15.7\n\nOne might question why the input to the feedback system is a current source applied to the transistor's source rather than a voltage source applied to its gate. Let's analyze the latter scenario.\n\n#### Solution\n\nFrom Fig. 15.30, note that with a finite variation in $V_{i n}$, the change in $I_{b}$ remains zero if the bias current source is ideal. Thus, if the source-bulk junction capacitance of $M_{1}$ is neglected, the change in the tank current is zero, resulting in $V_{\\text {out }} / V_{\\text {in }}=0$. Interestingly, $V_{X}$ does vary with $V_{i n}$, but $M_{1}$ generates a small-signal current that cancels that through $C_{2}$. It can be shown that $V_{X} / V_{i n}=g_{m} /\\left(g_{m}+C_{2} s\\right)$.\n\nThis example highlights two key points. First, to initiate oscillation, the stimulus can be applied at different points (i.e., the noise from any device in the loop can start the oscillation). Second, in Fig. 15.30, $V_{\\text {out }} / V_{\\text {in }}$ is zero because the impedance between the source of $M_{1}$ and ground is infinite. We then add a capacitor from this node to ground, as shown in Fig. 15.31(a), to explore oscillation conditions. Note that the capacitor in parallel with $L_{P}$ is removed, the reason for which will become clear later.\n\n**Figure 15.30 Description:**\n- **Vin:** Voltage source connected between Vin and GND\n- **Ib:** Current source connected between X and GND\n- **M1:** NMOS transistor with source (S) at X, drain (D) at Vout, and gate (G) at Vin\n- **RP:** Resistor connected between Vout and VDD\n- **CP:** Capacitor connected between Vout and VDD\n- **C2:** Capacitor connected between Vout and X\n- **LP:** Inductor connected between VDD and Vout\n\n**Extra Info:** The circuit is an oscillator with an NMOS transistor M1 and a tank circuit (RP, CP, and LP). The input voltage Vin controls the gate of M1, and the current source Ib biases the circuit. The output Vout is taken across the tank circuit.\n\n**Figure 15.30**\n\n**Figure 15.31 (a) Description:**\n- **LP:** Inductor connected between VDD and Vout\n- **RP:** Resistor connected between VDD and Vout\n- **M1:** NMOS transistor with source (S) at GND, drain (D) at Vout, and gate (G) at Vb\n- **C2:** Capacitor connected between Vout and s1\n- **Is:** Current source connected between s1 and GND\n- **C1:** Capacitor connected between s1 and GND\n\n**Extra Info:** This circuit is a Colpitts oscillator. The inductor LP and resistor RP form a parallel tank circuit connected to the drain of the NMOS transistor M1. The output Vout is taken across the tank circuit, and the transistor is biased by the voltage source S1 at the gate. Capacitors C1 and C2 provide the feedback necessary for oscillation.\n\n**Figure 15.31 (b) Description:**\n- **V1:** Voltage source connected between GND and x\n- **Iin:** Current source connected between GND and X\n- **gmV1:** Voltage-controlled current source\n- **C1:** Capacitor connected between x and GND\n- **C2:** Capacitor connected between Vout and x\n- **LP:** Inductor connected between Vout and GND\n- **RP:** Resistor connected between Vout and GND\n\n**Extra Info:** This circuit is a Colpitts oscillator. The voltage source V1 biases the circuit, while the current source Iin provides input stimulus. The voltage-controlled current source gmV1 models the active device. Capacitors C1 and C2, along with inductor LP and resistor RP, form the feedback network necessary for oscillation. The output is taken across the parallel combination of LP and RP.\n\n**Figure 15.31 (a) Colpitts oscillator; (b) equivalent circuit of (a) with input stimulus.**\n\nBy approximating $M_{1}$ as a single voltage-dependent current source, we construct the equivalent circuit of Fig. 15.31(b). Since the current through the parallel combination of $L_{P}$ and $R_{P}$ is given by $V_{\\text {out }} /\\left(L_{P} s\\right)+V_{\\text {out }} / R_{P}$, the total current through $C_{1}$ is $I_{\\text {in }}-V_{\\text {out }} /\\left(L_{P} s\\right)-V_{\\text {out }} / R_{P}$, yielding:\n\n$$\n\\begin{equation*}\nV_{1}=-\\left(I_{\\text {in }}-\\frac{V_{\\text {out }}}{L_{P} S}-\\frac{V_{\\text {out }}}{R_{P}}\\right) \\frac{1}{C_{1} S} \\tag{15.38}\n\\end{equation*}\n$$\n\nWriting the current through $C_{2}$ as $\\left(V_{\\text {out }}+V_{1}\\right) C_{2} s$, we sum all currents at the output node:\n\n$$\n\\begin{equation*}\n-g_{m}\\left(I_{\\text {in }}-\\frac{V_{\\text {out }}}{L_{P} S}-\\frac{V_{\\text {out }}}{R_{P}}\\right) \\frac{1}{C_{1} s}+\\left[V_{\\text {out }}-\\left(I_{\\text {in }}-\\frac{V_{\\text {out }}}{L_{P} S}-\\frac{V_{\\text {out }}}{R_{P}}\\right) \\frac{1}{C_{1} s}\\right] C_{2} s+\\frac{V_{\\text {out }}}{L_{P} S}+\\frac{V_{\\text {out }}}{R_{P}}=0 \\tag{15.39}\n\\end{equation*}\n$$\n\nIt follows that:\n\n$$\n\\begin{equation*}\n\\frac{V_{\\text {out }}}{I_{\\text {in }}}=\\frac{R_{P} L_{P} s\\left(g_{m}+C_{2} s\\right)}{R_{P} C_{1} C_{2} L_{P} s^{3}+\\left(C_{1}+C_{2}\\right) L_{P} s^{2}+\\left[g_{m} L_{P}+R_{P}\\left(C_{1}+C_{2}\\right)\\right] s+g_{m} R_{P}} \\tag{15.40}\n\\end{equation*}\n$$\n\n[^105]Note that, as expected, (15.40) reduces to $\\left(L_{P} S \\| R_{P}\\right)$ if $C_{1}=0$. The circuit oscillates if the closed-loop transfer function goes to infinity at an imaginary value of $s, s_{R}=j \\omega_{R}$. Consequently, both the real and imaginary parts of the denominator must be zero at this frequency:\n\n$$\n\\begin{align*}\n& -R_{P} C_{1} C_{2} L_{P} \\omega_{R}^{3}+\\left[g_{m} L_{P}+R_{P}\\left(C_{1}+C_{2}\\right)\\right] \\omega_{R}=0  \\tag{15.41}\\\\\n& -\\left(C_{1}+C_{2}\\right) L_{P} \\omega_{R}^{2}+g_{m} R_{P}=0 \\tag{15.42}\n\\end{align*}\n$$\n\nSince typically $g_{m} L_{P} \\ll R_{P}\\left(C_{1}+C_{2}\\right)$, Eq. (15.41) yields:\n\n$$\n\\begin{equation*}\n\\omega_{R}^{2}=\\frac{1}{L_{P} \\frac{C_{1} C_{2}}{C_{1}+C_{2}}} \\tag{15.43}\n\\end{equation*}\n$$\n\nand Eq. (15.42) results in:\n\n$$\n\\begin{align*}\ng_{m} R_{P} & =\\frac{\\left(C_{1}+C_{2}\\right)^{2}}{C_{1} C_{2}}  \\tag{15.44}\\\\\n& =\\frac{C_{1}}{C_{2}}\\left(1+\\frac{C_{2}}{C_{1}}\\right)^{2} \\tag{15.45}\n\\end{align*}\n$$\n\nRecognizing that $g_{m} R_{P}$ is the voltage gain from the source of $M_{1}$ to the output (if $g_{m b}=0$), we determine the ratio $C_{1} / C_{2}$ for the minimum required gain. It can be shown that the minimum occurs for $C_{1} / C_{2}=1$, requiring:\n\n$$\n\\begin{equation*}\ng_{m} R_{P} \\geq 4 \\tag{15.46}\n\\end{equation*}\n$$\n\nEquation (15.46) highlights a significant drawback of the Colpitts oscillator compared to the cross-coupled topology of Fig. 15.27(c). The Colpitts oscillator requires a voltage gain of at least 4 at resonance, whereas the cross-coupled scheme needs only unity. This is crucial if the inductor has a low $Q$ and thus a small $R_{P}$, a common issue in CMOS technologies. Consequently, the cross-coupled configuration is more widely used.\n\nThe previous analysis overlooked the capacitance in parallel with the inductor. As suggested in Problem 15.10, if this capacitance, $C_{P}$, is included in the equivalent circuit, Eq. (15.43) is modified to:\n\n$$\n\\begin{equation*}\n\\omega_{R}^{2}=\\frac{1}{L_{P}\\left(C_{P}+\\frac{C_{1} C_{2}}{C_{1}+C_{2}}\\right)} \\tag{15.47}\n\\end{equation*}\n$$\n\nwhile (15.46) remains unchanged. Thus, $C_{P}$ is simply added in parallel with the series combination of $C_{1}$ and $C_{2}$."
},
{
    "text": "An LC oscillator can be implemented using just one transistor in the signal path. Reconsider the gain stage depicted in Fig. 15.23(a) and remember that the drain voltage cannot be applied to the gate because the overall phase shift at resonance is $180^{\\circ}$, not $360^{\\circ}$. Also, recall that in a common-gate configuration, the phase shift from the source to the drain is zero. We then推测 that if, as illustrated in Fig. 15.29(a), the drain voltage is fed back to the source instead of the gate, the circuit might oscillate. The coupling must include a capacitor to prevent disturbance of the bias point of $M_{1}$.\n\nimage_name:Figure 15.29 (a)\ndescription:\n[\nname: LP, type: Inductor, value: LP, ports: {N1: VDD, N2: Vout}\nname: RP, type: Resistor, value: RP, ports: {N1: VDD, N2: Vout}\nname: CP, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Vout}\nname: M1, type: NMOS, ports: {S: s1, D: Vout, G: Vb}\nname: C2, type: Capacitor, value: C2, ports: {Np: Vout, Nn: s1}\nname: Ib, type: CurrentSource, value: Ib, ports: {Np: s1, Nn: GND}\nname: VDD, type: VoltageSource, value: VDD, ports: {Np: VDD, Nn: GND}\n]\nextrainfo:The circuit is a tuned stage with feedback from drain to source. It includes an NMOS transistor M1, with feedback provided through capacitor C2 to avoid disturbing the bias point. The circuit is designed for oscillation but does not oscillate due to insufficient loop gain.\n\nimage_name:Figure 15.29 (b)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: S1, D: Vout, G: Vb}\nname: LP, type: Inductor, value: LP, ports: {N1: VDD, N2: Vout}\nname: RP, type: Resistor, value: RP, ports: {N1: VDD, N2: Vout}\nname: CP, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Vout}\nname: C2, type: Capacitor, value: C2, ports: {Np: Vout, Nn: S1}\nname: Ib, type: CurrentSource, value: Ib, ports: {Np: S1, Nn: GND}\nname: Iin, type: CurrentSource, value: Iin, ports: {Np: GND, Nn: s1}\nname: VDD, type: VoltageSource, value: VDD, ports: {Np: VDD, Nn: GND}\n]\nextrainfo:The circuit is a feedback system with insufficient loop gain for oscillation. It includes an NMOS transistor with feedback from drain to source, a tank circuit with an inductor, resistor, and capacitor, and a bias current source. An additional input current source is included to calculate the closed-loop gain.\n\nFigure 15.29 (a) Tuned stage with feedback from drain to source; (b) addition of input current to calculate closed-loop gain.\n\nUnfortunately, due to insufficient loop gain, the circuit in Fig. 15.29(a) does not oscillate. To illustrate this, we refer to the perspective in Fig. 15.1, where an oscillator is viewed as a feedback system with infinite closed-loop gain. By applying an input current as shown in Fig. 15.29(b) and ignoring transistor parasitics, we derive the closed-loop gain as\n\n$$\n\\begin{equation*}\n\\frac{V_{\\text {out }}}{I_{\\text {in }}}=L_{P} s\\left\\|\\frac{1}{C_{P} S}\\right\\| R_{P} \\tag{15.37}\n\\end{equation*}\n$$\n\nbecause $M_{1}$ and $C_{2}$ directly conduct the input current to the tank. Since the closed-loop gain cannot be infinite at any frequency, the circuit fails to oscillate.\n\n#### Example 15.7\n\nOne might wonder why the input to the feedback system is implemented as a current source applied to the source of the transistor rather than a voltage source applied to its gate. Perform the analysis with the latter stimulus.\n\n#### Solution\n\nFrom Fig. 15.30, we observe that with a finite variation in $V_{i n}$, the change in $I_{b}$ remains zero if the bias current source is ideal. Thus, if the source-bulk junction capacitance of $M_{1}$ is ignored, the change in the tank current is zero, resulting in $V_{\\text {out }} / V_{\\text {in }}=0$. Interestingly, $V_{X}$ does vary with $V_{i n}$, but $M_{1}$ generates a small-signal current that cancels that through $C_{2}$. The reader can verify that $V_{X} / V_{i n}=g_{m} /\\left(g_{m}+C_{2} s\\right)$.\n\nThis example highlights two key points. First, to initiate oscillation in a circuit, the stimulus can be applied at various points. (That is, the noise of any device in the loop can start the oscillation.^6) Second, in Fig. 15.30, $V_{\\text {out }} / V_{\\text {in }}$ is zero because the impedance between the source of $M_{1}$ and ground is infinite. We then add a capacitor from this node to ground as shown in Fig. 15.31(a), to explore oscillation conditions. Note that the capacitor in parallel with $L_{P}$ is removed. The reason will be clarified later.\n\nimage_name:Figure 15.30\ndescription:\n[\nname: Vin, type: VoltageSource, value: Vin, ports: {Np: Vin, Nn: GND}\nname: Ib, type: CurrentSource, value: Ib, ports: {Np: X, Nn: GND}\nname: M1, type: NMOS, ports: {S: X, D: Vout, G: Vin}\nname: RP, type: Resistor, value: RP, ports: {N1: Vout, N2: VDD}\nname: CP, type: Capacitor, value: CP, ports: {Np: Vout, Nn: VDD}\nname: C2, type: Capacitor, value: C2, ports: {Np: Vout, Nn: X}\nname: LP, type: Inductor, value: LP, ports: {N1: VDD, N2: Vout}\n]\nextrainfo:The circuit is an oscillator with an NMOS transistor M1 and a tank circuit consisting of RP, CP, and LP. The input voltage Vin controls the gate of M1, and the current source Ib biases the circuit. The output Vout is taken across the tank circuit.\n\nFigure 15.30\n\nimage_name:(a)\ndescription:\n[\nname: LP, type: Inductor, value: LP, ports: {N1: VDD, N2: Vout}\nname: RP, type: Resistor, value: RP, ports: {N1: VDD, N2: Vout}\nname: M1, type: NMOS, ports: {S: GND, D: Vout, G: Vb}\nname: C2, type: Capacitor, value: C2, ports: {Np: Vout, Nn: s1}\nname: Is, type: CurrentSource, ports: {Np: s1, Nn: GND}\nname: C1, type: Capacitor, value: C1, ports: {Np: s1, Nn: GND}\n]\nextrainfo:This circuit is a Colpitts oscillator. The inductor LP and resistor RP form a parallel tank circuit connected to the drain of the NMOS transistor M1. The output Vout is taken across the tank circuit, and the transistor is biased by the voltage source S1 at the gate. Capacitors C1 and C2 provide the feedback necessary for oscillation.\n\nimage_name:(b)\ndescription:\n[\nname: V1, type: VoltageSource, value: V1, ports: {Np: GND, Nn: x}\nname: Iin, type: CurrentSource, value: Iin, ports: {Np: GND, Nn: X}\nname: gmV1, type: VoltageControlledCurrentSource, ports: {Np: Vout, Nn: x}\nname: C1, type: Capacitor, value: C1, ports: {Np: x, Nn: GND}\nname: C2, type: Capacitor, value: C2, ports: {Np: Vout, Nn: x}\nname: LP, type: Inductor, value: LP, ports: {N1: Vout, N2: GND}\nname: RP, type: Resistor, value: RP, ports: {N1: Vout, N2: GND}\n]\nextrainfo:This circuit is a Colpitts oscillator. The voltage source V1 biases the circuit, while the current source Iin provides input stimulus. The voltage-controlled current source gmV1 models the active device. Capacitors C1 and C2, along with inductor LP and resistor RP, form the feedback network necessary for oscillation. The output is taken across the parallel combination of LP and RP.\n\nFigure 15.31 (a) Colpitts oscillator; (b) equivalent circuit of (a) with input stimulus.\nBy approximating $M_{1}$ as a single voltage-dependent current source, we construct the equivalent circuit shown in Fig. 15.31(b). Since the current through the parallel combination of $L_{P}$ and $R_{P}$ is given by $V_{\\text {out }} /\\left(L_{P} s\\right)+V_{\\text {out }} / R_{P}$, the total current through $C_{1}$ is $I_{\\text {in }}-V_{\\text {out }} /\\left(L_{P} s\\right)-V_{\\text {out }} / R_{P}$, yielding\n\n$$\n\\begin{equation*}\nV_{1}=-\\left(I_{\\text {in }}-\\frac{V_{\\text {out }}}{L_{P} S}-\\frac{V_{\\text {out }}}{R_{P}}\\right) \\frac{1}{C_{1} S} \\tag{15.38}\n\\end{equation*}\n$$\n\nExpressing the current through $C_{2}$ as $\\left(V_{\\text {out }}+V_{1}\\right) C_{2} s$, we sum all currents at the output node:\n\n$$\n\\begin{equation*}\n-g_{m}\\left(I_{\\text {in }}-\\frac{V_{\\text {out }}}{L_{P} S}-\\frac{V_{\\text {out }}}{R_{P}}\\right) \\frac{1}{C_{1} s}+\\left[V_{\\text {out }}-\\left(I_{\\text {in }}-\\frac{V_{\\text {out }}}{L_{P} S}-\\frac{V_{\\text {out }}}{R_{P}}\\right) \\frac{1}{C_{1} s}\\right] C_{2} s+\\frac{V_{\\text {out }}}{L_{P} S}+\\frac{V_{\\text {out }}}{R_{P}}=0 \\tag{15.39}\n\\end{equation*}\n$$\n\nFrom this, we derive\n\n$$\n\\begin{equation*}\n\\frac{V_{\\text {out }}}{I_{\\text {in }}}=\\frac{R_{P} L_{P} s\\left(g_{m}+C_{2} s\\right)}{R_{P} C_{1} C_{2} L_{P} s^{3}+\\left(C_{1}+C_{2}\\right) L_{P} s^{2}+\\left[g_{m} L_{P}+R_{P}\\left(C_{1}+C_{2}\\right)\\right] s+g_{m} R_{P}} \\tag{15.40}\n\\end{equation*}\n$$\n\n[^105]Note that, as expected, (15.40) simplifies to $\\left(L_{P} S \\| R_{P}\\right)$ if $C_{1}=0$. The circuit oscillates if the closed-loop transfer function becomes infinite at an imaginary value of $s, s_{R}=j \\omega_{R}$. Consequently, both the real and imaginary parts of the denominator must be zero at this frequency:\n\n$$\n\\begin{align*}\n& -R_{P} C_{1} C_{2} L_{P} \\omega_{R}^{3}+\\left[g_{m} L_{P}+R_{P}\\left(C_{1}+C_{2}\\right)\\right] \\omega_{R}=0  \\tag{15.41}\\\\\n& -\\left(C_{1}+C_{2}\\right) L_{P} \\omega_{R}^{2}+g_{m} R_{P}=0 \\tag{15.42}\n\\end{align*}\n$$\n\nSince typically $g_{m} L_{P} \\ll R_{P}\\left(C_{1}+C_{2}\\right)$, Eq. (15.41) gives\n\n$$\n\\begin{equation*}\n\\omega_{R}^{2}=\\frac{1}{L_{P} \\frac{C_{1} C_{2}}{C_{1}+C_{2}}} \\tag{15.43}\n\\end{equation*}\n$$\n\nand Eq. (15.42) results in\n\n$$\n\\begin{align*}\ng_{m} R_{P} & =\\frac{\\left(C_{1}+C_{2}\\right)^{2}}{C_{1} C_{2}}  \\tag{15.44}\\\\\n& =\\frac{C_{1}}{C_{2}}\\left(1+\\frac{C_{2}}{C_{1}}\\right)^{2} \\tag{15.45}\n\\end{align*}\n$$\n\nRecognizing that $g_{m} R_{P}$ is the voltage gain from the source of $M_{1}$ to the output (if $g_{m b}=0$), we determine the ratio $C_{1} / C_{2}$ for the minimum required gain. The reader can show that the minimum occurs for $C_{1} / C_{2}=1$, requiring\n\n$$\n\\begin{equation*}\ng_{m} R_{P} \\geq 4 \\tag{15.46}\n\\end{equation*}\n$$\n\nEquation (15.46) highlights a significant drawback of the Colpitts oscillator compared to the cross-coupled topology of Fig. 15.27(c). The former requires a voltage gain of at least 4 at resonance, while the latter needs only unity. This difference is crucial if the inductor has a low $Q$ and hence a small $R_{P}$, a common issue in CMOS technologies. As a result, the cross-coupled configuration is more commonly used.\n\nThe previous analysis ignored the capacitance that appears in parallel with the inductor. As suggested in Problem 15.10, if this capacitance, $C_{P}$, is included in the equivalent circuit, Eq. (15.43) is modified to\n\n$$\n\\begin{equation*}\n\\omega_{R}^{2}=\\frac{1}{L_{P}\\left(C_{P}+\\frac{C_{1} C_{2}}{C_{1}+C_{2}}\\right)} \\tag{15.47}\n\\end{equation*}\n$$\n\nwhile (15.46) remains unchanged. Thus, $C_{P}$ is simply added in parallel with the series combination of $C_{1}$ and $C_{2}$."
},
{
    "text": "An LC oscillator can be implemented using just one transistor in the signal path. Re-examine the gain stage depicted in Fig. 15.23(a) and recall that the drain voltage cannot be applied to the gate because the overall phase shift at resonance is $180^{\\circ}$, not $360^{\\circ}$. Additionally, remember that in a common-gate configuration, the phase shift from the source to the drain is zero. We can infer that if, as shown in Fig. 15.29(a), the drain voltage is fed back to the source instead of the gate, the circuit might oscillate. The feedback must include a capacitor to prevent disturbing the bias point of $M_{1}$.\n\nimage_name:Figure 15.29 (a)\ndescription:\n[\nname: LP, type: Inductor, value: LP, ports: {N1: VDD, N2: Vout}\nname: RP, type: Resistor, value: RP, ports: {N1: VDD, N2: Vout}\nname: CP, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Vout}\nname: M1, type: NMOS, ports: {S: s1, D: Vout, G: Vb}\nname: C2, type: Capacitor, value: C2, ports: {Np: Vout, Nn: s1}\nname: Ib, type: CurrentSource, value: Ib, ports: {Np: s1, Nn: GND}\nname: VDD, type: VoltageSource, value: VDD, ports: {Np: VDD, Nn: GND}\n]\nextrainfo:The circuit features a tuned stage with feedback from the drain to the source. It includes an NMOS transistor $M1$, with feedback provided through capacitor $C2$ to avoid altering the bias point. The circuit is designed for oscillation but does not oscillate due to insufficient loop gain.\n\nimage_name:Figure 15.29 (b)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: S1, D: Vout, G: Vb}\nname: LP, type: Inductor, value: LP, ports: {N1: VDD, N2: Vout}\nname: RP, type: Resistor, value: RP, ports: {N1: VDD, N2: Vout}\nname: CP, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Vout}\nname: C2, type: Capacitor, value: C2, ports: {Np: Vout, Nn: S1}\nname: Ib, type: CurrentSource, value: Ib, ports: {Np: S1, Nn: GND}\nname: Iin, type: CurrentSource, value: Iin, ports: {Np: GND, Nn: s1}\nname: VDD, type: VoltageSource, value: VDD, ports: {Np: VDD, Nn: GND}\n]\nextrainfo:The circuit is a feedback system lacking sufficient loop gain for oscillation. It includes an NMOS transistor with feedback from the drain to the source, a tank circuit with an inductor, resistor, and capacitor, and a bias current source. An additional input current source is included to calculate the closed-loop gain.\n\nFigure 15.29 (a) Tuned stage with feedback from drain to source; (b) addition of input current to calculate closed-loop gain.\n\nUnfortunately, due to inadequate loop gain, the circuit in Fig. 15.29(a) fails to oscillate. To illustrate this, we refer to the perspective in Fig. 15.1, where an oscillator is viewed as a feedback system with infinite closed-loop gain. By applying an input current as shown in Fig. 15.29(b) and ignoring transistor parasitics, we derive the closed-loop gain as\n\n$$\n\\begin{equation*}\n\\frac{V_{\\text {out }}}{I_{\\text {in }}}=L_{P} s\\left\\|\\frac{1}{C_{P} S}\\right\\| R_{P} \\tag{15.37}\n\\end{equation*}\n$$\n\nsince $M_{1}$ and $C_{2}$ directly conduct the input current to the tank. Because the closed-loop gain cannot be infinite at any frequency, the circuit fails to oscillate.\n\n#### Example 15.7\n\nOne might question why the input to the feedback system is implemented as a current source applied to the transistor's source rather than a voltage source applied to its gate. Analyze the scenario with the latter stimulus.\n\n#### Solution\n\nFrom Fig. 15.30, observe that with a finite variation in $V_{i n}$, the change in $I_{b}$ remains zero if the bias current source is ideal. Thus, neglecting the source-bulk junction capacitance of $M_{1}$, the change in the tank current is zero, resulting in $V_{\\text {out }} / V_{\\text {in }}=0$. Interestingly, $V_{X}$ does vary with $V_{i n}$, but $M_{1}$ generates a small-signal current that cancels that through $C_{2}$. It can be shown that $V_{X} / V_{i n}=g_{m} /\\left(g_{m}+C_{2} s\\right)$.\n\nThis example highlights two key points. First, to initiate oscillation in a circuit, the stimulus can be applied at various points. (That is, the noise from any device in the loop can trigger\nimage_name:Figure 15.30\ndescription:\n[\nname: Vin, type: VoltageSource, value: Vin, ports: {Np: Vin, Nn: GND}\nname: Ib, type: CurrentSource, value: Ib, ports: {Np: X, Nn: GND}\nname: M1, type: NMOS, ports: {S: X, D: Vout, G: Vin}\nname: RP, type: Resistor, value: RP, ports: {N1: Vout, N2: VDD}\nname: CP, type: Capacitor, value: CP, ports: {Np: Vout, Nn: VDD}\nname: C2, type: Capacitor, value: C2, ports: {Np: Vout, Nn: X}\nname: LP, type: Inductor, value: LP, ports: {N1: VDD, N2: Vout}\n]\nextrainfo:The circuit is an oscillator with an NMOS transistor $M1$ and a tank circuit consisting of $RP$, $CP$, and $LP$. The input voltage $Vin$ controls the gate of $M1$, and the current source $Ib$ biases the circuit. The output $Vout$ is taken across the tank circuit.\n\nFigure 15.30\noscillation. ${ }^{6}$ ) Second, in Fig. 15.30, $V_{\\text {out }} / V_{\\text {in }}$ is zero because the impedance between the source of $M_{1}$ and ground is infinite. We then add a capacitor from this node to ground as shown in Fig. 15.31(a), seeking oscillation conditions. Note that the capacitor in parallel with $L_{P}$ is removed. The rationale will be clarified later.\nimage_name:(a)\ndescription:\n[\nname: LP, type: Inductor, value: LP, ports: {N1: VDD, N2: Vout}\nname: RP, type: Resistor, value: RP, ports: {N1: VDD, N2: Vout}\nname: M1, type: NMOS, ports: {S: GND, D: Vout, G: Vb}\nname: C2, type: Capacitor, value: C2, ports: {Np: Vout, Nn: s1}\nname: Is, type: CurrentSource, ports: {Np: s1, Nn: GND}\nname: C1, type: Capacitor, value: C1, ports: {Np: s1, Nn: GND}\n]\nextrainfo:This circuit is a Colpitts oscillator. The inductor $LP$ and resistor $RP$ form a parallel tank circuit connected to the drain of the NMOS transistor $M1$. The output $Vout$ is taken across the tank circuit, and the transistor is biased by the voltage source $S1$ at the gate. Capacitors $C1$ and $C2$ provide the feedback necessary for oscillation.\n\nimage_name:(b)\ndescription:\n[\nname: V1, type: VoltageSource, value: V1, ports: {Np: GND, Nn: x}\nname: Iin, type: CurrentSource, value: Iin, ports: {Np: GND, Nn: X}\nname: gmV1, type: VoltageControlledCurrentSource, ports: {Np: Vout, Nn: x}\nname: C1, type: Capacitor, value: C1, ports: {Np: x, Nn: GND}\nname: C2, type: Capacitor, value: C2, ports: {Np: Vout, Nn: x}\nname: LP, type: Inductor, value: LP, ports: {N1: Vout, N2: GND}\nname: RP, type: Resistor, value: RP, ports: {N1: Vout, N2: GND}\n]\nextrainfo:This circuit is a Colpitts oscillator. The voltage source $V1$ biases the circuit, while the current source $Iin$ provides input stimulus. The voltage-controlled current source $gmV1$ models the active device. Capacitors $C1$ and $C2$, along with inductor $LP$ and resistor $RP$, form the feedback network necessary for oscillation. The output is taken across the parallel combination of $LP$ and $RP$.\n\nFigure 15.31 (a) Colpitts oscillator; (b) equivalent circuit of (a) with input stimulus.\nApproximating $M_{1}$ by a single voltage-dependent current source, we construct the equivalent circuit of Fig. 15.31(b). Since the current through the parallel combination of $L_{P}$ and $R_{P}$ is given by $V_{\\text {out }} /\\left(L_{P} s\\right)+$ $V_{\\text {out }} / R_{P}$, the total current through $C_{1}$ is equal to $I_{\\text {in }}-V_{\\text {out }} /\\left(L_{P} s\\right)-V_{\\text {out }} / R_{P}$, yielding\n\n$$\n\\begin{equation*}\nV_{1}=-\\left(I_{\\text {in }}-\\frac{V_{\\text {out }}}{L_{P} S}-\\frac{V_{\\text {out }}}{R_{P}}\\right) \\frac{1}{C_{1} S} \\tag{15.38}\n\\end{equation*}\n$$\n\nWriting the current through $C_{2}$ as $\\left(V_{\\text {out }}+V_{1}\\right) C_{2} s$, we sum all currents at the output node:\n\n$$\n\\begin{equation*}\n-g_{m}\\left(I_{\\text {in }}-\\frac{V_{\\text {out }}}{L_{P} S}-\\frac{V_{\\text {out }}}{R_{P}}\\right) \\frac{1}{C_{1} s}+\\left[V_{\\text {out }}-\\left(I_{\\text {in }}-\\frac{V_{\\text {out }}}{L_{P} S}-\\frac{V_{\\text {out }}}{R_{P}}\\right) \\frac{1}{C_{1} s}\\right] C_{2} s+\\frac{V_{\\text {out }}}{L_{P} S}+\\frac{V_{\\text {out }}}{R_{P}}=0 \\tag{15.39}\n\\end{equation*}\n$$\n\nIt follows that\n\n$$\n\\begin{equation*}\n\\frac{V_{\\text {out }}}{I_{\\text {in }}}=\\frac{R_{P} L_{P} s\\left(g_{m}+C_{2} s\\right)}{R_{P} C_{1} C_{2} L_{P} s^{3}+\\left(C_{1}+C_{2}\\right) L_{P} s^{2}+\\left[g_{m} L_{P}+R_{P}\\left(C_{1}+C_{2}\\right)\\right] s+g_{m} R_{P}} \\tag{15.40}\n\\end{equation*}\n$$\n\n[^105]Note that, as expected, (15.40) reduces to $\\left(L_{P} S \\| R_{P}\\right)$ if $C_{1}=0$. The circuit oscillates if the closed-loop transfer function goes to infinity at an imaginary value of $s, s_{R}=j \\omega_{R}$. Consequently, both the real and imaginary parts of the denominator must vanish at this frequency:\n\n$$\n\\begin{align*}\n& -R_{P} C_{1} C_{2} L_{P} \\omega_{R}^{3}+\\left[g_{m} L_{P}+R_{P}\\left(C_{1}+C_{2}\\right)\\right] \\omega_{R}=0  \\tag{15.41}\\\\\n& -\\left(C_{1}+C_{2}\\right) L_{P} \\omega_{R}^{2}+g_{m} R_{P}=0 \\tag{15.42}\n\\end{align*}\n$$\n\nSince typically $g_{m} L_{P} \\ll R_{P}\\left(C_{1}+C_{2}\\right)$, Eq. (15.41) yields,\n\n$$\n\\begin{equation*}\n\\omega_{R}^{2}=\\frac{1}{L_{P} \\frac{C_{1} C_{2}}{C_{1}+C_{2}}} \\tag{15.43}\n\\end{equation*}\n$$\n\nand Eq. (15.42) results in\n\n$$\n\\begin{align*}\ng_{m} R_{P} & =\\frac{\\left(C_{1}+C_{2}\\right)^{2}}{C_{1} C_{2}}  \\tag{15.44}\\\\\n& =\\frac{C_{1}}{C_{2}}\\left(1+\\frac{C_{2}}{C_{1}}\\right)^{2} \\tag{15.45}\n\\end{align*}\n$$\n\nRecognizing that $g_{m} R_{P}$ is the voltage gain from the source of $M_{1}$ to the output (if $g_{m b}=0$ ), we determine the ratio $C_{1} / C_{2}$ for the minimum required gain. It can be shown that the minimum occurs for $C_{1} / C_{2}=1$, requiring\n\n$$\n\\begin{equation*}\ng_{m} R_{P} \\geq 4 \\tag{15.46}\n\\end{equation*}\n$$\n\nEquation (15.46) highlights a significant drawback of the Colpitts oscillator compared to the cross-coupled topology of Fig. 15.27(c). The former requires a voltage gain of at least 4 at resonance, whereas the latter only needs unity. This difference is crucial if the inductor has a low $Q$ and hence a small $R_{P}$, a common issue in CMOS technologies. Consequently, the cross-coupled configuration is more widely used.\n\nThe previous analysis ignored the capacitance that appears in parallel with the inductor. As suggested in Problem 15.10, if this capacitance, $C_{P}$, is included in the equivalent circuit, Eq. (15.43) is modified as\n\n$$\n\\begin{equation*}\n\\omega_{R}^{2}=\\frac{1}{L_{P}\\left(C_{P}+\\frac{C_{1} C_{2}}{C_{1}+C_{2}}\\right)} \\tag{15.47}\n\\end{equation*}\n$$\n\nwhereas (15.46) remains unchanged. Thus, $C_{P}$ is simply added in parallel with the series combination of $C_{1}$ and $C_{2}$."
},
{
    "text": "An LC oscillator can be implemented using just one transistor in the signal path. Reconsider the gain stage depicted in Fig. 15.23(a) and recall that the drain voltage cannot be applied to the gate because the overall phase shift at resonance is $180^{\\circ}$, not $360^{\\circ}$. Also, remember that in a common-gate configuration, the phase shift from the source to the drain is zero. We then deduce that if, as illustrated in Fig. 15.29(a), the drain voltage is fed back to the source instead of the gate, the circuit might oscillate. The feedback must include a capacitor to prevent disturbing the bias point of $M_{1}$.\n\nimage_name:Figure 15.29 (a)\ndescription:\n[\nname: LP, type: Inductor, value: LP, ports: {N1: VDD, N2: Vout}\nname: RP, type: Resistor, value: RP, ports: {N1: VDD, N2: Vout}\nname: CP, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Vout}\nname: M1, type: NMOS, ports: {S: s1, D: Vout, G: Vb}\nname: C2, type: Capacitor, value: C2, ports: {Np: Vout, Nn: s1}\nname: Ib, type: CurrentSource, value: Ib, ports: {Np: s1, Nn: GND}\nname: VDD, type: VoltageSource, value: VDD, ports: {Np: VDD, Nn: GND}\n]\nextrainfo:The circuit features a tuned stage with feedback from the drain to the source. It includes an NMOS transistor $M1$, with feedback provided through capacitor $C2$ to avoid disturbing the bias point. The circuit is designed for oscillation but does not oscillate due to insufficient loop gain.\n\nimage_name:Figure 15.29 (b)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: S1, D: Vout, G: Vb}\nname: LP, type: Inductor, value: LP, ports: {N1: VDD, N2: Vout}\nname: RP, type: Resistor, value: RP, ports: {N1: VDD, N2: Vout}\nname: CP, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Vout}\nname: C2, type: Capacitor, value: C2, ports: {Np: Vout, Nn: S1}\nname: Ib, type: CurrentSource, value: Ib, ports: {Np: S1, Nn: GND}\nname: Iin, type: CurrentSource, value: Iin, ports: {Np: GND, Nn: s1}\nname: VDD, type: VoltageSource, value: VDD, ports: {Np: VDD, Nn: GND}\n]\nextrainfo:The circuit is a feedback system with insufficient loop gain for oscillation. It includes an NMOS transistor with feedback from the drain to the source, a tank circuit comprising an inductor, resistor, and capacitor, and a bias current source. An additional input current source is included to calculate the closed-loop gain.\n\nFigure 15.29 (a) Tuned stage with feedback from drain to source; (b) addition of input current to calculate closed-loop gain.\n\nUnfortunately, due to insufficient loop gain, the circuit in Fig. 15.29(a) does not oscillate. To demonstrate this, we refer to the perspective in Fig. 15.1, where an oscillator is viewed as a feedback system with infinite closed-loop gain. By applying an input current as shown in Fig. 15.29(b) and忽略 transistor parasitics, we derive the closed-loop gain as\n\n$$\n\\begin{equation*}\n\\frac{V_{\\text {out }}}{I_{\\text {in }}}=L_{P} s\\left\\|\\frac{1}{C_{P} S}\\right\\| R_{P} \\tag{15.37}\n\\end{equation*}\n$$\n\nsince $M_{1}$ and $C_{2}$ directly conduct the input current to the tank. Because the closed-loop gain cannot be infinite at any frequency, the circuit fails to oscillate.\n\n#### Example 15.7\n\nOne might wonder why the input to the feedback system is implemented as a current source applied to the source of the transistor rather than a voltage source applied to its gate. Perform the analysis with the latter stimulus.\n\n#### Solution\n\nFrom Fig. 15.30, we observe that with a finite variation in $V_{i n}$, the change in $I_{b}$ remains zero if the bias current source is ideal. Thus, if the source-bulk junction capacitance of $M_{1}$ is ignored, the change in the tank current is zero, resulting in $V_{\\text {out }} / V_{\\text {in }}=0$. Interestingly, $V_{X}$ does vary with $V_{i n}$, but $M_{1}$ generates a small-signal current that cancels that through $C_{2}$. The reader can verify that $V_{X} / V_{i n}=g_{m} /\\left(g_{m}+C_{2} s\\right)$.\n\nThis example highlights two key points. First, to initiate oscillation in a circuit, the stimulus can be applied at various points. (That is, the noise from any device in the loop can start the oscillation.) Second, in Fig. 15.30, $V_{\\text {out }} / V_{\\text {in }}$ is zero because the impedance between the source of $M_{1}$ and ground is infinite. We then add a capacitor from this node to ground as shown in Fig. 15.31(a), seeking oscillation conditions. Note that the capacitor in parallel with $L_{P}$ is removed. The reason will become evident later.\n\nimage_name:Figure 15.30\ndescription:\n[\nname: Vin, type: VoltageSource, value: Vin, ports: {Np: Vin, Nn: GND}\nname: Ib, type: CurrentSource, value: Ib, ports: {Np: X, Nn: GND}\nname: M1, type: NMOS, ports: {S: X, D: Vout, G: Vin}\nname: RP, type: Resistor, value: RP, ports: {N1: Vout, N2: VDD}\nname: CP, type: Capacitor, value: CP, ports: {Np: Vout, Nn: VDD}\nname: C2, type: Capacitor, value: C2, ports: {Np: Vout, Nn: X}\nname: LP, type: Inductor, value: LP, ports: {N1: VDD, N2: Vout}\n]\nextrainfo:The circuit is an oscillator with an NMOS transistor $M1$ and a tank circuit consisting of $RP$, $CP$, and $LP$. The input voltage $Vin$ controls the gate of $M1$, and the current source $Ib$ biases the circuit. The output $Vout$ is taken across the tank circuit.\n\nFigure 15.30\n\nimage_name:(a)\ndescription:\n[\nname: LP, type: Inductor, value: LP, ports: {N1: VDD, N2: Vout}\nname: RP, type: Resistor, value: RP, ports: {N1: VDD, N2: Vout}\nname: M1, type: NMOS, ports: {S: GND, D: Vout, G: Vb}\nname: C2, type: Capacitor, value: C2, ports: {Np: Vout, Nn: s1}\nname: Is, type: CurrentSource, ports: {Np: s1, Nn: GND}\nname: C1, type: Capacitor, value: C1, ports: {Np: s1, Nn: GND}\n]\nextrainfo:This circuit is a Colpitts oscillator. The inductor $LP$ and resistor $RP$ form a parallel tank circuit connected to the drain of the NMOS transistor $M1$. The output $Vout$ is taken across the tank circuit, and the transistor is biased by the voltage source $S1$ at the gate. Capacitors $C1$ and $C2$ provide the feedback necessary for oscillation.\n\nimage_name:(b)\ndescription:\n[\nname: V1, type: VoltageSource, value: V1, ports: {Np: GND, Nn: x}\nname: Iin, type: CurrentSource, value: Iin, ports: {Np: GND, Nn: X}\nname: gmV1, type: VoltageControlledCurrentSource, ports: {Np: Vout, Nn: x}\nname: C1, type: Capacitor, value: C1, ports: {Np: x, Nn: GND}\nname: C2, type: Capacitor, value: C2, ports: {Np: Vout, Nn: x}\nname: LP, type: Inductor, value: LP, ports: {N1: Vout, N2: GND}\nname: RP, type: Resistor, value: RP, ports: {N1: Vout, N2: GND}\n]\nextrainfo:This circuit is a Colpitts oscillator. The voltage source $V1$ biases the circuit, while the current source $Iin$ provides input stimulus. The voltage-controlled current source $gmV1$ models the active device. Capacitors $C1$ and $C2$, along with inductor $LP$ and resistor $RP$, form the feedback network necessary for oscillation. The output is taken across the parallel combination of $LP$ and $RP$.\n\nFigure 15.31 (a) Colpitts oscillator; (b) equivalent circuit of (a) with input stimulus.\n\nApproximating $M_{1}$ by a single voltage-dependent current source, we construct the equivalent circuit of Fig. 15.31(b). Since the current through the parallel combination of $L_{P}$ and $R_{P}$ is given by $V_{\\text {out }} /\\left(L_{P} s\\right)+V_{\\text {out }} / R_{P}$, the total current through $C_{1}$ is $I_{\\text {in }}-V_{\\text {out }} /\\left(L_{P} s\\right)-V_{\\text {out }} / R_{P}$, yielding\n\n$$\n\\begin{equation*}\nV_{1}=-\\left(I_{\\text {in }}-\\frac{V_{\\text {out }}}{L_{P} S}-\\frac{V_{\\text {out }}}{R_{P}}\\right) \\frac{1}{C_{1} S} \\tag{15.38}\n\\end{equation*}\n$$\n\nWriting the current through $C_{2}$ as $\\left(V_{\\text {out }}+V_{1}\\right) C_{2} s$, we sum all currents at the output node:\n\n$$\n\\begin{equation*}\n-g_{m}\\left(I_{\\text {in }}-\\frac{V_{\\text {out }}}{L_{P} S}-\\frac{V_{\\text {out }}}{R_{P}}\\right) \\frac{1}{C_{1} s}+\\left[V_{\\text {out }}-\\left(I_{\\text {in }}-\\frac{V_{\\text {out }}}{L_{P} S}-\\frac{V_{\\text {out }}}{R_{P}}\\right) \\frac{1}{C_{1} s}\\right] C_{2} s+\\frac{V_{\\text {out }}}{L_{P} S}+\\frac{V_{\\text {out }}}{R_{P}}=0 \\tag{15.39}\n\\end{equation*}\n$$\n\nIt follows that\n\n$$\n\\begin{equation*}\n\\frac{V_{\\text {out }}}{I_{\\text {in }}}=\\frac{R_{P} L_{P} s\\left(g_{m}+C_{2} s\\right)}{R_{P} C_{1} C_{2} L_{P} s^{3}+\\left(C_{1}+C_{2}\\right) L_{P} s^{2}+\\left[g_{m} L_{P}+R_{P}\\left(C_{1}+C_{2}\\right)\\right] s+g_{m} R_{P}} \\tag{15.40}\n\\end{equation*}\n$$\n\n[^105]Note that, as expected, (15.40) reduces to $\\left(L_{P} S \\| R_{P}\\right)$ if $C_{1}=0$. The circuit oscillates if the closed-loop transfer function goes to infinity at an imaginary value of $s, s_{R}=j \\omega_{R}$. Consequently, both the real and imaginary parts of the denominator must vanish at this frequency:\n\n$$\n\\begin{align*}\n& -R_{P} C_{1} C_{2} L_{P} \\omega_{R}^{3}+\\left[g_{m} L_{P}+R_{P}\\left(C_{1}+C_{2}\\right)\\right] \\omega_{R}=0  \\tag{15.41}\\\\\n& -\\left(C_{1}+C_{2}\\right) L_{P} \\omega_{R}^{2}+g_{m} R_{P}=0 \\tag{15.42}\n\\end{align*}\n$$\n\nSince with typical values, $g_{m} L_{P} \\ll R_{P}\\left(C_{1}+C_{2}\\right)$, Eq. (15.41) yields,\n\n$$\n\\begin{equation*}\n\\omega_{R}^{2}=\\frac{1}{L_{P} \\frac{C_{1} C_{2}}{C_{1}+C_{2}}} \\tag{15.43}\n\\end{equation*}\n$$\n\nand Eq. (15.42) results in\n\n$$\n\\begin{align*}\ng_{m} R_{P} & =\\frac{\\left(C_{1}+C_{2}\\right)^{2}}{C_{1} C_{2}}  \\tag{15.44}\\\\\n& =\\frac{C_{1}}{C_{2}}\\left(1+\\frac{C_{2}}{C_{1}}\\right)^{2} \\tag{15.45}\n\\end{align*}\n$$\n\nRecognizing that $g_{m} R_{P}$ is the voltage gain from the source of $M_{1}$ to the output (if $g_{m b}=0$ ), we determine the ratio $C_{1} / C_{2}$ for the minimum required gain. The reader can prove that the minimum occurs for $C_{1} / C_{2}=1$, requiring\n\n$$\n\\begin{equation*}\ng_{m} R_{P} \\geq 4 \\tag{15.46}\n\\end{equation*}\n$$\n\nEquation (15.46) highlights a significant drawback of the Colpitts oscillator compared to the cross-coupled topology of Fig. 15.27(c). The former requires a voltage gain of at least 4 at resonance, while the latter needs only unity. This difference is crucial if the inductor has a low $Q$ and hence a small $R_{P}$, a common issue in CMOS technologies. Consequently, the cross-coupled scheme is more widely used.\n\nThe previous analysis omitted the capacitance that appears in parallel with the inductor. As suggested in Problem 15.10, if this capacitance, $C_{P}$, is included in the equivalent circuit, Eq. (15.43) is modified as\n\n$$\n\\begin{equation*}\n\\omega_{R}^{2}=\\frac{1}{L_{P}\\left(C_{P}+\\frac{C_{1} C_{2}}{C_{1}+C_{2}}\\right)} \\tag{15.47}\n\\end{equation*}\n$$\n\nwhile (15.46) remains unchanged. Thus, $C_{P}$ is simply added in parallel with the series combination of $C_{1}$ and $C_{2}$."
},
{
    "text": "An LC oscillator can be implemented using just one transistor in the signal path. Revisiting the gain stage depicted in Fig. 15.23(a), recall that the drain voltage cannot be applied to the gate because the overall phase shift at resonance is $180^{\\circ}$, not $360^{\\circ}$. Additionally, remember that in a common-gate configuration, the phase shift from the source to the drain is zero. We can infer that if, as illustrated in Fig. 15.29(a), the drain voltage is fed back to the source instead of the gate, the circuit might oscillate. This feedback must include a capacitor to prevent disturbance of the bias point of $M_{1}$.\n\n**Figure 15.29 (a) Description:**\n- **LP:** Inductor, connected between VDD and Vout\n- **RP:** Resistor, connected between VDD and Vout\n- **CP:** Capacitor, connected between VDD and Vout\n- **M1:** NMOS transistor, with source connected to s1, drain to Vout, and gate to Vb\n- **C2:** Capacitor, connected between Vout and s1\n- **Ib:** Current source, connected between s1 and GND\n- **VDD:** Voltage source, connected between VDD and GND\n\n**Extra Info:** The circuit is a tuned stage with feedback from drain to source. It includes an NMOS transistor M1, with feedback provided through capacitor C2 to avoid disturbing the bias point. The circuit is designed for oscillation but does not oscillate due to insufficient loop gain.\n\n**Figure 15.29 (b) Description:**\n- **M1:** NMOS transistor, with source connected to S1, drain to Vout, and gate to Vb\n- **LP:** Inductor, connected between VDD and Vout\n- **RP:** Resistor, connected between VDD and Vout\n- **CP:** Capacitor, connected between VDD and Vout\n- **C2:** Capacitor, connected between Vout and S1\n- **Ib:** Current source, connected between S1 and GND\n- **Iin:** Current source, connected between GND and s1\n- **VDD:** Voltage source, connected between VDD and GND\n\n**Extra Info:** The circuit is a feedback system with insufficient loop gain to oscillate. It includes an NMOS transistor with feedback from drain to source, a tank circuit with an inductor, resistor, and capacitor, and a bias current source. An additional input current source is present to calculate the closed-loop gain.\n\n**Figure 15.29 (a):** Tuned stage with feedback applied from drain to source; **(b):** Addition of input current to calculate closed-loop gain.\n\nUnfortunately, due to insufficient loop gain, the circuit in Fig. 15.29(a) does not oscillate. To demonstrate this, we refer to the perspective in Fig. 15.1, where an oscillator is viewed as a feedback system with infinite closed-loop gain. By applying an input current as shown in Fig. 15.29(b) and ignoring transistor parasitics, we derive the closed-loop gain as:\n\n$$\n\\begin{equation*}\n\\frac{V_{\\text {out }}}{I_{\\text {in }}}=L_{P} s\\left\\|\\frac{1}{C_{P} S}\\right\\| R_{P} \\tag{15.37}\n\\end{equation*}\n$$\n\nThis is because $M_{1}$ and $C_{2}$ directly conduct the input current to the tank. Since the closed-loop gain cannot be infinite at any frequency, the circuit fails to oscillate.\n\n#### Example 15.7\n\nOne might wonder why the input to the feedback system is implemented as a current source applied to the transistor's source instead of a voltage source applied to its gate. Let's analyze the latter scenario.\n\n#### Solution\n\nFrom Fig. 15.30, note that with a finite variation in $V_{i n}$, the change in $I_{b}$ remains zero if the bias current source is ideal. Thus, if the source-bulk junction capacitance of $M_{1}$ is neglected, the change in the tank current is zero, resulting in $V_{\\text {out }} / V_{\\text {in }}=0$. Interestingly, $V_{X}$ does vary with $V_{i n}$, but $M_{1}$ generates a small-signal current that cancels that through $C_{2}$. It can be shown that $V_{X} / V_{i n}=g_{m} /\\left(g_{m}+C_{2} s\\right)$.\n\nThis example highlights two key points. First, to initiate oscillation in a circuit, the stimulus can be applied at different locations. (That is, the noise from any device in the loop can start the oscillation.) Second, in Fig. 15.30, $V_{\\text {out }} / V_{\\text {in }}$ is zero because the impedance between the source of $M_{1}$ and ground is infinite. We then add a capacitor from this node to ground, as shown in Fig. 15.31(a), to explore oscillation conditions. Note that the capacitor in parallel with $L_{P}$ is removed, the reason for which will become clear later.\n\n**Figure 15.30 Description:**\n- **Vin:** Voltage source, connected between Vin and GND\n- **Ib:** Current source, connected between X and GND\n- **M1:** NMOS transistor, with source connected to X, drain to Vout, and gate to Vin\n- **RP:** Resistor, connected between Vout and VDD\n- **CP:** Capacitor, connected between Vout and VDD\n- **C2:** Capacitor, connected between Vout and X\n- **LP:** Inductor, connected between VDD and Vout\n\n**Extra Info:** The circuit is an oscillator with an NMOS transistor M1 and a tank circuit consisting of RP, CP, and LP. The input voltage Vin controls the gate of M1, and the current source Ib biases the circuit. The output Vout is taken across the tank circuit.\n\n**Figure 15.30**\n\n**Figure 15.31 (a) Description:**\n- **LP:** Inductor, connected between VDD and Vout\n- **RP:** Resistor, connected between VDD and Vout\n- **M1:** NMOS transistor, with source connected to GND, drain to Vout, and gate to Vb\n- **C2:** Capacitor, connected between Vout and s1\n- **Is:** Current source, connected between s1 and GND\n- **C1:** Capacitor, connected between s1 and GND\n\n**Extra Info:** This circuit is a Colpitts oscillator. The inductor LP and resistor RP form a parallel tank circuit connected to the drain of the NMOS transistor M1. The output Vout is taken across the tank circuit, and the transistor is biased by the voltage source S1 at the gate. Capacitors C1 and C2 are used to provide feedback necessary for oscillation.\n\n**Figure 15.31 (b) Description:**\n- **V1:** Voltage source, connected between GND and x\n- **Iin:** Current source, connected between GND and X\n- **gmV1:** Voltage-controlled current source, connected between Vout and x\n- **C1:** Capacitor, connected between x and GND\n- **C2:** Capacitor, connected between Vout and x\n- **LP:** Inductor, connected between Vout and GND\n- **RP:** Resistor, connected between Vout and GND\n\n**Extra Info:** This circuit is a Colpitts oscillator. The voltage source V1 biases the circuit, while the current source Iin provides input stimulus. The voltage-controlled current source gmV1 models the active device. Capacitors C1 and C2, along with inductor LP and resistor RP, form the feedback network necessary for oscillation. The output is taken across the parallel combination of LP and RP.\n\n**Figure 15.31 (a) Colpitts oscillator; (b) equivalent circuit of (a) with input stimulus.**\n\nBy approximating $M_{1}$ as a single voltage-dependent current source, we construct the equivalent circuit shown in Fig. 15.31(b). Since the current through the parallel combination of $L_{P}$ and $R_{P}$ is given by $V_{\\text {out }} /\\left(L_{P} s\\right)+V_{\\text {out }} / R_{P}$, the total current through $C_{1}$ is $I_{\\text {in }}-V_{\\text {out }} /\\left(L_{P} s\\right)-V_{\\text {out }} / R_{P}$, yielding:\n\n$$\n\\begin{equation*}\nV_{1}=-\\left(I_{\\text {in }}-\\frac{V_{\\text {out }}}{L_{P} S}-\\frac{V_{\\text {out }}}{R_{P}}\\right) \\frac{1}{C_{1} S} \\tag{15.38}\n\\end{equation*}\n$$\n\nWriting the current through $C_{2}$ as $\\left(V_{\\text {out }}+V_{1}\\right) C_{2} s$, we sum all currents at the output node:\n\n$$\n\\begin{equation*}\n-g_{m}\\left(I_{\\text {in }}-\\frac{V_{\\text {out }}}{L_{P} S}-\\frac{V_{\\text {out }}}{R_{P}}\\right) \\frac{1}{C_{1} s}+\\left[V_{\\text {out }}-\\left(I_{\\text {in }}-\\frac{V_{\\text {out }}}{L_{P} S}-\\frac{V_{\\text {out }}}{R_{P}}\\right) \\frac{1}{C_{1} s}\\right] C_{2} s+\\frac{V_{\\text {out }}}{L_{P} S}+\\frac{V_{\\text {out }}}{R_{P}}=0 \\tag{15.39}\n\\end{equation*}\n$$\n\nIt follows that:\n\n$$\n\\begin{equation*}\n\\frac{V_{\\text {out }}}{I_{\\text {in }}}=\\frac{R_{P} L_{P} s\\left(g_{m}+C_{2} s\\right)}{R_{P} C_{1} C_{2} L_{P} s^{3}+\\left(C_{1}+C_{2}\\right) L_{P} s^{2}+\\left[g_{m} L_{P}+R_{P}\\left(C_{1}+C_{2}\\right)\\right] s+g_{m} R_{P}} \\tag{15.40}\n\\end{equation*}\n$$\n\n[^105]Note that, as expected, (15.40) reduces to $\\left(L_{P} S \\| R_{P}\\right)$ if $C_{1}=0$. The circuit oscillates if the closed-loop transfer function goes to infinity at an imaginary value of $s, s_{R}=j \\omega_{R}$. Consequently, both the real and imaginary parts of the denominator must be zero at this frequency:\n\n$$\n\\begin{align*}\n& -R_{P} C_{1} C_{2} L_{P} \\omega_{R}^{3}+\\left[g_{m} L_{P}+R_{P}\\left(C_{1}+C_{2}\\right)\\right] \\omega_{R}=0  \\tag{15.41}\\\\\n& -\\left(C_{1}+C_{2}\\right) L_{P} \\omega_{R}^{2}+g_{m} R_{P}=0 \\tag{15.42}\n\\end{align*}\n$$\n\nSince typically $g_{m} L_{P} \\ll R_{P}\\left(C_{1}+C_{2}\\right)$, Eq. (15.41) yields:\n\n$$\n\\begin{equation*}\n\\omega_{R}^{2}=\\frac{1}{L_{P} \\frac{C_{1} C_{2}}{C_{1}+C_{2}}} \\tag{15.43}\n\\end{equation*}\n$$\n\nand Eq. (15.42) results in:\n\n$$\n\\begin{align*}\ng_{m} R_{P} & =\\frac{\\left(C_{1}+C_{2}\\right)^{2}}{C_{1} C_{2}}  \\tag{15.44}\\\\\n& =\\frac{C_{1}}{C_{2}}\\left(1+\\frac{C_{2}}{C_{1}}\\right)^{2} \\tag{15.45}\n\\end{align*}\n$$\n\nRecognizing that $g_{m} R_{P}$ is the voltage gain from the source of $M_{1}$ to the output (if $g_{m b}=0$), we determine the ratio $C_{1} / C_{2}$ for the minimum required gain. It can be shown that the minimum occurs for $C_{1} / C_{2}=1$, requiring:\n\n$$\n\\begin{equation*}\ng_{m} R_{P} \\geq 4 \\tag{15.46}\n\\end{equation*}\n$$\n\nEquation (15.46) highlights a significant drawback of the Colpitts oscillator compared to the cross-coupled topology of Fig. 15.27(c). The former requires a voltage gain of at least 4 at resonance, while the latter needs only unity. This is crucial if the inductor has a low $Q$ and hence a small $R_{P}$, a common issue in CMOS technologies. Consequently, the cross-coupled scheme is more widely used.\n\nThe previous analysis omitted the capacitance that appears in parallel with the inductor. As suggested in Problem 15.10, if this capacitance, $C_{P}$, is included in the equivalent circuit, Eq. (15.43) is modified to:\n\n$$\n\\begin{equation*}\n\\omega_{R}^{2}=\\frac{1}{L_{P}\\left(C_{P}+\\frac{C_{1} C_{2}}{C_{1}+C_{2}}\\right)} \\tag{15.47}\n\\end{equation*}\n$$\n\nwhile (15.46) remains unchanged. Thus, $C_{P}$ is simply added in parallel with the series combination of $C_{1}$ and $C_{2}$."
},
{
    "text": "An LC oscillator can be implemented using just one transistor in the signal path. Revisiting the gain stage depicted in Fig. 15.23(a), recall that the drain voltage cannot be applied to the gate because the overall phase shift at resonance is $180^{\\circ}$, not $360^{\\circ}$. Additionally, remember that in a common-gate configuration, the phase shift from the source to the drain is zero. We deduce that if, as illustrated in Fig. 15.29(a), the drain voltage is fed back to the source instead of the gate, the circuit might oscillate. The feedback must include a capacitor to prevent disturbance of the bias point of $M_{1}$.\n\nimage_name:Figure 15.29 (a)\ndescription:\n[\nname: LP, type: Inductor, value: LP, ports: {N1: VDD, N2: Vout}\nname: RP, type: Resistor, value: RP, ports: {N1: VDD, N2: Vout}\nname: CP, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Vout}\nname: M1, type: NMOS, ports: {S: s1, D: Vout, G: Vb}\nname: C2, type: Capacitor, value: C2, ports: {Np: Vout, Nn: s1}\nname: Ib, type: CurrentSource, value: Ib, ports: {Np: s1, Nn: GND}\nname: VDD, type: VoltageSource, value: VDD, ports: {Np: VDD, Nn: GND}\n]\nextrainfo:This circuit features a tuned stage with feedback from the drain to the source, incorporating an NMOS transistor $M_{1}$ with feedback through capacitor $C_{2}$ to maintain the bias point. The design aims for oscillation but fails due to inadequate loop gain.\n\nimage_name:Figure 15.29 (b)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: S1, D: Vout, G: Vb}\nname: LP, type: Inductor, value: LP, ports: {N1: VDD, N2: Vout}\nname: RP, type: Resistor, value: RP, ports: {N1: VDD, N2: Vout}\nname: CP, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Vout}\nname: C2, type: Capacitor, value: C2, ports: {Np: Vout, Nn: S1}\nname: Ib, type: CurrentSource, value: Ib, ports: {Np: S1, Nn: GND}\nname: Iin, type: CurrentSource, value: Iin, ports: {Np: GND, Nn: s1}\nname: VDD, type: VoltageSource, value: VDD, ports: {Np: VDD, Nn: GND}\n]\nextrainfo:The setup is a feedback system lacking sufficient loop gain for oscillation. It includes an NMOS transistor with feedback from the drain to the source, a tank circuit (inductor, resistor, capacitor), and a bias current source. An additional input current source is included to compute the closed-loop gain.\n\nFigure 15.29 (a) Tuned stage with feedback from drain to source; (b) inclusion of input current for closed-loop gain calculation.\n\nUnfortunately, due to insufficient loop gain, the circuit in Fig. 15.29(a) does not oscillate. To verify this, consider the perspective in Fig. 15.1, where an oscillator is viewed as a feedback system with infinite closed-loop gain. By applying an input current as shown in Fig. 15.29(b) and ignoring transistor parasitics, the closed-loop gain is derived as\n\n$$\n\\begin{equation*}\n\\frac{V_{\\text {out }}}{I_{\\text {in }}}=L_{P} s\\left\\|\\frac{1}{C_{P} S}\\right\\| R_{P} \\tag{15.37}\n\\end{equation*}\n$$\n\nsince $M_{1}$ and $C_{2}$ directly channel the input current to the tank. Because the closed-loop gain cannot reach infinity at any frequency, the circuit fails to oscillate.\n\n#### Example 15.7\n\nOne might wonder why the input to the feedback system is a current source applied to the transistor's source rather than a voltage source at its gate. Analyze the scenario with the latter stimulus.\n\n#### Solution\n\nFrom Fig. 15.30, observe that with a finite variation in $V_{i n}$, the change in $I_{b}$ remains zero if the bias current source is ideal. Thus, neglecting the source-bulk junction capacitance of $M_{1}$, the tank current change is zero, resulting in $V_{\\text {out }} / V_{\\text {in }}=0$. Interestingly, $V_{X}$ does vary with $V_{i n}$, but $M_{1}$ generates a small-signal current that cancels that through $C_{2}$. It can be shown that $V_{X} / V_{i n}=g_{m} /\\left(g_{m}+C_{2} s\\right)$.\n\nThis example highlights two key points. First, a circuit can be excited into oscillation by applying the stimulus at different locations. (That is, the noise from any device in the loop can initiate oscillation.) Second, in Fig. 15.30, $V_{\\text {out }} / V_{\\text {in }}$ is zero because the impedance between the source of $M_{1}$ and ground is infinite. We then add a capacitor from this node to ground, as shown in Fig. 15.31(a), to explore oscillation conditions. Note that the capacitor in parallel with $L_{P}$ is removed, the reason for which will be clarified later.\n\nimage_name:Figure 15.30\ndescription:\n[\nname: Vin, type: VoltageSource, value: Vin, ports: {Np: Vin, Nn: GND}\nname: Ib, type: CurrentSource, value: Ib, ports: {Np: X, Nn: GND}\nname: M1, type: NMOS, ports: {S: X, D: Vout, G: Vin}\nname: RP, type: Resistor, value: RP, ports: {N1: Vout, N2: VDD}\nname: CP, type: Capacitor, value: CP, ports: {Np: Vout, Nn: VDD}\nname: C2, type: Capacitor, value: C2, ports: {Np: Vout, Nn: X}\nname: LP, type: Inductor, value: LP, ports: {N1: VDD, N2: Vout}\n]\nextrainfo:This circuit is an oscillator with an NMOS transistor $M_{1}$ and a tank circuit (RP, CP, LP). The input voltage $V_{i n}$ controls the gate of $M_{1}$, and the current source $I_{b}$ biases the circuit. The output $V_{\\text {out }}$ is taken across the tank circuit.\n\nFigure 15.30\n\nimage_name:(a)\ndescription:\n[\nname: LP, type: Inductor, value: LP, ports: {N1: VDD, N2: Vout}\nname: RP, type: Resistor, value: RP, ports: {N1: VDD, N2: Vout}\nname: M1, type: NMOS, ports: {S: GND, D: Vout, G: Vb}\nname: C2, type: Capacitor, value: C2, ports: {Np: Vout, Nn: s1}\nname: Is, type: CurrentSource, ports: {Np: s1, Nn: GND}\nname: C1, type: Capacitor, value: C1, ports: {Np: s1, Nn: GND}\n]\nextrainfo:This circuit is a Colpitts oscillator. The inductor $L_{P}$ and resistor $R_{P}$ form a parallel tank circuit connected to the drain of the NMOS transistor $M_{1}$. The output $V_{\\text {out }}$ is taken across the tank circuit, and the transistor is biased by the voltage source $S_{1}$ at the gate. Capacitors $C_{1}$ and $C_{2}$ provide the necessary feedback for oscillation.\n\nimage_name:(b)\ndescription:\n[\nname: V1, type: VoltageSource, value: V1, ports: {Np: GND, Nn: x}\nname: Iin, type: CurrentSource, value: Iin, ports: {Np: GND, Nn: X}\nname: gmV1, type: VoltageControlledCurrentSource, ports: {Np: Vout, Nn: x}\nname: C1, type: Capacitor, value: C1, ports: {Np: x, Nn: GND}\nname: C2, type: Capacitor, value: C2, ports: {Np: Vout, Nn: x}\nname: LP, type: Inductor, value: LP, ports: {N1: Vout, N2: GND}\nname: RP, type: Resistor, value: RP, ports: {N1: Vout, N2: GND}\n]\nextrainfo:This circuit is a Colpitts oscillator. The voltage source $V_{1}$ biases the circuit, while the current source $I_{\\text {in }}$ provides input stimulus. The voltage-controlled current source $g_{m} V_{1}$ models the active device. Capacitors $C_{1}$ and $C_{2}$, along with inductor $L_{P}$ and resistor $R_{P}$, form the feedback network necessary for oscillation. The output is taken across the parallel combination of $L_{P}$ and $R_{P}$.\n\nFigure 15.31 (a) Colpitts oscillator; (b) equivalent circuit of (a) with input stimulus.\nBy approximating $M_{1}$ as a single voltage-dependent current source, we construct the equivalent circuit shown in Fig. 15.31(b). Given that the current through the parallel combination of $L_{P}$ and $R_{P}$ is $V_{\\text {out }} /\\left(L_{P} s\\right)+V_{\\text {out }} / R_{P}$, the total current through $C_{1}$ equals $I_{\\text {in }}-V_{\\text {out }} /\\left(L_{P} s\\right)-V_{\\text {out }} / R_{P}$, resulting in\n\n$$\n\\begin{equation*}\nV_{1}=-\\left(I_{\\text {in }}-\\frac{V_{\\text {out }}}{L_{P} S}-\\frac{V_{\\text {out }}}{R_{P}}\\right) \\frac{1}{C_{1} S} \\tag{15.38}\n\\end{equation*}\n$$\n\nExpressing the current through $C_{2}$ as $\\left(V_{\\text {out }}+V_{1}\\right) C_{2} s$, we sum all currents at the output node:\n\n$$\n\\begin{equation*}\n-g_{m}\\left(I_{\\text {in }}-\\frac{V_{\\text {out }}}{L_{P} S}-\\frac{V_{\\text {out }}}{R_{P}}\\right) \\frac{1}{C_{1} s}+\\left[V_{\\text {out }}-\\left(I_{\\text {in }}-\\frac{V_{\\text {out }}}{L_{P} S}-\\frac{V_{\\text {out }}}{R_{P}}\\right) \\frac{1}{C_{1} s}\\right] C_{2} s+\\frac{V_{\\text {out }}}{L_{P} S}+\\frac{V_{\\text {out }}}{R_{P}}=0 \\tag{15.39}\n\\end{equation*}\n$$\n\nThis leads to\n\n$$\n\\begin{equation*}\n\\frac{V_{\\text {out }}}{I_{\\text {in }}}=\\frac{R_{P} L_{P} s\\left(g_{m}+C_{2} s\\right)}{R_{P} C_{1} C_{2} L_{P} s^{3}+\\left(C_{1}+C_{2}\\right) L_{P} s^{2}+\\left[g_{m} L_{P}+R_{P}\\left(C_{1}+C_{2}\\right)\\right] s+g_{m} R_{P}} \\tag{15.40}\n\\end{equation*}\n$$\n\n[^105]Note that, as expected, (15.40) simplifies to $\\left(L_{P} S \\| R_{P}\\right)$ if $C_{1}=0$. The circuit oscillates if the closed-loop transfer function becomes infinite at an imaginary value of $s, s_{R}=j \\omega_{R}$. Consequently, both the real and imaginary parts of the denominator must be zero at this frequency:\n\n$$\n\\begin{align*}\n& -R_{P} C_{1} C_{2} L_{P} \\omega_{R}^{3}+\\left[g_{m} L_{P}+R_{P}\\left(C_{1}+C_{2}\\right)\\right] \\omega_{R}=0  \\tag{15.41}\\\\\n& -\\left(C_{1}+C_{2}\\right) L_{P} \\omega_{R}^{2}+g_{m} R_{P}=0 \\tag{15.42}\n\\end{align*}\n$$\n\nSince typically $g_{m} L_{P} \\ll R_{P}\\left(C_{1}+C_{2}\\right)$, Eq. (15.41) yields,\n\n$$\n\\begin{equation*}\n\\omega_{R}^{2}=\\frac{1}{L_{P} \\frac{C_{1} C_{2}}{C_{1}+C_{2}}} \\tag{15.43}\n\\end{equation*}\n$$\n\nand Eq. (15.42) results in\n\n$$\n\\begin{align*}\ng_{m} R_{P} & =\\frac{\\left(C_{1}+C_{2}\\right)^{2}}{C_{1} C_{2}}  \\tag{15.44}\\\\\n& =\\frac{C_{1}}{C_{2}}\\left(1+\\frac{C_{2}}{C_{1}}\\right)^{2} \\tag{15.45}\n\\end{align*}\n$$\n\nRecognizing that $g_{m} R_{P}$ is the voltage gain from the source of $M_{1}$ to the output (if $g_{m b}=0$), we determine the ratio $C_{1} / C_{2}$ for the minimum required gain. It can be shown that the minimum occurs for $C_{1} / C_{2}=1$, requiring\n\n$$\n\\begin{equation*}\ng_{m} R_{P} \\geq 4 \\tag{15.46}\n\\end{equation*}\n$$\n\nEquation (15.46) highlights a significant drawback of the Colpitts oscillator compared to the cross-coupled topology of Fig. 15.27(c). The former necessitates a voltage gain of at least 4 at resonance, whereas the latter requires only unity. This difference is crucial if the inductor has a low $Q$ and thus a small $R_{P}$, a common issue in CMOS technologies. Consequently, the cross-coupled configuration is more commonly used.\n\nThe previous analysis excluded the capacitance that appears in parallel with the inductor. As suggested in Problem 15.10, including this capacitance, $C_{P}$, in the equivalent circuit modifies Eq. (15.43) to\n\n$$\n\\begin{equation*}\n\\omega_{R}^{2}=\\frac{1}{L_{P}\\left(C_{P}+\\frac{C_{1} C_{2}}{C_{1}+C_{2}}\\right)} \\tag{15.47}\n\\end{equation*}\n$$\n\nwhile Eq. (15.46) remains unchanged. Thus, $C_{P}$ is simply added in parallel with the series combination of $C_{1}$ and $C_{2}$."
},
{
    "text": "An LC oscillator can be implemented using just one transistor in the signal path. Reconsider the gain stage depicted in Fig. 15.23(a) and recall that the drain voltage cannot be applied to the gate because the overall phase shift at resonance is $180^{\\circ}$ instead of $360^{\\circ}$. Also, remember that in a common-gate configuration, the phase shift from the source to the drain is zero. We then infer that if, as illustrated in Fig. 15.29(a), the drain voltage is fed back to the source rather than the gate, the circuit might oscillate. The feedback must include a capacitor to prevent disturbance of the bias point of $M_{1}$.\n\nimage_name:Figure 15.29 (a)\ndescription:\n[\nname: LP, type: Inductor, value: LP, ports: {N1: VDD, N2: Vout}\nname: RP, type: Resistor, value: RP, ports: {N1: VDD, N2: Vout}\nname: CP, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Vout}\nname: M1, type: NMOS, ports: {S: s1, D: Vout, G: Vb}\nname: C2, type: Capacitor, value: C2, ports: {Np: Vout, Nn: s1}\nname: Ib, type: CurrentSource, value: Ib, ports: {Np: s1, Nn: GND}\nname: VDD, type: VoltageSource, value: VDD, ports: {Np: VDD, Nn: GND}\n]\nextrainfo:This circuit is a tuned stage with feedback from the drain to the source. It includes an NMOS transistor M1, with feedback provided through capacitor C2 to avoid disturbing the bias point. The circuit is designed for oscillation but does not oscillate due to insufficient loop gain.\n\nimage_name:Figure 15.29 (b)\ndescription:\n[\nname: M1, type: NMOS, ports: {S: S1, D: Vout, G: Vb}\nname: LP, type: Inductor, value: LP, ports: {N1: VDD, N2: Vout}\nname: RP, type: Resistor, value: RP, ports: {N1: VDD, N2: Vout}\nname: CP, type: Capacitor, value: CP, ports: {Np: VDD, Nn: Vout}\nname: C2, type: Capacitor, value: C2, ports: {Np: Vout, Nn: S1}\nname: Ib, type: CurrentSource, value: Ib, ports: {Np: S1, Nn: GND}\nname: Iin, type: CurrentSource, value: Iin, ports: {Np: GND, Nn: s1}\nname: VDD, type: VoltageSource, value: VDD, ports: {Np: VDD, Nn: GND}\n]\nextrainfo:This circuit is a feedback system with inadequate loop gain for oscillation. It features an NMOS transistor with feedback from the drain to the source, a tank circuit consisting of an inductor, resistor, and capacitor, and a bias current source. An additional input current source is included to calculate the closed-loop gain.\n\nFigure 15.29 (a) Tuned stage with feedback from drain to source; (b) addition of input current to determine closed-loop gain.\n\nUnfortunately, due to insufficient loop gain, the circuit in Fig. 15.29(a) does not oscillate. To illustrate this, we refer to the perspective in Fig. 15.1, where an oscillator is viewed as a feedback system with infinite closed-loop gain. By applying an input current as shown in Fig. 15.29(b) and ignoring transistor parasitics, we derive the closed-loop gain as\n\n$$\n\\begin{equation*}\n\\frac{V_{\\text {out }}}{I_{\\text {in }}}=L_{P} s\\left\\|\\frac{1}{C_{P} S}\\right\\| R_{P} \\tag{15.37}\n\\end{equation*}\n$$\n\nsince $M_{1}$ and $C_{2}$ directly conduct the input current to the tank. Because the closed-loop gain cannot be infinite at any frequency, the circuit fails to oscillate.\n\n#### Example 15.7\n\nOne might wonder why the input to the feedback system is implemented as a current source applied to the source of the transistor instead of a voltage source applied to its gate. Perform the analysis using the latter stimulus.\n\n#### Solution\n\nFrom Fig. 15.30, we observe that with a finite variation in $V_{i n}$, the change in $I_{b}$ remains zero if the bias current source is ideal. Thus, if the source-bulk junction capacitance of $M_{1}$ is disregarded, the change in the tank current is zero, resulting in $V_{\\text {out }} / V_{\\text {in }}=0$. Interestingly, $V_{X}$ does vary with $V_{i n}$, but $M_{1}$ generates a small-signal current that cancels that through $C_{2}$. It can be shown that $V_{X} / V_{i n}=g_{m} /\\left(g_{m}+C_{2} s\\right)$.\n\nThis example highlights two key points. First, to initiate oscillation in a circuit, the stimulus can be applied at various points. (That is, the noise from any device in the loop can trigger oscillation.) Second, in Fig. 15.30, $V_{\\text {out }} / V_{\\text {in }}$ is zero because the impedance between the source of $M_{1}$ and ground is infinite. We then add a capacitor from this node to ground, as shown in Fig. 15.31(a), to explore oscillation conditions. Note that the capacitor in parallel with $L_{P}$ is removed, the reason for which will become clear later.\n\nimage_name:Figure 15.30\ndescription:\n[\nname: Vin, type: VoltageSource, value: Vin, ports: {Np: Vin, Nn: GND}\nname: Ib, type: CurrentSource, value: Ib, ports: {Np: X, Nn: GND}\nname: M1, type: NMOS, ports: {S: X, D: Vout, G: Vin}\nname: RP, type: Resistor, value: RP, ports: {N1: Vout, N2: VDD}\nname: CP, type: Capacitor, value: CP, ports: {Np: Vout, Nn: VDD}\nname: C2, type: Capacitor, value: C2, ports: {Np: Vout, Nn: X}\nname: LP, type: Inductor, value: LP, ports: {N1: VDD, N2: Vout}\n]\nextrainfo:This circuit is an oscillator with an NMOS transistor M1 and a tank circuit comprising RP, CP, and LP. The input voltage Vin controls the gate of M1, and the current source Ib biases the circuit. The output Vout is taken across the tank circuit.\n\nFigure 15.30\n\nimage_name:(a)\ndescription:\n[\nname: LP, type: Inductor, value: LP, ports: {N1: VDD, N2: Vout}\nname: RP, type: Resistor, value: RP, ports: {N1: VDD, N2: Vout}\nname: M1, type: NMOS, ports: {S: GND, D: Vout, G: Vb}\nname: C2, type: Capacitor, value: C2, ports: {Np: Vout, Nn: s1}\nname: Is, type: CurrentSource, ports: {Np: s1, Nn: GND}\nname: C1, type: Capacitor, value: C1, ports: {Np: s1, Nn: GND}\n]\nextrainfo:This circuit is a Colpitts oscillator. The inductor LP and resistor RP form a parallel tank circuit connected to the drain of the NMOS transistor M1. The output Vout is taken across the tank circuit, and the transistor is biased by the voltage source S1 at the gate. Capacitors C1 and C2 provide the necessary feedback for oscillation.\n\nimage_name:(b)\ndescription:\n[\nname: V1, type: VoltageSource, value: V1, ports: {Np: GND, Nn: x}\nname: Iin, type: CurrentSource, value: Iin, ports: {Np: GND, Nn: X}\nname: gmV1, type: VoltageControlledCurrentSource, ports: {Np: Vout, Nn: x}\nname: C1, type: Capacitor, value: C1, ports: {Np: x, Nn: GND}\nname: C2, type: Capacitor, value: C2, ports: {Np: Vout, Nn: x}\nname: LP, type: Inductor, value: LP, ports: {N1: Vout, N2: GND}\nname: RP, type: Resistor, value: RP, ports: {N1: Vout, N2: GND}\n]\nextrainfo:This circuit is a Colpitts oscillator. The voltage source V1 biases the circuit, while the current source Iin provides input stimulus. The voltage-controlled current source gmV1 models the active device. Capacitors C1 and C2, along with inductor LP and resistor RP, form the feedback network necessary for oscillation. The output is taken across the parallel combination of LP and RP.\n\nFigure 15.31 (a) Colpitts oscillator; (b) equivalent circuit of (a) with input stimulus.\n\nBy approximating $M_{1}$ as a single voltage-dependent current source, we construct the equivalent circuit shown in Fig. 15.31(b). Since the current through the parallel combination of $L_{P}$ and $R_{P}$ is given by $V_{\\text {out }} /\\left(L_{P} s\\right)+V_{\\text {out }} / R_{P}$, the total current through $C_{1}$ equals $I_{\\text {in }}-V_{\\text {out }} /\\left(L_{P} s\\right)-V_{\\text {out }} / R_{P}$, yielding\n\n$$\n\\begin{equation*}\nV_{1}=-\\left(I_{\\text {in }}-\\frac{V_{\\text {out }}}{L_{P} S}-\\frac{V_{\\text {out }}}{R_{P}}\\right) \\frac{1}{C_{1} S} \\tag{15.38}\n\\end{equation*}\n$$\n\nExpressing the current through $C_{2}$ as $\\left(V_{\\text {out }}+V_{1}\\right) C_{2} s$, we sum all currents at the output node:\n\n$$\n\\begin{equation*}\n-g_{m}\\left(I_{\\text {in }}-\\frac{V_{\\text {out }}}{L_{P} S}-\\frac{V_{\\text {out }}}{R_{P}}\\right) \\frac{1}{C_{1} s}+\\left[V_{\\text {out }}-\\left(I_{\\text {in }}-\\frac{V_{\\text {out }}}{L_{P} S}-\\frac{V_{\\text {out }}}{R_{P}}\\right) \\frac{1}{C_{1} s}\\right] C_{2} s+\\frac{V_{\\text {out }}}{L_{P} S}+\\frac{V_{\\text {out }}}{R_{P}}=0 \\tag{15.39}\n\\end{equation*}\n$$\n\nFrom this, we derive\n\n$$\n\\begin{equation*}\n\\frac{V_{\\text {out }}}{I_{\\text {in }}}=\\frac{R_{P} L_{P} s\\left(g_{m}+C_{2} s\\right)}{R_{P} C_{1} C_{2} L_{P} s^{3}+\\left(C_{1}+C_{2}\\right) L_{P} s^{2}+\\left[g_{m} L_{P}+R_{P}\\left(C_{1}+C_{2}\\right)\\right] s+g_{m} R_{P}} \\tag{15.40}\n\\end{equation*}\n$$\n\n[^105]Note that, as expected, (15.40) simplifies to $\\left(L_{P} S \\| R_{P}\\right)$ if $C_{1}=0$. The circuit oscillates if the closed-loop transfer function becomes infinite at an imaginary value of $s, s_{R}=j \\omega_{R}$. Consequently, both the real and imaginary parts of the denominator must be zero at this frequency:\n\n$$\n\\begin{align*}\n& -R_{P} C_{1} C_{2} L_{P} \\omega_{R}^{3}+\\left[g_{m} L_{P}+R_{P}\\left(C_{1}+C_{2}\\right)\\right] \\omega_{R}=0  \\tag{15.41}\\\\\n& -\\left(C_{1}+C_{2}\\right) L_{P} \\omega_{R}^{2}+g_{m} R_{P}=0 \\tag{15.42}\n\\end{align*}\n$$\n\nGiven that $g_{m} L_{P} \\ll R_{P}\\left(C_{1}+C_{2}\\right)$, Eq. (15.41) yields\n\n$$\n\\begin{equation*}\n\\omega_{R}^{2}=\\frac{1}{L_{P} \\frac{C_{1} C_{2}}{C_{1}+C_{2}}} \\tag{15.43}\n\\end{equation*}\n$$\n\nand Eq. (15.42) results in\n\n$$\n\\begin{align*}\ng_{m} R_{P} & =\\frac{\\left(C_{1}+C_{2}\\right)^{2}}{C_{1} C_{2}}  \\tag{15.44}\\\\\n& =\\frac{C_{1}}{C_{2}}\\left(1+\\frac{C_{2}}{C_{1}}\\right)^{2} \\tag{15.45}\n\\end{align*}\n$$\n\nRecognizing that $g_{m} R_{P}$ is the voltage gain from the source of $M_{1}$ to the output (if $g_{m b}=0$), we determine the ratio $C_{1} / C_{2}$ for the minimum required gain. It can be shown that the minimum occurs for $C_{1} / C_{2}=1$, requiring\n\n$$\n\\begin{equation*}\ng_{m} R_{P} \\geq 4 \\tag{15.46}\n\\end{equation*}\n$$\n\nEquation (15.46) highlights a significant drawback of the Colpitts oscillator compared to the cross-coupled topology of Fig. 15.27(c). The former requires a voltage gain of at least 4 at resonance, while the latter only needs unity. This difference is crucial if the inductor has a low $Q$ and hence a small $R_{P}$, a common issue in CMOS technologies. Consequently, the cross-coupled scheme is more commonly used.\n\nThe previous analysis ignored the capacitance that appears in parallel with the inductor. As suggested in Problem 15.10, if this capacitance, $C_{P}$, is included in the equivalent circuit, Eq. (15.43) is modified to\n\n$$\n\\begin{equation*}\n\\omega_{R}^{2}=\\frac{1}{L_{P}\\left(C_{P}+\\frac{C_{1} C_{2}}{C_{1}+C_{2}}\\right)} \\tag{15.47}\n\\end{equation*}\n$$\n\nwhile (15.46) remains unchanged. Thus, $C_{P}$ is simply added in parallel with the series combination of $C_{1}$ and $C_{2}$."
},
{
    "text": "To rephrase the provided text while maintaining the original meaning and length:\n\nOur progress in creating oscillators has hitherto relied on feedback systems. An alternative perspective that offers deeper understanding of the oscillation process involves the notion of \"negative resistance.\" To grasp this perspective, let's start by examining a straightforward tank circuit excited by a current pulse [Fig. 15.32(a)]. The tank reacts with a decaying oscillatory pattern because, during each cycle, some of the energy shuttling between the capacitor and the inductor dissipates as heat in the resistor. Now, imagine if a resistor with a value of $-R_{P}$ were placed in parallel with $R_{P}$, and the experiment was conducted again [Fig. 15.32(b)].\n\n[Figures and descriptions of the circuits remain unchanged in the rephrased text.]\n\nSince $R_{P} \\|\\left(-R_{P}\\right)=\\infty$, the tank will oscillate indefinitely. Therefore, if a one-port circuit displaying negative resistance is connected in parallel with a tank [Fig. 15.32(c)], the combination could oscillate. This arrangement is known as a one-port oscillator.\n\nHow can a circuit exhibit negative resistance? It's important to remember that feedback either amplifies or reduces the input and output impedances of circuits by a factor equal to one plus the loop gain. Consequently, if the loop gain is sufficiently negative (meaning the feedback is sufficiently positive), negative resistance is realized. As a straightforward example, consider applying positive feedback around a source follower. The follower does not invert the signal, and neither should the feedback network. As shown in Fig. 15.33(a), we achieve feedback through a common-gate stage and add the current source $I_{b}$ to supply the bias current for $M_{2}$.\n\n[Figures and descriptions of the circuits remain unchanged in the rephrased text.]\n\nHence,\n\n$$\n\\frac{V_{X}}{I_{X}}=-\\left(\\frac{1}{g_{m 1}}+\\frac{1}{g_{m 2}}\\right)\n$$\n\nand, if $g_{m 1}=g_{m 2}=g_{m}$, then\n\n$$\n\\frac{V_{X}}{I_{X}}=\\frac{-2}{g_{m}}\n$$\n\nNegative resistance makes more sense when we consider it as an incremental quantity; that is, negative resistance means that if the applied voltage increases, the current drawn by the circuit decreases. In Fig. 15.33(a), for instance, if the input voltage rises, so does the source voltage of $M_{1}$, reducing the drain current of $M_{2}$ and allowing a portion of $I_{b}$ to flow to the input source.\n\n[Figures and descriptions of the circuits remain unchanged in the rephrased text.]\n\nWith negative resistance at our disposal, we can now assemble an oscillator as depicted in Fig. 15.34. Here, $R_{P}$ represents the equivalent parallel resistance of the tank, and for oscillation to build up, $R_{P}-2 / g_{m} \\geq 0$. Note that the inductor supplies the bias current for $M_{2}$, eliminating the need for a separate current source. If the small-signal resistance presented by $M_{1}$ and $M_{2}$ to the tank is less negative than $-R_{P}$, the circuit will experience large swings such that each transistor is almost off for part of the cycle, resulting in an \"average\" resistance of $-R_{P}$.\n\nThe circuit of Fig. 15.34 resembles the stage of Fig. 15.29(a), but with the feedback capacitor substituted by a source follower. More intriguingly, the circuit can be redrawn as in Fig. 15.35(a), resembling Fig. 15.27(c). Indeed, if the drain current of $M_{1}$ flows through a tank and the resulting voltage is applied to the gate of $M_{2}$, the topology of Fig. 15.35(b) is produced. Ignoring bias paths and combining the two tanks into one (Fig. 15.36), we observe that the cross-coupled pair must deliver a negative resistance of $-R_{P}$ between nodes $X$ and $Y$ to enable oscillation. The reader can verify that this resistance equals $-2 / g_{m}$ and hence it is essential that $R_{P} \\geq 1 / g_{m}$. Thus, the circuit can be perceived as either a feedback system or a negative resistance in parallel with a lossy tank. This topology is also referred to as a \"negative- $G_{m}$ oscillator.\"\n\n[Figures and descriptions of the circuits remain unchanged in the rephrased text.]\n\nAs another approach to generating negative resistance, consider the topology shown in Fig. 15.37(a), where no nodes are grounded, and channel-length modulation, body effect, and transistor capacitances are disregarded. Since the drain current of $M_{1}$ is equal to $\\left(-I_{X} / C_{1} s\\right) g_{m}$, we have\n\n$$\nV_{X}=\\left(I_{X}-\\frac{-I_{X}}{C_{1} s} g_{m}\\right) \\frac{1}{C_{2} s}+\\frac{I_{X}}{C_{1} s}\n$$\n\n[Figures and descriptions of the circuits remain unchanged in the rephrased text.]\n\nand thus\n\n$$\n\\frac{V_{X}}{I_{X}}=\\frac{g_{m}}{C_{1} C_{2} s^{2}}+\\frac{1}{C_{2} s}+\\frac{1}{C_{1} s}\n$$\n\nFor $s=j \\omega$, this impedance consists of a negative resistance of $-g_{m} /\\left(C_{1} C_{2} \\omega^{2}\\right)$ in series with the series combination of $C_{1}$ and $C_{2}$ [Fig. 15.37(b)]. Therefore, as shown in Fig. 15.37(c), if an inductor is placed between the gate and drain of $M_{1}$, the circuit may oscillate. Of the three nodes in the circuit, one can serve as an ac ground, leading to the three distinct topologies illustrated in Fig. 15.38. The circuit of Fig. 15.38(a) is indeed based on a source follower, whose input impedance was determined in Chapter 6 to have a negative real part. The configuration of Fig. 15.38(b) is a Colpitts oscillator.\n\n[Figures and descriptions of the circuits remain unchanged in the rephrased text.]\n\n#### Example 15.8\n\nRedraw the circuits of Fig. 15.38 with appropriate biasing.\n\n#### Solution\n\nThe circuits are redrawn in Fig. 15.39.\n\n[Figures and descriptions of the circuits remain unchanged in the rephrased text.]"
},
{
    "text": "The development of oscillators has so far relied on feedback systems. An alternative perspective that offers deeper insight into the oscillation process is through the concept of \"negative resistance.\" To understand this perspective, let's first examine a simple tank circuit excited by a current impulse [Fig. 15.32(a)]. The tank circuit exhibits a decaying oscillatory response since some of the energy transferred between the capacitor and the inductor in each cycle is dissipated as heat in the resistor. Now, imagine if a resistor with a value of $-R_{P}$ is connected in parallel with $R_{P}$ and the experiment is conducted again [Fig. 15.32(b)].\n\nThe circuit in (a) is a basic tank circuit, which includes a capacitor Cp, an inductor Lp, and a resistor Rp, all connected in parallel to a current source Iin. The tank circuit's response is characterized by decaying oscillations due to the energy loss in resistor Rp. In diagram (b), the tank circuit is modified to include negative resistance, which compensates for the losses in Rp, enabling sustained oscillations. Diagram (c) depicts a one-port oscillator that incorporates an active circuit to generate negative resistance, countering the losses in Rp and allowing the tank circuit to oscillate indefinitely.\n\nIn Figure 15.32: (a) shows the decaying impulse response of a tank circuit; (b) illustrates the addition of negative resistance to offset the loss in $R_{P}$; (c) demonstrates the use of an active circuit to provide negative resistance.\n\nSince $R_{P} \\|\\left(-R_{P}\\right)=\\infty$, the tank circuit oscillates indefinitely. Therefore, if a one-port circuit exhibiting negative resistance is connected in parallel with a tank circuit [Fig. 15.32(c)], the combination can oscillate. This arrangement is referred to as a one-port oscillator.\n\nTo understand how a circuit can provide negative resistance, it's important to remember that feedback can either amplify or attenuate the input and output impedances of a circuit by a factor equal to one plus the loop gain. Consequently, if the loop gain is sufficiently negative (meaning the feedback is sufficiently positive), negative resistance is achieved. As a straightforward example, consider applying positive feedback around a source follower. The follower does not invert the signal, and neither should the feedback network. As shown in Fig. 15.33(a), we implement the feedback using a common-gate stage and incorporate a current source $I_{b}$ to supply the bias current for $M_{2}$.\n\nIn the equivalent circuit depicted in Fig. 15.33(b) (where channel-length modulation and body effect are disregarded), we have:\n\n$$\nI_{X}=g_{m 2} V_{2}=-g_{m 1} V_{1} \\tag{15.48}\n$$\n\nand\n\n$$\nV_{X}=V_{1}-V_{2} \\tag{15.49}\n$$\n\n$$\nV_{X}=-\\frac{I_{X}}{g_{m 1}}-\\frac{I_{X}}{g_{m 2}} \\tag{15.50}\n$$\n\nThus,\n\n$$\n\\frac{V_{X}}{I_{X}}=-\\left(\\frac{1}{g_{m 1}}+\\frac{1}{g_{m 2}}\\right) \\tag{15.51}\n$$\n\nand, if $g_{m 1}=g_{m 2}=g_{m}$, then\n\n$$\n\\frac{V_{X}}{I_{X}}=\\frac{-2}{g_{m}} \\tag{15.52}\n$$\n\nNegative resistance is more easily comprehensible when considered as an incremental quantity; it signifies that if the applied voltage increases, the current drawn by the circuit decreases. In Fig. 15.33(a), for instance, if the input voltage rises, the source voltage of $M_{1}$ also increases, reducing the drain current of $M_{2}$ and allowing a portion of $I_{b}$ to flow to the input source.\n\nWith negative resistance available, we can construct an oscillator as shown in Fig. 15.34. Here, $R_{P}$ represents the equivalent parallel resistance of the tank, and for oscillation to build up, $R_{P}-2 / g_{m} \\geq 0$. It's important to note that the inductor provides the bias current for $M_{2}$, eliminating the need for an additional current source. If the small-signal resistance presented by $M_{1}$ and $M_{2}$ to the tank is less negative than $-R_{P}$, the circuit will experience large swings, causing each transistor to be nearly off for part of the period and thus yielding an \"average\" resistance of $-R_{P}$.\n\nThe circuit in Fig. 15.34 resembles the stage in Fig. 15.29(a), but with the feedback capacitor replaced by a source follower. More intriguingly, the circuit can be redrawn as in Fig. 15.35(a), bearing a resemblance to Fig. 15.27(c). In fact, if the drain current of $M_{1}$ flows through a tank and the resulting voltage is applied to the gate of $M_{2}$, the topology shown in Fig. 15.35(b) is obtained. Ignoring bias paths and merging the two tanks into one (Fig. 15.36), we observe that the cross-coupled pair must provide a negative resistance of $-R_{P}$ between nodes $X$ and $Y$ to facilitate oscillation. The reader can verify that this resistance equals $-2 / g_{m}$, and hence it is necessary for $R_{P} \\geq 1 / g_{m}$. Thus, the circuit can be perceived as either a feedback system or a negative resistance in parallel with a lossy tank. This topology is also referred to as a \"negative- $G_{m}$ oscillator.\"\n\nFor an alternate method of generating negative resistance, consider the topology depicted in Fig. 15.37(a), where none of the nodes are grounded, and channel-length modulation, body effect, and transistor capacitances are neglected. Since the drain current of $M_{1}$ is equal to $\\left(-I_{X} / C_{1} s\\right) g_{m}$, we have\n\n$$\nV_{X}=\\left(I_{X}-\\frac{-I_{X}}{C_{1} s} g_{m}\\right) \\frac{1}{C_{2} s}+\\frac{I_{X}}{C_{1} s} \\tag{15.53}\n$$\n\nand hence\n\n$$\n\\frac{V_{X}}{I_{X}}=\\frac{g_{m}}{C_{1} C_{2} s^{2}}+\\frac{1}{C_{2} s}+\\frac{1}{C_{1} s} \\tag{15.54}\n$$\n\nFor $s=j \\omega$, this impedance consists of a negative resistance equal to $-g_{m} /\\left(C_{1} C_{2} \\omega^{2}\\right)$ in series with the series combination of $C_{1}$ and $C_{2}$ [Fig. 15.37(b)]. Therefore, as shown in Fig. 15.37(c), if an inductor is placed between the gate and drain of $M_{1}$, the circuit may oscillate. Of the three nodes in the circuit, one can be an ac ground, resulting in the three different topologies illustrated in Fig. 15.38. The circuit in Fig. 15.38(a) is actually based on a source follower, whose input impedance was found in Chapter 6 to contain a negative real part. The configuration in Fig. 15.38(b) is a Colpitts oscillator.\n\n#### Example 15.8\n\nRedraw the circuits of Fig. 15.38 with proper biasing.\n\n#### Solution\n\nThe circuits are redrawn in Fig. 15.39."
},
{
    "text": "The development of oscillators has primarily relied on feedback systems. An alternative perspective that offers deeper insights into oscillatory behavior involves the concept of \"negative resistance.\" To explore this perspective, let's consider a basic tank circuit that responds to a current impulse [Fig. 15.32(a)]. This tank circuit exhibits a decaying oscillatory response since some of the energy transferring between the capacitor and inductor is dissipated as heat in the resistor. Now, imagine adding a resistor with a value of $-R_{P}$ in parallel with $R_{P}$ and repeating the experiment [Fig. 15.32(b)].\n\nThe circuit in (a) is a simple tank circuit consisting of a capacitor Cp, an inductor Lp, and a resistor Rp connected in parallel to a current source Iin. The tank circuit demonstrates a decaying oscillatory response due to energy loss in resistor Rp. In diagram (b), a tank circuit is depicted with an additional negative resistance component to counteract the losses in Rp, enabling sustained oscillations. Diagram (c) illustrates a one-port oscillator that utilizes an active circuit to provide negative resistance, compensating for the losses in Rp and allowing the tank circuit to oscillate indefinitely.\n\nFigure 15.32 (a) depicts the decaying impulse response of a tank circuit; (b) shows the addition of negative resistance to offset the loss in $R_{P}$; (c) presents the use of an active circuit to supply negative resistance.\n\nSince $R_{P} \\|\\left(-R_{P}\\right)=\\infty$, the tank circuit can oscillate indefinitely. Consequently, if a one-port circuit exhibiting negative resistance is placed in parallel with a tank circuit [Fig. 15.32(c)], the combination may oscillate. This arrangement is known as a one-port oscillator.\n\nTo understand how a circuit can provide negative resistance, it's important to recall that feedback can amplify or attenuate the input and output impedances of circuits by a factor equal to one plus the loop gain. Therefore, if the loop gain is sufficiently negative (meaning the feedback is sufficiently positive), negative resistance is achieved. As a simple illustration, consider applying positive feedback around a source follower. The follower does not invert the signal, and neither should the feedback network. As shown in Fig. 15.33(a), the feedback is implemented using a common-gate stage, and a current source $I_{b}$ is added to supply the bias current for $M_{2}$. In the equivalent circuit of Fig. 15.33(b) (where channel-length modulation and body effect are neglected),\nwe obtain the following equations:\n\n$$\nI_{X}=g_{m 2} V_{2}=-g_{m 1} V_{1} \\tag{15.48}\n$$\n\nand\n\n$$\nV_{X}=V_{1}-V_{2}  \\tag{15.49}\n$$\n\n$$\nV_{X}=-\\frac{I_{X}}{g_{m 1}}-\\frac{I_{X}}{g_{m 2}} \\tag{15.50}\n$$\n\nThus,\n\n$$\n\\frac{V_{X}}{I_{X}}=-\\left(\\frac{1}{g_{m 1}}+\\frac{1}{g_{m 2}}\\right) \\tag{15.51}\n$$\n\nand if $g_{m 1}=g_{m 2}=g_{m}$, then\n\n$$\n\\frac{V_{X}}{I_{X}}=\\frac{-2}{g_{m}} \\tag{15.52}\n$$\n\nNegative resistance becomes more intuitive when we recognize that it is an incremental quantity; that is, negative resistance implies that if the applied voltage increases, the current drawn by the circuit decreases. For example, in Fig. 15.33(a), if the input voltage increases, so does the source voltage of $M_{1}$, decreasing the drain current of $M_{2}$ and allowing part of $I_{b}$ to flow to the input source.\n\nWith negative resistance available, we can construct an oscillator as shown in Fig. 15.34. Here, $R_{P}$ represents the equivalent parallel resistance of the tank circuit, and for oscillation build-up, $R_{P}-2 / g_{m} \\geq 0$. Note that the inductor supplies the bias current for $M_{2}$, eliminating the need for a separate current source. If the small-signal resistance presented by $M_{1}$ and $M_{2}$ to the tank circuit is less negative than $-R_{P}$, the circuit experiences large swings, causing each transistor to be nearly off for part of the period and resulting in an \"average\" resistance of $-R_{P}$.\n\nThe circuit in Fig. 15.34 resembles the stage shown in Fig. 15.29(a), but with the feedback capacitor replaced by a source follower. More interestingly, the circuit can be redrawn as in Fig. 15.35(a), bearing a resemblance to Fig. 15.27(c). In fact, if the drain current of $M_{1}$ flows through a tank circuit and the resulting voltage is applied to the gate of $M_{2}$, the topology shown in Fig. 15.35(b) is obtained. Ignoring bias paths and merging the two tank circuits into one (Fig. 15.36), we observe that the cross-coupled pair must provide a negative resistance of $-R_{P}$ between nodes $X$ and $Y$ to enable oscillation. The reader can verify that this resistance is equal to $-2 / g_{m}$, and hence it is necessary that $R_{P} \\geq 1 / g_{m}$. Therefore, the circuit can be viewed as either a feedback system or a negative resistance in parallel with a lossy tank circuit. This topology is also referred to as a \"negative- $G_{m}$ oscillator.\"\n\nAs another approach to generating negative resistance, consider the topology depicted in Fig. 15.37(a), where none of the nodes are grounded, and channel-length modulation, body effect, and transistor capacitances are neglected. Since the drain current of $M_{1}$ is equal to $\\left(-I_{X} / C_{1} s\\right) g_{m}$, we have\n\n$$\nV_{X}=\\left(I_{X}-\\frac{-I_{X}}{C_{1} s} g_{m}\\right) \\frac{1}{C_{2} s}+\\frac{I_{X}}{C_{1} s} \\tag{15.53}\n$$\n\nand hence\n\n$$\n\\frac{V_{X}}{I_{X}}=\\frac{g_{m}}{C_{1} C_{2} s^{2}}+\\frac{1}{C_{2} s}+\\frac{1}{C_{1} s} \\tag{15.54}\n$$\n\nFor $s=j \\omega$, this impedance consists of a negative resistance equal to $-g_{m} /\\left(C_{1} C_{2} \\omega^{2}\\right)$ in series with the series combination of $C_{1}$ and $C_{2}$ [Fig. 15.37(b)]. Thus, as shown in Fig. 15.37(c), if an inductor is placed between the gate and drain of $M_{1}$, the circuit may oscillate. Of the three nodes in the circuit, one can be an ac ground, resulting in the three different topologies illustrated in Fig. 15.38. The circuit in Fig. 15.38(a) is actually based on a source follower, whose input impedance was found in Chapter 6 to contain a negative real part. The configuration in Fig. 15.38(b) is a Colpitts oscillator.\n\nFigure 15.38 illustrates oscillator topologies derived from the circuit of Fig. 15.37(c).\n\n#### Example 15.8\n\nRedraw the circuits of Fig. 15.38 with proper biasing.\n\n#### Solution\n\nThe circuits are redrawn in Fig. 15.39."
},
{
    "text": "The progression of our oscillators has hinged on feedback systems until now. However, an alternative perspective that delves deeper into the oscillation process引入了“负电阻”的概念。为了理解这一观点，我们首先要思考一个简单的谐振电路，该电路受到电流脉冲的激励[图15.32(a)]。由于在每个周期内，电容器和电感器之间相互交换的能量有一部分以热能的形式在电阻中耗散，因此该电路呈现出衰减的振荡行为。现在假设将一个等于$-R_{P}$的电阻与$R_{P}$并联，然后重复实验[图15.32(b)]。\n\n图15.32(a)展示了一个简单的谐振电路对脉冲的衰减响应；(b)通过添加负电阻来补偿$R_{P}$中的损耗；(c)使用有源电路提供负电阻。\n\n由于$R_{P} \\|\\left(-R_{P}\\right)=\\infty$，因此谐振电路将持续振荡。因此，如果一个表现出负电阻特性的单端口电路与谐振电路[图15.32(c)]并联，则该组合可能会振荡。这种拓扑结构被称为单端口振荡器。\n\n电路如何提供负电阻？回想一下，反馈会以等于1加上环路增益的因子来乘或除电路的输入和输出阻抗。因此，如果环路增益足够负（即，反馈足够正），就可以实现负电阻。作为一个简单的例子，让我们围绕源极跟随器应用正反馈。跟随器不引入信号反转，反馈网络也不应该引入。如图15.33(a)所示，我们通过共栅极阶段实现反馈，并添加电流源$I_{b}$以为$M_{2}{ }^{7}$提供偏置电流。从图15.33(b)中的等效电路（忽略了沟道长度调制和体效应）来看，\n\n图15.33(a)展示了带有正反馈以产生负输入阻抗的源极跟随器；(b)是(a)的等效电路，用于计算输入阻抗。\n\n我们有\n\n$$\n\\begin{equation*}\nI_{X}=g_{m 2} V_{2}=-g_{m 1} V_{1} \\tag{15.48}\n\\end{equation*}\n$$\n\n$$\n以及\n$$\n\n$$\n\\begin{align*}\nV_{X} & =V_{1}-V_{2}  \\tag{15.49}\\\\\n& =-\\frac{I_{X}}{g_{m 1}}-\\frac{I_{X}}{g_{m 2}} \\tag{15.50}\n\\end{align*}\n$$\n\n因此，\n\n$$\n\\begin{equation*}\n\\frac{V_{X}}{I_{X}}=-\\left(\\frac{1}{g_{m 1}}+\\frac{1}{g_{m 2}}\\right) \\tag{15.51}\n\\end{equation*}\n$$\n\n并且，如果$g_{m 1}=g_{m 2}=g_{m}$，则\n\n$$\n\\begin{equation*}\n\\frac{V_{X}}{I_{X}}=\\frac{-2}{g_{m}} \\tag{15.52}\n\\end{equation*}\n$$\n\n如果记住负电阻是一个增量量，那么它就更容易理解了；也就是说，负电阻表明如果施加的电压增加，电路吸收的电流就会减少。例如，在图15.33(a)中，如果输入电压增加，$M_{1}$的源极电压也会增加，从而减少$M_{2}$的漏极电流，并允许部分$I_{b}$流入输入源。\n\n图15.34展示了使用源极跟随器的负输入电阻和正反馈来创建振荡器的电路。\n\n利用可用的负电阻，我们可以构建如图15.34所示的振荡器。在这里，$R_{P}$表示谐振电路的等效并联电阻，为了建立振荡，需要$R_{P}-2 / g_{m} \\geq 0$。注意，电感器为$M_{2}$提供偏置电流，从而无需额外的电流源。如果$M_{1}$和$M_{2}$向谐振电路呈现的小信号电阻比$-R_{P}$更不消极，那么电路将经历大幅摆动，以至于每个晶体管在周期的一部分时间内几乎不导通，从而产生“平均”电阻$-R_{P}$。\n\n图15.34中的电路与图15.29(a)中的阶段相似，但用源极跟随器替换了反馈电容器。更有趣的是，可以将电路重新绘制成图15.35(a)所示，它与图15.27(c)相似。实际上，如果$M_{1}$的漏极电流流经一个谐振电路，并将由此产生的电压施加到$M_{2}$的栅极上，就可以得到图15.35(b)所示的拓扑结构。忽略偏置路径并将两个谐振电路合并为一个（图15.36），我们注意到交叉耦合对必须在节点$X$和$Y$之间提供$-R_{P}$的负电阻，以实现振荡。读者可以证明，这种电阻等于$-2 / g_{m}$，因此需要$R_{P} \\geq 1 / g_{m}$。因此，该电路可以被视为一个系统或与有损谐振电路并联的负电阻。这种拓扑结构也称为“负$G_{m}$振荡器”。\n\n图15.35(a)是绘制了图15.34中所示的拓扑结构；(b)是(a)的差分版本。\n\n图15.36是图15.35(b)的等效电路。\n\n作为创建负电阻的另一种方法，考虑图15.37(a)中所示的拓扑结构，其中没有节点接地，忽略了沟道长度调制、体效应和晶体管电容。由于$M_{1}$的漏极电流等于$\\left(-I_{X} / C_{1} s\\right) g_{m}$，我们有\n\n图15.37(a)展示了一种提供负电阻的电路拓扑；(b)是(a)的等效电路；(c)使用(a)的振荡器。\n\n因此\n\n$$\n\\begin{equation*}\n\\frac{V_{X}}{I_{X}}=\\frac{g_{m}}{C_{1} C_{2} s^{2}}+\\frac{1}{C_{2} s}+\\frac{1}{C_{1} s} \\tag{15.54}\n\\end{equation*}\n$$\n\n对于$s=j \\omega$，该阻抗由一个等于$-g_{m} /\\left(C_{1} C_{2} \\omega^{2}\\right)$的负电阻串联$C_{1}$和$C_{2}$的组合组成[图15.37(b)]。因此，如图15.37(c)所示，如果在$M_{1}$的栅极和漏极之间放置一个电感器，则电路可能会振荡。在电路的三个节点中，可以有一个是交流接地，从而产生图15.38所示的三种不同拓扑结构。图15.38(a)中的电路实际上基于源极跟随器，正如在第6章中找到的那样，其输入阻抗包含一个负实部。图15.38(b)中的配置是一个科尔皮茨振荡器。\n\n图15.38从图15.37(c)的电路派生的振荡器拓扑结构。\n\n#### 示例15.8\n\n使用适当的偏置重新绘制图15.38中的电路。\n\n#### 解答\n\n电路在图15.39中重新绘制。\n图15.39\n\n图15.38(a)中的电路实际上基于源极跟随器，正如在第6章中找到的那样，其输入阻抗包含一个负实部。图15.38(b)中的配置是一个科尔皮茨振荡器。"
},
{
    "text": "Our progress in creating oscillators has primarily relied on feedback mechanisms. However, an alternative perspective that offers greater insight into the oscillation process involves the idea of \"negative resistance.\" To explore this concept, consider a straightforward tank circuit activated by a current pulse [Fig. 15.32(a)]. The tank circuit exhibits a decaying oscillatory response since, with each cycle, some energy is dissipated as heat in the resistor while oscillating between the capacitor and the inductor. Now, imagine introducing a resistor with a value of $-R_{P}$ in parallel with $R_{P}$ and repeating the experiment [Fig. 15.32(b)].\n\nThe circuit in (a) is a basic tank circuit consisting of a capacitor Cp, an inductor Lp, and a resistor Rp, all connected in parallel to a current source Iin. This tank circuit demonstrates a decaying oscillatory response due to energy dissipation in resistor Rp. In diagram (b), a tank circuit is shown with an additional negative resistance component designed to counteract the losses in resistor Rp, enabling sustained oscillations. Diagram (c) represents a one-port oscillator that utilizes an active circuit to generate negative resistance, countering the losses in Rp and allowing the tank circuit to oscillate continuously.\n\nFigure 15.32 depicts (a) the decaying impulse response of a tank circuit; (b) the introduction of negative resistance to offset the loss in $R_{P}$; and (c) the application of an active circuit to supply negative resistance.\n\nGiven that $R_{P} \\|\\left(-R_{P}\\right)=\\infty$, the tank circuit will oscillate indefinitely. Therefore, if a one-port circuit exhibiting negative resistance is connected in parallel with a tank circuit [Fig. 15.32(c)], the combination can sustain oscillations. This arrangement is known as a one-port oscillator.\n\nTo understand how a circuit can provide negative resistance, it's essential to recall that feedback either amplifies or reduces the input and output impedances of circuits by a factor equal to one plus the loop gain. Consequently, if the loop gain is sufficiently negative (meaning the feedback is adequately positive), negative resistance is realized. A straightforward example is applying positive feedback around a source follower. The follower does not invert the signal, and neither should the feedback network. As shown in Fig. 15.33(a), we establish the feedback through a common-gate stage and incorporate the current source $I_{b}$ to supply the bias current for $M_{2}$. Using the equivalent circuit in Fig. 15.33(b) (where channel-length modulation and body effect are disregarded), we derive the following equations:\n\n$$\n\\begin{equation*}\nI_{X}=g_{m 2} V_{2}=-g_{m 1} V_{1} \\tag{15.48}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{align*}\nV_{X} & =V_{1}-V_{2}  \\tag{15.49}\\\\\n& =-\\frac{I_{X}}{g_{m 1}}-\\frac{I_{X}}{g_{m 2}} \\tag{15.50}\n\\end{align*}\n$$\n\nThus,\n\n$$\n\\begin{equation*}\n\\frac{V_{X}}{I_{X}}=-\\left(\\frac{1}{g_{m 1}}+\\frac{1}{g_{m 2}}\\right) \\tag{15.51}\n\\end{equation*}\n$$\n\nand, if $g_{m 1}=g_{m 2}=g_{m}$, then\n\n$$\n\\begin{equation*}\n\\frac{V_{X}}{I_{X}}=\\frac{-2}{g_{m}} \\tag{15.52}\n\\end{equation*}\n$$\n\nThe concept of negative resistance becomes clearer when we recognize it as an incremental quantity; that is, negative resistance implies that if the applied voltage increases, the current drawn by the circuit decreases. In Fig. 15.33(a), for instance, if the input voltage rises, so does the source voltage of $M_{1}$, reducing the drain current of $M_{2}$ and allowing a portion of $I_{b}$ to flow towards the input source.\n\nWith negative resistance in hand, we can construct an oscillator as shown in Fig. 15.34. Here, $R_{P}$ represents the equivalent parallel resistance of the tank circuit, and for oscillation to build up, $R_{P}-2 / g_{m} \\geq 0$. Note that the inductor supplies the bias current for $M_{2}$, eliminating the need for a separate current source. If the small-signal resistance presented by $M_{1}$ and $M_{2}$ to the tank circuit is less negative than $-R_{P}$, the circuit will experience significant swings, causing each transistor to be nearly off for part of the cycle, thereby yielding an \"average\" resistance of $-R_{P}$.\n\nThe circuit in Fig. 15.34 resembles the stage in Fig. 15.29(a), but with the feedback capacitor replaced by a source follower. More intriguingly, the circuit can be reconfigured as in Fig. 15.35(a), bearing a similarity to Fig. 15.27(c). In fact, if the drain current of $M_{1}$ flows through a tank circuit and the resulting voltage is applied to the gate of $M_{2}$, the topology shown in Fig. 15.35(b) is obtained. Ignoring bias paths and merging the two tanks into one (Fig. 15.36), we observe that the cross-coupled pair must supply a negative resistance of $-R_{P}$ between nodes $X$ and $Y$ to enable oscillation. It can be proven that this resistance equals $-2 / g_{m}$, and therefore, it is necessary for $R_{P} \\geq 1 / g_{m}$. Thus, the circuit can be perceived as either a feedback system or a negative resistance in parallel with a lossy tank. This topology is also referred to as a \"negative- $G_{m}$ oscillator.\"\n\nFigure 15.35 illustrates (a) the redrawn topology from Fig. 15.34; and (b) the differential version of (a). Figure 15.36 represents the equivalent circuit of Fig. 15.35(b).\n\nAs another approach to generating negative resistance, consider the topology depicted in Fig. 15.37(a), where no nodes are grounded, and channel-length modulation, body effect, and transistor capacitances are neglected. Since the drain current of $M_{1}$ is equal to $\\left(-I_{X} / C_{1} s\\right) g_{m}$, we have\n\n$$\n\\begin{equation*}\nV_{X}=\\left(I_{X}-\\frac{-I_{X}}{C_{1} s} g_{m}\\right) \\frac{1}{C_{2} s}+\\frac{I_{X}}{C_{1} s} \\tag{15.53}\n\\end{equation*}\n$$\n\nand hence\n\n$$\n\\begin{equation*}\n\\frac{V_{X}}{I_{X}}=\\frac{g_{m}}{C_{1} C_{2} s^{2}}+\\frac{1}{C_{2} s}+\\frac{1}{C_{1} s} \\tag{15.54}\n\\end{equation*}\n$$\n\nFor $s=j \\omega$, this impedance consists of a negative resistance equal to $-g_{m} /\\left(C_{1} C_{2} \\omega^{2}\\right)$ in series with the series combination of $C_{1}$ and $C_{2}$ [Fig. 15.37(b)]. Thus, as depicted in Fig. 15.37(c), if an inductor is placed between the gate and drain of $M_{1}$, the circuit may oscillate. Of the three nodes in the circuit, one can serve as an ac ground, resulting in the three distinct topologies illustrated in Fig. 15.38. The circuit in Fig. 15.38(a) is based on a source follower, whose input impedance, as discussed in Chapter 6, possesses a negative real part. The configuration in Fig. 15.38(b) is a Colpitts oscillator.\n\nFigure 15.38 presents oscillator topologies derived from the circuit in Fig. 15.37(c).\n\n#### Example 15.8\n\nRedraw the circuits of Fig. 15.38 with proper biasing.\n\n#### Solution\n\nThe circuits are redrawn in Fig. 15.39.\n\nFigure 15.39 displays the redrawn circuits with appropriate biasing."
},
{
    "text": "Our progress in designing oscillators to date has revolved around feedback systems. An alternative perspective that offers deeper understanding of the oscillation process involves the notion of \"negative resistance.\" To grasp this perspective, let's start by examining a straightforward tank circuit that's activated by a current pulse [Fig. 15.32(a)]. The tank circuit exhibits a diminishing oscillatory response because, with each cycle, a portion of the energy that shuttles between the capacitor and the inductor dissipates as heat in the resistor. Now, imagine if a resistor with a value of $-R_{P}$ were introduced in parallel with $R_{P}$, and the experiment were conducted again [Fig. 15.32(b)].\n\nFigures 15.32 (a) illustrates the decaying impulse response of a tank circuit; (b) shows the addition of negative resistance to offset the loss in $R_{P}$; and (c) demonstrates the use of an active circuit to supply negative resistance.\n\nGiven that $R_{P} \\|\\left(-R_{P}\\right)=\\infty$, the tank circuit will oscillate indefinitely. Consequently, if a one-port circuit exhibiting negative resistance is connected in parallel with a tank [Fig. 15.32(c)], the resultant combination may oscillate. This arrangement is known as a one-port oscillator.\n\nTo understand how a circuit can provide negative resistance, recall that feedback either amplifies or reduces the input and output impedances of circuits by a factor equal to one plus the loop gain. Therefore, if the loop gain is sufficiently negative (meaning the feedback is sufficiently positive), negative resistance is realized. A straightforward example involves applying positive feedback around a source follower. The follower does not invert the signal, and neither should the feedback network. As shown in Fig. 15.33(a), we implement the feedback through a common-gate stage and incorporate the current source $I_{b}$ to supply the bias current for $M_{2}$.\n\nFigures 15.33 (a) displays a source follower with positive feedback to generate negative input impedance; (b) presents the equivalent circuit of (a) for calculating the input impedance.\n\nNegative resistance becomes more intuitive when we recognize that it is an incremental quantity; that is, negative resistance implies that if the applied voltage increases, the current drawn by the circuit decreases. In Fig. 15.33(a), for instance, if the input voltage rises, so does the source voltage of $M_{1}$, diminishing the drain current of $M_{2}$ and enabling part of $I_{b}$ to flow to the input source.\n\nWith negative resistance at our disposal, we can now assemble an oscillator as depicted in Fig. 15.34. Here, $R_{P}$ signifies the equivalent parallel resistance of the tank, and for oscillation to build up, $R_{P}-2 / g_{m} \\geq 0$. Note that the inductor supplies the bias current for $M_{2}$, eliminating the need for a separate current source. If the small-signal resistance presented by $M_{1}$ and $M_{2}$ to the tank is less negative than $-R_{P}$, the circuit will experience significant swings such that each transistor is nearly off for part of the period, resulting in an \"average\" resistance of $-R_{P}$.\n\nThe circuit in Fig. 15.34 resembles the stage in Fig. 15.29(a), but with the feedback capacitor substituted by a source follower. More intriguingly, the circuit can be reconfigured as in Fig. 15.35(a), which bears a similarity to Fig. 15.27(c). In fact, if the drain current of $M_{1}$ flows through a tank and the resulting voltage is applied to the gate of $M_{2}$, the topology of Fig. 15.35(b) is achieved. Disregarding bias paths and merging the two tanks into one (Fig. 15.36), we observe that the cross-coupled pair must supply a negative resistance of $-R_{P}$ between nodes $X$ and $Y$ to facilitate oscillation. The reader can verify that this resistance equals $-2 / g_{m}$, and thus it is essential that $R_{P} \\geq 1 / g_{m}$. Hence, the circuit can be perceived as either a feedback system or a negative resistance in parallel with a lossy tank. This topology is also referred to as a \"negative- $G_{m}$ oscillator.\"\n\nFigures 15.35 (a) depict the reconfiguration of the topology shown in Fig. 15.34; (b) presents the differential version of (a).\n\nAs another approach to generating negative resistance, consider the topology illustrated in Fig. 15.37(a), where none of the nodes are grounded, and channel-length modulation, body effect, and transistor capacitances are disregarded. Since the drain current of $M_{1}$ is equal to $\\left(-I_{X} / C_{1} s\\right) g_{m}$, we have\n\n$$\n\\begin{equation*}\nV_{X}=\\left(I_{X}-\\frac{-I_{X}}{C_{1} s} g_{m}\\right) \\frac{1}{C_{2} s}+\\frac{I_{X}}{C_{1} s} \\tag{15.53}\n\\end{equation*}\n$$\n\nand consequently\n\n$$\n\\begin{equation*}\n\\frac{V_{X}}{I_{X}}=\\frac{g_{m}}{C_{1} C_{2} s^{2}}+\\frac{1}{C_{2} s}+\\frac{1}{C_{1} s} \\tag{15.54}\n\\end{equation*}\n$$\n\nFor $s=j \\omega$, this impedance consists of a negative resistance equal to $-g_{m} /\\left(C_{1} C_{2} \\omega^{2}\\right)$ in series with the series combination of $C_{1}$ and $C_{2}$ [Fig. 15.37(b)]. Thus, as shown in Fig. 15.37(c), if an inductor is placed between the gate and drain of $M_{1}$, the circuit may oscillate. Of the three nodes in the circuit, one can serve as an ac ground, leading to the three distinct topologies illustrated in Fig. 15.38. The circuit in Fig. 15.38(a) is based on a source follower, whose input impedance was identified in Chapter 6 as having a negative real part. The configuration in Fig. 15.38(b) constitutes a Colpitts oscillator.\n\nFigures 15.38 display oscillator topologies derived from the circuit of Fig. 15.37(c).\n\nExample 15.8 involves redrawing the circuits of Fig. 15.38 with appropriate biasing.\n\nThe circuits are redrawn in Fig. 15.39.\nFigures 15.39 showcase the redrawn circuits with proper biasing."
},
{
    "text": "Our progress in creating oscillators has hitherto relied on feedback systems. An alternative perspective that offers greater insight into the oscillation process involves the notion of \"negative resistance.\" To grasp this perspective, let's start by examining a straightforward tank circuit activated by a current pulse [Fig. 15.32(a)]. The tank circuit exhibits a decaying oscillatory response because, with each cycle, some of the energy that shuttles between the capacitor and the inductor dissipates as heat in the resistor. Now, imagine if a resistor with a value of $-R_{P}$ were placed in parallel with $R_{P}$ and the experiment were conducted again [Fig. 15.32(b)].\n\nIn the provided diagrams, the circuit in (a) is a basic tank circuit comprising a capacitor Cp, an inductor Lp, and a resistor Rp, all connected in parallel to a current source Iin. This tank circuit shows a decaying oscillatory reaction due to energy dissipation in resistor Rp. The circuit in diagram (b) features a tank circuit augmented with negative resistance to counteract the losses in Rp, enabling sustained oscillations. The circuit in diagram (c) is a one-port oscillator that employs an active circuit to provide negative resistance, offsetting the losses in Rp and allowing the tank circuit to oscillate continuously.\n\nFigure 15.32 depicts (a) the decaying impulse response of a tank, (b) the addition of negative resistance to offset loss in $R_{P}$, and (c) the application of an active circuit to supply negative resistance.\n\nGiven that $R_{P} \\|\\left(-R_{P}\\right)=\\infty$, the tank circuit can oscillate indefinitely. Consequently, if a one-port circuit that exhibits negative resistance is connected in parallel with a tank [Fig. 15.32(c)], the composite system may oscillate. This arrangement is known as a one-port oscillator.\n\nThe question arises: how can a circuit provide negative resistance? It's important to remember that feedback either amplifies or reduces the input and output impedances of circuits by a factor equal to one plus the loop gain. Therefore, if the loop gain is sufficiently negative (meaning the feedback is sufficiently positive), negative resistance is realized. As a straightforward example, let's apply positive feedback around a source follower. The follower does not invert the signal, and neither does the feedback network. As shown in Fig. 15.33(a), we implement the feedback via a common-gate stage and incorporate the current source $I_{b}$ to supply the bias current for $M_{2}$. From the equivalent circuit in Fig. 15.33(b) (where channel-length modulation and body effect are disregarded),\n\nthe following equations apply:\n\n$$\nI_{X}=g_{m 2} V_{2}=-g_{m 1} V_{1} \\tag{15.48}\n$$\n\nand\n\n$$\nV_{X}=V_{1}-V_{2}  \\tag{15.49}\n$$\n\n$$\nV_{X}=-\\frac{I_{X}}{g_{m 1}}-\\frac{I_{X}}{g_{m 2}} \\tag{15.50}\n$$\n\nThus,\n\n$$\n\\frac{V_{X}}{I_{X}}=-\\left(\\frac{1}{g_{m 1}}+\\frac{1}{g_{m 2}}\\right) \\tag{15.51}\n$$\n\nand, if $g_{m 1}=g_{m 2}=g_{m}$, then\n\n$$\n\\frac{V_{X}}{I_{X}}=\\frac{-2}{g_{m}} \\tag{15.52}\n$$\n\nNegative resistance is more easily understood when we consider it as an incremental quantity; that is, negative resistance implies that if the applied voltage rises, the current drawn by the circuit decreases. In Fig. 15.33(a), for instance, if the input voltage increases, the source voltage of $M_{1}$ also rises, reducing the drain current of $M_{2}$ and allowing a portion of $I_{b}$ to flow to the input source.\n\nWith negative resistance at our disposal, we can now assemble an oscillator as shown in Fig. 15.34. Here, $R_{P}$ represents the equivalent parallel resistance of the tank, and for oscillation to build up, $R_{P}-2 / g_{m} \\geq 0$. Note that the inductor furnishes the bias current for $M_{2}$, eliminating the need for an additional current source. If the small-signal resistance presented by $M_{1}$ and $M_{2}$ to the tank is less negative than $-R_{P}$, then the circuit experiences large swings such that each transistor is nearly off for part of the period, thereby yielding an \"average\" resistance of $-R_{P}$.\n\nThe circuit in Fig. 15.34 resembles the stage in Fig. 15.29(a), but with the feedback capacitor substituted by a source follower. More intriguingly, the circuit can be reconfigured as in Fig. 15.35(a), bearing a resemblance to Fig. 15.27(c). In fact, if the drain current of $M_{1}$ flows through a tank and the resulting voltage is applied to the gate of $M_{2}$, the topology of Fig. 15.35(b) is obtained. Ignoring bias paths and merging the two tanks into one (Fig. 15.36), we observe that the cross-coupled pair must supply a negative resistance of $-R_{P}$ between nodes $X$ and $Y$ to facilitate oscillation. The reader can verify that this resistance equals $-2 / g_{m}$, and hence it is necessary for $R_{P} \\geq 1 / g_{m}$. Thus, the circuit can be perceived as either a feedback system or a negative resistance in parallel with a lossy tank. This topology is also referred to as a \"negative- $G_{m}$ oscillator.\"\n\nConsidering another method for generating negative resistance, let's examine the topology shown in Fig. 15.37(a), where no nodes are grounded, and channel-length modulation, body effect, and transistor capacitances are disregarded. Since the drain current of $M_{1}$ is equal to $\\left(-I_{X} / C_{1} s\\right) g_{m}$, we have\n\n$$\nV_{X}=\\left(I_{X}-\\frac{-I_{X}}{C_{1} s} g_{m}\\right) \\frac{1}{C_{2} s}+\\frac{I_{X}}{C_{1} s} \\tag{15.53}\n$$\n\nand hence\n\n$$\n\\frac{V_{X}}{I_{X}}=\\frac{g_{m}}{C_{1} C_{2} s^{2}}+\\frac{1}{C_{2} s}+\\frac{1}{C_{1} s} \\tag{15.54}\n$$\n\nFor $s=j \\omega$, this impedance consists of a negative resistance equal to $-g_{m} /\\left(C_{1} C_{2} \\omega^{2}\\right)$ in series with the series combination of $C_{1}$ and $C_{2}$ [Fig. 15.37(b)]. Thus, as depicted in Fig. 15.37(c), if an inductor is positioned between the gate and drain of $M_{1}$, the circuit may oscillate. Of the three nodes in the circuit, one can serve as an ac ground, resulting in the three distinct topologies illustrated in Fig. 15.38. The circuit of Fig. 15.38(a) is in fact based on a source follower, whose input impedance was determined in Chapter 6 to possess a negative real part. The configuration of Fig. 15.38(b) is a Colpitts oscillator.\n\n#### Example 15.8\n\nRedraw the circuits of Fig. 15.38 with appropriate biasing.\n\n#### Solution\n\nThe circuits are redrawn in Fig. 15.39."
},
{
    "text": "Our advancements in oscillators to date have centered on feedback systems. An alternative perspective that offers deeper understanding of the oscillation process involves the concept of \"negative resistance.\" To explore this perspective, consider a straightforward tank circuit activated by a current pulse [Fig. 15.32(a)]. The tank exhibits a diminishing oscillatory response since, with each cycle, some energy is lost as heat in the resistor while it oscillates between the capacitor and the inductor. Now, if a resistor with a value of $-R_{P}$ is introduced in parallel with $R_{P}$ and the experiment is conducted again [Fig. 15.32(b)].\n\nThe circuit depicted in (a) is a basic tank circuit featuring a capacitor Cp, an inductor Lp, and a resistor Rp, all connected in parallel to a current source Iin. The tank circuit shows a decaying oscillatory response due to energy dissipation in resistor Rp.\n\nIn diagram (b), the tank circuit is enhanced with negative resistance to counteract the energy loss in Rp, enabling continuous oscillations.\n\nThe circuit shown in diagram (c) is a one-port oscillator that utilizes an active circuit to produce negative resistance, counterbalancing the energy loss in Rp. This setup facilitates perpetual oscillation in the tank circuit.\n\nFigure 15.32 illustrates: (a) the decaying impulse response of a tank circuit; (b) the introduction of negative resistance to offset the loss in $R_{P}$; (c) the employment of an active circuit to supply negative resistance.\n\nGiven that $R_{P} \\|\\left(-R_{P}\\right)=\\infty$, the tank can oscillate indefinitely. Therefore, if a one-port circuit exhibiting negative resistance is connected in parallel with a tank [Fig. 15.32(c)], the combination could oscillate. This arrangement is referred to as a one-port oscillator.\n\nA circuit can achieve negative resistance through feedback that amplifies or reduces the input and output impedances by a factor equal to one plus the loop gain. Consequently, if the loop gain is sufficiently negative (meaning the feedback is sufficiently positive), negative resistance is realized. As a straightforward example, consider applying positive feedback around a source follower. The follower does not invert the signal, and neither should the feedback network. As shown in Fig. 15.33(a), we employ a common-gate stage for feedback and incorporate the current source $I_{b}$ to supply the bias current for $M_{2}$.\n\nIn the equivalent circuit in Fig. 15.33(b) (ignoring channel-length modulation and body effect), we have:\n\n$$\nI_{X}=g_{m 2} V_{2}=-g_{m 1} V_{1} \\tag{15.48}\n$$\n\nand\n\n$$\nV_{X}=V_{1}-V_{2}  \\tag{15.49}\n$$\n\n$$\nV_{X}=-\\frac{I_{X}}{g_{m 1}}-\\frac{I_{X}}{g_{m 2}} \\tag{15.50}\n$$\n\nThus,\n\n$$\n\\frac{V_{X}}{I_{X}}=-\\left(\\frac{1}{g_{m 1}}+\\frac{1}{g_{m 2}}\\right) \\tag{15.51}\n$$\n\nand if $g_{m 1}=g_{m 2}=g_{m}$, then\n\n$$\n\\frac{V_{X}}{I_{X}}=\\frac{-2}{g_{m}} \\tag{15.52}\n$$\n\nNegative resistance is more easily comprehended when considered as an incremental quantity, indicating that as the applied voltage rises, the current drawn by the circuit decreases. In Fig. 15.33(a), for instance, an increase in input voltage raises the source voltage of $M_{1}$, reducing the drain current of $M_{2}$ and allowing a portion of $I_{b}$ to flow to the input source.\n\nWith negative resistance at hand, we can now create an oscillator as depicted in Fig. 15.34. Here, $R_{P}$ signifies the equivalent parallel resistance of the tank, and for oscillation to grow, $R_{P}-2 / g_{m} \\geq 0$. Note that the inductor provides the bias current for $M_{2}$, eliminating the need for a separate current source. If the small-signal resistance presented by $M_{1}$ and $M_{2}$ to the tank is less negative than $-R_{P}$, the circuit experiences significant swings where each transistor is nearly off for part of the cycle, thus yielding an \"average\" resistance of $-R_{P}$.\n\nThe circuit in Fig. 15.34 resembles the stage in Fig. 15.29(a), but with the feedback capacitor substituted by a source follower. More intriguingly, the circuit can be redrawn as in Fig. 15.35(a), bearing a resemblance to Fig. 15.27(c). In fact, if the drain current of $M_{1}$ flows through a tank and the resulting voltage is applied to the gate of $M_{2}$, the topology in Fig. 15.35(b) is obtained. Ignoring bias paths and merging the two tanks into one (Fig. 15.36), we observe that the cross-coupled pair must supply a negative resistance of $-R_{P}$ between nodes $X$ and $Y$ to enable oscillation. It can be demonstrated that this resistance equals $-2 / g_{m}$, hence it is necessary that $R_{P} \\geq 1 / g_{m}$. Thus, the circuit can be perceived as either a feedback system or a negative resistance in parallel with a lossy tank. This topology is also known as a \"negative- $G_{m}$ oscillator.\"\n\nAs another technique for generating negative resistance, consider the topology shown in Fig. 15.37(a), where no nodes are grounded, and channel-length modulation, body effect, and transistor capacitances are disregarded. Since the drain current of $M_{1}$ is equal to $\\left(-I_{X} / C_{1} s\\right) g_{m}$, we have:\n\n$$\nV_{X}=\\left(I_{X}-\\frac{-I_{X}}{C_{1} s} g_{m}\\right) \\frac{1}{C_{2} s}+\\frac{I_{X}}{C_{1} s} \\tag{15.53}\n$$\n\nand hence\n\n$$\n\\frac{V_{X}}{I_{X}}=\\frac{g_{m}}{C_{1} C_{2} s^{2}}+\\frac{1}{C_{2} s}+\\frac{1}{C_{1} s} \\tag{15.54}\n$$\n\nFor $s=j \\omega$, this impedance comprises a negative resistance equivalent to $-g_{m} /\\left(C_{1} C_{2} \\omega^{2}\\right)$ in series with the parallel combination of $C_{1}$ and $C_{2}$ [Fig. 15.37(b)]. Thus, as shown in Fig. 15.37(c), if an inductor is placed between the gate and drain of $M_{1}$, the circuit may oscillate. Of the three nodes in the circuit, one can be an ac ground, leading to the three distinct topologies illustrated in Fig. 15.38. The circuit in Fig. 15.38(a) is indeed based on a source follower, whose input impedance was identified in Chapter 6 to possess a negative real part. The configuration of Fig. 15.38(b) is a Colpitts oscillator.\n\nFigure 15.38 depicts oscillator configurations derived from the circuit in Fig. 15.37(c).\n\n#### Example 15.8\n\nRedraw the circuits in Fig. 15.38 with appropriate biasing.\n\n#### Solution\n\nThe circuits are redrawn in Fig. 15.39.\n\nFigure 15.39 presents the redrawn circuits with proper biasing."
},
{
    "text": "Most applications necessitate that oscillators be \"tunable,\" meaning their output frequency should be dependent on a control input, typically a voltage. An ideal voltage-controlled oscillator (VCO) is a circuit whose output frequency\n\nSec. 15.4 Voltage-Controlled Oscillators\nimage_name:Figure 15.40\ndescription:The system block diagram labeled \"Figure 15.40\" illustrates the functional representation of a Voltage-Controlled Oscillator (VCO). The diagram is divided into two main sections: a block diagram and a graph.\n\nKey Components:\n- **Voltage-Controlled Oscillator Block:** This is the central element of the system. It accepts an input control voltage \\( V_{cont} \\) and generates an output frequency \\( \\omega_{out} \\). The primary role of the VCO is to convert the input voltage into a corresponding output frequency, ensuring the frequency is directly influenced by the control voltage.\n\nInformation and Control Flow:\n- **Input:** The control voltage \\( V_{cont} \\) is supplied to the VCO. This input determines the oscillation frequency of the output.\n- **Output:** The VCO produces the output frequency \\( \\omega_{out} \\) as a function of the control voltage. The relationship between the input and output is linear, as depicted in the graph below the block diagram.\n\nLabels, Annotations, and Key Indicators:\n- **Graph:** Below the VCO block, a graph illustrates the relationship between \\( V_{cont} \\) (x-axis) and \\( \\omega_{out} \\) (y-axis). The graph is a linear plot, indicating that the output frequency increases linearly with an increase in control voltage.\n- **\\( \\omega_{0} \\):** This represents the intercept on the y-axis, signifying the output frequency when the control voltage is zero.\n- **\\( K_{VCO} \\):** This denotes the slope of the line in the graph, representing the gain or sensitivity of the VCO, measured in rad/s/V.\n- **\\( \\omega_{1} \\) and \\( \\omega_{2} \\):** These are specific frequency points on the y-axis, indicating the range of frequencies achievable by varying the control voltage from \\( V_{1} \\) to \\( V_{2} \\).\n\nOverall System Function:\nThe main function of this system is to provide a tunable frequency output that varies linearly with the input control voltage. The VCO is designed with a specific gain \\( K_{VCO} \\), allowing precise control of the output frequency over a defined tuning range. This makes it suitable for applications requiring adjustable frequency outputs based on varying voltage inputs.\nimage_name:Definition of a VCO.\ndescription:The graph in Figure 15.40 is a linear plot representing the relationship between the control voltage \\( V_{\\text{cont}} \\) and the output frequency \\( \\omega_{\\text{out}} \\) of a voltage-controlled oscillator (VCO). The graph is a two-dimensional Cartesian plot with the horizontal axis labeled as \\( V_{\\text{cont}} \\), representing the control voltage. The vertical axis is labeled \\( \\omega_{\\text{out}} \\), representing the output angular frequency.\n\nThe plot shows a linear relationship between \\( V_{\\text{cont}} \\) and \\( \\omega_{\\text{out}} \\), indicating that the output frequency increases linearly with an increase in control voltage. The line starts at \\( \\omega_{0} \\) when \\( V_{\\text{cont}} = 0 \\), which is the intercept on the \\( \\omega_{\\text{out}} \\) axis.\n\nThe slope of the line, \\( K_{\\text{VCO}} \\), represents the gain or sensitivity of the VCO, expressed in radians per second per volt (rad/s/V). This slope indicates how much the output frequency changes per unit change in control voltage.\n\nThe graph also highlights two specific points, \\( V_1 \\) and \\( V_2 \\), on the \\( V_{\\text{cont}} \\) axis, corresponding to \\( \\omega_1 \\) and \\( \\omega_2 \\) on the \\( \\omega_{\\text{out}} \\) axis, respectively. These points define the tuning range of the VCO, \\( \\omega_2 - \\omega_1 \\), which is the range over which the oscillator can vary its output frequency based on the control voltage. The dashed lines help illustrate these points and the linear relationship.\n\nFigure 15.40 Definition of a VCO.\nis a linear function of its control voltage (Fig. 15.40):\n\n$$\n\\begin{equation*}\n\\omega_{\\text {out }}=\\omega_{0}+K_{V C O} V_{\\text {cont }} \\tag{15.55}\n\\end{equation*}\n$$\n\nHere, $\\omega_{0}$ represents the intercept corresponding to $V_{c o n t}=0$ and $K_{V C O}$ denotes the \"gain\" or \"sensitivity\" of the circuit (expressed in rad/s/V). ${ }^{8}$ The achievable range, $\\omega_{2}-\\omega_{1}$, is called the \"tuning range.\"\n\n#### Example 15.9\n\nIn the negative- $G_{m}$ oscillator of Fig. 15.27(c), assume that $C_{P}=0$, consider only the drain junction capacitance, $C_{D B}$, of $M_{1}$ and $M_{2}$, and explain why $V_{D D}$ can be viewed as the control voltage. Calculate the gain of the VCO.\n\n#### Solution\n\nSince $C_{D B}$ varies with the drain-bulk voltage, if $V_{D D}$ changes, so does the resonance frequency of the tank. Noting that the average voltage across $C_{D B}$ is approximately equal to $V_{D D}$, we write\n\n$$\n\\begin{equation*}\nC_{D B}=\\frac{C_{D B 0}}{\\left(1+\\frac{V_{D D}}{\\phi_{B}}\\right)^{m}} \\tag{15.56}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{align*}\nK_{V C O} & =\\frac{\\partial \\omega_{\\text {out }}}{\\partial V_{D D}}  \\tag{15.57}\\\\\n& =\\frac{\\partial \\omega_{\\text {out }}}{\\partial C_{D B}} \\cdot \\frac{\\partial C_{D B}}{\\partial V_{D D}} \\tag{15.58}\n\\end{align*}\n$$\n\nWith $\\omega_{\\text {out }}=1 / \\sqrt{L_{P} C_{D B}}$, we have\n\n$$\n\\begin{align*}\nK_{V C O} & =\\frac{-1}{2 \\sqrt{L_{P} C_{D B} C_{D B}}} \\cdot \\frac{-m C_{D B}}{\\phi_{B}\\left(1+\\frac{V_{D D}}{\\phi_{B}}\\right)}  \\tag{15.59}\\\\\n& =\\frac{m}{2 \\phi_{B}\\left(1+\\frac{V_{D D}}{\\phi_{B}}\\right)} \\cdot \\omega_{\\text {out }} \\tag{15.60}\n\\end{align*}\n$$\n\nNote that the relationship between $\\omega_{\\text {out }}$ and $V_{\\text {cont }}$ is nonlinear because $K_{V C O}$ varies with $V_{D D}$ and $\\omega_{\\text {out }}$.\n\nBefore modifying the oscillators discussed in the previous sections for tunability, we summarize the critical performance parameters of VCOs.\n\nCenter Frequency The center frequency (i.e., the midrange value in Fig. 15.40) is determined by the environment in which the VCO is used. For instance, in the clock generation network of a microprocessor, the VCO may need to operate at the clock rate or even twice that. Today's CMOS VCOs can achieve center frequencies up to hundreds of gigahertz.\nTuning Range The required tuning range is influenced by two parameters: (1) the variation of the VCO center frequency with process and temperature, and (2) the frequency range necessary for the application. The center frequency of some CMOS oscillators may vary by a factor of two at the extremes of process and temperature, thus requiring a sufficiently wide $(\\geq 2 \\times)$ tuning range to ensure the VCO output frequency can reach the desired value. Additionally, some applications require clock frequencies that vary by one to two orders of magnitude depending on the mode of operation, necessitating a proportionally wide tuning range.\n\nA significant concern in VCO design is the disturbance of the output phase and frequency due to noise on the control line. For a given noise amplitude, the noise in the output frequency is proportional to $K_{V C O}$ because $\\omega_{\\text {out }}=\\omega_{0}+K_{V C O} V_{\\text {cont }}$. Thus, to minimize the impact of noise in $V_{\\text {cont }}$, the VCO gain must be minimized, a requirement that conflicts with the needed tuning range. In fact, if, as shown in Fig. 15.40, the allowable range of $V_{\\text {cont }}$ is from $V_{1}$ to $V_{2}$ (e.g., from 0 to $V_{D D}$ ) and the tuning range must span at least $\\omega_{1}$ to $\\omega_{2}$, then $K_{V C O}$ must meet the following condition:\n\n$$\n\\begin{equation*}\nK_{V C O} \\geq \\frac{\\omega_{2}-\\omega_{1}}{V_{2}-V_{1}} \\tag{15.61}\n\\end{equation*}\n$$\n\nNote that, for a given tuning range, $K_{V C O}$ increases as the supply voltage decreases, making the oscillator more sensitive to noise on the control line.\n\nTuning Linearity As exemplified by Eq. (15.60), the tuning characteristics of VCOs exhibit nonlinearity, i.e., their gain, $K_{V C O}$, is not constant. As explained in Chapter 16, such nonlinearity degrades the settling behavior of phase-locked loops. Therefore, it is desirable to minimize the variation of $K_{V C O}$ across the tuning range.\n\nActual oscillator characteristics typically show a high-gain region in the middle of the range and lower gain at the two extremes (Fig. 15.41). Compared to a linear characteristic (the gray line), the actual behavior displays a maximum gain greater than that predicted by (15.61), implying that, for a given tuning range, nonlinearity inevitably leads to higher sensitivity for some region of the characteristic.\nimage_name:Figure 15.41 Nonlinear VCO characteristic\ndescription:The graph depicted is a characteristic curve of a Voltage-Controlled Oscillator (VCO), illustrating the nonlinear relationship between the output frequency (ω_out) and the control voltage (V_cont). The horizontal axis represents the control voltage (V_cont), while the vertical axis represents the output frequency (ω_out). Both axes appear to use linear scales.\n\nIn this graph, there is a black curve that represents the actual nonlinear characteristic of the VCO, and a gray line that indicates an ideal linear characteristic for comparison. The black curve shows a typical S-shaped nonlinear behavior.\n\n1. **Axes Labels and Units:**\n- **Horizontal Axis (V_cont):** Represents the control voltage.\n- **Vertical Axis (ω_out):** Represents the output frequency.\n\n2. **Overall Behavior and Trends:**\n- The curve starts at a lower frequency (ω1) when the control voltage is at V1.\n- As the control voltage increases towards V2, the output frequency rises, reaching an upper frequency limit (ω2).\n- The curve exhibits a high-gain region in the middle of the range, where the slope is steepest, indicating increased sensitivity to changes in control voltage.\n- At the extremes (near V1 and V2), the curve flattens, indicating lower sensitivity and gain.\n\n3. **Key Features and Technical Details:**\n- **High-Gain Region:** The middle portion of the curve is where the gain is highest, corresponding to the steepest slope.\n- **Low-Gain Regions:** At the beginning and end of the curve, the slope decreases, indicating reduced sensitivity.\n- Compared to the gray linear line, the actual characteristic (black curve) has a higher peak gain, demonstrating nonlinearity.\n\n4. **Annotations and Specific Data Points:**\n- The graph is annotated with dashed lines indicating the frequencies ω1 and ω2 and the control voltages V1 and V2, marking the range of operation.\n- The gray line serves as a reference for a linear response, highlighting the nonlinearity of the actual characteristic.\n\nThis graph effectively demonstrates the nonlinear behavior of a VCO, emphasizing the trade-offs between gain and control voltage across the tuning range.\n\nOutput Amplitude It is desirable to achieve a large output oscillation amplitude, thus making the waveform less susceptible to noise. The amplitude trades off with power dissipation, supply voltage, and (as explained in Sec. 15.4.2) even the tuning range. Additionally, the amplitude may vary across the tuning range, an undesirable effect.\n\nPower Dissipation As with other analog circuits, oscillators face trade-offs among speed, power dissipation, and noise. Typical oscillators consume 1 to 10 mW of power.\nSupply and Common-Mode Rejection Oscillators are highly sensitive to noise, especially if they are implemented in single-ended form. As seen in Example 15.9, even differential oscillators exhibit supply sensitivity. Designing oscillators for high noise immunity is a challenging task.\nOutput Signal Purity Even with a constant control voltage, the output waveform of a VCO is not perfectly periodic. The electronic noise of the devices in the oscillator and supply noise lead to noise in the output phase and frequency. These effects are quantified by \"jitter\" and \"phase noise\" and are determined by the requirements of each application."
},
{
    "text": "Most applications necessitate that oscillators be \"tunable,\" meaning their output frequency should be dependent on a control input, typically a voltage. An ideal voltage-controlled oscillator (VCO) is a circuit where the output frequency\n\nSec. 15.4 Voltage-Controlled Oscillators\nimage_name:Figure 15.40\ndescription:The system block diagram labeled \"Figure 15.40\" illustrates the functional representation of a Voltage-Controlled Oscillator (VCO). The diagram is divided into two main sections: a block diagram and a graph.\n\nKey Components:\n- **Voltage-Controlled Oscillator Block:** This is the central element of the system. It receives an input control voltage \\( V_{cont} \\) and generates an output frequency \\( \\omega_{out} \\). The primary role of the VCO is to convert the input voltage into a corresponding output frequency, ensuring the frequency is directly linked to the control voltage.\n\nInformation and Control Flow:\n- **Input:** The control voltage \\( V_{cont} \\) is fed into the VCO, determining the oscillation frequency of the output.\n- **Output:** The VCO produces the output frequency \\( \\omega_{out} \\) as a function of the control voltage. The relationship between input and output is linear, as shown in the graph below the block diagram.\n\nLabels, Annotations, and Key Indicators:\n- **Graph:** Below the VCO block, a graph depicts the relationship between \\( V_{cont} \\) (x-axis) and \\( \\omega_{out} \\) (y-axis). The graph is a linear plot, indicating that the output frequency increases linearly with an increase in control voltage.\n- **\\( \\omega_{0} \\):** This is the y-axis intercept, representing the output frequency when the control voltage is zero.\n- **\\( K_{VCO} \\):** This is the slope of the line in the graph, indicating the gain or sensitivity of the VCO, measured in rad/s/V.\n- **\\( \\omega_{1} \\) and \\( \\omega_{2} \\):** These are specific frequency points on the y-axis, showing the range of frequencies achievable by varying the control voltage from \\( V_{1} \\) to \\( V_{2} \\).\n\nOverall System Function:\nThe main function of this system is to provide a tunable frequency output that varies linearly with the input control voltage. The VCO is designed with a specific gain \\( K_{VCO} \\), allowing precise control of the output frequency within a defined tuning range. This makes it suitable for applications requiring adjustable frequency outputs based on varying voltage inputs.\nimage_name:Definition of a VCO.\ndescription:The graph in Figure 15.40 is a linear plot showing the relationship between the control voltage \\( V_{\\text{cont}} \\) and the output frequency \\( \\omega_{\\text{out}} \\) of a voltage-controlled oscillator (VCO). The graph is a two-dimensional Cartesian plot with the horizontal axis labeled \\( V_{\\text{cont}} \\), representing the control voltage, and the vertical axis labeled \\( \\omega_{\\text{out}} \\), representing the output angular frequency.\n\nThe plot illustrates a linear relationship between \\( V_{\\text{cont}} \\) and \\( \\omega_{\\text{out}} \\), indicating that the output frequency increases linearly with an increase in control voltage. The line starts at \\( \\omega_{0} \\) when \\( V_{\\text{cont}} = 0 \\), which is the intercept on the \\( \\omega_{\\text{out}} \\) axis.\n\nThe slope of the line, \\( K_{\\text{VCO}} \\), represents the gain or sensitivity of the VCO, expressed in radians per second per volt (rad/s/V). This slope shows how much the output frequency changes per unit change in control voltage.\n\nThe graph also highlights two specific points, \\( V_1 \\) and \\( V_2 \\), on the \\( V_{\\text{cont}} \\) axis, corresponding to \\( \\omega_1 \\) and \\( \\omega_2 \\) on the \\( \\omega_{\\text{out}} \\) axis, respectively. These points define the tuning range of the VCO, \\( \\omega_2 - \\omega_1 \\), which is the range over which the oscillator can vary its output frequency based on the control voltage. Dashed lines help illustrate these points and the linear relationship.\n\nFigure 15.40 Definition of a VCO.\nis a linear function of its control voltage (Fig. 15.40):\n\n$$\n\\begin{equation*}\n\\omega_{\\text {out }}=\\omega_{0}+K_{V C O} V_{\\text {cont }} \\tag{15.55}\n\\end{equation*}\n$$\n\nHere, $\\omega_{0}$ represents the intercept corresponding to $V_{c o n t}=0$ and $K_{V C O}$ denotes the \"gain\" or \"sensitivity\" of the circuit (expressed in rad/s/V). ${ }^{8}$ The achievable range, $\\omega_{2}-\\omega_{1}$, is termed the \"tuning range.\"\n\n#### Example 15.9\n\nIn the negative- $G_{m}$ oscillator of Fig. 15.27(c), assuming $C_{P}=0$ and considering only the drain junction capacitance, $C_{D B}$, of $M_{1}$ and $M_{2}$, explain why $V_{D D}$ can be viewed as the control voltage. Calculate the gain of the VCO.\n\n#### Solution\n\nSince $C_{D B}$ varies with the drain-bulk voltage, if $V_{D D}$ changes, so does the resonance frequency of the tank. Noting that the average voltage across $C_{D B}$ is approximately equal to $V_{D D}$, we write\n\n$$\n\\begin{equation*}\nC_{D B}=\\frac{C_{D B 0}}{\\left(1+\\frac{V_{D D}}{\\phi_{B}}\\right)^{m}} \\tag{15.56}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{align*}\nK_{V C O} & =\\frac{\\partial \\omega_{\\text {out }}}{\\partial V_{D D}}  \\tag{15.57}\\\\\n& =\\frac{\\partial \\omega_{\\text {out }}}{\\partial C_{D B}} \\cdot \\frac{\\partial C_{D B}}{\\partial V_{D D}} \\tag{15.58}\n\\end{align*}\n$$\n\nWith $\\omega_{\\text {out }}=1 / \\sqrt{L_{P} C_{D B}}$, we have\n\n$$\n\\begin{align*}\nK_{V C O} & =\\frac{-1}{2 \\sqrt{L_{P} C_{D B} C_{D B}}} \\cdot \\frac{-m C_{D B}}{\\phi_{B}\\left(1+\\frac{V_{D D}}{\\phi_{B}}\\right)}  \\tag{15.59}\\\\\n& =\\frac{m}{2 \\phi_{B}\\left(1+\\frac{V_{D D}}{\\phi_{B}}\\right)} \\cdot \\omega_{\\text {out }} \\tag{15.60}\n\\end{align*}\n$$\n\nNote that the relationship between $\\omega_{\\text {out }}$ and $V_{\\text {cont }}$ is nonlinear because $K_{V C O}$ varies with $V_{D D}$ and $\\omega_{\\text {out }}$.\n\nBefore modifying the oscillators discussed in previous sections for tunability, we summarize the key performance parameters of VCOs.\n\nCenter Frequency The center frequency (i.e., the midrange value in Fig. 15.40) is determined by the environment in which the VCO is used. For instance, in the clock generation network of a microprocessor, the VCO may need to operate at the clock rate or even twice that. Today's CMOS VCOs can achieve center frequencies up to hundreds of gigahertz.\nTuning Range The required tuning range is influenced by two factors: (1) the variation of the VCO center frequency with process and temperature, and (2) the frequency range needed for the application. The center frequency of some CMOS oscillators may vary by a factor of two at the extremes of process and temperature, necessitating a sufficiently wide $(\\geq 2 \\times)$ tuning range to ensure the VCO output frequency can reach the desired value. Additionally, some applications require clock frequencies that vary by one to two orders of magnitude depending on the mode of operation, demanding a correspondingly wide tuning range.\n\nA significant concern in VCO design is the disturbance of the output phase and frequency due to noise on the control line. For a given noise amplitude, the noise in the output frequency is proportional to $K_{V C O}$ because $\\omega_{\\text {out }}=\\omega_{0}+K_{V C O} V_{\\text {cont }}$. Thus, to minimize the impact of noise in $V_{\\text {cont }}$, the VCO gain must be minimized, a requirement that conflicts with the needed tuning range. In fact, if, as shown in Fig. 15.40, the allowable range of $V_{\\text {cont }}$ is from $V_{1}$ to $V_{2}$ (e.g., from 0 to $V_{D D}$ ) and the tuning range must span at least $\\omega_{1}$ to $\\omega_{2}$, then $K_{V C O}$ must meet the following condition:\n\n$$\n\\begin{equation*}\nK_{V C O} \\geq \\frac{\\omega_{2}-\\omega_{1}}{V_{2}-V_{1}} \\tag{15.61}\n\\end{equation*}\n$$\n\nNote that, for a given tuning range, $K_{V C O}$ increases as the supply voltage decreases, making the oscillator more sensitive to noise on the control line.\n\nTuning Linearity As exemplified by Eq. (15.60), the tuning characteristics of VCOs exhibit nonlinearity, i.e., their gain, $K_{V C O}$, is not constant. As explained in Chapter 16, such nonlinearity degrades the settling behavior of phase-locked loops. Therefore, it is desirable to minimize the variation of $K_{V C O}$ across the tuning range.\n\nActual oscillator characteristics often show a high-gain region in the middle of the range and lower gain at the two extremes (Fig. 15.41). Compared to a linear characteristic (the gray line), the actual behavior displays a maximum gain greater than that predicted by (15.61), implying that, for a given tuning range, nonlinearity inevitably leads to higher sensitivity in some regions of the characteristic.\nimage_name:Figure 15.41 Nonlinear VCO characteristic\ndescription:The graph depicted is a characteristic curve of a Voltage-Controlled Oscillator (VCO), illustrating the nonlinear relationship between the output frequency (ω_out) and the control voltage (V_cont). The horizontal axis represents the control voltage (V_cont), while the vertical axis represents the output frequency (ω_out). Both axes use linear scales.\n\nIn this graph, a black curve represents the actual nonlinear characteristic of the VCO, and a gray line indicates an ideal linear characteristic for comparison. The black curve shows a typical S-shaped nonlinear behavior.\n\n1. **Axes Labels and Units:**\n- **Horizontal Axis (V_cont):** Represents the control voltage.\n- **Vertical Axis (ω_out):** Represents the output frequency.\n\n2. **Overall Behavior and Trends:**\n- The curve starts at a lower frequency (ω1) when the control voltage is at V1.\n- As the control voltage increases towards V2, the output frequency rises, reaching an upper frequency limit (ω2).\n- The curve exhibits a high-gain region in the middle of the range, where the slope is steepest, indicating increased sensitivity to changes in control voltage.\n- At the extremes (near V1 and V2), the curve flattens, indicating lower sensitivity and gain.\n\n3. **Key Features and Technical Details:**\n- **High-Gain Region:** The middle portion of the curve has the highest gain, corresponding to the steepest slope.\n- **Low-Gain Regions:** At the beginning and end of the curve, the slope decreases, indicating reduced sensitivity.\n- Compared to the gray linear line, the actual characteristic (black curve) has a higher peak gain, demonstrating nonlinearity.\n\n4. **Annotations and Specific Data Points:**\n- The graph is annotated with dashed lines indicating the frequencies ω1 and ω2 and the control voltages V1 and V2, marking the range of operation.\n- The gray line serves as a reference for a linear response, highlighting the nonlinearity of the actual characteristic.\n\nThis graph effectively demonstrates the nonlinear behavior of a VCO, emphasizing the trade-offs between gain and control voltage across the tuning range.\n\nOutput Amplitude It is desirable to achieve a large output oscillation amplitude to make the waveform less susceptible to noise. The amplitude trades off with power dissipation, supply voltage, and (as explained in Sec. 15.4.2) even the tuning range. Additionally, the amplitude may vary across the tuning range, an undesirable effect.\n\nPower Dissipation As with other analog circuits, oscillators face trade-offs among speed, power dissipation, and noise. Typical oscillators consume 1 to 10 mW of power.\nSupply and Common-Mode Rejection Oscillators are highly sensitive to noise, especially if they are implemented in single-ended form. As seen in Example 15.9, even differential oscillators exhibit supply sensitivity. Designing oscillators for high noise immunity is a challenging task.\nOutput Signal Purity Even with a constant control voltage, the output waveform of a VCO is not perfectly periodic. The electronic noise of the devices in the oscillator and supply noise lead to noise in the output phase and frequency. These effects are quantified by \"jitter\" and \"phase noise\" and are determined by the requirements of each application."
},
{
    "text": "Most applications necessitate that oscillators be \"tunable,\" meaning their output frequency should depend on a control input, typically a voltage. An ideal voltage-controlled oscillator (VCO) is a circuit where the output frequency\n\nSec. 15.4 Voltage-Controlled Oscillators\nimage_name:Figure 15.40\ndescription:The system block diagram labeled \"Figure 15.40\" illustrates the functional representation of a Voltage-Controlled Oscillator (VCO). The diagram is divided into two main sections: a block diagram and a graph.\n\nKey Components:\n- **Voltage-Controlled Oscillator Block:** This is the central element of the system. It accepts an input control voltage \\( V_{cont} \\) and generates an output frequency \\( \\omega_{out} \\). The primary role of the VCO is to convert the input voltage into a corresponding output frequency, ensuring the frequency is directly dependent on the control voltage.\n\nInformation and Control Flow:\n- **Input:** The control voltage \\( V_{cont} \\) is input into the VCO. This voltage determines the oscillation frequency of the output.\n- **Output:** The output frequency \\( \\omega_{out} \\) is produced by the VCO as a function of the control voltage. The relationship between the input and output is linear, as depicted in the graph below the block diagram.\n\nLabels, Annotations, and Key Indicators:\n- **Graph:** Below the VCO block, a graph illustrates the relationship between \\( V_{cont} \\) (x-axis) and \\( \\omega_{out} \\) (y-axis). The graph is a linear plot, indicating that the output frequency increases linearly with an increase in control voltage.\n- **\\( \\omega_{0} \\):** This is the y-axis intercept, representing the output frequency when the control voltage is zero.\n- **\\( K_{VCO} \\):** This is the slope of the line in the graph, indicating the gain or sensitivity of the VCO, measured in rad/s/V.\n- **\\( \\omega_{1} \\) and \\( \\omega_{2} \\):** These are specific frequency points on the y-axis, showing the range of frequencies achievable by varying the control voltage from \\( V_{1} \\) to \\( V_{2} \\).\n\nOverall System Function:\nThe main function of this system is to provide a tunable frequency output that varies linearly with the input control voltage. The VCO is designed with a specific gain \\( K_{VCO} \\), allowing precise control of the output frequency over a defined tuning range. This makes it suitable for applications requiring adjustable frequency outputs based on varying voltage inputs.\nimage_name:Definition of a VCO.\ndescription:The graph in Figure 15.40 is a linear plot showing the relationship between the control voltage \\( V_{\\text{cont}} \\) and the output frequency \\( \\omega_{\\text{out}} \\) of a voltage-controlled oscillator (VCO). The graph is a two-dimensional Cartesian plot with the horizontal axis labeled \\( V_{\\text{cont}} \\), representing the control voltage, and the vertical axis labeled \\( \\omega_{\\text{out}} \\), representing the output angular frequency.\n\nThe plot demonstrates a linear relationship between \\( V_{\\text{cont}} \\) and \\( \\omega_{\\text{out}} \\), indicating that the output frequency increases linearly with an increase in control voltage. The line begins at \\( \\omega_{0} \\) when \\( V_{\\text{cont}} = 0 \\), which is the intercept on the \\( \\omega_{\\text{out}} \\) axis.\n\nThe slope of the line, \\( K_{\\text{VCO}} \\), represents the gain or sensitivity of the VCO, expressed in radians per second per volt (rad/s/V). This slope shows how much the output frequency changes per unit change in control voltage.\n\nThe graph also highlights two specific points, \\( V_1 \\) and \\( V_2 \\), on the \\( V_{\\text{cont}} \\) axis, corresponding to \\( \\omega_1 \\) and \\( \\omega_2 \\) on the \\( \\omega_{\\text{out}} \\) axis, respectively. These points define the tuning range of the VCO, \\( \\omega_2 - \\omega_1 \\), which is the range over which the oscillator can vary its output frequency based on the control voltage. Dashed lines help illustrate these points and the linear relationship.\n\nFigure 15.40 Definition of a VCO.\nis a linear function of its control voltage (Fig. 15.40):\n\n$$\n\\begin{equation*}\n\\omega_{\\text {out }}=\\omega_{0}+K_{V C O} V_{\\text {cont }} \\tag{15.55}\n\\end{equation*}\n$$\n\nHere, $\\omega_{0}$ represents the intercept corresponding to $V_{c o n t}=0$ and $K_{V C O}$ denotes the \"gain\" or \"sensitivity\" of the circuit (expressed in rad/s/V). ${ }^{8}$ The achievable range, $\\omega_{2}-\\omega_{1}$, is termed the \"tuning range.\"\n\n#### Example 15.9\n\nIn the negative- $G_{m}$ oscillator of Fig. 15.27(c), assuming $C_{P}=0$ and considering only the drain junction capacitance, $C_{D B}$, of $M_{1}$ and $M_{2}$, explain why $V_{D D}$ can be viewed as the control voltage. Calculate the gain of the VCO.\n\n#### Solution\n\nSince $C_{D B}$ varies with the drain-bulk voltage, if $V_{D D}$ changes, the resonance frequency of the tank also changes. Noting that the average voltage across $C_{D B}$ is approximately equal to $V_{D D}$, we write\n\n$$\n\\begin{equation*}\nC_{D B}=\\frac{C_{D B 0}}{\\left(1+\\frac{V_{D D}}{\\phi_{B}}\\right)^{m}} \\tag{15.56}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{align*}\nK_{V C O} & =\\frac{\\partial \\omega_{\\text {out }}}{\\partial V_{D D}}  \\tag{15.57}\\\\\n& =\\frac{\\partial \\omega_{\\text {out }}}{\\partial C_{D B}} \\cdot \\frac{\\partial C_{D B}}{\\partial V_{D D}} \\tag{15.58}\n\\end{align*}\n$$\n\nWith $\\omega_{\\text {out }}=1 / \\sqrt{L_{P} C_{D B}}$, we have\n\n$$\n\\begin{align*}\nK_{V C O} & =\\frac{-1}{2 \\sqrt{L_{P} C_{D B} C_{D B}}} \\cdot \\frac{-m C_{D B}}{\\phi_{B}\\left(1+\\frac{V_{D D}}{\\phi_{B}}\\right)}  \\tag{15.59}\\\\\n& =\\frac{m}{2 \\phi_{B}\\left(1+\\frac{V_{D D}}{\\phi_{B}}\\right)} \\cdot \\omega_{\\text {out }} \\tag{15.60}\n\\end{align*}\n$$\n\nNote that the relationship between $\\omega_{\\text {out }}$ and $V_{\\text {cont }}$ is nonlinear because $K_{V C O}$ varies with $V_{D D}$ and $\\omega_{\\text {out }}$.\n\nBefore modifying the oscillators discussed in previous sections for tunability, we summarize the key performance parameters of VCOs.\n\nCenter Frequency The center frequency (i.e., the midrange value in Fig. 15.40) is determined by the environment in which the VCO is used. For instance, in the clock generation network of a microprocessor, the VCO may need to operate at the clock rate or even twice that. Today's CMOS VCOs can achieve center frequencies up to hundreds of gigahertz.\nTuning Range The required tuning range is influenced by two factors: (1) the variation of the VCO center frequency with process and temperature, and (2) the frequency range needed for the application. The center frequency of some CMOS oscillators may vary by a factor of two at the extremes of process and temperature, necessitating a sufficiently wide $(\\geq 2 \\times)$ tuning range to ensure the VCO output frequency can reach the desired value. Additionally, some applications require clock frequencies that vary by one to two orders of magnitude depending on the mode of operation, demanding a correspondingly wide tuning range.\n\nA significant concern in VCO design is the disturbance of the output phase and frequency due to noise on the control line. For a given noise amplitude, the noise in the output frequency is proportional to $K_{V C O}$ because $\\omega_{\\text {out }}=\\omega_{0}+K_{V C O} V_{\\text {cont }}$. Thus, to minimize the impact of noise in $V_{\\text {cont }}$, the VCO gain must be minimized, a requirement that conflicts with the needed tuning range. In fact, if, as shown in Fig. 15.40, the allowable range of $V_{\\text {cont }}$ is from $V_{1}$ to $V_{2}$ (e.g., from 0 to $V_{D D}$ ) and the tuning range must span at least $\\omega_{1}$ to $\\omega_{2}$, then $K_{V C O}$ must meet the following condition:\n\n$$\n\\begin{equation*}\nK_{V C O} \\geq \\frac{\\omega_{2}-\\omega_{1}}{V_{2}-V_{1}} \\tag{15.61}\n\\end{equation*}\n$$\n\nNote that, for a given tuning range, $K_{V C O}$ increases as the supply voltage decreases, making the oscillator more sensitive to noise on the control line.\n\nTuning Linearity As exemplified by Eq. (15.60), VCO tuning characteristics exhibit nonlinearity, meaning their gain, $K_{V C O}$, is not constant. As explained in Chapter 16, such nonlinearity degrades the settling behavior of phase-locked loops. Therefore, it is desirable to minimize the variation of $K_{V C O}$ across the tuning range.\n\nActual oscillator characteristics typically show a high-gain region in the middle of the range and lower gain at the two extremes (Fig. 15.41). Compared to a linear characteristic (the gray line), the actual behavior displays a maximum gain greater than that predicted by (15.61), implying that, for a given tuning range, nonlinearity inevitably leads to higher sensitivity in some regions of the characteristic.\nimage_name:Figure 15.41 Nonlinear VCO characteristic\ndescription:The graph depicted is a characteristic curve of a Voltage-Controlled Oscillator (VCO), showing the nonlinear relationship between the output frequency (ω_out) and the control voltage (V_cont). The horizontal axis represents the control voltage (V_cont), while the vertical axis represents the output frequency (ω_out). Both axes use linear scales.\n\nIn this graph, a black curve represents the actual nonlinear characteristic of the VCO, and a gray line indicates an ideal linear characteristic for comparison. The black curve exhibits a typical S-shaped nonlinear behavior.\n\n1. **Axes Labels and Units:**\n- **Horizontal Axis (V_cont):** Represents the control voltage.\n- **Vertical Axis (ω_out):** Represents the output frequency.\n\n2. **Overall Behavior and Trends:**\n- The curve starts at a lower frequency (ω1) when the control voltage is at V1.\n- As the control voltage increases towards V2, the output frequency rises, reaching an upper frequency limit (ω2).\n- The curve shows a high-gain region in the middle of the range, where the slope is steepest, indicating increased sensitivity to changes in control voltage.\n- At the extremes (near V1 and V2), the curve flattens, indicating lower sensitivity and gain.\n\n3. **Key Features and Technical Details:**\n- **High-Gain Region:** The middle portion of the curve has the highest gain, corresponding to the steepest slope.\n- **Low-Gain Regions:** The beginning and end of the curve have a lower slope, indicating reduced sensitivity.\n- Compared to the gray linear line, the actual characteristic (black curve) has a higher peak gain, demonstrating nonlinearity.\n\n4. **Annotations and Specific Data Points:**\n- The graph is annotated with dashed lines indicating the frequencies ω1 and ω2 and the control voltages V1 and V2, marking the range of operation.\n- The gray line serves as a reference for a linear response, highlighting the nonlinearity of the actual characteristic.\n\nThis graph effectively illustrates the nonlinear behavior of a VCO, emphasizing the trade-offs between gain and control voltage across the tuning range.\n\nOutput Amplitude It is desirable to achieve a high output oscillation amplitude, making the waveform less susceptible to noise. The amplitude trades off with power dissipation, supply voltage, and (as explained in Sec. 15.4.2) even the tuning range. Additionally, the amplitude may vary across the tuning range, an undesirable effect.\n\nPower Dissipation Like other analog circuits, oscillators face trade-offs among speed, power dissipation, and noise. Typical oscillators consume 1 to 10 mW of power.\nSupply and Common-Mode Rejection Oscillators are highly sensitive to noise, especially if implemented in single-ended form. As seen in Example 15.9, even differential oscillators show supply sensitivity. Designing oscillators for high noise immunity is a challenging task.\nOutput Signal Purity Even with a constant control voltage, the output waveform of a VCO is not perfectly periodic. Device electronic noise and supply noise introduce noise into the output phase and frequency. These effects are quantified by \"jitter\" and \"phase noise\" and are determined by the requirements of each application."
},
{
    "text": "Most applications necessitate that oscillators be \"tunable,\" meaning their output frequency should be a function of a control input, typically a voltage. An ideal voltage-controlled oscillator (VCO) is a circuit where the output frequency\n\nSec. 15.4 Voltage-Controlled Oscillators\nimage_name:Figure 15.40\ndescription:The system block diagram labeled \"Figure 15.40\" illustrates the functional representation of a Voltage-Controlled Oscillator (VCO). The diagram is divided into two main sections: a block diagram and a graph.\n\nKey Components:\n- **Voltage-Controlled Oscillator Block:** This is the central element of the system. It accepts an input control voltage \\( V_{cont} \\) and generates an output frequency \\( \\omega_{out} \\). The primary role of the VCO is to convert the input voltage into a corresponding output frequency, ensuring the frequency is directly dependent on the control voltage.\n\nInformation and Control Flow:\n- **Input:** The control voltage \\( V_{cont} \\) is input into the VCO. This voltage determines the oscillation frequency of the output.\n- **Output:** The VCO produces the output frequency \\( \\omega_{out} \\) as a function of the control voltage. The relationship between input and output is linear, as depicted in the graph below the block diagram.\n\nLabels, Annotations, and Key Indicators:\n- **Graph:** Below the VCO block, a graph illustrates the relationship between \\( V_{cont} \\) (x-axis) and \\( \\omega_{out} \\) (y-axis). The graph is a linear plot, indicating that the output frequency increases linearly with an increase in control voltage.\n- **\\( \\omega_{0} \\):** This is the y-axis intercept, representing the output frequency when the control voltage is zero.\n- **\\( K_{VCO} \\):** This is the slope of the line in the graph, denoting the gain or sensitivity of the VCO, measured in rad/s/V.\n- **\\( \\omega_{1} \\) and \\( \\omega_{2} \\):** These are specific frequency points on the y-axis, indicating the range of frequencies achievable by varying the control voltage from \\( V_{1} \\) to \\( V_{2} \\).\n\nOverall System Function:\nThe main function of this system is to provide a tunable frequency output that varies linearly with the input control voltage. The VCO is designed with a specific gain \\( K_{VCO} \\), allowing precise control of the output frequency over a defined tuning range. This makes it suitable for applications requiring adjustable frequency outputs based on varying voltage inputs.\nimage_name:Definition of a VCO.\ndescription:The graph in Figure 15.40 is a linear plot representing the relationship between the control voltage \\( V_{\\text{cont}} \\) and the output frequency \\( \\omega_{\\text{out}} \\) of a voltage-controlled oscillator (VCO). The graph is a two-dimensional Cartesian plot with the horizontal axis labeled as \\( V_{\\text{cont}} \\), representing the control voltage. The vertical axis is labeled \\( \\omega_{\\text{out}} \\), representing the output angular frequency.\n\nThe plot shows a linear relationship between \\( V_{\\text{cont}} \\) and \\( \\omega_{\\text{out}} \\), indicating that the output frequency increases linearly with an increase in control voltage. The line starts at \\( \\omega_{0} \\) when \\( V_{\\text{cont}} = 0 \\), which is the intercept on the \\( \\omega_{\\text{out}} \\) axis.\n\nThe slope of the line, \\( K_{\\text{VCO}} \\), represents the gain or sensitivity of the VCO, expressed in radians per second per volt (rad/s/V). This slope indicates how much the output frequency changes per unit change in control voltage.\n\nThe graph also highlights two specific points, \\( V_1 \\) and \\( V_2 \\), on the \\( V_{\\text{cont}} \\) axis, corresponding to \\( \\omega_1 \\) and \\( \\omega_2 \\) on the \\( \\omega_{\\text{out}} \\) axis, respectively. These points define the tuning range of the VCO, \\( \\omega_2 - \\omega_1 \\), which is the range over which the oscillator can vary its output frequency based on the control voltage. The dashed lines help illustrate these points and the linear relationship.\n\nFigure 15.40 Definition of a VCO.\nis a linear function of its control voltage (Fig. 15.40):\n\n$$\n\\begin{equation*}\n\\omega_{\\text {out }}=\\omega_{0}+K_{V C O} V_{\\text {cont }} \\tag{15.55}\n\\end{equation*}\n$$\n\nHere, $\\omega_{0}$ represents the intercept corresponding to $V_{c o n t}=0$ and $K_{V C O}$ denotes the \"gain\" or \"sensitivity\" of the circuit (expressed in rad/s/V). ${ }^{8}$ The achievable range, $\\omega_{2}-\\omega_{1}$, is termed the \"tuning range.\"\n\n#### Example 15.9\n\nIn the negative- $G_{m}$ oscillator of Fig. 15.27(c), assume that $C_{P}=0$, consider only the drain junction capacitance, $C_{D B}$, of $M_{1}$ and $M_{2}$, and explain why $V_{D D}$ can be viewed as the control voltage. Calculate the gain of the VCO.\n\n#### Solution\n\nSince $C_{D B}$ varies with the drain-bulk voltage, if $V_{D D}$ changes, so does the resonance frequency of the tank. Noting that the average voltage across $C_{D B}$ is approximately equal to $V_{D D}$, we write\n\n$$\n\\begin{equation*}\nC_{D B}=\\frac{C_{D B 0}}{\\left(1+\\frac{V_{D D}}{\\phi_{B}}\\right)^{m}} \\tag{15.56}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{align*}\nK_{V C O} & =\\frac{\\partial \\omega_{\\text {out }}}{\\partial V_{D D}}  \\tag{15.57}\\\\\n& =\\frac{\\partial \\omega_{\\text {out }}}{\\partial C_{D B}} \\cdot \\frac{\\partial C_{D B}}{\\partial V_{D D}} \\tag{15.58}\n\\end{align*}\n$$\n\nWith $\\omega_{\\text {out }}=1 / \\sqrt{L_{P} C_{D B}}$, we have\n\n$$\n\\begin{align*}\nK_{V C O} & =\\frac{-1}{2 \\sqrt{L_{P} C_{D B} C_{D B}}} \\cdot \\frac{-m C_{D B}}{\\phi_{B}\\left(1+\\frac{V_{D D}}{\\phi_{B}}\\right)}  \\tag{15.59}\\\\\n& =\\frac{m}{2 \\phi_{B}\\left(1+\\frac{V_{D D}}{\\phi_{B}}\\right)} \\cdot \\omega_{\\text {out }} \\tag{15.60}\n\\end{align*}\n$$\n\nNote that the relationship between $\\omega_{\\text {out }}$ and $V_{\\text {cont }}$ is nonlinear because $K_{V C O}$ varies with $V_{D D}$ and $\\omega_{\\text {out }}$.\n\nBefore modifying the oscillators discussed in previous sections for tunability, we summarize the critical performance parameters of VCOs.\n\nCenter Frequency The center frequency (i.e., the midrange value in Fig. 15.40) is determined by the environment in which the VCO is used. For instance, in the clock generation network of a microprocessor, the VCO may need to operate at the clock rate or even twice that. Today's CMOS VCOs can achieve center frequencies up to hundreds of gigahertz.\nTuning Range The required tuning range is influenced by two factors: (1) the variation of the VCO center frequency with process and temperature, and (2) the frequency range necessary for the application. The center frequency of some CMOS oscillators may vary by a factor of two at the extremes of process and temperature, thus requiring a sufficiently wide $(\\geq 2 \\times)$ tuning range to ensure the VCO output frequency can reach the desired value. Additionally, some applications require clock frequencies that vary by one to two orders of magnitude depending on the mode of operation, necessitating a proportionally wide tuning range.\n\nA significant concern in VCO design is the disturbance of the output phase and frequency due to noise on the control line. For a given noise amplitude, the noise in the output frequency is proportional to $K_{V C O}$ because $\\omega_{\\text {out }}=\\omega_{0}+K_{V C O} V_{\\text {cont }}$. Thus, to minimize the impact of noise in $V_{\\text {cont }}$, the VCO gain must be minimized, a requirement that conflicts with the needed tuning range. In fact, if, as shown in Fig. 15.40, the allowable range of $V_{\\text {cont }}$ is from $V_{1}$ to $V_{2}$ (e.g., from 0 to $V_{D D}$ ) and the tuning range must span at least $\\omega_{1}$ to $\\omega_{2}$, then $K_{V C O}$ must meet the following condition:\n\n$$\n\\begin{equation*}\nK_{V C O} \\geq \\frac{\\omega_{2}-\\omega_{1}}{V_{2}-V_{1}} \\tag{15.61}\n\\end{equation*}\n$$\n\nNote that, for a given tuning range, $K_{V C O}$ increases as the supply voltage decreases, making the oscillator more sensitive to noise on the control line.\n\nTuning Linearity As exemplified by Eq. (15.60), the tuning characteristics of VCOs exhibit nonlinearity, i.e., their gain, $K_{V C O}$, is not constant. As explained in Chapter 16, such nonlinearity degrades the settling behavior of phase-locked loops. Therefore, it is desirable to minimize the variation of $K_{V C O}$ across the tuning range.\n\nActual oscillator characteristics typically show a high-gain region in the middle of the range and lower gain at the two extremes (Fig. 15.41). Compared to a linear characteristic (the gray line), the actual behavior displays a maximum gain greater than that predicted by (15.61), implying that, for a given tuning range, nonlinearity inevitably leads to higher sensitivity in some regions of the characteristic.\nimage_name:Figure 15.41 Nonlinear VCO characteristic\ndescription:The graph depicted is a characteristic curve of a Voltage-Controlled Oscillator (VCO), illustrating the nonlinear relationship between the output frequency (ω_out) and the control voltage (V_cont). The horizontal axis represents the control voltage (V_cont), while the vertical axis represents the output frequency (ω_out). Both axes use linear scales.\n\nIn this graph, a black curve represents the actual nonlinear characteristic of the VCO, and a gray line indicates an ideal linear characteristic for comparison. The black curve exhibits a typical S-shaped nonlinear behavior.\n\n1. **Axes Labels and Units:**\n- **Horizontal Axis (V_cont):** Represents the control voltage.\n- **Vertical Axis (ω_out):** Represents the output frequency.\n\n2. **Overall Behavior and Trends:**\n- The curve starts at a lower frequency (ω1) when the control voltage is at V1.\n- As the control voltage increases towards V2, the output frequency rises, reaching an upper frequency limit (ω2).\n- The curve shows a high-gain region in the middle of the range, where the slope is steepest, indicating increased sensitivity to changes in control voltage.\n- At the extremes (near V1 and V2), the curve flattens, indicating lower sensitivity and gain.\n\n3. **Key Features and Technical Details:**\n- **High-Gain Region:** The middle portion of the curve has the highest gain, corresponding to the steepest slope.\n- **Low-Gain Regions:** At the beginning and end of the curve, the slope decreases, indicating reduced sensitivity.\n- Compared to the gray linear line, the actual characteristic (black curve) has a higher peak gain, demonstrating nonlinearity.\n\n4. **Annotations and Specific Data Points:**\n- The graph is annotated with dashed lines indicating the frequencies ω1 and ω2 and the control voltages V1 and V2, marking the range of operation.\n- The gray line serves as a reference for a linear response, highlighting the nonlinearity of the actual characteristic.\n\nThis graph effectively demonstrates the nonlinear behavior of a VCO, emphasizing the trade-offs between gain and control voltage across the tuning range.\n\nOutput Amplitude It is desirable to achieve a high output oscillation amplitude, making the waveform less susceptible to noise. The amplitude trades off with power dissipation, supply voltage, and (as explained in Sec. 15.4.2) even the tuning range. Additionally, the amplitude may vary across the tuning range, an undesirable effect.\n\nPower Dissipation Like other analog circuits, oscillators face trade-offs among speed, power dissipation, and noise. Typical oscillators consume 1 to 10 mW of power.\nSupply and Common-Mode Rejection Oscillators are highly sensitive to noise, especially if implemented in single-ended form. As seen in Example 15.9, even differential oscillators show supply sensitivity. Designing oscillators for high noise immunity is a challenging task.\nOutput Signal Purity Even with a constant control voltage, the output waveform of a VCO is not perfectly periodic. The electronic noise of the devices in the oscillator and supply noise result in noise in the output phase and frequency. These effects are quantified by \"jitter\" and \"phase noise\" and are determined by the requirements of each application."
},
{
    "text": "Most applications necessitate that oscillators be \"tunable,\" meaning their output frequency should be dependent on a control input, typically a voltage. An ideal voltage-controlled oscillator (VCO) is a circuit where the output frequency\n\nSec. 15.4 Voltage-Controlled Oscillators\nimage_name:Figure 15.40\ndescription:The system block diagram labeled \"Figure 15.40\" illustrates the functional representation of a Voltage-Controlled Oscillator (VCO). The diagram consists of two main sections: a block diagram and a graph.\n\nKey Components:\n- **Voltage-Controlled Oscillator Block:** This is the central element of the system. It accepts an input control voltage \\( V_{cont} \\) and generates an output frequency \\( \\omega_{out} \\). The primary role of the VCO is to convert the input voltage into a corresponding output frequency, ensuring the frequency is directly influenced by the control voltage.\n\nInformation and Control Flow:\n- **Input:** The control voltage \\( V_{cont} \\) is fed into the VCO, determining the oscillation frequency of the output.\n- **Output:** The VCO produces an output frequency \\( \\omega_{out} \\) as a function of the control voltage. The relationship between input and output is linear, as depicted in the graph beneath the block diagram.\n\nLabels, Annotations, and Key Indicators:\n- **Graph:** Below the VCO block, a graph illustrates the relationship between \\( V_{cont} \\) (x-axis) and \\( \\omega_{out} \\) (y-axis). The graph is a linear plot, indicating that the output frequency increases linearly with an increase in control voltage.\n- **\\( \\omega_{0} \\):** This is the y-axis intercept, representing the output frequency when the control voltage is zero.\n- **\\( K_{VCO} \\):** This is the graph's line slope, denoting the VCO's gain or sensitivity, measured in rad/s/V.\n- **\\( \\omega_{1} \\) and \\( \\omega_{2} \\):** These are specific frequency points on the y-axis, indicating the range of frequencies achievable by varying the control voltage from \\( V_{1} \\) to \\( V_{2} \\).\n\nOverall System Function:\nThe main function of this system is to provide a tunable frequency output that varies linearly with the input control voltage. The VCO is designed with a specific gain \\( K_{VCO} \\), allowing precise control of the output frequency over a defined tuning range. This makes it suitable for applications requiring adjustable frequency outputs based on varying voltage inputs.\nimage_name:Definition of a VCO.\ndescription:The graph in Figure 15.40 is a linear plot showing the relationship between the control voltage \\( V_{\\text{cont}} \\) and the output frequency \\( \\omega_{\\text{out}} \\) of a voltage-controlled oscillator (VCO). The graph is a two-dimensional Cartesian plot with the horizontal axis labeled \\( V_{\\text{cont}} \\), representing the control voltage, and the vertical axis labeled \\( \\omega_{\\text{out}} \\), representing the output angular frequency.\n\nThe plot demonstrates a linear relationship between \\( V_{\\text{cont}} \\) and \\( \\omega_{\\text{out}} \\), indicating that the output frequency increases linearly with an increase in control voltage. The line starts at \\( \\omega_{0} \\) when \\( V_{\\text{cont}} = 0 \\), which is the intercept on the \\( \\omega_{\\text{out}} \\) axis.\n\nThe slope of the line, \\( K_{\\text{VCO}} \\), represents the gain or sensitivity of the VCO, expressed in radians per second per volt (rad/s/V). This slope indicates how much the output frequency changes per unit change in control voltage.\n\nThe graph also highlights two specific points, \\( V_1 \\) and \\( V_2 \\), on the \\( V_{\\text{cont}} \\) axis, corresponding to \\( \\omega_1 \\) and \\( \\omega_2 \\) on the \\( \\omega_{\\text{out}} \\) axis, respectively. These points define the tuning range of the VCO, \\( \\omega_2 - \\omega_1 \\), which is the range over which the oscillator can vary its output frequency based on the control voltage. Dashed lines help illustrate these points and the linear relationship.\n\nFigure 15.40 Definition of a VCO.\nis a linear function of its control voltage (Fig. 15.40):\n\n$$\n\\begin{equation*}\n\\omega_{\\text {out }}=\\omega_{0}+K_{V C O} V_{\\text {cont }} \\tag{15.55}\n\\end{equation*}\n$$\n\nHere, $\\omega_{0}$ represents the intercept corresponding to $V_{c o n t}=0$ and $K_{V C O}$ denotes the \"gain\" or \"sensitivity\" of the circuit (expressed in rad/s/V). ${ }^{8}$ The achievable range, $\\omega_{2}-\\omega_{1}$, is termed the \"tuning range.\"\n\n#### Example 15.9\n\nIn the negative- $G_{m}$ oscillator of Fig. 15.27(c), assuming $C_{P}=0$ and considering only the drain junction capacitance, $C_{D B}$, of $M_{1}$ and $M_{2}$, explain why $V_{D D}$ can be viewed as the control voltage. Calculate the VCO's gain.\n\n#### Solution\n\nSince $C_{D B}$ varies with the drain-bulk voltage, if $V_{D D}$ changes, the resonance frequency of the tank also changes. Noting that the average voltage across $C_{D B}$ is approximately equal to $V_{D D}$, we write\n\n$$\n\\begin{equation*}\nC_{D B}=\\frac{C_{D B 0}}{\\left(1+\\frac{V_{D D}}{\\phi_{B}}\\right)^{m}} \\tag{15.56}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{align*}\nK_{V C O} & =\\frac{\\partial \\omega_{\\text {out }}}{\\partial V_{D D}}  \\tag{15.57}\\\\\n& =\\frac{\\partial \\omega_{\\text {out }}}{\\partial C_{D B}} \\cdot \\frac{\\partial C_{D B}}{\\partial V_{D D}} \\tag{15.58}\n\\end{align*}\n$$\n\nWith $\\omega_{\\text {out }}=1 / \\sqrt{L_{P} C_{D B}}$, we have\n\n$$\n\\begin{align*}\nK_{V C O} & =\\frac{-1}{2 \\sqrt{L_{P} C_{D B} C_{D B}}} \\cdot \\frac{-m C_{D B}}{\\phi_{B}\\left(1+\\frac{V_{D D}}{\\phi_{B}}\\right)}  \\tag{15.59}\\\\\n& =\\frac{m}{2 \\phi_{B}\\left(1+\\frac{V_{D D}}{\\phi_{B}}\\right)} \\cdot \\omega_{\\text {out }} \\tag{15.60}\n\\end{align*}\n$$\n\nNote that the relationship between $\\omega_{\\text {out }}$ and $V_{\\text {cont }}$ is nonlinear because $K_{V C O}$ varies with $V_{D D}$ and $\\omega_{\\text {out }}$.\n\nBefore modifying the oscillators discussed in previous sections for tunability, we summarize the critical performance parameters of VCOs.\n\nCenter Frequency The center frequency (i.e., the midrange value in Fig. 15.40) is determined by the environment in which the VCO is used. For instance, in a microprocessor's clock generation network, the VCO may need to operate at the clock rate or even twice that. Today's CMOS VCOs can achieve center frequencies up to hundreds of gigahertz.\nTuning Range The required tuning range is influenced by two factors: (1) the variation of the VCO center frequency with process and temperature, and (2) the frequency range necessary for the application. The center frequency of some CMOS oscillators may vary by a factor of two at the extremes of process and temperature, necessitating a sufficiently wide $(\\geq 2 \\times)$ tuning range to ensure the VCO output frequency can reach the desired value. Additionally, some applications require clock frequencies that vary by one to two orders of magnitude depending on the mode of operation, demanding a proportionally wide tuning range.\n\nA significant concern in VCO design is the disturbance of the output phase and frequency due to noise on the control line. For a given noise amplitude, the noise in the output frequency is proportional to $K_{V C O}$ because $\\omega_{\\text {out }}=\\omega_{0}+K_{V C O} V_{\\text {cont }}$. Thus, to minimize the impact of noise in $V_{\\text {cont }}$, the VCO gain must be minimized, a requirement that conflicts with the needed tuning range. In fact, if, as shown in Fig. 15.40, the allowable range of $V_{\\text {cont }}$ is from $V_{1}$ to $V_{2}$ (e.g., from 0 to $V_{D D}$) and the tuning range must span at least $\\omega_{1}$ to $\\omega_{2}$, then $K_{V C O}$ must meet the following condition:\n\n$$\n\\begin{equation*}\nK_{V C O} \\geq \\frac{\\omega_{2}-\\omega_{1}}{V_{2}-V_{1}} \\tag{15.61}\n\\end{equation*}\n$$\n\nNote that, for a given tuning range, $K_{V C O}$ increases as the supply voltage decreases, making the oscillator more sensitive to noise on the control line.\n\nTuning Linearity As exemplified by Eq. (15.60), VCO tuning characteristics exhibit nonlinearity, i.e., their gain, $K_{V C O}$, is not constant. As explained in Chapter 16, such nonlinearity degrades the settling behavior of phase-locked loops. Therefore, it is desirable to minimize the variation of $K_{V C O}$ across the tuning range.\n\nTypical oscillator characteristics show a high-gain region in the middle of the range and lower gain at the two extremes (Fig. 15.41). Compared to a linear characteristic (the gray line), the actual behavior displays a maximum gain greater than that predicted by (15.61), implying that, for a given tuning range, nonlinearity inevitably leads to higher sensitivity in some regions of the characteristic.\nimage_name:Figure 15.41 Nonlinear VCO characteristic\ndescription:The graph depicted is a characteristic curve of a Voltage-Controlled Oscillator (VCO), illustrating the nonlinear relationship between the output frequency (ω_out) and the control voltage (V_cont). The horizontal axis represents the control voltage (V_cont), while the vertical axis represents the output frequency (ω_out), both using linear scales.\n\nThe graph features a black curve representing the actual nonlinear characteristic of the VCO and a gray line indicating an ideal linear characteristic for comparison. The black curve exhibits a typical S-shaped nonlinear behavior.\n\n1. **Axes Labels and Units:**\n- **Horizontal Axis (V_cont):** Represents the control voltage.\n- **Vertical Axis (ω_out):** Represents the output frequency.\n\n2. **Overall Behavior and Trends:**\n- The curve starts at a lower frequency (ω1) when the control voltage is at V1.\n- As the control voltage increases towards V2, the output frequency rises, reaching an upper frequency limit (ω2).\n- The curve shows a high-gain region in the middle of the range, where the slope is steepest, indicating increased sensitivity to changes in control voltage.\n- At the extremes (near V1 and V2), the curve flattens, indicating lower sensitivity and gain.\n\n3. **Key Features and Technical Details:**\n- **High-Gain Region:** The middle portion of the curve has the highest gain, corresponding to the steepest slope.\n- **Low-Gain Regions:** The beginning and end of the curve have decreased slopes, indicating reduced sensitivity.\n- Compared to the gray linear line, the actual characteristic (black curve) has a higher peak gain, demonstrating nonlinearity.\n\n4. **Annotations and Specific Data Points:**\n- The graph includes dashed lines indicating the frequencies ω1 and ω2 and the control voltages V1 and V2, marking the range of operation.\n- The gray line serves as a reference for a linear response, highlighting the nonlinearity of the actual characteristic.\n\nThis graph effectively demonstrates the nonlinear behavior of a VCO, emphasizing the trade-offs between gain and control voltage across the tuning range.\n\nOutput Amplitude It is desirable to achieve a large output oscillation amplitude to make the waveform less susceptible to noise. The amplitude trades off with power dissipation, supply voltage, and (as explained in Sec. 15.4.2) even the tuning range. Additionally, the amplitude may vary across the tuning range, an undesirable effect.\n\nPower Dissipation Like other analog circuits, oscillators face trade-offs between speed, power dissipation, and noise. Typical oscillators consume 1 to 10 mW of power.\nSupply and Common-Mode Rejection Oscillators are highly sensitive to noise, especially in single-ended form. As seen in Example 15.9, even differential oscillators exhibit supply sensitivity. Designing oscillators for high noise immunity is a challenging task.\nOutput Signal Purity Even with a constant control voltage, the output waveform of a VCO is not perfectly periodic. The electronic noise of the devices in the oscillator and supply noise lead to noise in the output phase and frequency. These effects are quantified by \"jitter\" and \"phase noise\" and are determined by the requirements of each application."
},
{
    "text": "Most applications necessitate that oscillators be \"tunable,\" meaning their output frequency should depend on a control input, typically a voltage. An ideal voltage-controlled oscillator (VCO) is a circuit where the output frequency is a function of the control voltage.\n\nSec. 15.4 Voltage-Controlled Oscillators\nimage_name:Figure 15.40\ndescription:The system block diagram labeled \"Figure 15.40\" illustrates the functional representation of a Voltage-Controlled Oscillator (VCO). The diagram is divided into two main sections: a block diagram and a graph.\n\nKey Components:\n- **Voltage-Controlled Oscillator Block:** This central component receives an input control voltage \\( V_{cont} \\) and generates an output frequency \\( \\omega_{out} \\). The VCO's primary role is to convert the input voltage into a corresponding output frequency, ensuring the frequency is directly dependent on the control voltage.\n\nInformation and Control Flow:\n- **Input:** The control voltage \\( V_{cont} \\) is fed into the VCO, determining the oscillation frequency of the output.\n- **Output:** The VCO produces an output frequency \\( \\omega_{out} \\) as a function of the control voltage. The relationship between input and output is linear, as depicted in the accompanying graph.\n\nLabels, Annotations, and Key Indicators:\n- **Graph:** Below the VCO block, a graph shows the relationship between \\( V_{cont} \\) (x-axis) and \\( \\omega_{out} \\) (y-axis). The graph is a linear plot indicating that the output frequency increases linearly with an increase in control voltage.\n- **\\( \\omega_{0} \\):** This is the y-axis intercept, representing the output frequency when the control voltage is zero.\n- **\\( K_{VCO} \\):** This is the graph's line slope, representing the VCO's gain or sensitivity, measured in rad/s/V.\n- **\\( \\omega_{1} \\) and \\( \\omega_{2} \\):** These are specific frequency points on the y-axis, indicating the range of frequencies achievable by varying the control voltage from \\( V_{1} \\) to \\( V_{2} \\).\n\nOverall System Function:\nThe main function of this system is to provide a tunable frequency output that varies linearly with the input control voltage. The VCO is designed with a specific gain \\( K_{VCO} \\), allowing precise control of the output frequency over a defined tuning range. This makes it suitable for applications requiring adjustable frequency outputs based on varying voltage inputs.\nimage_name:Definition of a VCO.\ndescription:The graph in Figure 15.40 is a linear plot representing the relationship between the control voltage \\( V_{\\text{cont}} \\) and the output frequency \\( \\omega_{\\text{out}} \\) of a voltage-controlled oscillator (VCO). The graph is a two-dimensional Cartesian plot with the horizontal axis labeled as \\( V_{\\text{cont}} \\), representing the control voltage. The vertical axis is labeled \\( \\omega_{\\text{out}} \\), representing the output angular frequency.\n\nThe plot shows a linear relationship between \\( V_{\\text{cont}} \\) and \\( \\omega_{\\text{out}} \\), indicating that the output frequency increases linearly with an increase in control voltage. The line starts at \\( \\omega_{0} \\) when \\( V_{\\text{cont}} = 0 \\), which is the intercept on the \\( \\omega_{\\text{out}} \\) axis.\n\nThe slope of the line, \\( K_{\\text{VCO}} \\), represents the gain or sensitivity of the VCO, expressed in radians per second per volt (rad/s/V). This slope indicates how much the output frequency changes per unit change in control voltage.\n\nThe graph also highlights two specific points, \\( V_1 \\) and \\( V_2 \\), on the \\( V_{\\text{cont}} \\) axis, corresponding to \\( \\omega_1 \\) and \\( \\omega_2 \\) on the \\( \\omega_{\\text{out}} \\) axis, respectively. These points define the tuning range of the VCO, \\( \\omega_2 - \\omega_1 \\), which is the range over which the oscillator can vary its output frequency based on the control voltage. The dashed lines help illustrate these points and the linear relationship.\n\nFigure 15.40 Definition of a VCO.\nis a linear function of its control voltage (Fig. 15.40):\n\n$$\n\\begin{equation*}\n\\omega_{\\text {out }}=\\omega_{0}+K_{V C O} V_{\\text {cont }} \\tag{15.55}\n\\end{equation*}\n$$\n\nHere, $\\omega_{0}$ represents the intercept corresponding to $V_{c o n t}=0$ and $K_{V C O}$ denotes the \"gain\" or \"sensitivity\" of the circuit (expressed in rad/s/V). ${ }^{8}$ The achievable range, $\\omega_{2}-\\omega_{1}$, is termed the \"tuning range.\"\n\n#### Example 15.9\n\nIn the negative- $G_{m}$ oscillator of Fig. 15.27(c), assume $C_{P}=0$, consider only the drain junction capacitance, $C_{D B}$, of $M_{1}$ and $M_{2}$, and explain why $V_{D D}$ can be viewed as the control voltage. Calculate the gain of the VCO.\n\n#### Solution\n\nSince $C_{D B}$ varies with the drain-bulk voltage, if $V_{D D}$ changes, so does the resonance frequency of the tank. Noting that the average voltage across $C_{D B}$ is approximately equal to $V_{D D}$, we write\n\n$$\n\\begin{equation*}\nC_{D B}=\\frac{C_{D B 0}}{\\left(1+\\frac{V_{D D}}{\\phi_{B}}\\right)^{m}} \\tag{15.56}\n\\end{equation*}\n$$\n\nand\n\n$$\n\\begin{align*}\nK_{V C O} & =\\frac{\\partial \\omega_{\\text {out }}}{\\partial V_{D D}}  \\tag{15.57}\\\\\n& =\\frac{\\partial \\omega_{\\text {out }}}{\\partial C_{D B}} \\cdot \\frac{\\partial C_{D B}}{\\partial V_{D D}} \\tag{15.58}\n\\end{align*}\n$$\n\nWith $\\omega_{\\text {out }}=1 / \\sqrt{L_{P} C_{D B}}$, we have\n\n$$\n\\begin{align*}\nK_{V C O} & =\\frac{-1}{2 \\sqrt{L_{P} C_{D B} C_{D B}}} \\cdot \\frac{-m C_{D B}}{\\phi_{B}\\left(1+\\frac{V_{D D}}{\\phi_{B}}\\right)}  \\tag{15.59}\\\\\n& =\\frac{m}{2 \\phi_{B}\\left(1+\\frac{V_{D D}}{\\phi_{B}}\\right)} \\cdot \\omega_{\\text {out }} \\tag{15.60}\n\\end{align*}\n$$\n\nNote that the relationship between $\\omega_{\\text {out }}$ and $V_{\\text {cont }}$ is nonlinear because $K_{V C O}$ varies with $V_{D D}$ and $\\omega_{\\text {out }}$.\n\nBefore modifying the oscillators discussed in previous sections for tunability, we summarize the critical performance parameters of VCOs.\n\nCenter Frequency The center frequency (i.e., the midrange value in Fig. 15.40) is determined by the environment in which the VCO is used. For instance, in a microprocessor's clock generation network, the VCO may need to operate at the clock rate or even twice that. Today's CMOS VCOs can achieve center frequencies up to hundreds of gigahertz.\nTuning Range The required tuning range is influenced by two factors: (1) the variation of the VCO center frequency with process and temperature, and (2) the frequency range needed for the application. The center frequency of some CMOS oscillators may vary by a factor of two at the extremes of process and temperature, necessitating a sufficiently wide $(\\geq 2 \\times)$ tuning range to ensure the VCO output frequency can reach the desired value. Additionally, some applications require clock frequencies that vary by one to two orders of magnitude depending on the operation mode, demanding a correspondingly wide tuning range.\n\nA significant concern in VCO design is the disturbance of the output phase and frequency due to noise on the control line. For a given noise amplitude, the noise in the output frequency is proportional to $K_{V C O}$ because $\\omega_{\\text {out }}=\\omega_{0}+K_{V C O} V_{\\text {cont }}$. Thus, to minimize the impact of noise in $V_{\\text {cont }}$, the VCO gain must be minimized, a requirement that conflicts with the needed tuning range. In fact, if, as shown in Fig. 15.40, the allowable range of $V_{\\text {cont }}$ is from $V_{1}$ to $V_{2}$ (e.g., from 0 to $V_{D D}$ ) and the tuning range must span at least $\\omega_{1}$ to $\\omega_{2}$, then $K_{V C O}$ must meet the following condition:\n\n$$\n\\begin{equation*}\nK_{V C O} \\geq \\frac{\\omega_{2}-\\omega_{1}}{V_{2}-V_{1}} \\tag{15.61}\n\\end{equation*}\n$$\n\nNote that, for a given tuning range, $K_{V C O}$ increases as the supply voltage decreases, making the oscillator more sensitive to noise on the control line.\n\nTuning Linearity As exemplified by Eq. (15.60), the tuning characteristics of VCOs exhibit nonlinearity, i.e., their gain, $K_{V C O}$, is not constant. As explained in Chapter 16, such nonlinearity degrades the settling behavior of phase-locked loops. Therefore, it is desirable to minimize the variation of $K_{V C O}$ across the tuning range.\n\nActual oscillator characteristics typically show a high-gain region in the middle of the range and lower gain at the two extremes (Fig. 15.41). Compared to a linear characteristic (the gray line), the actual behavior displays a maximum gain greater than that predicted by (15.61), implying that, for a given tuning range, nonlinearity inevitably leads to higher sensitivity in some regions of the characteristic.\nimage_name:Figure 15.41 Nonlinear VCO characteristic\ndescription:The graph depicted is a characteristic curve of a Voltage-Controlled Oscillator (VCO), illustrating the nonlinear relationship between the output frequency (ω_out) and the control voltage (V_cont). The horizontal axis represents the control voltage (V_cont), while the vertical axis represents the output frequency (ω_out). Both axes use linear scales.\n\nIn this graph, a black curve represents the actual nonlinear characteristic of the VCO, and a gray line indicates an ideal linear characteristic for comparison. The black curve shows a typical S-shaped nonlinear behavior.\n\n1. **Axes Labels and Units:**\n- **Horizontal Axis (V_cont):** Represents the control voltage.\n- **Vertical Axis (ω_out):** Represents the output frequency.\n\n2. **Overall Behavior and Trends:**\n- The curve starts at a lower frequency (ω1) when the control voltage is at V1.\n- As the control voltage increases towards V2, the output frequency rises, reaching an upper frequency limit (ω2).\n- The curve exhibits a high-gain region in the middle of the range, where the slope is steepest, indicating increased sensitivity to changes in control voltage.\n- At the extremes (near V1 and V2), the curve flattens, indicating lower sensitivity and gain.\n\n3. **Key Features and Technical Details:**\n- **High-Gain Region:** The middle portion of the curve has the highest gain, corresponding to the steepest slope.\n- **Low-Gain Regions:** At the beginning and end of the curve, the slope decreases, indicating reduced sensitivity.\n- Compared to the gray linear line, the actual characteristic (black curve) has a higher peak gain, demonstrating nonlinearity.\n\n4. **Annotations and Specific Data Points:**\n- The graph is annotated with dashed lines indicating the frequencies ω1 and ω2 and the control voltages V1 and V2, marking the range of operation.\n- The gray line serves as a reference for a linear response, highlighting the nonlinearity of the actual characteristic.\n\nThis graph effectively demonstrates the nonlinear behavior of a VCO, emphasizing the trade-offs between gain and control voltage across the tuning range.\n\nOutput Amplitude It is desirable to achieve a large output oscillation amplitude, making the waveform less susceptible to noise. The amplitude trades off with power dissipation, supply voltage, and (as explained in Sec. 15.4.2) even the tuning range. Additionally, the amplitude may vary across the tuning range, an undesirable effect.\n\nPower Dissipation Like other analog circuits, oscillators face trade-offs between speed, power dissipation, and noise. Typical oscillators consume 1 to 10 mW of power.\nSupply and Common-Mode Rejection Oscillators are highly sensitive to noise, especially in single-ended configurations. As seen in Example 15.9, even differential oscillators show supply sensitivity. Designing oscillators for high noise immunity is a challenging task.\nOutput Signal Purity Even with a constant control voltage, the output waveform of a VCO is not perfectly periodic. Device electronic noise and supply noise introduce noise into the output phase and frequency. These effects are quantified by \"jitter\" and \"phase noise\" and are determined by the specific requirements of each application."
}
]