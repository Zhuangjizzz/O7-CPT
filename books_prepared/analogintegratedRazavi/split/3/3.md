# CHAPTER 3 Single-Stage Amplifiers

Amplification is an essential function in most analog (and many digital) circuits. We amplify an analog or digital signal because it may be too small to drive a load, overcome the noise of a subsequent stage, or provide logical levels to a digital circuit. Amplification also plays a critical role in feedback systems (Chapter 8).

In this chapter, we study the low-frequency behavior of single-stage CMOS amplifiers. Analyzing both the large-signal and the small-signal characteristics of each circuit, we develop intuitive techniques and models that prove useful in understanding more complex systems. An important part of a designer's job is to use proper approximations so as to create a simple mental picture of a complicated circuit. The intuition thus gained makes it possible to formulate the behavior of most circuits by inspection rather than by lengthy calculations.

Following a brief review of basic concepts, we describe in this chapter four types of amplifiers: common-source and common-gate topologies, source followers, and cascode configurations. In each case, we begin with a simple model and gradually add second-order phenomena such as channel-length modulation and body effect.

## 3.1 ■ Applications

Do you carry an amplifier? In all likelihood, yes. Your mobile phone, laptop, and digital camera all incorporate various types of amplifiers. The receiver in your phone must sense and amplify small signals received by the antenna, thus requiring a "low-noise" amplifier (LNA) at the front end (Fig. 3.1). As the signal travels down the receive chain, it must be further amplified by additional stages so as to reach an acceptably high level. This proves difficult because, in addition to the small desired signal, the antenna picks up other strong signals ("interferers") that are transmitted by various other users in the same vicinity. Your phone's transmitter, too, employs amplifiers: to amplify the signal generated by the microphone and, eventually, the signal delivered to the antenna. The "power amplifier" (PA) necessary for such delivery draws the most energy from the battery and still presents interesting challenges.

## 3.2 ■ General Considerations

An ideal amplifier generates an output, $y(t)$, that is a linear replica of the input, $x(t)$ :

$$
\begin{equation*}
y(t)=\alpha_{1} x(t) \tag{3.1}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-046.jpg?height=564&width=1049&top_left_y=243&top_left_x=510)

Figure 3.1 General RF transceiver.
where $\alpha_{1}$ denotes the gain. Since the output signal is in fact superimposed on a bias (dc operating) point, $\alpha_{0}$, we can write the overall output as $y(t)=\alpha_{0}+\alpha_{1} x(t)$. In this case, the input-output (large-signal) characteristic of the circuit is a straight line [Fig. 3.2(a)]. However, as the signal excursions become larger and the bias point of the transistor(s) is disturbed substantially, the gain (the slope of the characteristic) begins to vary [Fig. 3.2(b)]. We approximate this nonlinear characteristic by a polynomial:

$$
\begin{equation*}
y(t)=\alpha_{0}+\alpha_{1} x(t)+\alpha_{2} x^{2}(t)+\cdots+\alpha_{n} x^{n}(t) \tag{3.2}
\end{equation*}
$$

A nonlinear amplifier distorts the signal of interest or creates unwanted interactions among several signals that may coexist at the input. We return to the problem of nonlinearity in Chapter 14.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-046.jpg?height=334&width=895&top_left_y=1347&top_left_x=592)

Figure 3.2 Input-output characteristic of a (a) linear and (b) nonlinear system.
What aspects of the performance of an amplifier are important? In addition to gain and speed, such parameters as power dissipation, supply voltage, linearity, noise, or maximum voltage swings may be important. Furthermore, the input and output impedances determine how the circuit interacts with the preceding and subsequent stages. In practice, most of these parameters trade with each other, making the design a multidimensional optimization problem. Illustrated in the "analog design octagon" of Fig. 3.3, such trade-offs present many challenges in the design of high-performance amplifiers, requiring intuition and experience to arrive at an acceptable compromise.

Table 3.1 gives a preview of the amplifier topologies studied in this chapter, indicating the much wider use of the common-source (CS) stage than other circuit configurations. For these amplifiers, we must (1) set up proper bias conditions so that each transistor provides the necessary transconductance and output resistance with certain quiescent currents and voltages, and (2) analyze the circuit's behavior as the input and output signals cause small or large departures from the bias input (small-signal and large-signal analyses, respectively). We deal with the latter task here and defer the former to Chapter 5.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-047.jpg?height=485&width=662&top_left_y=242&top_left_x=363)

Figure 3.3 Analog design octagon.

Table 3.1 Amplifier categories.

| Common-Source Stage | Source Follower | Common-Gate Stage | Cascode |
| :---: | :---: | :---: | :---: |
| With Resistive Load | With Resistive Bias | With Resistive Load | Telescopic |
| With Diode-Connected Load | With Current-Source Bias | With Current-Source Load | Folded |
| With Current-Source Load |  |  |  |
| With Active Load |  |  |  |
| With Source Degeneration |  |  |  |

## 3.3 ■ Common-Source Stage

### 3.3.1 Common-Source Stage with Resistive Load

By virtue of its transconductance, a MOSFET converts changes in its gate-source voltage to a small-signal drain current, which can pass through a resistor to generate an output voltage. Shown in Fig. 3.4(a), the common-source stage performs such an operation. ${ }^{1}$ We study both the large-signal and the small-signal behavior of the circuit. Note that the input impedance of the circuit is very high at low frequencies.

If the input voltage increases from zero, $M_{1}$ is off and $V_{\text {out }}=V_{D D}$ [Fig. 3.4(b)]. As $V_{\text {in }}$ approaches $V_{T H}, M_{1}$ begins to turn on, drawing current from $R_{D}$ and lowering $V_{\text {out }}$. Transistor $M_{1}$ turns on in saturation regardless of the values of $V_{D D}$ and $R_{D}$ (why?), and we have

$$
\begin{equation*}
V_{\text {out }}=V_{D D}-R_{D} \frac{1}{2} \mu_{n} C_{o x} \frac{W}{L}\left(V_{\text {in }}-V_{T H}\right)^{2} \tag{3.3}
\end{equation*}
$$

where channel-length modulation is neglected. With further increase in $V_{i n}, V_{o u t}$ drops more, and the transistor continues to operate in saturation until $V_{\text {in }}$ exceeds $V_{\text {out }}$ by $V_{T H}$ [point $A$ in Fig. 3.4(b)]. At this point,

$$
\begin{equation*}
V_{i n 1}-V_{T H}=V_{D D}-R_{D} \frac{1}{2} \mu_{n} C_{o x} \frac{W}{L}\left(V_{i n 1}-V_{T H}\right)^{2} \tag{3.4}
\end{equation*}
$$

from which $V_{i n 1}-V_{T H}$ and hence $V_{\text {out }}$ can be calculated.
For $V_{i n}>V_{i n 1}, M_{1}$ is in the triode region:

$$
\begin{equation*}
V_{\text {out }}=V_{D D}-R_{D} \frac{1}{2} \mu_{n} C_{o x} \frac{W}{L}\left[2\left(V_{\text {in }}-V_{T H}\right) V_{\text {out }}-V_{\text {out }}^{2}\right] \tag{3.5}
\end{equation*}
$$

[^10]![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-048.jpg?height=298&width=283&top_left_y=312&top_left_x=509)
(a)
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-048.jpg?height=291&width=286&top_left_y=710&top_left_x=505)
(c)
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-048.jpg?height=370&width=531&top_left_y=245&top_left_x=1025)
(b)
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-048.jpg?height=246&width=585&top_left_y=712&top_left_x=983)
(d)

Figure 3.4 (a) Common-source stage, (b) input-output characteristic, (c) equivalent circuit in the deep triode region, and (d) small-signal model for the saturation region.

If $V_{\text {in }}$ is high enough to drive $M_{1}$ into the deep triode region, $V_{o u t} \ll 2\left(V_{i n}-V_{T H}\right)$, and, from the equivalent circuit of Fig. 3.4(c),

$$
\begin{align*}
V_{\text {out }} & =V_{D D} \frac{R_{\text {on }}}{R_{o n}+R_{D}}  \tag{3.6}\\
& =\frac{V_{D D}}{1+\mu_{n} C_{o x} \frac{W}{L} R_{D}\left(V_{i n}-V_{T H}\right)} \tag{3.7}
\end{align*}
$$

Since the transconductance drops in the triode region, we usually ensure that $V_{\text {out }}>V_{\text {in }}-V_{T H}$, and hence the current operates to the left of point $A$ in Fig. 3.4(b). Using (3.3) as the input-output characteristic and viewing its slope as the small-signal gain, we have

$$
\begin{align*}
A_{v} & =\frac{\partial V_{\text {out }}}{\partial V_{\text {in }}}  \tag{3.8}\\
& =-R_{D} \mu_{n} C_{o x} \frac{W}{L}\left(V_{i n}-V_{T H}\right)  \tag{3.9}\\
& =-g_{m} R_{D} \tag{3.10}
\end{align*}
$$

This result can be directly derived from the observation that $M_{1}$ converts an input voltage change $\Delta V_{\text {in }}$ to a drain current change $g_{m} \Delta V_{i n}$, and hence an output voltage change $-g_{m} R_{D} \Delta V_{i n}$. The small-signal model of Fig. 3.4(d) yields the same result: $V_{\text {out }}=-g_{m} V_{1} R_{D}=-g_{m} V_{i n} R_{D}$. Note that, as mentioned in Chapter $2, V_{\text {in }}, V_{1}$, and $V_{\text {out }}$ in this figure denote small-signal quantities.

Even though derived for small-signal operation, the equation $A_{v}=-g_{m} R_{D}$ predicts certain effects if the circuit senses a large signal swing. Since $g_{m}$ itself varies with the input signal according to
$g_{m}=\mu_{n} C_{o x}(W / L)\left(V_{G S}-V_{T H}\right)$, the gain of the circuit changes substantially if the signal is large. In other words, if the gain of the circuit varies significantly with the signal swing, then the circuit operates in the large-signal mode. The dependence of the gain upon the signal level leads to nonlinearity (Chapter 14), usually an undesirable effect.

A key result here is that to minimize the nonlinearity, the gain equation must be a weak function of signal-dependent parameters such as $g_{m}$. We present several examples of this concept in this chapter and in Chapter 14.

#### Example 3.1

Sketch the drain current and transconductance of $M_{1}$ in Fig. 3.4(a) as a function of the input voltage.

#### Solution

The drain current becomes significant for $V_{i n}>V_{T H}$, eventually approaching $V_{D D} / R_{D}$ if $R_{o n 1} \ll R_{D}$ [Fig. 3.5(a)]. Since in saturation, $g_{m}=\mu_{n} C_{o x}(W / L)\left(V_{i n}-\right.$ $V_{T H}$ ), the transconductance begins to rise for $V_{i n}>V_{T H}$. In the triode region, $g_{m}=\mu_{n} C_{o x}(W / L) V_{D S}$, falling as $V_{i n}$ exceeds $V_{i n 1}$ [Fig. 3.5(b)]. Starting with Eq. (3.5), the reader can show that

$$
\begin{equation*}
A_{v}=\frac{\partial V_{\text {out }}}{\partial V_{\text {in }}}=\frac{-\mu_{n} C_{o x}(W / L) R_{D} V_{\text {out }}}{1+\mu_{n} C_{o x}(W / L) R_{D}\left(V_{\text {in }}-V_{T H}-V_{\text {out }}\right)} \tag{3.11}
\end{equation*}
$$

which reaches a maximum if $V_{\text {out }}=V_{\text {in }}-V_{T H}($ point $A)$.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-049.jpg?height=309&width=414&top_left_y=1208&top_left_x=341)
(a)
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-049.jpg?height=309&width=426&top_left_y=1208&top_left_x=840)
(b)

#### Nanometer Design Notes

How does the CS stage behave in nanometer technologies? The figure plots the simulated input-output characteristic for $W / L=2 \mu \mathrm{~m} / 40 \mathrm{~nm}$, $R_{D}=2 \mathrm{k} \Omega$, and $V_{D D}=1 \mathrm{~V}$. We observe that the circuit provides a gain of about 3 in the input range of 0.4 V to 0.6 V . The output swing is limited to about $0.3 \mathrm{~V}-0.8$ V for the gain not to drop significantly.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-049.jpg?height=413&width=533&top_left_y=1161&top_left_x=1342)

Figure 3.5

#### Example 3.2

A CS stage is driven by a sinusoid, $V_{i n}=V_{1} \cos \omega_{1} t+V_{0}$, where $V_{0}$ is the bias value and $V_{1}$ is large enough to drive the transistor into the off and triode regions. Sketch the $g_{m}$ of the transistor as a function of time.

#### Solution

Let us first sketch the output voltage (Fig. 3.6), noting that when $V_{\text {in }}=V_{1}+V_{0}, V_{\text {out }}$ is low, $M_{1}$ is in the triode region, and $g_{m}$ assumes a small value. As $V_{\text {in }}$ falls and $V_{\text {out }}$ and $g_{m}$ rise, $M_{1}$ enters saturation at $t=t_{1}$ (when $V_{\text {in }}-V_{\text {out }}=$ $V_{T H}$ ) and $g_{m}$ reaches its maximum (why?). As $V_{i n}$ falls further, so do $I_{D}$ and $g_{m}$. At $t=t_{2}, g_{m}$ reaches zero.

We observe that (a) since the voltage gain is approximately equal to $-g_{m} R_{D}$, it experiences the same variation as the $g_{m}$, and (b) $g_{m}$ varies periodically. ${ }^{2}$

[^11]![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-050.jpg?height=659&width=844&top_left_y=242&top_left_x=615)

Figure 3.6

How do we maximize the voltage gain of a common-source stage? Writing (3.10) as

$$
\begin{equation*}
A_{v}=-\sqrt{2 \mu_{n} C_{o x} \frac{W}{L} I_{D}} \frac{V_{R D}}{I_{D}} \tag{3.12}
\end{equation*}
$$

where $V_{R D}$ denotes the voltage drop across $R_{D}$, we have

$$
\begin{equation*}
A_{v}=-\sqrt{2 \mu_{n} C_{o x} \frac{W}{L}} \frac{V_{R D}}{\sqrt{I_{D}}} \tag{3.13}
\end{equation*}
$$

Thus, the magnitude of $A_{v}$ can be increased by increasing $W / L$ or $V_{R D}$ or decreasing $I_{D}$ if other parameters are constant. It is important to understand the trade-offs resulting from this equation. A larger device size leads to greater device capacitances, and a higher $V_{R D}$ limits the maximum voltage swings. For example, if $V_{D D}-V_{R D}=V_{i n}-V_{T H}$, then $M_{1}$ is at the edge of the triode region, allowing only very small swings at the output (and input). If $V_{R D}$ remains constant and $I_{D}$ is reduced, then $R_{D}$ must increase, thereby leading to a greater time constant at the output node. In other words, as noted in the analog design octagon, the circuit exhibits trade-offs between gain, bandwidth, and voltage swings. Lower supply voltages further tighten these trade-offs.

For large values of $R_{D}$, the effect of channel-length modulation in $M_{1}$ becomes significant. Modifying (3.3) to include this effect,

$$
\begin{equation*}
V_{\text {out }}=V_{D D}-R_{D} \frac{1}{2} \mu_{n} C_{o x} \frac{W}{L}\left(V_{\text {in }}-V_{T H}\right)^{2}\left(1+\lambda V_{\text {out }}\right) \tag{3.14}
\end{equation*}
$$

we have

$$
\begin{align*}
\frac{\partial V_{\text {out }}}{\partial V_{\text {in }}}= & -R_{D} \mu_{n} C_{\text {ox }} \frac{W}{L}\left(V_{\text {in }}-V_{T H}\right)\left(1+\lambda V_{\text {out }}\right) \\
& -R_{D} \frac{1}{2} \mu_{n} C_{\text {ox }} \frac{W}{L}\left(V_{\text {in }}-V_{T H}\right)^{2} \lambda \frac{\partial V_{\text {out }}}{\partial V_{\text {in }}} \tag{3.15}
\end{align*}
$$

We recognize that $(1 / 2) \mu_{n} C_{o x}(W / L)\left(V_{i n}-V_{T H}\right)^{2} \lambda=1 / r_{O}$ and

$$
\begin{equation*}
A_{v}=-R_{D} g_{m}-\frac{R_{D}}{r_{O}} A_{v} \tag{3.16}
\end{equation*}
$$

Thus,

$$
\begin{equation*}
A_{v}=-g_{m} \frac{r_{O} R_{D}}{r_{O}+R_{D}} \tag{3.17}
\end{equation*}
$$

The small-signal model of Fig. 3.7 gives the same result with much less effort. That is, since $g_{m} V_{1}\left(r_{O} \| R_{D}\right)=-V_{\text {out }}$ and $V_{1}=V_{\text {in }}$, we have $V_{\text {out }} / V_{\text {in }}=-g_{m}\left(r_{O} \| R_{D}\right)$.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-051.jpg?height=240&width=670&top_left_y=720&top_left_x=367)

Figure 3.7 Small-signal model of CS stage including the transistor output resistance.

#### Example 3.3

Assuming that $M_{1}$ in Fig. 3.8 is biased in saturation, calculate the small-signal voltage gain of the circuit.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-051.jpg?height=306&width=288&top_left_y=1174&top_left_x=553)

Figure 3.8

#### Solution

Since $I_{1}$ introduces an infinite impedance $\left(R_{D}=\infty\right)$, the gain is limited by the output resistance of $M_{1}$ :

$$
\begin{equation*}
A_{v}=-g_{m} r_{O} \tag{3.18}
\end{equation*}
$$

Called the "intrinsic gain" of a transistor, this quantity represents the maximum voltage gain that can be achieved using a single device. In today's CMOS technology, $g_{m} r_{O}$ of short-channel devices is between roughly 5 and 10. We usually assume $1 / g_{m} \ll r_{O}$.

In Fig. 3.8, Kirchhoff's current law (KCL) requires that $I_{D 1}=I_{1}$. Then, how can $V_{i n}$ change the current of $M_{1}$ if $I_{1}$ is constant? Writing the total drain current of $M_{1}$ as

$$
\begin{align*}
I_{D 1} & =\frac{1}{2} \mu_{n} C_{o x} \frac{W}{L}\left(V_{\text {in }}-V_{T H}\right)^{2}\left(1+\lambda V_{o u t}\right)  \tag{3.19}\\
& =I_{1} \tag{3.20}
\end{align*}
$$

we note that $V_{\text {in }}$ appears in the square term and $V_{\text {out }}$ in the linear term. As $V_{\text {in }}$ increases, $V_{\text {out }}$ must decrease such that the product remains constant. We may nevertheless say " $I_{D 1}$ increases as $V_{i n}$ increases." This statement simply refers to the quadratic part of the equation.

An important conclusion here is that, to maximize the voltage gain, we must maximize the (smallsignal) load impedance. Why can we not replace the load with an open circuit? This is because the circuit still needs a path from $V_{D D}$ to ground for the bias current of $M_{1}$.

#### Example 3.4

It is possible to use the bulk (back gate) of a MOSFET as the terminal controlling the channel. Shown in Fig. 3.9 is an example. Determine the voltage gain if $\lambda=0$.

#### Nanometer Design Notes

How do we design a CS stage for a given gain and supply voltage? With $W / L, I_{D}$, and $R_{D}$ under our control, we seem to have a wide design space. A good starting point is to choose a small device, $W / L=0.5 \mu \mathrm{~m} / 40 \mathrm{~nm}$, a low bias current, $I_{D}=50 \mu \mathrm{~A}$, and a sufficiently large load resistance to achieve the required gain. To this end, we use simulations to plot the transconductance of such a device as a function of $I_{D}$, obtaining $g_{m}=0.45 \mathrm{mS}$. Thus, for a voltage gain of, say, $10, R_{D}$ must reach $22.2 \mathrm{k} \Omega$ if $\lambda=0$. Is this an acceptable design? The answer depends on the application. In addition to gain, the circuit must also satisfy certain bandwidth, noise, and output swing requirements.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-052.jpg?height=370&width=474&top_left_y=1452&top_left_x=160)
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-052.jpg?height=270&width=267&top_left_y=592&top_left_x=881)

Figure 3.9

#### Solution

From the small-signal MOS model developed in Chapter 2, we recall that the drain current is given by $g_{m b} V_{i n}$. Thus, $A_{v}=-g_{m b} R_{D}$.

### 3.3.2 CS Stage with Diode-Connected Load

In some CMOS technologies, it is difficult to fabricate resistors with tightlycontrolled values or a reasonable physical size (Chapter 19). Consequently, it is desirable to replace $R_{D}$ in Fig. 3.4(a) with a MOS transistor.

A MOSFET can operate as a small-signal resistor if its gate and drain are shorted [Fig. 3.10(a)]. Called a "diode-connected" device in analogy with its bipolar counterpart, this configuration exhibits small-signal behavior similar to that of two-terminal resistor. Note that the transistor is always in saturation because the drain and the gate have the same potential. Using the small-signal equivalent shown in Fig. 3.10(b) to obtain the impedance of the device, we write $V_{1}=V_{X}$ and $I_{X}=V_{X} / r_{O}+g_{m} V_{X}$. That is, the impedance of the diode is simply equal to $V_{X} / I_{X}=\left(1 / g_{m}\right) \| r_{O} \approx 1 / g_{m}$. If body effect exists, we can use the circuit in Fig. 3.11 to write $V_{1}=-V_{X}, V_{b s}=-V_{X}$, and

$$
\begin{equation*}
\left(g_{m}+g_{m b}\right) V_{X}+\frac{V_{X}}{r_{O}}=I_{X} \tag{3.21}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-052.jpg?height=332&width=982&top_left_y=1919&top_left_x=513)

Figure 3.10 (a) Diode-connected NMOS and PMOS devices; (b) small-signal equivalent circuit.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-053.jpg?height=434&width=1000&top_left_y=218&top_left_x=463)

Figure 3.11 (a) Arrangement for measuring the equivalent resistance of a diode-connected MOSFET; (b) small-signal equivalent circuit.

It follows that

$$
\begin{align*}
\frac{V_{X}}{I_{X}} & =\frac{1}{g_{m}+g_{m b}+r_{O}^{-1}}  \tag{3.22}\\
& =\frac{1}{g_{m}+g_{m b}} \| r_{O}  \tag{3.23}\\
& \approx \frac{1}{g_{m}+g_{m b}} \tag{3.24}
\end{align*}
$$

In the general case, $V_{X} / I_{X}=\left(1 / g_{m}\right)\left\|r_{O}\right\|\left(1 / g_{m b}\right)$. Interestingly, the impedance seen at the source of $M_{1}$ is lower when body effect is included. Intuitive explanation of this effect is left as an exercise for the reader.

From a large-signal point of view, a diode-connected device acts as a "square-root" operator if its current is considered the input and its $V_{G S}$ or $V_{G S}-V_{T H}$ the output (why?). We return to this point later.

#### Example 3.5

Consider the circuit shown in Fig. 3.12(a). In some cases, we are interested in the impedance seen looking into the source, $R_{X}$. Determine $R_{X}$ if $\lambda=0$.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-053.jpg?height=303&width=288&top_left_y=1577&top_left_x=450)
(a)
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-053.jpg?height=327&width=620&top_left_y=1578&top_left_x=858)
(b)

Figure 3.12 Impedance seen at the source with $\lambda=0$.

#### Solution

To determine $R_{X}$, we set all independent sources to zero, draw the small-signal model, and apply a voltage source as shown in Fig. 3.12(b). Since $V_{1}=-V_{X}$ and $V_{b s}=-V_{X}$, we have

$$
\begin{equation*}
\left(g_{m}+g_{m b}\right) V_{X}=I_{X} \tag{3.25}
\end{equation*}
$$

and

$$
\begin{equation*}
\frac{V_{X}}{I_{X}}=\frac{1}{g_{m}+g_{m b}} \tag{3.26}
\end{equation*}
$$

This result should not be surprising: the topologies in Fig. 3.12(a) and Fig. 3.11(a) are similar except that the drain of $M_{1}$ in Fig. 3.12(b) is not at ac ground. This difference does not manifest itself if $\lambda=0$. We sometimes say, "looking into the source of a MOSFET, we see $1 / g_{m}$," assuming implicitly that $\lambda=\gamma=0$.

We now study a common-source stage with a diode-connected load (Fig. 3.13). With negligible channel-length modulation, (3.24) can be substituted in (3.10) for the load impedance, yielding

$$
\begin{align*}
A_{v} & =-g_{m 1} \frac{1}{g_{m 2}+g_{m b 2}}  \tag{3.27}\\
& =-\frac{g_{m 1}}{g_{m 2}} \frac{1}{1+\eta} \tag{3.28}
\end{align*}
$$

where $\eta=g_{m b 2} / g_{m 2}$. Expressing $g_{m 1}$ and $g_{m 2}$ in terms of device dimensions and bias currents, we have

$$
\begin{equation*}
A_{v}=-\frac{\sqrt{2 \mu_{n} C_{o x}(W / L)_{1} I_{D 1}}}{\sqrt{2 \mu_{n} C_{o x}(W / L)_{2} I_{D 2}}} \frac{1}{1+\eta} \tag{3.29}
\end{equation*}
$$

and, since $I_{D 1}=I_{D 2}$,

$$
\begin{equation*}
A_{v}=-\sqrt{\frac{(W / L)_{1}}{(W / L)_{2}}} \frac{1}{1+\eta} \tag{3.30}
\end{equation*}
$$

This equation reveals an interesting property: if the variation of $\eta$ with the output voltage is neglected, the gain is independent of the bias currents and voltages (so long as $M_{1}$ stays in saturation). In other words, as the input and output signal levels vary, the gain remains relatively constant, indicating that the input-output characteristic is relatively linear.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-054.jpg?height=350&width=288&top_left_y=1513&top_left_x=624)

Figure 3.13 CS stage with diode-connected load.

The linear behavior of the circuit can also be confirmed by large-signal analysis. Neglecting channellength modulation for simplicity, we have in Fig. 3.13

$$
\begin{equation*}
\frac{1}{2} \mu_{n} C_{o x}\left(\frac{W}{L}\right)_{1}\left(V_{i n}-V_{T H 1}\right)^{2}=\frac{1}{2} \mu_{n} C_{o x}\left(\frac{W}{L}\right)_{2}\left(V_{D D}-V_{o u t}-V_{T H 2}\right)^{2} \tag{3.31}
\end{equation*}
$$

and hence

$$
\begin{equation*}
\sqrt{\left(\frac{W}{L}\right)_{1}}\left(V_{i n}-V_{T H 1}\right)=\sqrt{\left(\frac{W}{L}\right)_{2}}\left(V_{D D}-V_{\text {out }}-V_{T H 2}\right) \tag{3.32}
\end{equation*}
$$

Thus, if the variation of $V_{T H 2}$ with $V_{\text {out }}$ is small, the circuit exhibits a linear input-output characteristic. In essence, the squaring function performed by $M_{1}$ (from the input voltage to its drain current) and the square root function performed by $M_{2}$ (from its drain current to its overdrive) act as $f^{-1}(f(x))=x$.

The small-signal gain can also be computed by differentiating both sides with respect to $V_{i n}$ :

$$
\begin{equation*}
\sqrt{\left(\frac{W}{L}\right)_{1}}=\sqrt{\left(\frac{W}{L}\right)_{2}}\left(-\frac{\partial V_{\text {out }}}{\partial V_{\text {in }}}-\frac{\partial V_{T H 2}}{\partial V_{i n}}\right) \tag{3.33}
\end{equation*}
$$

which, upon application of the chain rule $\partial V_{T H 2} / \partial V_{\text {in }}=\left(\partial V_{T H 2} / \partial V_{\text {out }}\right)\left(\partial V_{\text {out }} / \partial V_{\text {in }}\right)=\eta\left(\partial V_{\text {out }} / \partial V_{\text {in }}\right)$, reduces to

$$
\begin{equation*}
\frac{\partial V_{\text {out }}}{\partial V_{\text {in }}}=-\sqrt{\frac{(W / L)_{1}}{(W / L)_{2}}} \frac{1}{1+\eta} \tag{3.34}
\end{equation*}
$$

It is instructive to study the overall large-signal characteristic of the circuit as well. But let us first consider the circuit shown in Fig. 3.14(a). What is the final value of $V_{\text {out }}$ if $I_{1}$ drops to zero? As $I_{1}$ decreases, so does the overdrive of $M_{2}$. Thus, for small $I_{1}, V_{G S 2} \approx V_{T H 2}$ and $V_{\text {out }} \approx V_{D D}-V_{T H 2}$. In reality, the subthreshold conduction in $M_{2}$ eventually brings $V_{\text {out }}$ to $V_{D D}$ if $I_{D}$ approaches zero, but at very low current levels, the finite capacitance at the output node slows down the change from $V_{D D}-V_{T H 2}$ to $V_{D D}$. This is illustrated in the time-domain waveforms of Fig. 3.14(b). For this reason, in circuits that have frequent switching activity, we assume that $V_{\text {out }}$ remains around $V_{D D}-V_{T H 2}$ when $I_{1}$ falls to small values.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-055.jpg?height=334&width=352&top_left_y=1285&top_left_x=510)
(a)
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-055.jpg?height=408&width=474&top_left_y=1230&top_left_x=936)
(b)

Figure 3.14 (a) Diode-connected device with stepped bias current; (b) variation of source voltage versus time.
Now we return to the circuit of Fig. 3.13. Plotted in Fig. 3.15 versus $V_{i n}$, the output voltage equals $V_{D D}-V_{T H 2}$ if $V_{i n}<V_{T H 1}$. For $V_{i n}>V_{T H 1}$, Eq. (3.32) holds and $V_{\text {out }}$ follows an approximately straight line. As $V_{\text {in }}$ exceeds $V_{\text {out }}+V_{T H 1}$ (beyond point $A$ ), $M_{1}$ enters the triode region, and the characteristic becomes nonlinear.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-055.jpg?height=293&width=521&top_left_y=1984&top_left_x=436)

Figure 3.15 Input-output characteristic of a CS stage with diode-connected load.

The diode-connected load of Fig. 3.13 can be implemented with a PMOS device as well. Shown in Fig. 3.16, the circuit is free from body effect, providing a small-signal voltage gain equal to

$$
\begin{equation*}
A_{v}=-\sqrt{\frac{\mu_{n}(W / L)_{1}}{\mu_{p}(W / L)_{2}}} \tag{3.35}
\end{equation*}
$$

where channel-length modulation is neglected.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-056.jpg?height=347&width=291&top_left_y=574&top_left_x=623)

Figure 3.16 CS stage with diodeconnected PMOS device.

Equations (3.30) and (3.35) indicate that the gain of a common-source stage with diode-connected load is a relatively weak function of the device dimensions. For example, to achieve a gain of 5 , $\mu_{n}(W / L)_{1} /\left[\mu_{p}(W / L)_{2}\right]=25$, implying that, with $\mu_{n} \approx 2 \mu_{p}$, we must have $(W / L)_{1} \approx 12.5(W / L)_{2}$. In a sense, a high gain requires a "strong" input device and a "weak" load device. In addition to disproportionately wide or long transistors (and hence a large input or load capacitance), a high gain translates to another important limitation: reduction in allowable voltage swings. Specifically, since in Fig. 3.16, $I_{D 1}=\left|I_{D 2}\right|$,

$$
\begin{equation*}
\mu_{n}\left(\frac{W}{L}\right)_{1}\left(V_{G S 1}-V_{T H 1}\right)^{2}=\mu_{p}\left(\frac{W}{L}\right)_{2}\left(V_{G S 2}-V_{T H 2}\right)^{2} \tag{3.36}
\end{equation*}
$$

if $\lambda=0$, revealing that

#### Nanometer Design Notes

Let us design and simulate a CS stage with a diode-connected PMOS load in $40-\mathrm{nm}$ technology. We select $W / L=$ $5 \mu \mathrm{~m} / 40 \mathrm{~nm}$ for the NMOS device and $1 \mu \mathrm{~m} / 40 \mathrm{~nm}$ for the PMOS device. The large-signal I-V characteristic is shown in the figure. We observe that the circuit provides a small-signal gain of about 1.5 for an input range of roughly 0.4 V to 0.5 V . (In this dc sweep, $V_{\text {out }}$ can reach $V_{D D}$ when the input transistor is off.)
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-056.jpg?height=339&width=446&top_left_y=1920&top_left_x=169)

$$
\begin{equation*}
\frac{\left|V_{G S 2}-V_{T H 2}\right|}{V_{G S 1}-V_{T H 1}}=A_{v} \tag{3.37}
\end{equation*}
$$

In the above example, the overdrive voltage of $M_{2}$ must be 5 times that of $M_{1}$. For example, with $V_{G S 1}-V_{T H 1}=100 \mathrm{mV}$ and $\left|V_{T H 2}\right|=0.3 \mathrm{~V}$, we have $\left|V_{G S 2}\right|=0.8 \mathrm{~V}$, severely limiting the output swing. This is another example of the trade-offs suggested by the analog design octagon. Note that, with diode-connected loads, the swing is constrained by both the required overdrive voltage and the threshold voltage. That is, even with a small overdrive, the output level cannot exceed $V_{D D}-\left|V_{T H}\right|$.

An interesting paradox arises here if we write $g_{m}=\mu C_{o x}(W / L)$ $V_{G S}-V_{T H} \mid$. The voltage gain of the circuit is then given by

$$
\begin{align*}
\left|A_{v}\right| & =\frac{g_{m 1}}{g_{m 2}}  \tag{3.38}\\
& =\frac{\mu_{n} C_{o x}(W / L)_{1}\left(V_{G S 1}-V_{T H 1}\right)}{\mu_{p} C_{o x}(W / L)_{2}\left|V_{G S 2}-V_{T H 2}\right|} \tag{3.39}
\end{align*}
$$

Equation (3.39) implies that $A_{v}$ is inversely proportional to $\left|V_{G S 2}-V_{T H 2}\right|$. It is left for the reader to resolve the seemingly opposite trends suggested by (3.37) and (3.39).

#### Example 3.6

In the circuit of Fig. 3.17, $M_{1}$ is biased in saturation with a drain current equal to $I_{1}$. The current source $I_{S}=0.75 I_{1}$ is added to the circuit. How is (3.37) modified for this case? Assume $\lambda=0$.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-057.jpg?height=332&width=337&top_left_y=423&top_left_x=528)

Figure 3.17

#### Solution

Since $\left|I_{D 2}\right|=I_{1} / 4$, we have

$$
\begin{align*}
A_{v} & =-\frac{g_{m 1}}{g_{m 2}}  \tag{3.40}\\
& =-\sqrt{\frac{4 \mu_{n}(W / L)_{1}}{\mu_{p}(W / L)_{2}}} \tag{3.41}
\end{align*}
$$

Moreover,

$$
\begin{equation*}
\mu_{n}\left(\frac{W}{L}\right)_{1}\left(V_{G S 1}-V_{T H 1}\right)^{2}=4 \mu_{p}\left(\frac{W}{L}\right)_{2}\left(V_{G S 2}-V_{T H 2}\right)^{2} \tag{3.42}
\end{equation*}
$$

yielding

$$
\begin{equation*}
\frac{\left|V_{G S 2}-V_{T H 2}\right|}{V_{G S 1}-V_{T H 1}}=\frac{A_{v}}{4} \tag{3.43}
\end{equation*}
$$

Thus, for a gain of 5, the overdrive of $M_{2}$ need be only 1.25 times that of $M_{1}$. Alternatively, for a given overdrive voltage, this circuit achieves a gain four times that of the stage in Fig. 3.16. Intuitively, this is because for a given $\left|V_{G S 2}-V_{T H 2}\right|$, if the current decreases by a factor of 4 , then $(W / L)_{2}$ must decrease proportionally, and $g_{m 2}=\sqrt{2 \mu_{p} C_{o x}(W / L)_{2} I_{D 2}}$ is lowered by the same factor.

#### Example 3.7

A student attempts to calculate the voltage gain in the previous example by differentiating both sides of (3.42). Does this approach give a correct result? Why?

#### Solution

Since $V_{G S 2}=V_{\text {out }}-V_{D D}$, differentiation and multiplication by $C_{o x}$ yield

$$
\begin{equation*}
\mu_{n} C_{o x}\left(\frac{W}{L}\right)_{1}\left(V_{\text {in }}-V_{T H 1}\right)^{2}=4 \mu_{p} C_{o x}\left(\frac{W}{L}\right)_{2}\left(V_{\text {out }}-V_{D D}-V_{T H 2}\right) \frac{\partial V_{\text {out }}}{\partial V_{\text {in }}} \tag{3.44}
\end{equation*}
$$

It follows that $\partial V_{\text {out }} / \partial V_{\text {in }}=-g_{m 1} /\left(4 g_{m 2}\right)$. This incorrect result arises because (3.42) is valid for only one value of $V_{i n}$. As $V_{i n}$ is perturbed by the signal, $I_{1}$ departs from $4\left|I_{D 2}\right|$ and (3.42) cannot be differentiated.

In today's CMOS technology, channel-length modulation is quite significant and, more important, the behavior of transistors notably departs from the square law. Thus, the gain of the stage in Fig. 3.13 must be expressed as

$$
\begin{equation*}
A_{v}=-g_{m 1}\left(\frac{1}{g_{m 2}}\left\|r_{O 1}\right\| r_{O 2}\right) \tag{3.45}
\end{equation*}
$$

where $g_{m 1}$ and $g_{m 2}$ must be obtained as described in Chapter 17 .

### 3.3.3 CS Stage with Current-Source Load

In applications requiring a large voltage gain in a single stage, the relationship $A_{v}=-g_{m} R_{D}$ suggests that we should increase the load impedance of the CS stage. With a resistor or diode-connected load, however, increasing the load resistance translates to a large dc drop across the load, thereby limiting the output voltage swing.

A more practical approach is to replace the load with a device that does not obey Ohm's law, e.g., a current source. Described briefly in Example 3.3, the resulting circuit is shown in Fig. 3.18, where both transistors operate in saturation. Since the total impedance seen at the output node is equal to $r_{O 1} \| r_{O 2}$, the gain is given by is

$$
\begin{equation*}
A_{v}=-g_{m 1}\left(r_{O 1} \| r_{O 2}\right) \tag{3.46}
\end{equation*}
$$

The key point here is that the output impedance and the minimum required $\left|V_{D S}\right|$ of $M_{2}$ are less strongly coupled than the value and voltage drop of a resistor; the former need not satisfy Ohm's law, but the latter must. The voltage $\left|V_{D S 2, \text { min }}\right|=\left|V_{G S 2}-V_{T H 2}\right|$ can be reduced to less than a hundred millivolts by simply increasing the width of $M_{2}$. If $r_{O 2}$ is not sufficiently high, the length and width of $M_{2}$ can be increased to achieve a smaller $\lambda$ while maintaining the same overdrive voltage. The penalty is the larger capacitance introduced by $M_{2}$ at the output node.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-058.jpg?height=373&width=1192&top_left_y=1386&top_left_x=439)

Figure 3.18 CS stage with current-source load.
We should remark that the output bias voltage of the circuit in Fig. 3.18 is not well-defined. Thus, the stage is reliably biased only if a feedback loop forces $V_{\text {out }}$ to a known value (Chapter 8). The large-signal analysis of the circuit is left as an exercise for the reader.

As explained in Chapter 2, the output impedance of MOSFETs at a given drain current can be scaled by changing the channel length, i.e., to the first order, $\lambda \propto 1 / L$, and hence $r_{O} \propto L / I_{D}$. Since the gain of the stage shown in Fig. 3.18 is proportional to $r_{O 1} \| r_{O 2}$, we may surmise that longer transistors yield a higher voltage gain.

Let us consider $M_{1}$ and $M_{2}$ separately. If $L_{1}$ is scaled up by a factor of $\alpha(>1)$, then $W_{1}$ may need to be scaled proportionally as well. This is because, for a given drain current, $V_{G S 1}-V_{T H 1} \propto 1 / \sqrt{(W / L)_{1}}$, i.e., if $W_{1}$ is not scaled, the overdrive voltage increases, limiting the output voltage swing. Also, since $g_{m 1} \propto \sqrt{(W / L)_{1}}$, scaling up only $L_{1}$ lowers $g_{m 1}$.

In applications where these issues are unimportant, $W_{1}$ can remain constant while $L_{1}$ increases. Thus, the intrinsic gain of $M_{1}$ can be written as

$$
\begin{equation*}
g_{m 1} r_{O 1}=\sqrt{2\left(\frac{W}{L}\right)_{1} \mu_{n} C_{o x} I_{D}} \frac{1}{\lambda I_{D}} \tag{3.47}
\end{equation*}
$$

indicating that the gain increases with $L$ because $\lambda$ depends more strongly on $L$ than $g_{m}$ does. Also, note that $g_{m} r_{O}$ decreases as $I_{D}$ increases.

Increasing $L_{2}$ while keeping $W_{2}$ constant increases $r_{O 2}$ and hence the voltage gain, but at the cost of a higher $\left|V_{D S 2, \min }\right|$, which is required to maintain $M_{2}$ in saturation.

#### Example 3.8

Compare the maximum output voltage swings of CS stages with resistive and current-source loads.

#### Solution

For the resistively-loaded stage [Fig. 3.19(a)], the maximum output voltage is near $V_{D D}$ (when $V_{i n}$ falls to about $\left.V_{T H 1}\right)$. The minimum is the value that places $M_{1}$ at the edge of the triode region, $V_{i n}-V_{T H 1}$.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-059.jpg?height=375&width=1450&top_left_y=939&top_left_x=243)

Figure 3.19 Output swing in CS stage with (a) resistive load and (b) current-source load.
For the stage with a current-source load [Fig. 3.19(b)], the maximum output voltage is that which places $M_{2}$ at the edge of the triode region, $V_{D D}-\left|V_{G S 2}-V_{T H 2}\right|$. Thus, the latter actually provides smaller swings than the former, but can always achieve a higher gain if $L_{1}$ and $L_{2}$ are increased.

### 3.3.4 CS Stage with Active Load

In the amplifier topology of Fig. 3.19(b), the PMOS device serves as a constant current source. Is it possible for $M_{2}$ to operate as an amplifying device? Yes; we can apply the input signal to the gate of $M_{2}$ as well [Fig. 3.20(a)], converting it to an "active" load. The reader may recognize this topology as a CMOS inverter. Suppose both transistors are in saturation and $V_{i n}$ rises by $\Delta V_{0}$. Two changes now occur: (a) $I_{D 1}$ increases, pulling $V_{\text {out }}$ lower, and (b) $M_{2}$ injects less current into the output node, allowing $V_{\text {out }}$ to drop. The two changes thus enhance each other, leading to a greater voltage gain. Equivalently, as seen in Fig. 3.20(b), the two transistors operate in parallel and collapse into one as illustrated in Fig. 3.20(c). It follows that $-\left(g_{m 1}+g_{m 2}\right) V_{i n}\left(r_{O 1} \| r_{O 2}\right)=V_{\text {out }}$, and hence

$$
\begin{equation*}
A_{v}=-\left(g_{m 1}+g_{m 2}\right)\left(r_{O 1} \| r_{O 2}\right) \tag{3.48}
\end{equation*}
$$

Compared to the amplifier of Fig. 3.19(b), this circuit exhibits the same output resistance, $r_{O 1} \| r_{O 2}$, but a higher transconductance. This topology is also called a "complementary CS stage."

The amplifier of Fig. 3.20(a) must deal with two critical issues. First, the bias current of the two transistors is a strong function of PVT. In particular, since $V_{G S 1}+\left|V_{G S 2}\right|=V_{D D}$, variations in $V_{D D}$ or the threshold voltages directly translate to changes in the drain currents. Second, the circuit amplifies
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-060.jpg?height=393&width=1492&top_left_y=218&top_left_x=281)

Figure 3.20 (a) CS stage with active load, (b) small-signal model, and (c) simplified model.
supply voltage variations ("supply noise")! To understand this point, consider the arrangement depicted in Fig. 3.21, where $V_{B}$ is a bias voltage to place $M_{1}$ and $M_{2}$ in saturation. In Problem 3.31, we prove that the small-signal gain from $V_{D D}$ to $V_{\text {out }}$ is given by

#### Nanometer Design Notes

With minimum channel lengths, the CS stage with current-source load provides a low gain. For example, if $(W / L)$ NMOS $=5 \mu \mathrm{~m} / 40 \mathrm{~nm}$ and $(W / L)$ PMOS $=10 \mu \mathrm{~m} / 40 \mathrm{~nm}$, we obtain the input-output characteristic shown in the figure, where the maximum gain is about 2.5 ! If we plot the slope, we also see the useful output voltage range to be about 0.7 V with $V_{D D}=1 \mathrm{~V}$. Outside this range, the gain drops considerably.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-060.jpg?height=342&width=444&top_left_y=1545&top_left_x=172)
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-060.jpg?height=349&width=455&top_left_y=1910&top_left_x=167)

$$
\begin{align*}
\frac{V_{\text {out }}}{V_{D D}} & =\frac{g_{m 2} r_{O 2}+1}{r_{O 2}+r_{O 1}} r_{O 1}  \tag{3.49}\\
& =\left(g_{m 2}+\frac{1}{r_{O 2}}\right)\left(r_{O 1} \| r_{O 2}\right) \tag{3.50}
\end{align*}
$$

about half of the $A_{v}$ found above. These issues are addressed in Chapter 5.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-060.jpg?height=354&width=439&top_left_y=1165&top_left_x=754)

Figure 3.21 Arrangement for studying supply sensitivity of CS stage with active load.

### 3.3.5 CS Stage with Triode Load

A MOS device operating in the deep triode region behaves as a resistor and can therefore serve as the load in a CS stage. Illustrated in Fig. 3.22, such a circuit biases the gate of $M_{2}$ at a sufficiently low level, ensuring that the load is in the deep triode region for all output voltage swings. Since

$$
\begin{equation*}
R_{o n 2}=\frac{1}{\mu_{p} C_{o x}(W / L)_{2}\left(V_{D D}-V_{b}-\left|V_{T H P}\right|\right)} \tag{3.51}
\end{equation*}
$$

the voltage gain can be readily calculated.
The principal drawback of this circuit stems from the dependence of $R_{o n 2}$ upon $\mu_{p} C_{o x}, V_{b}$, and $V_{T H P}$. Since $\mu_{p} C_{o x}$ and $V_{T H P}$ vary with process and temperature, and since generating a precise value for $V_{b}$ requires additional complexity, this circuit is difficult to use. Triode loads, however, consume less voltage headroom than do diode-connected devices because in Fig. 3.22, $V_{\text {out }, \max }=V_{D D}$, whereas in Fig. 3.16, $V_{\text {out }, \max } \approx V_{D D}-\left|V_{T H P}\right|$.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-061.jpg?height=391&width=682&top_left_y=245&top_left_x=279)

Figure 3.22 CS stage with triode load.

Among the five CS variants studied above, those employing resistive, current-source, or active loads find wider usage than the other two.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-061.jpg?height=437&width=890&top_left_y=834&top_left_x=523)

Figure 3.23 CS stage with source degeneration.

### 3.3.6 CS Stage with Source Degeneration

In some applications, the nonlinear dependence of the drain current upon the overdrive voltage introduces excessive nonlinearity, making it desirable to "soften" the device characteristics. In Sec. 3.3.2, we noted the linear behavior of a CS stage using a diode-connected load, which allows "postcorrection" of the nonlinearity. Alternatively, as depicted in Fig. 3.23(a), this can be accomplished by placing a "degeneration" resistor in series with the source terminal so as to make the input device more linear. Let us neglect channel-length modulation and body effect. Here, as $V_{i n}$ increases, so do $I_{D}$ and the voltage drop across $R_{S}$. That is, a fraction of the change in $V_{i n}$ appears across the resistor rather than as the gate-source overdrive, thus leading to a smoother variation of $I_{D}$. From another perspective, we intend to make the gain equation a weaker function of $g_{m}$. Since $V_{\text {out }}=V_{D D}-I_{D} R_{D}$, the nonlinearity of the circuit arises from the nonlinear dependence of $I_{D}$ upon $V_{i n}$. We note that $\partial V_{\text {out }} / \partial V_{i n}=-\left(\partial I_{D} / \partial V_{i n}\right) R_{D}$, and define the equivalent transconductance of the circuit as $G_{m}=\partial I_{D} / \partial V_{i n} .{ }^{3}$ Now, assuming that $I_{D}=f\left(V_{G S}\right)$, we write

$$
\begin{align*}
G_{m} & =\frac{\partial I_{D}}{\partial V_{i n}}  \tag{3.52}\\
& =\frac{\partial f}{\partial V_{G S}} \frac{\partial V_{G S}}{\partial V_{i n}} \tag{3.53}
\end{align*}
$$

[^12]Since $V_{G S}=V_{i n}-I_{D} R_{S}$, we have $\partial V_{G S} / \partial V_{i n}=1-R_{S} \partial I_{D} / \partial V_{i n}$, obtaining

$$
\begin{equation*}
G_{m}=\left(1-R_{S} \frac{\partial I_{D}}{\partial V_{i n}}\right) \frac{\partial f}{\partial V_{G S}} \tag{3.54}
\end{equation*}
$$

But, $\partial f / \partial V_{G S}$ is the transconductance of $M_{1}$, and

$$
\begin{equation*}
G_{m}=\frac{g_{m}}{1+g_{m} R_{S}} \tag{3.55}
\end{equation*}
$$

The small-signal voltage gain is thus equal to

$$
\begin{align*}
A_{v} & =-G_{m} R_{D}  \tag{3.56}\\
& =\frac{-g_{m} R_{D}}{1+g_{m} R_{S}} \tag{3.57}
\end{align*}
$$

The same result can be derived using the small-signal model of Fig. 3.23(b) by writing a KVL, $V_{i n}=$ $V_{1}+I_{D} R_{S}$, and noting that $I_{D}=g_{m} V_{1}$. Equation (3.55) implies that as $R_{S}$ increases, $G_{m}$ becomes a weaker function of $g_{m}$ and hence the drain current. In fact, for $R_{S} \gg 1 / g_{m}$, we have $G_{m} \approx 1 / R_{S}$, i.e., $\Delta I_{D} \approx \Delta V_{i n} / R_{S}$, concluding that most of the change in $V_{i n}$ appears across $R_{S}$. We say that the drain current is a "linearized" function of the input voltage. In Problem 3.30, we examine this effect from a different perspective. The linearization is obtained at the cost of lower gain [and higher noise (Chapter 7)].

For our subsequent calculations, it is useful to determine $G_{m}$ in the presence of body effect and channel-length modulation. With the aid of the equivalent circuit shown in Fig. 3.24, we recognize that the current through $R_{S}$ equals $I_{\text {out }}$ and, therefore, $V_{\text {in }}=V_{1}+I_{\text {out }} R_{S}$. Summing the currents at node $X$, we have

$$
\begin{align*}
I_{\text {out }} & =g_{m} V_{1}-g_{m b} V_{X}-\frac{I_{\text {out }} R_{S}}{r_{O}}  \tag{3.58}\\
& =g_{m}\left(V_{\text {in }}-I_{\text {out }} R_{S}\right)+g_{m b}\left(-I_{\text {out }} R_{S}\right)-\frac{I_{\text {out }} R_{S}}{r_{O}} \tag{3.59}
\end{align*}
$$

It follows that

$$
\begin{align*}
G_{m} & =\frac{I_{\text {out }}}{V_{\text {in }}}  \tag{3.60}\\
& =\frac{g_{m} r_{O}}{R_{S}+\left[1+\left(g_{m}+g_{m b}\right) R_{S}\right] r_{O}} \tag{3.61}
\end{align*}
$$

![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-062.jpg?height=327&width=667&top_left_y=1952&top_left_x=432)

Figure 3.24 Small-signal equivalent circuit of a degenerated CS stage.

Let us now examine the large-signal behavior of the CS stage with $R_{S}=0$ and $R_{S} \neq 0$. For $R_{S}=0$, our derivations in Chapter 2 indicate that $I_{D}$ and $g_{m}$ vary as shown in Fig. 3.25(a). For $R_{S} \neq 0$, the turn-on behavior is similar to that in Fig. 3.25(a) because, at low current levels, $1 / g_{m} \gg R_{S}$, and hence $G_{m} \approx g_{m}\left[\right.$ Fig. 3.25(b)]. As the overdrive and therefore $g_{m}$ increase, the effect of degeneration, $1+g_{m} R_{S}$ in (3.55), becomes more significant. For large values of $V_{i n}$ (if $M_{1}$ is still saturated), $I_{D}$ is approximately a linear function of $V_{i n}$ and $G_{m}$ approaches $1 / R_{S}$.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-063.jpg?height=288&width=675&top_left_y=532&top_left_x=267)
(a)
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-063.jpg?height=289&width=670&top_left_y=532&top_left_x=1002)
(b)

Figure 3.25 Drain current and transconductance of a CS device (a) without and (b) with source degeneration.

#### Example 3.9

Plot the small-signal voltage gain of the circuit in Fig. 3.23 as a function of the input bias voltage, $V_{i n}$.

#### Solution

Using the results derived above for the equivalent transconductance of $M_{1}$ and $R_{S}$, we arrive at the plot shown in Fig. 3.26. For $V_{i n}$ slightly greater than $V_{T H}, 1 / g_{m} \gg R_{S}$ and $A_{v} \approx-g_{m} R_{D}$. As $V_{i n}$ increases, degeneration becomes more significant and $A_{v}=-g_{m} R_{D} /\left(1+g_{m} R_{S}\right)$. For large values of $V_{i n}, G_{m} \approx 1 / R_{S}$ and $A_{v}=-R_{D} / R_{S}$. However, if $V_{\text {in }}>V_{\text {out }}+V_{T H}$, that is, if $R_{D} I_{D}>V_{T H}+V_{D D}-V_{i n}, M_{1}$ enters the triode region and $A_{v}$ drops.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-063.jpg?height=321&width=408&top_left_y=1376&top_left_x=490)

Figure 3.26

Equation (3.57) can be rewritten as

$$
\begin{equation*}
A_{v}=-\frac{R_{D}}{\frac{1}{g_{m}}+R_{S}} \tag{3.62}
\end{equation*}
$$

This result allows formulating the gain by inspection. First, let us examine the denominator of (3.62). The expression is equal to the series combination of the inverse transconductance of the device and the explicit resistance seen from the source to ground. We call the denominator "the resistance seen in the source path" because if, as shown in Fig. 3.27, we disconnect the bottom terminal of $R_{S}$ from ground and calculate the resistance seen "looking up" (while setting the input to zero), we obtain $R_{S}+1 / g_{m}$.

#### Nanometer Design Notes

A common issue in nanometer technologies is that a MOS transistor experiences "stress" if its $V_{G S}, V_{D S}$, or $V_{D G}$ exceeds certain limits. For example, in 40-nm technology, these voltages should remain below 1 V . Interestingly, the cascode structure can avoid device stress even if $V_{D D}$ is greater than allowed. As can be seen from the diagram below, as the drain current decreases and $V_{\text {out }}$ approaches $V_{D D}, M_{1}$ experiences $V_{D S}=$ $V_{D D}$, whereas $M_{2}$ sees $V_{D S} \approx V_{b}-$ $V_{T H 2}$. Similarly, $V_{D S 3}<V_{D D}$ (why?).
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-064.jpg?height=254&width=397&top_left_y=795&top_left_x=199)
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-064.jpg?height=359&width=257&top_left_y=202&top_left_x=886)

Figure 3.27 Resistance seen in the source path.

Noting that the numerator of (3.62) is the resistance seen at the drain, we view the magnitude of the gain as the resistance seen at the drain node divided by the total resistance in the source path. This method greatly simplifies the analysis of more complex circuits.

#### Example 3.10

Assuming $\lambda=\gamma=0$, calculate the small-signal gain of the circuit shown in Fig. 3.28(a).
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-064.jpg?height=452&width=698&top_left_y=975&top_left_x=770)

Figure 3.28

#### Solution

Noting that $M_{2}$ is a diode-connected device and simplifying the circuit to that shown in Fig. 3.28(b), we use the above rule to write

$$
\begin{equation*}
A_{v}=-\frac{R_{D}}{\frac{1}{g_{m 1}}+\frac{1}{g_{m 2}}} \tag{3.63}
\end{equation*}
$$

Output Resistance Another important consequence of source degeneration is the increase in the output resistance of the stage. We calculate the output resistance first with the aid of the equivalent circuit shown in Fig. 3.29, where the load resistor, $R_{D}$, is excluded for now. Note that body effect is also included to
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-064.jpg?height=331&width=710&top_left_y=1945&top_left_x=408)

Figure 3.29 Equivalent circuit for calculating the output resistance of a degenerated CS stage.
arrive at a general result. Since the current through $R_{S}$ is equal to $I_{X}, V_{1}=-I_{X} R_{S}$, and the current flowing through $r_{O}$ is given by $I_{X}-\left(g_{m}+g_{m b}\right) V_{1}=I_{X}+\left(g_{m}+g_{m b}\right) R_{S} I_{X}$. Adding the voltage drops across $r_{O}$ and $R_{S}$, we obtain

$$
\begin{equation*}
r_{O}\left[I_{X}+\left(g_{m}+g_{m b}\right) R_{S} I_{X}\right]+I_{X} R_{S}=V_{X} \tag{3.64}
\end{equation*}
$$

It follows that

$$
\begin{align*}
R_{\text {out }} & =\left[1+\left(g_{m}+g_{m b}\right) R_{S}\right] r_{O}+R_{S}  \tag{3.65}\\
& =\left[1+\left(g_{m}+g_{m b}\right) r_{O}\right] R_{S}+r_{O} \tag{3.66}
\end{align*}
$$

Equation (3.65) indicates that $r_{O}$ is "boosted" by a factor of $1+\left(g_{m}+g_{m b}\right) R_{S}$ and then added to $R_{S}$. As an alternative perspective, Eq. (3.66) suggests that $R_{S}$ is boosted by a factor of $1+\left(g_{m}+g_{m b}\right) r_{O}$ (a value close to the transistor's intrinsic gain) and then added to $r_{O}$. Both views prove useful in analyzing circuits. Note that the overall output resistance is equal to the parallel combination of $R_{\text {out }}$ and $R_{D}$. If $\left(g_{m}+g_{m b}\right) r_{O} \gg 1$, we have

$$
\begin{align*}
R_{\text {out }} & \approx\left(g_{m}+g_{m b}\right) r_{O} R_{S}+r_{O}  \tag{3.67}\\
& =\left[1+\left(g_{m}+g_{m b}\right) R_{S}\right] r_{O} \tag{3.68}
\end{align*}
$$

To gain more insight, let us consider the circuit of Fig. 3.29 with $R_{S}=0$ and $R_{S}>0$. If $R_{S}=0$, then $g_{m} V_{1}=g_{m b} V_{b s}=0$ and $I_{X}=V_{X} / r_{O}$. On the other hand, if $R_{S}>0$, we have $I_{X} R_{S}>0$ and $V_{1}<0$, obtaining negative $g_{m} V_{1}$ and $g_{m b} V_{b s}$. Thus, the current supplied by $V_{X}$ is less than $V_{X} / r_{O}$, and hence the output impedance is greater than $r_{O}$.

The relationship in (3.65) can also be derived by inspection. As shown in Fig. 3.30(a), we apply a voltage to the output node, change its value by $\Delta V$, and measure the resulting change, $\Delta I$, in the output current. Since the current through $R_{S}$ must change by $\Delta I$ (why?), we first compute the voltage change across $R_{S}$. To this end, we draw the circuit as shown in Fig. 3.30(b) and note that the resistance seen looking into the source of $M_{1}$ is equal to $1 /\left(g_{m}+g_{m b}\right)$ [Eq. (3.24)], thus arriving at the equivalent circuit in Fig. 3.30(c). The voltage change across $R_{S}$ is therefore equal to

$$
\begin{equation*}
\Delta V_{R S}=\Delta V \frac{\frac{1}{g_{m}+g_{m b}} \| R_{S}}{\frac{1}{g_{m}+g_{m b}} \| R_{S}+r_{O}} \tag{3.69}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-065.jpg?height=431&width=1154&top_left_y=1782&top_left_x=386)

Figure 3.30 (a) Change in drain current in response to change in applied voltage to drain; (b) equivalent of (a); (c) small-signal model.

The change in the current is

$$
\begin{align*}
\Delta I & =\frac{\Delta V_{R S}}{R_{S}}  \tag{3.70}\\
& =\Delta V \frac{1}{\left[1+\left(g_{m}+g_{m b}\right)\right] R_{S} r_{O}+R_{S}} \tag{3.71}
\end{align*}
$$

that is,

$$
\begin{equation*}
\frac{\Delta V}{\Delta I}=\left[1+\left(g_{m}+g_{m b}\right) R_{S}\right] r_{O}+R_{S} \tag{3.72}
\end{equation*}
$$

With the foregoing developments, we can now compute the gain of a degenerated CS stage in the general case, taking into account both body effect and channel-length modulation. In the equivalent circuit depicted in Fig. 3.31, the current through $R_{S}$ must equal that through $R_{D}$, i.e., $-V_{\text {out }} / R_{D}$. Thus, the source voltage with respect to ground (and the bulk) is equal to $-V_{\text {out }} R_{S} / R_{D}$, yielding $V_{1}=V_{\text {in }}+V_{\text {out }} R_{S} / R_{D}$. The current flowing through $r_{O}$ from top to bottom can therefore be written as

$$
\begin{align*}
I_{r o} & =-\frac{V_{\text {out }}}{R_{D}}-\left(g_{m} V_{1}+g_{m b} V_{\text {bs }}\right)  \tag{3.73}\\
& =-\frac{V_{\text {out }}}{R_{D}}-\left[g_{m}\left(V_{\text {in }}+V_{\text {out }} \frac{R_{S}}{R_{D}}\right)+g_{m b} V_{\text {out }} \frac{R_{S}}{R_{D}}\right] \tag{3.74}
\end{align*}
$$

![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-066.jpg?height=346&width=926&top_left_y=1128&top_left_x=572)

Figure 3.31 Small-signal model of degenerated CS stage with finite output resistance.
Since the voltage drops across $r_{O}$ and $R_{S}$ must add up to $V_{\text {out }}$, we have

$$
\begin{align*}
V_{\text {out }} & =I_{\text {ro }} r_{O}-\frac{V_{\text {out }}}{R_{D}} R_{S}  \tag{3.75}\\
& =-\frac{V_{\text {out }}}{R_{D}} r_{O}-\left[g_{m}\left(V_{\text {in }}+V_{\text {out }} \frac{R_{S}}{R_{D}}\right)+g_{m b} V_{\text {out }} \frac{R_{S}}{R_{D}}\right] r_{O}-V_{\text {out }} \frac{R_{S}}{R_{D}} \tag{3.76}
\end{align*}
$$

It follows that

$$
\begin{equation*}
\frac{V_{\text {out }}}{V_{\text {in }}}=\frac{-g_{m} r_{O} R_{D}}{R_{D}+R_{S}+r_{O}+\left(g_{m}+g_{m b}\right) R_{S} r_{O}} \tag{3.77}
\end{equation*}
$$

To gain more insight into this result, we recognize that the last three terms in the denominator, namely, $R_{S}+r_{O}+\left(g_{m}+g_{m b}\right) R_{S} r_{O}$, represent the output resistance of a MOS device degenerated by a resistor $R_{S}$, as originally derived in (3.66). Let us now rewrite (3.77) as

$$
\begin{align*}
A_{v} & =\frac{-g_{m} r_{O} R_{D}\left[R_{S}+r_{O}+\left(g_{m}+g_{m b}\right) R_{S} r_{O}\right]}{R_{D}+R_{S}+r_{O}+\left(g_{m}+g_{m b}\right) R_{S} r_{O}} \cdot \frac{1}{R_{S}+r_{O}+\left(g_{m}+g_{m b}\right) R_{S} r_{O}}  \tag{3.78}\\
& =-\frac{g_{m} r_{O}}{R_{S}+r_{O}+\left(g_{m}+g_{m b}\right) R_{S} r_{O}} \cdot \frac{R_{D}\left[R_{S}+r_{O}+\left(g_{m}+g_{m b}\right) R_{S} r_{O}\right]}{R_{D}+R_{S}+r_{O}+\left(g_{m}+g_{m b}\right) R_{S} r_{O}} \tag{3.79}
\end{align*}
$$

The two fractions in (3.79) represent two important parameters of the circuit: the first is identical to that in (3.61), i.e., the equivalent transconductance of a degenerated MOSFET; and the second denotes the parallel combination of $R_{D}$ and $R_{S}+r_{O}+\left(g_{m}+g_{m b}\right) R_{S} r_{O}$, i.e., the overall output resistance of the circuit.

The above discussion suggests that in some circuits, it may be easier to calculate the voltage gain by exploiting the following lemma. We recall that the output port of a linear circuit can be represented by a Norton equivalent [Fig. 3.32(a)].

Lemma In a linear circuit, the voltage gain is equal to $-G_{m} R_{\text {out }}$, where $G_{m}$ denotes the transconductance of the circuit when the output is shorted to ground [Fig. 3.32(b)] and $R_{\text {out }}$ represents the output resistance of the circuit when the input voltage is set to zero [Fig. 3.32(c)].
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-067.jpg?height=296&width=1495&top_left_y=692&top_left_x=236)

Figure 3.32 (a) Norton equivalent of a linear circuit; (b) $G_{m}$ calculation; and (c) $R_{\text {out }}$ calculation.

The lemma can be proved by noting that the output voltage in Fig. 3.32(a) is equal to $-I_{\text {out }} R_{\text {out }}$, and $I_{\text {out }}$ can be obtained by measuring the short-circuit current at the output. Defining $G_{m}=I_{\text {out }} / V_{\text {in }}$, we have $V_{\text {out }}=-G_{m} V_{\text {in }} R_{\text {out }}$. This lemma proves useful if $G_{m}$ and $R_{\text {out }}$ can be determined by inspection. Note the direction of $I_{\text {out }}$.

#### Example 3.11

Calculate the voltage gain of the circuit shown in Fig. 3.33. Assume that $I_{0}$ is ideal.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-067.jpg?height=334&width=280&top_left_y=1449&top_left_x=557)

Figure 3.33

#### Solution

The transconductance and output resistance of the stage are given by Eqs. (3.61) and (3.66), respectively. Thus,

$$
\begin{align*}
A_{v} & =-\frac{g_{m} r_{O}}{R_{S}+\left[1+\left(g_{m}+g_{m b}\right) R_{S}\right] r_{O}}\left\{\left[1+\left(g_{m}+g_{m b}\right) r_{O}\right] R_{S}+r_{O}\right\}  \tag{3.80}\\
& =-g_{m} r_{O} \tag{3.81}
\end{align*}
$$

Interestingly, the voltage gain is equal to the intrinsic gain of the transistor and independent of $R_{S}$. This is because, if $I_{0}$ is ideal, the current through $R_{S}$ cannot change, and hence the small-signal voltage drop across $R_{S}$ is zero-as if $R_{S}$ were zero itself.

## 3.4 ■ Source Follower

Our analysis of the common-source stage indicates that, to achieve a high voltage gain with limited supply voltage, the load impedance must be as large as possible. If such a stage is to drive a low-impedance load, then a "buffer" must be placed after the amplifier so as to drive the load with negligible reduction in gain. The source follower (also called the "common-drain" stage) can operate as a voltage buffer.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-068.jpg?height=475&width=1271&top_left_y=551&top_left_x=402)

Figure 3.34 (a) Source follower, (b) example of its role as a buffer, and (c) its input-output characteristic.

Illustrated in Fig. 3.34(a), the source follower senses the signal at the gate, while presenting a high input impedance, and drives the load at the source, allowing the source potential to "follow" the gate voltage. Figure 3.34(b) depicts how the circuit can be used to drive a low resistance without degrading the voltage gain of a CS stage. Beginning with the large-signal behavior of the source follower, we note that for $V_{\text {in }}<V_{T H}, M_{1}$ is off and $V_{\text {out }}=0$. As $V_{\text {in }}$ exceeds $V_{T H}, M_{1}$ turns on in saturation (why?) and $I_{D 1}$ flows through $R_{S}$ [Fig. 3.34(c)]. As $V_{i n}$ increases further, $V_{o u t}$ follows the input with a difference (level shift) equal to $V_{G S}$. We can express the input-output characteristic as

$$
\begin{equation*}
\frac{1}{2} \mu_{n} C_{o x} \frac{W}{L}\left(V_{\text {in }}-V_{T H}-V_{\text {out }}\right)^{2} R_{S}=V_{\text {out }} \tag{3.82}
\end{equation*}
$$

where channel-length modulation is neglected. Let us calculate the small-signal gain of the circuit by differentiating both sides of (3.82) with respect to $V_{i n}$ :

$$
\begin{equation*}
\frac{1}{2} \mu_{n} C_{\text {ox }} \frac{W}{L} 2\left(V_{\text {in }}-V_{T H}-V_{\text {out }}\right)\left(1-\frac{\partial V_{T H}}{\partial V_{\text {in }}}-\frac{\partial V_{\text {out }}}{\partial V_{\text {in }}}\right) R_{S}=\frac{\partial V_{\text {out }}}{\partial V_{\text {in }}} \tag{3.83}
\end{equation*}
$$

Since $\partial V_{T H} / \partial V_{\text {in }}=\left(\partial V_{T H} / \partial V_{S B}\right)\left(\partial V_{S B} / \partial V_{\text {in }}\right)=\eta \partial V_{\text {out }} / \partial V_{\text {in }}$,

$$
\begin{equation*}
\frac{\partial V_{\text {out }}}{\partial V_{\text {in }}}=\frac{\mu_{n} C_{\text {ox }} \frac{W}{L}\left(V_{\text {in }}-V_{T H}-V_{\text {out }}\right) R_{S}}{1+\mu_{n} C_{\text {ox }} \frac{W}{L}\left(V_{\text {in }}-V_{T H}-V_{\text {out }}\right) R_{S}(1+\eta)} \tag{3.84}
\end{equation*}
$$

Also, note that

$$
\begin{equation*}
g_{m}=\mu_{n} C_{o x} \frac{W}{L}\left(V_{\text {in }}-V_{T H}-V_{\text {out }}\right) \tag{3.85}
\end{equation*}
$$

Consequently,

$$
\begin{equation*}
A_{v}=\frac{g_{m} R_{S}}{1+\left(g_{m}+g_{m b}\right) R_{S}} \tag{3.86}
\end{equation*}
$$

The same result is more easily obtained with the aid of a small-signal equivalent circuit. From Fig. 3.35, we have $V_{\text {in }}-V_{1}=V_{\text {out }}, V_{\text {bs }}=-V_{\text {out }}$, and $g_{m} V_{1}-g_{m b} V_{\text {out }}=V_{\text {out }} / R_{S}$. Thus, $V_{\text {out }} / V_{\text {in }}=g_{m} R_{S} /[1+$ $\left.\left(g_{m}+g_{m b}\right) R_{S}\right]$.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-069.jpg?height=331&width=588&top_left_y=572&top_left_x=408)

Figure 3.35 Small-signal equivalent circuit of source follower.

Sketched in Fig. 3.36 vs. $V_{i n}$, the voltage gain begins from zero for $V_{i n} \approx V_{T H}$ (that is, $g_{m} \approx 0$ ) and monotonically increases. As the drain current and $g_{m}$ increase, $A_{v}$ approaches $g_{m} /\left(g_{m}+g_{m b}\right)=1 /(1+\eta)$. Since $\eta$ itself slowly decreases with $V_{\text {out }}, A_{v}$ would eventually become equal to unity, but for typical allowable source-bulk voltages, $\eta$ remains greater than roughly 0.2 .
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-069.jpg?height=285&width=437&top_left_y=1133&top_left_x=478)

Figure 3.36 Voltage gain of source follower versus input voltage.

An important result of (3.86) is that even if $R_{S}=\infty$, the voltage gain of a source follower is not equal to one (unless body effect is removed as explained later). We return to this point later. Note that $M_{1}$ in Fig. 3.34(a) remains in saturation if $V_{i n}$ does not exceed $V_{D D}+V_{T H}$.

In the source follower of Fig. 3.34(a), the drain current of $M_{1}$ heavily depends on the input dc level. For example, if $V_{i n}$ changes from 0.7 V to $1 \mathrm{~V}, I_{D}$ may increase by a factor of 2 , and hence $V_{G S}-V_{T H}$ by $\sqrt{2}$. Even if $V_{T H}$ is relatively constant, the increase in $V_{G S}$ means that $V_{\text {out }}\left(=V_{i n}-V_{G S}\right)$ does not follow $V_{i n}$ faithfully, thereby incurring nonlinearity. To alleviate this issue, the resistor can be replaced by a constant current source as shown in Fig. 3.37(a). The current source itself is implemented as an NMOS transistor operating in the saturation region [Fig. 3.37(b)].
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-069.jpg?height=393&width=711&top_left_y=1904&top_left_x=341)

Figure 3.37 Source follower using (a) an ideal current source, and (b) an NMOS transistor as a current source.

Example 3.12
Suppose that in the source follower of Fig. 3.37(a), $(W / L)_{1}=20 / 0.5, I_{1}=200 \mu \mathrm{~A}, V_{T H 0}=0.6 \mathrm{~V}, 2 \Phi_{F}=0.7 \mathrm{~V}$, $V_{D D}=1.2 \mathrm{~V}, \mu_{n} C_{o x}=50 \mu \mathrm{~A} / \mathrm{V}^{2}$, and $\gamma=0.4 \mathrm{~V}^{1 / 2}$.
(a) Calculate $V_{\text {out }}$ for $V_{\text {in }}=1.2 \mathrm{~V}$.
(b) If $I_{1}$ is implemented as $M_{2}$ in Fig. 3.37 (b), find the minimum value of $(W / L)_{2}$ for which $M_{2}$ remains saturated when $V_{i n}=1.2 \mathrm{~V}$.

#### Solution

(a) Since the threshold voltage of $M_{1}$ depends on $V_{\text {out }}$, we perform a simple iteration. Noting that

$$
\begin{equation*}
\left(V_{\text {in }}-V_{T H}-V_{\text {out }}\right)^{2}=\frac{2 I_{D}}{\mu_{n} C_{o x}\left(\frac{W}{L}\right)_{1}} \tag{3.87}
\end{equation*}
$$

we first assume that $V_{T H} \approx 0.6 \mathrm{~V}$, obtaining $V_{\text {out }}=0.153 \mathrm{~V}$. Now we calculate a new $V_{T H}$ as

$$
\begin{align*}
V_{T H} & =V_{T H 0}+\gamma\left(\sqrt{2 \Phi_{F}+V_{S B}}-\sqrt{2 \Phi_{F}}\right)  \tag{3.88}\\
& =0.635 \mathrm{~V} \tag{3.89}
\end{align*}
$$

This indicates that $V_{\text {out }}$ is approximately 35 mV less than that calculated above, i.e., $V_{\text {out }} \approx 0.118 \mathrm{~V}$.
(b) Since the drain-source voltage of $M_{2}$ is equal to 0.118 V , the device is saturated only if $\left(V_{G S}-V_{T H}\right)_{2} \leq 0.118 \mathrm{~V}$. With $I_{D}=200 \mu \mathrm{~A}$, this gives $(W / L)_{2} \geq 287 / 0.5$. Note the substantial drain junction and overlap capacitance contributed by $M_{2}$ to the output node.

#### Example 3.13

Explain intuitively why the gain of the source follower in Fig. 3.37(a) is equal to unity if $I_{1}$ is ideal and $\lambda=\gamma=0$.

#### Solution

In this case, the drain current of $M_{1}$ remains exactly constant, and so does $V_{G S 1}$. Since $V_{\text {out }}=V_{\text {in }}-V_{G S 1}$, we observe that a change in $V_{\text {in }}$ must equally appear in $V_{\text {out }}$. Alternatively, as shown in Fig. 3.38, we can say that the small-signal drain current cannot flow through any path and must be zero, yielding $V_{1}=0$ and $V_{\text {out }}=V_{\text {in }}$.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-070.jpg?height=242&width=436&top_left_y=1503&top_left_x=548)

To gain a better understanding of source followers, let us calculate the small-signal output resistance of the circuit in Fig. 3.39(a). Using the equivalent circuit of Fig. 3.39(b) and noting that $V_{X}=-V_{b s}$, we write

$$
\begin{equation*}
I_{X}-g_{m} V_{X}-g_{m b} V_{X}=0 \tag{3.90}
\end{equation*}
$$

It follows that

$$
\begin{equation*}
R_{o u t}=\frac{1}{g_{m}+g_{m b}} \tag{3.91}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-071.jpg?height=452&width=1140&top_left_y=227&top_left_x=398)

Figure 3.39 Calculation of the output impedance of a source follower.

This result should not come as a surprise: the circuit in Fig. 3.39(b) is similar to that in Fig. 3.11(b). Interestingly, body effect decreases the output resistance of source followers. To understand why, suppose that in Fig. 3.39(c), $V_{X}$ decreases by $\Delta V$ so that the drain current increases. With no body effect, only the gate-source voltage of $M_{1}$ would increase by $\Delta V$. With body effect, on the other hand, the threshold voltage of the device decreases as well. Thus, in $\left(V_{G S}-V_{T H}\right)^{2}$, the first term increases and the second decreases, resulting in a greater change in the drain current and hence a lower output impedance.

The above phenomenon can also be studied with the aid of the small-signal model shown in Fig. 3.40(a). It is important to note that the magnitude of the current source $g_{m b} V_{b s}=g_{m b} V_{X}$ is linearly proportional to the voltage across it (because the current source and the voltage source are in parallel). Such a behavior is that of a simple resistor equal to $1 / g_{m b}$, yielding the small-signal model shown in Fig. 3.40(b). The equivalent resistor simply appears in parallel with the output, thereby lowering the overall output resistance. Since without $1 / g_{m b}$, the output resistance equals $1 / g_{m}$, we conclude that

$$
\begin{align*}
R_{\text {out }} & =\frac{1}{g_{m}} \| \frac{1}{g_{m b}}  \tag{3.92}\\
& =\frac{1}{g_{m}+g_{m b}} \tag{3.93}
\end{align*}
$$

Modeling the effect of $g_{m b}$ by a resistor—which is valid only for source followers-also helps explain the less-than-unity voltage gain implied by (3.86) for $R_{S}=\infty$. As shown in the Thevenin equivalent
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-071.jpg?height=454&width=1069&top_left_y=1781&top_left_x=434)

Figure 3.40 Source follower including body effect.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-072.jpg?height=326&width=1102&top_left_y=221&top_left_x=486)

Figure 3.41 Representation of intrinsic source follower by a Thevenin equivalent.
of Fig. 3.41,

$$
\begin{align*}
A_{v} & =\frac{\frac{1}{g_{m b}}}{\frac{1}{g_{m}}+\frac{1}{g_{m b}}}  \tag{3.94}\\
& =\frac{g_{m}}{g_{m}+g_{m b}} \tag{3.95}
\end{align*}
$$

For completeness, we also study a source follower with a finite load resistance and channel-length modulation [Fig. 3.42(a)]. Noting that $1 / g_{m b}, r_{O 1}, r_{O 2}$, and $R_{L}$ are in parallel, we can reduce the circuit to that shown in Fig. 3.42(c), where $R_{e q}=\left(1 / g_{m b}\right)\left\|r_{O 1}\right\| r_{O 2} \| R_{L}$. It follows that

$$
\begin{equation*}
A_{v}=\frac{R_{e q}}{R_{e q}+\frac{1}{g_{m}}} \tag{3.96}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-072.jpg?height=341&width=370&top_left_y=1351&top_left_x=284)
(a)
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-072.jpg?height=339&width=660&top_left_y=1354&top_left_x=633)
(b)
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-072.jpg?height=331&width=469&top_left_y=1351&top_left_x=1292)
(c)

Figure 3.42 (a) Source follower driving load resistance; (b) small-signal equivalent circuit; (c) simplified model.

#### Example 3.14

Calculate the voltage gain of the circuit shown in Fig. 3.43.

#### Solution

The impedance seen looking into the source of $M_{2}$ (a diode-connected device) is equal to $\left[1 /\left(g_{m 2}+g_{m b 2}\right)\right] \| r_{O 2}$. The impedance appears in parallel with $1 / g_{m b 1}$ and $r_{O 1}$. Thus,

$$
\begin{equation*}
A_{v}=\frac{\frac{1}{g_{m 2}+g_{m b 2}}\left\|r_{O 2}\right\| r_{O 1} \| \frac{1}{g_{m b 1}}}{\frac{1}{g_{m 2}+g_{m b 2}}\left\|r_{O 2}\right\| r_{O 1} \| \frac{1}{g_{m b 1}}+\frac{1}{g_{m 1}}} \tag{3.97}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-073.jpg?height=330&width=299&top_left_y=245&top_left_x=547)

Figure 3.43

Source followers exhibit a high input impedance and a moderate output impedance, but at the cost of two drawbacks: nonlinearity and voltage headroom limitation. We consider these issues in detail.

As mentioned in relation to Fig. 3.34(a), even if a source follower is biased by an ideal current source, its input-output characteristic displays some nonlinearity due to the nonlinear dependence of $V_{T H}$ upon the source potential. In submicron technologies, $r_{O}$ of the transistor also changes substantially with $V_{D S}$, thus introducing additional variation in the small-signal gain of the circuit (Chapter 14). For this reason, typical source followers suffer from significant nonlinearity.

The nonlinearity due to body effect can be eliminated if the bulk is tied to the source. This is usually possible only for PFETs because all NFETs share the same substrate. Figure 3.44 shows a PMOS source follower employing two separate $n$-wells so as to eliminate the body effect of $M_{1}$. The lower mobility of PFETs, however, yields a higher output impedance in this case than that available in an NMOS counterpart.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-073.jpg?height=644&width=1031&top_left_y=1199&top_left_x=450)

Figure 3.44 (a) PMOS source follower with no body effect; (b) corresponding layout showing separate $n$-wells.
Source followers also shift the dc level of the signal by $V_{G S}$, thereby consuming voltage headroom and limiting the voltage swings. To understand this point, consider the example illustrated in Fig. 3.45, a cascade of a common-source stage and a source follower. Without the source follower, the minimum allowable value of $V_{X}$ would be equal to $V_{G S 1}-V_{T H 1}$ (for $M_{1}$ to remain in saturation). With the source follower, on the other hand, $V_{X}$ must be greater than $V_{G S 2}+\left(V_{G S 3}-V_{T H 3}\right)$ so that $M_{3}$ is saturated. For comparable overdrive voltages in $M_{1}$ and $M_{3}$, this means the allowable swing at $X$ is reduced by $V_{G S 2}$, a substantial amount.

It is also instructive to compare the gain of source followers and common-source stages when the load impedance is relatively low. A practical example is the need to drive an external $50-\Omega$ termination in a
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-074.jpg?height=836&width=946&top_left_y=235&top_left_x=505)

Figure 3.46 (a) Source follower and (b) CS stage driving a load resistance.
high-frequency environment. As shown in Fig. 3.46(a), the load can be driven by a source follower with an overall voltage gain of

$$
\begin{align*}
\left.\frac{V_{\text {out }}}{V_{\text {in }}}\right|_{S F} & \approx \frac{R_{L}}{R_{L}+1 / g_{m 1}}  \tag{3.98}\\
& \approx \frac{g_{m 1} R_{L}}{1+g_{m 1} R_{L}} \tag{3.99}
\end{align*}
$$

On the other hand, as depicted in Fig. 3.46(b), the load can be included as part of a common-source stage, providing a gain of

$$
\begin{equation*}
\left.\frac{V_{\text {out }}}{V_{\text {in }}}\right|_{C S} \approx-g_{m 1} R_{L} \tag{3.100}
\end{equation*}
$$

The key difference between these two topologies is the achievable voltage gain for a given bias current. For example, if $1 / g_{m 1} \approx R_{L}$, then the source follower exhibits a gain of at most 0.5 , whereas the commonsource stage provides a gain close to unity. Thus, source followers are not necessarily efficient drivers.

The drawbacks of source followers, namely, nonlinearity due to body effect and voltage headroom consumption due to level shift, limit the use of this topology. As a general rule, we avoid the use of source followers unless they become absolutely necessary. One application of source followers is in performing voltage-level shift, as illustrated by the following example.

#### Example 3.15

(a) In the circuit of Fig. 3.47(a), calculate the voltage gain if $C_{1}$ acts as an ac short at the frequency of interest. What is the maximum dc level of the input signal for which $M_{1}$ remains saturated?
(b) To accommodate an input dc level close to $V_{D D}$, the circuit is modified as shown in Fig. 3.47(b). What relationship between the gate-source voltages of $M_{2}$ and $M_{3}$ guarantees that $M_{1}$ is saturated?
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-075.jpg?height=503&width=916&top_left_y=238&top_left_x=510)

Figure 3.47

#### Solution

(a) Noting that the source of $M_{1}$ is at ac ground, we write the gain as

$$
\begin{equation*}
A_{v}=-g_{m 1}\left[r_{O 1}\left\|r_{O 2}\right\|\left(1 / g_{m 2}\right)\right] \tag{3.101}
\end{equation*}
$$

Since $V_{\text {out }}=V_{D D}-\left|V_{G S 2}\right|$, the maximum allowable dc level of $V_{\text {in }}$ is equal to $V_{D D}-\left|V_{G S 2}\right|+V_{T H 1}$.
(b) If $V_{i n}=V_{D D}$, then $V_{X}=V_{D D}-V_{G S 3}$. For $M_{1}$ to be saturated when $V_{i n}=V_{D D}$, we must have $V_{D D}-$ $V_{G S 3}-V_{T H 1} \leq V_{D D}-\left|V_{G S 2}\right|$, and hence $V_{G S 3}+V_{T H 1} \geq\left|V_{G S 2}\right|$.

As explained in Chapter 7, source followers also introduce substantial noise. For this reason, the circuit of Fig. 3.47(b) is ill-suited to low-noise applications.

## 3.5 ■ Common-Gate Stage

In common-source amplifiers and source followers, the input signal is applied to the gate of a MOSFET. It is also possible to apply the signal to the source terminal. Shown in Fig. 3.48(a), a common-gate (CG) stage senses the input at the source and produces the output at the drain. The gate is connected to a dc voltage to establish proper operating conditions. Note that the bias current of $M_{1}$ flows through the input signal source. Alternatively, as depicted in Fig. 3.48(b), $M_{1}$ can be biased by a constant current source, with the signal capacitively coupled to the circuit.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-075.jpg?height=407&width=310&top_left_y=1792&top_left_x=557)
(a)
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-075.jpg?height=385&width=367&top_left_y=1787&top_left_x=1000)
(b)

Figure 3.48 (a) Common-gate stage with direct coupling at input; (b) CG stage with capacitive coupling at input.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-076.jpg?height=319&width=690&top_left_y=245&top_left_x=423)

Figure 3.49 Common-gate inputoutput characteristic.

We first study the large-signal behavior of the circuit in Fig. 3.48(a). For simplicity, let us assume that $V_{i n}$ decreases from a large positive value. Also, $\lambda=0$. For $V_{i n} \geq V_{b}-V_{T H}, M_{1}$ is off and $V_{\text {out }}=V_{D D}$. For lower values of $V_{i n}$, we can write

$$
\begin{equation*}
I_{D}=\frac{1}{2} \mu_{n} C_{o x} \frac{W}{L}\left(V_{b}-V_{i n}-V_{T H}\right)^{2} \tag{3.102}
\end{equation*}
$$

if $M_{1}$ is in saturation. As $V_{\text {in }}$ decreases, so does $V_{\text {out }}$, eventually driving $M_{1}$ into the triode region if

$$
\begin{equation*}
V_{D D}-\frac{1}{2} \mu_{n} C_{o x} \frac{W}{L}\left(V_{b}-V_{i n}-V_{T H}\right)^{2} R_{D}=V_{b}-V_{T H} \tag{3.103}
\end{equation*}
$$

The input-output characteristic is shown in Fig. 3.49, illustrating a case in which $M_{1}$ enters the triode region as $V_{i n}$ decreases. In the region where $M_{1}$ is saturated, we can express the output voltage as

$$
\begin{equation*}
V_{\text {out }}=V_{D D}-\frac{1}{2} \mu_{n} C_{o x} \frac{W}{L}\left(V_{b}-V_{\text {in }}-V_{T H}\right)^{2} R_{D} \tag{3.104}
\end{equation*}
$$

obtaining a small-signal gain of

$$
\begin{equation*}
\frac{\partial V_{\text {out }}}{\partial V_{\text {in }}}=-\mu_{n} C_{\text {ox }} \frac{W}{L}\left(V_{b}-V_{\text {in }}-V_{T H}\right)\left(-1-\frac{\partial V_{T H}}{\partial V_{\text {in }}}\right) R_{D} \tag{3.105}
\end{equation*}
$$

Since $\partial V_{T H} / \partial V_{i n}=\partial V_{T H} / \partial V_{S B}=\eta$, we have

$$
\begin{align*}
\frac{\partial V_{\text {out }}}{\partial V_{\text {in }}} & =\mu_{n} C_{o x} \frac{W}{L} R_{D}\left(V_{b}-V_{\text {in }}-V_{T H}\right)(1+\eta)  \tag{3.106}\\
& =g_{m}(1+\eta) R_{D} \tag{3.107}
\end{align*}
$$

Note that the gain is positive. Interestingly, body effect increases the equivalent transconductance of the stage.

For a given bias current and supply voltage (i.e., a given power budget), how do we maximize the voltage gain of a CG stage? We can increase $g_{m}$ by widening the input device, eventually reaching subthreshold operation $\left[g_{m} \approx I_{D} /\left(\xi V_{T}\right)\right.$ (why?), and/or we can increase $R_{D}$ and, inevitably, the dc drop across it. We must bear in mind that the minimum allowable level of $V_{\text {out }}$ in Fig. 3.48(b) is equal to $V_{G S}-V_{T H}+V_{I 1}$, where $V_{I 1}$ denotes the minimum voltage required by $I_{1}$.

#### Example 3.16

(a) Is it possible for $M_{1}$ in Fig. 3.48(a) to remain in saturation for the entire range of $V_{i n}$ from 0 to $V_{D D}$ ?
(b) Is it possible for $M_{1}$ to remain in the triode region for the entire range of $V_{i n}$ from 0 to $V_{D D}$ ?

#### Solution

(a) Yes, it is possible. To so guarantee, we choose $V_{D D}-R_{D} I_{D}>V_{b}-V_{T H}$, where $I_{D}$ denotes the drain current at $V_{\text {in }}=0$.
(b) Yes, it is possible. If $V_{b}>V_{D D}+V_{T H}$, then $M_{1}$ turns on at the edge of the triode region at $V_{i n}=V_{D D}-V_{T H}$ and goes deeper as $V_{i n}$ falls. Of course, this choice of $V_{b}$ is neither practical nor desirable.

The input impedance of the circuit is also important. We note that for $\lambda=0$, the impedance seen at the source of $M_{1}$ in Fig. 3.48(a) is the same as that at the source of $M_{1}$ in Fig. 3.39, namely, $1 /\left(g_{m}+g_{m b}\right)=$ $1 /\left[g_{m}(1+\eta)\right]$. Thus, the body effect decreases the input impedance of the common-gate stage. The relatively low input impedance of the common-gate stage proves useful in some applications.

#### Example 3.17

In Fig. 3.50, transistor $M_{1}$ senses $\Delta V$ and delivers a proportional current to a $50-\Omega$ transmission line. The other end of the line is terminated by a $50-\Omega$ resistor in Fig. 3.50(a) and a common-gate stage in Fig. 3.50(b). Assume $\lambda=\gamma=0$.
(a) Calculate $V_{\text {out }} / V_{\text {in }}$ at low frequencies for both arrangements.
(b) What condition is necessary to minimize wave reflection at node $X$ ?
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-077.jpg?height=469&width=1456&top_left_y=1046&top_left_x=240)

Figure 3.50

#### Solution

(a) For small signals applied to the gate of $M_{1}$, the drain current experiences a change equal to $g_{m 1} \Delta V_{X}$. This current is drawn from $R_{D}$ in Fig. 3.50(a) and $M_{2}$ in Fig. 3.50(b), producing an output voltage swing equal to $-g_{m 1} \Delta V_{X} R_{D}$. Thus, $A_{v}=-g_{m 1} R_{D}$ for both cases.
(b) To minimize reflection at node $X$, the resistance seen at the source of $M_{2}$ must equal $50 \Omega$ and the reactance must be small. Thus, $1 /\left(g_{m 2}+g_{m b 2}\right)=50 \Omega$, which can be ensured by proper sizing and biasing of $M_{2}$. To minimize the capacitances of the transistor, it is desirable to use a small device biased at a large current. (Recall that $g_{m}=\sqrt{2 \mu_{n} C_{o x}(W / L) I_{D}}$.) In addition to higher power dissipation, this remedy also requires a large $V_{G S}$ for $M_{2}$.

The key point in this example is that, while the overall voltage gain in both arrangements equals $-g_{m 1} R_{D}$, the value of $R_{D}$ in Fig. 3.50(b) can be much greater than $50 \Omega$ without introducing reflections at point $X$. Thus, the common-gate circuit can provide a higher voltage gain than that in Fig. 3.50(a).

Now let us study the common-gate topology in a more general case, taking into account both the output impedance of the transistor and the impedance of the signal source. Depicted in Fig. 3.51(a), the circuit can be analyzed with the aid of its equivalent shown in Fig. 3.51(b). Noting that the current flowing
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-078.jpg?height=551&width=290&top_left_y=242&top_left_x=444)
(a)
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-078.jpg?height=400&width=821&top_left_y=366&top_left_x=814)
(b)

Figure 3.51 (a) CG stage with finite transistor output resistance; (b) small-signal equivalent circuit.
through $R_{S}$ is equal to $-V_{\text {out }} / R_{D}$, we have

$$
\begin{equation*}
V_{1}-\frac{V_{\text {out }}}{R_{D}} R_{S}+V_{\text {in }}=0 \tag{3.108}
\end{equation*}
$$

Moreover, since the current through $r_{O}$ is equal to $-V_{\text {out }} / R_{D}-g_{m} V_{1}-g_{m b} V_{1}$, we can write

$$
\begin{equation*}
r_{O}\left(\frac{-V_{\text {out }}}{R_{D}}-g_{m} V_{1}-g_{m b} V_{1}\right)-\frac{V_{\text {out }}}{R_{D}} R_{S}+V_{\text {in }}=V_{\text {out }} \tag{3.109}
\end{equation*}
$$

Upon substitution for $V_{1}$ from (3.108), (3.109) reduces to

$$
\begin{equation*}
r_{O}\left[\frac{-V_{\text {out }}}{R_{D}}-\left(g_{m}+g_{m b}\right)\left(V_{\text {out }} \frac{R_{S}}{R_{D}}-V_{\text {in }}\right)\right]-\frac{V_{\text {out }} R_{S}}{R_{D}}+V_{\text {in }}=V_{\text {out }} \tag{3.110}
\end{equation*}
$$

It follows that

$$
\begin{equation*}
\frac{V_{\text {out }}}{V_{\text {in }}}=\frac{\left(g_{m}+g_{m b}\right) r_{O}+1}{r_{O}+\left(g_{m}+g_{m b}\right) r_{O} R_{S}+R_{S}+R_{D}} R_{D} \tag{3.111}
\end{equation*}
$$

Note the similarity between (3.111) and (3.77). The gain of the common-gate stage is slightly higher due to body effect.

#### Example 3.18

Calculate the voltage gain of the circuit shown in Fig. 3.52(a) if $\lambda \neq 0$ and $\gamma \neq 0$.

#### Solution

We first find the Thevenin equivalent of $M_{1}$ and $V_{i n}$. As shown in Fig. 3.52(b), $M_{1}$ operates as a source follower, the equivalent Thevenin voltage is given by

$$
\begin{equation*}
V_{i n, e q}=\frac{r_{O 1} \| \frac{1}{g_{m b 1}}}{r_{O 1} \| \frac{1}{g_{m b 1}}+\frac{1}{g_{m 1}}} V_{i n} \tag{3.112}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-079.jpg?height=485&width=1461&top_left_y=242&top_left_x=238)

Figure 3.52
and the equivalent Thevenin resistance is

$$
\begin{equation*}
R_{e q}=r_{O 1}\left\|\frac{1}{g_{m b 1}}\right\| \frac{1}{g_{m 1}} \tag{3.113}
\end{equation*}
$$

Redrawing the circuit as in Fig. 3.52(c), we use (3.111) to write

$$
\begin{equation*}
\frac{V_{\text {out }}}{V_{\text {in }}}=\frac{\left(g_{m 2}+g_{m b 2}\right) r_{O 2}+1}{r_{O 2}+\left[1+\left(g_{m 2}+g_{m b 2}\right) r_{O 2}\right]\left(r_{O 1}\left\|\frac{1}{g_{m b 1}}\right\| \frac{1}{g_{m 1}}\right)+R_{D}} R_{D} \frac{r_{O 1} \| \frac{1}{g_{m b 1}}}{r_{O 1} \| \frac{1}{g_{m b 1}}+\frac{1}{g_{m 1}}} \tag{3.114}
\end{equation*}
$$

This example demonstrates the ease with which a circuit can be analyzed by inspection-while relying on previously-derived results-rather than by blindly writing KVLs and KCLs.

The input and output impedances of the common-gate topology are also of interest. To obtain the impedance seen at the source [Fig. 3.53(a)], we use the equivalent circuit in Fig. 3.53(b). Since $V_{1}=-V_{X}$ and the current through $r_{O}$ is equal to $I_{X}+g_{m} V_{1}+g_{m b} V_{1}=I_{X}-\left(g_{m}+g_{m b}\right) V_{X}$, we can add up the voltages across $r_{O}$ and $R_{D}$ and equate the result to

$$
\begin{equation*}
R_{D} I_{X}+r_{O}\left[I_{X}-\left(g_{m}+g_{m b}\right) V_{X}\right]=V_{X} \tag{3.115}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-079.jpg?height=421&width=1077&top_left_y=1821&top_left_x=427)

Figure 3.53 (a) Input resistance of a CG stage; (b) small-signal equivalent circuit.

Thus,

$$
\begin{align*}
\frac{V_{X}}{I_{X}} & =\frac{R_{D}+r_{O}}{1+\left(g_{m}+g_{m b}\right) r_{O}}  \tag{3.116}\\
& \approx \frac{R_{D}}{\left(g_{m}+g_{m b}\right) r_{O}}+\frac{1}{g_{m}+g_{m b}} \tag{3.117}
\end{align*}
$$

if $\left(g_{m}+g_{m b}\right) r_{O} \gg 1$. This result reveals that the drain impedance is divided by $\left(g_{m}+g_{m b}\right) r_{O}$ when seen at the source. This is particularly important in short-channel devices because of their low intrinsic gain. Two special cases of (3.116) are worth studying. First, suppose $R_{D}=0$. Then,

$$
\begin{align*}
\frac{V_{X}}{I_{X}} & =\frac{r_{O}}{1+\left(g_{m}+g_{m b}\right) r_{O}}  \tag{3.118}\\
& =\frac{1}{\frac{1}{r_{O}}+g_{m}+g_{m b}} \tag{3.119}
\end{align*}
$$

which is simply the impedance seen at the source of a source follower, a predictable result because if $R_{D}=0$, the circuit configuration is the same as in Fig. 3.39(a).

Second, let us replace $R_{D}$ with an ideal current source. Equation (3.117) predicts that the input impedance approaches infinity. While somewhat surprising, this result can be explained with the aid of Fig. 3.54. Since the total current through the transistor is fixed and equal to $I_{1}$, a change in the source potential cannot change the device current, and hence $I_{X}=0$. In other words, the input impedance of a common-gate stage is relatively low only if the load impedance connected to the drain is small.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-080.jpg?height=462&width=239&top_left_y=1293&top_left_x=649)

Figure 3.54 Input resistance of a CG stage with ideal current-source load.

#### Example 3.19

Calculate the voltage gain of a common-gate stage with a current-source load [Fig. 3.55(a)].

#### Solution

Letting $R_{D}$ approach infinity in (3.111), we have

$$
\begin{equation*}
A_{v}=\left(g_{m}+g_{m b}\right) r_{O}+1 \tag{3.120}
\end{equation*}
$$

Interestingly, the gain does not depend on $R_{S}$. From our foregoing discussion, we recognize that if $R_{D} \rightarrow \infty$, so does the impedance seen at the source of $M_{1}$, and the small-signal voltage at node $X$ becomes equal to $V_{i n}$. We can therefore simplify the circuit as shown in Fig. 3.55(b), readily arriving at (3.120).
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-081.jpg?height=539&width=767&top_left_y=240&top_left_x=585)

Figure 3.55

Our analysis of the degenerated CS stage and the CG stage gives another interesting insight. As illustrated in Fig. 3.56, we loosely say that a transistor transforms its source resistance $u p$ and its drain resistance down (when seen at the appropriate terminal).
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-081.jpg?height=403&width=998&top_left_y=1079&top_left_x=469)

Figure 3.56 Impedance transformation by a MOSFET.
In order to calculate the output impedance of the common-gate stage, we use the circuit in Fig. 3.57. We note that the result is similar to that in Fig. 3.29, and hence

$$
\begin{equation*}
R_{\text {out }}=\left\{\left[1+\left(g_{m}+g_{m b}\right) r_{O}\right] R_{S}+r_{O}\right\} \| R_{D} \tag{3.121}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-081.jpg?height=488&width=400&top_left_y=1787&top_left_x=499)

Figure 3.57 Calculation of output resistance of a CG stage.

#### Example 3.20

As seen in Example 3.17, the input signal of a common-gate stage may be a current rather than a voltage. Shown in Fig. 3.58 is such an arrangement. Calculate $V_{\text {out }} / I_{\text {in }}$ and the output impedance of the circuit if the input current source exhibits an output impedance equal to $R_{P}$.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-082.jpg?height=387&width=288&top_left_y=452&top_left_x=619)

Figure 3.58

#### Solution

To find $V_{\text {out }} / I_{\text {in }}$, we replace $I_{\text {in }}$ and $R_{P}$ with a Thevenin equivalent and use (3.111) to write

$$
\begin{equation*}
\frac{V_{\text {out }}}{I_{\text {in }}}=\frac{\left(g_{m}+g_{m b}\right) r_{O}+1}{r_{O}+\left(g_{m}+g_{m b}\right) r_{O} R_{P}+R_{P}+R_{D}} R_{D} R_{P} \tag{3.122}
\end{equation*}
$$

The output impedance is simply equal to

$$
\begin{equation*}
R_{\text {out }}=\left\{\left[1+\left(g_{m}+g_{m b}\right) r_{O}\right] R_{P}+r_{O}\right\} \| R_{D} \tag{3.123}
\end{equation*}
$$

## 3.6 ■ Cascode Stage

As mentioned in Example 3.17, the input signal of a common-gate stage may be a current. We also know that a transistor in a common-source arrangement converts a voltage signal to a current signal. The cascade of a CS stage and a CG stage is called a "cascode" ${ }^{4}$ topology, providing many useful properties. Figure 3.59 shows the basic configuration: $M_{1}$ generates a small-signal drain current proportional to the small-signal input voltage, $V_{i n}$, and $M_{2}$ simply routes the current to $R_{D}$. We call $M_{1}$ the input device and $M_{2}$ the cascode device. Note that in this example, $M_{1}$ and $M_{2}$ carry equal bias and signal currents. As we describe the attributes of the circuit in this section, many advantages of the cascode topology over a simple common-source stage become evident. This circuit is also known as the "telescopic" cascode.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-082.jpg?height=434&width=413&top_left_y=1760&top_left_x=562)

Figure 3.59 Cascode stage.

[^13]Before delving into our analysis, it is instructive to explore the circuit qualitatively. We wish to know what happens if the value of $V_{i n}$ or $V_{b}$ changes by a small amount. Assume that both transistors are in saturation and $\lambda=\gamma=0$. If $V_{i n}$ rises by $\Delta V$, then $I_{D 1}$ increases by $g_{m 1} \Delta V$. This change in current flows through the impedance seen at $X$, i.e., the impedance seen at the source of $M_{2}$, which is equal to $1 / g_{m 2}$. Thus, $V_{X}$ falls by an amount given by $g_{m 1} \Delta V \cdot\left(1 / g_{m 2}\right)$ [Fig. 3.60(a)]. The change in $I_{D 1}$ also flows through $R_{D}$, producing a drop of $g_{m 1} \Delta V R_{D}$ in $V_{\text {out }}$ — just as in a simple CS stage.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-083.jpg?height=549&width=1372&top_left_y=512&top_left_x=277)

Figure 3.60 Cascode stage sensing a signal at the gate of (a) an input device and (b) a cascode device.
Now, consider the case where $V_{i n}$ is fixed and $V_{b}$ increases by $\Delta V$. Since $V_{G S 1}$ is constant and $r_{O 1}=\infty$, we simplify the circuit as shown in Fig. 3.60(b). How do $V_{X}$ and $V_{\text {out }}$ change here? As far as node $X$ is concerned, $M_{2}$ operates as a source follower because it senses an input, $\Delta V$, at its gate and generates an output at $X$. With $\lambda=\gamma=0$, the small-signal voltage gain of the follower is equal to unity, regardless of the value of $R_{D}$ (why?). Thus, $V_{X}$ rises by $\Delta V$. On the other hand, $V_{\text {out }}$ does not change because $I_{D 2}$ is equal to $I_{D 1}$ and hence remains constant. We say that the voltage gain from $V_{b}$ to $V_{o u t}$ is zero in this case.

Let us now study the bias conditions of the cascode, still assuming that $\lambda=\gamma=0$. For $M_{1}$ to operate in saturation, we must have $V_{X} \geq V_{i n}-V_{T H 1}$. If $M_{1}$ and $M_{2}$ are both in saturation, $M_{2}$ operates as a source follower and $V_{X}$ is determined primarily by $V_{b}: V_{X}=V_{b}-V_{G S 2}$. Thus, $V_{b}-V_{G S 2} \geq V_{i n}-V_{T H 1}$, and hence $V_{b}>V_{i n}+V_{G S 2}-V_{T H 1}$ (Fig. 3.61). For $M_{2}$ to be saturated, $V_{\text {out }} \geq V_{b}-V_{T H 2}$; that is,

$$
\begin{align*}
V_{\text {out }} & \geq V_{\text {in }}-V_{T H 1}+V_{G S 2}-V_{T H 2}  \tag{3.124}\\
& =\left(V_{G S 1}-V_{T H 1}\right)+\left(V_{G S 2}-V_{T H 2}\right) \tag{3.125}
\end{align*}
$$

![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-083.jpg?height=480&width=373&top_left_y=1804&top_left_x=505)

Figure 3.61 Allowable voltages in cascode stage.
if $V_{b}$ is chosen to place $M_{1}$ at the edge of saturation. Consequently, the minimum output level for which both transistors operate in saturation is equal to the overdrive voltage of $M_{1}$ plus that of $M_{2}$. In other words, addition of $M_{2}$ to the circuit reduces the output voltage swing by at least the overdrive voltage of $M_{2}$. We say that $M_{2}$ is "stacked" on top of $M_{1}$. We also loosely say that the minimum output voltage is equal to two overdrives or $2 V_{D, s a t}$.

We now analyze the large-signal behavior of the cascode stage shown in Fig. 3.59 as $V_{\text {in }}$ goes from zero to $V_{D D}$. For $V_{\text {in }} \leq V_{T H 1}, M_{1}$ and $M_{2}$ are off, $V_{o u t}=V_{D D}$, and $V_{X} \approx V_{b}-V_{T H 2}$ (if subthreshold conduction is neglected) (Fig. 3.62). As $V_{\text {in }}$ exceeds $V_{T H 1}, M_{1}$ begins to draw current, and $V_{\text {out }}$ drops. Since $I_{D 2}$ increases, $V_{G S 2}$ must increase as well, causing $V_{X}$ to fall. As $V_{i n}$ assumes sufficiently large values, two effects can occur: (1) $V_{X}$ drops below $V_{i n}$ by $V_{T H 1}$, forcing $M_{1}$ into the triode region; (2) $V_{o u t}$ drops below $V_{b}$ by $V_{T H 2}$, driving $M_{2}$ into the triode region. Depending on the device dimensions and the values of $R_{D}$ and $V_{b}$, one effect may occur before the other. For example, if $V_{b}$ is relatively low, $M_{1}$ may enter the triode region first. Note that if $M_{2}$ goes into the deep triode region, $V_{X}$ and $V_{\text {out }}$ become nearly equal.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-084.jpg?height=314&width=508&top_left_y=860&top_left_x=512)

Figure 3.62 Input-output
characteristic of a cascode stage.
Let us now consider the small-signal characteristics of a cascode stage, assuming that both transistors operate in saturation. If $\lambda=0$, the voltage gain is equal to that of a common-source stage because the drain current produced by the input device must flow through the cascode device. Illustrated in the equivalent circuit of Fig. 3.63, this result is independent of the transconductance and body effect of $M_{2}$. It can also be verified using $A_{v}=-G_{m} R_{\text {out }}$.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-084.jpg?height=368&width=792&top_left_y=1450&top_left_x=639)

Figure 3.63 Small-signal equivalent circuit of cascode stage.

#### Example 3.21

Calculate the voltage gain of the circuit shown in Fig. 3.64 if $\lambda=0$.

#### Solution

The small-signal drain current of $M_{1}, g_{m 1} V_{i n}$, is divided between $R_{P}$ and the impedance seen looking into the source of $M_{2}, 1 /\left(g_{m 2}+g_{m b 2}\right)$. Thus, the current flowing through $M_{2}$ is

$$
\begin{equation*}
I_{D 2}=g_{m 1} V_{i n} \frac{\left(g_{m 2}+g_{m b 2}\right) R_{P}}{1+\left(g_{m 2}+g_{m b 2}\right) R_{P}} \tag{3.126}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-085.jpg?height=470&width=339&top_left_y=226&top_left_x=535)

Figure 3.64

The voltage gain is therefore given by

$$
\begin{equation*}
A_{v}=-\frac{g_{m 1}\left(g_{m 2}+g_{m b 2}\right) R_{P} R_{D}}{1+\left(g_{m 2}+g_{m b 2}\right) R_{P}} \tag{3.127}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-085.jpg?height=364&width=649&top_left_y=991&top_left_x=370)

Figure 3.65 Calculation of output resistance of cascode stage.

Output Resistance An important property of the cascode structure is its high output impedance. As illustrated in Fig. 3.65, for calculation of $R_{\text {out }}$, the circuit can be viewed as a common-source stage with a degeneration resistor equal to $r_{O 1}$. Thus, from (3.66),

$$
\begin{equation*}
R_{o u t}=\left[1+\left(g_{m 2}+g_{m b 2}\right) r_{O 2}\right] r_{O 1}+r_{O 2} \tag{3.128}
\end{equation*}
$$

Assuming $g_{m} r_{O} \gg 1$, we have $R_{\text {out }} \approx\left(g_{m 2}+g_{m b 2}\right) r_{O 2} r_{O 1}$. That is, $M_{2}$ boosts the output impedance of $M_{1}$ by a factor of $\left(g_{m 2}+g_{m b 2}\right) r_{O 2}$. As shown in Fig. 3.66, cascoding can be extended to three or more stacked devices to achieve a higher output impedance, but the required additional voltage
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-085.jpg?height=403&width=321&top_left_y=1876&top_left_x=539)

Figure 3.66 Triple cascode.

#### Nanometer Design Notes

With a limited voltage headroom, nanometer cascode current sources are only moderately better than single transistors. The figure shows the I-V characteristic of an NMOS current source before and after cascoding (gray and black curves, respectively). Here, $W / L=5 \mu \mathrm{~m} / 40 \mathrm{~nm}$ for both devices. We observe that for $V_{X}<0.2 \mathrm{~V}$, the cascode has only a slightly higher output impedance.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-085.jpg?height=347&width=436&top_left_y=1901&top_left_x=1393)
headroom makes such configurations less attractive. For example, the minimum output voltage of a triple cascode is equal to the sum of three overdrive voltages.

To appreciate the utility of a high output impedance, recall from the lemma in Sec. 3.3.3 that the voltage gain can be written as $-G_{m} R_{\text {out }}$. Since $G_{m}$ is typically determined by the transconductance of a transistor, e.g., $M_{1}$ in Fig. 3.59, and hence bears trade-offs with the bias current and device capacitances, it is desirable to increase the voltage gain by maximizing $R_{\text {out }}$. Shown in Fig. 3.67 is an example. If both $M_{1}$ and $M_{2}$ operate in saturation, then $G_{m} \approx g_{m 1}$ and $R_{\text {out }} \approx\left(g_{m 2}+g_{m b 2}\right) r_{O 2} r_{O 1}$, yielding $A_{v}=\left(g_{m 2}+g_{m b 2}\right) r_{O 2} g_{m 1} r_{O 1}$. Thus, the maximum voltage gain is roughly equal to the square of the intrinsic gain of the transistors.

#### Example 3.22

Calculate the exact voltage gain of the circuit shown in Fig. 3.67.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-086.jpg?height=403&width=293&top_left_y=797&top_left_x=619)

Figure 3.67 Cascode stage with current-source load.

#### Solution

The actual $G_{m}$ of the stage is slightly less than $g_{m 1}$ because a fraction of the small-signal current produced by $M_{1}$ is shunted to ground by $r_{O 1}$. As depicted in Fig. 3.68(a), we short the output node to ac ground and recognize that the impedance seen looking into the source of $M_{2}$ is equal to $\left[1 /\left(g_{m 2}+g_{m b 2}\right)\right] \mid r_{O 2}$. Thus,

$$
\begin{equation*}
I_{\text {out }}=g_{m 1} V_{\text {in }} \frac{r_{O 1}}{r_{O 1}+\frac{1}{g_{m 2}+g_{m b 2}} \| r_{O 2}} \tag{3.129}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-086.jpg?height=624&width=844&top_left_y=1614&top_left_x=613)

Figure 3.68

It follows that the overall transconductance is equal to

$$
\begin{equation*}
G_{m}=\frac{g_{m 1} r_{O 1}\left[r_{O 2}\left(g_{m 2}+g_{m b 2}\right)+1\right]}{r_{O 1} r_{O 2}\left(g_{m 2}+g_{m b 2}\right)+r_{O 1}+r_{O 2}} \tag{3.130}
\end{equation*}
$$

and hence the voltage gain is given by

$$
\begin{align*}
\left|A_{v}\right| & =G_{m} R_{\text {out }}  \tag{3.131}\\
& =g_{m 1} r_{O 1}\left[\left(g_{m 2}+g_{m b 2}\right) r_{O 2}+1\right] \tag{3.132}
\end{align*}
$$

If we had assumed that $G_{m} \approx g_{m 1}$, then $\left|A_{v}\right| \approx g_{m 1}\left\{\left[1+\left(g_{m 2}+g_{m b 2}\right) r_{O 2}\right] r_{O 1}+r_{O 2}\right\}$.
Another approach to calculating the voltage gain is to replace $V_{i n}$ and $M_{1}$ by a Thevenin equivalent, reducing the circuit to a common-gate stage. Illustrated in Fig. 3.68(b), this method in conjunction with (3.111) gives the same result as (3.132).

It is also interesting to compare the increase in the output impedance due to cascoding with that due to increasing the length of the input transistor for a given bias current (Fig. 3.69). Suppose, for example, that the length of the input transistor of a CS stage is quadrupled while the width remains constant. Then, since $I_{D}=(1 / 2) \mu_{n} C_{o x}(W / L)\left(V_{G S}-V_{T H}\right)^{2}$, the overdrive voltage is doubled, and the transistor consumes the same amount of voltage headroom as does a cascode stage. That is, the circuits of Figs. 3.69(b) and (c) impose equal voltage swing constraints.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-087.jpg?height=429&width=875&top_left_y=1056&top_left_x=528)

Figure 3.69 Increasing output impedance by increasing the device length or cascoding.
Now consider the output impedance achieved in each case. Since

$$
\begin{equation*}
g_{m} r_{O}=\sqrt{2 \mu_{n} C_{o x} \frac{W}{L} I_{D}} \frac{1}{\lambda I_{D}} \tag{3.133}
\end{equation*}
$$

and $\lambda \propto 1 / L$, quadrupling $L$ only doubles the value of $g_{m} r_{O}$ while cascoding results in an output impedance of roughly $g_{m} r_{O}^{2}$. Note that the transconductance of $M_{1}$ in Fig. 3.69(b) is half that in Fig. 3.69(c), degrading the performance. In other words, for a given voltage headroom, the cascode structure provides a higher output impedance.

A cascode structure need not operate as an amplifier. Another popular application of this topology is in building constant current sources. The high output impedance yields a current source closer to the ideal, but at the cost of voltage headroom. For example, current source $I_{1}$ in Fig. 3.67 can be implemented as a PMOS cascode (Fig. 3.70), exhibiting an impedance equal to $\left[1+\left(g_{m 3}+g_{m b 3}\right) r_{O 3}\right] r_{O 4}+r_{O 3}$.

We calculate the voltage gain with the aid of the lemma illustrated in Fig. 3.32. Writing $G_{m} \approx g_{m 1}$, we note that $R_{\text {out }}$ is now equal to the parallel combination of the NMOS cascode output impedance and the PMOS cascode output impedance:

$$
\begin{equation*}
R_{\text {out }}=\left\{\left[1+\left(g_{m 2}+g_{m b 2}\right) r_{O 2}\right] r_{O 1}+r_{O 2}\right\} \|\left\{\left[1+\left(g_{m 3}+g_{m b 3}\right) r_{O 3}\right] r_{O 4}+r_{O 3}\right\} \tag{3.134}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-088.jpg?height=492&width=367&top_left_y=243&top_left_x=585)

Figure 3.70 NMOS cascode amplifier with PMOS cascode load.

The gain is given by $\left|A_{v}\right| \approx g_{m 1} R_{\text {out }}$. For typical values, we approximate the voltage gain as

$$
\begin{equation*}
\left|A_{v}\right| \approx g_{m 1}\left[\left(g_{m 2} r_{O 2} r_{O 1}\right) \|\left(g_{m 3} r_{O 3} r_{O 4}\right)\right] \tag{3.135}
\end{equation*}
$$

#### Example 3.23

How much voltage swing can the cascode amplifier of Fig. 3.70 support at the output?

#### Solution

Recall from Fig. 3.61 that $V_{b 1}$ can be chosen low enough to place $M_{1}$ at the edge of saturation, $V_{b 1}=V_{G S 2}+$ $\left(V_{G S 1}-V_{T H 1}\right)$, allowing a minimum value of $\left(V_{G S 2}-V_{T H 2}\right)+\left(V_{G S 1}-V_{T H 1}\right)$ for $V_{\text {out }}$. Similarly, $V_{b 2}$ can be chosen high enough to bias $M_{4}$ at the edge of saturation: $V_{b 2}+\left|V_{G S 3}\right|=V_{D D}-\left|V_{G S 4}-V_{T H 4}\right|$. This choice allows a maximum value of $V_{D D}-\left|V_{G S 4}-V_{T H 4}\right|-\left|V_{G S 3}-V_{T H 3}\right|$ for $V_{\text {out }}$. Thus, the total allowable voltage swing at the output is equal to
$V_{\text {out }, \text { max }}-V_{\text {out }, \text { min }}=V_{D D}-\left(V_{G S 1}-V_{T H 1}\right)-\left(V_{G S 2}-V_{T H 2}\right)-\left|V_{G S 3}-V_{T H 3}\right|-\left|V_{G S 4}-V_{T H 4}\right|$

We loosely say that the output swing is equal to $V_{D D}$ minus four overdrives or $4 V_{D, \text { sat }}$.

We should caution the reader that the dc value at the output of the cascode amplifier shown in Fig. 3.70 is poorly defined because two possibly unequal high-impedance current sources are placed in series. (What happens if two unequal ideal current sources appear in series?) For this reason, the circuit must be biased in a negative-feedback loop.

Poor Man's Cascode A "minimalist" cascode current source omits the bias voltage necessary for the cascode device. Shown in Fig. 3.71, this "poor man's cascode" places $M_{2}$ in the triode region because $V_{G S 1}>V_{T H 1}$ and $V_{D S 2}=V_{G S 2}-V_{G S 1}<V_{G S 2}-V_{T H 2}$. In fact, if $M_{1}$ and $M_{2}$ have identical dimensions, it can be proved that the structure is equivalent to a single transistor having twice the length—not really a cascode.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-088.jpg?height=285&width=235&top_left_y=2004&top_left_x=656)

Figure 3.71 Poor man's cascode.

In modern CMOS technologies, however, transistors with different threshold voltages are available, allowing $M_{2}$ to operate in saturation if $M_{1}$ has a lower threshold than $M_{2}$. For example, if $V_{T H 2}-V_{T H 1}=$ 150 mV and if $V_{G S 1}-V_{T H 1}<100 \mathrm{mV}$, then $M_{2}$ is saturated and the circuit acts as a true cascode.

Shielding Property Recall from Fig. 3.30 that the high output impedance arises from the fact that if the output-node voltage is changed by $\Delta V$, the resulting change at the source of the cascode device is much less. In a sense, the cascode transistor "shields" the input device from voltage variations at the output. The shielding property of cascodes proves useful in many circuits.

#### Example 3.24

Two identical NMOS transistors are used as constant current sources in a system [Fig. 3.72(a)]. However, due to the internal circuitry of the system, $V_{X}$ is higher than $V_{Y}$ by $\Delta V$.
(a) Calculate the resulting difference between $I_{D 1}$ and $I_{D 2}$ if $\lambda \neq 0$.
(b) Add cascode devices to $M_{1}$ and $M_{2}$ and repeat part (a).
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-089.jpg?height=554&width=926&top_left_y=817&top_left_x=505)

Figure 3.72

#### Solution

(a) We have

$$
\begin{align*}
I_{D 1}-I_{D 2} & =\frac{1}{2} \mu_{n} C_{o x} \frac{W}{L}\left(V_{b}-V_{T H}\right)^{2}\left(\lambda V_{D S 1}-\lambda V_{D S 2}\right)  \tag{3.137}\\
& =\frac{1}{2} \mu_{n} C_{o x} \frac{W}{L}\left(V_{b}-V_{T H}\right)^{2}(\lambda \Delta V) \tag{3.138}
\end{align*}
$$

(b) As shown in Fig. 3.72(b), cascoding reduces the effect of $V_{X}$ and $V_{Y}$ upon $I_{D 1}$ and $I_{D 2}$, respectively. As depicted in Fig. 3.30 and implied by Eq. (3.69), a difference $\Delta V$ between $V_{X}$ and $V_{Y}$ translates to a difference $\Delta V_{P Q}$ between $P$ and $Q$ equal to

$$
\begin{align*}
\Delta V_{P Q} & =\Delta V \frac{r_{O 1}}{\left[1+\left(g_{m 3}+g_{m b 3}\right) r_{O 3}\right] r_{O 1}+r_{O 3}}  \tag{3.139}\\
& \approx \frac{\Delta V}{\left(g_{m 3}+g_{m b 3}\right) r_{O 3}} \tag{3.140}
\end{align*}
$$

Thus,

$$
\begin{equation*}
I_{D 1}-I_{D 2}=\frac{1}{2} \mu_{n} C_{o x} \frac{W}{L}\left(V_{b}-V_{T H}\right)^{2} \frac{\lambda \Delta V}{\left(g_{m 3}+g_{m b 3}\right) r_{O 3}} \tag{3.141}
\end{equation*}
$$

In other words, cascoding reduces the mismatch between $I_{D 1}$ and $I_{D 2}$ by a factor of $\left(g_{m 3}+g_{m b 3}\right) r_{O 3}$.

#### Nanometer Design Notes

Let us implement a cascode stage with $(W / L)$ NMOS $=10 \mu \mathrm{~m} / 40 \mathrm{~nm}$, $(W / L)$ PMOS $=20 \mu \mathrm{~m} / 40 \mathrm{~nm}$, and $I_{D}=$ 0.3 mA . The figure plots the input-output characteristic of the circuit, displaying nonlinearity at the extremes of $V_{\text {out }}$. How do we quantify this nonlinearity? We can say that the output swing should not cause, say, more than a 20\% drop in the small-signal voltage gain. Plotting the derivative of the characteristic in the figure, we observe that the allowable single-ended peak-to-peak output swing is about 0.5 V if the gain must remain greater than 10. We also note that the gain is fairly low, dictating longer PMOS devices if a higher gain is necessary.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-090.jpg?height=344&width=457&top_left_y=924&top_left_x=161)
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-090.jpg?height=403&width=519&top_left_y=1269&top_left_x=135)

The shielding property of cascodes diminishes if the cascode device enters the triode region. To understand why, let us consider the circuit in Fig. 3.73, assuming that $V_{X}$ decreases from a large positive value. As $V_{X}$ falls below $V_{b 2}-V_{T H 2}, M_{2}$ enters the triode region and requires a greater gate-source overdrive so as to sustain the current drawn by $M_{1}$. We can write

$$
\begin{equation*}
I_{D 2}=\frac{1}{2} \mu_{n} C_{o x}\left(\frac{W}{L}\right)_{2}\left[2\left(V_{b 2}-V_{P}-V_{T H 2}\right)\left(V_{X}-V_{P}\right)-\left(V_{X}-V_{P}\right)^{2}\right] \tag{3.142}
\end{equation*}
$$

concluding that as $V_{X}$ decreases, $V_{P}$ also drops, so that $I_{D 2}$ remains constant. In other words, variation of $V_{X}$ is less attenuated as it appears at $P$. If $V_{X}$ falls sufficiently, $V_{P}$ goes below $V_{b 1}-V_{T H 1}$, driving $M_{1}$ into the triode region.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-090.jpg?height=308&width=372&top_left_y=737&top_left_x=828)

Figure 3.73 Output swing of cascode stage.

### 3.6.1 Folded Cascode

The idea behind the cascode structure is to convert the input voltage to a current and apply the result to a common-gate stage. However, the input device and the cascode device need not be of the same type. For example, as depicted in Fig. 3.74(a), a PMOS-NMOS combination performs the same function. In order to bias $M_{1}$ and $M_{2}$, a current source must be added as in Fig. 3.74(b). Note that $\left|I_{D 1}\right|+I_{D 2}$ is equal to $I_{1}$ and hence constant. The small-signal operation is as follows. If $V_{i n}$ becomes more positive, $\left|I_{D 1}\right|$ decreases, forcing $I_{D 2}$ to increase and hence $V_{\text {out }}$ to drop. The voltage gain and output impedance of the circuit can be obtained as calculated for the NMOS-NMOS cascode of Fig. 3.59. Shown in Fig. 3.74(c) is an NMOS-PMOS cascode. The advantages and disadvantages of these types will be explained later.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-090.jpg?height=493&width=1376&top_left_y=1718&top_left_x=347)

Figure 3.74 (a) Simple folded cascode; (b) folded cascode with proper biasing; (c) folded cascode with NMOS input.

The structures of Figs. 3.74(b) and (c) are called "folded cascode" stages because the small-signal current is "folded" up [in Fig. 3.74(b)] or down [in Fig. 3.74(c)]. We should mention as a point of contrast that the bias current of $M_{1}$ in Fig. 3.70 flows through $M_{2}$, i.e., it is "reused," whereas those of $M_{1}$ and $M_{2}$ in Fig. 3.74(b) add up to $I_{1}$. Thus, the total bias current in this case must be higher than that in Fig. 3.70 to achieve a comparable performance.

It is instructive to examine the large-signal behavior of a folded-cascode stage. Suppose that in Fig. 3.74(b), $V_{i n}$ decreases from $V_{D D}$ to zero. For $V_{i n}>V_{D D}-\left|V_{T H 1}\right|, M_{1}$ is off and $M_{2}$ carries all of $I_{1}{ }^{5}$ yielding $V_{\text {out }}=V_{D D}-I_{1} R_{D}$. For $V_{\text {in }}<V_{D D}-\left|V_{T H 1}\right|, M_{1}$ turns on in saturation, giving

$$
\begin{equation*}
I_{D 2}=I_{1}-\frac{1}{2} \mu_{p} C_{o x}\left(\frac{W}{L}\right)_{1}\left(V_{D D}-V_{i n}-\left|V_{T H 1}\right|\right)^{2} \tag{3.143}
\end{equation*}
$$

As $V_{i n}$ drops, $I_{D 2}$ decreases further, falling to zero if $I_{D 1}=I_{1}$. This occurs at $V_{i n}=V_{i n 1}$ if

$$
\begin{equation*}
\frac{1}{2} \mu_{p} C_{o x}\left(\frac{W}{L}\right)_{1}\left(V_{D D}-V_{i n 1}-\left|V_{T H 1}\right|\right)^{2}=I_{1} \tag{3.144}
\end{equation*}
$$

Thus,

$$
\begin{equation*}
V_{i n 1}=V_{D D}-\sqrt{\frac{2 I_{1}}{\mu_{p} C_{o x}(W / L)_{1}}}-\left|V_{T H 1}\right| \tag{3.145}
\end{equation*}
$$

If $V_{i n}$ falls below this level, $I_{D 1}$ tends to be greater than $I_{1}$, and $M_{1}$ enters the triode region so as to ensure $I_{D 1}=I_{1}$. The result is plotted in Fig. 3.75. The reader is encouraged to determine the input voltage at which $\left|I_{D 1}\right|=I_{D 2}$.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-091.jpg?height=321&width=570&top_left_y=1312&top_left_x=427)
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-091.jpg?height=324&width=421&top_left_y=1313&top_left_x=1080)

Figure 3.75 Large-signal characteristics of folded cascode.

What happens to $V_{X}$ in the above test? As $I_{D 2}$ drops, $V_{X}$ rises, reaching $V_{b}-V_{T H 2}$ for $I_{D 2}=0$. As $M_{1}$ enters the triode region, $V_{X}$ approaches $V_{D D}$.

#### Example 3.25

Calculate the output impedance of the folded cascode shown in Fig. 3.76(a), where $M_{3}$ operates as the bias current source.

#### Solution

Using the simplified model in Fig. 3.76(b) and Eq. (3.66), we have

$$
\begin{equation*}
R_{\text {out }}=\left[1+\left(g_{m 2}+g_{m b 2}\right) r_{O 2}\right]\left(r_{O 1} \| r_{O 3}\right)+r_{O 2} \tag{3.146}
\end{equation*}
$$

[^14]![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-092.jpg?height=426&width=863&top_left_y=225&top_left_x=608)

Figure 3.76

Thus, the circuit exhibits an output impedance lower than that of a nonfolded (also called "telescopic") cascode.

In order to achieve a high voltage gain, the load of a folded cascode can be implemented as a cascode itself (Fig. 3.77). This structure is studied more extensively in Chapter 9.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-092.jpg?height=590&width=516&top_left_y=983&top_left_x=510)

Figure 3.77 Folded cascode with cascode load.

Throughout this chapter, we have attempted to increase the output resistance of voltage amplifiers so as to obtain a high gain. This may seem to make the speed of the circuit quite susceptible to the load capacitance. However, as explained in Chapter 8, a high output impedance per se does not pose a serious issue if the amplifier is placed in a proper feedback loop.

## 3.7 ■ Choice of Device Models

In this chapter, we have developed various expressions for the properties of single-stage amplifiers. For example, the voltage gain of a degenerated common-source stage can be as simple as $-R_{D} /\left(R_{S}+g_{m}^{-1}\right)$ or as complex as Eq. (3.77). How does one choose a sufficiently accurate device model or expression?

The proper choice is not always straightforward, and making it is a skill gained through practice, experience, and intuition. However, some general principles in choosing the model for each transistor can be followed. First, break the circuit down into a number of familiar topologies. Next, concentrate on each subcircuit and use the simplest transistor model (a single voltage-dependent current source for

FETs operating in saturation) for all transistors. If the drain of a device is connected to a high impedance (e.g., the drain of another), then add $r_{O}$ to its model. At this point, the basic properties of most circuits can be determined by inspection. In a second, more accurate iteration, the body effect of devices whose source or bulk is not at ac ground can be included as well.

For bias calculations, it is usually adequate to neglect channel-length modulation and body effect in the first pass. These effects do introduce some error, but they can be included in the next iteration step—after the basic properties are understood.

In today's analog design, simulation of circuits is essential because the behavior of short-channel MOSFETs cannot be predicted accurately by hand calculations. Nonetheless, if the designer avoids a simple and intuitive analysis of the circuit and hence skips the task of gaining insight, then he/she cannot interpret the simulation results intelligently. For this reason, we say, "Don't let the computer think for you." Some say, "Don't be a SPICE monkey."
