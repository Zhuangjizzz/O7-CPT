# CHAPTER 7 Noise

Noise limits the minimum signal level that a circuit can process with acceptable quality. Today's analog designers constantly deal with the problem of noise because it trades with power dissipation, speed, and linearity.

In this chapter, we describe the phenomenon of noise and its effect on analog circuits. The objective is to provide sufficient understanding of the problem so that further developments of analog circuits in the following chapters take noise into account as naturally as they do other circuit parameters, such as gain, input and output impedances, etc. Seemingly a complex subject, noise is introduced at this early stage so as to accompany the reader for the remainder of the book and become more intuitive through various examples.

Following a general description of noise characteristics in the frequency and time domains, we introduce thermal and flicker noise. Next, we consider methods of representing noise in circuits. Finally, we describe the effect of noise in single-stage and differential amplifiers along with trade-offs with other performance parameters.

## 7.1 ■ Statistical Characteristics of Noise

Noise is a random process. For our purposes in this book, this statement means that the value of noise cannot be predicted at any time even if the past values are known. Compare the output of a sine-wave generator with that of a microphone picking up the sound of water flow in a river (Fig. 7.1). While the value of $x_{1}(t)$ at $t=t_{1}$ can be predicted from the observed waveform, the value of $x_{2}(t)$ at $t=t_{2}$ cannot. This is the principal difference between deterministic and random phenomena.

If the instantaneous value of noise in the time domain cannot be predicted, how can we incorporate noise in circuit analysis? This is accomplished by observing the noise for a long time and using the measured results to construct a "statistical model" for the noise. While the instantaneous amplitude of noise cannot be predicted, a statistical model provides knowledge about some other important properties of the noise that prove useful and adequate in circuit analysis.

Which properties of noise can be predicted? In many cases, the average power of noise is predictable. For example, if a microphone picking up the sound of a river is brought closer to the river, the resulting electrical signal displays, on the average, larger excursions and hence higher power (Fig. 7.2). The reader may wonder if a random process can be so random that even its average power is unpredictable. Such processes do exist, but we are fortunate that most sources of noise in circuits exhibit a constant average power.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-220.jpg?height=619&width=877&top_left_y=236&top_left_x=591)

Figure 7.1 (a) The output of a generator, and (b) the sound of a river.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-220.jpg?height=767&width=872&top_left_y=938&top_left_x=599)

Figure 7.2 Illustration of the average power of a random signal.

The concept of average power proves essential in our analysis and must be defined carefully. Recall from basic circuit theory that the average power delivered by a periodic voltage $v(t)$ to a load resistance $R_{L}$ is given by

$$
\begin{equation*}
P_{a v}=\frac{1}{T} \int_{-T / 2}^{+T / 2} \frac{v^{2}(t)}{R_{L}} d t \tag{7.1}
\end{equation*}
$$

where $T$ denotes the period. ${ }^{1}$ Measured in watts, this quantity can be visualized as the average heat produced in $R_{L}$ by $v(t)$.

[^33]How do we define $P_{a v}$ for a random signal? In the example of Fig. 7.2, we expect that $x_{B}(t)$ generates more heat than $x_{A}(t)$ if the microphone drives a resistive load. However, since the signals are not periodic, the measurement must be carried out over a long time:

$$
\begin{equation*}
P_{a v}=\lim _{T \rightarrow \infty} \frac{1}{T} \int_{-T / 2}^{+T / 2} \frac{x^{2}(t)}{R_{L}} d t \tag{7.2}
\end{equation*}
$$

where $x(t)$ is a voltage quantity. Figure 7.3 illustrates the operation on $x(t)$ : the signal is squared, the area under the resulting waveform is calculated for a long time $T$, and the average power is obtained by normalizing the area to $T .^{2}$
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-221.jpg?height=231&width=995&top_left_y=681&top_left_x=468)

Figure 7.3 Average noise power.
To simplify calculations, we write the definition of $P_{a v}$ as

$$
\begin{equation*}
P_{a v}=\lim _{T \rightarrow \infty} \frac{1}{T} \int_{-T / 2}^{+T / 2} x^{2}(t) d t \tag{7.3}
\end{equation*}
$$

where $P_{a v}$ is expressed in $\mathrm{V}^{2}$ rather than W . The idea is that if we know $P_{a v}$ from (7.3), then the actual power delivered to a load $R_{L}$ can be readily calculated as $P_{a v} / R_{L}$. In analogy with deterministic signals, we can also define a root-mean-square (rms) voltage for noise as $\sqrt{P_{a v}}$, where $P_{a v}$ is given by (7.3).

### 7.1.1 Noise Spectrum

The concept of average power becomes more versatile if defined with regard to the frequency content of noise. The noise made by a group of men contains weaker high-frequency components than that made by a group of women, a difference observable from the "spectrum" of each type of noise. Also called the "power spectral density" (PSD), the spectrum shows how much power the signal carries at each frequency. More specifically, the PSD, $S_{x}(f)$, of a noise waveform $x(t)$ is defined as the average power carried by $x(t)$ in a one-hertz bandwidth around $f$. That is, as illustrated in Fig. 7.4(a), we apply $x(t)$ to a bandpass filter with a center frequency of $f_{1}$ and a $1-\mathrm{Hz}$ bandwidth, square the output, $x_{f 1}(t)$, and calculate the average over a long time to obtain $S_{x}\left(f_{1}\right)$. Repeating the procedure with bandpass filters having different center frequencies, we arrive at the overall shape of $S_{x}(f)$ [Fig. 7.4(b)]. ${ }^{3}$ Generally, $S_{x}(f)$ is measured in watts per hertz. The total area under $S_{x}(f)$ represents the power carried by the signal (or the noise) at all frequencies; i.e., the total power.

#### Example 7.1

(a) Sketch the spectrum of voice for men and women. What does the difference imply about their time-domain waveforms?
(b) Estimate the averaging time, $T$, in Eq. (7.3) for voice signals.

[^34]![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-222.jpg?height=869&width=1328&top_left_y=242&top_left_x=371)

Figure 7.4 Calculation of noise spectrum.

#### Solution

(a) The human voice exhibits frequencies from 20 Hz to 20 kHz . Since women's voice contain stronger highfrequency components, we expect the two spectra to differ as shown in Fig. 7.5(a). In the time domain, we observe faster changes in women's voice [Fig. 7.5(b)].
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-222.jpg?height=316&width=737&top_left_y=1497&top_left_x=697)
(a)
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-222.jpg?height=321&width=687&top_left_y=1894&top_left_x=317)
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-222.jpg?height=386&width=687&top_left_y=1892&top_left_x=1064)
(b)

Figure 7.5 (a) Spectra of men's and women's voices, and (b) corresponding time-domain waveforms.
(b) The averaging time must be long enough to include a sufficient number of cycles of the lowest frequencies. That is, the averaging must capture the slowest dynamics in the signal. We must therefore choose $T$ to be at least about 10 cycles of 20 Hz , i.e., roughly 500 ms .

As with the definition of $P_{a v}$ in (7.3), it is customary to eliminate $R_{L}$ from $S_{x}(f)$. Thus, since each value on the plot in Fig. 7.4(b) is measured for a 1-Hz bandwidth, $S_{x}(f)$ is expressed in $\mathrm{V}^{2} / \mathrm{Hz}$ rather than W/Hz. It is also common to take the square root of $S_{x}(f)$, expressing the result in $\mathrm{V} / \sqrt{\mathrm{Hz}}$. For example, we say that the input noise voltage of an amplifier at 100 MHz is equal to $3 \mathrm{nV} / \sqrt{\mathrm{Hz}}$, simply to mean that the average power in a 1-Hz bandwidth at 100 MHz is equal to $\left(3 \times 10^{-9}\right)^{2} \mathrm{~V}^{2}$.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-223.jpg?height=188&width=367&top_left_y=659&top_left_x=513)

Figure 7.6 White spectrum.
An example of a common type of noise PSD is the "white spectrum," also called white noise. Shown in Fig. 7.6, such a PSD displays the same value at all frequencies (similar to white light). Strictly speaking, we note that white noise does not exist because the total area under the power spectral density, i.e., the total power carried by the noise, is infinite. In practice, however, any noise spectrum that is flat in the band of interest is usually called white.

The PSD is a powerful tool in analyzing the effect of noise in circuits, especially in conjunction with the following theorem.

Theorem If a signal with spectrum $S_{x}(f)$ is applied to a linear time-invariant system with transfer function $H(s)$, then the output spectrum is given by

$$
\begin{equation*}
S_{Y}(f)=S_{x}(f)|H(f)|^{2} \tag{7.4}
\end{equation*}
$$

where $H(f)=H(s=2 \pi j f)$. The proof can be found in textbooks on signal processing or communications, e.g., [1].

Somewhat similar to the relation $Y(s)=X(s) H(s)$, this theorem agrees with our intuition that the spectrum of the signal should be "shaped" by the transfer function of the system (Fig. 7.7). For example, as illustrated in Fig. 7.8, since regular telephones have a bandwidth of approximately 4 kHz , they suppress the high-frequency components of the caller's voice. Note that, owing to its limited bandwidth, $x_{\text {out }}(t)$ exhibits slower changes than does $x_{i n}(t)$. This bandwidth limitation sometimes makes it difficult to recognize the caller's voice.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-223.jpg?height=211&width=1210&top_left_y=1739&top_left_x=361)

Figure 7.7 Noise shaping by a transfer function.
Since $S_{x}(f)$ is an even function of $f$ for real $x(t)$ [1], as depicted in Fig. 7.9, the total power carried by $x(t)$ in the frequency range $\left[f_{1} f_{2}\right]$ is equal to

$$
\begin{align*}
P_{f 1, f 2} & =\int_{-f_{2}}^{-f_{1}} S_{x}(f) d f+\int_{+f_{1}}^{+f_{2}} S_{x}(f) d f  \tag{7.5}\\
& =\int_{+f_{1}}^{+f_{2}} 2 S_{x}(f) d f \tag{7.6}
\end{align*}
$$

![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-224.jpg?height=421&width=1451&top_left_y=243&top_left_x=309)

Figure 7.8 Spectral shaping by telephone bandwidth.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-224.jpg?height=334&width=1218&top_left_y=781&top_left_x=426)

Figure 7.9 (a) Two-sided and (b) one-sided noise spectra.

In fact, the integral in (7.6) is the quantity measured by a power meter sensing the output of a bandpass filter between $f_{1}$ and $f_{2}$. That is, the negative-frequency part of the spectrum is folded around the vertical axis and added to the positive-frequency part. We call the representation of Fig. 7.9(a) the "two-sided" spectrum and that of Fig. 7.9(b) the "one-sided" spectrum. For example, the two-sided white spectrum of Fig. 7.6 has the one-sided counterpart shown in Fig. 7.10.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-224.jpg?height=203&width=798&top_left_y=1456&top_left_x=636)

Figure 7.10 Folded white spectrum.

In summary, the spectrum shows the power carried in a small bandwidth at each frequency, revealing how fast the waveform is expected to vary in the time domain.

### 7.1.2 Amplitude Distribution

As mentioned earlier, the instantaneous amplitude of noise is usually unpredictable. However, by observing the noise waveform for a long time, we can construct a "distribution" of the amplitude, indicating how often each value occurs. Also called the "probability density function" (PDF), the distribution of $x(t)$ is defined as

$$
\begin{equation*}
p_{X}(x) d x=\text { probability of } x<X<x+d x \tag{7.7}
\end{equation*}
$$

where $X$ is the measured value of $x(t)$ at some point in time.

As illustrated in Fig. 7.11, to estimate the distribution, we sample $x(t)$ at many points, construct bins of small width, choose the bin height equal to the number of samples whose value falls between the two edges of the bin, and normalize the bin heights to the total number of samples. Note that the PDF provides no information as to how fast $x(t)$ varies in the time domain. For example, the sound generated by a violin may have the same amplitude distribution as that produced by a drum even though their frequency contents are vastly different.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-225.jpg?height=254&width=941&top_left_y=544&top_left_x=490)

Figure 7.11 Amplitude distribution of noise.

An important example of PDFs is the Gaussian (or normal) distribution. The central limit theorem states that if many independent random processes with arbitrary PDFs are added, the PDF of the sum approaches a Gaussian distribution [1]. It is therefore not surprising that many natural phenomena exhibit Gaussian statistics. For example, since the noise of a resistor results from the random "walk" of a very large number of electrons, each having relatively independent statistics, the overall amplitude follows a Gaussian PDF.

In this book, we employ the spectrum and average power of noise to a much greater extent than the amplitude distribution. For completeness, however, we note that the Gaussian PDF is defined as

$$
\begin{equation*}
p_{X}(x)=\frac{1}{\sigma \sqrt{2 \pi}} \exp \frac{-(x-m)^{2}}{2 \sigma^{2}} \tag{7.8}
\end{equation*}
$$

where $\sigma$ and $m$ are the standard deviation and mean of the distribution, respectively. For Gaussian distribution, $\sigma$ is equal to the rms value of the noise.

### 7.1.3 Correlated and Uncorrelated Sources

In analyzing circuits, we often need to add the effect of several sources of noise to obtain the total noise. While for deterministic voltages and currents, we simply use the superposition principle, the procedure is somewhat different for random noise because we are ultimately interested in the average noise power. Let us add two noise waveforms and take the average of the resulting power:

$$
\begin{align*}
P_{a v}= & \lim _{T \rightarrow \infty} \frac{1}{T} \int_{-T / 2}^{+T / 2}\left[x_{1}(t)+x_{2}(t)\right]^{2} d t  \tag{7.9}\\
= & \lim _{T \rightarrow \infty} \frac{1}{T} \int_{-T / 2}^{+T / 2} x_{1}^{2}(t) d t+\lim _{T \rightarrow \infty} \frac{1}{T} \int_{-T / 2}^{+T / 2} x_{2}^{2}(t) d t \\
& +\lim _{T \rightarrow \infty} \frac{1}{T} \int_{-T / 2}^{+T / 2} 2 x_{1}(t) x_{2}(t) d t  \tag{7.10}\\
= & P_{a v 1}+P_{a v 2}+\lim _{T \rightarrow \infty} \frac{1}{T} \int_{-T / 2}^{+T / 2} 2 x_{1}(t) x_{2}(t) d t \tag{7.11}
\end{align*}
$$

where $P_{a v 1}$ and $P_{a v 2}$ denote the average power of $x_{1}(t)$ and $x_{2}(t)$, respectively. Called the "correlation" between $x_{1}(t)$ and $x_{2}(t),{ }^{4}$ the third term in (7.11) indicates how "similar" these two waveforms are. If generated by independent devices, the noise waveforms are usually "uncorrelated" and the integral in (7.11) vanishes. For example, the noise produced by a resistor has no correlation with that generated by a transistor. In such a case, $P_{a v}=P_{a v 1}+P_{a v 2}$. From this observation, we say that superposition holds for the power of uncorrelated noise sources. Of course, superposition also holds for noise voltages and currents, but this does not help us in most cases.

A familiar analogy is that of the spectators in a sports stadium. Before the game begins, many conversations are in progress, generating uncorrelated noise components [Fig. 7.12(a)]. During the game, the spectators applaud (or scream) simultaneously, producing correlated noise at a much higher power level arising from the third term in Eq. (7.11). [Fig. 7.12(b)].
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-226.jpg?height=485&width=1497&top_left_y=705&top_left_x=281)

Figure 7.12 (a) Uncorrelated noise and (b) correlated noise generated in a stadium.
In most cases studied in this book, the noise sources are uncorrelated. One exception is studied in Section 7.3.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-226.jpg?height=421&width=1489&top_left_y=1339&top_left_x=283)

Figure 7.13 (a) Output noise produced by a circuit, and (b) additional noise if bandwidth is excessively wide.

### 7.1.4 Signal-to-Noise Ratio

Suppose an amplifier receives a sinusoidal signal as shown in Fig. 7.13. The output contains both the amplified signal and the noise generated by the circuit. For the output signal to be intelligible, its power, $P_{\text {sig }}$, must be sufficiently higher than that of the noise, $P_{\text {noise }}$. We therefore define the "signal-to-noise ratio" (SNR) as

$$
\begin{equation*}
\mathrm{SNR}=\frac{P_{\text {sig }}}{P_{\text {noise }}} \tag{7.12}
\end{equation*}
$$

[^35]For example, audio signals require a minimum SNR of about 20 dB (i.e., $P_{\text {sig }} / P_{\text {noise }}=100$ ). ${ }^{5}$ For a sinusoid having a peak amplitude of $A, P_{\text {sig }}=A^{2} / 2$, but how do we calculate $P_{\text {noise }}$ ? The total average power carried by noise is equal to the area under its spectrum:

$$
\begin{equation*}
P_{\text {noise }}=\int_{-\infty}^{+\infty} S_{\text {noise }}(f) d f \tag{7.13}
\end{equation*}
$$

Does this mean that $P_{\text {noise }}$ can be very large if $S_{\text {noise }}(f)$ spans a wide frequency range? Yes, indeed. As an example, suppose the above amplifier provides a bandwidth of 1 MHz while sensing an audio signal [Fig. 7.13(b)]. Then, the signal is corrupted by all of the noise components in the 1-MHz bandwidth. For this reason, the bandwidth of the circuit must always be limited to the minimum acceptable value so as to minimize the integrated noise power. The bandwidth can be reduced within the amplifier or by a low-pass filter placed thereafter.

#### Example 7.2

An amplifier produces a one-sided noise spectrum given by $S_{\text {noise }}(f)=5 \times 10^{-16} \mathrm{~V}^{2} / \mathrm{Hz}$. Determine the total output noise in a bandwidth of 1 MHz .

#### Solution

We have

$$
\begin{align*}
P_{\text {noise }} & =\int_{0}^{1 \mathrm{MHz}} S_{\text {noise }}(f) d f  \tag{7.14}\\
& =5 \times 10^{-10} \mathrm{~V}^{2} \tag{7.15}
\end{align*}
$$

Note that the total integrated noise is measured in $\mathrm{V}^{2}$ and not in $\mathrm{V}^{2} / \mathrm{Hz}$. This noise power corresponds to an rms voltage of $\sqrt{5 \times 10^{-10} \mathrm{~V}^{2}}=22.4 \mu \mathrm{~V}$.

### 7.1.5 Noise Analysis Procedure

With the tools developed in previous sections, we can now outline a methodology for the analysis of noise in circuits. The output signal of a given circuit is corrupted by the noise sources within the circuit. We are therefore interested in the noise observed at the output. Our procedure consists of four steps:

1. Identify the sources of noise (e.g., resistors and transistors) and write down the spectrum of each.
2. Find the transfer function from each noise source to the output (as if the source were a deterministic signal).
3. Utilize the theorem $S_{Y}(f)=S_{x}(f)|H(f)|^{2}$ to calculate the output noise spectrum contributed by each noise source. (The input signal is set to zero.)
4. Add all of the output spectra, paying attention to correlated and uncorrelated sources.

This procedure gives the output noise spectrum, which must then be integrated from $-\infty$ to $+\infty$ so as to yield the total output noise. To carry out the first step, we need the noise representation of various electronic devices, to be described in the next section.

[^36]
## 7.2 ■ Types of Noise

Analog signals processed by integrated circuits are corrupted by two different types of noise: device electronic noise and "environmental" noise. The latter refers to (seemingly) random disturbances that a circuit experiences through the supply or ground lines or through the substrate. We focus on device electronic noise here and defer the study of environmental noise to Chapter 19.

### 7.2.1 Thermal Noise

Resistor Thermal Noise The random motion of electrons in a conductor introduces fluctuations in the voltage measured across the conductor, even if the average current is zero. Thus, the spectrum of thermal noise is proportional to the absolute temperature. As shown in Fig. 7.14, the thermal noise of a resistor $R$ can be modeled by a series voltage source, with the one-sided spectral density

$$
\begin{equation*}
S_{v}(f)=4 k T R, \quad f \geq 0 \tag{7.16}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-228.jpg?height=237&width=772&top_left_y=906&top_left_x=644)

Figure 7.14 Thermal noise of a resistor.
where $k=1.38 \times 10^{-23} \mathrm{~J} / \mathrm{K}$ is the Boltzmann constant. Note that $S_{v}(f)$ is expressed in $\mathrm{V}^{2} / \mathrm{Hz}$. Thus, we also write $\overline{V_{n}^{2}}=4 k T R$, where the overline indicates averaging. ${ }^{6}$ We may even say that the noise "voltage" is given by $4 k T R$ even though this quantity is in fact the noise voltage squared. For example, a $50-\Omega$ resistor held at $T=300 \mathrm{~K}$ exhibits $8.28 \times 10^{-19} \mathrm{~V}^{2} / \mathrm{Hz}$ of thermal noise. To convert this number to a more familiar voltage quantity, we take the square root, obtaining $0.91 \mathrm{nV} / \sqrt{\mathrm{Hz}}$. While the square root of hertz may appear strange, it is helpful to remember that $0.91 \mathrm{nV} / \sqrt{\mathrm{Hz}}$ has little significance per se and simply means that the power in a $1-\mathrm{Hz}$ bandwidth is equal to $\left(0.91 \times 10^{-9}\right)^{2} \mathrm{~V}^{2}$.

The equation $S_{v}(f)=4 k T R$ suggests that thermal noise is white. In reality, $S_{v}(f)$ is flat for up to roughly 100 THz , dropping at higher frequencies. For our purposes, the white spectrum is quite accurate.

Since noise is a random quantity, the polarity used for the voltage source in Fig. 7.14 is unimportant. Nevertheless, once a polarity is chosen, it must be retained throughout the analysis of the circuit so as to obtain consistent results.

#### Example 7.3

Consider the $R C$ circuit shown in Fig. 7.15. Calculate the noise spectrum and the total noise power in $V_{\text {out }}$.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-228.jpg?height=224&width=954&top_left_y=1901&top_left_x=545)

Figure 7.15 Noise generated in a low-pass filter. ${ }^{\mathrm{x}_{3}}$

[^37]
#### Solution

We follow the four steps described in Section 7.1.5. The noise spectrum of $R$ is given by $S_{v}(f)=4 k T R$. Next, modeling the noise of $R$ by a series voltage source $V_{R}$, we compute the transfer function from $V_{R}$ to $V_{\text {out }}$ :

$$
\begin{equation*}
\frac{V_{\text {out }}}{V_{R}}(s)=\frac{1}{R C s+1} \tag{7.17}
\end{equation*}
$$

From the theorem in Section 7.1.1, we have

$$
\begin{align*}
S_{\text {out }}(f) & =S_{v}(f)\left|\frac{V_{\text {out }}}{V_{R}}(j \omega)\right|^{2}  \tag{7.18}\\
& =4 k T R \frac{1}{4 \pi^{2} R^{2} C^{2} f^{2}+1} \tag{7.19}
\end{align*}
$$

Thus, the white noise spectrum of the resistor is shaped by a low-pass characteristic (Fig. 7.16). To calculate the total noise power at the output, we write

$$
\begin{equation*}
P_{n, \text { out }}=\int_{0}^{\infty} \frac{4 k T R}{4 \pi^{2} R^{2} C^{2} f^{2}+1} d f \tag{7.20}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-229.jpg?height=247&width=1220&top_left_y=1042&top_left_x=356)

Figure 7.16 Noise spectrum shaping by a low-pass filter.
Note that the integration must be with respect to $f$ rather than $\omega$ (why?). Since

$$
\begin{equation*}
\int \frac{d x}{x^{2}+1}=\tan ^{-1} x \tag{7.21}
\end{equation*}
$$

the integral reduces to

$$
\begin{align*}
P_{n, \text { out }} & =\left.\frac{2 k T}{\pi C} \tan ^{-1} u\right|_{u=0} ^{u=\infty}  \tag{7.22}\\
& =\frac{k T}{C} \tag{7.23}
\end{align*}
$$

Note that the unit of $k T / C$ is $\mathrm{V}^{2}$. We may also consider $\sqrt{k T / C}$ as the total rms noise voltage measured at the output. For example, with a 1-pF capacitor, the total noise voltage is equal to $64.3 \mu \mathrm{~V}_{\mathrm{rms}}$ at $T=300 \mathrm{~K}$.

Equation (7.23) implies that the total noise at the output of the circuit shown in Fig. 7.15 is independent of the value of $R$. Intuitively, this is because for larger values of $R$, the associated noise per unit bandwidth increases while the overall bandwidth of the circuit decreases. The fact that $k T / C$ noise can be decreased only by increasing $C$ (if $T$ is fixed) introduces many difficulties in the design of analog circuits (Chapter 13).

The thermal noise of a resistor can be represented by a parallel current source as well (Fig. 7.17). For the representations of Figs. 7.14 and 7.17 to be equivalent, we have $\overline{V_{n}^{2}} / R^{2}=\overline{I_{n}^{2}}$, that is, $\overline{I_{n}^{2}}=4 k T / R$. Note that $\overline{I_{n}^{2}}$ is expressed in $\mathrm{A}^{2} / \mathrm{Hz}$. Depending on the circuit topology, one model may lead to simpler calculations than the other.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-230.jpg?height=249&width=375&top_left_y=224&top_left_x=578)

Figure 7.17 Representation of resistor thermal noise by a current source.

#### Example 7.4

Calculate the equivalent noise voltage of two parallel resistors $R_{1}$ and $R_{2}$ [Fig. 7.18(a)].
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-230.jpg?height=304&width=933&top_left_y=601&top_left_x=568)

Figure 7.18

#### Solution

As shown in Fig. 7.18(b), each resistor exhibits an equivalent noise current with the spectral density $4 k T / R$. Since the two noise sources are uncorrelated, we add the powers:

$$
\begin{align*}
\overline{I_{n, t o t}^{2}} & =\overline{I_{n 1}^{2}}+\overline{I_{n 2}^{2}}  \tag{7.24}\\
& =4 k T\left(\frac{1}{R_{1}}+\frac{1}{R_{2}}\right) \tag{7.25}
\end{align*}
$$

Thus, the equivalent noise voltage is given by

$$
\begin{align*}
\overline{V_{n, t o t}^{2}} & =\overline{I_{n, t o t}^{2}}\left(R_{1} \| R_{2}\right)^{2}  \tag{7.26}\\
& =4 k T\left(R_{1} \| R_{2}\right) \tag{7.27}
\end{align*}
$$

as intuitively expected. Note that our notation assumes a $1-\mathrm{Hz}$ bandwidth.

The dependence of thermal noise (and some other types of noise) upon $T$ suggests that low-temperature operation can decrease the noise in analog circuits. This approach becomes more attractive with the observation that the mobility of charge carriers in MOS devices increases at low temperatures [2]. ${ }^{7}$ Nonetheless, the required cooling equipment limits the practicality of low-temperature circuits.

MOSFETs MOS transistors also exhibit thermal noise. The most significant source is the noise generated in the channel. It can be proved [4] that for long-channel MOS devices operating in saturation, the channel noise can be modeled by a current source connected between the drain and source terminals (Fig. 7.19) with a spectral density: ${ }^{8}$

$$
\begin{equation*}
\overline{I_{n}^{2}}=4 k T \gamma g_{m} \tag{7.28}
\end{equation*}
$$

[^38]![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-231.jpg?height=237&width=377&top_left_y=245&top_left_x=493)

Figure 7.19 Thermal noise of a MOSFET.

The coefficient $\gamma$ (not to be confused with the body effect coefficient!) is derived to be equal to $2 / 3$ for long-channel transistors and may need to be replaced by a larger value for submicron MOSFETs [5]. It also varies to some extent with the drain-source voltage. As a rule of thumb, we assume $\gamma \approx 1$.

#### Example 7.5

Find the maximum noise voltage that a single MOSFET can generate.

#### Solution

As shown in Fig. 7.20, the maximum output noise occurs if the transistor sees only its own output impedance as the load, i.e., if the external load is an ideal current source. The output noise voltage spectrum is then given by $S_{\text {out }}(f)=S_{\text {in }}(f)|H(f)|^{2}$, i.e.,

$$
\begin{align*}
\overline{V_{n}^{2}} & =\overline{I_{n}^{2}} r_{O}^{2}  \tag{7.29}\\
& =\left(4 k T \gamma g_{m}\right) r_{O}^{2} \tag{7.30}
\end{align*}
$$

![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-231.jpg?height=388&width=421&top_left_y=1189&top_left_x=489)

Figure 7.20

Let us make three observations. First, (7.30) suggests that the noise current of a MOS transistor decreases if the transconductance drops. For example, if the transistor operates as a constant current source, it is desirable to minimize its transconductance.

Second, the noise measured at the output of the circuit does not depend on where the input terminal is because for output noise calculation, the input is set to zero. ${ }^{9}$ For example, the circuit of Fig. 7.20 may be a common-source or a common-gate stage, exhibiting the same output noise.

Third, the output resistance, $r_{O}$, does not produce noise because it is not a physical resistor.

The ohmic sections of a MOSFET also contribute thermal noise. As conceptually illustrated in the top view of Fig. 7.21(a), the gate, source, and drain materials exhibit finite resistivity, thereby introducing noise. For a relatively wide transistor, the source and drain resistance is typically negligible whereas the gate distributed resistance may become noticeable.

[^39]![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-232.jpg?height=923&width=1194&top_left_y=197&top_left_x=474)

Figure 7.21 (a) Layout of a MOSFET indicating the terminal resistances; (b) circuit model; (c) distributed gate resistance.

#### Nanometer Design Notes

The small dimensions of nanometer devices lead to considerable flicker noise. Plotted below are the gate-referred noise spectra for PMOS and NMOS devices with $W / L=5 \mu \mathrm{~m} / 40 \mathrm{~nm}$ and $I_{D}=250 \mu \mathrm{~A}$. We observe that PMOS devices exhibit less noise, and the NMOS flicker noise corner is as high as several hundred megahertz. For low flicker noise, therefore, the transistor areas must be increased substantially.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-232.jpg?height=401&width=526&top_left_y=1682&top_left_x=137)

In the noise model of Fig. 7.21(b), a lumped resistor $R_{1}$ represents the distributed gate resistance. Viewing the overall transistor as the distributed structure shown in Fig. 7.21(c), we observe that the unit transistors near the left end see the noise of only a fraction of $R_{G}$ whereas those near the right end see the noise of most of $R_{G}$. We therefore expect the lumped resistor in the noise model to be less than $R_{G}$. In fact, it can be proved that $R_{1}=R_{G} / 3$ (Problem 7.3) [3], and hence the noise generated by the gate resistance is given by $\overline{V_{n R G}^{2}}=4 k T R_{G} / 3$.

While the thermal noise generated in the channel is controlled by only the transconductance of the device, the effect of $R_{G}$ can be reduced by proper layout. Shown in Fig. 7.22 are two examples. In Fig. 7.22(a), the two ends of the gate are shorted by a metal line, thus reducing the distributed resistance from $R_{G}$ to $R_{G} / 4$ (why?). Alternatively, the transistor can be folded as described in Chapter 19 [Fig. 7.22(b)] so that each gate "finger" exhibits a resistance of $R_{G} / 2$, yielding a total distributed resistance of $R_{G} / 4$ for the composite transistor.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-232.jpg?height=332&width=913&top_left_y=1919&top_left_x=647)

Figure 7.22 Reduction of gate resistance by (a) adding contacts to both sides or (b) folding.

#### Example 7.6

A transistor of width $W$ is laid out with one gate finger and exhibits a total gate resistance of $R_{G}$ [Fig. 7.23(a)]. Now, we reconfigure the device into four equal gate fingers [Fig. 7.23(b)]. Determine the total gate resistance thermal noise spectrum of the new structure.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-233.jpg?height=428&width=623&top_left_y=429&top_left_x=385)

Figure 7.23

#### Solution

With a width of $W / 4$, each gate finger now has a distributed resistance of $R_{G} / 4$ and hence a lumped-model resistance of $R_{G} / 12$. Since the four fingers are in parallel, the net resistance is given by $R_{G} / 48$, yielding a noise spectrum of

$$
\begin{equation*}
\overline{V_{n R G}^{2}}=4 k T \frac{R_{G}}{48} \tag{7.31}
\end{equation*}
$$

(In general, if the gate is decomposed into $N$ parallel fingers, the distributed resistance falls by a factor of $N^{2}$.)

#### Example 7.7

Find the maximum thermal noise voltage that the gate resistance of a single MOSFET can generate. Neglect the device capacitances.

#### Solution

If the total distributed gate resistance is $R_{G}$, then from Fig. 7.24 , the output noise voltage due to $R_{G}$ is given by

$$
\begin{equation*}
\overline{V_{n, \text { out }}^{2}}=4 k T \frac{R_{G}}{3}\left(g_{m} r_{O}\right)^{2} \tag{7.32}
\end{equation*}
$$

An important observation here is that, for the gate resistance noise to be negligible, we must ensure that (7.32) is much less than (7.30), and thus

$$
\begin{equation*}
\frac{R_{G}}{3} \ll \frac{\gamma}{g_{m}} \tag{7.33}
\end{equation*}
$$

The number of gate fingers is chosen large enough to guarantee this condition.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-233.jpg?height=364&width=659&top_left_y=1862&top_left_x=367)

Figure 7.24

### 7.2.2 Flicker Noise

The interface between the gate oxide and the silicon substrate in a MOSFET entails an interesting phenomenon. Since the silicon crystal reaches an end at this interface, many "dangling" bonds appear, giving rise to extra energy states (Fig. 7.25). As charge carriers move at the interface, some are randomly trapped and later released by such energy states, introducing "flicker" noise in the drain current. In addition to trapping, several other mechanisms are believed to generate flicker noise [4].
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-234.jpg?height=313&width=710&top_left_y=548&top_left_x=408)

Figure 7.25 Dangling bonds at the oxide-silicon interface.

Unlike thermal noise, the average power of flicker noise cannot be predicted easily. Depending on the "cleanness" of the oxide-silicon interface, flicker noise may assume considerably different values and as such varies from one CMOS technology to another. The flicker noise is more easily modeled as a voltage source in series with the gate and, in the saturation region, roughly given by

$$
\begin{equation*}
\overline{V_{n}^{2}}=\frac{K}{C_{o x} W L} \cdot \frac{1}{f} \tag{7.34}
\end{equation*}
$$

where $K$ is a process-dependent constant on the order of $10^{-25} \mathrm{~V}^{2} \mathrm{~F}$. Note that our notation assumes a bandwidth of 1 Hz . Interestingly, as shown in Fig. 7.26, the noise spectral density is inversely proportional to the frequency. For example, the trap-and-release phenomenon associated with the dangling bonds occurs more often at low frequencies. For this reason, flicker noise is also called $1 / f$ noise. Note that (7.34) does not depend on the bias current or the temperature. This is only an approximation; in reality, the flicker noise equation is somewhat more complex [3].
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-234.jpg?height=293&width=513&top_left_y=1513&top_left_x=509)

Figure 7.26 Flicker noise spectrum.

The inverse dependence of (7.34) on $W L$ suggests that to reduce $1 / f$ noise, the device area must be increased. It is therefore not surprising to see devices having areas of several hundred square microns in low-noise applications. (More fundamentally, the noise power trades with the gate capacitance, $W L C_{o x}$.) Generally, PMOS devices exhibit less $1 / f$ noise than NMOS transistors because the former carry the holes in a "buried channel," i.e., at some distance from the oxide-silicon interface, and hence trap and release the carriers to a lesser extent.

#### Example 7.8

For an NMOS current source, calculate the total thermal and $1 / f$ noise in the drain current for a band from 1 kHz to 1 MHz .

#### Solution

The thermal noise current per unit bandwidth is given by $\overline{I_{n, t h}^{2}}=4 k T \gamma g_{m}$. Thus, the total thermal noise integrated across the band of interest is

$$
\begin{align*}
\overline{I_{n, t h, t o t}^{2}} & =4 k T \gamma g_{m}\left(10^{6}-10^{3}\right)  \tag{7.35}\\
& \approx 4 k T \gamma g_{m} \times 10^{6} \mathrm{~A}^{2} \tag{7.36}
\end{align*}
$$

For $1 / f$ noise, the drain noise current per unit bandwidth is obtained by multiplying the noise voltage at the gate by the device transconductance:

$$
\begin{equation*}
\overline{I_{n, 1 / f}^{2}}=\frac{K}{C_{o x} W L} \cdot \frac{1}{f} \cdot g_{m}^{2} \tag{7.37}
\end{equation*}
$$

The total $1 / f$ noise is then equal to

$$
\begin{align*}
\overline{I_{n, 1 / f, t o t}^{2}} & =\frac{K g_{m}^{2}}{C_{o x} W L} \int_{1 \mathrm{kHz}}^{1 \mathrm{MHz}} \frac{d f}{f}  \tag{7.38}\\
& =\frac{K g_{m}^{2}}{C_{o x} W L} \ln 10^{3}  \tag{7.39}\\
& =\frac{6.91 K g_{m}^{2}}{C_{o x} W L} \tag{7.40}
\end{align*}
$$

The above example raises an interesting question. What happens to $\overline{I_{n, 1 / f, t o t}^{2}}$ if the lower end of the band, $f_{L}$, is zero rather than 1 kHz ? Equation (7.39) then yields an infinite value for the total noise. To overcome the fear of infinite noise, we make two observations. First, extending $f_{L}$ to zero means that we are interested in arbitrarily slow noise components. A noise component at 0.01 Hz varies significantly in roughly 10 s (one-tenth of the period) and one at $10^{-6} \mathrm{~Hz}$ in roughly one day. Second, the infinite flicker noise power simply means that if we observe the circuit for a very long time, the very slow noise components can randomly assume a very large power level. At such slow rates, noise becomes indistinguishable from thermal drift or aging of devices.

The foregoing observations lead to the following conclusions. First, since the signals encountered in most applications do not contain very-low-frequency components, our observation window need not be very long. For example, voice signals display negligible energy below 20 Hz , and if a noise component varies at a lower rate, it does not corrupt the voice significantly. Second, the logarithmic dependence of the flicker noise power upon $f_{L}$ allows some margin for error in selecting $f_{L}$. For example, if the integral in Eq. (7.38) begins from 100 Hz rather than 1 kHz , the coefficient in (7.40) rises from 6.91 to 9.21.

In order to quantify the significance of $1 / f$ noise with respect to thermal noise for a given device, we plot both spectral densities on the same axes (Fig. 7.27). Called the $1 / f$ noise "corner frequency," the
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-235.jpg?height=290&width=629&top_left_y=1986&top_left_x=377)

Figure 7.27 Concept of flicker noise corner frequency.
intersection point serves as a measure of what part of the band is mostly corrupted by flicker noise. In the above example, the $1 / f$ noise corner, $f_{C}$, of the output current is determined as

$$
\begin{equation*}
4 k T \gamma g_{m}=\frac{K}{C_{o x} W L} \cdot \frac{1}{f_{C}} \cdot g_{m}^{2} \tag{7.41}
\end{equation*}
$$

that is,

$$
\begin{equation*}
f_{C}=\frac{K}{\gamma C_{o x} W L} g_{m} \frac{1}{4 k T} \tag{7.42}
\end{equation*}
$$

This result implies that $f_{C}$ generally depends on the device area and transconductance. Nonetheless, for a given $L$, the dependence is weak and the $1 / f$ noise corner is relatively constant, falling in the vicinity of 10 MHz to 50 MHz for nanometer transistors.

#### Example 7.9

For a $100-\mu \mathrm{m} / 0.5-\mu \mathrm{m}$ MOS device with $g_{m}=1 /(100 \Omega)$, the $1 / f$ noise corner frequency is measured to be 500 kHz . If $t_{o x}=90 \AA$, what is the flicker noise coefficient, $K$, in this technology?

#### Solution

For $t_{o x}=90 \AA$, we have $C_{o x}=3.84 \mathrm{fF} / \mu \mathrm{m}^{2}$. Using Eq. (7.42), we write

$$
\begin{equation*}
500 \mathrm{kHz}=\frac{K}{3.84 \times 100 \times 0.5 \times 10^{-15}} \cdot \frac{1}{100} \cdot \frac{3}{8 \times 1.38 \times 10^{-23} \times 300} \tag{7.43}
\end{equation*}
$$

That is, $K=1.06 \times 10^{-25} \mathrm{~V}^{2} \mathrm{~F}$.

It is important to bear in mind that typical transistor models include thermal and flicker noise but not the gate resistance noise. The latter must therefore be added to each transistor by the designer.

## 7.3 - Representation of Noise in Circuits

Output Noise Consider a general circuit with one input port and one output port (Fig. 7.28). How do we quantify the effect of noise here? The natural approach would be to set the input to zero and calculate the total noise at the output due to various sources of noise in the circuit. This is indeed how the noise is measured in the laboratory or in simulations. Our analysis procedure in Section 7.1.5 methodically leads to the output noise spectrum.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-236.jpg?height=285&width=723&top_left_y=1845&top_left_x=671)

Figure 7.28 Noise sources in a circuit.

#### Example 7.10

What is the total output noise voltage of the common-source stage shown in Fig. 7.29(a)? Assume that $\lambda=0$.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-237.jpg?height=416&width=852&top_left_y=227&top_left_x=542)

Figure 7.29 (a) CS stage; (b) circuit including noise sources.

#### Solution

We must identify the sources of noise, find their transfer functions to the output, multiply their spectra by the squared magnitude of the transfer functions and add the results. We model the thermal and flicker noise of $M_{1}$ by two current sources: $\overline{I_{n, t h}^{2}}=4 k T \gamma g_{m}$ and $\overline{I_{n, 1 / f}^{2}}=K g_{m}^{2} /\left(C_{o x} W L f\right)$. We also represent the thermal noise of $R_{D}$ by a current source $\overline{I_{n, R D}^{2}}=4 k T / R_{D}$. Since these currents flow through $R_{D}$, the output noise voltage per unit bandwidth is equal to

$$
\begin{equation*}
\overline{V_{n, \text { out }}^{2}}=\left(4 k T \gamma g_{m}+\frac{K}{C_{o x} W L} \cdot \frac{1}{f} \cdot g_{m}^{2}+\frac{4 k T}{R_{D}}\right) R_{D}^{2} \tag{7.44}
\end{equation*}
$$

Note that the noise mechanisms are added as "power" quantities because they are uncorrelated. The value given by (7.44) represents the noise power in 1 Hz at a frequency $f$. The total output noise is obtained by integration.

Input-Referred Noise While intuitively appealing, the output-referred noise does not allow a fair comparison of the performance of different circuits because it depends on the gain. For example, as depicted in Fig. 7.30, if a common-source stage is followed by a noiseless amplifier having a voltage gain $A_{1}$, then the output noise is equal to the expression in (7.44) multiplied by $A_{1}^{2}$. Considering only the output noise, we may conclude that as $A_{1}$ increases, the circuit becomes noisier, an incorrect result because a larger $A_{1}$ also provides a proportionally higher signal level at the output. That is, the output signal-to-noise ratio does not depend on $A_{1}$.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-237.jpg?height=306&width=490&top_left_y=1517&top_left_x=452)

Figure 7.30 Addition of gain stage to a CS stage.

To overcome the above quandary, we usually specify the "input-referred noise" of circuits. Illustrated conceptually in Fig. 7.31, the idea is to represent the effect of all noise sources in the circuit by a single
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-237.jpg?height=349&width=1280&top_left_y=1941&top_left_x=323)

Figure 7.31 Determination of input-referred noise voltage.
source, $\overline{V_{n, i n}^{2}}$, at the input such that the output noise in Fig. 7.31(b) equals that in Fig. 7.31(a). If the voltage gain is $A_{v}$, then we must have $\overline{V_{n, \text { out }}^{2}}=A_{v}^{2} \overline{V_{n, i n}^{2}}$, that is, the input-referred noise voltage in this simple case is given by the output noise voltage divided by the gain.

#### Example 7.11

For the circuit of Fig. 7.29, calculate the input-referred noise voltage.

#### Solution

We have

$$
\begin{align*}
\overline{V_{n, \text { in }}^{2}} & =\frac{\overline{V_{n, \text { out }}^{2}}}{A_{v}^{2}}  \tag{7.45}\\
& =\left(4 k T \gamma g_{m}+\frac{K}{C_{o x} W L} \cdot \frac{1}{f} \cdot g_{m}^{2}+\frac{4 k T}{R_{D}}\right) R_{D}^{2} \frac{1}{g_{m}^{2} R_{D}^{2}}  \tag{7.46}\\
& =4 k T \frac{\gamma}{g_{m}}+\frac{K}{C_{o x} W L} \cdot \frac{1}{f}+\frac{4 k T}{g_{m}^{2} R_{D}} \tag{7.47}
\end{align*}
$$

Note that the first term in (7.47) can be viewed as the thermal noise of a resistor equal to $\gamma /\left(g_{m}\right)$ placed in series with the gate. Similarly, the third term corresponds to the noise of a resistor equal to $\left(g_{m}^{2} R_{D}\right)^{-1}$. We sometimes say the "equivalent thermal noise resistance" of a circuit is equal to $R_{T}$, meaning that the total input-referred thermal noise of the circuit in unit bandwidth is equal to $4 k T R_{T}$.

Why does $\overline{V_{n, i n}^{2}}$ decrease as $R_{D}$ increases? This is because the noise voltage due to $R_{D}$ at the output is proportional to $\sqrt{R_{D}}$ while the voltage gain of the circuit is proportional to $R_{D}$.

At this point of our study, we make two observations. First, the input-referred noise and the input signal are both multiplied by the gain as they are processed by the circuit. Thus, the input-referred noise indicates how much the input signal is corrupted by the circuit's noise, i.e., how small an input the circuit can detect with acceptable SNR. For this reason, input-referred noise allows a fair comparison of different circuits. Second, the input-referred noise is a fictitious quantity in that it cannot be measured at the input of the circuit. The two circuits of Figs. 7.31(a) and (b) are mathematically equivalent but the physical circuit is still that in Fig. 7.31(a).

In the foregoing discussion, we have assumed that the input-referred noise can be modeled by a single voltage source in series with the input. This is generally an incomplete representation if the circuit has a finite input impedance and is driven by a finite source impedance. To understand why, let us first return to the CS stage of Fig. 7.29 and observe that the output thermal noise due to $M_{1}$ is equal to $\left(4 k T \gamma g_{m}\right) R_{D}^{2}$ regardless of the network driving the gate (i.e., regardless of the preceding stage). Upon dividing this noise by $\left(g_{m} R_{D}\right)^{2}$, we obtain an input-referred noise voltage of $4 k T \gamma / g_{m}$-also independent of the preceding stage.

Now, consider the common-source stage of Fig. 7.32(a), where the input capacitance is denoted by $C_{i n}$. The input-referred noise voltage due to $M_{1}$ is still given by $4 k T \gamma / g_{m}$. Suppose the preceding stage is modeled by a Thevenin equivalent having an output impedance of $R_{1}$ [Fig. 7.32(b)]. Simplifying the circuit for noise calculations as shown in Fig. 7.32(c), we seek the output noise due to $M_{1}$, hoping to obtain $4 k T \gamma g_{m} R_{D}^{2}$. Owing to the voltage division between $R_{1}$ and $1 /\left(C_{i n} s\right)$, the output noise emerges as

$$
\begin{align*}
\overline{V_{n, \text { out }}^{2}} & =\overline{V_{n, \text { in }}^{2}}\left|\frac{1}{R_{1} C_{\text {in }} j \omega+1}\right|^{2}\left(g_{m} R_{D}\right)^{2}  \tag{7.48}\\
& =\frac{4 k T \gamma g_{m} R_{D}^{2}}{R_{1}^{2} C_{i n}^{2} \omega^{2}+1} \tag{7.49}
\end{align*}
$$

This result is incorrect; after all, the output noise due to $M_{1}$ must not diminish as $R_{1}$ increases.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-239.jpg?height=385&width=1540&top_left_y=233&top_left_x=229)

Figure 7.32 CS stage including input capacitance; (b) CS stage stimulated by a finite source impedance; (c) effect of single noise source.

Let us summarize the problem. If the circuit has a finite input impedance, modeling the input-referred noise by merely a voltage source implies that the output noise vanishes as the source impedance becomes large, an incorrect conclusion. To resolve this issue, we model the input-referred noise by both a series voltage source and a parallel current source (Fig. 7.33) so that if the output impedance of the preceding stage assumes large values-thereby reducing the effect of $\overline{V_{n, i n}^{2}}$-the noise current source still flows through a finite impedance, producing noise at the input. It can be proved that $\overline{V_{n, i n}^{2}}$ and $\overline{I_{n, i n}^{2}}$ are necessary and sufficient to represent the noise of any linear two-port circuit [5].
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-239.jpg?height=228&width=518&top_left_y=1100&top_left_x=422)

Figure 7.33 Representation of noise by voltage and current sources.

How do we calculate $\overline{V_{n, i n}^{2}}$ and $\overline{I_{n, i n}^{2}}$ ? Since the model is valid for any source impedance, we consider two extreme cases: zero and infinite source impedances. As shown in Fig. 7.34(a), if the source impedance is zero, $\overline{I_{n, i n}^{2}}$ flows through $\overline{V_{n, i n}^{2}}$ and has no effect on the output. Thus, the output noise measured in this case arises solely from $\overline{V_{n, i n}^{2}}$. Similarly, if the input is open [Fig. 7.34(b)], then $\overline{V_{n, i n}^{2}}$ has no effect and the output noise is due to only $\overline{I_{n, i n}^{2}}$. Let us apply this method to the circuit of Fig. 7.32.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-239.jpg?height=521&width=1077&top_left_y=1591&top_left_x=427)

Figure 7.34 Calculation of input-referred noise (a) voltage and (b) current.

#### Example 7.12

Calculate the input-referred noise voltage and current of Fig. 7.32, including only the thermal noise of $M_{1}$ and $R_{D}$.

#### Solution

From (7.47), the input-referred noise voltage is simply

$$
\begin{equation*}
\overline{V_{n, i n}^{2}}=4 k T \frac{\gamma}{g_{m}}+\frac{4 k T}{g_{m}^{2} R_{D}} \tag{7.50}
\end{equation*}
$$

As depicted in Fig. 7.35(a), this voltage generates the same output noise as the actual circuit if the input is shorted.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-240.jpg?height=375&width=1264&top_left_y=530&top_left_x=403)

Figure 7.35
To obtain the input-referred noise current, we open the input and find the output noise in terms of $\overline{I_{n, i n}^{2}}$ [Fig.7.35(b)]. The noise current flows through $C_{i n}$, generating at the output

$$
\begin{equation*}
\overline{V_{n 2, \text { out }}^{2}}=\overline{I_{n, \text { in }}^{2}}\left(\frac{1}{C_{\text {in }} \omega}\right)^{2} g_{m}^{2} R_{D}^{2} \tag{7.51}
\end{equation*}
$$

According to Fig. 7.34(b), this value must be equal to the output of the noisy circuit when its input is open:

$$
\begin{equation*}
\overline{V_{n 2, \text { out }}^{2}}=\left(4 k T \gamma g_{m}+\frac{4 k T}{R_{D}}\right) R_{D}^{2} \tag{7.52}
\end{equation*}
$$

From (7.51) and (7.52), it follows that

$$
\begin{equation*}
\overline{I_{n, i n}^{2}}=\left(C_{i n} \omega\right)^{2} \frac{4 k T}{g_{m}^{2}}\left(\gamma g_{m}+\frac{1}{R_{D}}\right) \tag{7.53}
\end{equation*}
$$

As mentioned earlier, the input noise current, $I_{n, i n}$, becomes significant if the circuit's input impedance, $Z_{i n}$, is not very high. To see whether $I_{n, i n}$ can be neglected or not, we consider the scenario depicted in Fig. 7.36, where $Z_{S}$ denotes the output impedance of the preceding circuit. The total noise voltage sensed by the second stage at node $X$ is equal to

$$
\begin{equation*}
V_{n, X}=\frac{Z_{\text {in }}}{Z_{\text {in }}+Z_{S}} V_{n, i n}+\frac{Z_{\text {in }} Z_{S}}{Z_{\text {in }}+Z_{S}} I_{n, i n} \tag{7.54}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-240.jpg?height=298&width=692&top_left_y=1990&top_left_x=420)

Figure 7.36 Effect of input noise current.

If $\overline{I_{n, i n}^{2}}\left|Z_{S}\right|^{2} \ll \overline{V_{n, i n}^{2}}$, then the effect of $I_{n, i n}$ is negligible. In other words, ultimately, it is the output impedance of the preceding stage-rather than $Z_{i n}$-that determines the significance of $I_{n, i n}$. We conclude that the input-referred noise current can be neglected if

A difficulty in the use of input-referred noise voltages and currents is that they may be correlated. After all, $V_{n, i n}$ and $I_{n, i n}$ may contain effects from the same noise source. For example, in Fig. 7.35, if the noise voltage of $R_{D}$ is increasing at some point in time, then both $V_{n, i n}$ and $I_{n, i n}$ also inherit this increase. For this reason, noise calculations must revert to Eq. (7.11) and include the correlation between the two. Methods of avoiding this correlation are described in Appendix A.

The reader may wonder if the use of both a voltage source and a current source to represent the input-referred noise "counts the noise twice." We consider the environment depicted in Fig. 7.37 as an example and prove that the output noise is correct for any source impedance, $Z_{S}$. Assuming $Z_{S}$ is noiseless for simplicity, we first calculate the total noise voltage at the gate of $M_{1}$ due to $\overline{V_{n, i n}^{2}}$ and $\overline{I_{n, i n}^{2}}$. This voltage cannot be obtained by superposition of powers because $\overline{V_{n, i n}^{2}}$ and $\overline{I_{n, i n}^{2}}$ are correlated. Nonetheless, superposition still applies to voltages and currents because the circuit is linear and timeinvariant. Equations (7.50) and (7.53) must be respectively rewritten as

$$
\begin{align*}
V_{n, i n} & =V_{n, M 1}+\frac{1}{g_{m} R_{D}} V_{n, R D}  \tag{7.56}\\
I_{n, i n} & =C_{i n} s V_{n, M 1}+\frac{C_{i n} s}{g_{m} R_{D}} V_{n, R D} \tag{7.57}
\end{align*}
$$

![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-241.jpg?height=342&width=700&top_left_y=1389&top_left_x=344)

Figure 7.37 CS stage driven by a source impedance.
where $V_{n, M 1}$ denotes the gate-referred noise voltage of $M_{1}$ and $V_{n, R D}$ the noise voltage of $R_{D}$. We recognize that $V_{n, M 1}$ and $V_{n, R D}$ appear in both $V_{n, i n}$ and $I_{n, i n}$, creating a strong correlation between the two. Thus, the calculations must use superposition of voltages-as if $V_{n, i n}$ and $I_{n, i n}$ were deterministic quantities.

Adding the contributions of $V_{n, i n}$ and $I_{n, i n}$ at node $X$ in Fig. 7.37, we have

$$
\begin{align*}
V_{n, X} & =V_{n, i n} \frac{\frac{1}{C_{i n} s}}{\frac{1}{C_{i n} s}+Z_{S}}+I_{n, i n} \frac{\frac{Z_{S}}{C_{i n} s}}{\frac{1}{C_{i n} s}+Z_{S}}  \tag{7.58}\\
& =\frac{V_{n, i n}+I_{n, i n} Z_{S}}{Z_{S} C_{i n} s+1} \tag{7.59}
\end{align*}
$$

Substituting for $V_{n, i n}$ and $I_{n, i n}$ from (7.56) and (7.57), respectively, we obtain

$$
\begin{align*}
V_{n, X} & =\frac{1}{Z_{S} C_{i n} s+1}\left[V_{n, M 1}+\frac{1}{g_{m} R_{D}} V_{n, R D}+C_{i n} s Z_{S}\left(V_{n, M 1}+\frac{1}{g_{m} R_{D}} V_{n, R D}\right)\right] \\
& =V_{n, M 1}+\frac{1}{g_{m} R_{D}} V_{n, R D} \tag{7.60}
\end{align*}
$$

Note that $V_{n, X}$ is independent of $Z_{S}$ and $C_{i n}$. It follows that

$$
\begin{align*}
\overline{V_{n, \text { out }}^{2}} & =g_{m}^{2} R_{D}^{2} \overline{V_{n, X}^{2}}  \tag{7.61}\\
& =4 k T\left(\gamma g_{m}+\frac{1}{R_{D}}\right) R_{D}^{2} \tag{7.62}
\end{align*}
$$

the same as (7.52). Thus, $V_{n, i n}$ and $I_{n, i n}$ do not "double count" the noise.
Another Approach In some cases, it is simpler to consider the output short-circuit noise currentrather than the output open-circuit noise voltage-for these calculations. This current is then multiplied by the circuit's output resistance to yield the output noise voltage or simply divided by a proper gain to give the input-referred quantities. The following example illustrates this approach.

#### Example 7.13

Determine the input-referred noise voltage and current for the amplifier shown in Fig. 7.38(a). Assume that $I_{1}$ is noiseless and $\lambda=0$.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-242.jpg?height=749&width=1405&top_left_y=1203&top_left_x=335)

Figure 7.38

#### Solution

To compute the input-referred noise voltage, we must short the input port. In this case, we can also short the output port as shown in Fig. 7.38(b), and find the output noise current due to $R_{F}$ and $M_{1}$. Since both terminals of $R_{F}$ are at ac ground, a KVL yields

$$
\begin{equation*}
\overline{I_{n 1, \text { out }}^{2}}=\frac{4 k T}{R_{F}}+4 k T \gamma g_{m} \tag{7.63}
\end{equation*}
$$

The output impedance of the circuit with the input shorted is simply equal to $R_{F}$, yielding

$$
\begin{equation*}
\overline{V_{n 1, \text { out }}^{2}}=\left(\frac{4 k T}{R_{F}}+4 k T \gamma g_{m}\right) R_{F}^{2} \tag{7.64}
\end{equation*}
$$

We can calculate the input-referred noise voltage by dividing (7.64) by the voltage gain or by dividing (7.63) by the transconductance, $G_{m}$. Let us pursue the latter method. As depicted in Fig. 7.38(c),

$$
\begin{align*}
G_{m} & =\frac{I_{\text {out }}}{V_{\text {in }}}  \tag{7.65}\\
& =g_{m}-\frac{1}{R_{F}} \tag{7.66}
\end{align*}
$$

Dividing (7.63) by $G_{m}^{2}$ gives

$$
\begin{equation*}
\overline{V_{n, i n}^{2}}=\frac{\frac{4 k T}{R_{F}}+4 k T \gamma g_{m}}{\left(g_{m}-\frac{1}{R_{F}}\right)^{2}} \tag{7.67}
\end{equation*}
$$

For the input-referred noise current, we first compute the output noise current with the input left open [Fig. 7.38(d)]. Since $V_{n, R F}$ directly modulates the gate-source voltage of $M_{1}$, producing a drain current of $4 k T R_{F} g_{m}^{2}$, we have

$$
\begin{equation*}
\overline{I_{n 2, \text { out }}^{2}}=4 k T R_{F} g_{m}^{2}+4 k T \gamma g_{m} \tag{7.68}
\end{equation*}
$$

Next, we must determine the current gain of the circuit according to the arrangement shown in Fig. 7.38(c). Noting that $V_{G S}=I_{i n} R_{F}$, and hence $I_{D}=g_{m} I_{i n} R_{F}$, we obtain

$$
\begin{align*}
I_{\text {out }} & =g_{m} R_{F} I_{i n}-I_{i n}  \tag{7.69}\\
& =\left(g_{m} R_{F}-1\right) I_{i n} \tag{7.70}
\end{align*}
$$

Dividing (7.68) by the square of the current gain yields

$$
\begin{equation*}
\overline{I_{n, i n}^{2}}=\frac{4 k T R_{F} g_{m}^{2}+4 k T \gamma g_{m}}{\left(g_{m} R_{F}-1\right)^{2}} \tag{7.71}
\end{equation*}
$$

The reader is encouraged to repeat this analysis using the output noise voltage rather than the output noise current.
The above circuit exemplifies cases where the output noise voltage is not the same for short-circuit and open-circuit input ports. The reader can prove that, if the input is left open, then

$$
\begin{equation*}
\overline{V_{n 2, \text { out }}^{2}}=\frac{4 k T \gamma}{g_{m}}+4 k T R_{F} \tag{7.72}
\end{equation*}
$$

## 7.4 ■ Noise in Single-Stage Amplifiers

Having developed basic mathematical tools and models for noise analysis, we now study the noise performance of single-stage amplifiers at low frequencies. Before considering specific topologies, we describe a lemma that simplifies noise calculations.
Lemma The circuits shown in Fig. 7.39(a) and (b) are equivalent at low frequencies if $\overline{V_{n}^{2}}=\overline{I_{n}^{2}} / g_{m}^{2}$ and the circuits are driven by a finite impedance.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-244.jpg?height=454&width=1345&top_left_y=242&top_left_x=352)

Figure 7.39 Equivalent CS stages.

Proof Since the circuits have equal output impedances, we simply examine the output short-circuit currents [Figs. 7.39(c) and (d)]. It can be proved (Problem 7.4) that the output noise current of the circuit in Fig. 7.39(c) is given by

$$
\begin{equation*}
I_{n, \text { out } 1}=\frac{I_{n}}{Z_{S}\left(g_{m}+g_{m b}+1 / r_{O}\right)+1} \tag{7.73}
\end{equation*}
$$

and that of Fig. 7.39(d) is

$$
\begin{equation*}
I_{n, \text { out } 2}=\frac{g_{m} V_{n}}{Z_{S}\left(g_{m}+g_{m b}+1 / r_{o}\right)+1} \tag{7.74}
\end{equation*}
$$

Equating (7.73) and (7.74), we have $V_{n}=I_{n} / g_{m}$. We call $V_{n}$ the "gate-referred" noise of $M_{1}$.
This lemma suggests that the noise source can be transformed from a drain-source current to a gate series voltage for arbitrary $Z_{S}$. We repeat this analysis in the presence of the gate-source capacitance in Problem 7.29.

#### Example 7.14

Prove the above lemma using Thevenin equivalents.

#### Solution

We construct a Thevenin model for the circuits in Figs. 7.39(a) and (b) but exclude $Z_{L}$, as depicted in Figs. 7.40(a) and (b). With $I_{n}=0$ and $V_{n}=0$, the two topologies are identical, and hence $Z_{T h e v 1}=Z_{\text {Thev2 }}$. We thus need only find the condition under which $V_{\text {Thev1 }}=V_{T h e v 2}$.

To obtain the Thevenin voltages, we must replace $Z_{L}$ with an open circuit [Fig.7.40(c)]. ${ }^{10}$ Since the current flowing through $Z_{S}$ is zero in both circuits, we have $V_{T h e v 1}=I_{n} r_{O}$ and $V_{T h e v}=g_{m} V_{n} r_{O}$. It follows that $V_{n}=I_{n} / g_{m}$.

### 7.4.1 Common-Source Stage

From Example 7.11, the input-referred noise voltage per unit bandwidth of a simple CS stage is equal to

$$
\begin{equation*}
\overline{V_{n, i n}^{2}}=4 k T\left(\frac{\gamma}{g_{m}}+\frac{1}{g_{m}^{2} R_{D}}\right)+\frac{K}{C_{o x} W L} \frac{1}{f} \tag{7.75}
\end{equation*}
$$

[^40]![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-245.jpg?height=808&width=1494&top_left_y=236&top_left_x=242)

Figure 7.40
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-245.jpg?height=349&width=646&top_left_y=1152&top_left_x=379)

Figure 7.41 Voltage amplification versus current generation.

From the above lemma, we recognize that the term $4 k T \gamma / g_{m}$ is in fact the thermal noise current of $M_{1}$ expressed as a voltage in series with the gate.

How can we reduce the input-referred noise voltage? Equation (7.75) implies that the transconductance of $M_{1}$ must be maximized. Thus, the transconductance must be maximized if the transistor is to amplify a voltage signal applied to its gate [Fig. 7.41(a)] whereas it must be minimized if the transistor operates as a constant current source [Fig. 7.41(b)], as illustrated by the following example.

#### Example 7.15

Calculate the input-referred thermal noise voltage of the amplifier shown in Fig. 7.42(a), assuming both transistors are in saturation. Also, determine the total output thermal noise if the circuit drives a load capacitance $C_{L}$. What is the output signal-to-noise ratio if a low-frequency sinusoid of peak amplitude $V_{m}$ is applied to the input?

#### Solution

Representing the thermal noise of $M_{1}$ and $M_{2}$ by current sources [Fig. 7.42(b)] and noting that they are uncorrelated, we write

$$
\begin{equation*}
\overline{V_{n, \text { out }}^{2}}=4 k T\left(\gamma g_{m 1}+\gamma g_{m 2}\right)\left(r_{O 1} \| r_{O 2}\right)^{2} \tag{7.76}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-246.jpg?height=405&width=936&top_left_y=233&top_left_x=572)

Figure 7.42
(In reality, $\gamma$ may not be the same for NMOS and PMOS devices.) Since the voltage gain is equal to $g_{m 1}\left(r_{O 1} \| r_{O 2}\right)$, the total noise voltage referred to the gate of $M_{1}$ is

$$
\begin{align*}
\overline{V_{n, i n}^{2}} & =4 k T\left(\gamma g_{m 1}+\gamma g_{m 2}\right) \frac{1}{g_{m 1}^{2}}  \tag{7.77}\\
& =4 k T \gamma\left(\frac{1}{g_{m 1}}+\frac{g_{m 2}}{g_{m 1}^{2}}\right) \tag{7.78}
\end{align*}
$$

Equation (7.78) reveals the dependence of $\overline{V_{n, i n}^{2}}$ upon $g_{m 1}$ and $g_{m 2}$, confirming that $g_{m 2}$ must be minimized because $M_{2}$ serves as a current source rather than a transconductor. ${ }^{11}$

The reader may wonder why $M_{1}$ and $M_{2}$ in Fig. 7.42 exhibit different noise effects. After all, if the noise currents of both transistors flow through $r_{O 1} \| r_{O 2}$, why should $g_{m 1}$ be maximized and $g_{m 2}$ minimized? This is simply because, as $g_{m 1}$ increases, the output noise voltage rises in proportion to $\sqrt{g_{m 1}}$ whereas the voltage gain of the stage increases in proportion to $g_{m 1}$. As a result, the input-referred noise voltage decreases. Such a trend does not apply to $M_{2}$.

To compute the total output noise, we integrate (7.76) across the band:

$$
\begin{equation*}
\overline{V_{n, \text { out }, \text { tot }}^{2}}=\int_{0}^{\infty} 4 k T \gamma\left(g_{m 1}+g_{m 2}\right)\left(r_{O 1} \| r_{O 2}\right)^{2} \frac{d f}{1+\left(r_{O 1} \| r_{O 2}\right)^{2} C_{L}^{2}(2 \pi f)^{2}} \tag{7.79}
\end{equation*}
$$

Using the results of Example 7.3, we have

$$
\begin{equation*}
\overline{V_{n, \text { out }, \text { tot }}^{2}}=\gamma\left(g_{m 1}+g_{m 2}\right)\left(r_{O 1} \| r_{O 2}\right) \frac{k T}{C_{L}} \tag{7.80}
\end{equation*}
$$

A low-frequency input sinusoid of amplitude $V_{m}$ yields an output amplitude equal to $g_{m 1}\left(r_{O 1} \| r_{O 2}\right) V_{m}$. The output SNR is equal to the ratio of the signal power and the noise power:

$$
\begin{align*}
\mathrm{SNR}_{o u t} & =\left[\frac{g_{m 1}\left(r_{O 1} \| r_{O 2}\right) V_{m}}{\sqrt{2}}\right]^{2} \cdot \frac{1}{\gamma\left(g_{m 1}+g_{m 2}\right)\left(r_{O 1} \| r_{O 2}\right)\left(k T / C_{L}\right)}  \tag{7.81}\\
& =\frac{C_{L}}{2 \gamma k T} \cdot \frac{g_{m 1}^{2}\left(r_{O 1} \| r_{O 2}\right)}{g_{m 1}+g_{m 2}} V_{m}^{2} \tag{7.82}
\end{align*}
$$

We note that to maximize the output SNR, $C_{L}$ must be maximized, i.e., the bandwidth must be minimized. Of course, the bandwidth is also dictated by the input signal spectrum. This example indicates that it becomes exceedingly difficult to design broadband circuits while maintaining low noise.

[^41]
#### Example 7.16

Determine the input-referred thermal noise voltage of the complementary common-source stage shown in Fig. 7.43.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-247.jpg?height=316&width=357&top_left_y=380&top_left_x=518)

Figure 7.43

#### Solution

With the input signal set to zero, this circuit produces the same output noise voltage as the circuit in Fig. 7.42(a) does. But the complementary stage provides a higher voltage gain, $\left(g_{m 1}+g_{m 2}\right)\left(r_{O 1} \| r_{O 2}\right)$. The input-referred noise voltage is thus given by

$$
\begin{equation*}
\overline{V_{n, i n}^{2}}=\frac{4 k T \gamma}{g_{m 1}+g_{m 2}} \tag{7.83}
\end{equation*}
$$

an expected result because $M_{1}$ and $M_{2}$ operate in "parallel," and hence their transconductances add. Why does this topology exhibit a lower input noise than the circuit of Fig. 7.42(a)? In both cases, $M_{2}$ injects noise to the output node, but in the complementary stage, this device operates as a transconductor and amplifies the input.

For a simple CS stage with resistive load, Eq. (7.75) suggests that the thermal noise can be reduced by increasing the bias current. But, for a given headroom, this requires that we decrease $R_{D}$ and hence increase its noise contribution. In order to quantify this trade-off, we express $g_{m}$ as $2 I_{D} /\left(V_{G S}-V_{T H}\right)$ and write the input-referred thermal noise as

$$
\begin{equation*}
\overline{V_{n, i n}^{2}}=4 k T\left[\frac{\gamma\left(V_{G S}-V_{T H}\right)}{2 I_{D}}+\frac{\left(V_{G S}-V_{T H}\right)^{2}}{4 I_{D} \cdot I_{D} R_{D}}\right] \tag{7.84}
\end{equation*}
$$

This equation suggests that $V_{n, i n}$ falls if $I_{D}$ is increased and $I_{D} R_{D}$ kept constant provided that $V_{G S}-V_{T H}$ also remains constant, i.e., if the transistor width increases in proportion to $I_{D}$.

#### Example 7.17

Calculate the input-referred $1 / f$ and thermal noise voltage of the CS stage depicted in Fig. 7.44(a), assuming $M_{1}$ and $M_{2}$ are in saturation.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-247.jpg?height=328&width=403&top_left_y=1844&top_left_x=436)
(a)
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-247.jpg?height=342&width=613&top_left_y=1842&top_left_x=882)
(b)

Figure 7.44

#### Solution

We model the $1 / f$ and thermal noise of the transistors as voltage sources in series with their gates [Fig. 7.44(b)]. The noise voltage at the gate of $M_{2}$ experiences a gain of $g_{m 2}\left(R_{D}\left\|r_{O 1}\right\| r_{O 2}\right)$ as it appears at the output. The result must then be divided by $g_{m 1}\left(R_{D}\left\|r_{O 1}\right\| r_{O 2}\right)$ to be referred to the main input. The noise current of $R_{D}$ is multiplied by $R_{D}\left\|r_{O 1}\right\| r_{O 2}$ and divided by $g_{m 1}\left(R_{D}\left\|r_{O 1}\right\| r_{O 2}\right)$. Thus, the overall input-referred noise voltage is given by

$$
\begin{equation*}
\overline{V_{n, i n}^{2}}=4 k T \gamma\left(\frac{g_{m 2}}{g_{m 1}^{2}}+\frac{1}{g_{m 1}}\right)+\frac{1}{C_{o x}}\left[\frac{K_{P} g_{m 2}^{2}}{(W L)_{2} g_{m 1}^{2}}+\frac{K_{N}}{(W L)_{1}}\right] \frac{1}{f}+\frac{4 k T}{g_{m 1}^{2} R_{D}} \tag{7.85}
\end{equation*}
$$

where $K_{P}$ and $K_{N}$ denote the flicker noise coefficients of PMOS and NMOS devices, respectively. Note that the circuit reduces to that in Fig. 7.42(a) or 7.29 (a) if $R_{D}=\infty$ or $g_{m 2}=0$, respectively. How should the bias current of $M_{2}$ be chosen to minimize $V_{n, i n}$ if the dc voltage drop across $R_{D}$ is fixed? This is left as an exercise for the reader.

How do we design a common-source stage for low-noise operation? For thermal noise in the simple topology of Fig. 7.41, we must maximize $g_{m 1}$ by increasing the drain current or the device width. A higher $I_{D}$ translates to greater power dissipation and limited output voltage swings while a wider device leads to larger input and output capacitance. We can also increase $R_{D}$, but at the cost of limiting the voltage headroom and lowering the speed.

For $1 / f$ noise, the primary approach is to increase the area of the transistor. If $W L$ is increased while $W / L$ remains constant, then the device transconductance, and hence its thermal noise, do not change, but the device capacitances increase. These observations point to the trade-offs between noise, power dissipation, voltage headroom, and speed.

#### Example 7.18

A student writes the drain flicker noise current of a MOS device as $\left[K /\left(W L C_{o x} f\right)\right] g_{m}^{2}=\left[K /\left(W L C_{o x} f\right)\right]$ $\left(\sqrt{2 \mu_{n} C_{o x}(W / L) I_{D}}\right)^{2}=2 K \mu_{n} I_{D} /\left(L^{2} f\right)$, concluding that the flicker noise current is independent of $W$. Explain the flaw in this argument.

#### Solution

A fair comparison must keep both the overdrive and $I_{D}$ constant as $W$ changes. (If we allow $V_{G S}-V_{T H}$ to change, then the drain voltage headroom also changes.). Thus, we can express the drain flicker noise current as $\left[K /\left(W L C_{o x} f\right)\right]\left(4 I_{D}^{2}\right) /\left(V_{G S}-V_{T H}\right)^{2}$, which reveals that the noise current decreases as $W L$ increases.

#### Example 7.19

Design a resistively-loaded common-source stage with a total input-referred noise voltage of $100 \mu \mathrm{~V}_{\mathrm{rms}}$, a power budget of 1 mW , a bandwidth of 1 GHz , and a supply voltage of 1 V . Neglect channel-length modulation and flicker noise and assume that the bandwidth is limited by the load capacitance.

#### Solution

Illustrated in Fig. 7.45(a), the circuit produces noise at the output in a bandwidth given by $R_{D}$ and $C_{L}$. From the noise model shown in Fig. 7.45(b), the reader can derive a Thevenin equivalent for the circuit in the dashed box, obtaining the output noise spectrum as

$$
\begin{align*}
\overline{V_{n, \text { out }}^{2}} & =\left(\overline{V_{n, R D}^{2}}+R_{D}^{2} \overline{I_{n, M 1}^{2}}\right) \frac{1}{R_{D}^{2} C_{L}^{2} \omega^{2}+1}  \tag{7.86}\\
& =\left(4 k T R_{D}+4 k T \gamma g_{m} R_{D}^{2}\right) \frac{1}{R_{D}^{2} C_{L}^{2} \omega^{2}+1} \tag{7.87}
\end{align*}
$$

![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-249.jpg?height=352&width=1005&top_left_y=236&top_left_x=466)

Figure 7.45

Since we know that the integral of $4 k T R_{D} /\left(R_{D}^{2} C_{L}^{2} \omega^{2}+1\right)$ from 0 to $\infty$ yields a value of $k T / C_{L}$, we manipulate the transistor noise contribution as follows:

$$
\begin{equation*}
\overline{V_{n, \text { out }}^{2}}=\frac{4 k T R_{D}}{R_{D}^{2} C_{L}^{2} \omega^{2}+1}+\gamma g_{m} R_{D} \frac{4 k T R_{D}}{R_{D}^{2} C_{L}^{2} \omega^{2}+1} \tag{7.88}
\end{equation*}
$$

Integration from 0 to $\infty$ thus gives

$$
\begin{align*}
\overline{V_{n, \text { out }, t o t}^{2}} & =\frac{k T}{C_{L}}+\gamma g_{m} R_{D} \frac{k T}{C_{L}}  \tag{7.89}\\
& =\left(1+\gamma g_{m} R_{D}\right) \frac{k T}{C_{L}} \tag{7.90}
\end{align*}
$$

This noise must be divided by $g_{m}^{2} R_{D}^{2}$ and equated to $\left(100 \mu \mathrm{~V}_{\mathrm{rms}}\right)^{2}$. We also note that $1 /\left(2 \pi R_{D} C_{L}\right)=1 \mathrm{GHz}$ and $k T=4.14 \times 10^{-21} \mathrm{~J}$ at the room temperature, arriving at

$$
\begin{equation*}
\frac{1+\gamma g_{m} R_{D}}{g_{m}^{2} R_{D}} \cdot \frac{2 \pi k T}{2 \pi R_{D} C_{L}}=\left(100 \mu \mathrm{~V}_{\mathrm{rms}}\right)^{2} \tag{7.91}
\end{equation*}
$$

and hence

$$
\begin{equation*}
\frac{1}{g_{m}}\left(\frac{1}{g_{m} R_{D}}+\gamma\right)=384 \Omega \tag{7.92}
\end{equation*}
$$

We have some flexibility in the choice of $g_{m}$ and $R_{D}$ here. For example, if $g_{m} R_{D}=3$ and $\gamma=1$, then $1 / g_{m}=288 \Omega$ and $R_{D}=864 \Omega$. With a drain-current budget of $1 \mathrm{~mW} / V_{D D}=1 \mathrm{~mA}$, we can choose $W / L$ so as to obtain this amount of transconductance.

The above choice of the voltage gain and the resulting values of $R_{D}$ and $g_{m}$ must be checked against the bias conditions. Since $R_{D} I_{D}=864 \mathrm{mV}, V_{D S, \min }=136 \mathrm{mV}$, leaving little headroom for voltage swings. The reader is encouraged to try $g_{m} R_{D}=2$ or 4 to see how the voltage headroom depends on the choice of the gain.

### 7.4.2 Common-Gate Stage

Thermal Noise Consider the common-gate configuration shown in Fig. 7.46(a). Neglecting channellength modulation, we represent the thermal noise of $M_{1}$ and $R_{D}$ by two current sources [Fig. 7.46(b)]. Note that, owing to the low input impedance of the circuit, the input-referred noise current is not negligible even at low frequencies. To calculate the input-referred noise voltage, we short the input to ground and equate the output noises of the circuits in Figs. 7.47(a) and (b):

$$
\begin{equation*}
\left(4 k T \gamma g_{m}+\frac{4 k T}{R_{D}}\right) R_{D}^{2}=\overline{V_{n, i n}^{2}}\left(g_{m}+g_{m b}\right)^{2} R_{D}^{2} \tag{7.93}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-250.jpg?height=411&width=823&top_left_y=230&top_left_x=628)

Figure 7.46 (a) CG stage; (b) circuit including noise sources.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-250.jpg?height=487&width=1476&top_left_y=717&top_left_x=307)

Figure 7.47 Calculation of input-referred noise of a CG stage.

That is

$$
\begin{equation*}
\overline{V_{n, i n}^{2}}=\frac{4 k T\left(\gamma g_{m}+1 / R_{D}\right)}{\left(g_{m}+g_{m b}\right)^{2}} \tag{7.94}
\end{equation*}
$$

Similarly, equating the output noises of the circuits in Figs. 7.47(c) and (d) yields the input-referred noise current. What is the effect of $\overline{I_{n 1}^{2}}$ at the output in Fig. 7.47(c)? Since the sum of the currents at the source of $M_{1}$ is zero, $I_{n 1}+I_{D 1}=0$. Consequently, $I_{n 1}$ creates an equal and opposite current in $M_{1}$, producing no noise at the output. The output noise voltage of Fig. 7.46(a) is therefore equal to $4 k T R_{D}$, and hence $\overline{I_{n, i n}^{2}} R_{D}^{2}=4 k T R_{D}$. That is

$$
\begin{equation*}
\overline{I_{n, i n}^{2}}=\frac{4 k T}{R_{D}} \tag{7.95}
\end{equation*}
$$

An important drawback of the common-gate topology is that it directly refers the noise current produced by the load to the input. Exemplified by (7.95), this effect arises because such a circuit provides no current gain, a point of contrast to common-source amplifiers.

We have thus far neglected the noise contributed by the bias-current source of a common-gate stage. Shown in Fig. 7.48 is a simple mirror arrangement establishing the bias current of $M_{1}$ as a multiple of $I_{1}$. Capacitor $C_{0}$ shunts the noise generated by $M_{0}$ to ground. We note that if the input of the circuit is shorted to ground, then the drain noise current of $M_{2}$ does not flow through $R_{D}$, contributing no input-referred noise voltage. On the other hand, if the input is open, all of $\overline{I_{n 2}^{2}}$ flows from $M_{1}$ and $R_{D}$ (at low frequencies), producing an output noise equal to $\overline{I_{n 2}^{2}} R_{D}^{2}$ and hence an input-referred noise current of $\overline{I_{n 2}^{2}}$. As a result, the noise current of $M_{2}$ directly adds to the input-referred noise current, making it desirable to minimize
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-251.jpg?height=465&width=513&top_left_y=244&top_left_x=445)

Figure 7.48 Noise contributed by bias-current source.
the transconductance of $M_{2}$. For a given bias current, however, this translates to a higher drain-source voltage for $M_{2}$ because $g_{m 2}=2 I_{D 2} /\left(V_{G S 2}-V_{T H 2}\right)$, requiring a high value for $V_{b}$ and limiting the voltage swing at the output node.

#### Example 7.20

Calculate the input-referred thermal noise voltage and current of the circuit shown in Fig. 7.49 assuming that all of the transistors are in saturation.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-251.jpg?height=475&width=590&top_left_y=1079&top_left_x=399)

Figure 7.49

#### Solution

To compute the input-referred noise voltage, we short the input to ground, obtaining

$$
\begin{equation*}
\overline{V_{n 1, \text { out }}^{2}}=4 k T \gamma\left(g_{m 1}+g_{m 3}\right)\left(r_{O 1} \| r_{O 3}\right)^{2} \tag{7.96}
\end{equation*}
$$

Thus, the input-referred noise voltage, $V_{n, i n}$, must satisfy this relationship:

$$
\begin{equation*}
\overline{V_{n, i n}^{2}}\left(g_{m 1}+g_{m b 1}\right)^{2}\left(r_{O 1} \| r_{O 3}\right)^{2}=4 k T \gamma\left(g_{m 1}+g_{m 3}\right)\left(r_{O 1} \| r_{O 3}\right)^{2} \tag{7.97}
\end{equation*}
$$

where the voltage gain from $V_{\text {in }}$ to $V_{\text {out }}$ is approximated by $\left(g_{m 1}+g_{m b 1}\right)\left(r_{O 1} \| r_{O 3}\right)$. It follows that

$$
\begin{equation*}
\overline{V_{n, i n}^{2}}=4 k T \gamma \frac{\left(g_{m 1}+g_{m 3}\right)}{\left(g_{m 1}+g_{m b 1}\right)^{2}} \tag{7.98}
\end{equation*}
$$

As expected, the noise is proportional to $g_{m 3}$.
To calculate the input-referred noise current, we open the input and note that the output noise voltage due to $M_{3}$ is simply given by $I_{n 3}^{2} R_{o u t}^{2}$, where $R_{o u t}=r_{O 3} \|\left[r_{O 2}+\left(g_{m 1}+g_{m b 1}\right) r_{O 1} r_{O 2}+r_{O 1}\right]$ denotes the output impedance
when the input is open. The reader can prove that, in response to an input current $I_{i n}$, the circuit generates an output voltage given by

$$
\begin{equation*}
V_{\text {out }}=\frac{\left(g_{m 1}+g_{m b 1}\right) r_{O 1}+1}{r_{O 1}+\left(g_{m 1}+g_{m b 1}\right) r_{O 1} r_{O 2}+r_{O 2}+r_{O 3}} r_{O 3} r_{O 2} I_{i n} \tag{7.99}
\end{equation*}
$$

Dividing $I_{n 3} R_{\text {out }}$ by this gain to refer the noise of $M_{3}$ to the input, we have

$$
\begin{equation*}
\left.I_{n, i n}\right|_{M 3}=\frac{r_{O 2}+\left(g_{m 1}+g_{m b 1}\right) r_{O 1} r_{O 2}+r_{O 1}}{r_{O 2}\left[\left(g_{m 1}+g_{m b 1}\right) r_{O 1}+1\right]} I_{n 3} \tag{7.100}
\end{equation*}
$$

which reduces to

$$
\begin{align*}
\left.I_{n, i n}\right|_{M 3} & \approx I_{n 3}  \tag{7.101}\\
& \approx 4 k T \gamma g_{m 3} \tag{7.102}
\end{align*}
$$

if any $g_{m} r_{O}$ product is much greater than unity. Since the noise current of $M_{2}$ directly adds to the input, we have

$$
\begin{equation*}
\overline{I_{n, i n}^{2}}=4 k T \gamma\left(g_{m 2}+g_{m 3}\right) \tag{7.103}
\end{equation*}
$$

Again, the noise is proportional to the transconductance of the two current sources. In the above calculations, we have neglected the effect of $I_{n 1}$ when the input is left open even though the source of $M_{1}$ sees a finite degeneration (ro2). In Problem 7.31, we refer this noise to the input and prove that it is still negligible.

Flicker Noise The effect of $1 / f$ noise in a common-gate topology is also of interest. As a typical case, we compute the input-referred $1 / f$ noise voltage and current of the circuit shown in Fig. 7.49. Illustrated in Fig. 7.50, each $1 / f$ noise generator is modeled by a voltage source in series with the gate of the corresponding transistor. Note that the $1 / f$ noise of $M_{0}$ and $M_{4}$ is neglected. A more realistic case is studied in Problem 7.10.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-252.jpg?height=482&width=462&top_left_y=1406&top_left_x=532)

Figure 7.50 Flicker noise in a CG stage.

With the input shorted to ground, we have

$$
\begin{equation*}
\overline{V_{n 1, \text { out }}^{2}}=\frac{1}{C_{o x} f}\left[\frac{g_{m 1}^{2} K_{N}}{(W L)_{1}}+\frac{g_{m 3}^{2} K_{P}}{(W L)_{3}}\right]\left(r_{O 1} \| r_{O 3}\right)^{2} \tag{7.104}
\end{equation*}
$$

where $K_{N}$ and $K_{P}$ denote the flicker noise coefficients of NMOS and PMOS devices, respectively. Approximating the voltage gain as $\left(g_{m 1}+g_{m b 1}\right)\left(r_{O 1} \| r_{O 3}\right)$, we obtain

$$
\begin{equation*}
\overline{V_{n, i n}^{2}}=\frac{1}{C_{o x} f}\left[\frac{g_{m 1}^{2} K_{N}}{(W L)_{1}}+\frac{g_{m 3}^{2} K_{P}}{(W L)_{3}}\right] \frac{1}{\left(g_{m 1}+g_{m b 1}\right)^{2}} \tag{7.105}
\end{equation*}
$$

With the input open, the output noise voltage is approximately given by

$$
\begin{equation*}
\overline{V_{n 2, \text { out }}^{2}}=\frac{1}{C_{o x} f}\left[\frac{g_{m 2}^{2} K_{N}}{(W L)_{2}}+\frac{g_{m 3}^{2} K_{P}}{(W L)_{3}}\right] R_{\text {out }}^{2} \tag{7.106}
\end{equation*}
$$

where it is assumed that the transconductance from the gate of $M_{2}$ to the output is equal to $g_{m 2}$. It follows that

$$
\begin{equation*}
\overline{I_{n, i n}^{2}}=\frac{1}{C_{o x} f}\left[\frac{g_{m 2}^{2} K_{N}}{(W L)_{2}}+\frac{g_{m 3}^{2} K_{P}}{(W L)_{3}}\right] \tag{7.107}
\end{equation*}
$$

Equations (7.105) and (7.107) describe the $1 / f$ noise behavior of the circuit and must be added to (7.98) and (7.103), respectively, to obtain the overall noise per unit bandwidth.

### 7.4.3 Source Followers

Consider the source follower depicted in Fig. 7.51(a), where $M_{2}$ serves as the bias-current source. Since the input impedance of the circuit is quite high, even at relatively high frequencies, the input-referred noise current can usually be neglected for moderate driving source impedances. To compute the inputreferred thermal noise voltage, we employ the representation in Fig. 7.51(b), expressing the output noise due to $M_{2}$ as

$$
\begin{equation*}
\left.\overline{V_{n, \text { out }}^{2}}\right|_{M 2}=\overline{I_{n 2}^{2}}\left(\frac{1}{g_{m 1}}\left\|\frac{1}{g_{m b 1}}\right\| r_{O 1} \| r_{O 2}\right)^{2} \tag{7.108}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-253.jpg?height=339&width=813&top_left_y=1275&top_left_x=562)

Figure 7.51 (a) Source follower; (b) circuit including noise sources.
From Chapter 3,

$$
\begin{equation*}
A_{v}=\frac{\frac{1}{g_{m b 1}}\left\|r_{O 1}\right\| r_{O 2}}{\frac{1}{g_{m b 1}}\left\|r_{O 1}\right\| r_{O 2}+\frac{1}{g_{m 1}}} \tag{7.109}
\end{equation*}
$$

Thus, the total input-referred noise voltage is

$$
\begin{align*}
\overline{V_{n, \text { in }}^{2}} & =\overline{V_{n 1}^{2}}+\frac{\left.\overline{V_{n, \text { out }}^{2}}\right|_{M 2}}{A_{v}^{2}}  \tag{7.110}\\
& =4 k T \gamma\left(\frac{1}{g_{m 1}}+\frac{g_{m 2}}{g_{m 1}^{2}}\right) \tag{7.111}
\end{align*}
$$

Note the similarity between (7.78) and (7.111).

Since source followers add noise to the input signal while providing a voltage gain of less than unity, they are usually avoided in low-noise amplification. The $1 / f$ noise performance of source followers is studied in Problem 7.11.

### 7.4.4 Cascode Stage

Consider the cascode stage of Fig. 7.52(a). Since at low frequencies the noise currents of $M_{1}$ and $R_{D}$ mostly flow through $R_{D}$, the noise contributed by these two devices is quantified as in a common-source stage:

$$
\begin{equation*}
\left.\overline{V_{n, i n}^{2}}\right|_{M 1, R D}=4 k T\left(\frac{\gamma}{g_{m 1}}+\frac{1}{g_{m 1}^{2} R_{D}}\right) \tag{7.112}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-254.jpg?height=526&width=1210&top_left_y=726&top_left_x=430)

Figure 7.52 (a) Cascode stage; (b) noise of $M_{2}$ modeled by a current source; (c) noise of $M_{2}$ modeled by a voltage source.
where $1 / f$ noise of $M_{1}$ is ignored. What is the effect of noise of $M_{2}$ ? Modeled as in Fig. 7.52(b), this noise contributes negligibly to the output, especially at low frequencies. This is because, if channel-length modulation in $M_{1}$ is neglected, then $I_{n 2}+I_{D 2}=0$, and hence $M_{2}$ does not affect $V_{n, \text { out }}$. From another point of view, using the lemma of Fig. 7.39 to construct the equivalent in Fig. 7.52(c), we note that the voltage gain from $V_{n 2}$ to the output is quite small if the impedance at node $X$ is large. At high frequencies, on the other hand, the total capacitance at node $X, C_{X}$, gives rise to a gain:

$$
\begin{equation*}
\frac{V_{n, \text { out }}}{V_{n 2}} \approx \frac{-R_{D}}{1 / g_{m 2}+1 /\left(C_{X} s\right)} \tag{7.113}
\end{equation*}
$$

increasing the output noise. This capacitance also reduces the gain from the main input to the output by shunting the signal current produced by $M_{1}$ to ground. As a result, the input-referred noise of a cascode stage may rise considerably at high frequencies.

If $R_{D}$ in Fig. 7.52(c) is large, e.g., if it represents the output resistance of a PMOS cascode load, then the gain from $V_{n 2}$ to $V_{\text {out }}$ may not be small. The reader can show that, if $R_{D} \approx g_{m} r_{O}^{2}$ (for a cascode), then $V_{\text {out }} / V_{n}$ is still much greater, making the contribution of $V_{n}$ negligible.

## 7.5 ■ Noise in Current Mirrors

The noise produced by the devices in current mirrors may propagate to the output of interest. In Figs. 7.48 and 7.49 , for example, the diode-connected device may contribute substantial flicker noise unless an extremely large bypass capacitor is used. This effect is exacerbated by the bias-current multiplication factor in the current mirror.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-255.jpg?height=421&width=1497&top_left_y=233&top_left_x=222)

Figure 7.53 (a) Current mirror using a capacitor to suppress diode-connected device's noise, (b) small-signal model, and (c) overall equivalent circuit.

To appreciate the difficulty with current-mirror flicker noise, let us study the simple topology shown in Fig. 7.53(a), where $(W / L)_{1}=N(W / L)_{R E F}$. The multiplication factor, $N$, is in the range of 5 to 10 so as to minimize the power consumed by the reference branch. We wish to determine the flicker noise in $I_{D 1}$. We assume that $\lambda=0$ and $I_{R E F}$ is noiseless but caution the reader that, as described in Chapter 12, the noise of the reference (bandgap) current may not be negligible. We first construct a Thevenin equivalent for $M_{R E F}$ and its flicker noise, $V_{n, R E F}$ : as depicted in Fig. 7.53 (b), the open-circuit voltage is equal to $V_{n, R E F}$ because $V_{1}$ must be zero (why?). Noting that the Thevenin resistance is equal to $1 / g_{m, R E F}$, we arrive at the arrangement in Fig. 7.53(c), where the noise voltage at node $X$ and $V_{n 1}$ add (without correlation) and drive the gate of $M_{1}$, producing

$$
\begin{equation*}
\overline{I_{n, \text { out }}^{2}}=\left(\frac{g_{m, R E F}^{2}}{C_{B}^{2} \omega^{2}+g_{m, R E F}^{2}} \overline{V_{n, R E F}^{2}}+\overline{V_{n 1}^{2}}\right) g_{m 1}^{2} \tag{7.114}
\end{equation*}
$$

Since $(W / L)_{1}=N(W / L)_{R E F}$ and, typically, $L_{1}=L_{R E F}$, we observe that $\overline{V_{n, R E F}^{2}}=N \overline{V_{n 1}^{2}}$ because the flicker noise power spectral density is inversely proportional to the channel area, $W L$. It follows that

$$
\begin{equation*}
\overline{I_{n, \text { out }}^{2}}=\left(\frac{N g_{m, R E F}^{2}}{C_{B}^{2} \omega^{2}+g_{m, R E F}^{2}}+1\right) g_{m 1}^{2} \overline{V_{n 1}^{2}} \tag{7.115}
\end{equation*}
$$

For the noise of the diode-connected device to be negligible, we must ensure that the first term inside the parentheses is small:

$$
\begin{equation*}
(N-1) g_{m, R E F}^{2} \ll C_{B}^{2} \omega^{2} \tag{7.116}
\end{equation*}
$$

and hence

$$
\begin{equation*}
C_{B}^{2} \gg \frac{(N-1) g_{m, R E F}^{2}}{\omega^{2}} \tag{7.117}
\end{equation*}
$$

For example, if $N=5, g_{m, R E F} \approx 1 /(200 \Omega)$, and the minimum frequency of interest is 1 MHz , we have $C_{B}^{2} \gg 2.533 \times 10^{-18} \mathrm{~F}$. For a tenfold suppression of the $M_{R E F}$ noise, this translates to 5.03 nF !

In order to reduce the noise contributed by $M_{R E F}$ while avoiding such a large capacitor, we can insert a resistance between its gate and $C_{B}$ [Fig. 7.54(a)] and revise Eq. (7.114) as

$$
\begin{equation*}
\overline{I_{n, \text { out }}^{2}}=\left[\frac{g_{m, R E F}^{2}}{\left(1+g_{m, R E F} R_{B}\right)^{2} C_{B}^{2} \omega^{2}+g_{m, R E F}^{2}}\left(\overline{V_{n, R E F}^{2}}+\overline{V_{n, R B}^{2}}\right)+\overline{V_{n 1}^{2}}\right] g_{m 1}^{2} \tag{7.118}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-256.jpg?height=352&width=457&top_left_y=303&top_left_x=545)
(a)
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-256.jpg?height=408&width=449&top_left_y=242&top_left_x=1066)
(b)

Figure 7.54 (a) Use of a resistor to filter a diode-connected device's noise, and (b) realization of the resistor by a MOSFET.

The series resistance lowers the filter cutoff frequency to $\left[\left(1 / g_{m 1, R E F}+R_{B}\right) C_{B}\right]^{-1}$ but also contributes its own noise. We can thus increase $R_{B}$ before $\overline{V_{n, R B}^{2}}$ becomes an appreciable fraction of $\overline{V_{n, R E F}^{2}}$.

In practice, $R_{B}$ can be quite large before its thermal noise becomes comparable with the flicker noise of $M_{R E F}$. The upper bound on $R_{B}$ is therefore dictated by the area trade-off between $R_{B}$ and $C_{B} .{ }^{12} \mathrm{We}$ thus seek a circuit arrangement that provides a high resistance and occupies a moderate area. Fortunately, we have developed such a topology in Chapter 5: as shown in Fig. 7.54(b), a MOS device, $M_{R}$, with a small, but controlled overdrive serves our purpose. As explained in Chapter 5, $M_{R}$ is chosen narrow and long, and $M_{C}$ wide and short.

## 7.6 ■ Noise in Differential Pairs

With our understanding of noise in basic amplifiers, we can now study the noise behavior of differential pairs. Shown in Fig. 7.55(a), a differential pair can be viewed as a two-port circuit. It is therefore possible to model the overall noise as depicted in Fig. 7.55(b). For low-frequency operation, $\overline{I_{n, i n}^{2}}$ is negligible.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-256.jpg?height=536&width=1382&top_left_y=1489&top_left_x=349)

Figure 7.55 (a) Differential pair; (b) circuit including input-referred noise sources.
To calculate the thermal component of $\overline{V_{n, i n}^{2}}$, we first obtain the total output noise with the inputs shorted together [Fig. 7.56(a)], noting that superposition of power quantities is possible because the noise

[^42]![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-257.jpg?height=1171&width=1207&top_left_y=224&top_left_x=380)

Figure 7.56 Calculation of input-referred noise of a differential pair.
sources in the circuit are uncorrelated. Since $I_{n 1}$ and $I_{n 2}$ are uncorrelated, node $P$ cannot be considered a virtual ground, making it difficult to use the half-circuit concept. Thus, we simply derive the effect of each source individually. Depicted in Fig. 7.56(b), the contribution of $I_{n 1}$ is obtained by first reducing the circuit to that in Fig. 7.56(c). With the aid of this figure and neglecting channel-length modulation, the reader can prove that half of $I_{n 1}$ flows through $R_{D 1}$ and the other half through $M_{2}$ and $R_{D 2}$. [As shown in Fig. 7.56(d), this can also be proved by decomposing $I_{n 1}$ into two (correlated) current sources and calculating their effect at the output.] Thus, the differential output noise due to $M_{1}$ is equal to

$$
\begin{equation*}
\left.V_{n, \text { out }}\right|_{M 1}=\frac{I_{n 1}}{2} R_{D 1}+\frac{I_{n 1}}{2} R_{D 2} \tag{7.119}
\end{equation*}
$$

Note that the two noise voltages are directly added because they both arise from $I_{n 1}$ and are therefore correlated. It follows that, if $R_{D 1}=R_{D 2}=R_{D}$,

$$
\begin{equation*}
\left.\overline{V_{n, \text { out }}^{2}}\right|_{M 1}=\overline{I_{n 1}^{2}} R_{D}^{2} \tag{7.120}
\end{equation*}
$$

Similarly,

$$
\begin{equation*}
\left.\overline{V_{n, \text { out }}^{2}}\right|_{M 2}=\overline{I_{n 2}^{2}} R_{D}^{2} \tag{7.121}
\end{equation*}
$$

yielding

$$
\begin{equation*}
\left.\overline{V_{n, \text { out }}^{2}}\right|_{M 1, M 2}=\left(\overline{I_{n 1}^{2}}+\overline{I_{n 2}^{2}}\right) R_{D}^{2} \tag{7.122}
\end{equation*}
$$

Taking into account the noise of $R_{D 1}$ and $R_{D 2}$, we have for the total output noise

$$
\begin{align*}
\overline{V_{n, \text { out }}^{2}} & =\left(\overline{I_{n 1}^{2}}+\overline{I_{n 2}^{2}}\right) R_{D}^{2}+2\left(4 k T R_{D}\right)  \tag{7.123}\\
& =8 k T\left(\gamma g_{m} R_{D}^{2}+R_{D}\right) \tag{7.124}
\end{align*}
$$

Dividing the result by the square of the differential gain, $g_{m}^{2} R_{D}^{2}$, we obtain

$$
\begin{equation*}
\overline{V_{n, i n}^{2}}=8 k T\left(\frac{\gamma}{g_{m}}+\frac{1}{g_{m}^{2} R_{D}}\right) \tag{7.125}
\end{equation*}
$$

This is simply twice the input noise voltage squared of a common-source stage.
The input-referred noise voltage can also be calculated by exploiting the lemma illustrated in Fig. 7.39. As shown in Fig. 7.57, the noise of $M_{1}$ and $M_{2}$ is modeled as a voltage source in series with their gates, and the noise of $R_{D 1}$ and $R_{D 2}$ is divided by $g_{m}^{2} R_{D}^{2}$, thereby resulting in (7.125). The reader is encouraged to repeat these calculations if the tail current source is replaced with a short circuit.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-258.jpg?height=472&width=641&top_left_y=1109&top_left_x=445)

Figure 7.57 Alternative method of calculating the input-referred noise.

It is instructive to compare the noise performance of a differential pair and a common-source stage, as expressed by (7.75) and (7.125). We conclude that, if each transistor has a transconductance $g_{m}$, then the input-referred noise voltage of a differential pair is $\sqrt{2}$ times that of a common-source stage. This is simply because the former includes twice as many devices in the signal path, as exemplified by the two series voltage sources in Fig. 7.57. (Since the noise sources are uncorrelated, their powers add.) It is also important to recognize that, with the assumption of equal device transconductances, a differential pair consumes twice as much power as a common-source stage if the transistors have the same dimensions.

The noise modeling of Fig. 7.57 can readily account for $1 / f$ noise of the transistors as well. Placing the voltage sources given by $K /\left(C_{o x} W L\right)$ in series with each gate, we can rewrite (7.125) as

$$
\begin{equation*}
\overline{V_{n, i n, t o t}^{2}}=8 k T\left(\frac{\gamma}{g_{m}}+\frac{1}{g_{m}^{2} R_{D}}\right)+\frac{2 K}{C_{o x} W L} \frac{1}{f} \tag{7.126}
\end{equation*}
$$

These derivations suggest that the input-referred noise voltage squared of a fully-differential circuit is equal to twice that of its half-circuit equivalent (because the latter employs half as many devices in the signal path). The following example reinforces this point.

#### Example 7.21

A differential pair with current-source loads can be configured to act as a large "floating" resistor [7]. Illustrated in Fig. 7.58(a), the idea is to bias $M_{1}$ and $M_{2}$ at a very small current so as to obtain a high incremental resistance between $A$ and $B$, approximately equal to $1 / g_{m 1}+1 / g_{m 2}$. Determine the noise associated with this resistor. Neglect channel-length modulation.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-259.jpg?height=465&width=805&top_left_y=469&top_left_x=563)

Figure 7.58

#### Solution

Viewing $A$ and $B$ as the outputs and modeling the circuit by its Thevenin equivalent, we must determine the noise voltage that appears between these nodes. To this end, we construct the half circuit shown in Fig. 7.58(b) and write the noise voltage at $A$ as

$$
\begin{equation*}
\overline{V_{n, A}^{2}}=\left(4 k T \gamma g_{m 1}+4 k T \gamma g_{m 3}\right) \frac{1}{g_{m 1}^{2}}+\frac{K}{(W L)_{1} C_{o x}} \frac{1}{f}+\frac{K}{(W L)_{3} C_{o x}} \frac{1}{f}\left(\frac{g_{m 3}}{g_{m 1}}\right)^{2} \tag{7.127}
\end{equation*}
$$

The noise measured between $A$ and $B$ is thus equal to

$$
\begin{equation*}
\overline{V_{n, A B}^{2}}=8 k T \gamma\left(g_{m 1}+g_{m 3}\right) \frac{1}{g_{m 1}^{2}}+\frac{2 K}{(W L)_{1} C_{o x}} \frac{1}{f}+\frac{2 K}{(W L)_{3} C_{o x}} \frac{1}{f}\left(\frac{g_{m 3}}{g_{m 1}}\right)^{2} \tag{7.128}
\end{equation*}
$$

We recognize that this resistor is noisier than a simple ohmic resistor of the same value $\left(\approx 2 / g_{m 1}\right)$. It is also much less linear (why?).

Does the tail current source in Fig. 7.55 contribute noise? If the differential input signal is zero and the circuit is symmetric, then the noise in $I_{S S}$ divides equally between $M_{1}$ and $M_{2}$, producing only a common-mode noise voltage at the output. On the other hand, for a small differential input, $\Delta V_{i n}$, we have

$$
\begin{align*}
\Delta I_{D 1}-\Delta I_{D 2} & =g_{m} \Delta V_{i n}  \tag{7.129}\\
& =\sqrt{2 \mu_{n} C_{o x} \frac{W}{L}\left(\frac{I_{S S}+I_{n}}{2}\right)} \Delta V_{i n} \tag{7.130}
\end{align*}
$$

where $I_{n}$ denotes the noise in $I_{S S}$ and $I_{n} \ll I_{S S}$. In essence, the noise modulates the transconductance of each device. Equation (7.130) can be written as

$$
\begin{align*}
\Delta I_{D 1}-\Delta I_{D 2} & \approx \sqrt{2 \mu_{n} C_{o x} \frac{W}{L} \cdot \frac{I_{S S}}{2}}\left(1+\frac{I_{n}}{2 I_{S S}}\right) \Delta V_{i n}  \tag{7.131}\\
& =g_{m 0}\left(1+\frac{I_{n}}{2 I_{S S}}\right) \Delta V_{i n} \tag{7.132}
\end{align*}
$$

where $g_{m 0}$ is the transconductance of the noiseless circuit. Equation (7.132) suggests that as the circuit departs from equilibrium, $I_{n}$ is more unevenly divided between $M_{1}$ and $M_{2}$, thereby generating differential noise at the output. This effect is nonetheless usually negligible.

Example 7.22
Assuming that the devices in Fig. 7.59(a) operate in saturation and the circuit is symmetric, calculate the input-referred noise voltage.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-260.jpg?height=439&width=449&top_left_y=585&top_left_x=841)
(a)
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-260.jpg?height=355&width=628&top_left_y=1080&top_left_x=439)
(b)
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-260.jpg?height=414&width=536&top_left_y=1084&top_left_x=1100)
(c)

Figure 7.59

#### Solution

Since the thermal and $1 / f$ noise of $M_{1}$ and $M_{2}$ can be modeled as voltage sources in series with the input, we need only refer the noise of $M_{3}$ and $M_{4}$ to the input. Let us calculate the output noise contributed by $M_{3}$. The drain noise current of $M_{3}$ is divided between $r_{O 3}$ and the resistance seen looking into the drain of $M_{1}$ [Fig. 7.59(c)]. From Chapter 5, this resistance equals $R_{X}=r_{O 4}+2 r_{O 1}$. Denoting the resulting noise currents flowing through $r_{O 3}$ and $R_{X}$ by $I_{n A}$ and $I_{n B}$, respectively, we have

$$
\begin{equation*}
I_{n A}=g_{m 3} V_{n 3} \frac{r_{O 4}+2 r_{O 1}}{2 r_{O 4}+2 r_{O 1}} \tag{7.133}
\end{equation*}
$$

and

$$
\begin{equation*}
I_{n B}=g_{m 3} V_{n 3} \frac{r_{O 3}}{2 r_{O 4}+2 r_{O 1}} \tag{7.134}
\end{equation*}
$$

The former produces a noise voltage of $g_{m 3} V_{n 3} r_{O 3}\left(r_{O 4}+2 r_{O 1}\right) /\left(2 r_{O 4}+2 r_{O 1}\right)$ at node $X$ with respect to ground whereas the latter flows through $M_{1}, M_{2}$, and $r_{O 4}$, generating $g_{m 3} V_{n 3} r_{O 3} r_{O 4} /\left(2 r_{O 4}+2 r_{O 1}\right)$ at node $Y$ with respect
to ground. Thus, the total differential output noise due to $M_{3}$ is equal to

$$
\begin{align*}
V_{n X Y} & =V_{n X}-V_{n Y}  \tag{7.135}\\
& =g_{m 3} V_{n 3} \frac{r_{O 3} r_{O 1}}{r_{O 3}+r_{O 1}} \tag{7.136}
\end{align*}
$$

(The reader can verify that $V_{n Y}$ must be subtracted from $V_{n X}$.)
Equation (7.136) implies that the noise current of $M_{3}$ is simply multiplied by the parallel combination of $r_{O 1}$ and $r_{O 3}$ to produce the differential output voltage. This is of course not surprising because, as depicted in Fig. 7.60, the effect of $V_{n 3}$ at the output can also be derived by decomposing $V_{n 3}$ into two differential components applied to the gates of $M_{3}$ and $M_{4}$ and subsequently using the half-circuit concept. Since this calculation relates to a single noise source, we can temporarily ignore the random nature of noise and treat $V_{n 3}$ and the circuit as familiar deterministic, linear components.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-261.jpg?height=444&width=1464&top_left_y=782&top_left_x=231)

Figure 7.60 Calculation of input-referred noise in a differential pair with current-source loads.
Applying (7.136) to $M_{4}$ as well and adding the resulting powers, we have

$$
\begin{align*}
\left.\overline{V_{n, \text { out }}^{2}}\right|_{M 3, M 4} & =g_{m 3}^{2}\left(r_{O 1} \| r_{O 3}\right)^{2} \overline{V_{n 3}^{2}}+g_{m 4}^{2}\left(r_{O 2} \| r_{O 4}\right)^{2} \overline{V_{n 4}^{2}}  \tag{7.137}\\
& =2 g_{m 3}^{2}\left(r_{O 1} \| r_{O 3}\right)^{2} \overline{V_{n 3}^{2}} \tag{7.138}
\end{align*}
$$

To refer the noise to the input, we divide (7.138) by $g_{m 1}^{2}\left(r_{O 1} \| r_{O 3}\right)^{2}$, obtaining the total input-referred noise voltage per unit bandwidth as

$$
\begin{equation*}
\overline{V_{n, i n}^{2}}=2 \overline{V_{n 1}^{2}}+2 \frac{g_{m 3}^{2}}{g_{m 1}^{2}} \overline{V_{n 3}^{2}} \tag{7.139}
\end{equation*}
$$

which, upon substitution for $\overline{V_{n 1}^{2}}$ and $\overline{V_{n 3}^{2}}$, reduces to

$$
\begin{equation*}
\overline{V_{n, i n}^{2}}=8 k T \gamma\left(\frac{1}{g_{m 1}}+\frac{g_{m 3}}{g_{m 1}^{2}}\right)+\frac{2 K_{N}}{C_{o x}(W L)_{1} f}+\frac{2 K_{P}}{C_{o x}(W L)_{3} f} \frac{g_{m 3}^{2}}{g_{m 1}^{2}} \tag{7.140}
\end{equation*}
$$

It is instructive to compare the above input-referred noise to that of a differential pair with active load (the five-transistor OTA). We analyze the thermal noise of the latter and leave the flicker noise as an exercise for the reader. Due to lack of perfect symmetry, we seek the Norton noise equivalent of the circuit by first computing the output short-circuit noise current (Fig. 7.61). This result can be multiplied by the output resistance and divided by the gain to obtain the input-referred noise voltage.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-262.jpg?height=462&width=511&top_left_y=245&top_left_x=513)

Figure 7.61 OTA output short-circuit noise current.

We recall from Chapter 5 that the transconductance of the five-transistor OTA is approximately equal to $g_{m 1,2}$. Thus, the output noise current due to $M_{1}$ and $M_{2}$ is given by this transconductance multiplied by the gate-referred noises of $M_{1}$ and $M_{2}$, i.e., $g_{m 1,2}^{2}\left(4 k T \gamma / g_{m 1}+4 k T \gamma / g_{m 2}\right)$.

Let us consider the noise current of $M_{3}, 4 k T \gamma g_{m 3}$. This current primarily circulates through the diodeconnected impedance, $1 / g_{m 3}$, producing a voltage at the gate of $M_{4}$ with a spectral density of $4 k T \gamma / g_{m 3}$. This noise is multiplied by $g_{m 4}^{2}$ as it emerges from the drain of $M_{4}$. The noise current of $M_{4}$ itself also directly flows through the output short circuit. We therefore have

$$
\begin{equation*}
\overline{I_{n, \text { out }}^{2}}=4 k T \gamma\left(2 g_{m 1,2}+2 g_{m 3,4}\right) \tag{7.141}
\end{equation*}
$$

Multiplying this noise by $R_{\text {out }}^{2} \approx\left(r_{O 1,2} \| r_{O 3,4}\right)^{2}$ and dividing the result by $A_{v}^{2}=G_{m}^{2} R_{\text {out }}^{2}$, we obtain the total input-referred noise voltage as

$$
\begin{equation*}
\overline{V_{n, i n}^{2}}=8 k T \gamma\left(\frac{1}{g_{m 1,2}}+\frac{g_{m 3,4}}{g_{m 1,2}^{2}}\right) \tag{7.142}
\end{equation*}
$$

which is the same as that of the fully-differential circuit.
An interesting difference between the OTA and the fully-differential topology relates to the noise contributed by the tail current when $V_{i n 1}=V_{i n 2}$. Recall from Chapter 5 that the output voltage of the OTA in Fig. 7.62 is equal to $V_{X}$. If $I_{S S}$ fluctuates, so do $V_{X}$ and $V_{\text {out }}$. Since the tail noise current, $I_{n}$, splits equally between $M_{1}$ and $M_{2}$, the noise voltage at $X$ is given by $\overline{I_{n}^{2}} /\left(4 g_{m 3}^{2}\right)$, and so is the noise voltage at the output. (Why does $I_{n}$ split equally, even though the impedance seen looking into the source of $M_{2}$ appears to be higher than that seen looking into the source of $M_{1}$ ?)

The effect of noise must be studied for many other analog circuits as well. For example, feedback systems, op amps, and bandgap references exhibit interesting and important noise characteristics. We return to these topics in other chapters.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-262.jpg?height=467&width=498&top_left_y=1864&top_left_x=514)

Figure 7.62 Effect of tail noise current in OTA.

## 7.7 ■ Noise-Power Trade-Off

In our analysis of the input-referred thermal noise, we have seen that the noise contributed by the transistors "in the signal path" is inversely proportional to their transconductance. This dependence suggests a tradeoff between noise and power consumption.

The noise-power trade-off can in fact be generalized to any circuit (so long as the input noise current is negligible). To understand this point, let us begin with a simple CS stage as shown in Fig. 7.63(a): we double $W / L$ and the bias current of $M_{1}$ and halve the load resistor. This transformation maintains the voltage gain and the output swing regardless of the transistor characteristics. But we note that the input-referred thermal and flicker noise power is exactly halved (because both the $g_{m}$ and the gate area of the transistor are doubled). This 3-dB reduction in noise accrues at a cost of doubling the power consumption (and the input capacitance).
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-263.jpg?height=867&width=1169&top_left_y=755&top_left_x=386)

Figure 7.63 (a) Output noise reduction by scaling, (b) equivalent operation, and (c) scaling viewed at layout level.
Called "linear scaling," the transformation depicted in Fig. 7.63(a) can also be viewed as placing two instances of the original circuit in parallel, as illustrated in Fig. 7.63(b). Alternatively, we can say that the widths of the transistor and the resistor are doubled [Fig. 7.63(c)].

In general, if two instances of a circuit are placed in parallel, the output noise power is halved [Fig. 7.64(a)]. This can be proved by setting the input to zero and constructing a Thevenin noise equivalent for each [Fig. 7.64(b)]. Since $V_{n 1, \text { out }}$ and $V_{n 2, \text { out }}$ are uncorrelated, we can use superposition of powers to write

$$
\begin{align*}
\overline{V_{n, \text { out }}^{2}} & =\frac{\overline{V_{n 1, \text { out }}^{2}}}{4}+\frac{\overline{V_{n 2, \text { out }}^{2}}}{4}  \tag{7.143}\\
& =\frac{\overline{V_{n 1, \text { out }}^{2}}}{2} \tag{7.144}
\end{align*}
$$

Thus, the output noise is traded for power consumption while retaining the voltage gain and output swings. Note that this can also be proved if the input is left open, revealing that the input-referred noise current, $\overline{I_{n, i n}^{2}}$, is doubled (why?).
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-264.jpg?height=198&width=654&top_left_y=349&top_left_x=426)
(a)
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-264.jpg?height=452&width=536&top_left_y=245&top_left_x=1105)
(b)

Figure 7.64 (a) General scaling for noise reduction, and (b) equivalent circuit.

We should also remark that noise spectrum must eventually be integrated across the circuit's bandwidth. The foregoing linear scaling assumes that the bandwidth is dictated by the application and hence constant.

## 7.8 ■ Noise Bandwidth

The total noise corrupting a signal in a circuit results from all of the frequency components that fall in the bandwidth of the circuit. Consider a multipole circuit having the output noise spectrum shown in Fig. 7.65(a). Since the noise components above $\omega_{p 1}$ are not negligible, the total output noise must be evaluated by calculating the total area under the spectral density:

$$
\begin{equation*}
\overline{V_{n, \text { out }, \text { tot }}^{2}}=\int_{0}^{\infty} \overline{V_{n, \text { out }}^{2}} d f \tag{7.145}
\end{equation*}
$$

However, as depicted in Fig. 7.65(b), it is sometimes helpful to represent the total noise simply as $V_{0}^{2} \cdot B_{n}$, where the bandwidth $B_{n}$ is chosen such that

$$
\begin{equation*}
V_{0}^{2} \cdot B_{n}=\int_{0}^{\infty} \overline{V_{n, \text { out }}^{2}} d f \tag{7.146}
\end{equation*}
$$

Called the "noise bandwidth," $B_{n}$ allows a fair comparison of circuits that exhibit the same low-frequency noise, $V_{0}^{2}$, but different high-frequency transfer functions. As an exercise, the reader can prove that the noise bandwidth of a one-pole system is equal to $\pi / 2$ times the pole frequency.
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-264.jpg?height=308&width=682&top_left_y=1867&top_left_x=343)
(a)
![](https://cdn.mathpix.com/cropped/2024_10_28_134d5d788a0919ac264dg-264.jpg?height=306&width=688&top_left_y=1865&top_left_x=1029)
(b)

Figure 7.65 (a) Output noise spectrum of a circuit; (b) concept of noise bandwidth.
