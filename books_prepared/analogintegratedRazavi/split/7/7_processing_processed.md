# CHAPTER 7 Noise

Noise limits the minimum signal level that a circuit can process with acceptable quality. Today's analog designers constantly deal with the problem of noise because it trades with power dissipation, speed, and linearity.

In this chapter, we describe the phenomenon of noise and its effect on analog circuits. The objective is to provide sufficient understanding of the problem so that further developments of analog circuits in the following chapters take noise into account as naturally as they do other circuit parameters, such as gain, input and output impedances, etc. Seemingly a complex subject, noise is introduced at this early stage so as to accompany the reader for the remainder of the book and become more intuitive through various examples.

Following a general description of noise characteristics in the frequency and time domains, we introduce thermal and flicker noise. Next, we consider methods of representing noise in circuits. Finally, we describe the effect of noise in single-stage and differential amplifiers along with trade-offs with other performance parameters.

## 7.1 ■ Statistical Characteristics of Noise

Noise is a random process. For our purposes in this book, this statement means that the value of noise cannot be predicted at any time even if the past values are known. Compare the output of a sine-wave generator with that of a microphone picking up the sound of water flow in a river (Fig. 7.1). While the value of $x_{1}(t)$ at $t=t_{1}$ can be predicted from the observed waveform, the value of $x_{2}(t)$ at $t=t_{2}$ cannot. This is the principal difference between deterministic and random phenomena.

If the instantaneous value of noise in the time domain cannot be predicted, how can we incorporate noise in circuit analysis? This is accomplished by observing the noise for a long time and using the measured results to construct a "statistical model" for the noise. While the instantaneous amplitude of noise cannot be predicted, a statistical model provides knowledge about some other important properties of the noise that prove useful and adequate in circuit analysis.

Which properties of noise can be predicted? In many cases, the average power of noise is predictable. For example, if a microphone picking up the sound of a river is brought closer to the river, the resulting electrical signal displays, on the average, larger excursions and hence higher power (Fig. 7.2). The reader may wonder if a random process can be so random that even its average power is unpredictable. Such processes do exist, but we are fortunate that most sources of noise in circuits exhibit a constant average power.
image_name:Signal Generator
description:The diagram titled "Signal Generator" consists of two main parts: a block labeled "Signal Generator" and an illustration of a river. Each part is associated with a waveform diagram, labeled (a) and (b), respectively.

1. **Main Components:**
- **Signal Generator Block:** This component is depicted as a rectangular block with two output terminals. It represents a device that produces a periodic signal, shown as \( x_1(t) \) in the accompanying waveform diagram.
- **River Illustration:** This is a visual representation of a natural environment, likely indicating a source of random noise. It is connected to a block that resembles a microphone or a sensor, capturing the sound of the river. The output from this setup is represented by the waveform \( x_2(t) \).

2. **Flow of Information or Control:**
- **Signal Generator:** The signal generator outputs a periodic waveform \( x_1(t) \) with a specific frequency and amplitude. The diagram shows this waveform as a smooth, sinusoidal signal over time, indicating a controlled and predictable output.
- **River Sound Capture:** The sound of the river is captured by the microphone or sensor, and the corresponding waveform \( x_2(t) \) is shown. This waveform is more irregular and represents a random signal, illustrating the natural variability and randomness of environmental noise.

3. **Labels, Annotations, and Key Indicators:**
- **Waveform \( x_1(t) \):** This waveform is labeled with a time point \( t_1 \), indicating a specific moment in the periodic cycle.
- **Waveform \( x_2(t) \):** This waveform is labeled with a time point \( t_2 \), highlighting a particular instance in the random signal.

4. **Overall System Function:**
- The primary function of this diagram is to compare and contrast the characteristics of a controlled periodic signal generated by a signal generator with the random, unpredictable nature of a signal captured from a natural source like a river. The signal generator provides a stable and predictable output, while the river sound demonstrates variability and randomness, both in terms of amplitude and frequency, illustrating concepts of average power and randomness in signal processing.
image_name:(a)
description:The graph labeled "(a)" represents a time-domain waveform generated by a signal generator. This is a sinusoidal waveform, indicating a periodic and smooth oscillation over time. The horizontal axis is labeled as "t," representing time, while the vertical axis is labeled as "x1(t)," representing the signal amplitude.

1. **Type of Graph and Function:**
- The graph is a time-domain sinusoidal waveform.
- It illustrates the output of a signal generator.

2. **Axes Labels and Units:**
- The x-axis is time "t."
- The y-axis is the amplitude of the signal "x1(t)."
- The scale appears to be linear.

3. **Overall Behavior and Trends:**
- The waveform is sinusoidal, showing regular, periodic oscillations.
- It has a consistent amplitude and frequency, indicating a stable signal output.

4. **Key Features and Technical Details:**
- The waveform displays a clear periodic pattern with peaks and troughs.
- A specific time point, "t1," is marked, possibly indicating a reference or significant time point in the waveform.
- The waveform does not show any visible distortion or irregularities, suggesting a clean output from the signal generator.

5. **Annotations and Specific Data Points:**
- There is a vertical dashed line at "t1," which may indicate a point of interest or measurement reference in the waveform.
- No numerical values are provided, but the waveform's periodic nature is evident.
image_name:(b)
description:The graph labeled as (b) is a time-domain waveform representing the sound of a river. The horizontal axis is labeled 't', indicating time, though no specific units are provided. The vertical axis is labeled 'x2(t)', representing the amplitude of the signal, again without specific units.

1. **Type of Graph and Function:**
- This is a time-domain waveform showing the amplitude of a signal over time.

2. **Axes Labels and Units:**
- **Horizontal Axis (t):** Represents time.
- **Vertical Axis (x2(t)):** Represents the amplitude of the sound signal.
- No specific units or scales are provided for either axis.

3. **Overall Behavior and Trends:**
- The graph exhibits a random, noisy behavior typical of natural sounds like a river.
- There are no clear periodic patterns or regular oscillations.
- The amplitude appears to fluctuate randomly, with varying peaks and troughs.

4. **Key Features and Technical Details:**
- The waveform is irregular, with no discernible repeating patterns.
- There are multiple peaks and valleys, indicating the varying intensity of the river sound.
- The signal does not return to a baseline consistently, suggesting continuous noise.

5. **Annotations and Specific Data Points:**
- A vertical dashed line is drawn at a point labeled 't2', indicating a specific moment in time, though no specific data value is provided.
- This point might be used to highlight a particular feature or event within the waveform, but the context is not clear from the graph alone.

Figure 7.1 (a) The output of a generator, and (b) the sound of a river.

image_name:Figure 7.2 (a)
description:The image consists of two parts labeled (a) and (b), each depicting a conceptual representation of a signal generator and its corresponding output waveform.

1. **Figure 7.1(a): Output of a Generator**
- **Components and Structure:**
- On the left, there is a simple illustration of a tree and a winding path, which appears to be a metaphorical representation of a natural environment.
- Next to this, there is an icon of a generator, depicted as a circle with a vertical line through it, connected to two terminals. This symbolizes a generic signal generator.
- **Connections and Interactions:**
- The generator is connected to a graph on the right, which represents the output signal over time.
- The graph is labeled as \( x_A(t) \), showing a waveform that fluctuates slightly around a baseline, indicating a relatively stable output with minor variations.
- **Annotations and Key Features:**
- The waveform is plotted against a horizontal time axis \( t \), with an unspecified vertical axis.
- The signal appears consistent, suggesting a controlled output from the generator.

2. **Figure 7.1(b): Sound of a River**
- **Components and Structure:**
- Similar to part (a), this section includes a tree and a winding path, suggesting a natural setting, possibly representing the sound of flowing water.
- The same generator icon is present, indicating the source of the signal.
- **Connections and Interactions:**
- The generator is connected to another graph on the right, representing a different output signal.
- This graph is labeled \( x_B(t) \) and shows a more erratic waveform, suggesting a more complex or noisy signal compared to \( x_A(t) \).
- **Annotations and Key Features:**
- The waveform is plotted with respect to time \( t \), with no specific values on the vertical axis.
- The irregularity of the waveform might be used to represent the variability in the sound of a river, highlighting the natural randomness of such a sound source.

Overall, the image contrasts two different signal outputs, one stable and one more erratic, possibly to illustrate different types of signal behavior or to metaphorically represent natural phenomena through signal processing.
image_name:Figure 7.2 (b)
description:The graph labeled (b) represents the sound of a river over time. This is a time-domain waveform graph where the x-axis represents time (t) and the y-axis represents the amplitude of the sound signal, denoted as x_B(t).

1. **Type of Graph and Function:**
- This is a time-domain waveform graph showing the amplitude of a sound signal over time.

2. **Axes Labels and Units:**
- The x-axis is labeled as 't', representing time, though the specific units are not provided.
- The y-axis is labeled as 'x_B(t)', representing the amplitude of the sound signal.

3. **Overall Behavior and Trends:**
- The waveform shows a continuous and irregular pattern, indicating a random and complex signal typical of natural sounds like a river.
- The amplitude exhibits fluctuations, with no clear periodicity or repetitive pattern, suggesting the presence of continuous noise.

4. **Key Features and Technical Details:**
- The graph does not display any specific peaks or valleys that are highlighted, but the amplitude varies over time, depicting the dynamic nature of the river sound.
- There are no specific annotations or markers indicating particular data points or events.

5. **Annotations and Specific Data Points:**
- There are no annotations or specific data points marked on the graph. The context suggests a natural, random signal without distinct events or features highlighted.

This graph effectively represents the complex and random nature of a river's sound, characterized by continuous variations in amplitude without returning to a consistent baseline.

Figure 7.2 Illustration of the average power of a random signal.

The concept of average power proves essential in our analysis and must be defined carefully. Recall from basic circuit theory that the average power delivered by a periodic voltage $v(t)$ to a load resistance $R_{L}$ is given by

$$
\begin{equation*}
P_{a v}=\frac{1}{T} \int_{-T / 2}^{+T / 2} \frac{v^{2}(t)}{R_{L}} d t \tag{7.1}
\end{equation*}
$$

where $T$ denotes the period. ${ }^{1}$ Measured in watts, this quantity can be visualized as the average heat produced in $R_{L}$ by $v(t)$.

How do we define $P_{a v}$ for a random signal? In the example of Fig. 7.2, we expect that $x_{B}(t)$ generates more heat than $x_{A}(t)$ if the microphone drives a resistive load. However, since the signals are not periodic, the measurement must be carried out over a long time:

$$
\begin{equation*}
P_{a v}=\lim _{T \rightarrow \infty} \frac{1}{T} \int_{-T / 2}^{+T / 2} \frac{x^{2}(t)}{R_{L}} d t \tag{7.2}
\end{equation*}
$$

where $x(t)$ is a voltage quantity. Figure 7.3 illustrates the operation on $x(t)$ : the signal is squared, the area under the resulting waveform is calculated for a long time $T$, and the average power is obtained by normalizing the area to $T .^{2}$
image_name:Figure 7.3 Average noise power
description:The graph in Figure 7.3 illustrates the process of calculating average noise power from a non-periodic signal. It consists of two main sections:

1. **Original Signal**:
- **Type of Graph**: Time-domain waveform.
- **Axes Labels and Units**: The horizontal axis represents time \( t \), with no specific units or scale marked, indicating a general representation of time. The vertical axis represents the amplitude of the voltage signal \( x(t) \).
- **Overall Behavior and Trends**: The waveform shows a complex, non-periodic oscillation around the horizontal axis, indicating a fluctuating voltage signal. The oscillations have varying amplitudes and frequencies, with no discernible pattern or periodicity.
- **Key Features and Technical Details**: The waveform crosses the horizontal axis multiple times, indicating zero crossings. There are several peaks and valleys, but no specific numerical values or annotations are provided.
- **Annotations and Specific Data Points**: The time interval \( T \) is marked with dashed vertical lines, showing the duration over which the signal is observed.

2. **Squared Signal**:
- **Type of Graph**: Time-domain waveform of the squared signal.
- **Axes Labels and Units**: Similar to the original signal, the horizontal axis represents time \( t \), and the vertical axis represents the squared amplitude \( x^2(t) \).
- **Overall Behavior and Trends**: The waveform is entirely above the horizontal axis, as squaring the signal eliminates negative values. The general shape mirrors the original waveform but with all values non-negative, showing more pronounced peaks due to squaring.
- **Key Features and Technical Details**: The squared signal maintains the same zero crossings as the original, but now all values are positive. The area under the curve, shaded in gray, represents the integral of the squared signal over time \( T \), which is used to calculate average power.
- **Annotations and Specific Data Points**: The time interval \( T \) is again marked with dashed vertical lines, indicating the duration for averaging the power.

Figure 7.3 Average noise power.
To simplify calculations, we write the definition of $P_{a v}$ as

$$
\begin{equation*}
P_{a v}=\lim _{T \rightarrow \infty} \frac{1}{T} \int_{-T / 2}^{+T / 2} x^{2}(t) d t \tag{7.3}
\end{equation*}
$$

where $P_{a v}$ is expressed in $\mathrm{V}^{2}$ rather than W . The idea is that if we know $P_{a v}$ from (7.3), then the actual power delivered to a load $R_{L}$ can be readily calculated as $P_{a v} / R_{L}$. In analogy with deterministic signals, we can also define a root-mean-square (rms) voltage for noise as $\sqrt{P_{a v}}$, where $P_{a v}$ is given by (7.3).

### 7.1.1 Noise Spectrum

The concept of average power becomes more versatile if defined with regard to the frequency content of noise. The noise made by a group of men contains weaker high-frequency components than that made by a group of women, a difference observable from the "spectrum" of each type of noise. Also called the "power spectral density" (PSD), the spectrum shows how much power the signal carries at each frequency. More specifically, the PSD, $S_{x}(f)$, of a noise waveform $x(t)$ is defined as the average power carried by $x(t)$ in a one-hertz bandwidth around $f$. That is, as illustrated in Fig. 7.4(a), we apply $x(t)$ to a bandpass filter with a center frequency of $f_{1}$ and a $1-\mathrm{Hz}$ bandwidth, square the output, $x_{f 1}(t)$, and calculate the average over a long time to obtain $S_{x}\left(f_{1}\right)$. Repeating the procedure with bandpass filters having different center frequencies, we arrive at the overall shape of $S_{x}(f)$ [Fig. 7.4(b)]. ${ }^{3}$ Generally, $S_{x}(f)$ is measured in watts per hertz. The total area under $S_{x}(f)$ represents the power carried by the signal (or the noise) at all frequencies; i.e., the total power.

#### Example 7.1

(a) Sketch the spectrum of voice for men and women. What does the difference imply about their time-domain waveforms?
(b) Estimate the averaging time, $T$, in Eq. (7.3) for voice signals.

image_name:Figure 7.4(a)
description:The diagram labeled '(a)' illustrates the process of shaping a signal's spectrum using a band-pass filter. The system consists of the following main components:

1. **Input Signal, x(t):**
- The diagram begins with an input signal, denoted as \(x(t)\), which is a time-domain waveform. This signal is depicted as a waveform with varying amplitude over time.

2. **Band-Pass Filter:**
- The input signal \(x(t)\) is fed into a band-pass filter. This filter is characterized by a specific frequency range, centered at \(f_1\), and has a bandwidth of 1 Hz. The purpose of the band-pass filter is to allow only the frequencies within this narrow band to pass through, effectively isolating a portion of the signal's frequency spectrum.

3. **Filtered Signal, x_{f1}(t):**
- The output from the band-pass filter is a filtered version of the input signal, denoted as \(x_{f1}(t)\). This signal is shown as a sinusoidal waveform, indicating that only the frequency components around \(f_1\) are present.

4. **Squaring Block:**
- The filtered signal \(x_{f1}(t)\) is then passed through a squaring block. This block computes the square of the amplitude of the signal, resulting in \(|x_{f1}(t)|^2\). Squaring the signal typically emphasizes the power of the signal components.

5. **Output Signal, |x_{f1}(t)|^2:**
- The final output is the squared amplitude of the filtered signal, \(|x_{f1}(t)|^2\), which is shown as a waveform with increased amplitude variations over time. This represents the power of the signal components within the band-pass filter's frequency range.

**Flow of Information:**
- The signal flow starts with the input \(x(t)\), which is processed by the band-pass filter to produce \(x_{f1}(t)\). This filtered signal is then squared to yield \(|x_{f1}(t)|^2\). The flow of information is linear, with no feedback loops or additional control mechanisms.

**Overall System Function:**
- The primary function of this system is to isolate a specific frequency component from the input signal using a band-pass filter and then to analyze the power of this component by squaring its amplitude. This process is useful in spectral analysis where the power at specific frequency bands is of interest.
image_name:Figure 7.4(b)
description:The graph labeled (b) is a frequency spectrum plot, specifically depicting the noise spectrum $S_x(f)$ of a signal.

1. **Type of Graph and Function:**
- This is a frequency-domain graph representing the power spectral density (PSD) of a signal, $S_x(f)$.

2. **Axes Labels and Units:**
- The horizontal axis represents frequency ($f$), typically measured in Hertz (Hz).
- The vertical axis represents the power spectral density, $S_x(f)$, measured in watts per hertz (W/Hz).
- There are no specific scales mentioned, but it appears to be a linear scale for both axes.

3. **Overall Behavior and Trends:**
- The spectrum displays a series of peaks and valleys, indicating varying power levels at different frequencies.
- The graph starts with a peak at $f_1$, followed by a dip at $f_2$, then another peak, and gradually decreases as frequency increases towards $f_n$.
- This suggests that the signal has strong frequency components at certain frequencies, which diminish as the frequency increases.

4. **Key Features and Technical Details:**
- Peaks are observed at specific frequencies ($f_1$, $f_2$, ..., $f_n$), which are marked by vertical dashed lines.
- The highest peak is located between $f_2$ and $f_n$, indicating the frequency with the most power.
- The spectrum shows a decreasing trend in power as the frequency increases beyond the highest peak.

5. **Annotations and Specific Data Points:**
- The graph is annotated with open circles at key frequencies, highlighting significant points in the spectrum.
- These markers likely correspond to the center frequencies of band-pass filters used in calculating the spectrum.

Overall, this graph provides a visual representation of how the power of the signal is distributed across different frequencies, with specific frequencies showing higher power levels, indicative of the signal's characteristics in the frequency domain.

Figure 7.4 Calculation of noise spectrum.

#### Solution

(a) The human voice exhibits frequencies from 20 Hz to 20 kHz . Since women's voice contain stronger highfrequency components, we expect the two spectra to differ as shown in Fig. 7.5(a). In the time domain, we observe faster changes in women's voice [Fig. 7.5(b)].
image_name:Figure 7.5 (a)
description:The graph in Figure 7.5 (a) is a frequency spectrum plot comparing the spectral characteristics of men's and women's voices. The x-axis represents frequency \( f \) in hertz (Hz), ranging from 20 Hz to 20 kHz, which covers the typical frequency range of human hearing. The y-axis represents the spectral power \( S_x(f) \), although the units are not specified, it generally indicates the power or intensity of the sound at different frequencies.

The graph displays two curves: one for men's voices and one for women's voices. The curve for men's voices starts at a lower frequency with higher power, peaks at a mid-frequency range, and then decreases as the frequency increases towards 20 kHz. In contrast, the curve for women's voices shows a different trend, with a lower power at low frequencies, increasing to a peak at higher frequencies compared to men's voices, before tapering off towards 20 kHz.

Overall, the graph illustrates that men's voices tend to have stronger low-frequency components, while women's voices exhibit stronger high-frequency components. This difference is indicative of the typical spectral characteristics of male and female voices, with women's voices generally having higher frequency components due to physiological differences in vocal cord structure.

image_name:Men's Voice
description:The graph labeled "Men's Voice" is a time-domain waveform representation of a male voice signal. The x-axis is labeled as 't,' representing time, and the y-axis is labeled as 'x(t),' indicating the amplitude of the voice signal. The waveform shows a series of oscillations typical of a sound signal, with both positive and negative amplitude variations around a central axis, suggesting the presence of both compressions and rarefactions in the sound wave.

The waveform has a complex shape with multiple peaks and troughs, suggesting the presence of various frequency components. The amplitude of the oscillations varies over time, indicating dynamic changes in the loudness and pitch of the voice. The waveform does not exhibit a simple periodic pattern, reflecting the natural variability and complexity of human speech.

Key features include several prominent peaks and valleys, which may correspond to louder and quieter moments in the speech. The waveform crosses the zero amplitude line multiple times, indicating changes in the phase of the sound wave. This graph captures the typical characteristics of a male voice, likely emphasizing lower frequency components as suggested by the context provided.

image_name:Women's Voice
description:The graph is a time-domain waveform representing a woman's voice. The x-axis is labeled as 't' and represents time, while the y-axis is labeled as 'x(t)' and represents amplitude. The waveform is plotted on a linear scale, capturing the variations in amplitude over time.

**Overall Behavior and Trends:**
The waveform displays a complex pattern of oscillations, characteristic of human speech. It does not follow a simple periodic pattern, reflecting the natural variability and intricacy of vocal sounds. The waveform shows multiple peaks and valleys, indicating moments of higher and lower amplitude, respectively. These variations suggest changes in loudness and pitch typical in speech.

**Key Features and Technical Details:**
- **Zero Crossings:** The waveform crosses the zero amplitude line several times, indicating phase changes in the sound wave.
- **Peaks and Valleys:** There are several prominent peaks and valleys, which could correspond to louder and quieter parts of the speech.
- **Frequency Components:** The context suggests an emphasis on higher frequency components typical of a woman's voice, compared to a man's voice which often emphasizes lower frequencies.

**Annotations and Specific Data Points:**
The graph does not have specific numerical annotations or reference lines, but it visually highlights the dynamic range and complexity of a woman's vocal waveform. The waveform's structure suggests the inclusion of a wide range of frequencies and amplitudes, capturing the essence of a woman's voice in speech.

Figure 7.5 (a) Spectra of men's and women's voices, and (b) corresponding time-domain waveforms.
(b) The averaging time must be long enough to include a sufficient number of cycles of the lowest frequencies. That is, the averaging must capture the slowest dynamics in the signal. We must therefore choose $T$ to be at least about 10 cycles of 20 Hz , i.e., roughly 500 ms .

As with the definition of $P_{a v}$ in (7.3), it is customary to eliminate $R_{L}$ from $S_{x}(f)$. Thus, since each value on the plot in Fig. 7.4(b) is measured for a 1-Hz bandwidth, $S_{x}(f)$ is expressed in $\mathrm{V}^{2} / \mathrm{Hz}$ rather than W/Hz. It is also common to take the square root of $S_{x}(f)$, expressing the result in $\mathrm{V} / \sqrt{\mathrm{Hz}}$. For example, we say that the input noise voltage of an amplifier at 100 MHz is equal to $3 \mathrm{nV} / \sqrt{\mathrm{Hz}}$, simply to mean that the average power in a 1-Hz bandwidth at 100 MHz is equal to $\left(3 \times 10^{-9}\right)^{2} \mathrm{~V}^{2}$.
image_name:Figure 7.6 White spectrum
description:The graph in Figure 7.6 represents a 'white spectrum' or white noise power spectral density (PSD). This type of graph is a frequency-domain representation, specifically showing the PSD of a noise signal.

1. **Type of Graph and Function:**
- This is a frequency-domain plot, specifically a power spectral density (PSD) graph.

2. **Axes Labels and Units:**
- The horizontal axis is labeled as 'f,' representing frequency, typically in hertz (Hz).
- The vertical axis is labeled as 'S_n(f),' which represents the power spectral density, often expressed in units of V²/Hz or W/Hz.
- The scale of both axes is linear.

3. **Overall Behavior and Trends:**
- The graph shows a constant value across all frequencies, indicating that the noise power is uniformly distributed across the frequency spectrum. This flat line is characteristic of white noise, where the power spectral density does not change with frequency.

4. **Key Features and Technical Details:**
- There are no peaks, valleys, or inflection points since the graph is a flat line.
- The graph implies that the noise has equal power at all frequencies within the band of interest.
- The flat nature of the spectrum suggests infinite total power if integrated over an infinite frequency range, which is a theoretical concept since practical systems have limited bandwidth.

5. **Annotations and Specific Data Points:**
- There are no specific annotations or markers on the graph, as it is a simple representation of a white noise spectrum.
- The graph is a typical illustration of the concept of white noise, used to explain its uniform power distribution across frequencies.

An example of a common type of noise PSD is the "white spectrum," also called white noise. Shown in Fig. 7.6, such a PSD displays the same value at all frequencies (similar to white light). Strictly speaking, we note that white noise does not exist because the total area under the power spectral density, i.e., the total power carried by the noise, is infinite. In practice, however, any noise spectrum that is flat in the band of interest is usually called white.

The PSD is a powerful tool in analyzing the effect of noise in circuits, especially in conjunction with the following theorem.

Theorem If a signal with spectrum $S_{x}(f)$ is applied to a linear time-invariant system with transfer function $H(s)$, then the output spectrum is given by

$$
\begin{equation*}
S_{Y}(f)=S_{x}(f)|H(f)|^{2} \tag{7.4}
\end{equation*}
$$

where $H(f)=H(s=2 \pi j f)$. The proof can be found in textbooks on signal processing or communications, e.g., [1].

Somewhat similar to the relation $Y(s)=X(s) H(s)$, this theorem agrees with our intuition that the spectrum of the signal should be "shaped" by the transfer function of the system (Fig. 7.7). For example, as illustrated in Fig. 7.8, since regular telephones have a bandwidth of approximately 4 kHz , they suppress the high-frequency components of the caller's voice. Note that, owing to its limited bandwidth, $x_{\text {out }}(t)$ exhibits slower changes than does $x_{i n}(t)$. This bandwidth limitation sometimes makes it difficult to recognize the caller's voice.
image_name:Figure 7.7
description:The diagram in Figure 7.7 illustrates the concept of noise shaping by a transfer function. It consists of three parts, each representing a different stage of the frequency response transformation.

1. **Type of Graph and Function:**
- The graph is a frequency response diagram showing how a signal's spectrum is shaped by a system's transfer function.

2. **Axes Labels and Units:**
- Each part of the diagram has the horizontal axis labeled as frequency \( f \), though specific units are not provided, it is typically in hertz (Hz).

3. **Overall Behavior and Trends:**
- **First Part (Left):** The initial spectrum \( S_x(f) \) is shown as a flat, constant value across a certain frequency range, indicating a uniform distribution of power across these frequencies.
- **Middle Part:** The transfer function \( |H(f)|^2 \) is depicted with a bell-shaped curve with two peaks. This suggests that the system emphasizes certain frequencies more than others, corresponding to the peaks.
- **Last Part (Right):** The resulting spectrum \( S_y(f) \) after the transfer function is applied shows a shaped spectrum with peaks at the same frequencies as \( |H(f)|^2 \), indicating that these frequencies are emphasized in the output.

4. **Key Features and Technical Details:**
- The flat spectrum \( S_x(f) \) suggests an input signal with equal power across a range of frequencies.
- The transfer function \( |H(f)|^2 \) has a double-peaked shape, indicating selective amplification or attenuation at certain frequencies.
- The output spectrum \( S_y(f) \) reflects the shaping effect of the transfer function, with noticeable peaks aligning with those of \( |H(f)|^2 \).

5. **Annotations and Specific Data Points:**
- No specific numerical values or annotations are provided, but the emphasis is on the transformation process from \( S_x(f) \) to \( S_y(f) \) through \( |H(f)|^2 \).

This diagram effectively demonstrates how a transfer function can shape the spectrum of a signal, emphasizing certain frequency components while suppressing others.

Figure 7.7 Noise shaping by a transfer function.
Since $S_{x}(f)$ is an even function of $f$ for real $x(t)$ [1], as depicted in Fig. 7.9, the total power carried by $x(t)$ in the frequency range $\left[f_{1} f_{2}\right]$ is equal to

$$
\begin{align*}
P_{f 1, f 2} & =\int_{-f_{2}}^{-f_{1}} S_{x}(f) d f+\int_{+f_{1}}^{+f_{2}} S_{x}(f) d f  \tag{7.5}\\
& =\int_{+f_{1}}^{+f_{2}} 2 S_{x}(f) d f \tag{7.6}
\end{align*}
$$

image_name:x_in(t)
description:The graph labeled "x_in(t)" is a time-domain waveform depicting the input signal to a system, likely representing audio or some other real-time signal.

1. **Type of Graph and Function:**
- This is a time-domain waveform graph.

2. **Axes Labels and Units:**
- The horizontal axis represents time, denoted as "t," but no specific units (like seconds or milliseconds) are given in the image.
- The vertical axis represents the amplitude of the signal, denoted as "x_in(t)," again with no specific units provided.

3. **Overall Behavior and Trends:**
- The waveform shows a series of oscillations, indicating a varying signal with multiple frequency components.
- There are no clear trends of increasing or decreasing amplitude over time, suggesting a steady-state signal.

4. **Key Features and Technical Details:**
- The waveform exhibits several peaks and valleys, typical of a complex signal with multiple frequencies.
- No specific numerical values or critical points are annotated on this graph.

5. **Annotations and Specific Data Points:**
- There are no additional annotations or markers on this graph, and no specific data points are highlighted.

Overall, this waveform serves as the initial input signal before any processing or filtering, as indicated by the subsequent graphs in the provided context.
image_name:S_xin(f)
description:The graph labeled "S_{xin}(f)" is a frequency domain representation of the input signal to a telephone system. It is a spectral density plot where the x-axis represents frequency (f) in hertz, and the y-axis represents the spectral power density, S_{xin}(f).

1. **Type of Graph and Function**:
- This is a spectral density plot, commonly used to show how the power of a signal is distributed with frequency.

2. **Axes Labels and Units**:
- The x-axis is labeled as frequency (f) and is measured in kilohertz (kHz).
- The y-axis represents the spectral power density, typically in units of power per frequency (e.g., watts per hertz), though the specific units are not marked.

3. **Overall Behavior and Trends**:
- The plot shows a spectrum that is relatively flat up to about 20 kHz, indicating that the input signal has a wide frequency range up to this point.
- After 20 kHz, there is a sharp roll-off, suggesting that higher frequencies are not present or are significantly attenuated.

4. **Key Features and Technical Details**:
- The spectral density is relatively constant across the frequency range up to 20 kHz.
- The roll-off at 20 kHz is significant, marking the end of the frequency range for the input signal.

5. **Annotations and Specific Data Points**:
- The graph does not have specific annotations or markers, but the key point is the 20 kHz cutoff frequency where the spectral density begins to decrease sharply.

This graph is part of a larger diagram illustrating the effect of a telephone system on the input signal, where the input spectrum is filtered to emphasize frequencies around 4 kHz, as shown in other parts of the diagram.
image_name:Telephone
description:The system block diagram titled "Telephone" illustrates the process of spectral shaping applied to an input signal for transmission over a telephone line. The diagram consists of several key components and stages:

1. **Main Components:**
- **Input Signal (x_in(t)):** The diagram begins with a time-domain representation of the input signal, x_in(t), which appears as a fluctuating waveform.
- **Input Spectrum (S_xin(f)):** Below the time-domain signal, the frequency-domain representation is shown, labeled S_xin(f). This spectrum extends up to 20 kHz, indicating the range of frequencies initially present in the input signal.
- **Telephone System Block (|H(f)|):** The central component is a block labeled "Telephone," which contains a frequency response curve, |H(f)|. This curve is centered around 4 kHz, suggesting that the system acts as a bandpass filter emphasizing frequencies around this range.
- **Output Signal (x_out(t)):** On the right side, the output signal x_out(t) is shown, which resembles the input waveform but is likely modified due to the filtering process.
- **Output Spectrum (S_xout(f)):** Below the output signal, the frequency-domain representation S_xout(f) is depicted. This spectrum is concentrated around 4 kHz, indicating that frequencies outside this range have been attenuated.

2. **Flow of Information:**
- The input signal x_in(t) is first represented in both time and frequency domains.
- It is then processed by the "Telephone" block, where the frequency response |H(f)| shapes the spectrum.
- The output is the modified signal x_out(t) and its corresponding frequency spectrum S_xout(f), emphasizing the 4 kHz band.

3. **Labels and Annotations:**
- The frequency response |H(f)| within the "Telephone" block is crucial, as it defines the bandpass characteristics centered at 4 kHz.
- Arrows indicate the direction of signal flow from left to right, from input to output.

4. **Overall System Function:**
- The primary function of this system is to perform spectral shaping on the input signal, allowing only frequencies around 4 kHz to pass through while attenuating others. This process is typical in telephone systems, where bandwidth is limited, and certain frequency ranges are prioritized for efficient communication. The arrangement of components and signal flow ensures that the output signal is optimized for transmission over a telephone network.
image_name:x_out(t)
description:The graph labeled "x_out(t)" is a time-domain waveform representation of an output signal after passing through a system, likely a telephone filter. Here is a detailed description of the function graph:

1. **Type of Graph and Function:**
- The graph is a time-domain waveform, showing how the signal varies over time.

2. **Axes Labels and Units:**
- The horizontal axis represents time, labeled as "t," although the specific units (e.g., milliseconds) are not provided in the image.
- The vertical axis represents the amplitude of the signal, labeled as "x_out(t)." No specific units for amplitude are given.

3. **Overall Behavior and Trends:**
- The waveform appears to be an oscillatory signal, indicating it is likely a filtered version of the input.
- The signal shows periodic oscillations, suggesting the presence of specific frequency components that have been emphasized by the filtering process.

4. **Key Features and Technical Details:**
- The signal has visible peaks and troughs, indicating the presence of amplitude variations over time.
- The frequency content of the signal is likely limited to the bandwidth shown in the frequency domain graph labeled "S_xout(f)," which is centered around 4 kHz. This suggests that the output waveform primarily contains frequency components around this range.

5. **Annotations and Specific Data Points:**
- There are no specific annotations or numerical data points provided in the time-domain graph itself.
- However, the context implies that the output signal is shaped by a bandpass filter, as evidenced by the frequency domain representation next to it, which shows a spectrum centered around 4 kHz, matching the typical telephone bandwidth.

Overall, the "x_out(t)" graph depicts the time-domain behavior of a signal that has been filtered to emphasize components around a 4 kHz frequency range, typical of telephone bandwidth filtering.
image_name:S_xout(f)
description:The graph labeled "S_{xout}(f)" is a frequency-domain plot representing the spectral output of a signal after passing through a telephone system. This graph is part of a series of diagrams illustrating the effect of spectral shaping within a telephone bandwidth.

1. **Type of Graph and Function:**
- The graph is a frequency spectrum plot, showing the power spectral density of the output signal.

2. **Axes Labels and Units:**
- The horizontal axis (x-axis) represents frequency, labeled as \( f \), with units in kilohertz (kHz). The range shown is up to approximately 4 kHz.
- The vertical axis (y-axis) represents the power spectral density, labeled as \( S_{xout}(f) \). The scale appears to be linear, but specific units are not provided.

3. **Overall Behavior and Trends:**
- The graph shows a bell-shaped curve, indicating that the output spectrum is concentrated around a certain frequency range.
- The curve peaks within the telephone bandwidth, which is typical for signals processed by telephone systems that emphasize frequencies around 3-4 kHz.

4. **Key Features and Technical Details:**
- The peak of the curve is centered around 4 kHz, which aligns with the typical bandwidth of telephone systems.
- The spectrum shows a rapid rise to the peak and a gradual decline after the peak, suggesting a bandpass filtering effect.
- There are no visible annotations for specific data points or additional markers.

5. **Annotations and Specific Data Points:**
- No specific numerical values or annotations are provided on the graph itself, but the context suggests the peak is around 4 kHz.

This graph effectively illustrates how the telephone system shapes the input signal's spectrum, emphasizing frequencies around 4 kHz while attenuating others outside this range. It complements the other graphs in the series by showing the transformation from input to output spectrum through the system.

Figure 7.8 Spectral shaping by telephone bandwidth.

image_name:Figure 7.9(a)
description:The graph labeled \( (a) \) is a two-sided noise spectrum plot. It represents the spectral power density \( S_X(f) \) as a function of frequency \( f \). The plot is symmetric about the vertical axis, indicating that it includes both positive and negative frequencies. This symmetry is typical of two-sided spectra, where negative frequencies are mirrored and combined with positive frequencies.

**Axes Labels and Units:**
- The horizontal axis represents frequency \( f \), with specific points marked as \(-f_2, -f_1, 0, f_1,\) and \( f_2 \). While no units are specified, frequency is typically measured in hertz (Hz).
- The vertical axis represents the spectral power density \( S_X(f) \), which may be measured in units such as watts per hertz (W/Hz) or decibels (dB).

**Overall Behavior and Trends:**
- The graph shows a central peak at the origin (0 frequency), indicating a significant spectral component at this frequency.
- On either side of the central peak, there are two additional peaks at frequencies \( \pm f_1 \) and \( \pm f_2 \), suggesting prominent spectral components at these frequencies as well.
- The power density decreases as the frequency moves away from these peaks, showing a typical bandpass filter shape that emphasizes certain frequency ranges while attenuating others.

**Key Features and Technical Details:**
- The central peak at 0 frequency is the highest, indicating maximum power density at this point.
- The peaks at \( \pm f_1 \) and \( \pm f_2 \) are smaller than the central peak, showing lesser but still significant spectral components.
- The graph reflects the characteristic behavior of a system that permits certain frequency bands while attenuating others, potentially modeling a bandpass filter's response.

**Annotations and Specific Data Points:**
- Dotted vertical lines mark the frequencies \( -f_2, -f_1, f_1, \) and \( f_2 \), highlighting key points in the spectrum.
- Although no specific numerical values are provided for these frequencies, they are crucial in understanding the bandwidth and filtering characteristics depicted by the graph.
image_name:Figure 7.9(b)
description:The graph labeled (b) is a one-sided noise spectrum graph. It represents the spectral density \( S_X(f) \) on the vertical axis against frequency \( f \) on the horizontal axis. The axes are not labeled with specific units, but it is implied that the frequency is in hertz (Hz). The graph uses a linear scale for both axes.

Overall Behavior and Trends:
The graph begins at a high value at frequency \( f = 0 \), indicating a peak at this point. As the frequency increases, the spectral density decreases, forming a downward slope. There is a noticeable peak between the frequencies \( f_1 \) and \( f_2 \), suggesting a region where the noise power is concentrated. Beyond \( f_2 \), the spectral density continues to decrease.

Key Features and Technical Details:
- **Peak at Zero Frequency:** The graph shows a prominent peak at zero frequency, indicating a high concentration of noise power at low frequencies.
- **Secondary Peak:** There is another peak between \( f_1 \) and \( f_2 \), which are marked by vertical dashed lines. This suggests a band of frequencies where the noise power is significant.
- **Decreasing Trend:** Beyond \( f_2 \), the graph shows a decreasing trend in spectral density, indicating attenuation of noise power at higher frequencies.

Annotations and Specific Data Points:
- The graph does not provide specific numerical values or annotations for the peaks or the exact frequencies of \( f_1 \) and \( f_2 \). However, the presence of vertical dashed lines at these points highlights their significance in the spectrum.

Figure 7.9 (a) Two-sided and (b) one-sided noise spectra.

In fact, the integral in (7.6) is the quantity measured by a power meter sensing the output of a bandpass filter between $f_{1}$ and $f_{2}$. That is, the negative-frequency part of the spectrum is folded around the vertical axis and added to the positive-frequency part. We call the representation of Fig. 7.9(a) the "two-sided" spectrum and that of Fig. 7.9(b) the "one-sided" spectrum. For example, the two-sided white spectrum of Fig. 7.6 has the one-sided counterpart shown in Fig. 7.10.

image_name:Figure 7.10 Folded white spectrum.
description:**Type of Graph and Function:**
The graph is a spectral density plot that shows the transformation from a two-sided spectrum to a one-sided spectrum. The plots are typically used to represent power spectral densities, commonly in signal processing and communications.

**Axes Labels and Units:**
- The horizontal axis is labeled \( f \), representing frequency, likely in hertz (Hz).
- The vertical axis is labeled \( S_n(f) \), representing the power spectral density, with units that could be power per hertz (e.g., watts/Hz).

**Overall Behavior and Trends:**
- The left graph (two-sided spectrum) shows a rectangular shape centered around the frequency axis, extending equally into both positive and negative frequencies. The amplitude of the spectral density is \( \frac{\eta}{2} \).
- The right graph (one-sided spectrum) shows the spectrum folded around the vertical axis, resulting in a rectangular shape that only extends into the positive frequency domain. The amplitude of the spectral density is \( \eta \).

**Key Features and Technical Details:**
- The two-sided spectrum has a constant amplitude of \( \frac{\eta}{2} \) across both the positive and negative frequencies.
- The one-sided spectrum displays a constant amplitude of \( \eta \) across the positive frequencies only.
- This transformation indicates that the total power is conserved, as the negative frequency components are added to the positive frequency components in the one-sided spectrum.

**Annotations and Specific Data Points:**
- The arrow between the two graphs visually indicates the transformation process from the two-sided to the one-sided spectrum.
- The spectral density values \( \frac{\eta}{2} \) and \( \eta \) are explicitly marked on the vertical axis of each respective graph.

In summary, the spectrum shows the power carried in a small bandwidth at each frequency, revealing how fast the waveform is expected to vary in the time domain.

### 7.1.2 Amplitude Distribution

As mentioned earlier, the instantaneous amplitude of noise is usually unpredictable. However, by observing the noise waveform for a long time, we can construct a "distribution" of the amplitude, indicating how often each value occurs. Also called the "probability density function" (PDF), the distribution of $x(t)$ is defined as

$$
\begin{equation*}
p_{X}(x) d x=\text { probability of } x<X<x+d x \tag{7.7}
\end{equation*}
$$

where $X$ is the measured value of $x(t)$ at some point in time.

As illustrated in Fig. 7.11, to estimate the distribution, we sample $x(t)$ at many points, construct bins of small width, choose the bin height equal to the number of samples whose value falls between the two edges of the bin, and normalize the bin heights to the total number of samples. Note that the PDF provides no information as to how fast $x(t)$ varies in the time domain. For example, the sound generated by a violin may have the same amplitude distribution as that produced by a drum even though their frequency contents are vastly different.
image_name:Figure 7.11 x(t)
description:The image consists of two distinct parts: a time-domain waveform and a histogram representing an amplitude distribution.

1. **Time-Domain Waveform (x(t))**:
- **Type of Graph**: This is a time-domain waveform plot.
- **Axes Labels and Units**: The horizontal axis is labeled as 't', representing time, while the vertical axis is labeled as 'x(t)', representing the amplitude of the signal at time 't'. Units are not specified, indicating a general representation.
- **Overall Behavior and Trends**: The waveform exhibits oscillatory behavior with varying amplitude, suggesting a signal composed of multiple frequency components. The oscillations are irregular, indicating noise or a complex signal.
- **Key Features and Technical Details**: The waveform crosses the time axis multiple times, showing zero crossings. There are also several peaks and troughs, but specific numerical amplitudes are not provided.
- **Annotations and Specific Data Points**: The waveform is sampled at discrete points, indicated by circles along the curve, showing where the signal has been sampled.

2. **Amplitude Distribution (Histogram)**:
- **Type of Graph**: This is a histogram representing the amplitude distribution of the sampled signal.
- **Axes Labels and Units**: The horizontal axis is labeled 'x', representing amplitude values, and the vertical axis is labeled 'Number of Samples', indicating how many samples fall into each amplitude bin.
- **Overall Behavior and Trends**: The histogram shows a distribution of amplitudes that appears roughly symmetrical, resembling a Gaussian distribution. This suggests that the amplitudes of the signal are centered around a mean value with decreasing frequency as the amplitude moves away from the center.
- **Key Features and Technical Details**: The histogram has several bins with varying heights, with the tallest bins near the center, indicating the most common amplitude values. The distribution tapers off symmetrically on both sides.
- **Annotations and Specific Data Points**: No specific numerical values or annotations are present on the histogram, but the shape suggests a normal distribution of amplitudes.
image_name:Figure 7.11 Amplitude distribution of noise
description:The graph in Figure 7.11 illustrates the amplitude distribution of noise through two subplots.

1. **Type of Graph and Function:**
- The left subplot is a time-domain waveform of a random noise signal, denoted as $x(t)$.
- The right subplot is a histogram representing the probability density function (PDF) of the noise amplitude.

2. **Axes Labels and Units:**
- In the left subplot, the horizontal axis represents time ($t$), while the vertical axis represents the amplitude of the signal ($x(t)$). No specific units are provided, suggesting a general representation.
- In the right subplot, the horizontal axis represents the amplitude ($x$), and the vertical axis shows the number of samples. Again, no specific units are given, indicating a normalized distribution.

3. **Overall Behavior and Trends:**
- The left subplot shows a fluctuating waveform typical of noise, with no apparent periodicity or regular pattern. The waveform crosses the time axis several times, indicating zero crossings, and exhibits varying peak amplitudes.
- The right subplot displays a bell-shaped histogram, which suggests a normal distribution of the noise amplitude. The central bins have higher counts, indicating that most sample values are near the mean, with fewer samples at the extremes.

4. **Key Features and Technical Details:**
- The waveform in the left subplot shows varying amplitudes and frequencies, characteristic of noise.
- The histogram in the right subplot is symmetric around the central value, typical of Gaussian distributions.

5. **Annotations and Specific Data Points:**
- The left subplot includes markers on the waveform, possibly indicating sample points.
- The right subplot does not have specific annotations or reference lines, but the shape of the histogram is crucial for understanding the amplitude distribution.

Overall, Figure 7.11 provides a visual representation of how noise behaves in both the time domain and its amplitude distribution, emphasizing the Gaussian nature of the amplitude distribution.

An important example of PDFs is the Gaussian (or normal) distribution. The central limit theorem states that if many independent random processes with arbitrary PDFs are added, the PDF of the sum approaches a Gaussian distribution [1]. It is therefore not surprising that many natural phenomena exhibit Gaussian statistics. For example, since the noise of a resistor results from the random "walk" of a very large number of electrons, each having relatively independent statistics, the overall amplitude follows a Gaussian PDF.

In this book, we employ the spectrum and average power of noise to a much greater extent than the amplitude distribution. For completeness, however, we note that the Gaussian PDF is defined as

$$
\begin{equation*}
p_{X}(x)=\frac{1}{\sigma \sqrt{2 \pi}} \exp \frac{-(x-m)^{2}}{2 \sigma^{2}} \tag{7.8}
\end{equation*}
$$

where $\sigma$ and $m$ are the standard deviation and mean of the distribution, respectively. For Gaussian distribution, $\sigma$ is equal to the rms value of the noise.

### 7.1.3 Correlated and Uncorrelated Sources

In analyzing circuits, we often need to add the effect of several sources of noise to obtain the total noise. While for deterministic voltages and currents, we simply use the superposition principle, the procedure is somewhat different for random noise because we are ultimately interested in the average noise power. Let us add two noise waveforms and take the average of the resulting power:

$$
\begin{align*}
P_{a v}= & \lim _{T \rightarrow \infty} \frac{1}{T} \int_{-T / 2}^{+T / 2}\left[x_{1}(t)+x_{2}(t)\right]^{2} d t  \tag{7.9}\\
= & \lim _{T \rightarrow \infty} \frac{1}{T} \int_{-T / 2}^{+T / 2} x_{1}^{2}(t) d t+\lim _{T \rightarrow \infty} \frac{1}{T} \int_{-T / 2}^{+T / 2} x_{2}^{2}(t) d t \\
& +\lim _{T \rightarrow \infty} \frac{1}{T} \int_{-T / 2}^{+T / 2} 2 x_{1}(t) x_{2}(t) d t  \tag{7.10}\\
= & P_{a v 1}+P_{a v 2}+\lim _{T \rightarrow \infty} \frac{1}{T} \int_{-T / 2}^{+T / 2} 2 x_{1}(t) x_{2}(t) d t \tag{7.11}
\end{align*}
$$

where $P_{a v 1}$ and $P_{a v 2}$ denote the average power of $x_{1}(t)$ and $x_{2}(t)$, respectively. Called the "correlation" between $x_{1}(t)$ and $x_{2}(t),{ }^{4}$ the third term in (7.11) indicates how "similar" these two waveforms are. If generated by independent devices, the noise waveforms are usually "uncorrelated" and the integral in (7.11) vanishes. For example, the noise produced by a resistor has no correlation with that generated by a transistor. In such a case, $P_{a v}=P_{a v 1}+P_{a v 2}$. From this observation, we say that superposition holds for the power of uncorrelated noise sources. Of course, superposition also holds for noise voltages and currents, but this does not help us in most cases.

A familiar analogy is that of the spectators in a sports stadium. Before the game begins, many conversations are in progress, generating uncorrelated noise components [Fig. 7.12(a)]. During the game, the spectators applaud (or scream) simultaneously, producing correlated noise at a much higher power level arising from the third term in Eq. (7.11). [Fig. 7.12(b)].
image_name:Figure 7.12 (a)
description:The diagram labeled "Figure 7.12 (a)" illustrates the concept of uncorrelated noise generation, using a block diagram to represent the superposition of multiple noise sources. This diagram is part of a larger discussion on noise in systems, particularly in the context of a sports stadium analogy.

Main Components:
1. **Noise Sources (x1(t), x2(t), x3(t))**: These are depicted as three separate waveforms entering the system from the left. Each waveform represents an independent noise source, characterized by its own unique time-varying signal.
2. **Summation Block (+)**: This is the central component of the diagram, depicted as a circle with a plus sign inside. It serves to combine the inputs from the three noise sources into a single output signal.
3. **Output (xtot(t))**: The resulting waveform after the summation block represents the total noise output, which is also a time-varying signal.

Flow of Information or Control:
- The noise signals (x1(t), x2(t), x3(t)) flow from left to right into the summation block. Each signal is independent and uncorrelated with the others, meaning they do not influence each other’s characteristics.
- The summation block adds these signals together to produce the total output noise signal, xtot(t), which is also shown as a waveform moving towards the right.

Labels, Annotations, and Key Indicators:
- Each input signal is labeled with its respective function of time (x1(t), x2(t), x3(t)), indicating their nature as time-dependent noise sources.
- The output is labeled xtot(t), signifying the total noise output.
- The direction of time (t) is indicated by arrows, showing the progression of the signals through the system.

Overall System Function:
The primary function of this system is to illustrate how uncorrelated noise sources combine to produce a total noise output. Each input noise source contributes independently to the output, and the summation block simply adds these contributions without any correlation between them. This model helps in understanding how different noise components interact in a system, particularly when they are uncorrelated, as in the pre-game conversations analogy in a stadium.
image_name:Figure 7.12 (b)
description:Figure 7.12(b) illustrates a system block diagram representing correlated noise generated in a stadium. The diagram consists of three main components: noise sources labeled as \(x_1(t)\), \(x_2(t)\), and \(x_3(t)\), and a summing junction represented by a circle with a plus sign inside it. Each noise source generates a signal that is fed into the summing junction.

1. **Main Components:**
- **Noise Sources (\(x_1(t)\), \(x_2(t)\), \(x_3(t)\))**: These represent the individual noise signals generated by different sections of the spectators in the stadium. Each signal is depicted as a waveform, indicating its time-varying nature.
- **Summing Junction**: This is where the individual noise signals are combined. The circle with a plus sign symbolizes the addition of these signals.

2. **Flow of Information:**
- The noise signals \(x_1(t)\), \(x_2(t)\), and \(x_3(t)\) flow into the summing junction. The arrows indicate the direction of the signal flow towards the summing junction.
- The output of the summing junction is labeled as \(x_{tot}(t)\), representing the total noise signal. This output is shown as a waveform with a much larger amplitude compared to the individual inputs, signifying the correlated nature of the noise.

3. **Labels and Annotations:**
- The time variable \(t\) is indicated on the horizontal axis, emphasizing the temporal aspect of the noise signals.
- The labels \(x_1(t)\), \(x_2(t)\), \(x_3(t)\), and \(x_{tot}(t)\) are crucial for identifying the individual and total noise signals.

4. **Overall System Function:**
- The primary function of this diagram is to demonstrate how individual noise signals, when correlated, can combine to produce a much larger total noise signal. This is analogous to spectators in a stadium whose simultaneous applause or screams create a significant noise level. The arrangement of the blocks and the flow of information highlight the process of noise correlation and amplification.

Figure 7.12 (a) Uncorrelated noise and (b) correlated noise generated in a stadium.

In most cases studied in this book, the noise sources are uncorrelated. One exception is studied in Section 7.3.
image_name:Figure 7.13 (a)
description:**Main Components:**
The system block diagram labeled "Figure 7.13 (a)" illustrates the process of signal amplification and the presence of noise in the output. The key component in this diagram is the **Amplifier**. The diagram also shows the input signal, denoted as **Vin**, entering the amplifier.

**Flow of Information or Control:**
The flow of information begins with the input sinusoidal signal **Vin** entering the amplifier. The amplifier then processes this input signal, producing an output that consists of both the amplified signal and noise. The noise is depicted as a smaller, jagged waveform superimposed on the larger sinusoidal waveform at the output, indicating the presence of noise in the amplified signal.

**Labels, Annotations, and Key Indicators:**
The input is labeled as **Vin**, and the output is shown with two components: the **Signal** and **Noise**. The signal is represented by a larger sinusoidal waveform, while the noise is represented by a smaller, jagged waveform. The time variable **t** is indicated on the horizontal axis of the output, showing the temporal nature of the signal and noise.

**Overall System Function:**
The primary function of this system is to amplify an input signal while also illustrating the presence of noise in the output. The arrangement of the blocks shows the direct path from input to output through the amplifier, highlighting how noise can be introduced during amplification. The diagram emphasizes the importance of considering noise in the design and analysis of amplification systems to ensure a desirable signal-to-noise ratio.
image_name:Figure 7.13 (b)
description:Figure 7.13 (b) illustrates a frequency response graph, likely representing the output noise of an amplifier circuit. The graph is a Bode plot, which depicts the magnitude of the transfer function \(|H(\omega)|\) on the vertical axis and frequency \(f\) on the horizontal axis. The frequency axis is in hertz, ranging from 0 to beyond 1 MHz, and the plot uses a linear scale.

The graph shows a flat response in the audio range up to 20 kHz, indicating that the amplifier maintains a consistent gain within this range. Beyond 20 kHz, the response continues flat until it approaches 1 MHz, where it begins to roll off, suggesting a decrease in gain as the frequency increases beyond this point.

Key features include:
- A clearly marked audio range extending up to 20 kHz, indicating the frequencies that are most relevant for audio applications.
- The amplifier bandwidth is marked from 0 to 1 MHz, showing the range over which the amplifier can operate effectively.
- The roll-off beyond 1 MHz suggests a typical low-pass filter behavior, where higher frequencies are attenuated.

The graph is annotated with dashed lines at 20 kHz and 1 MHz, highlighting the transition points in the frequency response. This behavior is typical for amplifiers designed to handle audio signals while minimizing noise at higher frequencies.

Figure 7.13 (a) Output noise produced by a circuit, and (b) additional noise if bandwidth is excessively wide.

### 7.1.4 Signal-to-Noise Ratio

Suppose an amplifier receives a sinusoidal signal as shown in Fig. 7.13. The output contains both the amplified signal and the noise generated by the circuit. For the output signal to be intelligible, its power, $P_{\text {sig }}$, must be sufficiently higher than that of the noise, $P_{\text {noise }}$. We therefore define the "signal-to-noise ratio" (SNR) as

$$
\begin{equation*}
\mathrm{SNR}=\frac{P_{\text {sig }}}{P_{\text {noise }}} \tag{7.12}
\end{equation*}
$$

[^35]For example, audio signals require a minimum SNR of about 20 dB (i.e., $P_{\text {sig }} / P_{\text {noise }}=100$ ). ${ }^{5}$ For a sinusoid having a peak amplitude of $A, P_{\text {sig }}=A^{2} / 2$, but how do we calculate $P_{\text {noise }}$ ? The total average power carried by noise is equal to the area under its spectrum:

$$
\begin{equation*}
P_{\text {noise }}=\int_{-\infty}^{+\infty} S_{\text {noise }}(f) d f \tag{7.13}
\end{equation*}
$$

Does this mean that $P_{\text {noise }}$ can be very large if $S_{\text {noise }}(f)$ spans a wide frequency range? Yes, indeed. As an example, suppose the above amplifier provides a bandwidth of 1 MHz while sensing an audio signal [Fig. 7.13(b)]. Then, the signal is corrupted by all of the noise components in the 1-MHz bandwidth. For this reason, the bandwidth of the circuit must always be limited to the minimum acceptable value so as to minimize the integrated noise power. The bandwidth can be reduced within the amplifier or by a low-pass filter placed thereafter.

#### Example 7.2

An amplifier produces a one-sided noise spectrum given by $S_{\text {noise }}(f)=5 \times 10^{-16} \mathrm{~V}^{2} / \mathrm{Hz}$. Determine the total output noise in a bandwidth of 1 MHz .

#### Solution

We have

$$
\begin{align*}
P_{\text {noise }} & =\int_{0}^{1 \mathrm{MHz}} S_{\text {noise }}(f) d f  \tag{7.14}\\
& =5 \times 10^{-10} \mathrm{~V}^{2} \tag{7.15}
\end{align*}
$$

Note that the total integrated noise is measured in $\mathrm{V}^{2}$ and not in $\mathrm{V}^{2} / \mathrm{Hz}$. This noise power corresponds to an rms voltage of $\sqrt{5 \times 10^{-10} \mathrm{~V}^{2}}=22.4 \mu \mathrm{~V}$.

### 7.1.5 Noise Analysis Procedure

With the tools developed in previous sections, we can now outline a methodology for the analysis of noise in circuits. The output signal of a given circuit is corrupted by the noise sources within the circuit. We are therefore interested in the noise observed at the output. Our procedure consists of four steps:

1. Identify the sources of noise (e.g., resistors and transistors) and write down the spectrum of each.
2. Find the transfer function from each noise source to the output (as if the source were a deterministic signal).
3. Utilize the theorem $S_{Y}(f)=S_{x}(f)|H(f)|^{2}$ to calculate the output noise spectrum contributed by each noise source. (The input signal is set to zero.)
4. Add all of the output spectra, paying attention to correlated and uncorrelated sources.

This procedure gives the output noise spectrum, which must then be integrated from $-\infty$ to $+\infty$ so as to yield the total output noise. To carry out the first step, we need the noise representation of various electronic devices, to be described in the next section.

## 7.2 ■ Types of Noise

Analog signals processed by integrated circuits are corrupted by two different types of noise: device electronic noise and "environmental" noise. The latter refers to (seemingly) random disturbances that a circuit experiences through the supply or ground lines or through the substrate. We focus on device electronic noise here and defer the study of environmental noise to Chapter 19.

### 7.2.1 Thermal Noise

Resistor Thermal Noise The random motion of electrons in a conductor introduces fluctuations in the voltage measured across the conductor, even if the average current is zero. Thus, the spectrum of thermal noise is proportional to the absolute temperature. As shown in Fig. 7.14, the thermal noise of a resistor $R$ can be modeled by a series voltage source, with the one-sided spectral density

$$
\begin{equation*}
S_{v}(f)=4 k T R, \quad f \geq 0 \tag{7.16}
\end{equation*}
$$

image_name:Figure 7.14
description:
[
name: R, type: Resistor, value: R, ports: {N1: X1, N2: X2}
name: V^2_n, type: VoltageSource, ports: {Np: X3, Nn: X2}
]
extrainfo:The diagram models the thermal noise of a resistor with a noiseless resistor R and a voltage source V^2_n representing the noise voltage. The spectral density of the thermal noise is given by S_v(f) = 4kTR.
image_name:Figure 7.14 S_v(f)
description:The graph labeled "S_v(f)" is a plot representing the one-sided spectral density of thermal noise voltage across a noiseless resistor. The graph is a two-dimensional plot with the horizontal axis labeled as frequency, denoted by "f," and the vertical axis labeled as the spectral density of voltage noise, denoted by "S_v(f)". The units for the vertical axis are volts squared per hertz (V²/Hz).

1. **Type of Graph and Function:**
- This is a spectral density plot, specifically showing the thermal noise voltage across a resistor.

2. **Axes Labels and Units:**
- The horizontal axis (x-axis) represents frequency (f) and is typically measured in hertz (Hz).
- The vertical axis (y-axis) represents the spectral density of the noise voltage, S_v(f), in units of V²/Hz.

3. **Overall Behavior and Trends:**
- The plot shows a constant value for the spectral density across all frequencies, indicating that the thermal noise is white, meaning it has equal intensity at all frequencies.
- The value of the spectral density is constant at 4kTR, where k is the Boltzmann constant, T is the absolute temperature in Kelvin, and R is the resistance in ohms.

4. **Key Features and Technical Details:**
- The graph is a flat line parallel to the frequency axis, highlighting the frequency-independent nature of thermal noise.
- There are no peaks, valleys, or inflection points, as the plot is a constant line.

5. **Annotations and Specific Data Points:**
- The line is marked at the vertical value of 4kTR, indicating the magnitude of the spectral density.
- There are no specific data points or markers other than the constant value line, emphasizing the uniform distribution of noise across frequencies.

Figure 7.14 Thermal noise of a resistor.

where $k=1.38 \times 10^{-23} \mathrm{~J} / \mathrm{K}$ is the Boltzmann constant. Note that $S_{v}(f)$ is expressed in $\mathrm{V}^{2} / \mathrm{Hz}$. Thus, we also write $\overline{V_{n}^{2}}=4 k T R$, where the overline indicates averaging. ${ }^{6}$ We may even say that the noise "voltage" is given by $4 k T R$ even though this quantity is in fact the noise voltage squared. For example, a $50-\Omega$ resistor held at $T=300 \mathrm{~K}$ exhibits $8.28 \times 10^{-19} \mathrm{~V}^{2} / \mathrm{Hz}$ of thermal noise. To convert this number to a more familiar voltage quantity, we take the square root, obtaining $0.91 \mathrm{nV} / \sqrt{\mathrm{Hz}}$. While the square root of hertz may appear strange, it is helpful to remember that $0.91 \mathrm{nV} / \sqrt{\mathrm{Hz}}$ has little significance per se and simply means that the power in a $1-\mathrm{Hz}$ bandwidth is equal to $\left(0.91 \times 10^{-9}\right)^{2} \mathrm{~V}^{2}$.

The equation $S_{v}(f)=4 k T R$ suggests that thermal noise is white. In reality, $S_{v}(f)$ is flat for up to roughly 100 THz , dropping at higher frequencies. For our purposes, the white spectrum is quite accurate.

Since noise is a random quantity, the polarity used for the voltage source in Fig. 7.14 is unimportant. Nevertheless, once a polarity is chosen, it must be retained throughout the analysis of the circuit so as to obtain consistent results.

#### Example 7.3

Consider the $R C$ circuit shown in Fig. 7.15. Calculate the noise spectrum and the total noise power in $V_{\text {out }}$.
image_name:Figure 7.15
description:
[
name: R, type: Resistor, value: R, ports: {N1: X1, N2: X2}
name: C, type: Capacitor, value: C, ports: {Np: X1, Nn: X2}
name: Vout, type: VoltageSource, value: Vout, ports: {Np: X1, Nn: X2}
]
extrainfo:The circuit is a low-pass filter with a resistor R and capacitor C. Noise is modeled by a voltage source V2R in series with the resistor.

Figure 7.15 Noise generated in a low-pass filter. ${ }^{\mathrm{x}_{3}}$

#### Solution

We follow the four steps described in Section 7.1.5. The noise spectrum of $R$ is given by $S_{v}(f)=4 k T R$. Next, modeling the noise of $R$ by a series voltage source $V_{R}$, we compute the transfer function from $V_{R}$ to $V_{\text {out }}$ :

$$
\begin{equation*}
\frac{V_{\text {out }}}{V_{R}}(s)=\frac{1}{R C s+1} \tag{7.17}
\end{equation*}
$$

From the theorem in Section 7.1.1, we have

$$
\begin{align*}
S_{\text {out }}(f) & =S_{v}(f)\left|\frac{V_{\text {out }}}{V_{R}}(j \omega)\right|^{2}  \tag{7.18}\\
& =4 k T R \frac{1}{4 \pi^{2} R^{2} C^{2} f^{2}+1} \tag{7.19}
\end{align*}
$$

Thus, the white noise spectrum of the resistor is shaped by a low-pass characteristic (Fig. 7.16). To calculate the total noise power at the output, we write

$$
\begin{equation*}
P_{n, \text { out }}=\int_{0}^{\infty} \frac{4 k T R}{4 \pi^{2} R^{2} C^{2} f^{2}+1} d f \tag{7.20}
\end{equation*}
$$

image_name:S_v(f)
description:The graph labeled "S_v(f)" is a plot representing the white noise spectrum of a resistor, shaped by a low-pass filter characteristic. It is a frequency-domain graph with the following features:

1. **Type of Graph and Function:**
- This is a spectrum plot showing the power spectral density of noise as a function of frequency.

2. **Axes Labels and Units:**
- The horizontal axis represents frequency, labeled as \( f \), and is measured in hertz (Hz).
- The vertical axis represents the power spectral density, labeled as \( S_v(f) \), and is measured in units of \( 4kTR \), where \( k \) is Boltzmann's constant, \( T \) is the temperature, and \( R \) is the resistance.

3. **Overall Behavior and Trends:**
- The graph shows a constant value of \( 4kTR \) across all frequencies, indicating a flat or white noise spectrum. This means the power spectral density is uniform across the frequency range.

4. **Key Features and Technical Details:**
- The graph is a horizontal line, indicating that the noise power does not vary with frequency. This is characteristic of white noise, which contains equal power across all frequencies.
- There are no peaks, valleys, or inflection points in this graph, as it represents a constant power spectral density.

5. **Annotations and Specific Data Points:**
- The value of \( S_v(f) \) is explicitly marked as \( 4kTR \), emphasizing the uniformity of the noise spectrum.

This graph is part of a broader analysis involving noise shaping by a low-pass filter, as indicated by the context and the accompanying schematic diagram of a resistor-capacitor (RC) circuit.
image_name:V_n,out
description:
[
name: R, type: Resistor, value: R, ports: {N1: X1, N2: X2}
name: C, type: Capacitor, value: C, ports: {N1: X2, N2: X3}
]
extrainfo:The circuit is a simple RC low-pass filter, which shapes the noise spectrum of the resistor. It consists of a resistor R and capacitor C in series, with the output taken across the capacitor. The input is at node X1, and the output Vn,out is at node X3. The noise spectrum is shaped from a flat spectrum to one with a low-pass characteristic.
image_name:S_out(f)
description:The graph labeled "S_out(f)" is a frequency domain plot depicting the output noise power spectral density as a function of frequency for a system characterized by a low-pass filter. Here is a detailed description of the graph:

1. **Type of Graph and Function:**
- The graph is a power spectral density plot in the frequency domain, illustrating how the noise power is distributed across different frequencies.

2. **Axes Labels and Units:**
- The horizontal axis represents frequency \( f \), typically measured in hertz (Hz).
- The vertical axis represents the noise power spectral density \( S_{\text{out}}(f) \), with units of power per frequency, often in \( \text{V}^2/\text{Hz} \).
- The scale appears to be linear for both axes.

3. **Overall Behavior and Trends:**
- The graph shows a characteristic low-pass filter response. At lower frequencies, the noise power spectral density is constant and equal to \( 4kTR \), where \( k \) is Boltzmann's constant, \( T \) is the temperature, and \( R \) is the resistance.
- As frequency increases, the noise power spectral density begins to decrease, exhibiting a roll-off that is typical of a low-pass filter.
- The transition from the flat region to the declining region represents the cutoff behavior of the filter.

4. **Key Features and Technical Details:**
- The flat region at low frequencies indicates that the noise is white, meaning it has a constant power spectral density.
- The roll-off begins at a certain cutoff frequency, beyond which the noise power decreases, following the low-pass filter characteristic.
- The graph does not explicitly mark the cutoff frequency, but the decreasing trend indicates the filter's effect.

5. **Annotations and Specific Data Points:**
- The value \( 4kTR \) is annotated on the vertical axis, emphasizing the level of noise power spectral density in the passband.
- There are no specific markers for the cutoff frequency or other critical points, but the general shape indicates the low-pass filtering effect.

Figure 7.16 Noise spectrum shaping by a low-pass filter.
Note that the integration must be with respect to $f$ rather than $\omega$ (why?). Since

$$
\begin{equation*}
\int \frac{d x}{x^{2}+1}=\tan ^{-1} x \tag{7.21}
\end{equation*}
$$

the integral reduces to

$$
\begin{align*}
P_{n, \text { out }} & =\left.\frac{2 k T}{\pi C} \tan ^{-1} u\right|_{u=0} ^{u=\infty}  \tag{7.22}\\
& =\frac{k T}{C} \tag{7.23}
\end{align*}
$$

Note that the unit of $k T / C$ is $\mathrm{V}^{2}$. We may also consider $\sqrt{k T / C}$ as the total rms noise voltage measured at the output. For example, with a 1-pF capacitor, the total noise voltage is equal to $64.3 \mu \mathrm{~V}_{\mathrm{rms}}$ at $T=300 \mathrm{~K}$.

Equation (7.23) implies that the total noise at the output of the circuit shown in Fig. 7.15 is independent of the value of $R$. Intuitively, this is because for larger values of $R$, the associated noise per unit bandwidth increases while the overall bandwidth of the circuit decreases. The fact that $k T / C$ noise can be decreased only by increasing $C$ (if $T$ is fixed) introduces many difficulties in the design of analog circuits (Chapter 13).

The thermal noise of a resistor can be represented by a parallel current source as well (Fig. 7.17). For the representations of Figs. 7.14 and 7.17 to be equivalent, we have $\overline{V_{n}^{2}} / R^{2}=\overline{I_{n}^{2}}$, that is, $\overline{I_{n}^{2}}=4 k T / R$. Note that $\overline{I_{n}^{2}}$ is expressed in $\mathrm{A}^{2} / \mathrm{Hz}$. Depending on the circuit topology, one model may lead to simpler calculations than the other.
image_name:Figure 7.17
description:
[
name: R, type: Resistor, value: R, ports: {N1: X1, N2: X2}
name: I^2_n, type: CurrentSource, value: I^2_n, ports: {Np: X2, Nn: X1}
]
extrainfo:The circuit represents the thermal noise of a resistor using a parallel current source model. The current source is denoted as I_n with a spectral density of 4kT/R.

Figure 7.17 Representation of resistor thermal noise by a current source.

#### Example 7.4

Calculate the equivalent noise voltage of two parallel resistors $R_{1}$ and $R_{2}$ [Fig. 7.18(a)].
image_name:Fig. 7.18(a)
description:
[
name: R1, type: Resistor, value: R1, ports: {N1: X1, N2: X2}
name: R2, type: Resistor, value: R2, ports: {N1: X1, N2: X2}
]
extrainfo:The circuit represents two parallel resistors R1 and R2 with their thermal noise modeled as parallel current sources In1 and In2. The total noise voltage across the resistors is represented as Vn,tot.
image_name:Fig. 7.18(b)
description:
[
name: R1, type: Resistor, value: R1, ports: {N1: X1, N2: X2}
name: R2, type: Resistor, value: R2, ports: {N1: X1, N2: X2}
name: I^2n1, type: CurrentSource, value: I^2n1, ports: {Np: X1, Nn: X2}
name: I^2n2, type: CurrentSource, value: I^2n2, ports: {Np: X1, Nn: X2}
]
extrainfo:The diagram represents the thermal noise model of two parallel resistors R1 and R2 using current sources In1 and In2 with spectral density 4kT/R. The total noise current is calculated by adding the powers of the individual noise currents.


#### Solution

As shown in Fig. 7.18(b), each resistor exhibits an equivalent noise current with the spectral density $4 k T / R$. Since the two noise sources are uncorrelated, we add the powers:

$$
\begin{align*}
\overline{I_{n, t o t}^{2}} & =\overline{I_{n 1}^{2}}+\overline{I_{n 2}^{2}}  \tag{7.24}\\
& =4 k T\left(\frac{1}{R_{1}}+\frac{1}{R_{2}}\right) \tag{7.25}
\end{align*}
$$

Thus, the equivalent noise voltage is given by

$$
\begin{align*}
\overline{V_{n, t o t}^{2}} & =\overline{I_{n, t o t}^{2}}\left(R_{1} \| R_{2}\right)^{2}  \tag{7.26}\\
& =4 k T\left(R_{1} \| R_{2}\right) \tag{7.27}
\end{align*}
$$

as intuitively expected. Note that our notation assumes a $1-\mathrm{Hz}$ bandwidth.

The dependence of thermal noise (and some other types of noise) upon $T$ suggests that low-temperature operation can decrease the noise in analog circuits. This approach becomes more attractive with the observation that the mobility of charge carriers in MOS devices increases at low temperatures [2]. ${ }^{7}$ Nonetheless, the required cooling equipment limits the practicality of low-temperature circuits.

MOSFETs MOS transistors also exhibit thermal noise. The most significant source is the noise generated in the channel. It can be proved [4] that for long-channel MOS devices operating in saturation, the channel noise can be modeled by a current source connected between the drain and source terminals (Fig. 7.19) with a spectral density: ${ }^{8}$

$$
\begin{equation*}
\overline{I_{n}^{2}}=4 k T \gamma g_{m} \tag{7.28}
\end{equation*}
$$

image_name:Figure 7.19 Thermal noise of a MOSFET
description:
[
name: M, type: NMOS, ports: {S: s1, D: d1, G: g1}
name: I_n^2, type: CurrentSource, value: 4kTγgm, ports: {Np: d1, Nn: s1}
]
extrainfo:The circuit diagram represents the thermal noise model of a MOSFET in saturation, with a noise current source connected between the drain and source terminals.

Figure 7.19 Thermal noise of a MOSFET.

The coefficient $\gamma$ (not to be confused with the body effect coefficient!) is derived to be equal to $2 / 3$ for long-channel transistors and may need to be replaced by a larger value for submicron MOSFETs [5]. It also varies to some extent with the drain-source voltage. As a rule of thumb, we assume $\gamma \approx 1$.

#### Example 7.5

Find the maximum noise voltage that a single MOSFET can generate.

#### Solution

As shown in Fig. 7.20, the maximum output noise occurs if the transistor sees only its own output impedance as the load, i.e., if the external load is an ideal current source. The output noise voltage spectrum is then given by $S_{\text {out }}(f)=S_{\text {in }}(f)|H(f)|^{2}$, i.e.,

$$
\begin{align*}
\overline{V_{n}^{2}} & =\overline{I_{n}^{2}} r_{O}^{2}  \tag{7.29}\\
& =\left(4 k T \gamma g_{m}\right) r_{O}^{2} \tag{7.30}
\end{align*}
$$

image_name:Figure 7.20
description:The circuit diagram represents a noise analysis setup for an NMOS transistor M1 with a current source I1 as the load. The noise current is given by I_n^2 = 4kTγg_m. The output noise voltage is measured across Vn2_out.


Let us make three observations. First, (7.30) suggests that the noise current of a MOS transistor decreases if the transconductance drops. For example, if the transistor operates as a constant current source, it is desirable to minimize its transconductance.

Second, the noise measured at the output of the circuit does not depend on where the input terminal is because for output noise calculation, the input is set to zero. ${ }^{9}$ For example, the circuit of Fig. 7.20 may be a common-source or a common-gate stage, exhibiting the same output noise.

Third, the output resistance, $r_{O}$, does not produce noise because it is not a physical resistor.

The ohmic sections of a MOSFET also contribute thermal noise. As conceptually illustrated in the top view of Fig. 7.21(a), the gate, source, and drain materials exhibit finite resistivity, thereby introducing noise. For a relatively wide transistor, the source and drain resistance is typically negligible whereas the gate distributed resistance may become noticeable.

image_name:(a)
description:The image labeled as (a) depicts the layout of a MOSFET, highlighting the terminal resistances. The diagram shows a top view of the MOSFET structure, focusing on the gate (G), source (S), and drain (D) terminals. The gate is connected to a polysilicon line that runs horizontally through the structure, and this line is depicted with multiple resistive elements, indicating distributed resistance along the gate. This resistance can introduce noise into the device, as described in the context.

The layout shows the source (S) and drain (D) terminals at the top and bottom, respectively, with the gate (G) on the left side. The resistive elements are represented as zigzag lines within the polysilicon gate material, suggesting finite resistivity and noise contribution. The polysilicon material is labeled, emphasizing its role in the gate's resistive properties.

Overall, the diagram illustrates how the distributed gate resistance can affect the performance of the MOSFET by introducing thermal noise, particularly in wide transistors where this resistance becomes significant.
image_name:(b)
description:The circuit consists of multiple NMOS transistors M1, M2, ..., Mn connected in parallel with distributed gate resistances RG1, RG2, ..., RGn. The resistors R1, RD, RS are connected to the NMOS M1. This configuration may be used to model distributed gate resistance in wide transistors.
image_name:(c)
description:The circuit diagram (c) represents a distributed gate resistance model for multiple NMOS transistors connected in parallel. The total gate resistance is the sum of individual resistances RG1, RG2, ..., RGn, denoted as RG.

Figure 7.21 (a) Layout of a MOSFET indicating the terminal resistances; (b) circuit model; (c) distributed gate resistance.

In the noise model of Fig. 7.21(b), a lumped resistor $R_{1}$ represents the distributed gate resistance. Viewing the overall transistor as the distributed structure shown in Fig. 7.21(c), we observe that the unit transistors near the left end see the noise of only a fraction of $R_{G}$ whereas those near the right end see the noise of most of $R_{G}$. We therefore expect the lumped resistor in the noise model to be less than $R_{G}$. In fact, it can be proved that $R_{1}=R_{G} / 3$ (Problem 7.3) [3], and hence the noise generated by the gate resistance is given by $\overline{V_{n R G}^{2}}=4 k T R_{G} / 3$.

While the thermal noise generated in the channel is controlled by only the transconductance of the device, the effect of $R_{G}$ can be reduced by proper layout. Shown in Fig. 7.22 are two examples. In Fig. 7.22(a), the two ends of the gate are shorted by a metal line, thus reducing the distributed resistance from $R_{G}$ to $R_{G} / 4$ (why?). Alternatively, the transistor can be folded as described in Chapter 19 [Fig. 7.22(b)] so that each gate "finger" exhibits a resistance of $R_{G} / 2$, yielding a total distributed resistance of $R_{G} / 4$ for the composite transistor.
image_name:Fig. 7.22(a)
description:The diagram illustrates two methods for reducing gate resistance in transistors. In Fig. 7.22(a), the ends of the gate are shorted by a metal line, reducing the distributed resistance from R_G to R_G/4. In Fig. 7.22(b), the transistor is folded, so each gate "finger" has a resistance of R_G/2, resulting in a total resistance of R_G/4 for the composite transistor. These techniques help in reducing the thermal noise spectrum due to gate resistance.
image_name:Fig. 7.22(b)
description:The diagram in Fig. 7.22(b) illustrates a folded transistor layout, where the gate resistance is reduced by configuring the transistor into multiple gate fingers. This configuration decreases the resistance by distributing it across the fingers, effectively reducing the total gate resistance to R_G/4 for the composite transistor. The source (S) and drain (D) are labeled, and the width of each finger is W/2, contributing to the overall reduction in resistance.

Figure 7.22 Reduction of gate resistance by (a) adding contacts to both sides or (b) folding.

#### Example 7.6

A transistor of width $W$ is laid out with one gate finger and exhibits a total gate resistance of $R_{G}$ [Fig. 7.23(a)]. Now, we reconfigure the device into four equal gate fingers [Fig. 7.23(b)]. Determine the total gate resistance thermal noise spectrum of the new structure.
image_name:Figure 7.23(a)
description:The image consists of two schematic diagrams labeled as (a) and (b), representing different configurations of a transistor's gate layout.

1. **Identification of Components and Structure:**
- **Diagram (a):** Depicts a single gate finger configuration. It shows a horizontal rectangular bar representing the gate with a total width labeled as \( W \). The gate is flanked by several small black squares on both sides, indicating contact points or vias.
- **Diagram (b):** Illustrates a reconfigured gate layout with four parallel gate fingers. Each finger is a narrower vertical bar with a width of \( W/4 \). Similar to diagram (a), there are black squares on both sides of each finger, indicating contact points.

2. **Connections and Interactions:**
- **Diagram (a):** The single gate finger spans the entire width \( W \), suggesting a straightforward connection across the contacts.
- **Diagram (b):** The four gate fingers are arranged in parallel, indicating that they are electrically connected in parallel. This configuration reduces the overall gate resistance by distributing the resistance across multiple paths.

3. **Labels, Annotations, and Key Features:**
- The width of the gate in diagram (a) is labeled as \( W \).
- In diagram (b), each gate finger is labeled with a width of \( W/4 \), highlighting the division of the original gate into four smaller fingers.
- The black squares serve as visual markers for electrical contacts or vias, crucial for understanding the flow of current and the reduction of resistance in the layout.

Overall, the diagrams illustrate how dividing a gate into multiple fingers can significantly reduce gate resistance due to the parallel configuration, which is a key consideration in transistor design to minimize thermal noise.
image_name:Figure 7.23(b)
description:The image labeled "(b)" depicts a transistor layout reconfigured into four parallel gate fingers, each with a width of $W/4$. The diagram shows a vertical arrangement of four rectangular gate fingers, each finger having a contact at both ends. These contacts are represented by small black squares, indicating electrical connection points. The gate fingers are evenly spaced and aligned in parallel, suggesting that they share a common electrical pathway that reduces overall resistance by dividing it among the four fingers.

The structure appears to be a simplified schematic, focusing on the layout and electrical configuration rather than physical details of the transistor. The parallel arrangement of the gate fingers is designed to decrease the gate resistance by a factor of 48, as inferred from the context. This reduction is achieved by distributing the resistance across multiple pathways, effectively lowering the thermal noise spectrum associated with the gate resistance.

The diagram highlights key features such as the reduced width of each gate finger ($W/4$) compared to the original single gate finger width ($W$), and the parallel configuration that facilitates reduced resistance and improved performance. The layout is indicative of a design strategy aimed at optimizing electrical characteristics by modifying the physical structure of the transistor's gate layout.

#### Solution

With a width of $W / 4$, each gate finger now has a distributed resistance of $R_{G} / 4$ and hence a lumped-model resistance of $R_{G} / 12$. Since the four fingers are in parallel, the net resistance is given by $R_{G} / 48$, yielding a noise spectrum of

$$
\begin{equation*}
\overline{V_{n R G}^{2}}=4 k T \frac{R_{G}}{48} \tag{7.31}
\end{equation*}
$$

(In general, if the gate is decomposed into $N$ parallel fingers, the distributed resistance falls by a factor of $N^{2}$.)

#### Example 7.7

Find the maximum thermal noise voltage that the gate resistance of a single MOSFET can generate. Neglect the device capacitances.

#### Solution

If the total distributed gate resistance is $R_{G}$, then from Fig. 7.24 , the output noise voltage due to $R_{G}$ is given by

$$
\begin{equation*}
\overline{V_{n, \text { out }}^{2}}=4 k T \frac{R_{G}}{3}\left(g_{m} r_{O}\right)^{2} \tag{7.32}
\end{equation*}
$$

An important observation here is that, for the gate resistance noise to be negligible, we must ensure that (7.32) is much less than (7.30), and thus

$$
\begin{equation*}
\frac{R_{G}}{3} \ll \frac{\gamma}{g_{m}} \tag{7.33}
\end{equation*}
$$

The number of gate fingers is chosen large enough to guarantee this condition.
image_name:Figure 7.24
description:
[
name: M1, type: NMOS, ports: {S: GND, D: Vn^2out, G: g1}
name: I1, type: CurrentSource, ports: {Np: VDD, Nn: Vn^2out}
name: RG/3, type: Resistor, value: RG/3, ports: {N1: g1, N2: Vn^2RG}
name: Vn^2RG, type: VoltageSource, value: 4kTRg/3, ports: {Np: Vn^2RG, Nn: GND}
]
extrainfo:The circuit illustrates the gate resistance noise and its influence on the output voltage noise. It includes a resistor RG/3, an NMOS transistor M1, and a current source I1. The noise voltage due to RG is expressed as 4kT(RG/3).


### 7.2.2 Flicker Noise

The interface between the gate oxide and the silicon substrate in a MOSFET entails an interesting phenomenon. Since the silicon crystal reaches an end at this interface, many "dangling" bonds appear, giving rise to extra energy states (Fig. 7.25). As charge carriers move at the interface, some are randomly trapped and later released by such energy states, introducing "flicker" noise in the drain current. In addition to trapping, several other mechanisms are believed to generate flicker noise [4].
image_name:Figure 7.25 Dangling bonds at the oxide-silicon interface
description:The image, titled "Figure 7.25 Dangling bonds at the oxide-silicon interface," illustrates the interface between different layers in a MOSFET structure. At the top, there is a layer labeled 'Polysilicon,' which is depicted as a solid gray block. Below this is a dotted layer labeled 'SiO2,' representing the silicon dioxide gate oxide. Underneath the SiO2 layer, there is a schematic representation of a 'Silicon Crystal,' shown as a lattice structure with interconnected circles and lines.

Between the SiO2 layer and the Silicon Crystal, there are dashed lines indicating 'Dangling Bonds.' These are depicted as vertical dashed lines connecting the SiO2 layer to the lattice structure of the Silicon Crystal. The dangling bonds represent the incomplete bonds that occur at the interface where the silicon crystal ends.

The diagram highlights the interface where the silicon crystal structure meets the gate oxide, resulting in dangling bonds. These bonds introduce extra energy states that can trap and release charge carriers, contributing to flicker noise in the MOSFET's drain current. The image effectively illustrates the concept of dangling bonds and their role in noise generation within the device.

Figure 7.25 Dangling bonds at the oxide-silicon interface.

Unlike thermal noise, the average power of flicker noise cannot be predicted easily. Depending on the "cleanness" of the oxide-silicon interface, flicker noise may assume considerably different values and as such varies from one CMOS technology to another. The flicker noise is more easily modeled as a voltage source in series with the gate and, in the saturation region, roughly given by

$$
\begin{equation*}
\overline{V_{n}^{2}}=\frac{K}{C_{o x} W L} \cdot \frac{1}{f} \tag{7.34}
\end{equation*}
$$

where $K$ is a process-dependent constant on the order of $10^{-25} \mathrm{~V}^{2} \mathrm{~F}$. Note that our notation assumes a bandwidth of 1 Hz . Interestingly, as shown in Fig. 7.26, the noise spectral density is inversely proportional to the frequency. For example, the trap-and-release phenomenon associated with the dangling bonds occurs more often at low frequencies. For this reason, flicker noise is also called $1 / f$ noise. Note that (7.34) does not depend on the bias current or the temperature. This is only an approximation; in reality, the flicker noise equation is somewhat more complex [3].
image_name:Figure 7.26 Flicker noise spectrum
description:The graph depicted in Figure 7.26 is a logarithmic plot representing the flicker noise spectrum, often referred to as $1/f$ noise. The graph is a Bode plot, which is commonly used to depict the frequency response of a system.

**Axes Labels and Units:**
- The horizontal axis is labeled as 'log $f$,' where $f$ represents frequency. This indicates that the frequency is plotted on a logarithmic scale.
- The vertical axis is labeled as '10 log $\overline{V_n^2}$,' which suggests that it represents the power spectral density of the noise voltage, also plotted on a logarithmic scale.

**Overall Behavior and Trends:**
- The plot shows a downward-sloping line, indicating that the noise power spectral density decreases as the frequency increases. This is characteristic of $1/f$ noise, where the noise intensity is inversely proportional to the frequency.
- The graph starts at a higher value on the vertical axis and slopes downward to the right, emphasizing the inverse relationship.

**Key Features and Technical Details:**
- There are no specific markers, peaks, or valleys indicated, as the graph is a straight line on a log-log scale.
- The slope of the line is negative, which is typical for $1/f$ noise, reflecting the inverse relationship.
- The shaded area beneath the line may represent the integrated noise power over a specific frequency range, although this is not explicitly annotated.

**Annotations and Specific Data Points:**
- The graph does not provide specific numerical values or annotations for particular frequencies or noise power levels.
- The absence of specific data points or markers suggests a general representation of the $1/f$ noise behavior rather than specific measured data.

This graph effectively illustrates the concept of flicker noise, emphasizing its inverse dependence on frequency and highlighting the importance of considering noise characteristics in low-frequency applications.

Figure 7.26 Flicker noise spectrum.

The inverse dependence of (7.34) on $W L$ suggests that to reduce $1 / f$ noise, the device area must be increased. It is therefore not surprising to see devices having areas of several hundred square microns in low-noise applications. (More fundamentally, the noise power trades with the gate capacitance, $W L C_{o x}$.) Generally, PMOS devices exhibit less $1 / f$ noise than NMOS transistors because the former carry the holes in a "buried channel," i.e., at some distance from the oxide-silicon interface, and hence trap and release the carriers to a lesser extent.

#### Example 7.8

For an NMOS current source, calculate the total thermal and $1 / f$ noise in the drain current for a band from 1 kHz to 1 MHz .

#### Solution

The thermal noise current per unit bandwidth is given by $\overline{I_{n, t h}^{2}}=4 k T \gamma g_{m}$. Thus, the total thermal noise integrated across the band of interest is

$$
\begin{align*}
\overline{I_{n, t h, t o t}^{2}} & =4 k T \gamma g_{m}\left(10^{6}-10^{3}\right)  \tag{7.35}\\
& \approx 4 k T \gamma g_{m} \times 10^{6} \mathrm{~A}^{2} \tag{7.36}
\end{align*}
$$

For $1 / f$ noise, the drain noise current per unit bandwidth is obtained by multiplying the noise voltage at the gate by the device transconductance:

$$
\begin{equation*}
\overline{I_{n, 1 / f}^{2}}=\frac{K}{C_{o x} W L} \cdot \frac{1}{f} \cdot g_{m}^{2} \tag{7.37}
\end{equation*}
$$

The total $1 / f$ noise is then equal to

$$
\begin{align*}
\overline{I_{n, 1 / f, t o t}^{2}} & =\frac{K g_{m}^{2}}{C_{o x} W L} \int_{1 \mathrm{kHz}}^{1 \mathrm{MHz}} \frac{d f}{f}  \tag{7.38}\\
& =\frac{K g_{m}^{2}}{C_{o x} W L} \ln 10^{3}  \tag{7.39}\\
& =\frac{6.91 K g_{m}^{2}}{C_{o x} W L} \tag{7.40}
\end{align*}
$$

The above example raises an interesting question. What happens to $\overline{I_{n, 1 / f, t o t}^{2}}$ if the lower end of the band, $f_{L}$, is zero rather than 1 kHz ? Equation (7.39) then yields an infinite value for the total noise. To overcome the fear of infinite noise, we make two observations. First, extending $f_{L}$ to zero means that we are interested in arbitrarily slow noise components. A noise component at 0.01 Hz varies significantly in roughly 10 s (one-tenth of the period) and one at $10^{-6} \mathrm{~Hz}$ in roughly one day. Second, the infinite flicker noise power simply means that if we observe the circuit for a very long time, the very slow noise components can randomly assume a very large power level. At such slow rates, noise becomes indistinguishable from thermal drift or aging of devices.

The foregoing observations lead to the following conclusions. First, since the signals encountered in most applications do not contain very-low-frequency components, our observation window need not be very long. For example, voice signals display negligible energy below 20 Hz , and if a noise component varies at a lower rate, it does not corrupt the voice significantly. Second, the logarithmic dependence of the flicker noise power upon $f_{L}$ allows some margin for error in selecting $f_{L}$. For example, if the integral in Eq. (7.38) begins from 100 Hz rather than 1 kHz , the coefficient in (7.40) rises from 6.91 to 9.21.

In order to quantify the significance of $1 / f$ noise with respect to thermal noise for a given device, we plot both spectral densities on the same axes (Fig. 7.27). Called the $1 / f$ noise "corner frequency," the
image_name:Figure 7.27 Concept of flicker noise corner frequency
description:The graph in Figure 7.27 illustrates the concept of the flicker noise corner frequency. It is a log-log plot with the x-axis representing frequency (f) on a logarithmic scale, and the y-axis representing the logarithm of the power spectral density (10log(Vn^2)).

1. **Type of Graph and Function:**
- This is a log-log plot, commonly used to compare different types of noise spectral densities over a range of frequencies.

2. **Axes Labels and Units:**
- **X-axis:** Frequency (f), presented on a logarithmic scale, indicating a wide range of frequencies.
- **Y-axis:** 10log(Vn^2), representing the logarithmic scale of the noise power spectral density.

3. **Overall Behavior and Trends:**
- The graph shows two distinct regions: the left side dominated by 1/f noise and the right side by thermal noise.
- The 1/f noise decreases with increasing frequency, exhibiting a negative slope on the log-log scale.
- The thermal noise is constant over frequency, represented by a horizontal line on the log-log scale.

4. **Key Features and Technical Details:**
- The intersection point of the 1/f noise curve and the thermal noise line is marked as the corner frequency (fC).
- This corner frequency (fC) indicates the frequency beyond which thermal noise dominates over 1/f noise.
- The shaded area highlights the region where 1/f noise is significant compared to thermal noise.

5. **Annotations and Specific Data Points:**
- The graph includes annotations such as "1/f Corner" and "Thermal" to differentiate the two noise regions.
- The corner frequency (fC) is marked with a dashed line, indicating its critical role in noise analysis.

This graph is essential for understanding the frequency range over which different types of noise affect a system, particularly in electronic devices where flicker noise and thermal noise are significant factors.

Figure 7.27 Concept of flicker noise corner frequency.
intersection point serves as a measure of what part of the band is mostly corrupted by flicker noise. In the above example, the $1 / f$ noise corner, $f_{C}$, of the output current is determined as

$$
\begin{equation*}
4 k T \gamma g_{m}=\frac{K}{C_{o x} W L} \cdot \frac{1}{f_{C}} \cdot g_{m}^{2} \tag{7.41}
\end{equation*}
$$

that is,

$$
\begin{equation*}
f_{C}=\frac{K}{\gamma C_{o x} W L} g_{m} \frac{1}{4 k T} \tag{7.42}
\end{equation*}
$$

This result implies that $f_{C}$ generally depends on the device area and transconductance. Nonetheless, for a given $L$, the dependence is weak and the $1 / f$ noise corner is relatively constant, falling in the vicinity of 10 MHz to 50 MHz for nanometer transistors.

#### Example 7.9

For a $100-\mu \mathrm{m} / 0.5-\mu \mathrm{m}$ MOS device with $g_{m}=1 /(100 \Omega)$, the $1 / f$ noise corner frequency is measured to be 500 kHz . If $t_{o x}=90 \AA$, what is the flicker noise coefficient, $K$, in this technology?

#### Solution

For $t_{o x}=90 \AA$, we have $C_{o x}=3.84 \mathrm{fF} / \mu \mathrm{m}^{2}$. Using Eq. (7.42), we write

$$
\begin{equation*}
500 \mathrm{kHz}=\frac{K}{3.84 \times 100 \times 0.5 \times 10^{-15}} \cdot \frac{1}{100} \cdot \frac{3}{8 \times 1.38 \times 10^{-23} \times 300} \tag{7.43}
\end{equation*}
$$

That is, $K=1.06 \times 10^{-25} \mathrm{~V}^{2} \mathrm{~F}$.

It is important to bear in mind that typical transistor models include thermal and flicker noise but not the gate resistance noise. The latter must therefore be added to each transistor by the designer.

## 7.3 - Representation of Noise in Circuits

Output Noise Consider a general circuit with one input port and one output port (Fig. 7.28). How do we quantify the effect of noise here? The natural approach would be to set the input to zero and calculate the total noise at the output due to various sources of noise in the circuit. This is indeed how the noise is measured in the laboratory or in simulations. Our analysis procedure in Section 7.1.5 methodically leads to the output noise spectrum.
image_name:Figure 7.28 Noise sources in a circuit.
description:The circuit diagram represents a noise model with three noise sources: two voltage-controlled voltage sources and one current source. The input is labeled as Vin and the output as Vout. The noise sources contribute to the overall noise at the output.

#### Example 7.10

What is the total output noise voltage of the common-source stage shown in Fig. 7.29(a)? Assume that $\lambda=0$.
image_name:(a)
description:
[
name: M1, type: NMOS, ports: {S: GND, D: Vout, G: Vin}
name: RD, type: Resistor, value: RD, ports: {N1: VDD, N2: Vout}
name: VDD, type: VoltageSource, value: VDD, ports: {Np: VDD, Nn: GND}
]
extrainfo:The circuit is a common-source amplifier stage with an NMOS transistor M1. The output is taken across RD, and the input is applied to the gate of M1. The circuit operates with a supply voltage VDD, and the output node is labeled as Vout. The diagram also includes noise sources in a separate figure (b), but they are not part of the netlist for figure (a).
image_name:(b)
description:
[
name: M1, type: NMOS, ports: {S: GND, D: Vn^2out, G: ac(GND)}
name: RD, type: Resistor, value: RD, ports: {N1: VDD, N2: Vn^2out}
name: VDD, type: VoltageSource, value: VDD, ports: {Np: VDD, Nn: GND}
name: I2nRD, type: CurrentSource, value: I^2nRD, ports: {Np: VDD, Nn: Vn^2ou}
name: I^2n1, type: CurrentSource, value: I2n1, ports: {Np: Vn^2out, Nn: GND}
]
extrainfo:The circuit diagram includes noise sources modeled by two current sources (I2nRD and I2n1) contributing to the output noise voltage V2n,out. The NMOS transistor M1 is driven by the input Vin and connected to the output Vout through the resistor RD. The circuit is powered by a voltage source VDD.

Figure 7.29 (a) CS stage; (b) circuit including noise sources.

#### Solution

We must identify the sources of noise, find their transfer functions to the output, multiply their spectra by the squared magnitude of the transfer functions and add the results. We model the thermal and flicker noise of $M_{1}$ by two current sources: $\overline{I_{n, t h}^{2}}=4 k T \gamma g_{m}$ and $\overline{I_{n, 1 / f}^{2}}=K g_{m}^{2} /\left(C_{o x} W L f\right)$. We also represent the thermal noise of $R_{D}$ by a current source $\overline{I_{n, R D}^{2}}=4 k T / R_{D}$. Since these currents flow through $R_{D}$, the output noise voltage per unit bandwidth is equal to

$$
\begin{equation*}
\overline{V_{n, \text { out }}^{2}}=\left(4 k T \gamma g_{m}+\frac{K}{C_{o x} W L} \cdot \frac{1}{f} \cdot g_{m}^{2}+\frac{4 k T}{R_{D}}\right) R_{D}^{2} \tag{7.44}
\end{equation*}
$$

Note that the noise mechanisms are added as "power" quantities because they are uncorrelated. The value given by (7.44) represents the noise power in 1 Hz at a frequency $f$. The total output noise is obtained by integration.

Input-Referred Noise While intuitively appealing, the output-referred noise does not allow a fair comparison of the performance of different circuits because it depends on the gain. For example, as depicted in Fig. 7.30, if a common-source stage is followed by a noiseless amplifier having a voltage gain $A_{1}$, then the output noise is equal to the expression in (7.44) multiplied by $A_{1}^{2}$. Considering only the output noise, we may conclude that as $A_{1}$ increases, the circuit becomes noisier, an incorrect result because a larger $A_{1}$ also provides a proportionally higher signal level at the output. That is, the output signal-to-noise ratio does not depend on $A_{1}$.
image_name:Figure 7.30
description:
[
name: RD, type: Resistor, value: RD, ports: {N1: VDD, N2: d1}
name: M1, type: NMOS, ports: {S: GND, D: d1, G: Vin}
name: A1, type: OpAmp, value: A1, ports: {InP: d1, InN: GND, OutP: Vout, OutN: ''}
]
extrainfo:The circuit is a common-source amplifier stage followed by an op-amp for additional gain. The NMOS M1 is used for amplification with RD providing the load. The output is taken from the op-amp A1, which further amplifies the signal.

Figure 7.30 Addition of gain stage to a CS stage.

To overcome the above quandary, we usually specify the "input-referred noise" of circuits. Illustrated conceptually in Fig. 7.31, the idea is to represent the effect of all noise sources in the circuit by a single
image_name:(a)
description:The circuit represents a noisy circuit model with input-referred noise sources. The output noise is represented by Vn_out.
image_name:(b)
description:The diagram illustrates a noiseless circuit model with input-referred noise voltage represented by Vn,in^2 and output noise voltage represented by Vn,out^2.

Figure 7.31 Determination of input-referred noise voltage.
source, $\overline{V_{n, i n}^{2}}$, at the input such that the output noise in Fig. 7.31(b) equals that in Fig. 7.31(a). If the voltage gain is $A_{v}$, then we must have $\overline{V_{n, \text { out }}^{2}}=A_{v}^{2} \overline{V_{n, i n}^{2}}$, that is, the input-referred noise voltage in this simple case is given by the output noise voltage divided by the gain.

#### Example 7.11

For the circuit of Fig. 7.29, calculate the input-referred noise voltage.

#### Solution

We have

$$
\begin{align*}
\overline{V_{n, \text { in }}^{2}} & =\frac{\overline{V_{n, \text { out }}^{2}}}{A_{v}^{2}}  \tag{7.45}\\
& =\left(4 k T \gamma g_{m}+\frac{K}{C_{o x} W L} \cdot \frac{1}{f} \cdot g_{m}^{2}+\frac{4 k T}{R_{D}}\right) R_{D}^{2} \frac{1}{g_{m}^{2} R_{D}^{2}}  \tag{7.46}\\
& =4 k T \frac{\gamma}{g_{m}}+\frac{K}{C_{o x} W L} \cdot \frac{1}{f}+\frac{4 k T}{g_{m}^{2} R_{D}} \tag{7.47}
\end{align*}
$$

Note that the first term in (7.47) can be viewed as the thermal noise of a resistor equal to $\gamma /\left(g_{m}\right)$ placed in series with the gate. Similarly, the third term corresponds to the noise of a resistor equal to $\left(g_{m}^{2} R_{D}\right)^{-1}$. We sometimes say the "equivalent thermal noise resistance" of a circuit is equal to $R_{T}$, meaning that the total input-referred thermal noise of the circuit in unit bandwidth is equal to $4 k T R_{T}$.

Why does $\overline{V_{n, i n}^{2}}$ decrease as $R_{D}$ increases? This is because the noise voltage due to $R_{D}$ at the output is proportional to $\sqrt{R_{D}}$ while the voltage gain of the circuit is proportional to $R_{D}$.

At this point of our study, we make two observations. First, the input-referred noise and the input signal are both multiplied by the gain as they are processed by the circuit. Thus, the input-referred noise indicates how much the input signal is corrupted by the circuit's noise, i.e., how small an input the circuit can detect with acceptable SNR. For this reason, input-referred noise allows a fair comparison of different circuits. Second, the input-referred noise is a fictitious quantity in that it cannot be measured at the input of the circuit. The two circuits of Figs. 7.31(a) and (b) are mathematically equivalent but the physical circuit is still that in Fig. 7.31(a).

In the foregoing discussion, we have assumed that the input-referred noise can be modeled by a single voltage source in series with the input. This is generally an incomplete representation if the circuit has a finite input impedance and is driven by a finite source impedance. To understand why, let us first return to the CS stage of Fig. 7.29 and observe that the output thermal noise due to $M_{1}$ is equal to $\left(4 k T \gamma g_{m}\right) R_{D}^{2}$ regardless of the network driving the gate (i.e., regardless of the preceding stage). Upon dividing this noise by $\left(g_{m} R_{D}\right)^{2}$, we obtain an input-referred noise voltage of $4 k T \gamma / g_{m}$-also independent of the preceding stage.

Now, consider the common-source stage of Fig. 7.32(a), where the input capacitance is denoted by $C_{i n}$. The input-referred noise voltage due to $M_{1}$ is still given by $4 k T \gamma / g_{m}$. Suppose the preceding stage is modeled by a Thevenin equivalent having an output impedance of $R_{1}$ [Fig. 7.32(b)]. Simplifying the circuit for noise calculations as shown in Fig. 7.32(c), we seek the output noise due to $M_{1}$, hoping to obtain $4 k T \gamma g_{m} R_{D}^{2}$. Owing to the voltage division between $R_{1}$ and $1 /\left(C_{i n} s\right)$, the output noise emerges as

$$
\begin{align*}
\overline{V_{n, \text { out }}^{2}} & =\overline{V_{n, \text { in }}^{2}}\left|\frac{1}{R_{1} C_{\text {in }} j \omega+1}\right|^{2}\left(g_{m} R_{D}\right)^{2}  \tag{7.48}\\
& =\frac{4 k T \gamma g_{m} R_{D}^{2}}{R_{1}^{2} C_{i n}^{2} \omega^{2}+1} \tag{7.49}
\end{align*}
$$

This result is incorrect; after all, the output noise due to $M_{1}$ must not diminish as $R_{1}$ increases.
image_name:(a)
description:The circuit is a common-source (CS) amplifier stage with an NMOS transistor (M1) and includes a resistor (RD) connected to VDD and a capacitor (Cin) connected to the input noise voltage source (Vn,in). The output is taken across the drain of M1.
image_name:(b)
description:The circuit diagram (b) represents a common-source stage with input noise modeled by a series voltage source and parallel current source. The NMOS transistor M1 amplifies the input signal, with RD serving as the load resistor. VDD provides the supply voltage. The presence of Cin and R1 affects the input impedance and noise characteristics.
image_name:(c)
description:The circuit diagram (c) represents a common-source (CS) stage with an NMOS transistor M1, where the input-referred noise is modeled by both a series voltage source and a parallel current source at the input. The input signal is applied through a resistor R1, and the input capacitance Cin is connected to ground. The drain of M1 is connected to the output node Vout through the resistor RD, and the source is connected to ground. The circuit is powered by VDD.

Figure 7.32 CS stage including input capacitance; (b) CS stage stimulated by a finite source impedance; (c) effect of single noise source.

Let us summarize the problem. If the circuit has a finite input impedance, modeling the input-referred noise by merely a voltage source implies that the output noise vanishes as the source impedance becomes large, an incorrect conclusion. To resolve this issue, we model the input-referred noise by both a series voltage source and a parallel current source (Fig. 7.33) so that if the output impedance of the preceding stage assumes large values-thereby reducing the effect of $\overline{V_{n, i n}^{2}}$-the noise current source still flows through a finite impedance, producing noise at the input. It can be proved that $\overline{V_{n, i n}^{2}}$ and $\overline{I_{n, i n}^{2}}$ are necessary and sufficient to represent the noise of any linear two-port circuit [5].
image_name:Figure 7.33 Representation of noise by voltage and current sources
description:
[
name: Vn^2,in, type: VoltageSource, value: Vn^2,in, ports: {Np: X1, Nn: X2}
name: In^2,in, type: CurrentSource, value: In^2,in, ports: {Np: X2, Nn: X3}
]
extrainfo:The circuit diagram represents noise in a linear two-port circuit using a series voltage source (Vn^2,in) and a parallel current source (In^2,in) connected to a noiseless circuit.

Figure 7.33 Representation of noise by voltage and current sources.

How do we calculate $\overline{V_{n, i n}^{2}}$ and $\overline{I_{n, i n}^{2}}$ ? Since the model is valid for any source impedance, we consider two extreme cases: zero and infinite source impedances. As shown in Fig. 7.34(a), if the source impedance is zero, $\overline{I_{n, i n}^{2}}$ flows through $\overline{V_{n, i n}^{2}}$ and has no effect on the output. Thus, the output noise measured in this case arises solely from $\overline{V_{n, i n}^{2}}$. Similarly, if the input is open [Fig. 7.34(b)], then $\overline{V_{n, i n}^{2}}$ has no effect and the output noise is due to only $\overline{I_{n, i n}^{2}}$. Let us apply this method to the circuit of Fig. 7.32.
image_name:(a)
description:The system block diagram labeled (a) illustrates the calculation of input-referred noise voltage and current for a given circuit setup. It consists of two main sections: a 'Noisy Circuit' and a 'Noiseless Circuit'.

1. **Main Components:**
- **Noisy Circuit:** This block represents a circuit that generates output noise, denoted as $\overline{V_{n1,out}^{2}}$.
- **Noiseless Circuit:** This block is intended to represent an ideal circuit with no noise contribution, used to analyze the effect of input-referred noise.
- **Voltage Source ($\overline{V_{n,in}^{2}}$):** Represents the input-referred noise voltage.
- **Current Source ($\overline{I_{n,in}^{2}}$):** Represents the input-referred noise current.

2. **Flow of Information or Control:**
- The output noise from the Noisy Circuit ($\overline{V_{n1,out}^{2}}$) is considered equivalent to the input-referred noise voltage ($\overline{V_{n,in}^{2}}$) and current ($\overline{I_{n,in}^{2}}$) flowing through the Noiseless Circuit.
- The voltage source $\overline{V_{n,in}^{2}}$ is connected in series, and the current source $\overline{I_{n,in}^{2}}$ is connected in parallel with the Noiseless Circuit.

3. **Labels, Annotations, and Key Indicators:**
- **$X_1$ and $X_2$:** These points indicate the connection nodes where the input-referred noise voltage and current are applied to the Noiseless Circuit.
- The diagram uses arrows to indicate the direction of noise influence from the Noisy Circuit to the Noiseless Circuit.

4. **Overall System Function:**
- The primary function of this setup is to model how input-referred noise from a noisy circuit can be represented and analyzed in terms of equivalent noise sources (voltage and current) applied to a noiseless circuit. This helps in understanding the impact of noise on circuit performance and is essential for noise analysis in electronic circuits.
image_name:(b)
description:The diagram labeled as (b) illustrates a method for calculating the input-referred noise current in a circuit. The system is divided into three main components:

1. **Noisy Circuit**: This block generates noise, which is represented as an output noise voltage \( \overline{V_{n2,\text{out}}^2} \). The noise from this circuit is considered in the analysis to determine its effect on the following stages.

2. **Noise Representation**: This section includes a noise voltage source \( \overline{V_{n,\text{in}}^2} \) and a noise current source \( \overline{I_{n,\text{in}}^2} \). These sources are used to model the noise characteristics of the circuit. The noise voltage source is depicted as a circle with a plus and minus sign, indicating its potential difference, while the noise current source is shown as a current arrow, indicating the flow of noise current.
- **X1** and **X2**: These points are the connection nodes for the noise voltage and current sources, indicating where these noise elements interface with the noiseless circuit.
- **X3**: This is another connection point, likely representing a ground or reference node for the current source.

3. **Noiseless Circuit**: This block is presumed to be free of intrinsic noise, serving as a reference to measure the effect of the input-referred noise current. The output of this block is labeled as \( \overline{V_{n2,\text{out}}^2} \), representing the noise at the output due to the input-referred noise current.

**Flow of Information**:
- The noise from the noisy circuit is represented by the noise voltage and current sources. The noise voltage \( \overline{V_{n,\text{in}}^2} \) is applied across nodes X1 and X2, while the noise current \( \overline{I_{n,\text{in}}^2} \) flows through node X3 into the noiseless circuit.
- The noiseless circuit processes these noise inputs, resulting in the output noise \( \overline{V_{n2,\text{out}}^2} \).

**Overall System Function**:
The primary function of this system is to model and measure the input-referred noise current from the noisy circuit, isolating it from other noise sources. By using a noiseless circuit as a reference, it allows for a clear understanding of how the input-referred noise affects the overall circuit performance.

Figure 7.34 Calculation of input-referred noise (a) voltage and (b) current.

#### Example 7.12

Calculate the input-referred noise voltage and current of Fig. 7.32, including only the thermal noise of $M_{1}$ and $R_{D}$.

#### Solution

From (7.47), the input-referred noise voltage is simply

$$
\begin{equation*}
\overline{V_{n, i n}^{2}}=4 k T \frac{\gamma}{g_{m}}+\frac{4 k T}{g_{m}^{2} R_{D}} \tag{7.50}
\end{equation*}
$$

As depicted in Fig. 7.35(a), this voltage generates the same output noise as the actual circuit if the input is shorted.
image_name:Fig. 7.35(a)
description:The circuit in Fig. 7.35(a) shows the input-referred noise voltage analysis with the input shorted. The NMOS transistor M1 is connected with the source to ground, the drain to the node Vn1out, and the gate to Vn1in. The resistor RD is connected between VDD and Vn1out. The capacitor Cin is connected between Vn1in and ground.
image_name:Fig. 7.35(b)
description:The circuit diagram Fig. 7.35(b) shows an NMOS transistor M1 with its source connected to ground, drain connected to Vn2,out, and gate connected to Vin. It includes a resistor RD connected to VDD and the drain of M1, a capacitor Cin connected between Vin and ground, and a current source In2,in connected between Vin and ground. The analysis focuses on calculating the input-referred noise current.

Figure 7.35
To obtain the input-referred noise current, we open the input and find the output noise in terms of $\overline{I_{n, i n}^{2}}$ [Fig.7.35(b)]. The noise current flows through $C_{i n}$, generating at the output

$$
\begin{equation*}
\overline{V_{n 2, \text { out }}^{2}}=\overline{I_{n, \text { in }}^{2}}\left(\frac{1}{C_{\text {in }} \omega}\right)^{2} g_{m}^{2} R_{D}^{2} \tag{7.51}
\end{equation*}
$$

According to Fig. 7.34(b), this value must be equal to the output of the noisy circuit when its input is open:

$$
\begin{equation*}
\overline{V_{n 2, \text { out }}^{2}}=\left(4 k T \gamma g_{m}+\frac{4 k T}{R_{D}}\right) R_{D}^{2} \tag{7.52}
\end{equation*}
$$

From (7.51) and (7.52), it follows that

$$
\begin{equation*}
\overline{I_{n, i n}^{2}}=\left(C_{i n} \omega\right)^{2} \frac{4 k T}{g_{m}^{2}}\left(\gamma g_{m}+\frac{1}{R_{D}}\right) \tag{7.53}
\end{equation*}
$$

As mentioned earlier, the input noise current, $I_{n, i n}$, becomes significant if the circuit's input impedance, $Z_{i n}$, is not very high. To see whether $I_{n, i n}$ can be neglected or not, we consider the scenario depicted in Fig. 7.36, where $Z_{S}$ denotes the output impedance of the preceding circuit. The total noise voltage sensed by the second stage at node $X$ is equal to

$$
\begin{equation*}
V_{n, X}=\frac{Z_{\text {in }}}{Z_{\text {in }}+Z_{S}} V_{n, i n}+\frac{Z_{\text {in }} Z_{S}}{Z_{\text {in }}+Z_{S}} I_{n, i n} \tag{7.54}
\end{equation*}
$$

image_name:Figure 7.36
description:The circuit illustrates the effect of input noise current on the total noise voltage sensed by the second stage at node X. It includes a voltage source representing input noise voltage, a current source for input noise current, and resistors representing source and input impedances.

Figure 7.36 Effect of input noise current.

If $\overline{I_{n, i n}^{2}}\left|Z_{S}\right|^{2} \ll \overline{V_{n, i n}^{2}}$, then the effect of $I_{n, i n}$ is negligible. In other words, ultimately, it is the output impedance of the preceding stage-rather than $Z_{i n}$-that determines the significance of $I_{n, i n}$. We conclude that the input-referred noise current can be neglected if

A difficulty in the use of input-referred noise voltages and currents is that they may be correlated. After all, $V_{n, i n}$ and $I_{n, i n}$ may contain effects from the same noise source. For example, in Fig. 7.35, if the noise voltage of $R_{D}$ is increasing at some point in time, then both $V_{n, i n}$ and $I_{n, i n}$ also inherit this increase. For this reason, noise calculations must revert to Eq. (7.11) and include the correlation between the two. Methods of avoiding this correlation are described in Appendix A.

The reader may wonder if the use of both a voltage source and a current source to represent the input-referred noise "counts the noise twice." We consider the environment depicted in Fig. 7.37 as an example and prove that the output noise is correct for any source impedance, $Z_{S}$. Assuming $Z_{S}$ is noiseless for simplicity, we first calculate the total noise voltage at the gate of $M_{1}$ due to $\overline{V_{n, i n}^{2}}$ and $\overline{I_{n, i n}^{2}}$. This voltage cannot be obtained by superposition of powers because $\overline{V_{n, i n}^{2}}$ and $\overline{I_{n, i n}^{2}}$ are correlated. Nonetheless, superposition still applies to voltages and currents because the circuit is linear and timeinvariant. Equations (7.50) and (7.53) must be respectively rewritten as

$$
\begin{align*}
V_{n, i n} & =V_{n, M 1}+\frac{1}{g_{m} R_{D}} V_{n, R D}  \tag{7.56}\\
I_{n, i n} & =C_{i n} s V_{n, M 1}+\frac{C_{i n} s}{g_{m} R_{D}} V_{n, R D} \tag{7.57}
\end{align*}
$$

image_name:Figure 7.37 CS stage driven by a source impedance
description:The circuit is a common-source (CS) stage driven by a source impedance (Zs) with an NMOS transistor (M1) and a load resistor (RD). The input voltage noise is represented by Vn,in and the output voltage noise by Vn,out. The capacitor Cin is connected to the gate of M1 and ground.

where $V_{n, M 1}$ denotes the gate-referred noise voltage of $M_{1}$ and $V_{n, R D}$ the noise voltage of $R_{D}$. We recognize that $V_{n, M 1}$ and $V_{n, R D}$ appear in both $V_{n, i n}$ and $I_{n, i n}$, creating a strong correlation between the two. Thus, the calculations must use superposition of voltages-as if $V_{n, i n}$ and $I_{n, i n}$ were deterministic quantities.

Adding the contributions of $V_{n, i n}$ and $I_{n, i n}$ at node $X$ in Fig. 7.37, we have

$$
\begin{align*}
V_{n, X} & =V_{n, i n} \frac{\frac{1}{C_{i n} s}}{\frac{1}{C_{i n} s}+Z_{S}}+I_{n, i n} \frac{\frac{Z_{S}}{C_{i n} s}}{\frac{1}{C_{i n} s}+Z_{S}}  \tag{7.58}\\
& =\frac{V_{n, i n}+I_{n, i n} Z_{S}}{Z_{S} C_{i n} s+1} \tag{7.59}
\end{align*}
$$

Substituting for $V_{n, i n}$ and $I_{n, i n}$ from (7.56) and (7.57), respectively, we obtain

$$
\begin{align*}
V_{n, X} & =\frac{1}{Z_{S} C_{i n} s+1}\left[V_{n, M 1}+\frac{1}{g_{m} R_{D}} V_{n, R D}+C_{i n} s Z_{S}\left(V_{n, M 1}+\frac{1}{g_{m} R_{D}} V_{n, R D}\right)\right] \\
& =V_{n, M 1}+\frac{1}{g_{m} R_{D}} V_{n, R D} \tag{7.60}
\end{align*}
$$

Note that $V_{n, X}$ is independent of $Z_{S}$ and $C_{i n}$. It follows that

$$
\begin{align*}
\overline{V_{n, \text { out }}^{2}} & =g_{m}^{2} R_{D}^{2} \overline{V_{n, X}^{2}}  \tag{7.61}\\
& =4 k T\left(\gamma g_{m}+\frac{1}{R_{D}}\right) R_{D}^{2} \tag{7.62}
\end{align*}
$$

the same as (7.52). Thus, $V_{n, i n}$ and $I_{n, i n}$ do not "double count" the noise.
Another Approach In some cases, it is simpler to consider the output short-circuit noise currentrather than the output open-circuit noise voltage-for these calculations. This current is then multiplied by the circuit's output resistance to yield the output noise voltage or simply divided by a proper gain to give the input-referred quantities. The following example illustrates this approach.


## 7.4 ■ Noise in Single-Stage Amplifiers

Having developed basic mathematical tools and models for noise analysis, we now study the noise performance of single-stage amplifiers at low frequencies. Before considering specific topologies, we describe a lemma that simplifies noise calculations.
Lemma The circuits shown in Fig. 7.39(a) and (b) are equivalent at low frequencies if $\overline{V_{n}^{2}}=\overline{I_{n}^{2}} / g_{m}^{2}$ and the circuits are driven by a finite impedance.
image_name:(a)
description:
[
name: Vin, type: VoltageSource, value: Vin, ports: {Np: Vin, Nn: GND}
name: ZL, type: Resistor, value: ZL, ports: {N1: VDD, N2: d1}
name: ZS, type: Resistor, value: ZS, ports: {N1: s1, N2: GND}
name: M1, type: NMOS, ports: {S: s1, D: d1, G: Vin}
name: I2n, type: CurrentSource, value: I2n, ports: {Np: d1, Nn: s1}
]
extrainfo:The circuit is a common-source amplifier with an NMOS transistor (M1), loaded with a resistor ZL and driven by a voltage source Vin. A current source I2n models the noise current. The source resistor ZS is connected to ground. The circuit is biased by VDD.
image_name:(b)
description:
[
name: M1, type: NMOS, ports: {S: s1, D: d1, G: gI}
name: ZL, type: Resistor, value: ZL, ports: {N1: d1, N2: VDD}
name: ZS, type: Resistor, value: ZS, ports: {N1: s1, N2: GND}
name: I2n, type: CurrentSource, value: I2n, ports: {Np: s1, Nn: GND}
name: V2n, type: VoltageSource, value: V2n, ports: {Np: gI, Nn: GND}
name: VDD, type: VoltageSource, value: VDD, ports: {Np: VDD, Nn: GND}
name: gI, type: VoltageControlledVoltageSource, value: gI, ports: {Np: gI, Nn: GND}
]
extrainfo:The circuit diagram (b) is a single-stage amplifier with an NMOS transistor M1. The amplifier is powered by a voltage source VDD and includes a load resistor ZL and a source resistor ZS. It also has a voltage-controlled voltage source gI connected to the gate of M1. The circuit is designed to analyze noise performance at low frequencies.
image_name:(c)
description:
[
name: M1, type: NMOS, ports: {S: s1, D: d1, G: GND}
name: ZL, type: Resistor, value: ZL, ports: {N1: d1, N2: VDD}
name: ZS, type: Resistor, value: ZS, ports: {N1: s1, N2: GND}
name: I2n, type: CurrentSource, value: I2n, ports: {Np: d1, Nn: s1}
]
extrainfo:The circuit is a single-stage amplifier with NMOS M1. It includes resistors ZL and ZS, and a current source I2n. The NMOS gate is grounded, and the source is connected to the ground through ZS. The drain is connected to the supply voltage VDD through ZL. The current source I2n injects current from the drain to the source.
image_name:(d)
description:
[
name: M1, type: NMOS, ports: {S: s1, D: d1, G: s1}
name: ZL, type: Resistor, value: ZL, ports: {N1: d1, N2: VDD}
name: ZS, type: Resistor, value: ZS, ports: {N1: s1, N2: GND}
name: I2n, type: CurrentSource, value: I2n, ports: {Np: d1, Nn: s1}
name: gI, type: VoltageControlledVoltageSource, value: gI, ports: {N1: s1, N2: GND}
]
extrainfo:The circuit in diagram (d) is a noise equivalent model with an NMOS transistor M1, a load resistor ZL connected to VDD, and a source resistor ZS connected to ground. A current source I2n models noise, and a voltage-controlled voltage source gI is used for noise analysis.

Figure 7.39 Equivalent CS stages.

Proof Since the circuits have equal output impedances, we simply examine the output short-circuit currents [Figs. 7.39(c) and (d)]. It can be proved (Problem 7.4) that the output noise current of the circuit in Fig. 7.39(c) is given by

$$
\begin{equation*}
I_{n, \text { out } 1}=\frac{I_{n}}{Z_{S}\left(g_{m}+g_{m b}+1 / r_{O}\right)+1} \tag{7.73}
\end{equation*}
$$

and that of Fig. 7.39(d) is

$$
\begin{equation*}
I_{n, \text { out } 2}=\frac{g_{m} V_{n}}{Z_{S}\left(g_{m}+g_{m b}+1 / r_{o}\right)+1} \tag{7.74}
\end{equation*}
$$

Equating (7.73) and (7.74), we have $V_{n}=I_{n} / g_{m}$. We call $V_{n}$ the "gate-referred" noise of $M_{1}$.
This lemma suggests that the noise source can be transformed from a drain-source current to a gate series voltage for arbitrary $Z_{S}$. We repeat this analysis in the presence of the gate-source capacitance in Problem 7.29.

#### Example 7.14

Prove the above lemma using Thevenin equivalents.

#### Solution

We construct a Thevenin model for the circuits in Figs. 7.39(a) and (b) but exclude $Z_{L}$, as depicted in Figs. 7.40(a) and (b). With $I_{n}=0$ and $V_{n}=0$, the two topologies are identical, and hence $Z_{T h e v 1}=Z_{\text {Thev2 }}$. We thus need only find the condition under which $V_{\text {Thev1 }}=V_{T h e v 2}$.

To obtain the Thevenin voltages, we must replace $Z_{L}$ with an open circuit [Fig.7.40(c)]. ${ }^{10}$ Since the current flowing through $Z_{S}$ is zero in both circuits, we have $V_{T h e v 1}=I_{n} r_{O}$ and $V_{T h e v}=g_{m} V_{n} r_{O}$. It follows that $V_{n}=I_{n} / g_{m}$.

### 7.4.1 Common-Source Stage

From Example 7.11, the input-referred noise voltage per unit bandwidth of a simple CS stage is equal to

$$
\begin{equation*}
\overline{V_{n, i n}^{2}}=4 k T\left(\frac{\gamma}{g_{m}}+\frac{1}{g_{m}^{2} R_{D}}\right)+\frac{K}{C_{o x} W L} \frac{1}{f} \tag{7.75}
\end{equation*}
$$

[^40]image_name:(a)
description:
[
name: M1, type: NMOS, ports: {S: GND, D: d1, G: Vin}
name: ZL, type: Resistor, value: ZL, ports: {N1: d1, N2: Vout}
name: ZS, type: Resistor, value: ZS, ports: {N1: GND, N2: s1}
name: SI, type: CurrentSource, value: SI, ports: {Np: s1, Nn: GND}
name: VThev1, type: VoltageSource, value: VThev1, ports: {Np: d1, Nn: GND}
name: ZThev1, type: Resistor, value: ZThev1, ports: {N1: d1, N2: Vout}
]
extrainfo:The circuit diagram (a) represents a common-source stage with Thevenin equivalent circuits shown in (b) and (c). The NMOS transistor M1 is driven by a current source SI with resistors ZL and ZS forming part of the load. Voltage sources VThev1 and VThev2 represent Thevenin equivalent voltages in different configurations.
image_name:(b)
description:
[
name: M1, type: NMOS, ports: {S: GND, D: Vout, G: Vin}
name: ZL, type: Resistor, value: ZL, ports: {N1: Vout, N2: GND}
name: ZS, type: Resistor, value: ZS, ports: {N1: Vin, N2: GND}
name: SI, type: CurrentSource, value: SI, ports: {Np: Vin, Nn: GND}
name: VThev2, type: VoltageSource, value: VThev2, ports: {Np: Vout, Nn: GND}
name: ZThev2, type: Resistor, value: ZThev2, ports: {N1: Vout, N2: GND}
]
extrainfo:The circuit diagram (b) represents a simplified model of a common-source amplifier stage with a Thevenin equivalent circuit. The NMOS transistor M1 is driven by a voltage source VThev2 with a series resistance ZThev2. The output is taken across the load resistor ZL.
image_name:(c)
description:
[
name: M1, type: NMOS, ports: {S: s1, D: d1, G: Vin}
name: ZS, type: Resistor, value: ZS, ports: {N1: d1, N2: GND}
name: SI, type: CurrentSource, value: SI, ports: {Np: s1, Nn: GND}
]
extrainfo:The circuit diagram (c) illustrates a simplified common-source stage with an NMOS transistor M1, a current source SI, and a resistor ZS. The input voltage is applied to the gate of M1, and the output is taken from the drain, which is connected to ZS. The source of M1 is connected to ground.

Figure 7.40
image_name:(a)
description:
[
name: Vin, type: VoltageSource, value: Vin, ports: {Np: Vin, Nn: GND}
name: M1, type: NMOS, ports: {S: GND, D: Vout, G: Vin}
]
extrainfo:The circuit diagram (a) illustrates a simplified common-source stage with an NMOS transistor M1. The input voltage is applied to the gate of M1, and the output is taken from the drain. The source of M1 is connected to ground. This configuration is used for voltage amplification.
image_name:(b)
description:
[
name: M1, type: NMOS, ports: {S: GND, D: LOAD, G: Vb}
]
extrainfo:The circuit diagram (b) illustrates a simplified NMOS stage with a bias voltage Vb applied to the gate of M1. The output current Io is taken from the drain, which is connected to a load. The source of M1 is connected to ground.

Figure 7.41 Voltage amplification versus current generation.

From the above lemma, we recognize that the term $4 k T \gamma / g_{m}$ is in fact the thermal noise current of $M_{1}$ expressed as a voltage in series with the gate.

How can we reduce the input-referred noise voltage? Equation (7.75) implies that the transconductance of $M_{1}$ must be maximized. Thus, the transconductance must be maximized if the transistor is to amplify a voltage signal applied to its gate [Fig. 7.41(a)] whereas it must be minimized if the transistor operates as a constant current source [Fig. 7.41(b)], as illustrated by the following example.

#### Example 7.15

Calculate the input-referred thermal noise voltage of the amplifier shown in Fig. 7.42(a), assuming both transistors are in saturation. Also, determine the total output thermal noise if the circuit drives a load capacitance $C_{L}$. What is the output signal-to-noise ratio if a low-frequency sinusoid of peak amplitude $V_{m}$ is applied to the input?

#### Solution

Representing the thermal noise of $M_{1}$ and $M_{2}$ by current sources [Fig. 7.42(b)] and noting that they are uncorrelated, we write

$$
\begin{equation*}
\overline{V_{n, \text { out }}^{2}}=4 k T\left(\gamma g_{m 1}+\gamma g_{m 2}\right)\left(r_{O 1} \| r_{O 2}\right)^{2} \tag{7.76}
\end{equation*}
$$

image_name:(a)
description:
[
name: M1, type: NMOS, ports: {S: GND, D: Vout, G: Vin}
name: M2, type: PMOS, ports: {S: VDD, D: Vout, G: Vb}
]
extrainfo:The circuit is a simple amplifier with an NMOS and PMOS transistor forming a CMOS inverter. The input is applied to the gate of the NMOS (M1) and the output is taken from the common drain connection (Vout). The PMOS (M2) is connected to VDD and the NMOS (M1) to ground, with the gates driven by Vb and Vin respectively. The circuit likely amplifies the input signal Vin to produce an output at Vout.
image_name:(b)
description:
[
name: M1, type: NMOS, ports: {S: GND, D: Vnout, G: Vin}
name: M2, type: PMOS, ports: {S: VDD, D: Vnout, G: Vb}
name: r0, type: Resistor, value: r0, ports: {N1: Vnout, N2: GND}
]
extrainfo:The diagram represents a noise model with thermal noise sources for M1 and M2. The output noise voltage is indicated as Vn,out.

Figure 7.42
(In reality, $\gamma$ may not be the same for NMOS and PMOS devices.) Since the voltage gain is equal to $g_{m 1}\left(r_{O 1} \| r_{O 2}\right)$, the total noise voltage referred to the gate of $M_{1}$ is

$$
\begin{align*}
\overline{V_{n, i n}^{2}} & =4 k T\left(\gamma g_{m 1}+\gamma g_{m 2}\right) \frac{1}{g_{m 1}^{2}}  \tag{7.77}\\
& =4 k T \gamma\left(\frac{1}{g_{m 1}}+\frac{g_{m 2}}{g_{m 1}^{2}}\right) \tag{7.78}
\end{align*}
$$

Equation (7.78) reveals the dependence of $\overline{V_{n, i n}^{2}}$ upon $g_{m 1}$ and $g_{m 2}$, confirming that $g_{m 2}$ must be minimized because $M_{2}$ serves as a current source rather than a transconductor. ${ }^{11}$

The reader may wonder why $M_{1}$ and $M_{2}$ in Fig. 7.42 exhibit different noise effects. After all, if the noise currents of both transistors flow through $r_{O 1} \| r_{O 2}$, why should $g_{m 1}$ be maximized and $g_{m 2}$ minimized? This is simply because, as $g_{m 1}$ increases, the output noise voltage rises in proportion to $\sqrt{g_{m 1}}$ whereas the voltage gain of the stage increases in proportion to $g_{m 1}$. As a result, the input-referred noise voltage decreases. Such a trend does not apply to $M_{2}$.

To compute the total output noise, we integrate (7.76) across the band:

$$
\begin{equation*}
\overline{V_{n, \text { out }, \text { tot }}^{2}}=\int_{0}^{\infty} 4 k T \gamma\left(g_{m 1}+g_{m 2}\right)\left(r_{O 1} \| r_{O 2}\right)^{2} \frac{d f}{1+\left(r_{O 1} \| r_{O 2}\right)^{2} C_{L}^{2}(2 \pi f)^{2}} \tag{7.79}
\end{equation*}
$$

Using the results of Example 7.3, we have

$$
\begin{equation*}
\overline{V_{n, \text { out }, \text { tot }}^{2}}=\gamma\left(g_{m 1}+g_{m 2}\right)\left(r_{O 1} \| r_{O 2}\right) \frac{k T}{C_{L}} \tag{7.80}
\end{equation*}
$$

A low-frequency input sinusoid of amplitude $V_{m}$ yields an output amplitude equal to $g_{m 1}\left(r_{O 1} \| r_{O 2}\right) V_{m}$. The output SNR is equal to the ratio of the signal power and the noise power:

$$
\begin{align*}
\mathrm{SNR}_{o u t} & =\left[\frac{g_{m 1}\left(r_{O 1} \| r_{O 2}\right) V_{m}}{\sqrt{2}}\right]^{2} \cdot \frac{1}{\gamma\left(g_{m 1}+g_{m 2}\right)\left(r_{O 1} \| r_{O 2}\right)\left(k T / C_{L}\right)}  \tag{7.81}\\
& =\frac{C_{L}}{2 \gamma k T} \cdot \frac{g_{m 1}^{2}\left(r_{O 1} \| r_{O 2}\right)}{g_{m 1}+g_{m 2}} V_{m}^{2} \tag{7.82}
\end{align*}
$$

We note that to maximize the output SNR, $C_{L}$ must be maximized, i.e., the bandwidth must be minimized. Of course, the bandwidth is also dictated by the input signal spectrum. This example indicates that it becomes exceedingly difficult to design broadband circuits while maintaining low noise.

[^41]
#### Example 7.16

Determine the input-referred thermal noise voltage of the complementary common-source stage shown in Fig. 7.43.
image_name:Figure 7.43
description:
[
name: Vin, type: VoltageSource, value: Vin, ports: {Np: Vin, Nn: GND}
name: M1, type: NMOS, ports: {S: GND, D: Vout, G: Vin}
name: M2, type: PMOS, ports: {S: VDD, D: Vout, G: Vin}
]
extrainfo:The circuit is a complementary common-source stage with one NMOS (M1) and one PMOS (M2) transistor. The input is applied at Vin, and the output is taken from Vout. M1 is connected to ground, and M2 is connected to VDD.

Figure 7.43

#### Solution

With the input signal set to zero, this circuit produces the same output noise voltage as the circuit in Fig. 7.42(a) does. But the complementary stage provides a higher voltage gain, $\left(g_{m 1}+g_{m 2}\right)\left(r_{O 1} \| r_{O 2}\right)$. The input-referred noise voltage is thus given by

$$
\begin{equation*}
\overline{V_{n, i n}^{2}}=\frac{4 k T \gamma}{g_{m 1}+g_{m 2}} \tag{7.83}
\end{equation*}
$$

an expected result because $M_{1}$ and $M_{2}$ operate in "parallel," and hence their transconductances add. Why does this topology exhibit a lower input noise than the circuit of Fig. 7.42(a)? In both cases, $M_{2}$ injects noise to the output node, but in the complementary stage, this device operates as a transconductor and amplifies the input.

For a simple CS stage with resistive load, Eq. (7.75) suggests that the thermal noise can be reduced by increasing the bias current. But, for a given headroom, this requires that we decrease $R_{D}$ and hence increase its noise contribution. In order to quantify this trade-off, we express $g_{m}$ as $2 I_{D} /\left(V_{G S}-V_{T H}\right)$ and write the input-referred thermal noise as

$$
\begin{equation*}
\overline{V_{n, i n}^{2}}=4 k T\left[\frac{\gamma\left(V_{G S}-V_{T H}\right)}{2 I_{D}}+\frac{\left(V_{G S}-V_{T H}\right)^{2}}{4 I_{D} \cdot I_{D} R_{D}}\right] \tag{7.84}
\end{equation*}
$$

This equation suggests that $V_{n, i n}$ falls if $I_{D}$ is increased and $I_{D} R_{D}$ kept constant provided that $V_{G S}-V_{T H}$ also remains constant, i.e., if the transistor width increases in proportion to $I_{D}$.

#### Example 7.17

Calculate the input-referred $1 / f$ and thermal noise voltage of the CS stage depicted in Fig. 7.44(a), assuming $M_{1}$ and $M_{2}$ are in saturation.
image_name:Fig. 7.44(a)
description:
[
name: M1, type: NMOS, ports: {S: GND, D: Vout, G: Vin}
name: M2, type: PMOS, ports: {S: VDD, D: Vout, G: Vb}
name: RD, type: Resistor, value: RD, ports: {N1: VDD, N2: Vout}
]
extrainfo:The circuit is a common-source amplifier with an NMOS (M1) and a PMOS (M2) transistor. M1 is driven by an input voltage Vin, and M2 is biased by a voltage Vb. The output is taken at Vout, with a load resistor RD connected to VDD.

(a)
image_name:Figure 7.44(b)
description:
[
name: M1, type: NMOS, ports: {S: GND, D: d1d2, G: Vn1}
name: M2, type: PMOS, ports: {S: VDD, D: d1d2, G: Vn2}
name: RD, type: Resistor, value: RD, ports: {N1: VDD, N2: d1d2}
name: In,R1, type: CurrentSource, value: In,R1, ports: {Np: d1d2, Nn: GND}
]
extrainfo:The circuit is a noise model of a common-source amplifier. It includes noise voltage sources at the gates of M1 and M2, and a noise current source parallel to RD. The output noise voltage is measured at Vn,out.

(b)

Figure 7.44

#### Solution

We model the $1 / f$ and thermal noise of the transistors as voltage sources in series with their gates [Fig. 7.44(b)]. The noise voltage at the gate of $M_{2}$ experiences a gain of $g_{m 2}\left(R_{D}\left\|r_{O 1}\right\| r_{O 2}\right)$ as it appears at the output. The result must then be divided by $g_{m 1}\left(R_{D}\left\|r_{O 1}\right\| r_{O 2}\right)$ to be referred to the main input. The noise current of $R_{D}$ is multiplied by $R_{D}\left\|r_{O 1}\right\| r_{O 2}$ and divided by $g_{m 1}\left(R_{D}\left\|r_{O 1}\right\| r_{O 2}\right)$. Thus, the overall input-referred noise voltage is given by

$$
\begin{equation*}
\overline{V_{n, i n}^{2}}=4 k T \gamma\left(\frac{g_{m 2}}{g_{m 1}^{2}}+\frac{1}{g_{m 1}}\right)+\frac{1}{C_{o x}}\left[\frac{K_{P} g_{m 2}^{2}}{(W L)_{2} g_{m 1}^{2}}+\frac{K_{N}}{(W L)_{1}}\right] \frac{1}{f}+\frac{4 k T}{g_{m 1}^{2} R_{D}} \tag{7.85}
\end{equation*}
$$

where $K_{P}$ and $K_{N}$ denote the flicker noise coefficients of PMOS and NMOS devices, respectively. Note that the circuit reduces to that in Fig. 7.42(a) or 7.29 (a) if $R_{D}=\infty$ or $g_{m 2}=0$, respectively. How should the bias current of $M_{2}$ be chosen to minimize $V_{n, i n}$ if the dc voltage drop across $R_{D}$ is fixed? This is left as an exercise for the reader.

How do we design a common-source stage for low-noise operation? For thermal noise in the simple topology of Fig. 7.41, we must maximize $g_{m 1}$ by increasing the drain current or the device width. A higher $I_{D}$ translates to greater power dissipation and limited output voltage swings while a wider device leads to larger input and output capacitance. We can also increase $R_{D}$, but at the cost of limiting the voltage headroom and lowering the speed.

For $1 / f$ noise, the primary approach is to increase the area of the transistor. If $W L$ is increased while $W / L$ remains constant, then the device transconductance, and hence its thermal noise, do not change, but the device capacitances increase. These observations point to the trade-offs between noise, power dissipation, voltage headroom, and speed.

#### Example 7.18

A student writes the drain flicker noise current of a MOS device as $\left[K /\left(W L C_{o x} f\right)\right] g_{m}^{2}=\left[K /\left(W L C_{o x} f\right)\right]$ $\left(\sqrt{2 \mu_{n} C_{o x}(W / L) I_{D}}\right)^{2}=2 K \mu_{n} I_{D} /\left(L^{2} f\right)$, concluding that the flicker noise current is independent of $W$. Explain the flaw in this argument.

#### Solution

A fair comparison must keep both the overdrive and $I_{D}$ constant as $W$ changes. (If we allow $V_{G S}-V_{T H}$ to change, then the drain voltage headroom also changes.). Thus, we can express the drain flicker noise current as $\left[K /\left(W L C_{o x} f\right)\right]\left(4 I_{D}^{2}\right) /\left(V_{G S}-V_{T H}\right)^{2}$, which reveals that the noise current decreases as $W L$ increases.

#### Example 7.19

Design a resistively-loaded common-source stage with a total input-referred noise voltage of $100 \mu \mathrm{~V}_{\mathrm{rms}}$, a power budget of 1 mW , a bandwidth of 1 GHz , and a supply voltage of 1 V . Neglect channel-length modulation and flicker noise and assume that the bandwidth is limited by the load capacitance.

#### Solution

Illustrated in Fig. 7.45(a), the circuit produces noise at the output in a bandwidth given by $R_{D}$ and $C_{L}$. From the noise model shown in Fig. 7.45(b), the reader can derive a Thevenin equivalent for the circuit in the dashed box, obtaining the output noise spectrum as

$$
\begin{align*}
\overline{V_{n, \text { out }}^{2}} & =\left(\overline{V_{n, R D}^{2}}+R_{D}^{2} \overline{I_{n, M 1}^{2}}\right) \frac{1}{R_{D}^{2} C_{L}^{2} \omega^{2}+1}  \tag{7.86}\\
& =\left(4 k T R_{D}+4 k T \gamma g_{m} R_{D}^{2}\right) \frac{1}{R_{D}^{2} C_{L}^{2} \omega^{2}+1} \tag{7.87}
\end{align*}
$$

image_name:(a)
description:
[
name: Vin, type: VoltageSource, value: Vin, ports: {Np: Vin, Nn: GND}
name: M1, type: NMOS, ports: {S: GND, D: Vout, G: Vin}
name: RD, type: Resistor, value: RD, ports: {N1: VDD, N2: Vout}
name: CL, type: Capacitor, value: CL, ports: {Np: Vout, Nn: GND}
name: VDD, type: VoltageSource, value: VDD, ports: {Np: VDD, Nn: GND}
]
extrainfo:The circuit is a basic common-source amplifier with an NMOS transistor, a load resistor RD, and a load capacitor CL. The input is applied at the gate of the NMOS, and the output is taken at the drain.
image_name:(b)
description:
[
name: M1, type: NMOS, ports: {S: GND, D: Vout, G: Vin}
name: RD, type: Resistor, value: RD, ports: {N1: VDD, N2: X1}
name: CL, type: Capacitor, value: CL, ports: {Np: X2, Nn: GND}
name: VDD, type: VoltageSource, value: VDD, ports: {Np: VDD, Nn: GND}
name: Vn,RD, type: VoltageSource, value: Vn,RD, ports: {Np: X1, Nn: GND}
name: In,M1, type: CurrentSource, value: In,M1, ports: {Np: X2, Nn: GND}
]
extrainfo:The circuit in diagram (b) is a noise model showing the Thevenin equivalent circuit. It includes a noise voltage source Vn,RD and a noise current source In,M1 connected to a resistor RD and capacitor CL, representing the output noise spectrum.

Figure 7.45

Since we know that the integral of $4 k T R_{D} /\left(R_{D}^{2} C_{L}^{2} \omega^{2}+1\right)$ from 0 to $\infty$ yields a value of $k T / C_{L}$, we manipulate the transistor noise contribution as follows:

$$
\begin{equation*}
\overline{V_{n, \text { out }}^{2}}=\frac{4 k T R_{D}}{R_{D}^{2} C_{L}^{2} \omega^{2}+1}+\gamma g_{m} R_{D} \frac{4 k T R_{D}}{R_{D}^{2} C_{L}^{2} \omega^{2}+1} \tag{7.88}
\end{equation*}
$$

Integration from 0 to $\infty$ thus gives

$$
\begin{align*}
\overline{V_{n, \text { out }, t o t}^{2}} & =\frac{k T}{C_{L}}+\gamma g_{m} R_{D} \frac{k T}{C_{L}}  \tag{7.89}\\
& =\left(1+\gamma g_{m} R_{D}\right) \frac{k T}{C_{L}} \tag{7.90}
\end{align*}
$$

This noise must be divided by $g_{m}^{2} R_{D}^{2}$ and equated to $\left(100 \mu \mathrm{~V}_{\mathrm{rms}}\right)^{2}$. We also note that $1 /\left(2 \pi R_{D} C_{L}\right)=1 \mathrm{GHz}$ and $k T=4.14 \times 10^{-21} \mathrm{~J}$ at the room temperature, arriving at

$$
\begin{equation*}
\frac{1+\gamma g_{m} R_{D}}{g_{m}^{2} R_{D}} \cdot \frac{2 \pi k T}{2 \pi R_{D} C_{L}}=\left(100 \mu \mathrm{~V}_{\mathrm{rms}}\right)^{2} \tag{7.91}
\end{equation*}
$$

and hence

$$
\begin{equation*}
\frac{1}{g_{m}}\left(\frac{1}{g_{m} R_{D}}+\gamma\right)=384 \Omega \tag{7.92}
\end{equation*}
$$

We have some flexibility in the choice of $g_{m}$ and $R_{D}$ here. For example, if $g_{m} R_{D}=3$ and $\gamma=1$, then $1 / g_{m}=288 \Omega$ and $R_{D}=864 \Omega$. With a drain-current budget of $1 \mathrm{~mW} / V_{D D}=1 \mathrm{~mA}$, we can choose $W / L$ so as to obtain this amount of transconductance.

The above choice of the voltage gain and the resulting values of $R_{D}$ and $g_{m}$ must be checked against the bias conditions. Since $R_{D} I_{D}=864 \mathrm{mV}, V_{D S, \min }=136 \mathrm{mV}$, leaving little headroom for voltage swings. The reader is encouraged to try $g_{m} R_{D}=2$ or 4 to see how the voltage headroom depends on the choice of the gain.

### 7.4.2 Common-Gate Stage

Thermal Noise Consider the common-gate configuration shown in Fig. 7.46(a). Neglecting channellength modulation, we represent the thermal noise of $M_{1}$ and $R_{D}$ by two current sources [Fig. 7.46(b)]. Note that, owing to the low input impedance of the circuit, the input-referred noise current is not negligible even at low frequencies. To calculate the input-referred noise voltage, we short the input to ground and equate the output noises of the circuits in Figs. 7.47(a) and (b):

$$
\begin{equation*}
\left(4 k T \gamma g_{m}+\frac{4 k T}{R_{D}}\right) R_{D}^{2}=\overline{V_{n, i n}^{2}}\left(g_{m}+g_{m b}\right)^{2} R_{D}^{2} \tag{7.93}
\end{equation*}
$$

image_name:Figure 7.46 (a)
description:
[
name: M1, type: NMOS, ports: {S: Vin, D: Vout, G: Vb}
name: RD, type: Resistor, value: RD, ports: {N1: VDD, N2: Vout}
name: VDD, type: VoltageSource, value: VDD, ports: {Np: VDD, Nn: GND}
]
extrainfo:The circuit is a common-gate (CG) amplifier stage with an NMOS transistor (M1) and a load resistor (RD). The input is applied to the source of M1, and the output is taken from the drain. The gate is biased with Vb. The circuit is powered by VDD.
image_name:Figure 7.46 (b)
description:
[
name: M1, type: NMOS, ports: {S: s1, D: Vout, G: Vb}
name: RD, type: Resistor, value: RD, ports: {N1: VDD, N2: Vout}
name: VDD, type: VoltageSource, value: VDD, ports: {Np: VDD, Nn: GND}
]
extrainfo:The circuit in Figure 7.46(b) is a common-gate (CG) stage with noise sources. It includes an NMOS transistor (M1) with a bias voltage (Vb) on the gate, a resistor (RD) connected to the drain, and a voltage source (VDD) supplying power. Noise currents are represented by current sources in parallel with RD and M1.

Figure 7.46 (a) CG stage; (b) circuit including noise sources.
image_name:(a)
description:
[
name: M1, type: NMOS, ports: {S: s1, D: Vout, G: Vb}
name: RD, type: Resistor, value: RD, ports: {N1: VDD, N2: Vout}
name: VDD, type: VoltageSource, value: VDD, ports: {Np: VDD, Nn: GND}
name: I2nRD, type: CurrentSource, value: I2nRD, ports: {Np: VDD, Nn: Vout}
name: I2n1, type: CurrentSource, value: I2n1, ports: {Np: GND, Nn: s1}
name: Vb, type: VoltageSource, value: Vb, ports: {Np: Vb, Nn: GND}
name: V2n,in, type: VoltageSource, value: V2n,in, ports: {Np: s1, Nn: GND}
]
extrainfo:The circuit in Figure 7.46(a) is a common-gate (CG) stage with noise sources, using an NMOS transistor (M1) with a bias voltage (Vb) on the gate, a resistor (RD) connected to the drain, and a voltage source (VDD) supplying power. Noise currents are represented by current sources in parallel with RD and M1.
image_name:(b)
description:
[
name: I2nRD, type: CurrentSource, ports: {Np: VDD, Nn: s1d1}
name: I2n1, type: CurrentSource, ports: {Np: s1d1, Nn: GND}
name: RD, type: Resistor, value: RD, ports: {N1: VDD, N2: Vout}
name: M1, type: NMOS, ports: {S: GND, D: s1d1, G: Vb}
name: VDD, type: VoltageSource, value: VDD, ports: {Np: VDD, Nn: GND}
]
extrainfo:The circuit in Figure 7.46(b) is a common-gate (CG) stage with noise sources. It includes an NMOS transistor (M1) with a bias voltage (Vb) on the gate, a resistor (RD) connected to the drain, and a voltage source (VDD) supplying power. Noise currents are represented by current sources in parallel with RD and M1.
image_name:(c)
description:
[
name: RD, type: Resistor, ports: {N1: VDD, N2: Vn2n1out}
name: M1, type: NMOS, ports: {S: GND, D: Vn2n1out, G: Vb}
name: I2nRD, type: CurrentSource, ports: {Np: VDD, Nn: Vn2n1out}
name: I2n1, type: CurrentSource, ports: {Np: Vn2n1out, Nn: GND}
name: VDD, type: VoltageSource, ports: {Np: VDD, Nn: GND}
]
extrainfo:The circuit is a common-gate (CG) stage with noise sources. It includes an NMOS transistor (M1) with a bias voltage (Vb) on the gate, a resistor (RD) connected to the drain, and a voltage source (VDD) supplying power. Noise currents are represented by current sources in parallel with RD and M1.
image_name:(d)
description:
[
name: M1, type: NMOS, ports: {S: s1, D: Vout, G: Vb}
name: RD, type: Resistor, value: RD, ports: {N1: Vout, N2: VDD}
name: I2n1, type: CurrentSource, value: I2n1, ports: {Np: Vin, Nn: s1}
name: V2n,in, type: VoltageSource, value: V2n,in, ports: {Np: Vin, Nn: GND}
name: VDD, type: VoltageSource, value: VDD, ports: {Np: VDD, Nn: GND}
]
extrainfo:The circuit is a common-gate (CG) stage with an NMOS transistor M1. It includes a bias voltage Vb on the gate, a resistor RD connected to the drain, and a voltage source VDD supplying power. The input-referred noise is represented by a voltage source V2n,in.

Figure 7.47 Calculation of input-referred noise of a CG stage.

That is

$$
\begin{equation*}
\overline{V_{n, i n}^{2}}=\frac{4 k T\left(\gamma g_{m}+1 / R_{D}\right)}{\left(g_{m}+g_{m b}\right)^{2}} \tag{7.94}
\end{equation*}
$$

Similarly, equating the output noises of the circuits in Figs. 7.47(c) and (d) yields the input-referred noise current. What is the effect of $\overline{I_{n 1}^{2}}$ at the output in Fig. 7.47(c)? Since the sum of the currents at the source of $M_{1}$ is zero, $I_{n 1}+I_{D 1}=0$. Consequently, $I_{n 1}$ creates an equal and opposite current in $M_{1}$, producing no noise at the output. The output noise voltage of Fig. 7.46(a) is therefore equal to $4 k T R_{D}$, and hence $\overline{I_{n, i n}^{2}} R_{D}^{2}=4 k T R_{D}$. That is

$$
\begin{equation*}
\overline{I_{n, i n}^{2}}=\frac{4 k T}{R_{D}} \tag{7.95}
\end{equation*}
$$

An important drawback of the common-gate topology is that it directly refers the noise current produced by the load to the input. Exemplified by (7.95), this effect arises because such a circuit provides no current gain, a point of contrast to common-source amplifiers.

We have thus far neglected the noise contributed by the bias-current source of a common-gate stage. Shown in Fig. 7.48 is a simple mirror arrangement establishing the bias current of $M_{1}$ as a multiple of $I_{1}$. Capacitor $C_{0}$ shunts the noise generated by $M_{0}$ to ground. We note that if the input of the circuit is shorted to ground, then the drain noise current of $M_{2}$ does not flow through $R_{D}$, contributing no input-referred noise voltage. On the other hand, if the input is open, all of $\overline{I_{n 2}^{2}}$ flows from $M_{1}$ and $R_{D}$ (at low frequencies), producing an output noise equal to $\overline{I_{n 2}^{2}} R_{D}^{2}$ and hence an input-referred noise current of $\overline{I_{n 2}^{2}}$. As a result, the noise current of $M_{2}$ directly adds to the input-referred noise current, making it desirable to minimize
image_name:Figure 7.49
description:
[
name: M1, type: NMOS, ports: {S: GND, D: Vout, G: Vb}
name: M2, type: NMOS, ports: {S: GND, D: Vin, G: Vin}
name: M0, type: NMOS, ports: {S: GND, D: Vb, G: Vb}
name: RD, type: Resistor, value: RD, ports: {N1: VDD, N2: Vout}
name: C0, type: Capacitor, value: C0, ports: {Np: Vb, Nn: GND}
name: I1, type: CurrentSource, value: I1, ports: {Np: VDD, Nn: Vb}
]
extrainfo:The circuit is designed to analyze input-referred thermal noise. M1 and M2 are NMOS transistors forming the main amplification path, while M0 acts as a biasing transistor. RD is the load resistor. C0 is used for stability or filtering. I1 is a bias current source. The circuit operates with VDD as the power supply.

Figure 7.48 Noise contributed by bias-current source.
the transconductance of $M_{2}$. For a given bias current, however, this translates to a higher drain-source voltage for $M_{2}$ because $g_{m 2}=2 I_{D 2} /\left(V_{G S 2}-V_{T H 2}\right)$, requiring a high value for $V_{b}$ and limiting the voltage swing at the output node.

#### Example 7.20

Calculate the input-referred thermal noise voltage and current of the circuit shown in Fig. 7.49 assuming that all of the transistors are in saturation.
image_name:Figure 7.49
description:
[
name: M1, type: NMOS, ports: {S: Vin, D: Vb, G: Vin}
name: M2, type: NMOS, ports: {S: Vin, D: g0g2d0, G: Vin}
name: M0, type: NMOS, ports: {S: g0g2d0, D: GND, G: g0g2d0}
name: M3, type: PMOS, ports: {S: VDD, D: Vout, G: Vb}
name: M4, type: PMOS, ports: {S: VDD, D: X1, G: X1}
name: I1, type: CurrentSource, ports: {Np: VDD, Nn: Vout}
name: I2, type: CurrentSource, ports: {Np: X1, Nn: GND}
name: I_n2, type: CurrentSource, ports: {Np: Vin, Nn: GND}
]
extrainfo:The circuit is a differential amplifier with PMOS and NMOS transistors, featuring current sources for biasing and differential inputs and outputs.

Figure 7.49

#### Solution

To compute the input-referred noise voltage, we short the input to ground, obtaining

$$
\begin{equation*}
\overline{V_{n 1, \text { out }}^{2}}=4 k T \gamma\left(g_{m 1}+g_{m 3}\right)\left(r_{O 1} \| r_{O 3}\right)^{2} \tag{7.96}
\end{equation*}
$$

Thus, the input-referred noise voltage, $V_{n, i n}$, must satisfy this relationship:

$$
\begin{equation*}
\overline{V_{n, i n}^{2}}\left(g_{m 1}+g_{m b 1}\right)^{2}\left(r_{O 1} \| r_{O 3}\right)^{2}=4 k T \gamma\left(g_{m 1}+g_{m 3}\right)\left(r_{O 1} \| r_{O 3}\right)^{2} \tag{7.97}
\end{equation*}
$$

where the voltage gain from $V_{\text {in }}$ to $V_{\text {out }}$ is approximated by $\left(g_{m 1}+g_{m b 1}\right)\left(r_{O 1} \| r_{O 3}\right)$. It follows that

$$
\begin{equation*}
\overline{V_{n, i n}^{2}}=4 k T \gamma \frac{\left(g_{m 1}+g_{m 3}\right)}{\left(g_{m 1}+g_{m b 1}\right)^{2}} \tag{7.98}
\end{equation*}
$$

As expected, the noise is proportional to $g_{m 3}$.
To calculate the input-referred noise current, we open the input and note that the output noise voltage due to $M_{3}$ is simply given by $I_{n 3}^{2} R_{o u t}^{2}$, where $R_{o u t}=r_{O 3} \|\left[r_{O 2}+\left(g_{m 1}+g_{m b 1}\right) r_{O 1} r_{O 2}+r_{O 1}\right]$ denotes the output impedance
when the input is open. The reader can prove that, in response to an input current $I_{i n}$, the circuit generates an output voltage given by

$$
\begin{equation*}
V_{\text {out }}=\frac{\left(g_{m 1}+g_{m b 1}\right) r_{O 1}+1}{r_{O 1}+\left(g_{m 1}+g_{m b 1}\right) r_{O 1} r_{O 2}+r_{O 2}+r_{O 3}} r_{O 3} r_{O 2} I_{i n} \tag{7.99}
\end{equation*}
$$

Dividing $I_{n 3} R_{\text {out }}$ by this gain to refer the noise of $M_{3}$ to the input, we have

$$
\begin{equation*}
\left.I_{n, i n}\right|_{M 3}=\frac{r_{O 2}+\left(g_{m 1}+g_{m b 1}\right) r_{O 1} r_{O 2}+r_{O 1}}{r_{O 2}\left[\left(g_{m 1}+g_{m b 1}\right) r_{O 1}+1\right]} I_{n 3} \tag{7.100}
\end{equation*}
$$

which reduces to

$$
\begin{align*}
\left.I_{n, i n}\right|_{M 3} & \approx I_{n 3}  \tag{7.101}\\
& \approx 4 k T \gamma g_{m 3} \tag{7.102}
\end{align*}
$$

if any $g_{m} r_{O}$ product is much greater than unity. Since the noise current of $M_{2}$ directly adds to the input, we have

$$
\begin{equation*}
\overline{I_{n, i n}^{2}}=4 k T \gamma\left(g_{m 2}+g_{m 3}\right) \tag{7.103}
\end{equation*}
$$

Again, the noise is proportional to the transconductance of the two current sources. In the above calculations, we have neglected the effect of $I_{n 1}$ when the input is left open even though the source of $M_{1}$ sees a finite degeneration (ro2). In Problem 7.31, we refer this noise to the input and prove that it is still negligible.

Flicker Noise The effect of $1 / f$ noise in a common-gate topology is also of interest. As a typical case, we compute the input-referred $1 / f$ noise voltage and current of the circuit shown in Fig. 7.49. Illustrated in Fig. 7.50, each $1 / f$ noise generator is modeled by a voltage source in series with the gate of the corresponding transistor. Note that the $1 / f$ noise of $M_{0}$ and $M_{4}$ is neglected. A more realistic case is studied in Problem 7.10.
image_name:Figure 7.50 Flicker noise in a CG stage
description:
[
name: M1, type: NMOS, ports: {S: GND, D: Vin, G: V2n1}
name: M2, type: NMOS, ports: {S: GND, D: Vin, G: V2n2}
name: M3, type: PMOS, ports: {S: VDD, D: Vin, G: V2n3}
name: V2n3, type: VoltageSource, value: V2n3, ports: {Np: V2n3, Nn: GND}
name: V2n1, type: VoltageSource, value: V2n1, ports: {Np: V2n1, Nn: GND}
name: V2n2, type: VoltageSource, value: V2n2, ports: {Np: V2n2, Nn: GND}
]
extrainfo:The circuit is a common-gate topology focusing on flicker noise analysis. It includes NMOS and PMOS transistors with voltage sources modeling flicker noise.

Figure 7.50 Flicker noise in a CG stage.

With the input shorted to ground, we have

$$
\begin{equation*}
\overline{V_{n 1, \text { out }}^{2}}=\frac{1}{C_{o x} f}\left[\frac{g_{m 1}^{2} K_{N}}{(W L)_{1}}+\frac{g_{m 3}^{2} K_{P}}{(W L)_{3}}\right]\left(r_{O 1} \| r_{O 3}\right)^{2} \tag{7.104}
\end{equation*}
$$

where $K_{N}$ and $K_{P}$ denote the flicker noise coefficients of NMOS and PMOS devices, respectively. Approximating the voltage gain as $\left(g_{m 1}+g_{m b 1}\right)\left(r_{O 1} \| r_{O 3}\right)$, we obtain

$$
\begin{equation*}
\overline{V_{n, i n}^{2}}=\frac{1}{C_{o x} f}\left[\frac{g_{m 1}^{2} K_{N}}{(W L)_{1}}+\frac{g_{m 3}^{2} K_{P}}{(W L)_{3}}\right] \frac{1}{\left(g_{m 1}+g_{m b 1}\right)^{2}} \tag{7.105}
\end{equation*}
$$

With the input open, the output noise voltage is approximately given by

$$
\begin{equation*}
\overline{V_{n 2, \text { out }}^{2}}=\frac{1}{C_{o x} f}\left[\frac{g_{m 2}^{2} K_{N}}{(W L)_{2}}+\frac{g_{m 3}^{2} K_{P}}{(W L)_{3}}\right] R_{\text {out }}^{2} \tag{7.106}
\end{equation*}
$$

where it is assumed that the transconductance from the gate of $M_{2}$ to the output is equal to $g_{m 2}$. It follows that

$$
\begin{equation*}
\overline{I_{n, i n}^{2}}=\frac{1}{C_{o x} f}\left[\frac{g_{m 2}^{2} K_{N}}{(W L)_{2}}+\frac{g_{m 3}^{2} K_{P}}{(W L)_{3}}\right] \tag{7.107}
\end{equation*}
$$

Equations (7.105) and (7.107) describe the $1 / f$ noise behavior of the circuit and must be added to (7.98) and (7.103), respectively, to obtain the overall noise per unit bandwidth.

### 7.4.3 Source Followers

Consider the source follower depicted in Fig. 7.51(a), where $M_{2}$ serves as the bias-current source. Since the input impedance of the circuit is quite high, even at relatively high frequencies, the input-referred noise current can usually be neglected for moderate driving source impedances. To compute the inputreferred thermal noise voltage, we employ the representation in Fig. 7.51(b), expressing the output noise due to $M_{2}$ as

$$
\begin{equation*}
\left.\overline{V_{n, \text { out }}^{2}}\right|_{M 2}=\overline{I_{n 2}^{2}}\left(\frac{1}{g_{m 1}}\left\|\frac{1}{g_{m b 1}}\right\| r_{O 1} \| r_{O 2}\right)^{2} \tag{7.108}
\end{equation*}
$$

image_name:Figure 7.51 (a)
description:
[
name: M1, type: NMOS, ports: {S: Vout, D: VDD, G: Vin}
name: M2, type: NMOS, ports: {S: GND, D: Vout, G: Vb}
name: Vn1, type: VoltageSource, value: Vn1, ports: {Np: GND, Nn: Vn_out}
name: In2, type: CurrentSource, value: In2, ports: {Np: Vn_out, Nn: GND}
]
extrainfo:The circuit is a source follower with M1 and M2 as NMOS transistors. M1 is connected to the input voltage Vin, and M2 is controlled by the bias voltage Vb. The output is taken at Vout. The diagram also includes noise sources Vn1 and In2, representing voltage and current noise, respectively.
image_name:Figure 7.51 (b)
description:
[
name: M1, type: NMOS, ports: {S: Vout, D: VDD, G: Vin}
name: M2, type: NMOS, ports: {S: GND, D: Vout, G: Vb}
name: Vn1, type: VoltageSource, value: Vn1, ports: {Np: GND, Nn: Vin}
name: In2, type: CurrentSource, value: In2, ports: {Np: Vn,out, Nn: GND}
]
extrainfo:The circuit represents a source follower with noise sources included. M1 is connected between VDD and Vout, while M2 is connected between Vout and ground. The voltage source Vn1 and current source In2 represent noise components in the circuit.

Figure 7.51 (a) Source follower; (b) circuit including noise sources.
From Chapter 3,

$$
\begin{equation*}
A_{v}=\frac{\frac{1}{g_{m b 1}}\left\|r_{O 1}\right\| r_{O 2}}{\frac{1}{g_{m b 1}}\left\|r_{O 1}\right\| r_{O 2}+\frac{1}{g_{m 1}}} \tag{7.109}
\end{equation*}
$$

Thus, the total input-referred noise voltage is

$$
\begin{align*}
\overline{V_{n, \text { in }}^{2}} & =\overline{V_{n 1}^{2}}+\frac{\left.\overline{V_{n, \text { out }}^{2}}\right|_{M 2}}{A_{v}^{2}}  \tag{7.110}\\
& =4 k T \gamma\left(\frac{1}{g_{m 1}}+\frac{g_{m 2}}{g_{m 1}^{2}}\right) \tag{7.111}
\end{align*}
$$

Note the similarity between (7.78) and (7.111).

Since source followers add noise to the input signal while providing a voltage gain of less than unity, they are usually avoided in low-noise amplification. The $1 / f$ noise performance of source followers is studied in Problem 7.11.

### 7.4.4 Cascode Stage

Consider the cascode stage of Fig. 7.52(a). Since at low frequencies the noise currents of $M_{1}$ and $R_{D}$ mostly flow through $R_{D}$, the noise contributed by these two devices is quantified as in a common-source stage:

$$
\begin{equation*}
\left.\overline{V_{n, i n}^{2}}\right|_{M 1, R D}=4 k T\left(\frac{\gamma}{g_{m 1}}+\frac{1}{g_{m 1}^{2} R_{D}}\right) \tag{7.112}
\end{equation*}
$$

image_name:(a)
description:
[
name: M1, type: NMOS, ports: {S: GND, D: X, G: Vin}
name: M2, type: NMOS, ports: {S: X, D: Vout, G: Vb}
name: RD, type: Resistor, value: RD, ports: {N1: VDD, N2: Vout}
name: VDD, type: VoltageSource, value: VDD, ports: {Np: VDD, Nn: GND}
]
extrainfo:The circuit is a cascode stage with two NMOS transistors M1 and M2. M1 is configured as a common-source stage, and M2 acts as a cascode transistor. The resistor RD is connected between VDD and the output node Vout.
image_name:(b)
description:
[
name: M1, type: NMOS, ports: {S: GND, D: X, G: Vin}
name: M2, type: NMOS, ports: {S: X, D: Vout, G: Vb}
name: RD, type: Resistor, value: RD, ports: {N1: VDD, N2: Vout}
]
extrainfo:The circuit diagram (b) models the noise of M2 as a current source. The noise current I_n2 flows from M2 to the output node Vout. M1 is connected to ground, and M2 is connected to the bias voltage Vb. The resistor RD connects VDD to Vout.
image_name:(c)
description:
[
name: M2, type: NMOS, ports: {S: X, D: Vout, G: Vb}
name: M1, type: NMOS, ports: {S: GND, D: X, G: Vin}
name: RD, type: Resistor, value: RD, ports: {N1: Vout, N2: VDD}
name: VDD, type: VoltageSource, value: VDD, ports: {Np: VDD, Nn: GND}
name: g2, type: VoltageControlledVoltageSource, value: g2, ports: {Np: Vn2, Nn: X}
]
extrainfo:The circuit diagram (c) represents a cascode stage with two NMOS transistors M1 and M2. M1 is connected to ground at the source, and its gate is connected to the input voltage Vin. M2 has its source connected to the drain of M1 (node X), its gate connected to a bias voltage Vb, and its drain connected to the output node Vout, which is also connected to the resistor RD leading to VDD. A voltage-controlled voltage source g2 models the noise of M2.

Figure 7.52 (a) Cascode stage; (b) noise of $M_{2}$ modeled by a current source; (c) noise of $M_{2}$ modeled by a voltage source.
where $1 / f$ noise of $M_{1}$ is ignored. What is the effect of noise of $M_{2}$ ? Modeled as in Fig. 7.52(b), this noise contributes negligibly to the output, especially at low frequencies. This is because, if channel-length modulation in $M_{1}$ is neglected, then $I_{n 2}+I_{D 2}=0$, and hence $M_{2}$ does not affect $V_{n, \text { out }}$. From another point of view, using the lemma of Fig. 7.39 to construct the equivalent in Fig. 7.52(c), we note that the voltage gain from $V_{n 2}$ to the output is quite small if the impedance at node $X$ is large. At high frequencies, on the other hand, the total capacitance at node $X, C_{X}$, gives rise to a gain:

$$
\begin{equation*}
\frac{V_{n, \text { out }}}{V_{n 2}} \approx \frac{-R_{D}}{1 / g_{m 2}+1 /\left(C_{X} s\right)} \tag{7.113}
\end{equation*}
$$

increasing the output noise. This capacitance also reduces the gain from the main input to the output by shunting the signal current produced by $M_{1}$ to ground. As a result, the input-referred noise of a cascode stage may rise considerably at high frequencies.

If $R_{D}$ in Fig. 7.52(c) is large, e.g., if it represents the output resistance of a PMOS cascode load, then the gain from $V_{n 2}$ to $V_{\text {out }}$ may not be small. The reader can show that, if $R_{D} \approx g_{m} r_{O}^{2}$ (for a cascode), then $V_{\text {out }} / V_{n}$ is still much greater, making the contribution of $V_{n}$ negligible.

## 7.5 ■ Noise in Current Mirrors

The noise produced by the devices in current mirrors may propagate to the output of interest. In Figs. 7.48 and 7.49 , for example, the diode-connected device may contribute substantial flicker noise unless an extremely large bypass capacitor is used. This effect is exacerbated by the bias-current multiplication factor in the current mirror.
image_name:(a)
description:
[
name: MREF, type: NMOS, ports: {S: GND, D: x1, G: x1}
name: M1, type: NMOS, ports: {S: GND, D: LOAD, G: x1}
name: CB, type: Capacitor, value: CB, ports: {Np: x1, Nn: GND}
name: IREF, type: CurrentSource, value: IREF, ports: {Np: VDD, Nn: x1}
name: ID1, type: Diode, ports: {Na: LOAD, Nc: GND}
name: V1, type: VoltageSource, value: V1, ports: {Np: x2, Nn: x3}
name: gm,REF, type: VoltageControlledCurrentSource, ports: {Np: x2, Nn: x1}
name: 1/gm,REF, type: Resistor, value: 1/gm,REF, ports: {N1: x1, N2: x}
]
extrainfo:The circuit in Figure 7.53(a) is a current mirror configuration designed to minimize flicker noise using a bypass capacitor CB. It includes two NMOS transistors (MREF and M1), where MREF is diode-connected. The current source IREF provides the reference current, and the capacitor CB is used to suppress noise. The diode ID1 and the load are connected at the drain of M1.
image_name:(b)
description:
[
name: MREF, type: NMOS, ports: {S: GND, D: x1, G: x1}
name: M1, type: NMOS, ports: {S: GND, D: x, G: x1}
name: CB, type: Capacitor, value: CB, ports: {Np: x, Nn: GND}
name: IREF, type: CurrentSource, value: IREF, ports: {Np: VDD, Nn: x1}
]
extrainfo:The circuit in (b) represents a small-signal model to study flicker noise in a current mirror. It includes a noise voltage source Vn,REF and a transconductance element gm,REF. The capacitor CB is used to suppress noise.
image_name:(c)
description:
[
name: M_REF, type: NMOS, ports: {S: GND, D: x1, G: x1}
name: M_1, type: NMOS, ports: {S: GND, D: x, G: x1}
name: C_B, type: Capacitor, value: C_B, ports: {Np: x, Nn: GND}
name: I_REF, type: CurrentSource, value: I_REF, ports: {Np: VDD, Nn: x1}
name: V_1, type: VoltageSource, value: V_1, ports: {Np: x2, Nn: x3}
]
extrainfo:The circuit is a current mirror with a capacitor C_B used to suppress flicker noise from the diode-connected device M_REF. The noise voltage V_n,REF is modeled in the circuit.

Figure 7.53 (a) Current mirror using a capacitor to suppress diode-connected device's noise, (b) small-signal model, and (c) overall equivalent circuit.

To appreciate the difficulty with current-mirror flicker noise, let us study the simple topology shown in Fig. 7.53(a), where $(W / L)_{1}=N(W / L)_{R E F}$. The multiplication factor, $N$, is in the range of 5 to 10 so as to minimize the power consumed by the reference branch. We wish to determine the flicker noise in $I_{D 1}$. We assume that $\lambda=0$ and $I_{R E F}$ is noiseless but caution the reader that, as described in Chapter 12, the noise of the reference (bandgap) current may not be negligible. We first construct a Thevenin equivalent for $M_{R E F}$ and its flicker noise, $V_{n, R E F}$ : as depicted in Fig. 7.53 (b), the open-circuit voltage is equal to $V_{n, R E F}$ because $V_{1}$ must be zero (why?). Noting that the Thevenin resistance is equal to $1 / g_{m, R E F}$, we arrive at the arrangement in Fig. 7.53(c), where the noise voltage at node $X$ and $V_{n 1}$ add (without correlation) and drive the gate of $M_{1}$, producing

$$
\begin{equation*}
\overline{I_{n, \text { out }}^{2}}=\left(\frac{g_{m, R E F}^{2}}{C_{B}^{2} \omega^{2}+g_{m, R E F}^{2}} \overline{V_{n, R E F}^{2}}+\overline{V_{n 1}^{2}}\right) g_{m 1}^{2} \tag{7.114}
\end{equation*}
$$

Since $(W / L)_{1}=N(W / L)_{R E F}$ and, typically, $L_{1}=L_{R E F}$, we observe that $\overline{V_{n, R E F}^{2}}=N \overline{V_{n 1}^{2}}$ because the flicker noise power spectral density is inversely proportional to the channel area, $W L$. It follows that

$$
\begin{equation*}
\overline{I_{n, \text { out }}^{2}}=\left(\frac{N g_{m, R E F}^{2}}{C_{B}^{2} \omega^{2}+g_{m, R E F}^{2}}+1\right) g_{m 1}^{2} \overline{V_{n 1}^{2}} \tag{7.115}
\end{equation*}
$$

For the noise of the diode-connected device to be negligible, we must ensure that the first term inside the parentheses is small:

$$
\begin{equation*}
(N-1) g_{m, R E F}^{2} \ll C_{B}^{2} \omega^{2} \tag{7.116}
\end{equation*}
$$

and hence

$$
\begin{equation*}
C_{B}^{2} \gg \frac{(N-1) g_{m, R E F}^{2}}{\omega^{2}} \tag{7.117}
\end{equation*}
$$

For example, if $N=5, g_{m, R E F} \approx 1 /(200 \Omega)$, and the minimum frequency of interest is 1 MHz , we have $C_{B}^{2} \gg 2.533 \times 10^{-18} \mathrm{~F}$. For a tenfold suppression of the $M_{R E F}$ noise, this translates to 5.03 nF !

In order to reduce the noise contributed by $M_{R E F}$ while avoiding such a large capacitor, we can insert a resistance between its gate and $C_{B}$ [Fig. 7.54(a)] and revise Eq. (7.114) as

$$
\begin{equation*}
\overline{I_{n, \text { out }}^{2}}=\left[\frac{g_{m, R E F}^{2}}{\left(1+g_{m, R E F} R_{B}\right)^{2} C_{B}^{2} \omega^{2}+g_{m, R E F}^{2}}\left(\overline{V_{n, R E F}^{2}}+\overline{V_{n, R B}^{2}}\right)+\overline{V_{n 1}^{2}}\right] g_{m 1}^{2} \tag{7.118}
\end{equation*}
$$

image_name:Figure 7.54 (a)
description:
[
name: IREF, type: CurrentSource, value: IREF, ports: {Np: VDD, Nn: X1}
name: MREF, type: NMOS, ports: {S: GND, D: X1, G: X1}
name: RB, type: Resistor, value: RB, ports: {N1: X1, N2: g1}
name: CB, type: Capacitor, value: CB, ports: {Np: g1, Nn: GND}
name: M1, type: NMOS, ports: {S: GND, D: LOAD, G: g1}
]
extrainfo:The circuit is a noise reduction setup using a resistor RB to filter noise from the diode-connected NMOS MREF. The resistor RB and capacitor CB form a low-pass filter to reduce the noise contribution of MREF. The output current ID1 flows through the load connected to the drain of NMOS M1.

(a)
image_name:(a)
description:
[
name: IREF, type: CurrentSource, value: IREF, ports: {Np: VDD, Nn: gc}
name: MC, type: PMOS, ports: {S: VDD, D: gc, G: X1}
name: MREF, type: PMOS, ports: {S: gc, D: X1, G: X1}
name: MR, type: NMOS, ports: {S: X1, D: g1, G: gc}
name: CB, type: Capacitor, value: CB, ports: {Np: g1, Nn: GND}
name: M1, type: NMOS, ports: {S: GND, D: LOAD, G: g1}
]
extrainfo:The circuit is a noise reduction setup using a resistor RB to filter noise from the diode-connected NMOS MREF. The resistor RB and capacitor CB form a low-pass filter to reduce the noise contribution of MREF. The output current ID1 flows through the load connected to the drain of NMOS M1.

(b)

Figure 7.54 (a) Use of a resistor to filter a diode-connected device's noise, and (b) realization of the resistor by a MOSFET.

The series resistance lowers the filter cutoff frequency to $\left[\left(1 / g_{m 1, R E F}+R_{B}\right) C_{B}\right]^{-1}$ but also contributes its own noise. We can thus increase $R_{B}$ before $\overline{V_{n, R B}^{2}}$ becomes an appreciable fraction of $\overline{V_{n, R E F}^{2}}$.

In practice, $R_{B}$ can be quite large before its thermal noise becomes comparable with the flicker noise of $M_{R E F}$. The upper bound on $R_{B}$ is therefore dictated by the area trade-off between $R_{B}$ and $C_{B} .{ }^{12} \mathrm{We}$ thus seek a circuit arrangement that provides a high resistance and occupies a moderate area. Fortunately, we have developed such a topology in Chapter 5: as shown in Fig. 7.54(b), a MOS device, $M_{R}$, with a small, but controlled overdrive serves our purpose. As explained in Chapter 5, $M_{R}$ is chosen narrow and long, and $M_{C}$ wide and short.

## 7.6 ■ Noise in Differential Pairs

With our understanding of noise in basic amplifiers, we can now study the noise behavior of differential pairs. Shown in Fig. 7.55(a), a differential pair can be viewed as a two-port circuit. It is therefore possible to model the overall noise as depicted in Fig. 7.55(b). For low-frequency operation, $\overline{I_{n, i n}^{2}}$ is negligible.
image_name:(a)
description:
[
name: M1, type: NMOS, ports: {S: p, D: Voutp, G: Vip}
name: M2, type: NMOS, ports: {S: p, D: Voutn, G: Vin}
name: RD1, type: Resistor, value: RD, ports: {N1: VDD, N2: Voutp}
name: RD2, type: Resistor, value: RD, ports: {N1: VDD, N2: Voutn}
name: ISS, type: CurrentSource, value: ISS, ports: {Np: p, Nn: GND}
]
extrainfo:The circuit is a differential pair with NMOS transistors M1 and M2. The differential pair is biased by a current source ISS. The outputs are taken across resistors RD connected to VDD, providing differential outputs Voutp and Voutn.
image_name:(b)
description:
[
name: M1, type: NMOS, ports: {S: p, D: Voutp, G: g1}
name: M2, type: NMOS, ports: {S: p, D: Voutn, G: g2}
name: RD1, type: Resistor, value: RD, ports: {N1: VDD, N2: Voutp}
name: RD2, type: Resistor, value: RD, ports: {N1: VDD, N2: Voutn}
name: ISS, type: CurrentSource, value: ISS, ports: {Np: p, Nn: GND}
]
extrainfo:The circuit is a differential pair with input-referred noise sources. It includes two NMOS transistors M1 and M2, each connected to a resistor RD. The current source ISS provides the biasing current. The nodes g1 and g2 are the gates of M1 and M2, respectively, representing the input noise sources.

Figure 7.55 (a) Differential pair; (b) circuit including input-referred noise sources.
To calculate the thermal component of $\overline{V_{n, i n}^{2}}$, we first obtain the total output noise with the inputs shorted together [Fig. 7.56(a)], noting that superposition of power quantities is possible because the noise

[^42]image_name:(a)
description:
[
name: M1, type: NMOS, ports: {S: P, D: d1, G: g1}
name: M2, type: NMOS, ports: {S: P, D: d2, G: g2}
name: RD1, type: Resistor, value: RD1, ports: {N1: d1, N2: VDD}
name: RD2, type: Resistor, value: RD2, ports: {N1: d2, N2: VDD}
name: ISS, type: CurrentSource, value: ISS, ports: {Np: GND, Nn: P}
]
extrainfo:The circuit is a differential pair with NMOS transistors M1 and M2. RD1 and RD2 are load resistors connected to VDD, and ISS is a current source providing biasing current to the differential pair. The gates of M1 and M2 are the input nodes g1 and g2, respectively. The node P is the common source node, connected to the current source ISS.
image_name:(b)
description:
[
name: M1, type: NMOS, ports: {S: s1s2, D: d1, G: g1g2}
name: M2, type: NMOS, ports: {S: s1s2, D: d2, G: g1g2}
name: RD1, type: Resistor, value: RD1, ports: {N1: d1, N2: VDD}
name: RD2, type: Resistor, value: RD2, ports: {N1: d2, N2: VDD}
name: Iss, type: CurrentSource, value: Iss, ports: {Np: GND, Nn: s1s2}
]
extrainfo:The circuit is a differential pair with input-referred noise sources. The nodes g1 and g2 are the gates of M1 and M2, respectively. The current source Iss provides the biasing current.
image_name:(c)
description:
[
name: M1, type: NMOS, ports: {S: s1, D: d1, G: Vin}
name: RD1, type: Resistor, value: RD1, ports: {N1: VDD, N2: d1}
name: I_n1, type: CurrentSource, value: I_n1, ports: {Np: d1, Nn: s1}
]
extrainfo:The circuit in diagram (c) is a simplified representation of a differential pair focusing on one transistor M1. It includes a noise current source I_n1 and a resistor RD1 connected to VDD. The circuit is used to analyze the noise performance of the differential pair.
image_name:(d)
description:
[
name: M1, type: NMOS, ports: {S: s1, D: d1, G: Vin}
name: RD1, type: Resistor, value: RD1, ports: {N1: d1, N2: VDD}
name: ISS, type: CurrentSource, value: In1, ports: {Np: d1, Nn: s1}
]
extrainfo:The circuit is a simplified representation of a differential pair focusing on the noise contribution from M1. It includes a resistor RD1 connected to VDD and a current source In1 representing noise.

Figure 7.56 Calculation of input-referred noise of a differential pair.
sources in the circuit are uncorrelated. Since $I_{n 1}$ and $I_{n 2}$ are uncorrelated, node $P$ cannot be considered a virtual ground, making it difficult to use the half-circuit concept. Thus, we simply derive the effect of each source individually. Depicted in Fig. 7.56(b), the contribution of $I_{n 1}$ is obtained by first reducing the circuit to that in Fig. 7.56(c). With the aid of this figure and neglecting channel-length modulation, the reader can prove that half of $I_{n 1}$ flows through $R_{D 1}$ and the other half through $M_{2}$ and $R_{D 2}$. [As shown in Fig. 7.56(d), this can also be proved by decomposing $I_{n 1}$ into two (correlated) current sources and calculating their effect at the output.] Thus, the differential output noise due to $M_{1}$ is equal to

$$
\begin{equation*}
\left.V_{n, \text { out }}\right|_{M 1}=\frac{I_{n 1}}{2} R_{D 1}+\frac{I_{n 1}}{2} R_{D 2} \tag{7.119}
\end{equation*}
$$

Note that the two noise voltages are directly added because they both arise from $I_{n 1}$ and are therefore correlated. It follows that, if $R_{D 1}=R_{D 2}=R_{D}$,

$$
\begin{equation*}
\left.\overline{V_{n, \text { out }}^{2}}\right|_{M 1}=\overline{I_{n 1}^{2}} R_{D}^{2} \tag{7.120}
\end{equation*}
$$

Similarly,

$$
\begin{equation*}
\left.\overline{V_{n, \text { out }}^{2}}\right|_{M 2}=\overline{I_{n 2}^{2}} R_{D}^{2} \tag{7.121}
\end{equation*}
$$

yielding

$$
\begin{equation*}
\left.\overline{V_{n, \text { out }}^{2}}\right|_{M 1, M 2}=\left(\overline{I_{n 1}^{2}}+\overline{I_{n 2}^{2}}\right) R_{D}^{2} \tag{7.122}
\end{equation*}
$$

Taking into account the noise of $R_{D 1}$ and $R_{D 2}$, we have for the total output noise

$$
\begin{align*}
\overline{V_{n, \text { out }}^{2}} & =\left(\overline{I_{n 1}^{2}}+\overline{I_{n 2}^{2}}\right) R_{D}^{2}+2\left(4 k T R_{D}\right)  \tag{7.123}\\
& =8 k T\left(\gamma g_{m} R_{D}^{2}+R_{D}\right) \tag{7.124}
\end{align*}
$$

Dividing the result by the square of the differential gain, $g_{m}^{2} R_{D}^{2}$, we obtain

$$
\begin{equation*}
\overline{V_{n, i n}^{2}}=8 k T\left(\frac{\gamma}{g_{m}}+\frac{1}{g_{m}^{2} R_{D}}\right) \tag{7.125}
\end{equation*}
$$

This is simply twice the input noise voltage squared of a common-source stage.
The input-referred noise voltage can also be calculated by exploiting the lemma illustrated in Fig. 7.39. As shown in Fig. 7.57, the noise of $M_{1}$ and $M_{2}$ is modeled as a voltage source in series with their gates, and the noise of $R_{D 1}$ and $R_{D 2}$ is divided by $g_{m}^{2} R_{D}^{2}$, thereby resulting in (7.125). The reader is encouraged to repeat these calculations if the tail current source is replaced with a short circuit.
image_name:Figure 7.57
description:
[
name: M1, type: NMOS, ports: {S: P, D: VoutP, G: x1}
name: M2, type: NMOS, ports: {S: P, D: VoutN, G: x2}
name: RD1, type: Resistor, value: RD1, ports: {N1: VoutP, N2: VDD}
name: RD2, type: Resistor, value: RD2, ports: {N1: VoutN, N2: VDD}
name: VDD, type: VoltageSource, value: VDD, ports: {Np: VDD, Nn: GND}
name: ISS, type: CurrentSource, value: ISS, ports: {Np: VDD, Nn: P}
]
extrainfo:The circuit is a differential pair with NMOS transistors M1 and M2. It includes resistors RD1 and RD2 connected to VDD, and a tail current source ISS connected to ground. The input-referred noise voltage is analyzed using noise sources at the gates of M1 and M2.

Figure 7.57 Alternative method of calculating the input-referred noise.

It is instructive to compare the noise performance of a differential pair and a common-source stage, as expressed by (7.75) and (7.125). We conclude that, if each transistor has a transconductance $g_{m}$, then the input-referred noise voltage of a differential pair is $\sqrt{2}$ times that of a common-source stage. This is simply because the former includes twice as many devices in the signal path, as exemplified by the two series voltage sources in Fig. 7.57. (Since the noise sources are uncorrelated, their powers add.) It is also important to recognize that, with the assumption of equal device transconductances, a differential pair consumes twice as much power as a common-source stage if the transistors have the same dimensions.

The noise modeling of Fig. 7.57 can readily account for $1 / f$ noise of the transistors as well. Placing the voltage sources given by $K /\left(C_{o x} W L\right)$ in series with each gate, we can rewrite (7.125) as

$$
\begin{equation*}
\overline{V_{n, i n, t o t}^{2}}=8 k T\left(\frac{\gamma}{g_{m}}+\frac{1}{g_{m}^{2} R_{D}}\right)+\frac{2 K}{C_{o x} W L} \frac{1}{f} \tag{7.126}
\end{equation*}
$$

These derivations suggest that the input-referred noise voltage squared of a fully-differential circuit is equal to twice that of its half-circuit equivalent (because the latter employs half as many devices in the signal path). The following example reinforces this point.

#### Example 7.21

A differential pair with current-source loads can be configured to act as a large "floating" resistor [7]. Illustrated in Fig. 7.58(a), the idea is to bias $M_{1}$ and $M_{2}$ at a very small current so as to obtain a high incremental resistance between $A$ and $B$, approximately equal to $1 / g_{m 1}+1 / g_{m 2}$. Determine the noise associated with this resistor. Neglect channel-length modulation.
image_name:(a)
description:
[
name: M1, type: NMOS, ports: {S: P, D: A, G: A}
name: M2, type: NMOS, ports: {S: P, D: B, G: B}
name: M3, type: PMOS, ports: {S: VDD, D: A, G: Vb}
name: M4, type: PMOS, ports: {S: VDD, D: B, G: Vb}
name: I1, type: CurrentSource, ports: {Np: GND, Nn: P}
]
extrainfo:The circuit is a differential pair with current-source loads, acting as a large floating resistor. It is biased to have a high incremental resistance between nodes A and B.
image_name:(b)
description:
[
name: M1, type: NMOS, ports: {S: GND, D: A, G: P}
name: M3, type: PMOS, ports: {S: VDD, D: A, G: Vb}
name: I1, type: CurrentSource, value: I1, ports: {Np: P, Nn: GND}
]
extrainfo:The circuit in (b) is a simplified half-circuit of a differential pair with current-source loads. It is used to analyze the noise voltage at node A. The NMOS transistor M1 is biased by the current source I1, and PMOS transistor M3 acts as a load with a bias voltage Vb.

Figure 7.58

#### Solution

Viewing $A$ and $B$ as the outputs and modeling the circuit by its Thevenin equivalent, we must determine the noise voltage that appears between these nodes. To this end, we construct the half circuit shown in Fig. 7.58(b) and write the noise voltage at $A$ as

$$
\begin{equation*}
\overline{V_{n, A}^{2}}=\left(4 k T \gamma g_{m 1}+4 k T \gamma g_{m 3}\right) \frac{1}{g_{m 1}^{2}}+\frac{K}{(W L)_{1} C_{o x}} \frac{1}{f}+\frac{K}{(W L)_{3} C_{o x}} \frac{1}{f}\left(\frac{g_{m 3}}{g_{m 1}}\right)^{2} \tag{7.127}
\end{equation*}
$$

The noise measured between $A$ and $B$ is thus equal to

$$
\begin{equation*}
\overline{V_{n, A B}^{2}}=8 k T \gamma\left(g_{m 1}+g_{m 3}\right) \frac{1}{g_{m 1}^{2}}+\frac{2 K}{(W L)_{1} C_{o x}} \frac{1}{f}+\frac{2 K}{(W L)_{3} C_{o x}} \frac{1}{f}\left(\frac{g_{m 3}}{g_{m 1}}\right)^{2} \tag{7.128}
\end{equation*}
$$

We recognize that this resistor is noisier than a simple ohmic resistor of the same value $\left(\approx 2 / g_{m 1}\right)$. It is also much less linear (why?).

Does the tail current source in Fig. 7.55 contribute noise? If the differential input signal is zero and the circuit is symmetric, then the noise in $I_{S S}$ divides equally between $M_{1}$ and $M_{2}$, producing only a common-mode noise voltage at the output. On the other hand, for a small differential input, $\Delta V_{i n}$, we have

$$
\begin{align*}
\Delta I_{D 1}-\Delta I_{D 2} & =g_{m} \Delta V_{i n}  \tag{7.129}\\
& =\sqrt{2 \mu_{n} C_{o x} \frac{W}{L}\left(\frac{I_{S S}+I_{n}}{2}\right)} \Delta V_{i n} \tag{7.130}
\end{align*}
$$

where $I_{n}$ denotes the noise in $I_{S S}$ and $I_{n} \ll I_{S S}$. In essence, the noise modulates the transconductance of each device. Equation (7.130) can be written as

$$
\begin{align*}
\Delta I_{D 1}-\Delta I_{D 2} & \approx \sqrt{2 \mu_{n} C_{o x} \frac{W}{L} \cdot \frac{I_{S S}}{2}}\left(1+\frac{I_{n}}{2 I_{S S}}\right) \Delta V_{i n}  \tag{7.131}\\
& =g_{m 0}\left(1+\frac{I_{n}}{2 I_{S S}}\right) \Delta V_{i n} \tag{7.132}
\end{align*}
$$

where $g_{m 0}$ is the transconductance of the noiseless circuit. Equation (7.132) suggests that as the circuit departs from equilibrium, $I_{n}$ is more unevenly divided between $M_{1}$ and $M_{2}$, thereby generating differential noise at the output. This effect is nonetheless usually negligible.

Example 7.22
Assuming that the devices in Fig. 7.59(a) operate in saturation and the circuit is symmetric, calculate the input-referred noise voltage.
image_name:(a)
description:
[
name: M1, type: NMOS, ports: {S: GND, D: Voutp, G: Vip}
name: M2, type: NMOS, ports: {S: GND, D: Voutn, G: Vin}
name: M3, type: PMOS, ports: {S: VDD, D: Voutp, G: Vb}
name: M4, type: PMOS, ports: {S: VDD, D: Voutn, G: Vb}
name: CurrentSource, type: CurrentSource, ports: {Np: GND, Nn: P}
]
extrainfo:The circuit is a symmetric differential amplifier with NMOS input pair (M1, M2) and PMOS load (M3, M4). It is biased with a current source connected to ground.

(a)
image_name:Figure 7.59
description:
[
name: M1, type: NMOS, ports: {S: GND, D: X, G: Vin1}
name: M2, type: NMOS, ports: {S: GND, D: Y, G: Vin2}
name: M3, type: PMOS, ports: {S: VDD, D: X, G: Vb}
name: M4, type: PMOS, ports: {S: VDD, D: Y, G: Vb}
name: CurrentSource, type: CurrentSource, ports: {Np: VDD, Nn: GND}
]
extrainfo:The circuit is a symmetric differential amplifier with NMOS input pair (M1, M2) and PMOS load (M3, M4). It is biased with a current source connected to ground. The input signals are Vin1 and Vin2, and the outputs are at nodes X and Y.

(b)
image_name:Figure 7.59(c)
description:
[
name: Vn3^2, type: VoltageSource, value: Vn3^2, ports: {Np: g3, Nn: GND}
name: M3, type: PMOS, ports: {S: VDD, D: X, G: g3}
name: M4, type: PMOS, ports: {S: VDD, D: Y, G: g3}
name: M1, type: NMOS, ports: {S: GND, D: X, G: g1g2}
name: M2, type: NMOS, ports: {S: GND, D: Y, G: g1g2}
name: rO3, type: Resistor, value: rO3, ports: {N1: X, N2: g3}
name: RX, type: Resistor, value: RX, ports: {N1: X, N2: Y}
]
extrainfo:The circuit is a symmetric differential amplifier with NMOS input pair (M1, M2) and PMOS load (M3, M4). It includes a resistor RX between the outputs X and Y, and a resistor rO3 connected to the drain of M3. The circuit is biased with a voltage source Vn3^2 connected to the gate of M3 and M4.

(c)

Figure 7.59

#### Solution

Since the thermal and $1 / f$ noise of $M_{1}$ and $M_{2}$ can be modeled as voltage sources in series with the input, we need only refer the noise of $M_{3}$ and $M_{4}$ to the input. Let us calculate the output noise contributed by $M_{3}$. The drain noise current of $M_{3}$ is divided between $r_{O 3}$ and the resistance seen looking into the drain of $M_{1}$ [Fig. 7.59(c)]. From Chapter 5, this resistance equals $R_{X}=r_{O 4}+2 r_{O 1}$. Denoting the resulting noise currents flowing through $r_{O 3}$ and $R_{X}$ by $I_{n A}$ and $I_{n B}$, respectively, we have

$$
\begin{equation*}
I_{n A}=g_{m 3} V_{n 3} \frac{r_{O 4}+2 r_{O 1}}{2 r_{O 4}+2 r_{O 1}} \tag{7.133}
\end{equation*}
$$

and

$$
\begin{equation*}
I_{n B}=g_{m 3} V_{n 3} \frac{r_{O 3}}{2 r_{O 4}+2 r_{O 1}} \tag{7.134}
\end{equation*}
$$

The former produces a noise voltage of $g_{m 3} V_{n 3} r_{O 3}\left(r_{O 4}+2 r_{O 1}\right) /\left(2 r_{O 4}+2 r_{O 1}\right)$ at node $X$ with respect to ground whereas the latter flows through $M_{1}, M_{2}$, and $r_{O 4}$, generating $g_{m 3} V_{n 3} r_{O 3} r_{O 4} /\left(2 r_{O 4}+2 r_{O 1}\right)$ at node $Y$ with respect
to ground. Thus, the total differential output noise due to $M_{3}$ is equal to

$$
\begin{align*}
V_{n X Y} & =V_{n X}-V_{n Y}  \tag{7.135}\\
& =g_{m 3} V_{n 3} \frac{r_{O 3} r_{O 1}}{r_{O 3}+r_{O 1}} \tag{7.136}
\end{align*}
$$

(The reader can verify that $V_{n Y}$ must be subtracted from $V_{n X}$.)
Equation (7.136) implies that the noise current of $M_{3}$ is simply multiplied by the parallel combination of $r_{O 1}$ and $r_{O 3}$ to produce the differential output voltage. This is of course not surprising because, as depicted in Fig. 7.60, the effect of $V_{n 3}$ at the output can also be derived by decomposing $V_{n 3}$ into two differential components applied to the gates of $M_{3}$ and $M_{4}$ and subsequently using the half-circuit concept. Since this calculation relates to a single noise source, we can temporarily ignore the random nature of noise and treat $V_{n 3}$ and the circuit as familiar deterministic, linear components.
image_name:(a)
description:
[
name: M1, type: NMOS, ports: {S: GND, D: X, G: g1g2}
name: M2, type: NMOS, ports: {S: GND, D: Y, G: g2g2}
name: M3, type: PMOS, ports: {S: VDD, D: X, G: g3}
name: M4, type: PMOS, ports: {S: VDD, D: Y, G: g3}
name: Vn3, type: VoltageSource, ports: {Np: g3, Nn: GND}
name: VDD, type: VoltageSource, ports: {Np: VDD, Nn: GND}
]
extrainfo:The circuit diagram (a) represents a differential pair with current-source loads. It includes two NMOS transistors (M1 and M2) and two PMOS transistors (M3 and M4). The voltage source Vn3 is connected to the gates of the PMOS transistors. The power supply VDD is connected to the sources of the PMOS transistors. Nodes X and Y are the drains of the NMOS and PMOS pairs, forming the differential output.
image_name:(b)
description:
[
name: M1, type: NMOS, ports: {S: GND, D: X, G: g1g2}
name: M2, type: NMOS, ports: {S: GND, D: Y, G: g1g2}
name: M3, type: PMOS, ports: {S: VDD, D: X, G: g3}
name: M4, type: PMOS, ports: {S: VDD, D: Y, G: g3}
name: Vn3, type: VoltageSource, ports: {Np: g3, Nn: GND}
name: VDD, type: VoltageSource, ports: {Np: VDD, Nn: GND}
]
extrainfo:This is a differential pair with current-source loads, focusing on input-referred noise analysis. The circuit uses two NMOS transistors (M1, M2) and two PMOS transistors (M3, M4) with a voltage source Vn3 applied to the gates of the PMOS transistors. The nodes X and Y are the differential outputs.
image_name:(c)
description:
[
name: M1, type: NMOS, ports: {S: GND, D: X, G: GND}
name: M3, type: PMOS, ports: {S: VDD, D: X, G: GND}
]
extrainfo:The circuit diagram (c) represents a half-circuit of a differential pair with a current-source load, focusing on the effect of noise source Vn3.

Figure 7.60 Calculation of input-referred noise in a differential pair with current-source loads.
Applying (7.136) to $M_{4}$ as well and adding the resulting powers, we have

$$
\begin{align*}
\left.\overline{V_{n, \text { out }}^{2}}\right|_{M 3, M 4} & =g_{m 3}^{2}\left(r_{O 1} \| r_{O 3}\right)^{2} \overline{V_{n 3}^{2}}+g_{m 4}^{2}\left(r_{O 2} \| r_{O 4}\right)^{2} \overline{V_{n 4}^{2}}  \tag{7.137}\\
& =2 g_{m 3}^{2}\left(r_{O 1} \| r_{O 3}\right)^{2} \overline{V_{n 3}^{2}} \tag{7.138}
\end{align*}
$$

To refer the noise to the input, we divide (7.138) by $g_{m 1}^{2}\left(r_{O 1} \| r_{O 3}\right)^{2}$, obtaining the total input-referred noise voltage per unit bandwidth as

$$
\begin{equation*}
\overline{V_{n, i n}^{2}}=2 \overline{V_{n 1}^{2}}+2 \frac{g_{m 3}^{2}}{g_{m 1}^{2}} \overline{V_{n 3}^{2}} \tag{7.139}
\end{equation*}
$$

which, upon substitution for $\overline{V_{n 1}^{2}}$ and $\overline{V_{n 3}^{2}}$, reduces to

$$
\begin{equation*}
\overline{V_{n, i n}^{2}}=8 k T \gamma\left(\frac{1}{g_{m 1}}+\frac{g_{m 3}}{g_{m 1}^{2}}\right)+\frac{2 K_{N}}{C_{o x}(W L)_{1} f}+\frac{2 K_{P}}{C_{o x}(W L)_{3} f} \frac{g_{m 3}^{2}}{g_{m 1}^{2}} \tag{7.140}
\end{equation*}
$$

It is instructive to compare the above input-referred noise to that of a differential pair with active load (the five-transistor OTA). We analyze the thermal noise of the latter and leave the flicker noise as an exercise for the reader. Due to lack of perfect symmetry, we seek the Norton noise equivalent of the circuit by first computing the output short-circuit noise current (Fig. 7.61). This result can be multiplied by the output resistance and divided by the gain to obtain the input-referred noise voltage.
image_name:Figure 7.61 OTA output short-circuit noise current
description:
[
name: M1, type: NMOS, ports: {S: GND, D: P, G: X}
name: M2, type: NMOS, ports: {S: GND, D: P, G: X}
name: M3, type: PMOS, ports: {S: VDD, D: X, G: X}
name: M4, type: PMOS, ports: {S: VDD, D: GND, G: X}
name: Iss, type: CurrentSource, value: Iss, ports: {Np: P, Nn: GND}
]
extrainfo:The circuit is a five-transistor operational transconductance amplifier (OTA) with a differential pair (M1, M2) and active load (M3, M4). The current source Iss provides biasing.

Figure 7.61 OTA output short-circuit noise current.

We recall from Chapter 5 that the transconductance of the five-transistor OTA is approximately equal to $g_{m 1,2}$. Thus, the output noise current due to $M_{1}$ and $M_{2}$ is given by this transconductance multiplied by the gate-referred noises of $M_{1}$ and $M_{2}$, i.e., $g_{m 1,2}^{2}\left(4 k T \gamma / g_{m 1}+4 k T \gamma / g_{m 2}\right)$.

Let us consider the noise current of $M_{3}, 4 k T \gamma g_{m 3}$. This current primarily circulates through the diodeconnected impedance, $1 / g_{m 3}$, producing a voltage at the gate of $M_{4}$ with a spectral density of $4 k T \gamma / g_{m 3}$. This noise is multiplied by $g_{m 4}^{2}$ as it emerges from the drain of $M_{4}$. The noise current of $M_{4}$ itself also directly flows through the output short circuit. We therefore have

$$
\begin{equation*}
\overline{I_{n, \text { out }}^{2}}=4 k T \gamma\left(2 g_{m 1,2}+2 g_{m 3,4}\right) \tag{7.141}
\end{equation*}
$$

Multiplying this noise by $R_{\text {out }}^{2} \approx\left(r_{O 1,2} \| r_{O 3,4}\right)^{2}$ and dividing the result by $A_{v}^{2}=G_{m}^{2} R_{\text {out }}^{2}$, we obtain the total input-referred noise voltage as

$$
\begin{equation*}
\overline{V_{n, i n}^{2}}=8 k T \gamma\left(\frac{1}{g_{m 1,2}}+\frac{g_{m 3,4}}{g_{m 1,2}^{2}}\right) \tag{7.142}
\end{equation*}
$$

which is the same as that of the fully-differential circuit.
An interesting difference between the OTA and the fully-differential topology relates to the noise contributed by the tail current when $V_{i n 1}=V_{i n 2}$. Recall from Chapter 5 that the output voltage of the OTA in Fig. 7.62 is equal to $V_{X}$. If $I_{S S}$ fluctuates, so do $V_{X}$ and $V_{\text {out }}$. Since the tail noise current, $I_{n}$, splits equally between $M_{1}$ and $M_{2}$, the noise voltage at $X$ is given by $\overline{I_{n}^{2}} /\left(4 g_{m 3}^{2}\right)$, and so is the noise voltage at the output. (Why does $I_{n}$ split equally, even though the impedance seen looking into the source of $M_{2}$ appears to be higher than that seen looking into the source of $M_{1}$ ?)

The effect of noise must be studied for many other analog circuits as well. For example, feedback systems, op amps, and bandgap references exhibit interesting and important noise characteristics. We return to these topics in other chapters.
image_name:Figure 7.62 Effect of tail noise current in OTA
description:
[
name: M1, type: NMOS, ports: {S: GND, D: X, G: P}
name: M2, type: NMOS, ports: {S: GND, D: Vout, G: P}
name: M3, type: PMOS, ports: {S: VDD, D: X, G: X}
name: M4, type: PMOS, ports: {S: VDD, D: Vout, G: X}
name: Iss, type: CurrentSource, ports: {Np: P, Nn: GND}
]
extrainfo:The circuit is a differential pair with a tail current source Iss. M1 and M2 are NMOS transistors forming the input pair, while M3 and M4 are PMOS transistors forming the load. The output is taken from the drain of M2.

Figure 7.62 Effect of tail noise current in OTA.

## 7.7 ■ Noise-Power Trade-Off

In our analysis of the input-referred thermal noise, we have seen that the noise contributed by the transistors "in the signal path" is inversely proportional to their transconductance. This dependence suggests a tradeoff between noise and power consumption.

The noise-power trade-off can in fact be generalized to any circuit (so long as the input noise current is negligible). To understand this point, let us begin with a simple CS stage as shown in Fig. 7.63(a): we double $W / L$ and the bias current of $M_{1}$ and halve the load resistor. This transformation maintains the voltage gain and the output swing regardless of the transistor characteristics. But we note that the input-referred thermal and flicker noise power is exactly halved (because both the $g_{m}$ and the gate area of the transistor are doubled). This 3-dB reduction in noise accrues at a cost of doubling the power consumption (and the input capacitance).
image_name:(a)
description:
[
name: M1, type: NMOS, ports: {S: GND, D: Vout, G: Vin}
name: RD, type: Resistor, value: RD, ports: {N1: VDD, N2: Vout}
]
extrainfo:The circuit in Fig. 7.63(a) shows a common-source stage with an NMOS transistor M1 and a load resistor RD. The transformation involves doubling the width-to-length ratio (W/L) and the bias current of M1, while halving the load resistor RD. This maintains the voltage gain and output swing, but reduces input-referred noise by 3 dB at the cost of doubling power consumption.
image_name:(b)
description:
[
name: M1, type: NMOS, ports: {S: GND, D: Vout, G: Vin}
name: RD, type: Resistor, value: RD, ports: {N1: Vout, N2: VDD}
name: M1, type: NMOS, ports: {S: GND, D: Vout, G: Vin}
name: RD, type: Resistor, value: RD, ports: {N1: Vout, N2: VDD}
]
extrainfo:The circuit in Fig. 7.63(b) shows two parallel NMOS transistors (M1) each with a load resistor (RD). This configuration is equivalent to doubling the width of the transistor and the load resistor, hence reducing the output noise power by half while maintaining the same voltage gain and output swing. The input-referred thermal and flicker noise power is halved at the cost of doubling the power consumption and input capacitance.
image_name:(c)
description:The image labeled as Figure 7.63(c) illustrates the concept of scaling at the layout level in a circuit design. It displays the transformation of a circuit by doubling the width of both the transistor and the resistor, which is part of a linear scaling process.

1. **Identification of Components and Structure:**
- The diagram on the left shows a single transistor labeled as \(M_1\) with a width \(W_1\) and a resistor \(R_D\) with a width \(W_D\). The transistor is represented as a rectangular block with a smaller black square inside, indicating the gate area. The resistor is depicted above the transistor, connected vertically.
- The diagram on the right shows the scaled version of the same components. The transistor \(M_1\) now has a doubled width of \(2W_1\), and the resistor \(R_D\) also has a doubled width of \(2W_D\). This indicates that both components have been physically enlarged in the layout.

2. **Connections and Interactions:**
- The resistor \(R_D\) is connected to the drain of the transistor \(M_1\). The scaling transformation maintains this connection, but with larger physical dimensions.
- The scaling does not alter the fundamental electrical connections or the operation of the circuit, but rather changes the physical layout to achieve reduced noise and increased power consumption.

3. **Labels, Annotations, and Key Features:**
- The key annotations include the dimensions \(W_1\) and \(W_D\) for the original layout and \(2W_1\) and \(2W_D\) for the scaled layout. These indicate the doubling of the width in the layout.
- The diagram effectively communicates the concept of linear scaling by showing the physical changes in the layout while maintaining the same circuit functionality.

Figure 7.63 (a) Output noise reduction by scaling, (b) equivalent operation, and (c) scaling viewed at layout level.
Called "linear scaling," the transformation depicted in Fig. 7.63(a) can also be viewed as placing two instances of the original circuit in parallel, as illustrated in Fig. 7.63(b). Alternatively, we can say that the widths of the transistor and the resistor are doubled [Fig. 7.63(c)].

In general, if two instances of a circuit are placed in parallel, the output noise power is halved [Fig. 7.64(a)]. This can be proved by setting the input to zero and constructing a Thevenin noise equivalent for each [Fig. 7.64(b)]. Since $V_{n 1, \text { out }}$ and $V_{n 2, \text { out }}$ are uncorrelated, we can use superposition of powers to write

$$
\begin{align*}
\overline{V_{n, \text { out }}^{2}} & =\frac{\overline{V_{n 1, \text { out }}^{2}}}{4}+\frac{\overline{V_{n 2, \text { out }}^{2}}}{4}  \tag{7.143}\\
& =\frac{\overline{V_{n 1, \text { out }}^{2}}}{2} \tag{7.144}
\end{align*}
$$

Thus, the output noise is traded for power consumption while retaining the voltage gain and output swings. Note that this can also be proved if the input is left open, revealing that the input-referred noise current, $\overline{I_{n, i n}^{2}}$, is doubled (why?).
image_name:Figure 7.64 (b) equivalent circuit
description:The system block diagram labeled "Figure 7.64 (b) equivalent circuit" consists of two main amplifier blocks, both denoted by the letter 'A'. These amplifiers are arranged in parallel configuration.

1. **Main Components:**
- **Amplifiers (A):** There are two identical amplifiers in the circuit. The amplifiers are responsible for increasing the amplitude of the input signal.

2. **Flow of Information or Control:**
- The input voltage, \( V_{in} \), is split into two paths at nodes \( X_1 \) and \( X_2 \). Each path leads to one of the amplifiers.
- The outputs from the amplifiers are then recombined at nodes \( X_3 \) and \( X_4 \) to form the output voltage, \( V_{out} \).
- The signal flow is unidirectional from \( V_{in} \) to \( V_{out} \), with no feedback loops indicated in this configuration.

3. **Labels, Annotations, and Key Indicators:**
- The nodes \( X_1, X_2, X_3, \) and \( X_4 \) are labeled to indicate the points of signal splitting and recombination.

4. **Overall System Function:**
- The primary function of this circuit is to amplify the input signal \( V_{in} \) while splitting the signal path into two parallel amplifiers. This configuration can help in reducing noise by averaging out the noise contributions from each amplifier, as suggested by the context. The output \( V_{out} \) is a combination of the amplified signals from both paths, potentially providing a cleaner and stronger signal output.

(a)
image_name:(b) equivalent circuit
description:
[
name: V2n1, type: VoltageSource, value: V2n1, ports: {Np: X1, Nn: X3}
name: Zout, type: Resistor, value: Zout, ports: {N1: X1, N2: X2}
name: V2n2, type: VoltageSource, value: V2n2, ports: {Np: X4, Nn: X3}
name: Zout, type: Resistor, value: Zout, ports: {N1: X4, N2: X2}
]
extrainfo:The circuit diagram shows two parallel paths, each with a voltage source and a resistor, combining at node X2 to produce the output Vn^2,out.

(b)

Figure 7.64 (a) General scaling for noise reduction, and (b) equivalent circuit.

We should also remark that noise spectrum must eventually be integrated across the circuit's bandwidth. The foregoing linear scaling assumes that the bandwidth is dictated by the application and hence constant.

## 7.8 ■ Noise Bandwidth

The total noise corrupting a signal in a circuit results from all of the frequency components that fall in the bandwidth of the circuit. Consider a multipole circuit having the output noise spectrum shown in Fig. 7.65(a). Since the noise components above $\omega_{p 1}$ are not negligible, the total output noise must be evaluated by calculating the total area under the spectral density:

$$
\begin{equation*}
\overline{V_{n, \text { out }, \text { tot }}^{2}}=\int_{0}^{\infty} \overline{V_{n, \text { out }}^{2}} d f \tag{7.145}
\end{equation*}
$$

However, as depicted in Fig. 7.65(b), it is sometimes helpful to represent the total noise simply as $V_{0}^{2} \cdot B_{n}$, where the bandwidth $B_{n}$ is chosen such that

$$
\begin{equation*}
V_{0}^{2} \cdot B_{n}=\int_{0}^{\infty} \overline{V_{n, \text { out }}^{2}} d f \tag{7.146}
\end{equation*}
$$

Called the "noise bandwidth," $B_{n}$ allows a fair comparison of circuits that exhibit the same low-frequency noise, $V_{0}^{2}$, but different high-frequency transfer functions. As an exercise, the reader can prove that the noise bandwidth of a one-pole system is equal to $\pi / 2$ times the pole frequency.
image_name:(a)
description:1. **Type of Graph and Function:**
The graph is a plot of the output noise power spectrum of a circuit. It is likely a frequency-domain representation showing how the output noise power varies with frequency.

2. **Axes Labels and Units:**
- The vertical axis is labeled as \( V_{n, \text{out}}^2 \), representing the output noise power spectral density, presumably in units of volts squared per hertz (\( V^2/Hz \)).
- The horizontal axis is labeled \( \omega \), indicating angular frequency in radians per second.

3. **Overall Behavior and Trends:**
- The graph starts with a flat region at \( V_0^2 \) indicating a constant noise power level at low frequencies.
- As frequency increases, the graph shows a downward trend, indicating a decrease in noise power.
- The spectrum has two distinct slopes, marked by points \( \omega_{p1} \) and \( \omega_{p2} \), suggesting changes in the system's transfer function at these frequencies.

4. **Key Features and Technical Details:**
- **Flat Region:** At low frequencies, the noise power remains constant at \( V_0^2 \).
- **First Breakpoint (\( \omega_{p1} \))**: The first change in slope occurs at \( \omega_{p1} \), where the noise power begins to decrease.
- **Second Breakpoint (\( \omega_{p2} \))**: A further decrease in slope occurs at \( \omega_{p2} \), indicating a more rapid decline in noise power.
- **End Behavior:** At high frequencies, the noise power approaches zero, suggesting the system filters out high-frequency noise.

5. **Annotations and Specific Data Points:**
- The graph includes two vertical dashed lines at \( \omega_{p1} \) and \( \omega_{p2} \), marking critical frequencies where the slope changes.
- The shaded area under the curve represents the total integrated noise power over all frequencies, which is related to the noise bandwidth \( B_n \).
image_name:(b)
description:The graph in Figure 7.65 (b) is a plot representing the concept of noise bandwidth for a circuit. It is a frequency-domain plot with the horizontal axis labeled as frequency (ω) and the vertical axis labeled as \( V_{n, \text{out}}^2 \), which represents the power spectral density of the output noise voltage.

**Type of Graph and Function:**
This is a spectral density plot showing how the output noise power varies with frequency.

**Axes Labels and Units:**
- **Horizontal Axis (ω):** Represents frequency, typically in radians per second. The axis is linear.
- **Vertical Axis (\( V_{n, \text{out}}^2 \)):** Represents the squared noise voltage, indicating power spectral density. The units are in volts squared (\( V^2 \)).

**Overall Behavior and Trends:**
- The graph starts with a constant noise power level \( V_0^2 \) at lower frequencies, indicating that the noise power is flat or constant up to a certain frequency.
- The plot shows a downward slope after the first marked frequency \( \omega_{p1} \), indicating a decrease in noise power with increasing frequency.
- The slope continues to decrease more sharply after the second marked frequency \( \omega_{p2} \), showing a more rapid decline in noise power.

**Key Features and Technical Details:**
- **\( \omega_{p1} \) and \( \omega_{p2} \):** These are critical frequencies where the slope of the noise power changes. They likely represent pole frequencies in the system's transfer function.
- The shaded area under the curve represents the integral of the noise power over frequency, which is used to define the noise bandwidth \( B_n \).
- The concept of noise bandwidth is illustrated by the area under the curve being equivalent to a rectangle with height \( V_0^2 \) and width \( B_n \).

**Annotations and Specific Data Points:**
- The graph is annotated with \( \omega_{p1} \) and \( \omega_{p2} \) to highlight the frequencies where changes occur.
- \( V_0^2 \) is marked as the initial constant level of noise power density.

This graph effectively illustrates how noise bandwidth is conceptualized, showing how the total noise power is distributed across different frequencies and how it can be represented by an equivalent noise bandwidth for comparison purposes.

(a)
image_name:(b)
description:The graph in Figure 7.65 (b) is a conceptual representation of noise bandwidth in a circuit. It is a frequency-domain plot that illustrates how noise power density is distributed across different frequencies.

1. **Type of Graph and Function:**
- This is a frequency-domain plot representing noise power density as a function of frequency.

2. **Axes Labels and Units:**
- The vertical axis represents the noise power density, labeled as \( V_n^2, \text{out} \), with units likely in volts squared per hertz (V²/Hz).
- The horizontal axis represents frequency, labeled as \( \omega \), with units typically in radians per second (rad/s).

3. **Overall Behavior and Trends:**
- The graph starts at a constant level \( V_0^2 \), indicating a flat noise power density up to frequency \( \omega_{p1} \).
- Beyond \( \omega_{p1} \), the noise power density begins to decrease, forming a downward slope until it reaches \( \omega_{p2} \).
- After \( \omega_{p2} \), the graph continues to slope downward, indicating a further reduction in noise power density.

4. **Key Features and Technical Details:**
- The graph highlights two critical frequencies, \( \omega_{p1} \) and \( \omega_{p2} \), where changes in the noise power density occur.
- The area under the curve between \( \omega_{p1} \) and \( \omega_{p2} \) is shaded and labeled as \( A_1 \), while the area under the curve beyond \( \omega_{p2} \) is labeled as \( A_2 \).
- The total noise bandwidth \( B_n \) is represented by the horizontal distance between \( \omega_{p1} \) and \( \omega_{p2} \).
- The areas \( A_1 \) and \( A_2 \) are equal, illustrating the concept of equivalent noise bandwidth, where the total noise power is represented by an equivalent rectangular bandwidth.

5. **Annotations and Specific Data Points:**
- The constant noise power density level \( V_0^2 \) is marked at the beginning of the graph.
- The graph is annotated with \( \omega_{p1} \) and \( \omega_{p2} \) to highlight the frequencies where the noise power density begins to change and continues to decrease.

(b)

Figure 7.65 (a) Output noise spectrum of a circuit; (b) concept of noise bandwidth.
